const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ChartByComm-CfNMYcyq.js","./index-FdyGBlLz.js","./index-BnngHmlw.css","./ChartByComm-CxJ2tzVq.css"])))=>i.map(i=>d[i]);
import{cq as v,n as A,_ as L,cr as N,cs as T,j as _}from"./index-FdyGBlLz.js";import{h as D,a as h}from"./common-0X47MWYd.js";import{_ as S}from"./go1-FKcY8q87.js";import{_ as k}from"./close-DKk2BBKI.js";const Y={today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",yearFormat:"YYYY年",dayFormat:"D日",dateFormat:"YYYY年M月D日",dateTimeFormat:"YYYY年M月D日 HH时mm分ss秒",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪"};var P={placeholder:"请选择时间"},C={lang:v({placeholder:"请选择日期",rangePlaceholder:["开始日期","结束日期"]},Y),timePickerLocale:v({},P)};C.lang.ok="确 定";let w=["#E44948","#F2C96F","#94BC77","#4b9dff"];function z(i){return{color:w,tooltip:{show:!0,trigger:"axis",formatter:e=>{let t='<span style="font-weight:600">'+e[0].name+"</span>";for(let a=0,l=e.length;a<l;a++)D(e[a].value)?e[a].seriesName==="实测功率"?t+='<br/><span style="font-weight:600">'+e[a].marker+e[a].seriesName+"&nbsp;&nbsp;&nbsp;"+e[a].value+"MW</span>":t+='<br/><span style="font-weight:600">'+e[a].marker+"预测功率（"+e[a].seriesName+"）&nbsp;&nbsp;&nbsp;"+e[a].value+"MW</span>":t+='<br/><span style="font-weight:600">'+e[a].marker+"预测功率（"+e[a].seriesName+"）&nbsp;&nbsp;&nbsp;暂无数据</span>";return t}},legend:{show:!0,top:0,icon:"circle",textStyle:{color:"#fff"},orient:"horizontal",formatter:e=>e==="实测功率"?e:"预测功率（"+e+"）"},grid:{left:45,right:45,bottom:45,top:38,containLabel:!0},xAxis:{type:"category",data:i.xAxis,axisLine:{lineStyle:{color:"#fff"}},axisTick:{show:!1}},yAxis:{type:"value",name:"MW",nameTextStyle:{color:"#fff"},axisLine:{show:!0,lineStyle:{color:"#fff"}},splitLine:{lineStyle:{color:"#999"}},axisTick:{show:!1}},dataZoom:[{type:"inside"},{type:"slider",moveHandleSize:0,handleSize:40,bottom:15,height:20,borderColor:"#fff",dataBackground:{lineStyle:{color:"rgb(255,255,255, 0)"},areaStyle:{color:"rgb(255,255,255, 0)"}}}],series:i.yAxis}}function F(i){return{color:w,tooltip:{show:!0,trigger:"axis",formatter:e=>{let t='<span style="font-weight:600">'+e[0].name+"</span>";for(let a=0,l=e.length;a<l;a++)D(e[a].value)?t+='<br/><span style="font-weight:600">'+e[a].marker+"准确率（"+e[a].seriesName+"）&nbsp;&nbsp;&nbsp;"+parseFloat(e[a].value).toFixed(2)+"%</span>":t+='<br/><span style="font-weight:600">'+e[a].marker+"准确率（"+e[a].seriesName+"）&nbsp;&nbsp;&nbsp;暂无数据</span>";return t}},legend:{show:!0,top:0,icon:"circle",textStyle:{color:"#fff"},orient:"horizontal",formatter:e=>"准确率（"+e+"）"},grid:{left:45,right:45,bottom:45,top:38,containLabel:!0},xAxis:{type:"category",data:i.xAxis,axisLine:{lineStyle:{color:"#fff"}},axisTick:{show:!1}},yAxis:{type:"value",name:"%",nameTextStyle:{color:"#fff"},axisLine:{show:!0,lineStyle:{color:"#fff"}},splitLine:{lineStyle:{color:"#999"}},axisTick:{show:!1}},dataZoom:[{type:"inside"},{type:"slider",moveHandleSize:0,handleSize:40,bottom:15,height:20,borderColor:"#fff",dataBackground:{lineStyle:{color:"rgb(255,255,255, 0)"},areaStyle:{color:"rgb(255,255,255, 0)"}}}],series:i.yAxis}}var f=null,p=null;const B={name:"WindPower",props:{entityId:{type:[String,Number],default:null},isSuper:{type:Boolean,default:!1},auth:{type:String,default:""}},components:{ChartByComm:()=>L(()=>import("./ChartByComm-CfNMYcyq.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)},data(){return{locale:C,visiblity:!1,isShowPower:!0,superDetail:!1,fanList:[],isShortPage:!0,myChart:null,accuracyChart:null,superData:[],accuracyDate:[],tableKey:"",detailList:[],startTime:h(0,"-",0)+" 00:00:00",endTime:h(0,"-",0)+" 23:59:59",startAccuTime:h(-30,"-",0),endAccuTime:h(0,"-",0),minTime:"",maxTime:"",minAccuTime:"",maxAccuTime:"",predictionHead:[],predictionList:[],tabHeadName:[],tabAccuHeadName:[],accuracyHead:[],accuracyList:[],extendValue:[],noSuperData:!1,noShortData:!1,init:!1,tableTypes:{prediction:{name:"预测",unit:"MW",head:[],data:[]},accuracy:{name:"准确率",unit:"%",head:[],data:[]}},comProps1:null,comProps2:null}},computed:{historyAverageTxt(){let i="";return this.extendValue.forEach(e=>{Number(e.value)!==0&&(i+=`${e.factoryName}(${e.value}%)；`)}),i},dateType(){return this.isSuper?2:1}},mounted(){this.resize()},methods:{initData(){this.$nextTick(()=>{this.$refs.wpbox.scrollTop=0}),this.init=!0,this.detailList=[],this.extendValue=[],f&&f.clear(),p&&p.clear();for(let i in this.tableTypes)this.tableTypes[i].head=[],this.tableTypes[i].data=[];this._GetForecastData(h(0,"-",0)+" 00:00:00",h(this.isSuper?0:7,"-",0)+" 23:59:59"),this._GetAccuracyData(h(-30,"-",0),h(0,"-",0))},async _GetForecastData(i,e){this.superData=[i,e],this.tabHeadName.length=0;let t={entityId:this.entityId,dateType:this.dateType,startTime:i,endTime:e},{result:a}=await N(t);if(this.minTime=a.startTime,this.maxTime=a.endTime,a.data&&a.data.length>0){this.noSuperData=!1,this.tableTypes.prediction.data=a.data;let l=a.data.map(r=>r.dataTime),o=[],c=[],y=a.data[0].predictionList.map(r=>r.factoryName);this.tableTypes.prediction.head=y,a.data.forEach(r=>{o=o.concat(r.predictionList)}),y.forEach(r=>{let d=o.filter(s=>s.factoryName===r),b={};r==="实际值"?b={name:"实测功率",data:d,type:"line",showSymbol:!1,connectNulls:!1,lineStyle:{type:"dashed"}}:b={name:r,data:d,type:"line",showSymbol:!1,connectNulls:!1},c.push(b)});let m=z({xAxis:l,yAxis:c});this.comProps1={beforeSetOptions(r){return r.grid.top="7%",r.grid.left="3%",r.grid.right="1%",r.grid.bottom="12%",r.legend={show:!0,top:0,icon:"circle",textStyle:{color:"#fff"},orient:"horizontal",formatter:d=>d==="实测功率"?d:"预测功率（"+d+"）"},r.dataZoom=[{type:"inside"},{type:"slider",moveHandleSize:0,handleSize:40,bottom:15,height:20,borderColor:"#fff",dataBackground:{lineStyle:{color:"rgb(255,255,255, 0)"},areaStyle:{color:"rgb(255,255,255, 0)"}}}],r},chartData:{unit:"MW",xAxisData:m.xAxis.data,series:m.series.map((r,d)=>({name:r.name,noSmooth:!0,needDotted:!!r.lineStyle,color:m.color[d],data:r.data}))}}}else this.noSuperData=!0},async _GetAccuracyData(i,e){this.accuracyDate=[i,e],this.tabAccuHeadName.length=0,this.extendValue=[];let t={},a={entityId:this.entityId,dateType:this.dateType,startTime:i,endTime:e},{result:l}=await T(a);if(this.dateType===1&&(t=(await T({...a,dateType:3})).result),this.minAccuTime=l.startTime,this.maxAccuTime=l.endTime,l.data&&l.data.length>0){this.noShortData=!1;let o=this.dateType===1?"短期":"",c=l.data.map(s=>({...s,accuracyList:s.accuracyList.map(n=>({...n,factoryName:n.factoryName+o}))}));this.tableTypes.accuracy.data=c,this.extendValue=o?l.extendValue.map(s=>({...s,factoryName:s.factoryName+o})):l.extendValue;let y=l.data.map(s=>s.dataTime),x=[],m=[],r=c[0].accuracyList.map(s=>s.factoryName);if(t.data&&t.data.length){this.extendValue=[...this.extendValue,...t.extendValue.map(n=>({...n,factoryName:n.factoryName+"中期"}))];let s=t.data[0].accuracyList.map(n=>n.factoryName+"中期");t.data.forEach(n=>{let g=y.indexOf(n.dataTime);g!==-1&&c[g].accuracyList.push(...n.accuracyList.map(u=>({...u,factoryName:u.factoryName+"中期"})))}),r=[...r,...s]}this.tableTypes.accuracy.head=r,c.forEach(s=>{x=x.concat(s.accuracyList)}),r.forEach(s=>{let n=x.filter(u=>u.factoryName===s),g={name:s,data:n.map(u=>u.value===0||u.value==="0"?null:u.value),type:"line",showSymbol:!0,connectNulls:!1};m.push(g)});let b=F({xAxis:y,yAxis:m});this.comProps2={beforeSetOptions(s){return s.grid.top="7%",s.grid.left="3%",s.grid.right="1%",s.grid.bottom="12%",s.legend={show:!0,top:0,icon:"circle",textStyle:{color:"#fff"},orient:"horizontal",formatter:n=>"准确率（"+n+"）"},s.dataZoom=[{type:"inside"},{type:"slider",moveHandleSize:0,handleSize:40,bottom:15,height:20,borderColor:"#fff",dataBackground:{lineStyle:{color:"rgb(255,255,255, 0)"},areaStyle:{color:"rgb(255,255,255, 0)"}}}],s},chartData:{unit:"%",xAxisData:b.xAxis.data,series:b.series.map((s,n)=>({name:s.name,noSmooth:!0,needDotted:!!s.lineStyle,color:["#E44948","#F2C96F","#94BC77","#4b9dff"][n],data:s.data}))}}}else this.noShortData=!0},getListData(){let i={},e=[],{data:t,head:a}=this.tableTypes[this.tableKey];t.forEach(l=>{for(let o=0;o<a.length;o++){let c=l[`${this.tableKey}List`][o]||{},y={dataTime:l.dataTime,["data"+[o]]:c.value,["name"+[o]]:c.factoryName};e.push(y)}i=e.reduce((o,c)=>Object.assign(o,c),{}),this.detailList.push(i)}),this.tableKey==="accuracy"&&(this.detailList=this.detailList.reverse())},xCompletion(){},disableSuperDate(i){return i<_(this.minTime)||i>_(this.maxTime)},disableSuperAccuDate(i){let e=i.format("YYYY-MM-DD");return new Date(e+" 23:59:59")<_(this.minAccuTime)||new Date(e+" 00:00:00")>_(this.maxAccuTime)},onDetail(i){this.detailList=[],this.superDetail=!0,this.tableKey=i,this.getListData()},onclose(){this.superDetail=!1},resize(){window.addEventListener("resize",()=>{f&&f.resize(),p&&p.resize()})},destorySuperEchart(){f&&f.dispose(),p&&p.dispose(),f=null,p=null}},beforeDestroy(){this.destorySuperEchart()},watch:{entityId:{handler(i){i&&this.initData()},immediate:!0}}};var M=function(){var e=this,t=e._self._c;return t("div",{ref:"wpbox",staticClass:"wind-power-box"},[e.isShowPower?t("div",{staticClass:"shortPowerBox"},[t("div",{staticClass:"shortPage"},[t("div",{staticClass:"superShort"},[t("div",{staticClass:"topBox"},[t("div",{staticClass:"title"},[t("img",{staticClass:"logo",attrs:{src:S}}),t("span",[e._v(e._s(e.isSuper?"超":"")+"短期预测")])]),t("div",{staticClass:"dateTime"},[t("span",[e._v("开始时间：")]),t("div",{staticStyle:{display:"inline-block",width:"320px"}},[t("SeaDatePicker",{attrs:{allowClear:!1,"disabled-date":e.disableSuperDate,locale:e.locale,showTime:{minuteStep:15,secondStep:60},value:e.superData,inputReadOnly:"",type:"range",valueFormat:"YYYY-MM-DD HH:mm:ss"},on:{change:function(a){return e._GetForecastData(...a)}}})],1),t("button",{staticClass:"btn",on:{click:function(a){return e.onDetail("prediction")}}},[e._v("明细")])]),e.noSuperData?t("div",{staticClass:"no_data"},[e._v("暂无数据")]):t("ChartByComm",{attrs:{cName:"LineChart",comProps:e.comProps1}})],1),t("div",{staticClass:"topBox bottomBox"},[t("div",{staticClass:"title"},[t("img",{staticClass:"logo",attrs:{src:S}}),t("span",[e._v(e._s(e.isSuper?"超":"中/")+"短期 - 准确率")])]),t("div",{staticClass:"dateTime"},[t("span",[e._v("开始时间：")]),t("div",{staticStyle:{display:"inline-block",width:"320px"}},[t("SeaDatePicker",{attrs:{"disabled-date":e.disableSuperAccuDate,locale:e.locale,value:e.accuracyDate,inputReadOnly:"",type:"range",valueFormat:"YYYY-MM-DD"},on:{change:function(a){return e._GetAccuracyData(...a)}}})],1),t("button",{staticClass:"btn",on:{click:function(a){return e.onDetail("accuracy")}}},[e._v("明细")])]),e.historyAverageTxt?t("div",{staticClass:"history_average"},[e._v(" 历史平均准确率："+e._s(e.historyAverageTxt)+" ")]):e._e(),e.noShortData?t("div",{staticClass:"no_data"},[e._v("暂无数据")]):t("ChartByComm",{attrs:{cName:"LineChart",comProps:e.comProps2}})],1)])])]):e._e(),e.superDetail?t("div",{staticClass:"detail_bg"},[t("div",{staticClass:"detailBox"},[t("div",{staticClass:"title"},[t("img",{staticClass:"logo",attrs:{src:S}}),t("span",[e._v("明细 - "+e._s(e.isSuper?"超":"")+"短期"+e._s(e.tableTypes[e.tableKey].name))]),t("img",{staticClass:"clone_icon",attrs:{src:k,alt:"关闭"},on:{click:e.onclose}})]),t("div",{staticClass:"detail_tab"},[t("table",[t("tr",{staticClass:"header"},[t("td",{staticClass:"time"},[e._v("时间")]),e._l(e.tableTypes[e.tableKey].head,function(a,l){return t("td",{key:l,staticClass:"accuracy_power1"},[e._v(" 预测功率（"+e._s(a)+"） ")])})],2),e._l(e.detailList,function(a,l){return t("tr",{key:l},[t("td",{staticClass:"time"},[e._v(" "+e._s(a.dataTime)+" ")]),e._l(e.tableTypes[e.tableKey].head,function(o,c){return t("td",{key:c,staticClass:"accuracy_power1"},[e._v(" "+e._s(a["data"+c]==="0.0"?"0%":a["data"+c]==0?"/":parseFloat(a["data"+c]).toFixed(2)+e.tableTypes[e.tableKey].unit)+" ")])})],2)})],2)])])]):e._e()])},E=[],H=A(B,M,E,!1,null,"46bd1b9e");const j=H.exports;export{j as W};
