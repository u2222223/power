/*!
 * Powered by uglifiyJS v2.6.1, Build by http://tool.uis.cc/jsmin/
 * build time: Tue Mar 07 2023 16:31:48 GMT+0800 (中国标准时间)
*/
var LMV=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(n,i,function(t){return e[t]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s="./src/index.js")}({"../workers/MainWorker-node":function(e,t){e.exports="DELETED_WORKERNODE"},"./extensions/DefaultTools/NavTools.js":function(e,t,r){"use strict";function n(e,t){o.Extension.call(this,e,t),this.name="navtools",this.modes=[g,v,y,_,b,x,w],this.onToolChanged=this.onToolChanged.bind(this),this.onNavigationModeChanged=this.onNavigationModeChanged.bind(this),this.navToolsConfig=t.navToolsConfig||{}}function i(e,t,r){return function(){e.isActive(r)?e.deactivate():e.activate(r)}}r.r(t),r.d(t,"NavToolsExtension",function(){return n});var o=r("./src/application/Extension.js"),s=r("./src/application/EventTypes.js"),a=(r.n(s),r("./src/gui/GuiViewerToolbarConst.js")),l=r("./src/gui/controls/ComboButton.js"),c=r("./src/gui/controls/Button.js"),u=r("./src/tools/FovTool.js"),d=r("./src/tools/WorldUpTool.js"),h=r("./src/globalization/i18next.js"),f=r("./src/gui/controls/RadioButtonGroup.js"),p=r("./src/compat.js"),m=r("./src/gui/HudMessage.js"),g="pan",v="dolly",y="freeorbit",_="orbit",b="fov",x="worldup",w="fittoview";n.prototype=Object.create(o.Extension.prototype),n.prototype.constructor=n;var E=n.prototype;E.load=function(){var e=this.viewer,t=new u.FovTool(e);if(e.toolController.registerTool(t),!this.navToolsConfig.isAECCameraControls){var r=new d.WorldUpTool(e.impl,e);e.toolController.registerTool(r)}return this.initFocalLengthOverlay(),e.addEventListener(s.TOOL_CHANGE_EVENT,this.onToolChanged),e.addEventListener(s.NAVIGATION_MODE_CHANGED_EVENT,this.onNavigationModeChanged),!0},E.updateUI=function(e){e!==this.is3d&&(this._destroyUI(),this._createUI(e))},E.onToolbarCreated=function(e){var t=this.viewer.model.is3d();this._createUI(t)},E.navActionDisplayMode=function(e){return this.viewer.navigation.isActionEnabled(e)?"block":"none"},E._createUI=function(e){var t=this.viewer,r=t.getToolbar(),n=r.getControl(a.TOOLBAR.NAVTOOLSID);if(e){var o=new l.ComboButton("toolbar-orbitTools");o.setToolTip("Orbit"),o.setIcon("adsk-icon-orbit-constrained"),o.setDisplay(this.navActionDisplayMode("orbit")),this.createOrbitSubmenu(o),n.addControl(o),n.orbittoolsbutton=o,o.setState(c.Button.State.ACTIVE),n.returnToDefault=function(){o.setState(c.Button.State.ACTIVE)}}var s=new c.Button("toolbar-panTool");s.setToolTip("Pan"),s.setIcon("adsk-icon-pan"),s.onClick=i(this,s,g),s.setDisplay(this.navActionDisplayMode("pan")),n.addControl(s),n.panbutton=s,e||(n.returnToDefault=function(){s.setState(c.Button.State.ACTIVE)},n.returnToDefault());var u=new c.Button("toolbar-zoomTool");if(u.setToolTip("Zoom"),u.setIcon("adsk-icon-zoom"),u.onClick=i(this,u,v),u.setDisplay(this.navActionDisplayMode("zoom")),n.addControl(u),n.dollybutton=u,this.navToolsConfig.isAECCameraControls)n.addControl(this.createFitViewButton(n));else{var d=new l.ComboButton("toolbar-cameraSubmenuTool");d.setToolTip("Camera interactions"),d.setIcon("adsk-icon-camera"),d.saveAsDefault(),this.createCameraSubmenu(d,e),n.addControl(d),n.camerabutton=d}this.is3d=e},E.createOrbitSubmenu=function(e){var t=this.viewer,r=t.getToolbar(),n=r.getControl(a.TOOLBAR.NAVTOOLSID),o=new c.Button("toolbar-freeOrbitTool");o.setToolTip("Free orbit"),o.setIcon("adsk-icon-orbit-free"),o.onClick=i(this,o,y),e.addControl(o),n.freeorbitbutton=o;var s=new c.Button("toolbar-orbitTool");s.setToolTip("Orbit"),s.setIcon("adsk-icon-orbit-constrained"),s.onClick=i(this,s,_),e.addControl(s),n.orbitbutton=s,e.onClick=s.onClick},E.createFitViewButton=function(e,t){var r=this.viewer,n=new c.Button("toolbar-fitToViewTool");return n.setToolTip("Fit to view"),n.setIcon("adsk-icon-fit-to-view"),n.onClick=function(e){r.impl.fitToView(r.impl.selector.getAggregateSelection());var n=r.getDefaultNavigationToolName();r.setActiveNavigationTool(n),t&&t.restoreDefault()},n.setDisplay(this.navActionDisplayMode("gotoview")),e.fittoviewbutton=n,n},E.createCameraSubmenu=function(e,t){var r=this,n=this.viewer,o=n.getToolbar(),s=o.getControl(a.TOOLBAR.NAVTOOLSID);if(Object(p.isTouchDevice)()){var l=new c.Button("toolbar-homeTool");l.setToolTip("Home"),l.setIcon("adsk-icon-home"),l.onClick=function(){n.navigation.setRequestHomeView(!0);var t=n.getDefaultNavigationToolName();r.activate(t),e.restoreDefault()},l.setDisplay(this.navActionDisplayMode("gotoview")),e.addControl(l),s.homebutton=l}if(e.addControl(this.createFitViewButton(s,e)),t){var u=new c.Button("toolbar-focalLengthTool");u.setToolTip("Focal length"),u.setIcon("adsk-icon-fov"),u.onClick=i(this,u,b),u.setDisplay(this.navActionDisplayMode("fov")),e.addControl(u),s.fovbutton=u}var d=new c.Button("toolbar-rollTool");d.setToolTip("Roll"),d.setIcon("adsk-icon-roll"),d.onClick=i(this,d,x),d.setDisplay(this.navActionDisplayMode("roll")),e.addControl(d),s.rollbutton=d},E.onToolChanged=function(e){if("fov"===e.toolName&&this.showFocalLengthOverlay(e.active),e.active)switch(e.toolName){case"dolly":this.handleAltRelease("dollybutton");break;case"pan":this.handleAltRelease("panbutton");break;case"worldup":this.handleAltRelease("rollbutton");break;case"fov":this.handleAltRelease("fovbutton")}},E.onNavigationModeChanged=function(e){var t=this.viewer.getDefaultNavigationToolName();if(t===e.id){var r=this.viewer.getToolbar();if(!r)return;var n=r.getControl(a.TOOLBAR.NAVTOOLSID);if(!n)return;n.returnToDefault&&n.returnToDefault()}},E.handleAltRelease=function(e){var t=this.viewer.getToolbar();if(t){var r=t.getControl(a.TOOLBAR.NAVTOOLSID),n=r&&r[e];n&&n.setState(c.Button.State.ACTIVE)}},E.initFocalLengthOverlay=function(){var e=this.getDocument(),t=this.focallength=e.createElement("div");t.classList.add("message-panel"),t.classList.add("docking-panel"),t.classList.add("focal-length"),t.classList.add("docking-panel-container-solid-color-b");var r=e.createElement("table"),n=e.createElement("tbody");r.appendChild(n),t.appendChild(r),this.viewer.container.appendChild(t);var i=n.insertRow(-1),o=i.insertCell(0);o.classList.add("name"),o.setAttribute("data-i18n","Focal Length"),o.textContent=h.i18n.translate("Focal Length"),o=i.insertCell(1),o.classList.add("value"),o.textContent="",this.fovCell=o,t.style.visibility="hidden"},E.showFocalLengthOverlay=function(e){function t(e){if(e){var t={msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic",messageDefaultValue:"The view is set to Orthographic. Changing the focal length will switch to Perspective."};m.HudMessage.displayMessage(a.container,t)}else m.HudMessage.dismiss()}function r(e){e&&n(),o.focallength&&(o.focallength.style.visibility=e?"visible":"hidden")}function n(){var e=a.getFocalLength();l!==e&&(l=e,o.fovCell.textContent=e.toString()+" mm")}function i(e){if(n(),"fov"===a.toolController.getActiveToolName()){var i=a.navigation.getCamera(),o=i&&!i.isPerspective;r(!o),t(o)}}var o=this,a=this.viewer,l=0,c=a.navigation.getCamera(),u=c&&!c.isPerspective;r(e&&!u),t(e&&u),e?a.addEventListener(s.CAMERA_CHANGE_EVENT,i):a.removeEventListener(s.CAMERA_CHANGE_EVENT,i)},E.unload=function(){return this._destroyUI(),!0},E._destroyUI=function(){function e(e){e&&(e.subMenu.removeEventListener(f.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,e.subMenuActiveButtonChangedHandler(i)),i.removeControl(e.getId()),e.onClick=null)}function t(e){e&&(i.removeControl(e.getId()),e.onClick=null)}var r=this.viewer,n=r.getToolbar();if(!n)return!0;var i=n.getControl(a.TOOLBAR.NAVTOOLSID);return i?(this.is3d&&(e(i.orbittoolsbutton),i.orbittoolsbutton=null,t(i.orbitbutton),i.orbitbutton=null,t(i.freeorbitbutton),i.freeorbitbutton=null,t(i.fovbutton),i.fovbutton=null),t(i.panbutton),i.panbutton=null,t(i.dollybutton),i.dollybutton=null,e(i.camerabutton),i.camerabutton=null,t(i.rollbutton),i.rollbutton=null,t(i.fittoviewbutton),i.fittoviewbutton=null,this.focallength&&(r.container.removeChild(this.focallength),this.focallength=null),r.removeEventListener(s.TOOL_CHANGE_EVENT,this.toolChangedHandler),this.toolChangedHandler=null,r.removeEventListener(s.NAVIGATION_MODE_CHANGED_EVENT,this.navChangedHandler),this.navChangedHandler=null,!0):!0},E.activate=function(e){if(this.isActive(e))return!1;if(e===w)return this.viewer.impl.fitToView(this.viewer.impl.selector.getAggregateSelection()),!0;if(-1!=this.modes.indexOf(e)){var t=this.viewer.getDefaultNavigationToolName();return-1===this.modes.indexOf(t)&&this.viewer.activateDefaultNavigationTools(this.viewer.model.is2d()),this.viewer.setActiveNavigationTool(e),!0}return!1},E.deactivate=function(){return this.viewer.setActiveNavigationTool(),!0},E.isActive=function(e){var t=this.viewer.getActiveNavigationTool();return t===e}},"./extensions/Explode/Explode.js":function(e,t,r){"use strict";function n(e,t){a.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="explode",this.deactivate=this.deactivate.bind(this),this._onExplode=this._onExplode.bind(this),this._slider=null,this._explodeButton=null,this._explodeSubmenu=null,this._tooltip=null}function i(e,t){var r=(Autodesk.Viewing.UI,e.viewer),n=new c.Button("toolbar-explodeTool");n.setIcon("adsk-icon-explode"),n.setToolTip("Explode model"),r.modelTools.addControl(n);var i,o='<div class="docking-panel docking-panel-container-solid-color-b explode-submenu" style="display:none"><input class="explode-slider" type="range" min="0" max="1" step="0.01" value="0"/></div>',s=Object(u.stringToDOM)(o),a=e.getDocument();Object(l.isIOSDevice)()?(i=a.querySelector("#toolbar-explodeTool").parentNode,s.classList.add("ios")):Object(l.isAndroidDevice)()?(i=a.querySelector("#toolbar-explodeTool").parentNode,s.classList.add("android")):i=n.container,i.appendChild(s);var h=s.querySelector(".explode-slider");h.addEventListener(l.isIE11?"change":"input",function(e){r.explode(h.value)}),l.isIE11&&(h.style["padding-top"]="0",h.style["padding-bottom"]="0",h.style["margin-top"]="10px"),s.onclick=function(e){e.stopPropagation()};var f=n.container.querySelector(".adsk-control-tooltip");n.onClick=function(t){e.isActive()?e.deactivate():(e.activate(),d.logger.track({category:"tool_changed",name:"explode"}))},e._slider=h,e._explodeButton=n,e._explodeSubmenu=s,e._tooltip=f,r.explodeSlider=h,r.explodeSubmenu=s}function o(e){var t=e.viewer;e._slider&&(e._explodeButton&&e._explodeButton.removeFromParent(),e._slider=null,e._explodeButton=null,e._explodeSubmenu=null,e._tooltip=null,t.explodeSlider=null,t.explodeSubmenu=null)}function s(e){e._slider.parentNode.style.display="none",e._tooltip.style.display=""}r.r(t),r.d(t,"ExplodeExtension",function(){return n});var a=r("./src/application/Extension.js"),l=r("./src/compat.js"),c=r("./src/gui/controls/Button.js"),u=r("./src/globals.js"),d=r("./src/logger/Logger.js"),h=r("./src/application/EventTypes.js"),f=(r.n(h),Autodesk.Viewing.Private);n.prototype=Object.create(a.Extension.prototype),n.prototype.constructor=n;var p=n.prototype;p.load=function(){return!0},p.unload=function(){return this.deactivate(),o(this),!0},p.onToolbarCreated=function(e){i(this,e)},p.activate=function(){if(this.isActive())return!0;if(!this._explodeSubmenu)return!1;this._explodeSubmenu.style.display="",this._explodeButton.setState(c.Button.State.ACTIVE),this._tooltip.style.display="none";var e=this.viewer.impl.getExplodeScale();return this._slider.value=e,this.viewer.addEventListener(h.EXPLODE_CHANGE_EVENT,this._onExplode),!0},p.deactivate=function(){return this.isActive()&&this._explodeSubmenu?(this._explodeButton.setState(c.Button.State.INACTIVE),s(this),this.viewer.explode(0),this.viewer.removeEventListener(h.EXPLODE_CHANGE_EVENT,this._onExplode),!0):!0},p.isActive=function(){return this._explodeSubmenu?"none"!==this._explodeSubmenu.style.display:!1},p.getScale=function(){return this.viewer.getExplodeScale()},p.setScale=function(e){return this.viewer.explode(e)},p.setStrategy=function(e){e!==this.getStrategy()&&this.viewer.prefs.set(f.Prefs3D.EXPLODE_STRATEGY,e)},p.getStrategy=function(){return this.viewer.prefs.get(f.Prefs3D.EXPLODE_STRATEGY)},p._onExplode=function(e){this._slider.value=e.scale},p.setUIEnabled=function(e){this._explodeButton&&(e?(this._explodeButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE),this._wasActive&&this.activate()):(this._wasActive=this.isActive(),s(this),this._explodeButton.setState(Autodesk.Viewing.UI.Button.State.DISABLED)))}},"./extensions/FullScreen/FullScreen.js":function(e,t,r){"use strict";function n(e,t){i.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="fullscreen"}r.r(t),r.d(t,"FullScreenExtension",function(){return n});var i=r("./src/application/Extension.js");n.prototype=Object.create(i.Extension.prototype),n.prototype.constructor=n;var o=n.prototype;o.activate=function(){return this.activeStatus||(this.viewer.nextScreenMode(),this.activeStatus=!0),!0},o.deactivate=function(){return this.activeStatus&&(this.viewer.escapeScreenMode(),this.activeStatus=!1),!0}},"./extensions/FusionOrbit/FusionOrbit.css":function(e,t,r){},"./extensions/FusionOrbit/FusionOrbit.js":function(e,t,r){"use strict";function n(e,t){i.Extension.call(this,e,t),this.name="fusionorbit",this.modes=["fusionorbit","fusionfreeorbit"]}r.r(t),r.d(t,"FusionOrbitExtension",function(){return n});var i=r("./src/application/Extension.js"),o=r("./src/gui/GuiViewerToolbarConst.js"),s=r("./src/gui/controls/Button.js"),a=r("./extensions/FusionOrbit/FusionOrbitTool.js"),l=r("./extensions/FusionOrbit/FusionOrbit.css");r.n(l);n.prototype=Object.create(i.Extension.prototype),n.prototype.constructor=n;var c=n.prototype;c.load=function(){var e=this.viewer;return this.tool=new a.FusionOrbitTool,this.tool.setViewer(e),e.toolController.registerTool(this.tool),!0},c.onToolbarCreated=function(e){var t=this,r=this.viewer,n=e.getControl(o.TOOLBAR.NAVTOOLSID);n&&n.orbitbutton&&(this.classicBehavior={},this.classicBehavior.orbitOnClick=n.orbitbutton.onClick,this.classicBehavior.freeorbitOnClick=n.freeorbitbutton.onClick,this.classicBehavior.returnToDefault=n.returnToDefault,n.freeorbitbutton.onClick=function(e){var r=n.freeorbitbutton.getState();r===s.Button.State.INACTIVE?(t.activate("fusionfreeorbit"),n.freeorbitbutton.setState(s.Button.State.ACTIVE)):r===s.Button.State.ACTIVE&&(t.deactivate(),n.freeorbitbutton.setState(s.Button.State.INACTIVE))},n.orbitbutton.onClick=function(e){var r=n.orbitbutton.getState();r===s.Button.State.INACTIVE?(t.activate("fusionorbit"),n.orbitbutton.setState(s.Button.State.ACTIVE)):r===s.Button.State.ACTIVE&&t.deactivate()},n.returnToDefault=function(){n.orbittoolsbutton&&n.orbittoolsbutton.setState(s.Button.State.ACTIVE)},n.orbittoolsbutton.setState(s.Button.State.INACTIVE),r.prefs.fusionOrbitConstrained?(n.orbittoolsbutton.onClick=n.orbitbutton.onClick,n.orbittoolsbutton.setIcon(n.orbitbutton.iconClass),r.setDefaultNavigationTool("orbit")):(n.orbittoolsbutton.onClick=n.freeorbitbutton.onClick,n.orbittoolsbutton.setIcon(n.freeorbitbutton.iconClass),r.setDefaultNavigationTool("freeorbit")),r.setActiveNavigationTool(),n.returnToDefault&&n.returnToDefault())},c.unload=function(){var e=this.viewer;if(this.classicBehavior){var t=e.getToolbar(),r=t.getControl(o.TOOLBAR.NAVTOOLSID);r&&(r.orbitbutton&&(r.orbitbutton.onClick=this.classicBehavior.orbitOnClick),r.freeorbitbutton&&(r.freeorbitbutton.onClick=this.classicBehavior.freeorbitOnClick),r.returnToDefault=this.classicBehavior.returnToDefault,r.orbittoolsbutton&&(r.orbitbutton?r.orbittoolsbutton.onClick=r.orbitbutton.onClick:r.orbittoolsbutton.onClick=null,r.orbittoolsbutton.setIcon("adsk-icon-orbit-constrained"),r.orbittoolsbutton.setState(s.Button.State.ACTIVE))),this.classicBehavior=null}return e.setActiveNavigationTool("orbit"),e.setDefaultNavigationTool("orbit"),e.toolController.deregisterTool(this.tool),this.tool.setViewer(null),this.tool=null,!0},c.activate=function(e){if(!this.activeStatus||this.mode!==e){switch(e){default:case"fusionorbit":this.viewer.setActiveNavigationTool("fusion orbit constrained"),this.mode="fusionorbit";break;case"fusionfreeorbit":this.viewer.setActiveNavigationTool("fusion orbit"),this.mode="fusionfreeorbit"}return this.activeStatus=!0,!0}},c.deactivate=function(){return this.activeStatus&&(this.viewer.setActiveNavigationTool(),this.activeStatus=!1),!0}},"./extensions/FusionOrbit/FusionOrbitTool.js":function(e,t,r){"use strict";function n(){var e,t,r,n,a,c=["fusion orbit","fusion orbit constrained"],u=.8,d=1.2,h="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto",f={HORIZONTAL:0,VERTICAL:1,ROLL:2},p={HORIZONTAL:.005,VERTICAL:.005,ROLL:1},m={},g=Object(o.isTouchDevice)(),v=!1,y={buttons:[],src:void 0,x:0,y:0,dx:0,dy:0,firstMove:!0,mode:void 0},_=this;this.setViewer=function(e){this.viewer=e,this.navapi=e?e.navigation:null,e&&this.setGlobalManager(e.globalManager)};var b=function(e){y.buttons[e.touches?0:e.button]=!0,y.src=e.target.className,y.x=0,y.y=0,y.dx=0,y.dy=0,y.firstMove=!0,y.mode=void 0,"ring"===y.src?y.mode=f.ROLL:"edgemark-area"===y.src&&("layout-ver"===e.target.parentNode.className?y.mode=f.HORIZONTAL:"layout-hor"===e.target.parentNode.className&&(y.mode=f.VERTICAL)),T(),e.stopPropagation()},x=function(e){y.buttons[e.touches?0:e.button]=!1,y.src=void 0},w=function(e){y.buttons[0]&&(E(e),S(),y.firstMove=!1)},E=function(e){var t=e.touches?e.touches[0].pageX:e.pageX,r=e.touches?e.touches[0].pageY:e.pageY;y.firstMove||(y.dx=t-y.x,y.dy=r-y.y),y.x=t,y.y=r},S=function(){switch(y.mode){case f.ROLL:if(!_.navapi.isActionEnabled("roll"))return;break;case f.HORIZONTAL:case f.VERTICAL:if(!_.navapi.isActionEnabled("orbit"))return}var e=a.target.clone().sub(a.position).normalize(),t=e.clone().cross(a.up).normalize(),r=t.clone().cross(e).normalize();if(a.up.copy(r),y.mode===f.ROLL){var i=new THREE.Vector3(y.x-m.center.x,y.y-m.center.y,0),o=new THREE.Vector3(y.dx,y.dy,0).add(i);i.normalize(),o.normalize();var l=i.clone().cross(o),c=Math.asin(l.z);a.up.applyAxisAngle(e,-c*p.ROLL)}else{var u,d;y.mode===f.HORIZONTAL?(d=-y.dx*p.HORIZONTAL,n&&(a.up=s.Navigation.snapToAxis(a.up.clone())),u=a.up):y.mode===f.VERTICAL&&(d=-y.dy*p.VERTICAL,n?(y.firstMove&&(a.up=s.Navigation.snapToAxis(a.up.clone())),u=e.clone().cross(a.up).normalize()):u=t,a.up.applyAxisAngle(u,d));var h=_.navapi.getPivotPoint(),g=a.position.clone().sub(h);g.applyAxisAngle(u,d),a.position.addVectors(h,g);var v=a.target.clone().sub(h);v.applyAxisAngle(u,d),a.target.addVectors(h,v)}a.dirty=!0},A=function(){var e=a.target.clone().sub(a.position).normalize(),t=_.viewer.impl.rayIntersect(new THREE.Ray(a.position,e));return t&&t.intersectPoint?t.intersectPoint:a.target},M=function(e,t){var r=t||e.clone().sub(a.position).normalize();return new THREE.Plane(r,-r.x*e.x-r.y*e.y-r.z*e.z)},T=function(){var e=a.target.clone().sub(a.position).normalize(),t=M(a.position,e),r=t.distanceToPoint(a.pivot);a.pivot.copy(e).multiplyScalar(r).add(a.position)},C=function(e){e.touches||0!==e.button||T()},j=function(e){v&&_.viewer.setActiveNavigationTool()},P=function(e,t){var r,n=_.viewer.impl.hitTest(e,t);if(n&&n.intersectPoint)r=n.intersectPoint;else{var i=_.viewer.impl.viewportToRay(_.viewer.impl.clientToViewport(e,t));r=i.intersectPlane(M(a.target))}var o=a.position.clone().sub(A()).add(r);_.navapi.setRequestTransition(!0,o,r,a.fov)};this.register=function(){e=Object(i.stringToDOM)(l),e.style.display="none",this.viewer.canvasWrap.insertBefore(e,this.viewer.canvasWrap.firstChild),t=e.querySelector(".ring"),t.addEventListener("mousedown",b),Array.prototype.forEach.call(e.querySelectorAll(".edgemark-area"),function(e,t){e.addEventListener("mousedown",b),g&&e.addEventListener("touchstart",b)}),this.addWindowEventListener("mouseup",x),this.addWindowEventListener("mousemove",w),r=e.querySelector(".outside"),r.addEventListener("mousedown",j);var n=e.querySelector(".circle");n.addEventListener("mousedown",C),g&&(t.addEventListener("touchstart",b),this.addWindowEventListener("touchend",x),this.addWindowEventListener("touchmove",w),r.addEventListener("touchstart",j),n.addEventListener("touchstart",C)),a=this.viewer.impl.camera},this.deregister=function(){this.removeWindowEventListener("mouseup",x),this.removeWindowEventListener("mousemove",w),r.removeEventListener("mousedown",j),g&&(this.removeWindowEventListener("touchend",x),this.removeWindowEventListener("touchmove",w),r.removeEventListener("touchstart",j)),this.viewer.canvasWrap.removeChild(e),e=void 0,t=void 0,r=void 0},this.activate=function(t){e.style.display="",this.handleResize(),n="fusion orbit constrained"===t;var r=this.viewer.toolController.isToolActivated("hyperlink");r&&this.viewer.toolController.deactivateTool("hyperlink"),n?(this.viewer.setDefaultNavigationTool("orbit"),this.viewer.prefs.set("fusionOrbitConstrained",!0)):(this.viewer.setDefaultNavigationTool("freeorbit"),this.viewer.prefs.set("fusionOrbitConstrained",!1)),r&&this.viewer.toolController.activateTool("hyperlink"),this.viewer.navigation.setZoomTowardsPivot(!0)},this.deactivate=function(t){e.style.display="none",this.viewer.navigation.setZoomTowardsPivot(this.viewer.prefs.zoomTowardsPivot)},this.getNames=function(){return c},this.getName=function(){return c[0]},this.update=function(){return!1},this.handleSingleClick=function(e,t){return P(e.canvasX,e.canvasY),!0},this.handleDoubleClick=function(e,t){return!0},this.handleSingleTap=function(e){return P(e.canvasX,e.canvasY),!0},this.handleDoubleTap=function(e){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(e){return!1},this.handleButtonDown=function(e,t){return!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(e){var t,n=this.viewer.impl.getCanvasBoundingClientRect();t=n.width>n.height?new THREE.Vector2(((e.canvasX+.5)/n.width*2-1)*n.width/n.height,2*-((e.canvasY+.5)/n.height)+1):new THREE.Vector2((e.canvasX+.5)/n.width*2-1,(2*-((e.canvasY+.5)/n.height)+1)*n.height/n.width);var i=t.length(),o=i>d;return v!==o&&(o?r.style.cursor="":r.style.cursor=h,v=o),!1},this.handleGesture=function(e){return T(),!1},this.handleBlur=function(e){return!1},this.handleResize=function(){var r=e.getBoundingClientRect(),n=this.getWindow();m.left=r.left+n.pageXOffset,m.top=r.top+n.pageYOffset,m.width=r.width,m.height=r.height,m.center={},m.center.x=m.left+m.width/2,m.center.y=m.top+m.height/2;var i=(n.innerWidth>n.innerHeight?n.innerHeight:n.innerWidth)*u;e.style.width=e.style.height=""+i+"px",e.style.top=e.style.left="calc(50% - "+i/2+"px)",t.style.borderWidth=""+.1*i+"px"}}r.r(t),r.d(t,"FusionOrbitTool",function(){return n});var i=r("./src/globals.js"),o=r("./src/compat.js"),s=r("./src/tools/Navigation.js"),a=Autodesk.Viewing,l=['<div class="orbit-gizmo noselect">','<div class="outside"></div>','<div class="ring"></div>','<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="layout-mid">','<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="circle">','<div class="crosshair-area">','<div class="crosshair-v"></div>','<div class="crosshair-h"></div>',"</div>","</div>",'<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>",'<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>"].join("\n");a.GlobalManagerMixin.call(n.prototype)},"./extensions/GoHome/GoHome.js":function(e,t,r){"use strict";function n(e,t){i.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="gohome"}r.r(t),r.d(t,"GoHomeExtension",function(){return n});var i=r("./src/application/Extension.js");n.prototype=Object.create(i.Extension.prototype),n.prototype.constructor=n;var o=n.prototype;o.activate=function(){return this.viewer.navigation.setRequestHomeView(!0),!0},o.deactivate=function(){return!1}},"./extensions/ModelStructure/ModelStructure.js":function(e,t,r){"use strict";function n(e,t){i.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="modelstructure",this._modelstructure=null,this._onLoadModel=this._onLoadModel.bind(this),this._onUnloadModel=this._onUnloadModel.bind(this)}r.r(t),r.d(t,"ModelStructureExtension",function(){return n});var i=r("./src/application/Extension.js"),o=r("./src/gui/ViewerModelStructurePanel.js"),s=r("./src/compat.js"),a=r("./src/gui/controls/Button.js"),l=r("./src/application/EventTypes.js");r.n(l);n.prototype=Object.create(i.Extension.prototype),n.prototype.constructor=n;var c=n.prototype;c.load=function(){return this.viewer.addEventListener(l.MODEL_ADDED_EVENT,this._onLoadModel),this.viewer.addEventListener(l.MODEL_ROOT_LOADED_EVENT,this._onLoadModel),this.viewer.addEventListener(l.MODEL_UNLOADED_EVENT,this._onUnloadModel),this.viewer.addEventListener(l.MODEL_REMOVED_EVENT,this._onUnloadModel),!0},c.unload=function(){return this.deactivate(),this.setModelStructurePanel(null),this._structureButton&&(this.viewer.settingsTools.removeControl(this._structureButton),this.viewer.settingsTools.structurebutton=null,this._structureButton=null),this.viewer.removeEventListener(l.MODEL_ADDED_EVENT,this._onLoadModel),this.viewer.removeEventListener(l.MODEL_ROOT_LOADED_EVENT,this._onLoadModel),this.viewer.removeEventListener(l.MODEL_UNLOADED_EVENT,this._onUnloadModel),this.viewer.removeEventListener(l.MODEL_REMOVED_EVENT,this._onUnloadModel),!0},c.onToolbarCreated=function(e){var t=this,r=new a.Button("toolbar-modelStructureTool");r.setToolTip("Model browser"),r.setIcon("adsk-icon-structure"),r.onClick=function(e){var r=!t._modelstructure.isVisible();r?t.activate():t.deactivate()};var n=this.viewer.settingsTools;n.addControl(r,{index:0}),n.structurebutton=r,this._structureButton=r,this.restoreDefaultPanel()},c.activate=function(){return this._modelstructure?(this._modelstructure.setVisible(!0),!0):!1},c.deactivate=function(){return this._modelstructure&&this._modelstructure.setVisible(!1),!0},c.isActive=function(){return this._modelstructure?this._modelstructure.isVisible():!1},c.setModelStructurePanel=function(e){var t=this;if(e===this._modelstructure)return!1;if(this._modelstructure&&(this._modelstructure.setVisible(!1),this.viewer.removePanel(this._modelstructure),this._modelstructure.uninitialize()),this._modelstructure=e,this.viewer.modelstructure=e,!e)return!0;this.viewer.addPanel(this._modelstructure);for(var r=this.viewer.impl.modelQueue().getModels(),n=0;n<r.length;++n)this._modelstructure.addModel(r[n]);return this._modelstructure.addVisibilityListener(function(e){e&&t.viewer.onPanelVisible(t._modelstructure),t._structureButton.setState(e?a.Button.State.ACTIVE:a.Button.State.INACTIVE)}),!0},c.restoreDefaultPanel=function(){var e=this.viewer.config,t={docStructureConfig:e.docStructureConfig,hideSearch:Object(s.isMobileDevice)(),excludeRoot:e.modelBrowserExcludeRoot,startCollapsed:e.modelBrowserStartCollapsed},r=e.defaultModelStructureTitle||"Browser",n=new o.ViewerModelStructurePanel(this.viewer,r,t);this.setModelStructurePanel(n)},c._onLoadModel=function(e){this._modelstructure&&this._modelstructure.addModel(e.model)},c._onUnloadModel=function(e){this._modelstructure&&this._modelstructure.unloadModel(e.model)}},"./extensions/PropertiesManager/PropertiesManager.js":function(e,t,r){"use strict";function n(e,t){i.Extension.call(this,e,t),this.name="propertiesmanager",this._panel=null,this._onIsolateEvent=this._onIsolateEvent.bind(this),this._onSelectionChangeEvent=this._onSelectionChangeEvent.bind(this),this._onPrefChange=this._onPrefChange.bind(this)}r.r(t),r.d(t,"PropertiesManagerExtension",function(){return n});var i=r("./src/application/Extension.js"),o=r("./src/gui/PropertyPanel.js"),s=r("./src/gui/ViewerPropertyPanel.js"),a=r("./src/gui/controls/Button.js"),l=r("./src/application/EventTypes.js"),c=(r.n(l),r("./src/application/PreferenceNames.js"));n.prototype=Object.create(i.Extension.prototype),n.prototype.constructor=n;var u=n.prototype;u.load=function(){return this.viewer.addEventListener(l.ISOLATE_EVENT,this._onIsolateEvent),this.viewer.addEventListener(l.AGGREGATE_SELECTION_CHANGED_EVENT,this._onSelectionChangeEvent),this.viewer.prefs.addListeners(c.Prefs.OPEN_PROPERTIES_ON_SELECT,this._onPrefChange),!0},u.unload=function(){this.viewer.removeEventListener(l.ISOLATE_EVENT,this._onIsolateEvent),this.viewer.removeEventListener(l.AGGREGATE_SELECTION_CHANGED_EVENT,this._onSelectionChangeEvent),this.viewer.prefs.removeListeners(c.Prefs.OPEN_PROPERTIES_ON_SELECT,this._onPrefChange),this.deactivate(),this.setPanel(null),this._toolbarButton&&(this.viewer.settingsTools.removeControl(this._toolbarButton),this.viewer.settingsTools.propertiesbutton=null,this._toolbarButton=null)},u.onToolbarCreated=function(e){this.setDefaultPanel(),this._addToolbarButton()},u.activate=function(){return this._panel?(this._panel.setVisible(!0),!0):!1},u.deactivate=function(){return this._panel&&this._panel.setVisible(!1),!0},u.isActive=function(){return this._panel?this._panel.isVisible():!1},u.setPanel=function(e){var t=this;return e instanceof o.PropertyPanel||!e?(this._panel&&(this._panel.setVisible(!1),this.viewer.removePanel(this._panel),this._panel.uninitialize()),this._panel=e,e&&(this.viewer.addPanel(e),e.addVisibilityListener(function(e){e&&t.viewer.onPanelVisible(t._panel),t._toolbarButton.setState(e?a.Button.State.ACTIVE:a.Button.State.INACTIVE)})),!0):!1},u.setDefaultPanel=function(){this.setPanel(new s.ViewerPropertyPanel(this.viewer))},u.getPanel=function(){return this._panel},u.getToolbarButton=function(){return this._toolbarButton},u._addToolbarButton=function(){var e=this;if(!this._toolbarButton){var t=this._toolbarButton=new a.Button("toolbar-propertiesTool");t.setToolTip("Properties"),t.setIcon("adsk-icon-properties"),t.onClick=function(t){e._panel.setVisible(!e._panel.isVisible())},t.setVisible(!this.viewer.prefs.openPropertiesOnSelect),this.viewer.settingsTools.addControl(t,{index:1}),this.viewer.settingsTools.propertiesbutton=t}},u._onIsolateEvent=function(e){this._panel&&(this.viewer.prefs.openPropertiesOnSelect||e.nodeIdArray[0]===e.model.getRootId())&&this._panel.setVisible(e.nodeIdArray.length>0||this.viewer.impl.selector.hasSelection())},u._onSelectionChangeEvent=function(e){if(this.viewer.prefs.openPropertiesOnSelect){for(var t=!1,r=0;r<e.selections.length;++r)if(e.selections[r].dbIdArray.length>0){t=!0;break}t?this.activate():this.deactivate()}},u._onPrefChange=function(e){this._toolbarButton&&this._toolbarButton.setVisible(!e)}},"./extensions/ViewerSettings/ViewerSettings.js":function(e,t,r){"use strict";function n(e,t){i.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="viewersettings"}r.r(t),r.d(t,"ViewerSettingsExtension",function(){
return n});var i=r("./src/application/Extension.js"),o=r("./src/gui/ViewerSettingsPanel.js");n.prototype=Object.create(i.Extension.prototype),n.prototype.constructor=n;var s=n.prototype;s.activate=function(){if(!this.activeStatus){this.viewer.showViewer3dOptions(!0);var e=this.viewer.getSettingsPanel(!0);e.selectTab(o.ViewerSettingTab.Performance),this.activeStatus=!0}return!0},s.deactivate=function(){return this.activeStatus&&(this.viewer.showViewer3dOptions(!1),this.activeStatus=!1),!0}},"./extensions/builtinExtensions.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/application/ExtensionManager.js"),i=r("./extensions/PropertiesManager/PropertiesManager.js"),o=r("./extensions/ViewerSettings/ViewerSettings.js"),s=r("./extensions/ModelStructure/ModelStructure.js"),a=r("./extensions/DefaultTools/NavTools.js"),l=r("./extensions/Explode/Explode.js"),c=r("./extensions/FullScreen/FullScreen.js"),u=r("./extensions/GoHome/GoHome.js"),d=r("./extensions/FusionOrbit/FusionOrbit.js");n.theExtensionManager.registerExtension("Autodesk.PropertiesManager",i.PropertiesManagerExtension),n.theExtensionManager.registerExtension("Autodesk.ViewerSettings",o.ViewerSettingsExtension),n.theExtensionManager.registerExtension("Autodesk.ModelStructure",s.ModelStructureExtension),n.theExtensionManager.registerExtension("Autodesk.DefaultTools.NavTools",a.NavToolsExtension),n.theExtensionManager.registerExtension("Autodesk.Explode",l.ExplodeExtension),n.theExtensionManager.registerExtension("Autodesk.FullScreen",c.FullScreenExtension),n.theExtensionManager.registerExtension("Autodesk.GoHome",u.GoHomeExtension),n.theExtensionManager.registerExtension("Autodesk.Viewing.FusionOrbit",d.FusionOrbitExtension)},"./extensions/externalExtensions.js":function(e,t){function r(e){var t=e.src.split("/")[2];return t}var n=[{src:"./extensions/Wireframes/Wireframes.js",ids:["Autodesk.Viewing.Wireframes"]},{src:"./extensions/ZoomWindow/ZoomWindow.js",ids:["Autodesk.Viewing.ZoomWindow"]},{src:"./extensions/AEC/LibraryExports.js",ids:["Autodesk.AEC.LevelsExtension","Autodesk.AEC.HyperlinkExtension","Autodesk.AEC.DropMeExtension","Autodesk.AEC.CanvasBookmarkExtension","Autodesk.AEC.Minimap3DExtension","Autodesk.AEC.LocationsExtension","Autodesk.AEC.Hypermodeling"]},{src:"./extensions/Pushpins/PushPinExtension.js",ids:["Autodesk.BIM360.Extension.PushPin"]},{src:"./extensions/Hyperlink/Hyperlink.js",ids:["Autodesk.Hyperlink"]},{src:"./extensions/Debug/Debug.js",ids:["Autodesk.Debug"]},{src:"./extensions/BimWalk/BimWalk.js",ids:["Autodesk.BimWalk"]},{src:"./extensions/Section/Section.js",ids:["Autodesk.Section"]},{src:"./extensions/CompGeom/index.js",ids:["Autodesk.CompGeom"]},{src:"./extensions/Snapping/index.js",ids:["Autodesk.Snapping"]},{src:"./extensions/Beeline/Beeline.js",ids:["Autodesk.Beeline"]},{src:"./extensions/FirstPerson/FirstPerson.js",ids:["Autodesk.FirstPerson"]},{src:"./extensions/webVR/webVR.js",ids:["Autodesk.Viewing.WebVR"]},{src:"./extensions/CAM360/CAM360.js",ids:["Autodesk.CAM360"]},{src:"./extensions/Collaboration/Collaboration.js",ids:["Autodesk.Viewing.Collaboration"]},{src:"./extensions/FusionSim/FusionSim.js",ids:["Autodesk.Fusion360.Simulation"]},{src:"./extensions/OMV/OMV.js",ids:["Autodesk.OMV"]},{src:"./extensions/SplitScreen/SplitScreen.js",ids:["Autodesk.SplitScreen"]},{src:"./extensions/CrossFadeEffects/CrossFadeEffects.js",ids:["Autodesk.CrossFadeEffects"]},{src:"./extensions/Edit2D/Edit2D.js",ids:["Autodesk.Edit2D"]},{src:"./extensions/VisualClusters/VisualClusters.js",ids:["Autodesk.VisualClusters"]},{src:"./extensions/Moldflow/Moldflow.js",ids:["Autodesk.Moldflow"]},{src:"./extensions/PixelCompare/PixelCompare.js",ids:["Autodesk.Viewing.PixelCompare"]},{src:"./extensions/ScalarisSimulation/ScalarisSimulation.js",ids:["Autodesk.Viewing.ScalarisSimulation"]},{src:"./extensions/Measure/Measure.js",ids:["Autodesk.Measure"]},{src:"./extensions/Markup/Markup.js",ids:["Autodesk.Viewing.MarkupsCore","Autodesk.Viewing.MarkupsGui"]},{src:"./extensions/PDF/index.js",ids:["Autodesk.PDF"]},{src:"./extensions/ReCap/index.js",ids:["Autodesk.ReCap"]},{src:"./extensions/Scalaris/index.js",ids:["Autodesk.Scalaris"]},{src:"./extensions/DocumentBrowser/index.js",ids:["Autodesk.DocumentBrowser"]},{src:"./extensions/Geolocation/index.js",ids:["Autodesk.Geolocation"]},{src:"./extensions/Fusion360/AnimationExtension.js",ids:["Autodesk.Fusion360.Animation"]},{src:"./extensions/NPR/index.js",ids:["Autodesk.NPR"]},{src:"./extensions/MSDF/index.js",ids:["Autodesk.MSDF"]},{src:"./extensions/MemoryLimited/MemoryLimited.js",ids:["Autodesk.MemoryLimited"]},{src:"./extensions/ViewCubeUi/ViewCubeUi.js",ids:["Autodesk.ViewCubeUi"]},{src:"./extensions/MemoryLimitedDebug/MemoryManager.js",ids:["Autodesk.Viewing.MemoryLimitedDebug"]},{src:"./extensions/BimMarkups/BimMarkups.js",ids:["Autodesk.BIM360.Markups"]},{src:"./extensions/Minimap2D/Minimap2D.js",ids:["Autodesk.BIM360.Minimap"]},{src:"./extensions/GestureDocumentNavigation/GestureDocumentNavigation.js",ids:["Autodesk.BIM360.GestureDocumentNavigation"]},{src:"./extensions/RollCamera/RollCamera.js",ids:["Autodesk.BIM360.RollCamera"]},{src:"./extensions/LayerManager/LayerManager.js",ids:["Autodesk.LayerManager"]},{src:"./extensions/SceneBuilder/sceneBuilder.js",ids:["Autodesk.Viewing.SceneBuilder"]},{src:"./extensions/Popout/index.js",ids:["Autodesk.Viewing.Popout"]},{src:"./extensions/ProfileUi/index.js",ids:["Autodesk.ProfileUi"]},{src:"./extensions/PropertySearch/PropertySearch.js",ids:["Autodesk.PropertySearch"]},{src:"./extensions/StandardSurface/index.js",ids:["Autodesk.StandardSurface"]},{src:"./extensions/MaterialConverterPrism/index.js",ids:["Autodesk.Viewing.MaterialConverterPrism"]},{src:"./extensions/DWF/index.js",ids:["Autodesk.DWF"]},{src:"./extensions/ModelsPanel/index.js",ids:["Autodesk.ModelsPanel"]},{src:"./extensions/ModelAlignment/ModelAlignment.js",ids:["Autodesk.ModelAlignment"]}];e.exports={externalExtensions:n,getExtensionEntryKey:r}},"./extensions/registerExternalExtensions.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/application/ExtensionManager.js"),i=r("./extensions/externalExtensions.js"),o=(r.n(i),"js");i.externalExtensions.forEach(function(e){var t=Object(i.getExtensionEntryKey)(e),r="extensions/".concat(t,"/").concat(t,".").concat(o);e.ids.forEach(function(e){n.theExtensionManager.registerExternalExtension(e,r)})}),n.theExtensionManager.registerExternalExtension("Autodesk.DiffTool","extensions/DiffTool/DiffTool.".concat(o))},"./node_modules/clusterize.js/clusterize.js":function(e,t,r){!function(t,r){e.exports=r()}("Clusterize",function(){"use strict";function e(e,t,r){return t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent("on"+e,r)}function t(e,t,r){return t.removeEventListener?t.removeEventListener(e,r,!1):t.detachEvent("on"+e,r)}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e,t){return window.getComputedStyle?window.getComputedStyle(t)[e]:t.currentStyle[e]}var i=function(){for(var e=3,t=document.createElement("b"),r=t.all||[];t.innerHTML="<!--[if gt IE "+ ++e+"]><i><![endif]-->",r[0];);return e>4?e:document.documentMode}(),o=navigator.platform.toLowerCase().indexOf("mac")+1,s=function(n){if(!(this instanceof s))return new s(n);var i=this,a={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:"clusterize-no-data",no_data_text:"No data",keep_parity:!0,callbacks:{}};i.options={};for(var l,c=["rows_in_block","blocks_in_cluster","show_no_data_row","no_data_class","no_data_text","keep_parity","tag","callbacks"],u=0;l=c[u];u++)i.options[l]="undefined"!=typeof n[l]&&null!=n[l]?n[l]:a[l];for(var d,h=["scroll","content"],u=0;d=h[u];u++)if(i[d+"_elem"]=n[d+"Id"]?document.getElementById(n[d+"Id"]):n[d+"Elem"],!i[d+"_elem"])throw new Error("Error! Could not find "+d+" element");i.content_elem.hasAttribute("tabindex")||i.content_elem.setAttribute("tabindex",0);var f=r(n.rows)?n.rows:i.fetchMarkup(),p={},m=i.scroll_elem.scrollTop;i.insertToDOM(f,p),i.scroll_elem.scrollTop=m;var g=!1,v=0,y=!1,_=function(){o&&(y||(i.content_elem.style.pointerEvents="none"),y=!0,clearTimeout(v),v=setTimeout(function(){i.content_elem.style.pointerEvents="auto",y=!1},50)),g!=(g=i.getClusterNum())&&i.insertToDOM(f,p),i.options.callbacks.scrollingProgress&&i.options.callbacks.scrollingProgress(i.getScrollProgress())},b=0,x=function(){clearTimeout(b),b=setTimeout(i.refresh,100)};e("scroll",i.scroll_elem,_),e("resize",window,x),i.destroy=function(e){t("scroll",i.scroll_elem,_),t("resize",window,x),i.html((e?i.generateEmptyRow():f).join(""))},i.refresh=function(e){(i.getRowsHeight(f)||e)&&i.update(f)},i.update=function(e){f=r(e)?e:[];var t=i.scroll_elem.scrollTop;f.length*i.options.item_height<t&&(i.scroll_elem.scrollTop=0,g=0),i.insertToDOM(f,p),i.scroll_elem.scrollTop=t},i.clear=function(){i.update([])},i.getRowsAmount=function(){return f.length},i.getScrollProgress=function(){return this.options.scroll_top/(f.length*this.options.item_height)*100||0};var w=function(e,t){var n=r(t)?t:[];n.length&&(f="append"==e?f.concat(n):n.concat(f),i.insertToDOM(f,p))};i.append=function(e){w("append",e)},i.prepend=function(e){w("prepend",e)}};return s.prototype={constructor:s,fetchMarkup:function(){for(var e=[],t=this.getChildNodes(this.content_elem);t.length;)e.push(t.shift().outerHTML);return e},exploreEnvironment:function(e,t){var r=this.options;r.content_tag=this.content_elem.tagName.toLowerCase(),e.length&&(i&&9>=i&&!r.tag&&(r.tag=e[0].match(/<([^>\s/]*)/)[1].toLowerCase()),this.content_elem.children.length<=1&&(t.data=this.html(e[0]+e[0]+e[0])),r.tag||(r.tag=this.content_elem.children[0].tagName.toLowerCase()),this.getRowsHeight(e))},getRowsHeight:function(e){var t=this.options,r=t.item_height;if(t.cluster_height=0,e.length){var i=this.content_elem.children;if(i.length){var o=i[Math.floor(i.length/2)];if(t.item_height=o.offsetHeight,"tr"==t.tag&&"collapse"!=n("borderCollapse",this.content_elem)&&(t.item_height+=parseInt(n("borderSpacing",this.content_elem),10)||0),"tr"!=t.tag){var s=parseInt(n("marginTop",o),10)||0,a=parseInt(n("marginBottom",o),10)||0;t.item_height+=Math.max(s,a)}return t.block_height=t.item_height*t.rows_in_block,t.rows_in_cluster=t.blocks_in_cluster*t.rows_in_block,t.cluster_height=t.blocks_in_cluster*t.block_height,r!=t.item_height}}},getClusterNum:function(){return this.options.scroll_top=this.scroll_elem.scrollTop,Math.floor(this.options.scroll_top/(this.options.cluster_height-this.options.block_height))||0},generateEmptyRow:function(){var e=this.options;if(!e.tag||!e.show_no_data_row)return[];var t,r=document.createElement(e.tag),n=document.createTextNode(e.no_data_text);return r.className=e.no_data_class,"tr"==e.tag&&(t=document.createElement("td"),t.colSpan=100,t.appendChild(n)),r.appendChild(t||n),[r.outerHTML]},generate:function(e,t){var r=this.options,n=e.length;if(n<r.rows_in_block)return{top_offset:0,bottom_offset:0,rows_above:0,rows:n?e:this.generateEmptyRow()};var i=Math.max((r.rows_in_cluster-r.rows_in_block)*t,0),o=i+r.rows_in_cluster,s=Math.max(i*r.item_height,0),a=Math.max((n-o)*r.item_height,0),l=[],c=i;1>s&&c++;for(var u=i;o>u;u++)e[u]&&l.push(e[u]);return{top_offset:s,bottom_offset:a,rows_above:c,rows:l}},renderExtraTag:function(e,t){var r=document.createElement(this.options.tag),n="clusterize-";return r.className=[n+"extra-row",n+e].join(" "),t&&(r.style.height=t+"px"),r.outerHTML},insertToDOM:function(e,t){this.options.cluster_height||this.exploreEnvironment(e,t);var r=this.generate(e,this.getClusterNum()),n=r.rows.join(""),i=this.checkChanges("data",n,t),o=this.checkChanges("top",r.top_offset,t),s=this.checkChanges("bottom",r.bottom_offset,t),a=this.options.callbacks,l=[];i||o?(r.top_offset&&(this.options.keep_parity&&l.push(this.renderExtraTag("keep-parity")),l.push(this.renderExtraTag("top-space",r.top_offset))),l.push(n),r.bottom_offset&&l.push(this.renderExtraTag("bottom-space",r.bottom_offset)),a.clusterWillChange&&a.clusterWillChange(),this.html(l.join("")),"ol"==this.options.content_tag&&this.content_elem.setAttribute("start",r.rows_above),this.content_elem.style["counter-increment"]="clusterize-counter "+(r.rows_above-1),a.clusterChanged&&a.clusterChanged()):s&&(this.content_elem.lastChild.style.height=r.bottom_offset+"px")},html:function(e){var t=this.content_elem;if(i&&9>=i&&"tr"==this.options.tag){var r,n=document.createElement("div");for(n.innerHTML="<table><tbody>"+e+"</tbody></table>";r=t.lastChild;)t.removeChild(r);for(var o=this.getChildNodes(n.firstChild.firstChild);o.length;)t.appendChild(o.shift())}else t.innerHTML=e},getChildNodes:function(e){for(var t=e.children,r=[],n=0,i=t.length;i>n;n++)r.push(t[n]);return r},checkChanges:function(e,t,r){var n=t!=r[e];return r[e]=t,n}},s})},"./node_modules/core-js/internals/a-function.js":function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},"./node_modules/core-js/internals/a-possible-prototype.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-object.js");e.exports=function(e){if(!n(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},"./node_modules/core-js/internals/add-to-unscopables.js":function(e,t,r){var n=r("./node_modules/core-js/internals/well-known-symbol.js"),i=r("./node_modules/core-js/internals/object-create.js"),o=r("./node_modules/core-js/internals/object-define-property.js"),s=n("unscopables"),a=Array.prototype;void 0==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),e.exports=function(e){a[s][e]=!0}},"./node_modules/core-js/internals/advance-string-index.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/string-multibyte.js").charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},"./node_modules/core-js/internals/an-instance.js":function(e,t){e.exports=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e}},"./node_modules/core-js/internals/an-object.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-object.js");e.exports=function(e){if(!n(e))throw TypeError(String(e)+" is not an object");return e}},"./node_modules/core-js/internals/array-buffer-native.js":function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},"./node_modules/core-js/internals/array-buffer-view-core.js":function(e,t,r){"use strict";var n,i=r("./node_modules/core-js/internals/array-buffer-native.js"),o=r("./node_modules/core-js/internals/descriptors.js"),s=r("./node_modules/core-js/internals/global.js"),a=r("./node_modules/core-js/internals/is-object.js"),l=r("./node_modules/core-js/internals/has.js"),c=r("./node_modules/core-js/internals/classof.js"),u=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),d=r("./node_modules/core-js/internals/redefine.js"),h=r("./node_modules/core-js/internals/object-define-property.js").f,f=r("./node_modules/core-js/internals/object-get-prototype-of.js"),p=r("./node_modules/core-js/internals/object-set-prototype-of.js"),m=r("./node_modules/core-js/internals/well-known-symbol.js"),g=r("./node_modules/core-js/internals/uid.js"),v=s.Int8Array,y=v&&v.prototype,_=s.Uint8ClampedArray,b=_&&_.prototype,x=v&&f(v),w=y&&f(y),E=Object.prototype,S=E.isPrototypeOf,A=m("toStringTag"),M=g("TYPED_ARRAY_TAG"),T=i&&!!p&&"Opera"!==c(s.opera),C=!1,j={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},P=function(e){var t=c(e);return"DataView"===t||l(j,t)},L=function(e){return a(e)&&l(j,c(e))},D=function(e){if(L(e))return e;throw TypeError("Target is not a typed array")},I=function(e){if(p){if(S.call(x,e))return e}else for(var t in j)if(l(j,n)){var r=s[t];if(r&&(e===r||S.call(r,e)))return e}throw TypeError("Target is not a typed array constructor")},R=function(e,t,r){if(o){if(r)for(var n in j){var i=s[n];i&&l(i.prototype,e)&&delete i.prototype[e]}(!w[e]||r)&&d(w,e,r?t:T&&y[e]||t)}},O=function(e,t,r){var n,i;if(o){if(p){if(r)for(n in j)i=s[n],i&&l(i,e)&&delete i[e];if(x[e]&&!r)return;try{return d(x,e,r?t:T&&v[e]||t)}catch(a){}}for(n in j)i=s[n],!i||i[e]&&!r||d(i,e,t)}};for(n in j)s[n]||(T=!1);if((!T||"function"!=typeof x||x===Function.prototype)&&(x=function(){throw TypeError("Incorrect invocation")},T))for(n in j)s[n]&&p(s[n],x);if((!T||!w||w===E)&&(w=x.prototype,T))for(n in j)s[n]&&p(s[n].prototype,w);if(T&&f(b)!==w&&p(b,w),o&&!l(w,A)){C=!0,h(w,A,{get:function(){return a(this)?this[M]:void 0}});for(n in j)s[n]&&u(s[n],M,n)}e.exports={NATIVE_ARRAY_BUFFER_VIEWS:T,TYPED_ARRAY_TAG:C&&M,aTypedArray:D,aTypedArrayConstructor:I,exportTypedArrayMethod:R,exportTypedArrayStaticMethod:O,isView:P,isTypedArray:L,TypedArray:x,TypedArrayPrototype:w}},"./node_modules/core-js/internals/array-buffer.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/array-buffer-native.js"),s=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),a=r("./node_modules/core-js/internals/redefine-all.js"),l=r("./node_modules/core-js/internals/fails.js"),c=r("./node_modules/core-js/internals/an-instance.js"),u=r("./node_modules/core-js/internals/to-integer.js"),d=r("./node_modules/core-js/internals/to-length.js"),h=r("./node_modules/core-js/internals/to-index.js"),f=r("./node_modules/core-js/internals/ieee754.js"),p=r("./node_modules/core-js/internals/object-get-prototype-of.js"),m=r("./node_modules/core-js/internals/object-set-prototype-of.js"),g=r("./node_modules/core-js/internals/object-get-own-property-names.js").f,v=r("./node_modules/core-js/internals/object-define-property.js").f,y=r("./node_modules/core-js/internals/array-fill.js"),_=r("./node_modules/core-js/internals/set-to-string-tag.js"),b=r("./node_modules/core-js/internals/internal-state.js"),x=b.get,w=b.set,E="ArrayBuffer",S="DataView",A="prototype",M="Wrong length",T="Wrong index",C=n[E],j=C,P=n[S],L=P&&P[A],D=Object.prototype,I=n.RangeError,R=f.pack,O=f.unpack,k=function(e){return[255&e]},N=function(e){return[255&e,e>>8&255]},F=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},V=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},U=function(e){return R(e,23,4)},B=function(e){return R(e,52,8)},z=function(e,t){v(e[A],t,{get:function(){return x(this)[t]}})},G=function(e,t,r,n){var i=h(r),o=x(e);if(i+t>o.byteLength)throw I(T);var s=x(o.buffer).bytes,a=i+o.byteOffset,l=s.slice(a,a+t);return n?l:l.reverse()},H=function(e,t,r,n,i,o){var s=h(r),a=x(e);if(s+t>a.byteLength)throw I(T);for(var l=x(a.buffer).bytes,c=s+a.byteOffset,u=n(+i),d=0;t>d;d++)l[c+d]=u[o?d:t-d-1]};if(o){if(!l(function(){C(1)})||!l(function(){new C(-1)})||l(function(){return new C,new C(1.5),new C(NaN),C.name!=E})){j=function(e){return c(this,j),new C(h(e))};for(var W,q=j[A]=C[A],X=g(C),Y=0;X.length>Y;)(W=X[Y++])in j||s(j,W,C[W]);q.constructor=j}m&&p(L)!==D&&m(L,D);var K=new P(new j(2)),Q=L.setInt8;K.setInt8(0,2147483648),K.setInt8(1,2147483649),(K.getInt8(0)||!K.getInt8(1))&&a(L,{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},{unsafe:!0})}else j=function(e){c(this,j,E);var t=h(e);w(this,{bytes:y.call(new Array(t),0),byteLength:t}),i||(this.byteLength=t)},P=function(e,t,r){c(this,P,S),c(e,j,S);var n=x(e).byteLength,o=u(t);if(0>o||o>n)throw I("Wrong offset");if(r=void 0===r?n-o:d(r),o+r>n)throw I(M);w(this,{buffer:e,byteLength:r,byteOffset:o}),i||(this.buffer=e,this.byteLength=r,this.byteOffset=o)},i&&(z(j,"byteLength"),z(P,"buffer"),z(P,"byteLength"),z(P,"byteOffset")),a(P[A],{getInt8:function(e){return G(this,1,e)[0]<<24>>24},getUint8:function(e){return G(this,1,e)[0]},getInt16:function(e){var t=G(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=G(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return V(G(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return V(G(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return O(G(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return O(G(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){H(this,1,e,k,t)},setUint8:function(e,t){H(this,1,e,k,t)},setInt16:function(e,t){H(this,2,e,N,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){H(this,2,e,N,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){H(this,4,e,F,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){H(this,4,e,F,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){H(this,4,e,U,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){H(this,8,e,B,t,arguments.length>2?arguments[2]:void 0)}});_(j,E),_(P,S),e.exports={ArrayBuffer:j,DataView:P}},"./node_modules/core-js/internals/array-copy-within.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/to-object.js"),i=r("./node_modules/core-js/internals/to-absolute-index.js"),o=r("./node_modules/core-js/internals/to-length.js"),s=Math.min;e.exports=[].copyWithin||function(e,t){var r=n(this),a=o(r.length),l=i(e,a),c=i(t,a),u=arguments.length>2?arguments[2]:void 0,d=s((void 0===u?a:i(u,a))-c,a-l),h=1;for(l>c&&c+d>l&&(h=-1,c+=d-1,l+=d-1);d-- >0;)c in r?r[l]=r[c]:delete r[l],l+=h,c+=h;return r}},"./node_modules/core-js/internals/array-fill.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/to-object.js"),i=r("./node_modules/core-js/internals/to-absolute-index.js"),o=r("./node_modules/core-js/internals/to-length.js");e.exports=function(e){for(var t=n(this),r=o(t.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,r),l=s>2?arguments[2]:void 0,c=void 0===l?r:i(l,r);c>a;)t[a++]=e;return t}},"./node_modules/core-js/internals/array-for-each.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-iteration.js").forEach,i=r("./node_modules/core-js/internals/array-method-is-strict.js"),o=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),s=i("forEach"),a=o("forEach");e.exports=s&&a?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},"./node_modules/core-js/internals/array-from.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/function-bind-context.js"),i=r("./node_modules/core-js/internals/to-object.js"),o=r("./node_modules/core-js/internals/call-with-safe-iteration-closing.js"),s=r("./node_modules/core-js/internals/is-array-iterator-method.js"),a=r("./node_modules/core-js/internals/to-length.js"),l=r("./node_modules/core-js/internals/create-property.js"),c=r("./node_modules/core-js/internals/get-iterator-method.js");e.exports=function(e){var t,r,u,d,h,f,p=i(e),m="function"==typeof this?this:Array,g=arguments.length,v=g>1?arguments[1]:void 0,y=void 0!==v,_=c(p),b=0;if(y&&(v=n(v,g>2?arguments[2]:void 0,2)),void 0==_||m==Array&&s(_))for(t=a(p.length),r=new m(t);t>b;b++)f=y?v(p[b],b):p[b],l(r,b,f);else for(d=_.call(p),h=d.next,r=new m;!(u=h.call(d)).done;b++)f=y?o(d,v,[u.value,b],!0):u.value,l(r,b,f);return r.length=b,r}},"./node_modules/core-js/internals/array-includes.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-indexed-object.js"),i=r("./node_modules/core-js/internals/to-length.js"),o=r("./node_modules/core-js/internals/to-absolute-index.js"),s=function(e){return function(t,r,s){var a,l=n(t),c=i(l.length),u=o(s,c);if(e&&r!=r){for(;c>u;)if(a=l[u++],a!=a)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===r)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},"./node_modules/core-js/internals/array-iteration.js":function(e,t,r){var n=r("./node_modules/core-js/internals/function-bind-context.js"),i=r("./node_modules/core-js/internals/indexed-object.js"),o=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/to-length.js"),a=r("./node_modules/core-js/internals/array-species-create.js"),l=[].push,c=function(e){var t=1==e,r=2==e,c=3==e,u=4==e,d=6==e,h=5==e||d;return function(f,p,m,g){for(var v,y,_=o(f),b=i(_),x=n(p,m,3),w=s(b.length),E=0,S=g||a,A=t?S(f,w):r?S(f,0):void 0;w>E;E++)if((h||E in b)&&(v=b[E],y=x(v,E,_),e))if(t)A[E]=y;else if(y)switch(e){case 3:return!0;case 5:return v;case 6:return E;case 2:l.call(A,v)}else if(u)return!1;return d?-1:c||u?u:A}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},"./node_modules/core-js/internals/array-last-index-of.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/to-indexed-object.js"),i=r("./node_modules/core-js/internals/to-integer.js"),o=r("./node_modules/core-js/internals/to-length.js"),s=r("./node_modules/core-js/internals/array-method-is-strict.js"),a=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),l=Math.min,c=[].lastIndexOf,u=!!c&&1/[1].lastIndexOf(1,-0)<0,d=s("lastIndexOf"),h=a("indexOf",{ACCESSORS:!0,1:0}),f=u||!d||!h;e.exports=f?function(e){if(u)return c.apply(this,arguments)||0;var t=n(this),r=o(t.length),s=r-1;for(arguments.length>1&&(s=l(s,i(arguments[1]))),0>s&&(s=r+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:c},"./node_modules/core-js/internals/array-method-has-species-support.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js"),i=r("./node_modules/core-js/internals/well-known-symbol.js"),o=r("./node_modules/core-js/internals/engine-v8-version.js"),s=i("species");e.exports=function(e){return o>=51||!n(function(){var t=[],r=t.constructor={};return r[s]=function(){return{foo:1}},1!==t[e](Boolean).foo})}},"./node_modules/core-js/internals/array-method-is-strict.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/fails.js");e.exports=function(e,t){var r=[][e];return!!r&&n(function(){r.call(null,t||function(){throw 1},1)})}},"./node_modules/core-js/internals/array-method-uses-to-length.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/has.js"),s=Object.defineProperty,a={},l=function(e){throw e};e.exports=function(e,t){if(o(a,e))return a[e];t||(t={});var r=[][e],c=o(t,"ACCESSORS")?t.ACCESSORS:!1,u=o(t,0)?t[0]:l,d=o(t,1)?t[1]:void 0;return a[e]=!!r&&!i(function(){if(c&&!n)return!0;var e={length:-1};c?s(e,1,{enumerable:!0,get:l}):e[1]=1,r.call(e,u,d)})}},"./node_modules/core-js/internals/array-reduce.js":function(e,t,r){var n=r("./node_modules/core-js/internals/a-function.js"),i=r("./node_modules/core-js/internals/to-object.js"),o=r("./node_modules/core-js/internals/indexed-object.js"),s=r("./node_modules/core-js/internals/to-length.js"),a=function(e){return function(t,r,a,l){n(r);var c=i(t),u=o(c),d=s(c.length),h=e?d-1:0,f=e?-1:1;if(2>a)for(;;){if(h in u){l=u[h],h+=f;break}if(h+=f,e?0>h:h>=d)throw TypeError("Reduce of empty array with no initial value")}for(;e?h>=0:d>h;h+=f)h in u&&(l=r(l,u[h],h,c));return l}};e.exports={left:a(!1),right:a(!0)}},"./node_modules/core-js/internals/array-species-create.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-object.js"),i=r("./node_modules/core-js/internals/is-array.js"),o=r("./node_modules/core-js/internals/well-known-symbol.js"),s=o("species");e.exports=function(e,t){var r;return i(e)&&(r=e.constructor,"function"!=typeof r||r!==Array&&!i(r.prototype)?n(r)&&(r=r[s],null===r&&(r=void 0)):r=void 0),new(void 0===r?Array:r)(0===t?0:t)}},"./node_modules/core-js/internals/call-with-safe-iteration-closing.js":function(e,t,r){var n=r("./node_modules/core-js/internals/an-object.js");e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(o){var s=e["return"];throw void 0!==s&&n(s.call(e)),o}}},"./node_modules/core-js/internals/check-correctness-of-iteration.js":function(e,t,r){var n=r("./node_modules/core-js/internals/well-known-symbol.js"),i=n("iterator"),o=!1;try{var s=0,a={next:function(){return{done:!!s++}},"return":function(){o=!0}};a[i]=function(){return this},Array.from(a,function(){throw 2})}catch(l){}e.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var n={};n[i]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(s){}return r}},"./node_modules/core-js/internals/classof-raw.js":function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},"./node_modules/core-js/internals/classof.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-string-tag-support.js"),i=r("./node_modules/core-js/internals/classof-raw.js"),o=r("./node_modules/core-js/internals/well-known-symbol.js"),s=o("toStringTag"),a="Arguments"==i(function(){return arguments}()),l=function(e,t){try{return e[t]}catch(r){}};e.exports=n?i:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=l(t=Object(e),s))?r:a?i(t):"Object"==(n=i(t))&&"function"==typeof t.callee?"Arguments":n}},"./node_modules/core-js/internals/collection-add-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/an-object.js"),i=r("./node_modules/core-js/internals/a-function.js");e.exports=function(){for(var e=n(this),t=i(e.add),r=0,o=arguments.length;o>r;r++)t.call(e,arguments[r]);return e}},"./node_modules/core-js/internals/collection-delete-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/an-object.js"),i=r("./node_modules/core-js/internals/a-function.js");e.exports=function(){for(var e,t=n(this),r=i(t["delete"]),o=!0,s=0,a=arguments.length;a>s;s++)e=r.call(t,arguments[s]),o=o&&e;return!!o}},"./node_modules/core-js/internals/collection-from.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/a-function.js"),i=r("./node_modules/core-js/internals/function-bind-context.js"),o=r("./node_modules/core-js/internals/iterate.js");e.exports=function(e){var t,r,s,a,l=arguments.length,c=l>1?arguments[1]:void 0;return n(this),t=void 0!==c,t&&n(c),void 0==e?new this:(r=[],t?(s=0,a=i(c,l>2?arguments[2]:void 0,2),o(e,function(e){r.push(a(e,s++))})):o(e,r.push,r),new this(r))}},"./node_modules/core-js/internals/collection-of.js":function(e,t,r){"use strict";e.exports=function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}},"./node_modules/core-js/internals/collection-strong.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/object-define-property.js").f,i=r("./node_modules/core-js/internals/object-create.js"),o=r("./node_modules/core-js/internals/redefine-all.js"),s=r("./node_modules/core-js/internals/function-bind-context.js"),a=r("./node_modules/core-js/internals/an-instance.js"),l=r("./node_modules/core-js/internals/iterate.js"),c=r("./node_modules/core-js/internals/define-iterator.js"),u=r("./node_modules/core-js/internals/set-species.js"),d=r("./node_modules/core-js/internals/descriptors.js"),h=r("./node_modules/core-js/internals/internal-metadata.js").fastKey,f=r("./node_modules/core-js/internals/internal-state.js"),p=f.set,m=f.getterFor;e.exports={getConstructor:function(e,t,r,c){var u=e(function(e,n){a(e,u,t),p(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=n&&l(n,e[c],e,r)}),f=m(t),g=function(e,t,r){var n,i,o=f(e),s=v(e,t);return s?s.value=r:(o.last=s={index:i=h(t,!0),key:t,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=s),n&&(n.next=s),d?o.size++:e.size++,"F"!==i&&(o.index[i]=s)),e},v=function(e,t){var r,n=f(e),i=h(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==t)return r};return o(u.prototype,{clear:function(){for(var e=this,t=f(e),r=t.index,n=t.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete r[n.index],n=n.next;t.first=t.last=void 0,d?t.size=0:e.size=0},"delete":function(e){var t=this,r=f(t),n=v(t,e);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first==n&&(r.first=i),r.last==n&&(r.last=o),d?r.size--:t.size--;
}return!!n},forEach:function(e){for(var t,r=f(this),n=s(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!v(this,e)}}),o(u.prototype,r?{get:function(e){var t=v(this,e);return t&&t.value},set:function(e,t){return g(this,0===e?0:e,t)}}:{add:function(e){return g(this,e=0===e?0:e,e)}}),d&&n(u.prototype,"size",{get:function(){return f(this).size}}),u},setStrong:function(e,t,r){var n=t+" Iterator",i=m(t),o=m(n);c(e,t,function(e,t){p(this,{type:n,target:e,state:i(e),kind:t,last:void 0})},function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})},r?"entries":"values",!r,!0),u(t)}}},"./node_modules/core-js/internals/collection-weak.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/redefine-all.js"),i=r("./node_modules/core-js/internals/internal-metadata.js").getWeakData,o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/is-object.js"),a=r("./node_modules/core-js/internals/an-instance.js"),l=r("./node_modules/core-js/internals/iterate.js"),c=r("./node_modules/core-js/internals/array-iteration.js"),u=r("./node_modules/core-js/internals/has.js"),d=r("./node_modules/core-js/internals/internal-state.js"),h=d.set,f=d.getterFor,p=c.find,m=c.findIndex,g=0,v=function(e){return e.frozen||(e.frozen=new y)},y=function(){this.entries=[]},_=function(e,t){return p(e.entries,function(e){return e[0]===t})};y.prototype={get:function(e){var t=_(this,e);return t?t[1]:void 0},has:function(e){return!!_(this,e)},set:function(e,t){var r=_(this,e);r?r[1]=t:this.entries.push([e,t])},"delete":function(e){var t=m(this.entries,function(t){return t[0]===e});return~t&&this.entries.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,c){var d=e(function(e,n){a(e,d,t),h(e,{type:t,id:g++,frozen:void 0}),void 0!=n&&l(n,e[c],e,r)}),p=f(t),m=function(e,t,r){var n=p(e),s=i(o(t),!0);return s===!0?v(n).set(t,r):s[n.id]=r,e};return n(d.prototype,{"delete":function(e){var t=p(this);if(!s(e))return!1;var r=i(e);return r===!0?v(t)["delete"](e):r&&u(r,t.id)&&delete r[t.id]},has:function(e){var t=p(this);if(!s(e))return!1;var r=i(e);return r===!0?v(t).has(e):r&&u(r,t.id)}}),n(d.prototype,r?{get:function(e){var t=p(this);if(s(e)){var r=i(e);return r===!0?v(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return m(this,e,t)}}:{add:function(e){return m(this,e,!0)}}),d}}},"./node_modules/core-js/internals/collection.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/is-forced.js"),s=r("./node_modules/core-js/internals/redefine.js"),a=r("./node_modules/core-js/internals/internal-metadata.js"),l=r("./node_modules/core-js/internals/iterate.js"),c=r("./node_modules/core-js/internals/an-instance.js"),u=r("./node_modules/core-js/internals/is-object.js"),d=r("./node_modules/core-js/internals/fails.js"),h=r("./node_modules/core-js/internals/check-correctness-of-iteration.js"),f=r("./node_modules/core-js/internals/set-to-string-tag.js"),p=r("./node_modules/core-js/internals/inherit-if-required.js");e.exports=function(e,t,r){var m=-1!==e.indexOf("Map"),g=-1!==e.indexOf("Weak"),v=m?"set":"add",y=i[e],_=y&&y.prototype,b=y,x={},w=function(e){var t=_[e];s(_,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return g&&!u(e)?!1:t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return g&&!u(e)?!1:t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})};if(o(e,"function"!=typeof y||!(g||_.forEach&&!d(function(){(new y).entries().next()}))))b=r.getConstructor(t,e,m,v),a.REQUIRED=!0;else if(o(e,!0)){var E=new b,S=E[v](g?{}:-0,1)!=E,A=d(function(){E.has(1)}),M=h(function(e){new y(e)}),T=!g&&d(function(){for(var e=new y,t=5;t--;)e[v](t,t);return!e.has(-0)});M||(b=t(function(t,r){c(t,b,e);var n=p(new y,t,b);return void 0!=r&&l(r,n[v],n,m),n}),b.prototype=_,_.constructor=b),(A||T)&&(w("delete"),w("has"),m&&w("get")),(T||S)&&w(v),g&&_.clear&&delete _.clear}return x[e]=b,n({global:!0,forced:b!=y},x),f(b,e),g||r.setStrong(b,e,m),b}},"./node_modules/core-js/internals/composite-key.js":function(e,t,r){var n=r("./node_modules/core-js/modules/es.map.js"),i=r("./node_modules/core-js/modules/es.weak-map.js"),o=r("./node_modules/core-js/internals/object-create.js"),s=r("./node_modules/core-js/internals/is-object.js"),a=function(){this.object=null,this.symbol=null,this.primitives=null,this.objectsByIndex=o(null)};a.prototype.get=function(e,t){return this[e]||(this[e]=t())},a.prototype.next=function(e,t,r){var o=r?this.objectsByIndex[e]||(this.objectsByIndex[e]=new i):this.primitives||(this.primitives=new n),s=o.get(t);return s||o.set(t,s=new a),s};var l=new a;e.exports=function(){var e,t,r=l,n=arguments.length;for(e=0;n>e;e++)s(t=arguments[e])&&(r=r.next(e,t,!0));if(this===Object&&r===l)throw TypeError("Composite keys must contain a non-primitive component");for(e=0;n>e;e++)s(t=arguments[e])||(r=r.next(e,t,!1));return r}},"./node_modules/core-js/internals/copy-constructor-properties.js":function(e,t,r){var n=r("./node_modules/core-js/internals/has.js"),i=r("./node_modules/core-js/internals/own-keys.js"),o=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),s=r("./node_modules/core-js/internals/object-define-property.js");e.exports=function(e,t){for(var r=i(t),a=s.f,l=o.f,c=0;c<r.length;c++){var u=r[c];n(e,u)||a(e,u,l(t,u))}}},"./node_modules/core-js/internals/correct-is-regexp-logic.js":function(e,t,r){var n=r("./node_modules/core-js/internals/well-known-symbol.js"),i=n("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[i]=!1,"/./"[e](t)}catch(n){}}return!1}},"./node_modules/core-js/internals/correct-prototype-getter.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js");e.exports=!n(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},"./node_modules/core-js/internals/create-html.js":function(e,t,r){var n=r("./node_modules/core-js/internals/require-object-coercible.js"),i=/"/g;e.exports=function(e,t,r,o){var s=String(n(e)),a="<"+t;return""!==r&&(a+=" "+r+'="'+String(o).replace(i,"&quot;")+'"'),a+">"+s+"</"+t+">"}},"./node_modules/core-js/internals/create-iterator-constructor.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/iterators-core.js").IteratorPrototype,i=r("./node_modules/core-js/internals/object-create.js"),o=r("./node_modules/core-js/internals/create-property-descriptor.js"),s=r("./node_modules/core-js/internals/set-to-string-tag.js"),a=r("./node_modules/core-js/internals/iterators.js"),l=function(){return this};e.exports=function(e,t,r){var c=t+" Iterator";return e.prototype=i(n,{next:o(1,r)}),s(e,c,!1,!0),a[c]=l,e}},"./node_modules/core-js/internals/create-non-enumerable-property.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/object-define-property.js"),o=r("./node_modules/core-js/internals/create-property-descriptor.js");e.exports=n?function(e,t,r){return i.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},"./node_modules/core-js/internals/create-property-descriptor.js":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"./node_modules/core-js/internals/create-property.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/to-primitive.js"),i=r("./node_modules/core-js/internals/object-define-property.js"),o=r("./node_modules/core-js/internals/create-property-descriptor.js");e.exports=function(e,t,r){var s=n(t);s in e?i.f(e,s,o(0,r)):e[s]=r}},"./node_modules/core-js/internals/date-to-iso-string.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/fails.js"),i=r("./node_modules/core-js/internals/string-pad.js").start,o=Math.abs,s=Date.prototype,a=s.getTime,l=s.toISOString;e.exports=n(function(){return"0385-07-25T07:06:39.999Z"!=l.call(new Date(-5e13-1))})||!n(function(){l.call(new Date(NaN))})?function(){if(!isFinite(a.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=0>t?"-":t>9999?"+":"";return n+i(o(t),n?6:4,0)+"-"+i(e.getUTCMonth()+1,2,0)+"-"+i(e.getUTCDate(),2,0)+"T"+i(e.getUTCHours(),2,0)+":"+i(e.getUTCMinutes(),2,0)+":"+i(e.getUTCSeconds(),2,0)+"."+i(r,3,0)+"Z"}:l},"./node_modules/core-js/internals/date-to-primitive.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/an-object.js"),i=r("./node_modules/core-js/internals/to-primitive.js");e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(n(this),"number"!==e)}},"./node_modules/core-js/internals/define-iterator.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-iterator-constructor.js"),o=r("./node_modules/core-js/internals/object-get-prototype-of.js"),s=r("./node_modules/core-js/internals/object-set-prototype-of.js"),a=r("./node_modules/core-js/internals/set-to-string-tag.js"),l=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),c=r("./node_modules/core-js/internals/redefine.js"),u=r("./node_modules/core-js/internals/well-known-symbol.js"),d=r("./node_modules/core-js/internals/is-pure.js"),h=r("./node_modules/core-js/internals/iterators.js"),f=r("./node_modules/core-js/internals/iterators-core.js"),p=f.IteratorPrototype,m=f.BUGGY_SAFARI_ITERATORS,g=u("iterator"),v="keys",y="values",_="entries",b=function(){return this};e.exports=function(e,t,r,u,f,x,w){i(r,t,u);var E,S,A,M=function(e){if(e===f&&L)return L;if(!m&&e in j)return j[e];switch(e){case v:return function(){return new r(this,e)};case y:return function(){return new r(this,e)};case _:return function(){return new r(this,e)}}return function(){return new r(this)}},T=t+" Iterator",C=!1,j=e.prototype,P=j[g]||j["@@iterator"]||f&&j[f],L=!m&&P||M(f),D="Array"==t?j.entries||P:P;if(D&&(E=o(D.call(new e)),p!==Object.prototype&&E.next&&(d||o(E)===p||(s?s(E,p):"function"!=typeof E[g]&&l(E,g,b)),a(E,T,!0,!0),d&&(h[T]=b))),f==y&&P&&P.name!==y&&(C=!0,L=function(){return P.call(this)}),d&&!w||j[g]===L||l(j,g,L),h[t]=L,f)if(S={values:M(y),keys:x?L:M(v),entries:M(_)},w)for(A in S)!m&&!C&&A in j||c(j,A,S[A]);else n({target:t,proto:!0,forced:m||C},S);return S}},"./node_modules/core-js/internals/define-well-known-symbol.js":function(e,t,r){var n=r("./node_modules/core-js/internals/path.js"),i=r("./node_modules/core-js/internals/has.js"),o=r("./node_modules/core-js/internals/well-known-symbol-wrapped.js"),s=r("./node_modules/core-js/internals/object-define-property.js").f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||s(t,e,{value:o.f(e)})}},"./node_modules/core-js/internals/descriptors.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js");e.exports=!n(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},"./node_modules/core-js/internals/document-create-element.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/is-object.js"),o=n.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},"./node_modules/core-js/internals/dom-iterables.js":function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},"./node_modules/core-js/internals/engine-is-ios.js":function(e,t,r){var n=r("./node_modules/core-js/internals/engine-user-agent.js");e.exports=/(iphone|ipod|ipad).*applewebkit/i.test(n)},"./node_modules/core-js/internals/engine-user-agent.js":function(e,t,r){var n=r("./node_modules/core-js/internals/get-built-in.js");e.exports=n("navigator","userAgent")||""},"./node_modules/core-js/internals/engine-v8-version.js":function(e,t,r){var n,i,o=r("./node_modules/core-js/internals/global.js"),s=r("./node_modules/core-js/internals/engine-user-agent.js"),a=o.process,l=a&&a.versions,c=l&&l.v8;c?(n=c.split("."),i=n[0]+n[1]):s&&(n=s.match(/Edge\/(\d+)/),(!n||n[1]>=74)&&(n=s.match(/Chrome\/(\d+)/),n&&(i=n[1]))),e.exports=i&&+i},"./node_modules/core-js/internals/enum-bug-keys.js":function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"./node_modules/core-js/internals/export.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,o=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),s=r("./node_modules/core-js/internals/redefine.js"),a=r("./node_modules/core-js/internals/set-global.js"),l=r("./node_modules/core-js/internals/copy-constructor-properties.js"),c=r("./node_modules/core-js/internals/is-forced.js");e.exports=function(e,t){var r,u,d,h,f,p,m=e.target,g=e.global,v=e.stat;if(u=g?n:v?n[m]||a(m,{}):(n[m]||{}).prototype)for(d in t){if(f=t[d],e.noTargetGet?(p=i(u,d),h=p&&p.value):h=u[d],r=c(g?d:m+(v?".":"#")+d,e.forced),!r&&void 0!==h){if(typeof f==typeof h)continue;l(f,h)}(e.sham||h&&h.sham)&&o(f,"sham",!0),s(u,d,f,e)}}},"./node_modules/core-js/internals/fails.js":function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},"./node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js":function(e,t,r){"use strict";r("./node_modules/core-js/modules/es.regexp.exec.js");var n=r("./node_modules/core-js/internals/redefine.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/well-known-symbol.js"),s=r("./node_modules/core-js/internals/regexp-exec.js"),a=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),l=o("species"),c=!i(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),u=function(){return"$0"==="a".replace(/./,"$0")}(),d=o("replace"),h=function(){return/./[d]?""===/./[d]("a","$0"):!1}(),f=!i(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]});e.exports=function(e,t,r,d){var p=o(e),m=!i(function(){var t={};return t[p]=function(){return 7},7!=""[e](t)}),g=m&&!i(function(){var t=!1,r=/a/;return"split"===e&&(r={},r.constructor={},r.constructor[l]=function(){return r},r.flags="",r[p]=/./[p]),r.exec=function(){return t=!0,null},r[p](""),!t});if(!m||!g||"replace"===e&&(!c||!u||h)||"split"===e&&!f){var v=/./[p],y=r(p,""[e],function(e,t,r,n,i){return t.exec===s?m&&!i?{done:!0,value:v.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}},{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:h}),_=y[0],b=y[1];n(String.prototype,e,_),n(RegExp.prototype,p,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}d&&a(RegExp.prototype[p],"sham",!0)}},"./node_modules/core-js/internals/flatten-into-array.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/is-array.js"),i=r("./node_modules/core-js/internals/to-length.js"),o=r("./node_modules/core-js/internals/function-bind-context.js"),s=function(e,t,r,a,l,c,u,d){for(var h,f=l,p=0,m=u?o(u,d,3):!1;a>p;){if(p in r){if(h=m?m(r[p],p,t):r[p],c>0&&n(h))f=s(e,t,h,i(h.length),f,c-1)-1;else{if(f>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[f]=h}f++}p++}return f};e.exports=s},"./node_modules/core-js/internals/freezing.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js");e.exports=!n(function(){return Object.isExtensible(Object.preventExtensions({}))})},"./node_modules/core-js/internals/function-bind-context.js":function(e,t,r){var n=r("./node_modules/core-js/internals/a-function.js");e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},"./node_modules/core-js/internals/function-bind.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/a-function.js"),i=r("./node_modules/core-js/internals/is-object.js"),o=[].slice,s={},a=function(e,t,r){if(!(t in s)){for(var n=[],i=0;t>i;i++)n[i]="a["+i+"]";s[t]=Function("C,a","return new C("+n.join(",")+")")}return s[t](e,r)};e.exports=Function.bind||function(e){var t=n(this),r=o.call(arguments,1),s=function(){var n=r.concat(o.call(arguments));return this instanceof s?a(t,n.length,n):t.apply(e,n)};return i(t.prototype)&&(s.prototype=t.prototype),s}},"./node_modules/core-js/internals/get-built-in.js":function(e,t,r){var n=r("./node_modules/core-js/internals/path.js"),i=r("./node_modules/core-js/internals/global.js"),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(n[e])||o(i[e]):n[e]&&n[e][t]||i[e]&&i[e][t]}},"./node_modules/core-js/internals/get-iterator-method.js":function(e,t,r){var n=r("./node_modules/core-js/internals/classof.js"),i=r("./node_modules/core-js/internals/iterators.js"),o=r("./node_modules/core-js/internals/well-known-symbol.js"),s=o("iterator");e.exports=function(e){return void 0!=e?e[s]||e["@@iterator"]||i[n(e)]:void 0}},"./node_modules/core-js/internals/get-iterator.js":function(e,t,r){var n=r("./node_modules/core-js/internals/an-object.js"),i=r("./node_modules/core-js/internals/get-iterator-method.js");e.exports=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return n(t.call(e))}},"./node_modules/core-js/internals/get-map-iterator.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-pure.js"),i=r("./node_modules/core-js/internals/get-iterator.js");e.exports=n?i:function(e){return Map.prototype.entries.call(e)}},"./node_modules/core-js/internals/get-set-iterator.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-pure.js"),i=r("./node_modules/core-js/internals/get-iterator.js");e.exports=n?i:function(e){return Set.prototype.values.call(e)}},"./node_modules/core-js/internals/global.js":function(e,t,r){(function(t){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||Function("return this")()}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/core-js/internals/has.js":function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},"./node_modules/core-js/internals/hidden-keys.js":function(e,t){e.exports={}},"./node_modules/core-js/internals/host-report-errors.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js");e.exports=function(e,t){var r=n.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}},"./node_modules/core-js/internals/html.js":function(e,t,r){var n=r("./node_modules/core-js/internals/get-built-in.js");e.exports=n("document","documentElement")},"./node_modules/core-js/internals/ie8-dom-define.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/document-create-element.js");e.exports=!n&&!i(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},"./node_modules/core-js/internals/ieee754.js":function(e,t){var r=1/0,n=Math.abs,i=Math.pow,o=Math.floor,s=Math.log,a=Math.LN2,l=function(e,t,l){var c,u,d,h=new Array(l),f=8*l-t-1,p=(1<<f)-1,m=p>>1,g=23===t?i(2,-24)-i(2,-77):0,v=0>e||0===e&&0>1/e?1:0,y=0;for(e=n(e),e!=e||e===r?(u=e!=e?1:0,c=p):(c=o(s(e)/a),e*(d=i(2,-c))<1&&(c--,d*=2),e+=c+m>=1?g/d:g*i(2,1-m),e*d>=2&&(c++,d/=2),c+m>=p?(u=0,c=p):c+m>=1?(u=(e*d-1)*i(2,t),c+=m):(u=e*i(2,m-1)*i(2,t),c=0));t>=8;h[y++]=255&u,u/=256,t-=8);for(c=c<<t|u,f+=t;f>0;h[y++]=255&c,c/=256,f-=8);return h[--y]|=128*v,h},c=function(e,t){var n,o=e.length,s=8*o-t-1,a=(1<<s)-1,l=a>>1,c=s-7,u=o-1,d=e[u--],h=127&d;for(d>>=7;c>0;h=256*h+e[u],u--,c-=8);for(n=h&(1<<-c)-1,h>>=-c,c+=t;c>0;n=256*n+e[u],u--,c-=8);if(0===h)h=1-l;else{if(h===a)return n?NaN:d?-r:r;n+=i(2,t),h-=l}return(d?-1:1)*n*i(2,h-t)};e.exports={pack:l,unpack:c}},"./node_modules/core-js/internals/indexed-object.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js"),i=r("./node_modules/core-js/internals/classof-raw.js"),o="".split;e.exports=n(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},"./node_modules/core-js/internals/inherit-if-required.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-object.js"),i=r("./node_modules/core-js/internals/object-set-prototype-of.js");e.exports=function(e,t,r){var o,s;return i&&"function"==typeof(o=t.constructor)&&o!==r&&n(s=o.prototype)&&s!==r.prototype&&i(e,s),e}},"./node_modules/core-js/internals/inspect-source.js":function(e,t,r){var n=r("./node_modules/core-js/internals/shared-store.js"),i=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(e){return i.call(e)}),e.exports=n.inspectSource},"./node_modules/core-js/internals/internal-metadata.js":function(e,t,r){var n=r("./node_modules/core-js/internals/hidden-keys.js"),i=r("./node_modules/core-js/internals/is-object.js"),o=r("./node_modules/core-js/internals/has.js"),s=r("./node_modules/core-js/internals/object-define-property.js").f,a=r("./node_modules/core-js/internals/uid.js"),l=r("./node_modules/core-js/internals/freezing.js"),c=a("meta"),u=0,d=Object.isExtensible||function(){return!0},h=function(e){s(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},f=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,c)){if(!d(e))return"F";if(!t)return"E";h(e)}return e[c].objectID},p=function(e,t){if(!o(e,c)){if(!d(e))return!0;if(!t)return!1;h(e)}return e[c].weakData},m=function(e){return l&&g.REQUIRED&&d(e)&&!o(e,c)&&h(e),e},g=e.exports={REQUIRED:!1,fastKey:f,getWeakData:p,onFreeze:m};n[c]=!0},"./node_modules/core-js/internals/internal-state.js":function(e,t,r){var n,i,o,s=r("./node_modules/core-js/internals/native-weak-map.js"),a=r("./node_modules/core-js/internals/global.js"),l=r("./node_modules/core-js/internals/is-object.js"),c=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),u=r("./node_modules/core-js/internals/has.js"),d=r("./node_modules/core-js/internals/shared-key.js"),h=r("./node_modules/core-js/internals/hidden-keys.js"),f=a.WeakMap,p=function(e){return o(e)?i(e):n(e,{})},m=function(e){return function(t){var r;if(!l(t)||(r=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}};if(s){var g=new f,v=g.get,y=g.has,_=g.set;n=function(e,t){return _.call(g,e,t),t},i=function(e){return v.call(g,e)||{}},o=function(e){return y.call(g,e)}}else{var b=d("state");h[b]=!0,n=function(e,t){return c(e,b,t),t},i=function(e){return u(e,b)?e[b]:{}},o=function(e){return u(e,b)}}e.exports={set:n,get:i,has:o,enforce:p,getterFor:m}},"./node_modules/core-js/internals/is-array-iterator-method.js":function(e,t,r){var n=r("./node_modules/core-js/internals/well-known-symbol.js"),i=r("./node_modules/core-js/internals/iterators.js"),o=n("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[o]===e)}},"./node_modules/core-js/internals/is-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/classof-raw.js");e.exports=Array.isArray||function(e){return"Array"==n(e)}},"./node_modules/core-js/internals/is-forced.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js"),i=/#|\.prototype\./,o=function(e,t){var r=a[s(e)];return r==c?!0:r==l?!1:"function"==typeof t?n(t):!!t},s=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},a=o.data={},l=o.NATIVE="N",c=o.POLYFILL="P";e.exports=o},"./node_modules/core-js/internals/is-integer.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-object.js"),i=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&i(e)===e}},"./node_modules/core-js/internals/is-object.js":function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},"./node_modules/core-js/internals/is-pure.js":function(e,t){e.exports=!1},"./node_modules/core-js/internals/is-regexp.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-object.js"),i=r("./node_modules/core-js/internals/classof-raw.js"),o=r("./node_modules/core-js/internals/well-known-symbol.js"),s=o("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==i(e))}},"./node_modules/core-js/internals/iterate.js":function(e,t,r){var n=r("./node_modules/core-js/internals/an-object.js"),i=r("./node_modules/core-js/internals/is-array-iterator-method.js"),o=r("./node_modules/core-js/internals/to-length.js"),s=r("./node_modules/core-js/internals/function-bind-context.js"),a=r("./node_modules/core-js/internals/get-iterator-method.js"),l=r("./node_modules/core-js/internals/call-with-safe-iteration-closing.js"),c=function(e,t){this.stopped=e,this.result=t},u=e.exports=function(e,t,r,u,d){var h,f,p,m,g,v,y,_=s(t,r,u?2:1);if(d)h=e;else{if(f=a(e),"function"!=typeof f)throw TypeError("Target is not iterable");if(i(f)){for(p=0,m=o(e.length);m>p;p++)if(g=u?_(n(y=e[p])[0],y[1]):_(e[p]),g&&g instanceof c)return g;return new c(!1)}h=f.call(e)}for(v=h.next;!(y=v.call(h)).done;)if(g=l(h,_,y.value,u),"object"==typeof g&&g&&g instanceof c)return g;return new c(!1)};u.stop=function(e){return new c(!0,e)}},"./node_modules/core-js/internals/iterators-core.js":function(e,t,r){"use strict";var n,i,o,s=r("./node_modules/core-js/internals/object-get-prototype-of.js"),a=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),l=r("./node_modules/core-js/internals/has.js"),c=r("./node_modules/core-js/internals/well-known-symbol.js"),u=r("./node_modules/core-js/internals/is-pure.js"),d=c("iterator"),h=!1,f=function(){return this};[].keys&&(o=[].keys(),"next"in o?(i=s(s(o)),i!==Object.prototype&&(n=i)):h=!0),void 0==n&&(n={}),u||l(n,d)||a(n,d,f),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:h}},"./node_modules/core-js/internals/iterators.js":function(e,t){e.exports={}},"./node_modules/core-js/internals/math-expm1.js":function(e,t){var r=Math.expm1,n=Math.exp;e.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&1e-6>e?e+e*e/2:n(e)-1}:r},"./node_modules/core-js/internals/math-fround.js":function(e,t,r){var n=r("./node_modules/core-js/internals/math-sign.js"),i=Math.abs,o=Math.pow,s=o(2,-52),a=o(2,-23),l=o(2,127)*(2-a),c=o(2,-126),u=function(e){return e+1/s-1/s};e.exports=Math.fround||function(e){var t,r,o=i(e),d=n(e);return c>o?d*u(o/c/a)*c*a:(t=(1+a/s)*o,r=t-(t-o),r>l||r!=r?d*(1/0):d*r)}},"./node_modules/core-js/internals/math-log1p.js":function(e,t){var r=Math.log;e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&1e-8>e?e-e*e/2:r(1+e)}},"./node_modules/core-js/internals/math-scale.js":function(e,t){e.exports=Math.scale||function(e,t,r,n,i){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||i!=i?NaN:e===1/0||e===-(1/0)?e:(e-t)*(i-n)/(r-t)+n}},"./node_modules/core-js/internals/math-sign.js":function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:0>e?-1:1}},"./node_modules/core-js/internals/microtask.js":function(e,t,r){var n,i,o,s,a,l,c,u,d=r("./node_modules/core-js/internals/global.js"),h=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,f=r("./node_modules/core-js/internals/classof-raw.js"),p=r("./node_modules/core-js/internals/task.js").set,m=r("./node_modules/core-js/internals/engine-is-ios.js"),g=d.MutationObserver||d.WebKitMutationObserver,v=d.process,y=d.Promise,_="process"==f(v),b=h(d,"queueMicrotask"),x=b&&b.value;x||(n=function(){var e,t;for(_&&(e=v.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(r){throw i?s():o=void 0,r}}o=void 0,e&&e.enter()},_?s=function(){v.nextTick(n)}:g&&!m?(a=!0,l=document.createTextNode(""),new g(n).observe(l,{characterData:!0}),s=function(){l.data=a=!a}):y&&y.resolve?(c=y.resolve(void 0),u=c.then,s=function(){u.call(c,n)}):s=function(){p.call(d,n)}),e.exports=x||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,s()),o=t}},"./node_modules/core-js/internals/native-promise-constructor.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js");e.exports=n.Promise},"./node_modules/core-js/internals/native-symbol.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js");e.exports=!!Object.getOwnPropertySymbols&&!n(function(){return!String(Symbol())})},"./node_modules/core-js/internals/native-url.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js"),i=r("./node_modules/core-js/internals/well-known-symbol.js"),o=r("./node_modules/core-js/internals/is-pure.js"),s=i("iterator");e.exports=!n(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach(function(e,n){t["delete"]("b"),r+=n+e}),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[s]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})},"./node_modules/core-js/internals/native-weak-map.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/inspect-source.js"),o=n.WeakMap;e.exports="function"==typeof o&&/native code/.test(i(o))},"./node_modules/core-js/internals/new-promise-capability.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/a-function.js"),i=function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=n(t),this.reject=n(r)};e.exports.f=function(e){return new i(e)}},"./node_modules/core-js/internals/not-a-regexp.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-regexp.js");e.exports=function(e){if(n(e))throw TypeError("The method doesn't accept regular expressions");return e}},"./node_modules/core-js/internals/number-is-finite.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=n.isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&i(e)}},"./node_modules/core-js/internals/number-parse-float.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/string-trim.js").trim,o=r("./node_modules/core-js/internals/whitespaces.js"),s=n.parseFloat,a=1/s(o+"-0")!==-(1/0);e.exports=a?function(e){var t=i(String(e)),r=s(t);return 0===r&&"-"==t.charAt(0)?-0:r}:s},"./node_modules/core-js/internals/number-parse-int.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/string-trim.js").trim,o=r("./node_modules/core-js/internals/whitespaces.js"),s=n.parseInt,a=/^[+-]?0[Xx]/,l=8!==s(o+"08")||22!==s(o+"0x16");e.exports=l?function(e,t){var r=i(String(e));return s(r,t>>>0||(a.test(r)?16:10));
}:s},"./node_modules/core-js/internals/object-assign.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/object-keys.js"),s=r("./node_modules/core-js/internals/object-get-own-property-symbols.js"),a=r("./node_modules/core-js/internals/object-property-is-enumerable.js"),l=r("./node_modules/core-js/internals/to-object.js"),c=r("./node_modules/core-js/internals/indexed-object.js"),u=Object.assign,d=Object.defineProperty;e.exports=!u||i(function(){if(n&&1!==u({b:1},u(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach(function(e){t[e]=e}),7!=u({},e)[r]||o(u({},t)).join("")!=i})?function(e,t){for(var r=l(e),i=arguments.length,u=1,d=s.f,h=a.f;i>u;)for(var f,p=c(arguments[u++]),m=d?o(p).concat(d(p)):o(p),g=m.length,v=0;g>v;)f=m[v++],(!n||h.call(p,f))&&(r[f]=p[f]);return r}:u},"./node_modules/core-js/internals/object-create.js":function(e,t,r){var n,i=r("./node_modules/core-js/internals/an-object.js"),o=r("./node_modules/core-js/internals/object-define-properties.js"),s=r("./node_modules/core-js/internals/enum-bug-keys.js"),a=r("./node_modules/core-js/internals/hidden-keys.js"),l=r("./node_modules/core-js/internals/html.js"),c=r("./node_modules/core-js/internals/document-create-element.js"),u=r("./node_modules/core-js/internals/shared-key.js"),d=">",h="<",f="prototype",p="script",m=u("IE_PROTO"),g=function(){},v=function(e){return h+p+d+e+h+"/"+p+d},y=function(e){e.write(v("")),e.close();var t=e.parentWindow.Object;return e=null,t},_=function(){var e,t=c("iframe"),r="java"+p+":";return t.style.display="none",l.appendChild(t),t.src=String(r),e=t.contentWindow.document,e.open(),e.write(v("document.F=Object")),e.close(),e.F},b=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(e){}b=n?y(n):_();for(var t=s.length;t--;)delete b[f][s[t]];return b()};a[m]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(g[f]=i(e),r=new g,g[f]=null,r[m]=e):r=b(),void 0===t?r:o(r,t)}},"./node_modules/core-js/internals/object-define-properties.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/object-define-property.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/object-keys.js");e.exports=n?Object.defineProperties:function(e,t){o(e);for(var r,n=s(t),a=n.length,l=0;a>l;)i.f(e,r=n[l++],t[r]);return e}},"./node_modules/core-js/internals/object-define-property.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/ie8-dom-define.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/to-primitive.js"),a=Object.defineProperty;t.f=n?a:function(e,t,r){if(o(e),t=s(t,!0),o(r),i)try{return a(e,t,r)}catch(n){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},"./node_modules/core-js/internals/object-get-own-property-descriptor.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/object-property-is-enumerable.js"),o=r("./node_modules/core-js/internals/create-property-descriptor.js"),s=r("./node_modules/core-js/internals/to-indexed-object.js"),a=r("./node_modules/core-js/internals/to-primitive.js"),l=r("./node_modules/core-js/internals/has.js"),c=r("./node_modules/core-js/internals/ie8-dom-define.js"),u=Object.getOwnPropertyDescriptor;t.f=n?u:function(e,t){if(e=s(e),t=a(t,!0),c)try{return u(e,t)}catch(r){}return l(e,t)?o(!i.f.call(e,t),e[t]):void 0}},"./node_modules/core-js/internals/object-get-own-property-names-external.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-indexed-object.js"),i=r("./node_modules/core-js/internals/object-get-own-property-names.js").f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(e){try{return i(e)}catch(t){return s.slice()}};e.exports.f=function(e){return s&&"[object Window]"==o.call(e)?a(e):i(n(e))}},"./node_modules/core-js/internals/object-get-own-property-names.js":function(e,t,r){var n=r("./node_modules/core-js/internals/object-keys-internal.js"),i=r("./node_modules/core-js/internals/enum-bug-keys.js"),o=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},"./node_modules/core-js/internals/object-get-own-property-symbols.js":function(e,t){t.f=Object.getOwnPropertySymbols},"./node_modules/core-js/internals/object-get-prototype-of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/has.js"),i=r("./node_modules/core-js/internals/to-object.js"),o=r("./node_modules/core-js/internals/shared-key.js"),s=r("./node_modules/core-js/internals/correct-prototype-getter.js"),a=o("IE_PROTO"),l=Object.prototype;e.exports=s?Object.getPrototypeOf:function(e){return e=i(e),n(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},"./node_modules/core-js/internals/object-keys-internal.js":function(e,t,r){var n=r("./node_modules/core-js/internals/has.js"),i=r("./node_modules/core-js/internals/to-indexed-object.js"),o=r("./node_modules/core-js/internals/array-includes.js").indexOf,s=r("./node_modules/core-js/internals/hidden-keys.js");e.exports=function(e,t){var r,a=i(e),l=0,c=[];for(r in a)!n(s,r)&&n(a,r)&&c.push(r);for(;t.length>l;)n(a,r=t[l++])&&(~o(c,r)||c.push(r));return c}},"./node_modules/core-js/internals/object-keys.js":function(e,t,r){var n=r("./node_modules/core-js/internals/object-keys-internal.js"),i=r("./node_modules/core-js/internals/enum-bug-keys.js");e.exports=Object.keys||function(e){return n(e,i)}},"./node_modules/core-js/internals/object-property-is-enumerable.js":function(e,t,r){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!n.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},"./node_modules/core-js/internals/object-prototype-accessors-forced.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/is-pure.js"),i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/fails.js");e.exports=n||!o(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete i[e]})},"./node_modules/core-js/internals/object-set-prototype-of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/an-object.js"),i=r("./node_modules/core-js/internals/a-possible-prototype.js");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,e.call(r,[]),t=r instanceof Array}catch(o){}return function(r,o){return n(r),i(o),t?e.call(r,o):r.__proto__=o,r}}():void 0)},"./node_modules/core-js/internals/object-to-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/object-keys.js"),o=r("./node_modules/core-js/internals/to-indexed-object.js"),s=r("./node_modules/core-js/internals/object-property-is-enumerable.js").f,a=function(e){return function(t){for(var r,a=o(t),l=i(a),c=l.length,u=0,d=[];c>u;)r=l[u++],(!n||s.call(a,r))&&d.push(e?[r,a[r]]:a[r]);return d}};e.exports={entries:a(!0),values:a(!1)}},"./node_modules/core-js/internals/object-to-string.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/to-string-tag-support.js"),i=r("./node_modules/core-js/internals/classof.js");e.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},"./node_modules/core-js/internals/own-keys.js":function(e,t,r){var n=r("./node_modules/core-js/internals/get-built-in.js"),i=r("./node_modules/core-js/internals/object-get-own-property-names.js"),o=r("./node_modules/core-js/internals/object-get-own-property-symbols.js"),s=r("./node_modules/core-js/internals/an-object.js");e.exports=n("Reflect","ownKeys")||function(e){var t=i.f(s(e)),r=o.f;return r?t.concat(r(e)):t}},"./node_modules/core-js/internals/path.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js");e.exports=n},"./node_modules/core-js/internals/perform.js":function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},"./node_modules/core-js/internals/promise-resolve.js":function(e,t,r){var n=r("./node_modules/core-js/internals/an-object.js"),i=r("./node_modules/core-js/internals/is-object.js"),o=r("./node_modules/core-js/internals/new-promise-capability.js");e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e),s=r.resolve;return s(t),r.promise}},"./node_modules/core-js/internals/redefine-all.js":function(e,t,r){var n=r("./node_modules/core-js/internals/redefine.js");e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},"./node_modules/core-js/internals/redefine.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),o=r("./node_modules/core-js/internals/has.js"),s=r("./node_modules/core-js/internals/set-global.js"),a=r("./node_modules/core-js/internals/inspect-source.js"),l=r("./node_modules/core-js/internals/internal-state.js"),c=l.get,u=l.enforce,d=String(String).split("String");(e.exports=function(e,t,r,a){var l=a?!!a.unsafe:!1,c=a?!!a.enumerable:!1,h=a?!!a.noTargetGet:!1;return"function"==typeof r&&("string"!=typeof t||o(r,"name")||i(r,"name",t),u(r).source=d.join("string"==typeof t?t:"")),e===n?void(c?e[t]=r:s(t,r)):(l?!h&&e[t]&&(c=!0):delete e[t],void(c?e[t]=r:i(e,t,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&c(this).source||a(this)})},"./node_modules/core-js/internals/reflect-metadata.js":function(e,t,r){var n=r("./node_modules/core-js/modules/es.map.js"),i=r("./node_modules/core-js/modules/es.weak-map.js"),o=r("./node_modules/core-js/internals/shared.js"),s=o("metadata"),a=s.store||(s.store=new i),l=function(e,t,r){var i=a.get(e);if(!i){if(!r)return;a.set(e,i=new n)}var o=i.get(t);if(!o){if(!r)return;i.set(t,o=new n)}return o},c=function(e,t,r){var n=l(t,r,!1);return void 0===n?!1:n.has(e)},u=function(e,t,r){var n=l(t,r,!1);return void 0===n?void 0:n.get(e)},d=function(e,t,r,n){l(r,n,!0).set(e,t)},h=function(e,t){var r=l(e,t,!1),n=[];return r&&r.forEach(function(e,t){n.push(t)}),n},f=function(e){return void 0===e||"symbol"==typeof e?e:String(e)};e.exports={store:a,getMap:l,has:c,get:u,set:d,keys:h,toKey:f}},"./node_modules/core-js/internals/regexp-exec-abstract.js":function(e,t,r){var n=r("./node_modules/core-js/internals/classof-raw.js"),i=r("./node_modules/core-js/internals/regexp-exec.js");e.exports=function(e,t){var r=e.exec;if("function"==typeof r){var o=r.call(e,t);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==n(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},"./node_modules/core-js/internals/regexp-exec.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/regexp-flags.js"),i=r("./node_modules/core-js/internals/regexp-sticky-helpers.js"),o=RegExp.prototype.exec,s=String.prototype.replace,a=o,l=function(){var e=/a/,t=/b*/g;return o.call(e,"a"),o.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),c=i.UNSUPPORTED_Y||i.BROKEN_CARET,u=void 0!==/()??/.exec("")[1],d=l||u||c;d&&(a=function(e){var t,r,i,a,d=this,h=c&&d.sticky,f=n.call(d),p=d.source,m=0,g=e;return h&&(f=f.replace("y",""),-1===f.indexOf("g")&&(f+="g"),g=String(e).slice(d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==e[d.lastIndex-1])&&(p="(?: "+p+")",g=" "+g,m++),r=new RegExp("^(?:"+p+")",f)),u&&(r=new RegExp("^"+p+"$(?!\\s)",f)),l&&(t=d.lastIndex),i=o.call(h?r:d,g),h?i?(i.input=i.input.slice(m),i[0]=i[0].slice(m),i.index=d.lastIndex,d.lastIndex+=i[0].length):d.lastIndex=0:l&&i&&(d.lastIndex=d.global?i.index+i[0].length:t),u&&i&&i.length>1&&s.call(i[0],r,function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(i[a]=void 0)}),i}),e.exports=a},"./node_modules/core-js/internals/regexp-flags.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/an-object.js");e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},"./node_modules/core-js/internals/regexp-sticky-helpers.js":function(e,t,r){"use strict";function n(e,t){return RegExp(e,t)}var i=r("./node_modules/core-js/internals/fails.js");t.UNSUPPORTED_Y=i(function(){var e=n("a","y");return e.lastIndex=2,null!=e.exec("abcd")}),t.BROKEN_CARET=i(function(){var e=n("^r","gy");return e.lastIndex=2,null!=e.exec("str")})},"./node_modules/core-js/internals/require-object-coercible.js":function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on "+e);return e}},"./node_modules/core-js/internals/same-value-zero.js":function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},"./node_modules/core-js/internals/same-value.js":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"./node_modules/core-js/internals/set-global.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/create-non-enumerable-property.js");e.exports=function(e,t){try{i(n,e,t)}catch(r){n[e]=t}return t}},"./node_modules/core-js/internals/set-species.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/get-built-in.js"),i=r("./node_modules/core-js/internals/object-define-property.js"),o=r("./node_modules/core-js/internals/well-known-symbol.js"),s=r("./node_modules/core-js/internals/descriptors.js"),a=o("species");e.exports=function(e){var t=n(e),r=i.f;s&&t&&!t[a]&&r(t,a,{configurable:!0,get:function(){return this}})}},"./node_modules/core-js/internals/set-to-string-tag.js":function(e,t,r){var n=r("./node_modules/core-js/internals/object-define-property.js").f,i=r("./node_modules/core-js/internals/has.js"),o=r("./node_modules/core-js/internals/well-known-symbol.js"),s=o("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,s)&&n(e,s,{configurable:!0,value:t})}},"./node_modules/core-js/internals/shared-key.js":function(e,t,r){var n=r("./node_modules/core-js/internals/shared.js"),i=r("./node_modules/core-js/internals/uid.js"),o=n("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},"./node_modules/core-js/internals/shared-store.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/set-global.js"),o="__core-js_shared__",s=n[o]||i(o,{});e.exports=s},"./node_modules/core-js/internals/shared.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-pure.js"),i=r("./node_modules/core-js/internals/shared-store.js");(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.4",mode:n?"pure":"global",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"})},"./node_modules/core-js/internals/species-constructor.js":function(e,t,r){var n=r("./node_modules/core-js/internals/an-object.js"),i=r("./node_modules/core-js/internals/a-function.js"),o=r("./node_modules/core-js/internals/well-known-symbol.js"),s=o("species");e.exports=function(e,t){var r,o=n(e).constructor;return void 0===o||void 0==(r=n(o)[s])?t:i(r)}},"./node_modules/core-js/internals/string-html-forced.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js");e.exports=function(e){return n(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})}},"./node_modules/core-js/internals/string-multibyte.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-integer.js"),i=r("./node_modules/core-js/internals/require-object-coercible.js"),o=function(e){return function(t,r){var o,s,a=String(i(t)),l=n(r),c=a.length;return 0>l||l>=c?e?"":void 0:(o=a.charCodeAt(l),55296>o||o>56319||l+1===c||(s=a.charCodeAt(l+1))<56320||s>57343?e?a.charAt(l):o:e?a.slice(l,l+2):(o-55296<<10)+(s-56320)+65536)}};e.exports={codeAt:o(!1),charAt:o(!0)}},"./node_modules/core-js/internals/string-pad-webkit-bug.js":function(e,t,r){var n=r("./node_modules/core-js/internals/engine-user-agent.js");e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},"./node_modules/core-js/internals/string-pad.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-length.js"),i=r("./node_modules/core-js/internals/string-repeat.js"),o=r("./node_modules/core-js/internals/require-object-coercible.js"),s=Math.ceil,a=function(e){return function(t,r,a){var l,c,u=String(o(t)),d=u.length,h=void 0===a?" ":String(a),f=n(r);return d>=f||""==h?u:(l=f-d,c=i.call(h,s(l/h.length)),c.length>l&&(c=c.slice(0,l)),e?u+c:c+u)}};e.exports={start:a(!1),end:a(!0)}},"./node_modules/core-js/internals/string-punycode-to-ascii.js":function(e,t,r){"use strict";var n=2147483647,i=36,o=1,s=26,a=38,l=700,c=72,u=128,d="-",h=/[^\0-\u007E]/,f=/[.\u3002\uFF0E\uFF61]/g,p="Overflow: input needs wider integers to process",m=i-o,g=Math.floor,v=String.fromCharCode,y=function(e){for(var t=[],r=0,n=e.length;n>r;){var i=e.charCodeAt(r++);if(i>=55296&&56319>=i&&n>r){var o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),r--)}else t.push(i)}return t},_=function(e){return e+22+75*(26>e)},b=function(e,t,r){var n=0;for(e=r?g(e/l):e>>1,e+=g(e/t);e>m*s>>1;n+=i)e=g(e/m);return g(n+(m+1)*e/(e+a))},x=function(e){var t=[];e=y(e);var r,a,l=e.length,h=u,f=0,m=c;for(r=0;r<e.length;r++)a=e[r],128>a&&t.push(v(a));var x=t.length,w=x;for(x&&t.push(d);l>w;){var E=n;for(r=0;r<e.length;r++)a=e[r],a>=h&&E>a&&(E=a);var S=w+1;if(E-h>g((n-f)/S))throw RangeError(p);for(f+=(E-h)*S,h=E,r=0;r<e.length;r++){if(a=e[r],h>a&&++f>n)throw RangeError(p);if(a==h){for(var A=f,M=i;;M+=i){var T=m>=M?o:M>=m+s?s:M-m;if(T>A)break;var C=A-T,j=i-T;t.push(v(_(T+C%j))),A=g(C/j)}t.push(v(_(A))),m=b(f,S,w==x),f=0,++w}}++f,++h}return t.join("")};e.exports=function(e){var t,r,n=[],i=e.toLowerCase().replace(f,".").split(".");for(t=0;t<i.length;t++)r=i[t],n.push(h.test(r)?"xn--"+x(r):r);return n.join(".")}},"./node_modules/core-js/internals/string-repeat.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/to-integer.js"),i=r("./node_modules/core-js/internals/require-object-coercible.js");e.exports="".repeat||function(e){var t=String(i(this)),r="",o=n(e);if(0>o||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(r+=t);return r}},"./node_modules/core-js/internals/string-trim-forced.js":function(e,t,r){var n=r("./node_modules/core-js/internals/fails.js"),i=r("./node_modules/core-js/internals/whitespaces.js"),o="\u200b\x85\u180e";e.exports=function(e){return n(function(){return!!i[e]()||o[e]()!=o||i[e].name!==e})}},"./node_modules/core-js/internals/string-trim.js":function(e,t,r){var n=r("./node_modules/core-js/internals/require-object-coercible.js"),i=r("./node_modules/core-js/internals/whitespaces.js"),o="["+i+"]",s=RegExp("^"+o+o+"*"),a=RegExp(o+o+"*$"),l=function(e){return function(t){var r=String(n(t));return 1&e&&(r=r.replace(s,"")),2&e&&(r=r.replace(a,"")),r}};e.exports={start:l(1),end:l(2),trim:l(3)}},"./node_modules/core-js/internals/task.js":function(e,t,r){var n,i,o,s=r("./node_modules/core-js/internals/global.js"),a=r("./node_modules/core-js/internals/fails.js"),l=r("./node_modules/core-js/internals/classof-raw.js"),c=r("./node_modules/core-js/internals/function-bind-context.js"),u=r("./node_modules/core-js/internals/html.js"),d=r("./node_modules/core-js/internals/document-create-element.js"),h=r("./node_modules/core-js/internals/engine-is-ios.js"),f=s.location,p=s.setImmediate,m=s.clearImmediate,g=s.process,v=s.MessageChannel,y=s.Dispatch,_=0,b={},x="onreadystatechange",w=function(e){if(b.hasOwnProperty(e)){var t=b[e];delete b[e],t()}},E=function(e){return function(){w(e)}},S=function(e){w(e.data)},A=function(e){s.postMessage(e+"",f.protocol+"//"+f.host)};p&&m||(p=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return b[++_]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},n(_),_},m=function(e){delete b[e]},"process"==l(g)?n=function(e){g.nextTick(E(e))}:y&&y.now?n=function(e){y.now(E(e))}:v&&!h?(i=new v,o=i.port2,i.port1.onmessage=S,n=c(o.postMessage,o,1)):!s.addEventListener||"function"!=typeof postMessage||s.importScripts||a(A)?n=x in d("script")?function(e){u.appendChild(d("script"))[x]=function(){u.removeChild(this),w(e)}}:function(e){setTimeout(E(e),0)}:(n=A,s.addEventListener("message",S,!1))),e.exports={set:p,clear:m}},"./node_modules/core-js/internals/this-number-value.js":function(e,t,r){var n=r("./node_modules/core-js/internals/classof-raw.js");e.exports=function(e){if("number"!=typeof e&&"Number"!=n(e))throw TypeError("Incorrect invocation");return+e}},"./node_modules/core-js/internals/to-absolute-index.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-integer.js"),i=Math.max,o=Math.min;e.exports=function(e,t){var r=n(e);return 0>r?i(r+t,0):o(r,t)}},"./node_modules/core-js/internals/to-index.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-integer.js"),i=r("./node_modules/core-js/internals/to-length.js");e.exports=function(e){if(void 0===e)return 0;var t=n(e),r=i(t);if(t!==r)throw RangeError("Wrong length or index");return r}},"./node_modules/core-js/internals/to-indexed-object.js":function(e,t,r){var n=r("./node_modules/core-js/internals/indexed-object.js"),i=r("./node_modules/core-js/internals/require-object-coercible.js");e.exports=function(e){return n(i(e))}},"./node_modules/core-js/internals/to-integer.js":function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},"./node_modules/core-js/internals/to-length.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-integer.js"),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},"./node_modules/core-js/internals/to-object.js":function(e,t,r){var n=r("./node_modules/core-js/internals/require-object-coercible.js");e.exports=function(e){return Object(n(e))}},"./node_modules/core-js/internals/to-offset.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-positive-integer.js");e.exports=function(e,t){var r=n(e);if(r%t)throw RangeError("Wrong offset");return r}},"./node_modules/core-js/internals/to-positive-integer.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-integer.js");e.exports=function(e){var t=n(e);if(0>t)throw RangeError("The argument can't be less than 0");return t}},"./node_modules/core-js/internals/to-primitive.js":function(e,t,r){var n=r("./node_modules/core-js/internals/is-object.js");e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},"./node_modules/core-js/internals/to-string-tag-support.js":function(e,t,r){var n=r("./node_modules/core-js/internals/well-known-symbol.js"),i=n("toStringTag"),o={};o[i]="z",e.exports="[object z]"===String(o)},"./node_modules/core-js/internals/typed-array-constructor.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/descriptors.js"),s=r("./node_modules/core-js/internals/typed-array-constructors-require-wrappers.js"),a=r("./node_modules/core-js/internals/array-buffer-view-core.js"),l=r("./node_modules/core-js/internals/array-buffer.js"),c=r("./node_modules/core-js/internals/an-instance.js"),u=r("./node_modules/core-js/internals/create-property-descriptor.js"),d=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),h=r("./node_modules/core-js/internals/to-length.js"),f=r("./node_modules/core-js/internals/to-index.js"),p=r("./node_modules/core-js/internals/to-offset.js"),m=r("./node_modules/core-js/internals/to-primitive.js"),g=r("./node_modules/core-js/internals/has.js"),v=r("./node_modules/core-js/internals/classof.js"),y=r("./node_modules/core-js/internals/is-object.js"),_=r("./node_modules/core-js/internals/object-create.js"),b=r("./node_modules/core-js/internals/object-set-prototype-of.js"),x=r("./node_modules/core-js/internals/object-get-own-property-names.js").f,w=r("./node_modules/core-js/internals/typed-array-from.js"),E=r("./node_modules/core-js/internals/array-iteration.js").forEach,S=r("./node_modules/core-js/internals/set-species.js"),A=r("./node_modules/core-js/internals/object-define-property.js"),M=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),T=r("./node_modules/core-js/internals/internal-state.js"),C=r("./node_modules/core-js/internals/inherit-if-required.js"),j=T.get,P=T.set,L=A.f,D=M.f,I=Math.round,R=i.RangeError,O=l.ArrayBuffer,k=l.DataView,N=a.NATIVE_ARRAY_BUFFER_VIEWS,F=a.TYPED_ARRAY_TAG,V=a.TypedArray,U=a.TypedArrayPrototype,B=a.aTypedArrayConstructor,z=a.isTypedArray,G="BYTES_PER_ELEMENT",H="Wrong length",W=function(e,t){for(var r=0,n=t.length,i=new(B(e))(n);n>r;)i[r]=t[r++];return i},q=function(e,t){L(e,t,{get:function(){return j(this)[t]}})},X=function(e){var t;return e instanceof O||"ArrayBuffer"==(t=v(e))||"SharedArrayBuffer"==t},Y=function(e,t){return z(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},K=function(e,t){return Y(e,t=m(t,!0))?u(2,e[t]):D(e,t)},Q=function(e,t,r){return!(Y(e,t=m(t,!0))&&y(r)&&g(r,"value"))||g(r,"get")||g(r,"set")||r.configurable||g(r,"writable")&&!r.writable||g(r,"enumerable")&&!r.enumerable?L(e,t,r):(e[t]=r.value,e)};o?(N||(M.f=K,A.f=Q,q(U,"buffer"),q(U,"byteOffset"),q(U,"byteLength"),q(U,"length")),n({target:"Object",stat:!0,forced:!N},{getOwnPropertyDescriptor:K,defineProperty:Q}),e.exports=function(e,t,r){var o=e.match(/\d+$/)[0]/8,a=e+(r?"Clamped":"")+"Array",l="get"+e,u="set"+e,m=i[a],g=m,v=g&&g.prototype,A={},M=function(e,t){var r=j(e);return r.view[l](t*o+r.byteOffset,!0)},T=function(e,t,n){var i=j(e);r&&(n=(n=I(n))<0?0:n>255?255:255&n),i.view[u](t*o+i.byteOffset,n,!0)},D=function(e,t){L(e,t,{get:function(){return M(this,t)},set:function(e){return T(this,t,e)},enumerable:!0})};N?s&&(g=t(function(e,t,r,n){return c(e,g,a),C(function(){return y(t)?X(t)?void 0!==n?new m(t,p(r,o),n):void 0!==r?new m(t,p(r,o)):new m(t):z(t)?W(g,t):w.call(g,t):new m(f(t))}(),e,g)}),b&&b(g,V),E(x(m),function(e){e in g||d(g,e,m[e])}),g.prototype=v):(g=t(function(e,t,r,n){c(e,g,a);var i,s,l,u=0,d=0;if(y(t)){if(!X(t))return z(t)?W(g,t):w.call(g,t);i=t,d=p(r,o);var m=t.byteLength;if(void 0===n){if(m%o)throw R(H);if(s=m-d,0>s)throw R(H)}else if(s=h(n)*o,s+d>m)throw R(H);l=s/o}else l=f(t),s=l*o,i=new O(s);for(P(e,{buffer:i,byteOffset:d,byteLength:s,length:l,view:new k(i)});l>u;)D(e,u++)}),b&&b(g,V),v=g.prototype=_(U)),v.constructor!==g&&d(v,"constructor",g),F&&d(v,F,a),A[a]=g,n({global:!0,forced:g!=m,sham:!N},A),G in g||d(g,G,o),G in v||d(v,G,o),S(a)}):e.exports=function(){}},"./node_modules/core-js/internals/typed-array-constructors-require-wrappers.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/check-correctness-of-iteration.js"),s=r("./node_modules/core-js/internals/array-buffer-view-core.js").NATIVE_ARRAY_BUFFER_VIEWS,a=n.ArrayBuffer,l=n.Int8Array;e.exports=!s||!i(function(){l(1)})||!i(function(){new l(-1)})||!o(function(e){new l,new l(null),new l(1.5),new l(e)},!0)||i(function(){return 1!==new l(new a(2),1,void 0).length})},"./node_modules/core-js/internals/typed-array-from.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-object.js"),i=r("./node_modules/core-js/internals/to-length.js"),o=r("./node_modules/core-js/internals/get-iterator-method.js"),s=r("./node_modules/core-js/internals/is-array-iterator-method.js"),a=r("./node_modules/core-js/internals/function-bind-context.js"),l=r("./node_modules/core-js/internals/array-buffer-view-core.js").aTypedArrayConstructor;e.exports=function(e){var t,r,c,u,d,h,f=n(e),p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,v=o(f);if(void 0!=v&&!s(v))for(d=v.call(f),h=d.next,f=[];!(u=h.call(d)).done;)f.push(u.value);for(g&&p>2&&(m=a(m,arguments[2],2)),r=i(f.length),c=new(l(this))(r),t=0;r>t;t++)c[t]=g?m(f[t],t):f[t];return c}},"./node_modules/core-js/internals/uid.js":function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++r+n).toString(36)}},"./node_modules/core-js/internals/use-symbol-as-uid.js":function(e,t,r){var n=r("./node_modules/core-js/internals/native-symbol.js");e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},"./node_modules/core-js/internals/well-known-symbol-wrapped.js":function(e,t,r){var n=r("./node_modules/core-js/internals/well-known-symbol.js");t.f=n},"./node_modules/core-js/internals/well-known-symbol.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/shared.js"),o=r("./node_modules/core-js/internals/has.js"),s=r("./node_modules/core-js/internals/uid.js"),a=r("./node_modules/core-js/internals/native-symbol.js"),l=r("./node_modules/core-js/internals/use-symbol-as-uid.js"),c=i("wks"),u=n.Symbol,d=l?u:u&&u.withoutSetter||s;e.exports=function(e){return o(c,e)||(a&&o(u,e)?c[e]=u[e]:c[e]=d("Symbol."+e)),c[e]}},"./node_modules/core-js/internals/whitespaces.js":function(e,t){e.exports="	\n\x0B\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff"},"./node_modules/core-js/modules/es.array-buffer.constructor.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/array-buffer.js"),s=r("./node_modules/core-js/internals/set-species.js"),a="ArrayBuffer",l=o[a],c=i[a];n({global:!0,forced:c!==l},{ArrayBuffer:l}),s(a)},"./node_modules/core-js/modules/es.array-buffer.is-view.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-buffer-view-core.js"),o=i.NATIVE_ARRAY_BUFFER_VIEWS;n({target:"ArrayBuffer",stat:!0,forced:!o},{isView:i.isView})},"./node_modules/core-js/modules/es.array-buffer.slice.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/array-buffer.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/to-absolute-index.js"),l=r("./node_modules/core-js/internals/to-length.js"),c=r("./node_modules/core-js/internals/species-constructor.js"),u=o.ArrayBuffer,d=o.DataView,h=u.prototype.slice,f=i(function(){return!new u(2).slice(1,void 0).byteLength});n({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:f},{slice:function(e,t){if(void 0!==h&&void 0===t)return h.call(s(this),e);for(var r=s(this).byteLength,n=a(e,r),i=a(void 0===t?r:t,r),o=new(c(this,u))(l(i-n)),f=new d(this),p=new d(o),m=0;i>n;)p.setUint8(m++,f.getUint8(n++));return o}})},"./node_modules/core-js/modules/es.array.concat.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/is-array.js"),s=r("./node_modules/core-js/internals/is-object.js"),a=r("./node_modules/core-js/internals/to-object.js"),l=r("./node_modules/core-js/internals/to-length.js"),c=r("./node_modules/core-js/internals/create-property.js"),u=r("./node_modules/core-js/internals/array-species-create.js"),d=r("./node_modules/core-js/internals/array-method-has-species-support.js"),h=r("./node_modules/core-js/internals/well-known-symbol.js"),f=r("./node_modules/core-js/internals/engine-v8-version.js"),p=h("isConcatSpreadable"),m=9007199254740991,g="Maximum allowed index exceeded",v=f>=51||!i(function(){
var e=[];return e[p]=!1,e.concat()[0]!==e}),y=d("concat"),_=function(e){if(!s(e))return!1;var t=e[p];return void 0!==t?!!t:o(e)},b=!v||!y;n({target:"Array",proto:!0,forced:b},{concat:function(e){var t,r,n,i,o,s=a(this),d=u(s,0),h=0;for(t=-1,n=arguments.length;n>t;t++)if(o=-1===t?s:arguments[t],_(o)){if(i=l(o.length),h+i>m)throw TypeError(g);for(r=0;i>r;r++,h++)r in o&&c(d,h,o[r])}else{if(h>=m)throw TypeError(g);c(d,h++,o)}return d.length=h,d}})},"./node_modules/core-js/modules/es.array.copy-within.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-copy-within.js"),o=r("./node_modules/core-js/internals/add-to-unscopables.js");n({target:"Array",proto:!0},{copyWithin:i}),o("copyWithin")},"./node_modules/core-js/modules/es.array.every.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-iteration.js").every,o=r("./node_modules/core-js/internals/array-method-is-strict.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a=o("every"),l=s("every");n({target:"Array",proto:!0,forced:!a||!l},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.array.fill.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-fill.js"),o=r("./node_modules/core-js/internals/add-to-unscopables.js");n({target:"Array",proto:!0},{fill:i}),o("fill")},"./node_modules/core-js/modules/es.array.filter.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-iteration.js").filter,o=r("./node_modules/core-js/internals/array-method-has-species-support.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a=o("filter"),l=s("filter");n({target:"Array",proto:!0,forced:!a||!l},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.array.find-index.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-iteration.js").findIndex,o=r("./node_modules/core-js/internals/add-to-unscopables.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a="findIndex",l=!0,c=s(a);a in[]&&Array(1)[a](function(){l=!1}),n({target:"Array",proto:!0,forced:l||!c},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(a)},"./node_modules/core-js/modules/es.array.find.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-iteration.js").find,o=r("./node_modules/core-js/internals/add-to-unscopables.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a="find",l=!0,c=s(a);a in[]&&Array(1)[a](function(){l=!1}),n({target:"Array",proto:!0,forced:l||!c},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(a)},"./node_modules/core-js/modules/es.array.flat-map.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/flatten-into-array.js"),o=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/to-length.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/array-species-create.js");n({target:"Array",proto:!0},{flatMap:function(e){var t,r=o(this),n=s(r.length);return a(e),t=l(r,0),t.length=i(t,r,r,n,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},"./node_modules/core-js/modules/es.array.flat.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/flatten-into-array.js"),o=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/to-length.js"),a=r("./node_modules/core-js/internals/to-integer.js"),l=r("./node_modules/core-js/internals/array-species-create.js");n({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=o(this),r=s(t.length),n=l(t,0);return n.length=i(n,t,t,r,0,void 0===e?1:a(e)),n}})},"./node_modules/core-js/modules/es.array.for-each.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-for-each.js");n({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},"./node_modules/core-js/modules/es.array.from.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-from.js"),o=r("./node_modules/core-js/internals/check-correctness-of-iteration.js"),s=!o(function(e){Array.from(e)});n({target:"Array",stat:!0,forced:s},{from:i})},"./node_modules/core-js/modules/es.array.includes.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-includes.js").includes,o=r("./node_modules/core-js/internals/add-to-unscopables.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a=s("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:!a},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},"./node_modules/core-js/modules/es.array.index-of.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-includes.js").indexOf,o=r("./node_modules/core-js/internals/array-method-is-strict.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a=[].indexOf,l=!!a&&1/[1].indexOf(1,-0)<0,c=o("indexOf"),u=s("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:l||!c||!u},{indexOf:function(e){return l?a.apply(this,arguments)||0:i(this,e,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.array.iterator.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/to-indexed-object.js"),i=r("./node_modules/core-js/internals/add-to-unscopables.js"),o=r("./node_modules/core-js/internals/iterators.js"),s=r("./node_modules/core-js/internals/internal-state.js"),a=r("./node_modules/core-js/internals/define-iterator.js"),l="Array Iterator",c=s.set,u=s.getterFor(l);e.exports=a(Array,"Array",function(e,t){c(this,{type:l,target:n(e),index:0,kind:t})},function(){var e=u(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},"./node_modules/core-js/modules/es.array.join.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/indexed-object.js"),o=r("./node_modules/core-js/internals/to-indexed-object.js"),s=r("./node_modules/core-js/internals/array-method-is-strict.js"),a=[].join,l=i!=Object,c=s("join",",");n({target:"Array",proto:!0,forced:l||!c},{join:function(e){return a.call(o(this),void 0===e?",":e)}})},"./node_modules/core-js/modules/es.array.last-index-of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-last-index-of.js");n({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})},"./node_modules/core-js/modules/es.array.map.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-iteration.js").map,o=r("./node_modules/core-js/internals/array-method-has-species-support.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a=o("map"),l=s("map");n({target:"Array",proto:!0,forced:!a||!l},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.array.of.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/create-property.js"),s=i(function(){function e(){}return!(Array.of.call(e)instanceof e)});n({target:"Array",stat:!0,forced:s},{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)o(r,e,arguments[e++]);return r.length=t,r}})},"./node_modules/core-js/modules/es.array.reduce-right.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-reduce.js").right,o=r("./node_modules/core-js/internals/array-method-is-strict.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a=o("reduceRight"),l=s("reduce",{1:0});n({target:"Array",proto:!0,forced:!a||!l},{reduceRight:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.array.reduce.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-reduce.js").left,o=r("./node_modules/core-js/internals/array-method-is-strict.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a=o("reduce"),l=s("reduce",{1:0});n({target:"Array",proto:!0,forced:!a||!l},{reduce:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.array.reverse.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-array.js"),o=[].reverse,s=[1,2];n({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),o.call(this)}})},"./node_modules/core-js/modules/es.array.slice.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-object.js"),o=r("./node_modules/core-js/internals/is-array.js"),s=r("./node_modules/core-js/internals/to-absolute-index.js"),a=r("./node_modules/core-js/internals/to-length.js"),l=r("./node_modules/core-js/internals/to-indexed-object.js"),c=r("./node_modules/core-js/internals/create-property.js"),u=r("./node_modules/core-js/internals/well-known-symbol.js"),d=r("./node_modules/core-js/internals/array-method-has-species-support.js"),h=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),f=d("slice"),p=h("slice",{ACCESSORS:!0,0:0,1:2}),m=u("species"),g=[].slice,v=Math.max;n({target:"Array",proto:!0,forced:!f||!p},{slice:function(e,t){var r,n,u,d=l(this),h=a(d.length),f=s(e,h),p=s(void 0===t?h:t,h);if(o(d)&&(r=d.constructor,"function"!=typeof r||r!==Array&&!o(r.prototype)?i(r)&&(r=r[m],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return g.call(d,f,p);for(n=new(void 0===r?Array:r)(v(p-f,0)),u=0;p>f;f++,u++)f in d&&c(n,u,d[f]);return n.length=u,n}})},"./node_modules/core-js/modules/es.array.some.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-iteration.js").some,o=r("./node_modules/core-js/internals/array-method-is-strict.js"),s=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),a=o("some"),l=s("some");n({target:"Array",proto:!0,forced:!a||!l},{some:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.array.sort.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/a-function.js"),o=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/fails.js"),a=r("./node_modules/core-js/internals/array-method-is-strict.js"),l=[],c=l.sort,u=s(function(){l.sort(void 0)}),d=s(function(){l.sort(null)}),h=a("sort"),f=u||!d||!h;n({target:"Array",proto:!0,forced:f},{sort:function(e){return void 0===e?c.call(o(this)):c.call(o(this),i(e))}})},"./node_modules/core-js/modules/es.array.species.js":function(e,t,r){var n=r("./node_modules/core-js/internals/set-species.js");n("Array")},"./node_modules/core-js/modules/es.array.splice.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/to-absolute-index.js"),o=r("./node_modules/core-js/internals/to-integer.js"),s=r("./node_modules/core-js/internals/to-length.js"),a=r("./node_modules/core-js/internals/to-object.js"),l=r("./node_modules/core-js/internals/array-species-create.js"),c=r("./node_modules/core-js/internals/create-property.js"),u=r("./node_modules/core-js/internals/array-method-has-species-support.js"),d=r("./node_modules/core-js/internals/array-method-uses-to-length.js"),h=u("splice"),f=d("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,m=Math.min,g=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!h||!f},{splice:function(e,t){var r,n,u,d,h,f,y=a(this),_=s(y.length),b=i(e,_),x=arguments.length;if(0===x?r=n=0:1===x?(r=0,n=_-b):(r=x-2,n=m(p(o(t),0),_-b)),_+r-n>g)throw TypeError(v);for(u=l(y,n),d=0;n>d;d++)h=b+d,h in y&&c(u,d,y[h]);if(u.length=n,n>r){for(d=b;_-n>d;d++)h=d+n,f=d+r,h in y?y[f]=y[h]:delete y[f];for(d=_;d>_-n+r;d--)delete y[d-1]}else if(r>n)for(d=_-n;d>b;d--)h=d+n-1,f=d+r-1,h in y?y[f]=y[h]:delete y[f];for(d=0;r>d;d++)y[d+b]=arguments[d+2];return y.length=_-n+r,u}})},"./node_modules/core-js/modules/es.array.unscopables.flat-map.js":function(e,t,r){var n=r("./node_modules/core-js/internals/add-to-unscopables.js");n("flatMap")},"./node_modules/core-js/modules/es.array.unscopables.flat.js":function(e,t,r){var n=r("./node_modules/core-js/internals/add-to-unscopables.js");n("flat")},"./node_modules/core-js/modules/es.data-view.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/array-buffer.js"),o=r("./node_modules/core-js/internals/array-buffer-native.js");n({global:!0,forced:!o},{DataView:i.DataView})},"./node_modules/core-js/modules/es.date.to-iso-string.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/date-to-iso-string.js");n({target:"Date",proto:!0,forced:Date.prototype.toISOString!==i},{toISOString:i})},"./node_modules/core-js/modules/es.date.to-json.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/to-primitive.js"),a=i(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})});n({target:"Date",proto:!0,forced:a},{toJSON:function(e){var t=o(this),r=s(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}})},"./node_modules/core-js/modules/es.date.to-primitive.js":function(e,t,r){var n=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),i=r("./node_modules/core-js/internals/date-to-primitive.js"),o=r("./node_modules/core-js/internals/well-known-symbol.js"),s=o("toPrimitive"),a=Date.prototype;s in a||n(a,s,i)},"./node_modules/core-js/modules/es.function.has-instance.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/is-object.js"),i=r("./node_modules/core-js/internals/object-define-property.js"),o=r("./node_modules/core-js/internals/object-get-prototype-of.js"),s=r("./node_modules/core-js/internals/well-known-symbol.js"),a=s("hasInstance"),l=Function.prototype;a in l||i.f(l,a,{value:function(e){if("function"!=typeof this||!n(e))return!1;if(!n(this.prototype))return e instanceof this;for(;e=o(e);)if(this.prototype===e)return!0;return!1}})},"./node_modules/core-js/modules/es.function.name.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/object-define-property.js").f,o=Function.prototype,s=o.toString,a=/^\s*function ([^ (]*)/,l="name";!n||l in o||i(o,l,{configurable:!0,get:function(){try{return s.call(this).match(a)[1]}catch(e){return""}}})},"./node_modules/core-js/modules/es.global-this.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/global.js");n({global:!0},{globalThis:i})},"./node_modules/core-js/modules/es.json.to-string-tag.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/set-to-string-tag.js");i(n.JSON,"JSON",!0)},"./node_modules/core-js/modules/es.map.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/collection.js"),i=r("./node_modules/core-js/internals/collection-strong.js");e.exports=n("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},i)},"./node_modules/core-js/modules/es.math.acosh.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-log1p.js"),o=Math.acosh,s=Math.log,a=Math.sqrt,l=Math.LN2,c=!o||710!=Math.floor(o(Number.MAX_VALUE))||o(1/0)!=1/0;n({target:"Math",stat:!0,forced:c},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?s(e)+l:i(e-1+a(e-1)*a(e+1))}})},"./node_modules/core-js/modules/es.math.asinh.js":function(e,t,r){function n(e){return isFinite(e=+e)&&0!=e?0>e?-n(-e):s(e+a(e*e+1)):e}var i=r("./node_modules/core-js/internals/export.js"),o=Math.asinh,s=Math.log,a=Math.sqrt;i({target:"Math",stat:!0,forced:!(o&&1/o(0)>0)},{asinh:n})},"./node_modules/core-js/modules/es.math.atanh.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=Math.atanh,o=Math.log;n({target:"Math",stat:!0,forced:!(i&&1/i(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:o((1+e)/(1-e))/2}})},"./node_modules/core-js/modules/es.math.cbrt.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-sign.js"),o=Math.abs,s=Math.pow;n({target:"Math",stat:!0},{cbrt:function(e){return i(e=+e)*s(o(e),1/3)}})},"./node_modules/core-js/modules/es.math.clz32.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=Math.floor,o=Math.log,s=Math.LOG2E;n({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-i(o(e+.5)*s):32}})},"./node_modules/core-js/modules/es.math.cosh.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-expm1.js"),o=Math.cosh,s=Math.abs,a=Math.E;n({target:"Math",stat:!0,forced:!o||o(710)===1/0},{cosh:function(e){var t=i(s(e)-1)+1;return(t+1/(t*a*a))*(a/2)}})},"./node_modules/core-js/modules/es.math.expm1.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-expm1.js");n({target:"Math",stat:!0,forced:i!=Math.expm1},{expm1:i})},"./node_modules/core-js/modules/es.math.fround.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-fround.js");n({target:"Math",stat:!0},{fround:i})},"./node_modules/core-js/modules/es.math.hypot.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=Math.hypot,o=Math.abs,s=Math.sqrt,a=!!i&&i(1/0,NaN)!==1/0;n({target:"Math",stat:!0,forced:a},{hypot:function(e,t){for(var r,n,i=0,a=0,l=arguments.length,c=0;l>a;)r=o(arguments[a++]),r>c?(n=c/r,i=i*n*n+1,c=r):r>0?(n=r/c,i+=n*n):i+=r;return c===1/0?1/0:c*s(i)}})},"./node_modules/core-js/modules/es.math.imul.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=Math.imul,s=i(function(){return-5!=o(4294967295,5)||2!=o.length});n({target:"Math",stat:!0,forced:s},{imul:function(e,t){var r=65535,n=+e,i=+t,o=r&n,s=r&i;return 0|o*s+((r&n>>>16)*s+o*(r&i>>>16)<<16>>>0)}})},"./node_modules/core-js/modules/es.math.log10.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=Math.log,o=Math.LOG10E;n({target:"Math",stat:!0},{log10:function(e){return i(e)*o}})},"./node_modules/core-js/modules/es.math.log1p.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-log1p.js");n({target:"Math",stat:!0},{log1p:i})},"./node_modules/core-js/modules/es.math.log2.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=Math.log,o=Math.LN2;n({target:"Math",stat:!0},{log2:function(e){return i(e)/o}})},"./node_modules/core-js/modules/es.math.sign.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-sign.js");n({target:"Math",stat:!0},{sign:i})},"./node_modules/core-js/modules/es.math.sinh.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/math-expm1.js"),s=Math.abs,a=Math.exp,l=Math.E,c=i(function(){return-2e-17!=Math.sinh(-2e-17)});n({target:"Math",stat:!0,forced:c},{sinh:function(e){return s(e=+e)<1?(o(e)-o(-e))/2:(a(e-1)-a(-e-1))*(l/2)}})},"./node_modules/core-js/modules/es.math.tanh.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-expm1.js"),o=Math.exp;n({target:"Math",stat:!0},{tanh:function(e){var t=i(e=+e),r=i(-e);return t==1/0?1:r==1/0?-1:(t-r)/(o(e)+o(-e))}})},"./node_modules/core-js/modules/es.math.to-string-tag.js":function(e,t,r){var n=r("./node_modules/core-js/internals/set-to-string-tag.js");n(Math,"Math",!0)},"./node_modules/core-js/modules/es.math.trunc.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=Math.ceil,o=Math.floor;n({target:"Math",stat:!0},{trunc:function(e){return(e>0?o:i)(e)}})},"./node_modules/core-js/modules/es.number.constructor.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/is-forced.js"),s=r("./node_modules/core-js/internals/redefine.js"),a=r("./node_modules/core-js/internals/has.js"),l=r("./node_modules/core-js/internals/classof-raw.js"),c=r("./node_modules/core-js/internals/inherit-if-required.js"),u=r("./node_modules/core-js/internals/to-primitive.js"),d=r("./node_modules/core-js/internals/fails.js"),h=r("./node_modules/core-js/internals/object-create.js"),f=r("./node_modules/core-js/internals/object-get-own-property-names.js").f,p=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,m=r("./node_modules/core-js/internals/object-define-property.js").f,g=r("./node_modules/core-js/internals/string-trim.js").trim,v="Number",y=i[v],_=y.prototype,b=l(h(_))==v,x=function(e){var t,r,n,i,o,s,a,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(r=c.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(o=c.slice(2),s=o.length,a=0;s>a;a++)if(l=o.charCodeAt(a),48>l||l>i)return NaN;return parseInt(o,n)}return+c};if(o(v,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var w,E=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof E&&(b?d(function(){_.valueOf.call(r)}):l(r)!=v)?c(new y(x(t)),r,E):x(t)},S=n?f(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),A=0;S.length>A;A++)a(y,w=S[A])&&!a(E,w)&&m(E,w,p(y,w));E.prototype=_,_.constructor=E,s(i,v,E)}},"./node_modules/core-js/modules/es.number.epsilon.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Number",stat:!0},{EPSILON:Math.pow(2,-52)})},"./node_modules/core-js/modules/es.number.is-finite.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/number-is-finite.js");n({target:"Number",stat:!0},{isFinite:i})},"./node_modules/core-js/modules/es.number.is-integer.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-integer.js");n({target:"Number",stat:!0},{isInteger:i})},"./node_modules/core-js/modules/es.number.is-nan.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},"./node_modules/core-js/modules/es.number.is-safe-integer.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-integer.js"),o=Math.abs;n({target:"Number",stat:!0},{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},"./node_modules/core-js/modules/es.number.max-safe-integer.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},"./node_modules/core-js/modules/es.number.min-safe-integer.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991})},"./node_modules/core-js/modules/es.number.parse-float.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/number-parse-float.js");n({target:"Number",stat:!0,forced:Number.parseFloat!=i},{parseFloat:i})},"./node_modules/core-js/modules/es.number.parse-int.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/number-parse-int.js");n({target:"Number",stat:!0,forced:Number.parseInt!=i},{parseInt:i})},"./node_modules/core-js/modules/es.number.to-fixed.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/to-integer.js"),o=r("./node_modules/core-js/internals/this-number-value.js"),s=r("./node_modules/core-js/internals/string-repeat.js"),a=r("./node_modules/core-js/internals/fails.js"),l=1..toFixed,c=Math.floor,u=function(e,t,r){return 0===t?r:t%2===1?u(e,t-1,r*e):u(e*e,t/2,r)},d=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},h=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0))||!a(function(){l.call({})});n({target:"Number",proto:!0,forced:h},{toFixed:function(e){var t,r,n,a,l=o(this),h=i(e),f=[0,0,0,0,0,0],p="",m="0",g=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*f[r],f[r]=n%1e7,n=c(n/1e7)},v=function(e){for(var t=6,r=0;--t>=0;)r+=f[t],f[t]=c(r/e),r=r%e*1e7},y=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==f[e]){var r=String(f[e]);t=""===t?r:t+s.call("0",7-r.length)+r}return t};if(0>h||h>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(-1e21>=l||l>=1e21)return String(l);if(0>l&&(p="-",l=-l),l>1e-21)if(t=d(l*u(2,69,1))-69,r=0>t?l*u(2,-t,1):l/u(2,t,1),r*=4503599627370496,t=52-t,t>0){for(g(0,r),n=h;n>=7;)g(1e7,0),n-=7;for(g(u(10,n,1),0),n=t-1;n>=23;)v(1<<23),n-=23;v(1<<n),g(1,1),v(2),m=y()}else g(0,r),g(1<<-t,0),m=y()+s.call("0",h);return h>0?(a=m.length,m=p+(h>=a?"0."+s.call("0",h-a)+m:m.slice(0,a-h)+"."+m.slice(a-h))):m=p+m,m}})},"./node_modules/core-js/modules/es.number.to-precision.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/this-number-value.js"),s=1..toPrecision,a=i(function(){return"1"!==s.call(1,void 0)})||!i(function(){s.call({})});n({target:"Number",proto:!0,forced:a},{toPrecision:function(e){return void 0===e?s.call(o(this)):s.call(o(this),e)}})},"./node_modules/core-js/modules/es.object.assign.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/object-assign.js");n({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},"./node_modules/core-js/modules/es.object.define-getter.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/object-prototype-accessors-forced.js"),s=r("./node_modules/core-js/internals/to-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/object-define-property.js");i&&n({target:"Object",proto:!0,forced:o},{__defineGetter__:function(e,t){l.f(s(this),e,{get:a(t),enumerable:!0,configurable:!0})}})},"./node_modules/core-js/modules/es.object.define-setter.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/object-prototype-accessors-forced.js"),s=r("./node_modules/core-js/internals/to-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/object-define-property.js");i&&n({target:"Object",proto:!0,forced:o},{__defineSetter__:function(e,t){l.f(s(this),e,{set:a(t),enumerable:!0,configurable:!0})}})},"./node_modules/core-js/modules/es.object.entries.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/object-to-array.js").entries;n({target:"Object",stat:!0},{entries:function(e){return i(e)}})},"./node_modules/core-js/modules/es.object.freeze.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/freezing.js"),o=r("./node_modules/core-js/internals/fails.js"),s=r("./node_modules/core-js/internals/is-object.js"),a=r("./node_modules/core-js/internals/internal-metadata.js").onFreeze,l=Object.freeze,c=o(function(){l(1)});n({target:"Object",stat:!0,forced:c,sham:!i},{freeze:function(e){return l&&s(e)?l(a(e)):e}})},"./node_modules/core-js/modules/es.object.from-entries.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/iterate.js"),o=r("./node_modules/core-js/internals/create-property.js");n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return i(e,function(e,r){o(t,e,r)},void 0,!0),t}})},"./node_modules/core-js/modules/es.object.get-own-property-descriptor.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/to-indexed-object.js"),s=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,a=r("./node_modules/core-js/internals/descriptors.js"),l=i(function(){s(1)}),c=!a||l;n({target:"Object",stat:!0,forced:c,sham:!a},{getOwnPropertyDescriptor:function(e,t){return s(o(e),t)}})},"./node_modules/core-js/modules/es.object.get-own-property-descriptors.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/own-keys.js"),s=r("./node_modules/core-js/internals/to-indexed-object.js"),a=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),l=r("./node_modules/core-js/internals/create-property.js");n({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){for(var t,r,n=s(e),i=a.f,c=o(n),u={},d=0;c.length>d;)r=i(n,t=c[d++]),void 0!==r&&l(u,t,r);return u}})},"./node_modules/core-js/modules/es.object.get-own-property-names.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/object-get-own-property-names-external.js").f,s=i(function(){return!Object.getOwnPropertyNames(1)});n({target:"Object",stat:!0,forced:s},{getOwnPropertyNames:o})},"./node_modules/core-js/modules/es.object.get-prototype-of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/object-get-prototype-of.js"),a=r("./node_modules/core-js/internals/correct-prototype-getter.js"),l=i(function(){
s(1)});n({target:"Object",stat:!0,forced:l,sham:!a},{getPrototypeOf:function(e){return s(o(e))}})},"./node_modules/core-js/modules/es.object.is-extensible.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/is-object.js"),s=Object.isExtensible,a=i(function(){s(1)});n({target:"Object",stat:!0,forced:a},{isExtensible:function(e){return o(e)?s?s(e):!0:!1}})},"./node_modules/core-js/modules/es.object.is-frozen.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/is-object.js"),s=Object.isFrozen,a=i(function(){s(1)});n({target:"Object",stat:!0,forced:a},{isFrozen:function(e){return o(e)?s?s(e):!1:!0}})},"./node_modules/core-js/modules/es.object.is-sealed.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/is-object.js"),s=Object.isSealed,a=i(function(){s(1)});n({target:"Object",stat:!0,forced:a},{isSealed:function(e){return o(e)?s?s(e):!1:!0}})},"./node_modules/core-js/modules/es.object.is.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/same-value.js");n({target:"Object",stat:!0},{is:i})},"./node_modules/core-js/modules/es.object.keys.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/to-object.js"),o=r("./node_modules/core-js/internals/object-keys.js"),s=r("./node_modules/core-js/internals/fails.js"),a=s(function(){o(1)});n({target:"Object",stat:!0,forced:a},{keys:function(e){return o(i(e))}})},"./node_modules/core-js/modules/es.object.lookup-getter.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/object-prototype-accessors-forced.js"),s=r("./node_modules/core-js/internals/to-object.js"),a=r("./node_modules/core-js/internals/to-primitive.js"),l=r("./node_modules/core-js/internals/object-get-prototype-of.js"),c=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f;i&&n({target:"Object",proto:!0,forced:o},{__lookupGetter__:function(e){var t,r=s(this),n=a(e,!0);do if(t=c(r,n))return t.get;while(r=l(r))}})},"./node_modules/core-js/modules/es.object.lookup-setter.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/object-prototype-accessors-forced.js"),s=r("./node_modules/core-js/internals/to-object.js"),a=r("./node_modules/core-js/internals/to-primitive.js"),l=r("./node_modules/core-js/internals/object-get-prototype-of.js"),c=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f;i&&n({target:"Object",proto:!0,forced:o},{__lookupSetter__:function(e){var t,r=s(this),n=a(e,!0);do if(t=c(r,n))return t.set;while(r=l(r))}})},"./node_modules/core-js/modules/es.object.prevent-extensions.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-object.js"),o=r("./node_modules/core-js/internals/internal-metadata.js").onFreeze,s=r("./node_modules/core-js/internals/freezing.js"),a=r("./node_modules/core-js/internals/fails.js"),l=Object.preventExtensions,c=a(function(){l(1)});n({target:"Object",stat:!0,forced:c,sham:!s},{preventExtensions:function(e){return l&&i(e)?l(o(e)):e}})},"./node_modules/core-js/modules/es.object.seal.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-object.js"),o=r("./node_modules/core-js/internals/internal-metadata.js").onFreeze,s=r("./node_modules/core-js/internals/freezing.js"),a=r("./node_modules/core-js/internals/fails.js"),l=Object.seal,c=a(function(){l(1)});n({target:"Object",stat:!0,forced:c,sham:!s},{seal:function(e){return l&&i(e)?l(o(e)):e}})},"./node_modules/core-js/modules/es.object.set-prototype-of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/object-set-prototype-of.js");n({target:"Object",stat:!0},{setPrototypeOf:i})},"./node_modules/core-js/modules/es.object.to-string.js":function(e,t,r){var n=r("./node_modules/core-js/internals/to-string-tag-support.js"),i=r("./node_modules/core-js/internals/redefine.js"),o=r("./node_modules/core-js/internals/object-to-string.js");n||i(Object.prototype,"toString",o,{unsafe:!0})},"./node_modules/core-js/modules/es.object.values.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/object-to-array.js").values;n({target:"Object",stat:!0},{values:function(e){return i(e)}})},"./node_modules/core-js/modules/es.parse-float.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/number-parse-float.js");n({global:!0,forced:parseFloat!=i},{parseFloat:i})},"./node_modules/core-js/modules/es.parse-int.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/number-parse-int.js");n({global:!0,forced:parseInt!=i},{parseInt:i})},"./node_modules/core-js/modules/es.promise.all-settled.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/a-function.js"),o=r("./node_modules/core-js/internals/new-promise-capability.js"),s=r("./node_modules/core-js/internals/perform.js"),a=r("./node_modules/core-js/internals/iterate.js");n({target:"Promise",stat:!0},{allSettled:function(e){var t=this,r=o.f(t),n=r.resolve,l=r.reject,c=s(function(){var r=i(t.resolve),o=[],s=0,l=1;a(e,function(e){var i=s++,a=!1;o.push(void 0),l++,r.call(t,e).then(function(e){a||(a=!0,o[i]={status:"fulfilled",value:e},--l||n(o))},function(e){a||(a=!0,o[i]={status:"rejected",reason:e},--l||n(o))})}),--l||n(o)});return c.error&&l(c.value),r.promise}})},"./node_modules/core-js/modules/es.promise.finally.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/native-promise-constructor.js"),s=r("./node_modules/core-js/internals/fails.js"),a=r("./node_modules/core-js/internals/get-built-in.js"),l=r("./node_modules/core-js/internals/species-constructor.js"),c=r("./node_modules/core-js/internals/promise-resolve.js"),u=r("./node_modules/core-js/internals/redefine.js"),d=!!o&&s(function(){o.prototype["finally"].call({then:function(){}},function(){})});n({target:"Promise",proto:!0,real:!0,forced:d},{"finally":function(e){var t=l(this,a("Promise")),r="function"==typeof e;return this.then(r?function(r){return c(t,e()).then(function(){return r})}:e,r?function(r){return c(t,e()).then(function(){throw r})}:e)}}),i||"function"!=typeof o||o.prototype["finally"]||u(o.prototype,"finally",a("Promise").prototype["finally"])},"./node_modules/core-js/modules/es.promise.js":function(e,t,r){"use strict";var n,i,o,s,a=r("./node_modules/core-js/internals/export.js"),l=r("./node_modules/core-js/internals/is-pure.js"),c=r("./node_modules/core-js/internals/global.js"),u=r("./node_modules/core-js/internals/get-built-in.js"),d=r("./node_modules/core-js/internals/native-promise-constructor.js"),h=r("./node_modules/core-js/internals/redefine.js"),f=r("./node_modules/core-js/internals/redefine-all.js"),p=r("./node_modules/core-js/internals/set-to-string-tag.js"),m=r("./node_modules/core-js/internals/set-species.js"),g=r("./node_modules/core-js/internals/is-object.js"),v=r("./node_modules/core-js/internals/a-function.js"),y=r("./node_modules/core-js/internals/an-instance.js"),_=r("./node_modules/core-js/internals/classof-raw.js"),b=r("./node_modules/core-js/internals/inspect-source.js"),x=r("./node_modules/core-js/internals/iterate.js"),w=r("./node_modules/core-js/internals/check-correctness-of-iteration.js"),E=r("./node_modules/core-js/internals/species-constructor.js"),S=r("./node_modules/core-js/internals/task.js").set,A=r("./node_modules/core-js/internals/microtask.js"),M=r("./node_modules/core-js/internals/promise-resolve.js"),T=r("./node_modules/core-js/internals/host-report-errors.js"),C=r("./node_modules/core-js/internals/new-promise-capability.js"),j=r("./node_modules/core-js/internals/perform.js"),P=r("./node_modules/core-js/internals/internal-state.js"),L=r("./node_modules/core-js/internals/is-forced.js"),D=r("./node_modules/core-js/internals/well-known-symbol.js"),I=r("./node_modules/core-js/internals/engine-v8-version.js"),R=D("species"),O="Promise",k=P.get,N=P.set,F=P.getterFor(O),V=d,U=c.TypeError,B=c.document,z=c.process,G=u("fetch"),H=C.f,W=H,q="process"==_(z),X=!!(B&&B.createEvent&&c.dispatchEvent),Y="unhandledrejection",K="rejectionhandled",Q=0,Z=1,J=2,$=1,ee=2,te=L(O,function(){var e=b(V)!==String(V);if(!e){if(66===I)return!0;if(!q&&"function"!=typeof PromiseRejectionEvent)return!0}if(l&&!V.prototype["finally"])return!0;if(I>=51&&/native code/.test(V))return!1;var t=V.resolve(1),r=function(e){e(function(){},function(){})},n=t.constructor={};return n[R]=r,!(t.then(function(){})instanceof r)}),re=te||!w(function(e){V.all(e)["catch"](function(){})}),ne=function(e){var t;return g(e)&&"function"==typeof(t=e.then)?t:!1},ie=function(e,t,r){if(!t.notified){t.notified=!0;var n=t.reactions;A(function(){for(var i=t.value,o=t.state==Z,s=0;n.length>s;){var a,l,c,u=n[s++],d=o?u.ok:u.fail,h=u.resolve,f=u.reject,p=u.domain;try{d?(o||(t.rejection===ee&&le(e,t),t.rejection=$),d===!0?a=i:(p&&p.enter(),a=d(i),p&&(p.exit(),c=!0)),a===u.promise?f(U("Promise-chain cycle")):(l=ne(a))?l.call(a,h,f):h(a)):f(i)}catch(m){p&&!c&&p.exit(),f(m)}}t.reactions=[],t.notified=!1,r&&!t.rejection&&se(e,t)})}},oe=function(e,t,r){var n,i;X?(n=B.createEvent("Event"),n.promise=t,n.reason=r,n.initEvent(e,!1,!0),c.dispatchEvent(n)):n={promise:t,reason:r},(i=c["on"+e])?i(n):e===Y&&T("Unhandled promise rejection",r)},se=function(e,t){S.call(c,function(){var r,n=t.value,i=ae(t);if(i&&(r=j(function(){q?z.emit("unhandledRejection",n,e):oe(Y,e,n)}),t.rejection=q||ae(t)?ee:$,r.error))throw r.value})},ae=function(e){return e.rejection!==$&&!e.parent},le=function(e,t){S.call(c,function(){q?z.emit("rejectionHandled",e):oe(K,e,t.value)})},ce=function(e,t,r,n){return function(i){e(t,r,i,n)}},ue=function(e,t,r,n){t.done||(t.done=!0,n&&(t=n),t.value=r,t.state=J,ie(e,t,!0))},de=function(e,t,r,n){if(!t.done){t.done=!0,n&&(t=n);try{if(e===r)throw U("Promise can't be resolved itself");var i=ne(r);i?A(function(){var n={done:!1};try{i.call(r,ce(de,e,n,t),ce(ue,e,n,t))}catch(o){ue(e,n,o,t)}}):(t.value=r,t.state=Z,ie(e,t,!1))}catch(o){ue(e,{done:!1},o,t)}}};te&&(V=function(e){y(this,V,O),v(e),n.call(this);var t=k(this);try{e(ce(de,this,t),ce(ue,this,t))}catch(r){ue(this,t,r)}},n=function(e){N(this,{type:O,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:Q,value:void 0})},n.prototype=f(V.prototype,{then:function(e,t){var r=F(this),n=H(E(this,V));return n.ok="function"==typeof e?e:!0,n.fail="function"==typeof t&&t,n.domain=q?z.domain:void 0,r.parent=!0,r.reactions.push(n),r.state!=Q&&ie(this,r,!1),n.promise},"catch":function(e){return this.then(void 0,e)}}),i=function(){var e=new n,t=k(e);this.promise=e,this.resolve=ce(de,e,t),this.reject=ce(ue,e,t)},C.f=H=function(e){return e===V||e===o?new i(e):W(e)},l||"function"!=typeof d||(s=d.prototype.then,h(d.prototype,"then",function(e,t){var r=this;return new V(function(e,t){s.call(r,e,t)}).then(e,t)},{unsafe:!0}),"function"==typeof G&&a({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return M(V,G.apply(c,arguments))}}))),a({global:!0,wrap:!0,forced:te},{Promise:V}),p(V,O,!1,!0),m(O),o=u(O),a({target:O,stat:!0,forced:te},{reject:function(e){var t=H(this);return t.reject.call(void 0,e),t.promise}}),a({target:O,stat:!0,forced:l||te},{resolve:function(e){return M(l&&this===o?V:this,e)}}),a({target:O,stat:!0,forced:re},{all:function(e){var t=this,r=H(t),n=r.resolve,i=r.reject,o=j(function(){var r=v(t.resolve),o=[],s=0,a=1;x(e,function(e){var l=s++,c=!1;o.push(void 0),a++,r.call(t,e).then(function(e){c||(c=!0,o[l]=e,--a||n(o))},i)}),--a||n(o)});return o.error&&i(o.value),r.promise},race:function(e){var t=this,r=H(t),n=r.reject,i=j(function(){var i=v(t.resolve);x(e,function(e){i.call(t,e).then(r.resolve,n)})});return i.error&&n(i.value),r.promise}})},"./node_modules/core-js/modules/es.reflect.apply.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/get-built-in.js"),o=r("./node_modules/core-js/internals/a-function.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/fails.js"),l=i("Reflect","apply"),c=Function.apply,u=!a(function(){l(function(){})});n({target:"Reflect",stat:!0,forced:u},{apply:function(e,t,r){return o(e),s(r),l?l(e,t,r):c.call(e,t,r)}})},"./node_modules/core-js/modules/es.reflect.construct.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/get-built-in.js"),o=r("./node_modules/core-js/internals/a-function.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/is-object.js"),l=r("./node_modules/core-js/internals/object-create.js"),c=r("./node_modules/core-js/internals/function-bind.js"),u=r("./node_modules/core-js/internals/fails.js"),d=i("Reflect","construct"),h=u(function(){function e(){}return!(d(function(){},[],e)instanceof e)}),f=!u(function(){d(function(){})}),p=h||f;n({target:"Reflect",stat:!0,forced:p,sham:p},{construct:function(e,t){o(e),s(t);var r=arguments.length<3?e:o(arguments[2]);if(f&&!h)return d(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(c.apply(e,n))}var i=r.prototype,u=l(a(i)?i:Object.prototype),p=Function.apply.call(e,u,t);return a(p)?p:u}})},"./node_modules/core-js/modules/es.reflect.define-property.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/to-primitive.js"),a=r("./node_modules/core-js/internals/object-define-property.js"),l=r("./node_modules/core-js/internals/fails.js"),c=l(function(){Reflect.defineProperty(a.f({},1,{value:1}),1,{value:2})});n({target:"Reflect",stat:!0,forced:c,sham:!i},{defineProperty:function(e,t,r){o(e);var n=s(t,!0);o(r);try{return a.f(e,n,r),!0}catch(i){return!1}}})},"./node_modules/core-js/modules/es.reflect.delete-property.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/an-object.js"),o=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f;n({target:"Reflect",stat:!0},{deleteProperty:function(e,t){var r=o(i(e),t);return r&&!r.configurable?!1:delete e[t]}})},"./node_modules/core-js/modules/es.reflect.get-own-property-descriptor.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js");n({target:"Reflect",stat:!0,sham:!i},{getOwnPropertyDescriptor:function(e,t){return s.f(o(e),t)}})},"./node_modules/core-js/modules/es.reflect.get-prototype-of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/an-object.js"),o=r("./node_modules/core-js/internals/object-get-prototype-of.js"),s=r("./node_modules/core-js/internals/correct-prototype-getter.js");n({target:"Reflect",stat:!0,sham:!s},{getPrototypeOf:function(e){return o(i(e))}})},"./node_modules/core-js/modules/es.reflect.get.js":function(e,t,r){function n(e,t){var r,i,u=arguments.length<3?e:arguments[2];return s(e)===u?e[t]:(r=l.f(e,t))?a(r,"value")?r.value:void 0===r.get?void 0:r.get.call(u):o(i=c(e))?n(i,t,u):void 0}var i=r("./node_modules/core-js/internals/export.js"),o=r("./node_modules/core-js/internals/is-object.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/has.js"),l=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),c=r("./node_modules/core-js/internals/object-get-prototype-of.js");i({target:"Reflect",stat:!0},{get:n})},"./node_modules/core-js/modules/es.reflect.has.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Reflect",stat:!0},{has:function(e,t){return t in e}})},"./node_modules/core-js/modules/es.reflect.is-extensible.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/an-object.js"),o=Object.isExtensible;n({target:"Reflect",stat:!0},{isExtensible:function(e){return i(e),o?o(e):!0}})},"./node_modules/core-js/modules/es.reflect.own-keys.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/own-keys.js");n({target:"Reflect",stat:!0},{ownKeys:i})},"./node_modules/core-js/modules/es.reflect.prevent-extensions.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/get-built-in.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/freezing.js");n({target:"Reflect",stat:!0,sham:!s},{preventExtensions:function(e){o(e);try{var t=i("Object","preventExtensions");return t&&t(e),!0}catch(r){return!1}}})},"./node_modules/core-js/modules/es.reflect.set-prototype-of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/an-object.js"),o=r("./node_modules/core-js/internals/a-possible-prototype.js"),s=r("./node_modules/core-js/internals/object-set-prototype-of.js");s&&n({target:"Reflect",stat:!0},{setPrototypeOf:function(e,t){i(e),o(t);try{return s(e,t),!0}catch(r){return!1}}})},"./node_modules/core-js/modules/es.reflect.set.js":function(e,t,r){function n(e,t,r){var i,l,f=arguments.length<4?e:arguments[3],p=u.f(o(e),t);if(!p){if(s(l=d(e)))return n(l,t,r,f);p=h(0)}if(a(p,"value")){if(p.writable===!1||!s(f))return!1;if(i=u.f(f,t)){if(i.get||i.set||i.writable===!1)return!1;i.value=r,c.f(f,t,i)}else c.f(f,t,h(0,r));return!0}return void 0===p.set?!1:(p.set.call(f,r),!0)}var i=r("./node_modules/core-js/internals/export.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/is-object.js"),a=r("./node_modules/core-js/internals/has.js"),l=r("./node_modules/core-js/internals/fails.js"),c=r("./node_modules/core-js/internals/object-define-property.js"),u=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),d=r("./node_modules/core-js/internals/object-get-prototype-of.js"),h=r("./node_modules/core-js/internals/create-property-descriptor.js"),f=l(function(){var e=c.f({},"a",{configurable:!0});return Reflect.set(d(e),"a",1,e)!==!1});i({target:"Reflect",stat:!0,forced:f},{set:n})},"./node_modules/core-js/modules/es.regexp.constructor.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/is-forced.js"),s=r("./node_modules/core-js/internals/inherit-if-required.js"),a=r("./node_modules/core-js/internals/object-define-property.js").f,l=r("./node_modules/core-js/internals/object-get-own-property-names.js").f,c=r("./node_modules/core-js/internals/is-regexp.js"),u=r("./node_modules/core-js/internals/regexp-flags.js"),d=r("./node_modules/core-js/internals/regexp-sticky-helpers.js"),h=r("./node_modules/core-js/internals/redefine.js"),f=r("./node_modules/core-js/internals/fails.js"),p=r("./node_modules/core-js/internals/internal-state.js").set,m=r("./node_modules/core-js/internals/set-species.js"),g=r("./node_modules/core-js/internals/well-known-symbol.js"),v=g("match"),y=i.RegExp,_=y.prototype,b=/a/g,x=/a/g,w=new y(b)!==b,E=d.UNSUPPORTED_Y,S=n&&o("RegExp",!w||E||f(function(){return x[v]=!1,y(b)!=b||y(x)==x||"/a/i"!=y(b,"i")}));if(S){for(var A=function(e,t){var r,n=this instanceof A,i=c(e),o=void 0===t;if(!n&&i&&e.constructor===A&&o)return e;w?i&&!o&&(e=e.source):e instanceof A&&(o&&(t=u.call(e)),e=e.source),E&&(r=!!t&&t.indexOf("y")>-1,r&&(t=t.replace(/y/g,"")));var a=s(w?new y(e,t):y(e,t),n?this:_,A);return E&&r&&p(a,{sticky:r}),a},M=(function(e){e in A||a(A,e,{configurable:!0,get:function(){return y[e]},set:function(t){y[e]=t}})}),T=l(y),C=0;T.length>C;)M(T[C++]);_.constructor=A,A.prototype=_,h(i,"RegExp",A)}m("RegExp")},"./node_modules/core-js/modules/es.regexp.exec.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/regexp-exec.js");n({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},"./node_modules/core-js/modules/es.regexp.flags.js":function(e,t,r){var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/object-define-property.js"),o=r("./node_modules/core-js/internals/regexp-flags.js"),s=r("./node_modules/core-js/internals/regexp-sticky-helpers.js").UNSUPPORTED_Y;n&&("g"!=/./g.flags||s)&&i.f(RegExp.prototype,"flags",{configurable:!0,get:o})},"./node_modules/core-js/modules/es.regexp.to-string.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/redefine.js"),i=r("./node_modules/core-js/internals/an-object.js"),o=r("./node_modules/core-js/internals/fails.js"),s=r("./node_modules/core-js/internals/regexp-flags.js"),a="toString",l=RegExp.prototype,c=l[a],u=o(function(){return"/a/b"!=c.call({source:"a",flags:"b"})}),d=c.name!=a;(u||d)&&n(RegExp.prototype,a,function(){var e=i(this),t=String(e.source),r=e.flags,n=String(void 0===r&&e instanceof RegExp&&!("flags"in l)?s.call(e):r);return"/"+t+"/"+n},{unsafe:!0})},"./node_modules/core-js/modules/es.set.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/collection.js"),i=r("./node_modules/core-js/internals/collection-strong.js");e.exports=n("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},i)},"./node_modules/core-js/modules/es.string.anchor.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("anchor")},{anchor:function(e){return i(this,"a","name",e)}})},"./node_modules/core-js/modules/es.string.big.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("big")},{big:function(){return i(this,"big","","")}})},"./node_modules/core-js/modules/es.string.blink.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("blink")},{blink:function(){return i(this,"blink","","")}})},"./node_modules/core-js/modules/es.string.bold.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("bold")},{bold:function(){return i(this,"b","","")}})},"./node_modules/core-js/modules/es.string.code-point-at.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/string-multibyte.js").codeAt;n({target:"String",proto:!0},{codePointAt:function(e){return i(this,e)}})},"./node_modules/core-js/modules/es.string.ends-with.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,o=r("./node_modules/core-js/internals/to-length.js"),s=r("./node_modules/core-js/internals/not-a-regexp.js"),a=r("./node_modules/core-js/internals/require-object-coercible.js"),l=r("./node_modules/core-js/internals/correct-is-regexp-logic.js"),c=r("./node_modules/core-js/internals/is-pure.js"),u="".endsWith,d=Math.min,h=l("endsWith"),f=!c&&!h&&!!function(){var e=i(String.prototype,"endsWith");return e&&!e.writable}();n({target:"String",proto:!0,forced:!f&&!h},{endsWith:function(e){var t=String(a(this));s(e);var r=arguments.length>1?arguments[1]:void 0,n=o(t.length),i=void 0===r?n:d(o(r),n),l=String(e);return u?u.call(t,l,i):t.slice(i-l.length,i)===l}})},"./node_modules/core-js/modules/es.string.fixed.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("fixed")},{fixed:function(){return i(this,"tt","","")}})},"./node_modules/core-js/modules/es.string.fontcolor.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("fontcolor")},{fontcolor:function(e){return i(this,"font","color",e)}})},"./node_modules/core-js/modules/es.string.fontsize.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("fontsize")},{fontsize:function(e){return i(this,"font","size",e)}})},"./node_modules/core-js/modules/es.string.from-code-point.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/to-absolute-index.js"),o=String.fromCharCode,s=String.fromCodePoint,a=!!s&&1!=s.length;n({target:"String",stat:!0,forced:a},{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,s=0;n>s;){if(t=+arguments[s++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(65536>t?o(t):o(((t-=65536)>>10)+55296,t%1024+56320))}return r.join("")}})},"./node_modules/core-js/modules/es.string.includes.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/not-a-regexp.js"),o=r("./node_modules/core-js/internals/require-object-coercible.js"),s=r("./node_modules/core-js/internals/correct-is-regexp-logic.js");n({target:"String",proto:!0,forced:!s("includes")},{includes:function(e){return!!~String(o(this)).indexOf(i(e),arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.string.italics.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("italics")},{italics:function(){return i(this,"i","","")}})},"./node_modules/core-js/modules/es.string.iterator.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/string-multibyte.js").charAt,i=r("./node_modules/core-js/internals/internal-state.js"),o=r("./node_modules/core-js/internals/define-iterator.js"),s="String Iterator",a=i.set,l=i.getterFor(s);o(String,"String",function(e){a(this,{type:s,string:String(e),index:0})},function(){var e,t=l(this),r=t.string,i=t.index;return i>=r.length?{value:void 0,done:!0}:(e=n(r,i),t.index+=e.length,{value:e,done:!1})})},"./node_modules/core-js/modules/es.string.link.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("link")},{link:function(e){return i(this,"a","href",e)}})},"./node_modules/core-js/modules/es.string.match-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-iterator-constructor.js"),o=r("./node_modules/core-js/internals/require-object-coercible.js"),s=r("./node_modules/core-js/internals/to-length.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/an-object.js"),c=r("./node_modules/core-js/internals/classof-raw.js"),u=r("./node_modules/core-js/internals/is-regexp.js"),d=r("./node_modules/core-js/internals/regexp-flags.js"),h=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),f=r("./node_modules/core-js/internals/fails.js"),p=r("./node_modules/core-js/internals/well-known-symbol.js"),m=r("./node_modules/core-js/internals/species-constructor.js"),g=r("./node_modules/core-js/internals/advance-string-index.js"),v=r("./node_modules/core-js/internals/internal-state.js"),y=r("./node_modules/core-js/internals/is-pure.js"),_=p("matchAll"),b="RegExp String",x=b+" Iterator",w=v.set,E=v.getterFor(x),S=RegExp.prototype,A=S.exec,M="".matchAll,T=!!M&&!f(function(){"a".matchAll(/./)}),C=function(e,t){var r,n=e.exec;if("function"==typeof n){if(r=n.call(e,t),"object"!=typeof r)throw TypeError("Incorrect exec result");return r}return A.call(e,t)},j=i(function(e,t,r,n){w(this,{type:x,regexp:e,string:t,global:r,unicode:n,done:!1})},b,function(){var e=E(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,r=e.string,n=C(t,r);return null===n?{value:void 0,done:e.done=!0}:e.global?(""==String(n[0])&&(t.lastIndex=g(r,s(t.lastIndex),e.unicode)),{value:n,done:!1}):(e.done=!0,{value:n,done:!1})}),P=function(e){var t,r,n,i,o,a,c=l(this),u=String(e);return t=m(c,RegExp),r=c.flags,void 0===r&&c instanceof RegExp&&!("flags"in S)&&(r=d.call(c)),n=void 0===r?"":String(r),i=new t(t===RegExp?c.source:c,n),o=!!~n.indexOf("g"),a=!!~n.indexOf("u"),i.lastIndex=s(c.lastIndex),new j(i,u,o,a)};n({target:"String",proto:!0,forced:T},{matchAll:function(e){var t,r,n,i,s=o(this);if(null!=e){if(u(e)&&(t=String(o("flags"in S?e.flags:d.call(e))),!~t.indexOf("g")))throw TypeError("`.matchAll` does not allow non-global regexes");if(T)return M.apply(s,arguments);if(n=e[_],void 0===n&&y&&"RegExp"==c(e)&&(n=P),null!=n)return a(n).call(e,s)}else if(T)return M.apply(s,arguments);return r=String(s),i=new RegExp(e,"g"),y?P.call(i,r):i[_](r)}}),y||_ in S||h(S,_,P)},"./node_modules/core-js/modules/es.string.match.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js"),i=r("./node_modules/core-js/internals/an-object.js"),o=r("./node_modules/core-js/internals/to-length.js"),s=r("./node_modules/core-js/internals/require-object-coercible.js"),a=r("./node_modules/core-js/internals/advance-string-index.js"),l=r("./node_modules/core-js/internals/regexp-exec-abstract.js");n("match",1,function(e,t,r){return[function(t){var r=s(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var s=i(e),c=String(this);if(!s.global)return l(s,c);var u=s.unicode;s.lastIndex=0;for(var d,h=[],f=0;null!==(d=l(s,c));){var p=String(d[0]);h[f]=p,""===p&&(s.lastIndex=a(c,o(s.lastIndex),u)),f++}return 0===f?null:h}]})},"./node_modules/core-js/modules/es.string.pad-end.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/string-pad.js").end,o=r("./node_modules/core-js/internals/string-pad-webkit-bug.js");n({target:"String",proto:!0,forced:o},{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0);
}})},"./node_modules/core-js/modules/es.string.pad-start.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/string-pad.js").start,o=r("./node_modules/core-js/internals/string-pad-webkit-bug.js");n({target:"String",proto:!0,forced:o},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.string.raw.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/to-indexed-object.js"),o=r("./node_modules/core-js/internals/to-length.js");n({target:"String",stat:!0},{raw:function(e){for(var t=i(e.raw),r=o(t.length),n=arguments.length,s=[],a=0;r>a;)s.push(String(t[a++])),n>a&&s.push(String(arguments[a]));return s.join("")}})},"./node_modules/core-js/modules/es.string.repeat.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/string-repeat.js");n({target:"String",proto:!0},{repeat:i})},"./node_modules/core-js/modules/es.string.replace.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js"),i=r("./node_modules/core-js/internals/an-object.js"),o=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/to-length.js"),a=r("./node_modules/core-js/internals/to-integer.js"),l=r("./node_modules/core-js/internals/require-object-coercible.js"),c=r("./node_modules/core-js/internals/advance-string-index.js"),u=r("./node_modules/core-js/internals/regexp-exec-abstract.js"),d=Math.max,h=Math.min,f=Math.floor,p=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g,g=function(e){return void 0===e?e:String(e)};n("replace",2,function(e,t,r,n){function v(e,r,n,i,s,a){var l=n+e.length,c=i.length,u=m;return void 0!==s&&(s=o(s),u=p),t.call(a,u,function(t,o){var a;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return r.slice(0,n);case"'":return r.slice(l);case"<":a=s[o.slice(1,-1)];break;default:var u=+o;if(0===u)return t;if(u>c){var d=f(u/10);return 0===d?t:c>=d?void 0===i[d-1]?o.charAt(1):i[d-1]+o.charAt(1):t}a=i[u-1]}return void 0===a?"":a})}var y=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,_=n.REPLACE_KEEPS_$0,b=y?"$":"$0";return[function(r,n){var i=l(this),o=void 0==r?void 0:r[e];return void 0!==o?o.call(r,i,n):t.call(String(i),r,n)},function(e,n){if(!y&&_||"string"==typeof n&&-1===n.indexOf(b)){var o=r(t,e,this,n);if(o.done)return o.value}var l=i(e),f=String(this),p="function"==typeof n;p||(n=String(n));var m=l.global;if(m){var x=l.unicode;l.lastIndex=0}for(var w=[];;){var E=u(l,f);if(null===E)break;if(w.push(E),!m)break;var S=String(E[0]);""===S&&(l.lastIndex=c(f,s(l.lastIndex),x))}for(var A="",M=0,T=0;T<w.length;T++){E=w[T];for(var C=String(E[0]),j=d(h(a(E.index),f.length),0),P=[],L=1;L<E.length;L++)P.push(g(E[L]));var D=E.groups;if(p){var I=[C].concat(P,j,f);void 0!==D&&I.push(D);var R=String(n.apply(void 0,I))}else R=v(C,f,j,P,D,n);j>=M&&(A+=f.slice(M,j)+R,M=j+C.length)}return A+f.slice(M)}]})},"./node_modules/core-js/modules/es.string.search.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js"),i=r("./node_modules/core-js/internals/an-object.js"),o=r("./node_modules/core-js/internals/require-object-coercible.js"),s=r("./node_modules/core-js/internals/same-value.js"),a=r("./node_modules/core-js/internals/regexp-exec-abstract.js");n("search",1,function(e,t,r){return[function(t){var r=o(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var o=i(e),l=String(this),c=o.lastIndex;s(c,0)||(o.lastIndex=0);var u=a(o,l);return s(o.lastIndex,c)||(o.lastIndex=c),null===u?-1:u.index}]})},"./node_modules/core-js/modules/es.string.small.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("small")},{small:function(){return i(this,"small","","")}})},"./node_modules/core-js/modules/es.string.split.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js"),i=r("./node_modules/core-js/internals/is-regexp.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/require-object-coercible.js"),a=r("./node_modules/core-js/internals/species-constructor.js"),l=r("./node_modules/core-js/internals/advance-string-index.js"),c=r("./node_modules/core-js/internals/to-length.js"),u=r("./node_modules/core-js/internals/regexp-exec-abstract.js"),d=r("./node_modules/core-js/internals/regexp-exec.js"),h=r("./node_modules/core-js/internals/fails.js"),f=[].push,p=Math.min,m=4294967295,g=!h(function(){return!RegExp(m,"y")});n("split",2,function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=String(s(this)),o=void 0===r?m:r>>>0;if(0===o)return[];if(void 0===e)return[n];if(!i(e))return t.call(n,e,o);for(var a,l,c,u=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,g=new RegExp(e.source,h+"g");(a=d.call(g,n))&&(l=g.lastIndex,!(l>p&&(u.push(n.slice(p,a.index)),a.length>1&&a.index<n.length&&f.apply(u,a.slice(1)),c=a[0].length,p=l,u.length>=o)));)g.lastIndex===a.index&&g.lastIndex++;return p===n.length?(c||!g.test(""))&&u.push(""):u.push(n.slice(p)),u.length>o?u.slice(0,o):u}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var i=s(this),o=void 0==t?void 0:t[e];return void 0!==o?o.call(t,i,r):n.call(String(i),t,r)},function(e,i){var s=r(n,e,this,i,n!==t);if(s.done)return s.value;var d=o(e),h=String(this),f=a(d,RegExp),v=d.unicode,y=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(g?"y":"g"),_=new f(g?d:"^(?:"+d.source+")",y),b=void 0===i?m:i>>>0;if(0===b)return[];if(0===h.length)return null===u(_,h)?[h]:[];for(var x=0,w=0,E=[];w<h.length;){_.lastIndex=g?w:0;var S,A=u(_,g?h:h.slice(w));if(null===A||(S=p(c(_.lastIndex+(g?0:w)),h.length))===x)w=l(h,w,v);else{if(E.push(h.slice(x,w)),E.length===b)return E;for(var M=1;M<=A.length-1;M++)if(E.push(A[M]),E.length===b)return E;w=x=S}}return E.push(h.slice(x)),E}]},!g)},"./node_modules/core-js/modules/es.string.starts-with.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,o=r("./node_modules/core-js/internals/to-length.js"),s=r("./node_modules/core-js/internals/not-a-regexp.js"),a=r("./node_modules/core-js/internals/require-object-coercible.js"),l=r("./node_modules/core-js/internals/correct-is-regexp-logic.js"),c=r("./node_modules/core-js/internals/is-pure.js"),u="".startsWith,d=Math.min,h=l("startsWith"),f=!c&&!h&&!!function(){var e=i(String.prototype,"startsWith");return e&&!e.writable}();n({target:"String",proto:!0,forced:!f&&!h},{startsWith:function(e){var t=String(a(this));s(e);var r=o(d(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return u?u.call(t,n,r):t.slice(r,r+n.length)===n}})},"./node_modules/core-js/modules/es.string.strike.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("strike")},{strike:function(){return i(this,"strike","","")}})},"./node_modules/core-js/modules/es.string.sub.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("sub")},{sub:function(){return i(this,"sub","","")}})},"./node_modules/core-js/modules/es.string.sup.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-html.js"),o=r("./node_modules/core-js/internals/string-html-forced.js");n({target:"String",proto:!0,forced:o("sup")},{sup:function(){return i(this,"sup","","")}})},"./node_modules/core-js/modules/es.string.trim-end.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/string-trim.js").end,o=r("./node_modules/core-js/internals/string-trim-forced.js"),s=o("trimEnd"),a=s?function(){return i(this)}:"".trimEnd;n({target:"String",proto:!0,forced:s},{trimEnd:a,trimRight:a})},"./node_modules/core-js/modules/es.string.trim-start.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/string-trim.js").start,o=r("./node_modules/core-js/internals/string-trim-forced.js"),s=o("trimStart"),a=s?function(){return i(this)}:"".trimStart;n({target:"String",proto:!0,forced:s},{trimStart:a,trimLeft:a})},"./node_modules/core-js/modules/es.string.trim.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/string-trim.js").trim,o=r("./node_modules/core-js/internals/string-trim-forced.js");n({target:"String",proto:!0,forced:o("trim")},{trim:function(){return i(this)}})},"./node_modules/core-js/modules/es.symbol.async-iterator.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("asyncIterator")},"./node_modules/core-js/modules/es.symbol.description.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/global.js"),s=r("./node_modules/core-js/internals/has.js"),a=r("./node_modules/core-js/internals/is-object.js"),l=r("./node_modules/core-js/internals/object-define-property.js").f,c=r("./node_modules/core-js/internals/copy-constructor-properties.js"),u=o.Symbol;if(i&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var d={},h=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof h?new u(e):void 0===e?u():u(e);return""===e&&(d[t]=!0),t};c(h,u);var f=h.prototype=u.prototype;f.constructor=h;var p=f.toString,m="Symbol(test)"==String(u("test")),g=/^Symbol\((.*)\)[^)]+$/;l(f,"description",{configurable:!0,get:function(){var e=a(this)?this.valueOf():this,t=p.call(e);if(s(d,e))return"";var r=m?t.slice(7,-1):t.replace(g,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:h})}},"./node_modules/core-js/modules/es.symbol.has-instance.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("hasInstance")},"./node_modules/core-js/modules/es.symbol.is-concat-spreadable.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("isConcatSpreadable")},"./node_modules/core-js/modules/es.symbol.iterator.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("iterator")},"./node_modules/core-js/modules/es.symbol.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/is-pure.js"),a=r("./node_modules/core-js/internals/descriptors.js"),l=r("./node_modules/core-js/internals/native-symbol.js"),c=r("./node_modules/core-js/internals/use-symbol-as-uid.js"),u=r("./node_modules/core-js/internals/fails.js"),d=r("./node_modules/core-js/internals/has.js"),h=r("./node_modules/core-js/internals/is-array.js"),f=r("./node_modules/core-js/internals/is-object.js"),p=r("./node_modules/core-js/internals/an-object.js"),m=r("./node_modules/core-js/internals/to-object.js"),g=r("./node_modules/core-js/internals/to-indexed-object.js"),v=r("./node_modules/core-js/internals/to-primitive.js"),y=r("./node_modules/core-js/internals/create-property-descriptor.js"),_=r("./node_modules/core-js/internals/object-create.js"),b=r("./node_modules/core-js/internals/object-keys.js"),x=r("./node_modules/core-js/internals/object-get-own-property-names.js"),w=r("./node_modules/core-js/internals/object-get-own-property-names-external.js"),E=r("./node_modules/core-js/internals/object-get-own-property-symbols.js"),S=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),A=r("./node_modules/core-js/internals/object-define-property.js"),M=r("./node_modules/core-js/internals/object-property-is-enumerable.js"),T=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),C=r("./node_modules/core-js/internals/redefine.js"),j=r("./node_modules/core-js/internals/shared.js"),P=r("./node_modules/core-js/internals/shared-key.js"),L=r("./node_modules/core-js/internals/hidden-keys.js"),D=r("./node_modules/core-js/internals/uid.js"),I=r("./node_modules/core-js/internals/well-known-symbol.js"),R=r("./node_modules/core-js/internals/well-known-symbol-wrapped.js"),O=r("./node_modules/core-js/internals/define-well-known-symbol.js"),k=r("./node_modules/core-js/internals/set-to-string-tag.js"),N=r("./node_modules/core-js/internals/internal-state.js"),F=r("./node_modules/core-js/internals/array-iteration.js").forEach,V=P("hidden"),U="Symbol",B="prototype",z=I("toPrimitive"),G=N.set,H=N.getterFor(U),W=Object[B],q=i.Symbol,X=o("JSON","stringify"),Y=S.f,K=A.f,Q=w.f,Z=M.f,J=j("symbols"),$=j("op-symbols"),ee=j("string-to-symbol-registry"),te=j("symbol-to-string-registry"),re=j("wks"),ne=i.QObject,ie=!ne||!ne[B]||!ne[B].findChild,oe=a&&u(function(){return 7!=_(K({},"a",{get:function(){return K(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=Y(W,t);n&&delete W[t],K(e,t,r),n&&e!==W&&K(W,t,n)}:K,se=function(e,t){var r=J[e]=_(q[B]);return G(r,{type:U,tag:e,description:t}),a||(r.description=t),r},ae=c?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof q},le=function(e,t,r){e===W&&le($,t,r),p(e);var n=v(t,!0);return p(r),d(J,n)?(r.enumerable?(d(e,V)&&e[V][n]&&(e[V][n]=!1),r=_(r,{enumerable:y(0,!1)})):(d(e,V)||K(e,V,y(1,{})),e[V][n]=!0),oe(e,n,r)):K(e,n,r)},ce=function(e,t){p(e);var r=g(t),n=b(r).concat(pe(r));return F(n,function(t){(!a||de.call(r,t))&&le(e,t,r[t])}),e},ue=function(e,t){return void 0===t?_(e):ce(_(e),t)},de=function(e){var t=v(e,!0),r=Z.call(this,t);return this===W&&d(J,t)&&!d($,t)?!1:r||!d(this,t)||!d(J,t)||d(this,V)&&this[V][t]?r:!0},he=function(e,t){var r=g(e),n=v(t,!0);if(r!==W||!d(J,n)||d($,n)){var i=Y(r,n);return!i||!d(J,n)||d(r,V)&&r[V][n]||(i.enumerable=!0),i}},fe=function(e){var t=Q(g(e)),r=[];return F(t,function(e){d(J,e)||d(L,e)||r.push(e)}),r},pe=function(e){var t=e===W,r=Q(t?$:g(e)),n=[];return F(r,function(e){!d(J,e)||t&&!d(W,e)||n.push(J[e])}),n};if(l||(q=function(){if(this instanceof q)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=D(e),r=function(e){this===W&&r.call($,e),d(this,V)&&d(this[V],t)&&(this[V][t]=!1),oe(this,t,y(1,e))};return a&&ie&&oe(W,t,{configurable:!0,set:r}),se(t,e)},C(q[B],"toString",function(){return H(this).tag}),C(q,"withoutSetter",function(e){return se(D(e),e)}),M.f=de,A.f=le,S.f=he,x.f=w.f=fe,E.f=pe,R.f=function(e){return se(I(e),e)},a&&(K(q[B],"description",{configurable:!0,get:function(){return H(this).description}}),s||C(W,"propertyIsEnumerable",de,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:q}),F(b(re),function(e){O(e)}),n({target:U,stat:!0,forced:!l},{"for":function(e){var t=String(e);if(d(ee,t))return ee[t];var r=q(t);return ee[t]=r,te[r]=t,r},keyFor:function(e){if(!ae(e))throw TypeError(e+" is not a symbol");return d(te,e)?te[e]:void 0},useSetter:function(){ie=!0},useSimple:function(){ie=!1}}),n({target:"Object",stat:!0,forced:!l,sham:!a},{create:ue,defineProperty:le,defineProperties:ce,getOwnPropertyDescriptor:he}),n({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:fe,getOwnPropertySymbols:pe}),n({target:"Object",stat:!0,forced:u(function(){E.f(1)})},{getOwnPropertySymbols:function(e){return E.f(m(e))}}),X){var me=!l||u(function(){var e=q();return"[null]"!=X([e])||"{}"!=X({a:e})||"{}"!=X(Object(e))});n({target:"JSON",stat:!0,forced:me},{stringify:function(e,t,r){for(var n,i=[e],o=1;arguments.length>o;)i.push(arguments[o++]);return n=t,!f(t)&&void 0===e||ae(e)?void 0:(h(t)||(t=function(e,t){return"function"==typeof n&&(t=n.call(this,e,t)),ae(t)?void 0:t}),i[1]=t,X.apply(null,i))}})}q[B][z]||T(q[B],z,q[B].valueOf),k(q,U),L[V]=!0},"./node_modules/core-js/modules/es.symbol.match.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("match")},"./node_modules/core-js/modules/es.symbol.replace.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("replace")},"./node_modules/core-js/modules/es.symbol.search.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("search")},"./node_modules/core-js/modules/es.symbol.species.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("species")},"./node_modules/core-js/modules/es.symbol.split.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("split")},"./node_modules/core-js/modules/es.symbol.to-primitive.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("toPrimitive")},"./node_modules/core-js/modules/es.symbol.to-string-tag.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("toStringTag")},"./node_modules/core-js/modules/es.symbol.unscopables.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("unscopables")},"./node_modules/core-js/modules/es.typed-array.copy-within.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-copy-within.js"),o=n.aTypedArray,s=n.exportTypedArrayMethod;s("copyWithin",function(e,t){return i.call(o(this),e,t,arguments.length>2?arguments[2]:void 0)})},"./node_modules/core-js/modules/es.typed-array.every.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-iteration.js").every,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("every",function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)})},"./node_modules/core-js/modules/es.typed-array.fill.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-fill.js"),o=n.aTypedArray,s=n.exportTypedArrayMethod;s("fill",function(e){return i.apply(o(this),arguments)})},"./node_modules/core-js/modules/es.typed-array.filter.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-iteration.js").filter,o=r("./node_modules/core-js/internals/species-constructor.js"),s=n.aTypedArray,a=n.aTypedArrayConstructor,l=n.exportTypedArrayMethod;l("filter",function(e){for(var t=i(s(this),e,arguments.length>1?arguments[1]:void 0),r=o(this,this.constructor),n=0,l=t.length,c=new(a(r))(l);l>n;)c[n]=t[n++];return c})},"./node_modules/core-js/modules/es.typed-array.find-index.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-iteration.js").findIndex,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("findIndex",function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)})},"./node_modules/core-js/modules/es.typed-array.find.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-iteration.js").find,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("find",function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)})},"./node_modules/core-js/modules/es.typed-array.float32-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/typed-array-constructor.js");n("Float32",function(e){return function(t,r,n){return e(this,t,r,n)}})},"./node_modules/core-js/modules/es.typed-array.float64-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/typed-array-constructor.js");n("Float64",function(e){return function(t,r,n){return e(this,t,r,n)}})},"./node_modules/core-js/modules/es.typed-array.for-each.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-iteration.js").forEach,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("forEach",function(e){i(o(this),e,arguments.length>1?arguments[1]:void 0)})},"./node_modules/core-js/modules/es.typed-array.from.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/typed-array-constructors-require-wrappers.js"),i=r("./node_modules/core-js/internals/array-buffer-view-core.js").exportTypedArrayStaticMethod,o=r("./node_modules/core-js/internals/typed-array-from.js");i("from",o,n)},"./node_modules/core-js/modules/es.typed-array.includes.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-includes.js").includes,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("includes",function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)})},"./node_modules/core-js/modules/es.typed-array.index-of.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-includes.js").indexOf,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("indexOf",function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)})},"./node_modules/core-js/modules/es.typed-array.int16-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/typed-array-constructor.js");n("Int16",function(e){return function(t,r,n){return e(this,t,r,n)}})},"./node_modules/core-js/modules/es.typed-array.int32-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/typed-array-constructor.js");n("Int32",function(e){return function(t,r,n){return e(this,t,r,n)}})},"./node_modules/core-js/modules/es.typed-array.int8-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/typed-array-constructor.js");n("Int8",function(e){return function(t,r,n){return e(this,t,r,n)}})},"./node_modules/core-js/modules/es.typed-array.iterator.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/array-buffer-view-core.js"),o=r("./node_modules/core-js/modules/es.array.iterator.js"),s=r("./node_modules/core-js/internals/well-known-symbol.js"),a=s("iterator"),l=n.Uint8Array,c=o.values,u=o.keys,d=o.entries,h=i.aTypedArray,f=i.exportTypedArrayMethod,p=l&&l.prototype[a],m=!!p&&("values"==p.name||void 0==p.name),g=function(){return c.call(h(this))};f("entries",function(){return d.call(h(this))}),f("keys",function(){return u.call(h(this))}),f("values",g,!m),f(a,g,!m)},"./node_modules/core-js/modules/es.typed-array.join.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=n.aTypedArray,o=n.exportTypedArrayMethod,s=[].join;o("join",function(e){return s.apply(i(this),arguments)})},"./node_modules/core-js/modules/es.typed-array.last-index-of.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-last-index-of.js"),o=n.aTypedArray,s=n.exportTypedArrayMethod;s("lastIndexOf",function(e){return i.apply(o(this),arguments)})},"./node_modules/core-js/modules/es.typed-array.map.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-iteration.js").map,o=r("./node_modules/core-js/internals/species-constructor.js"),s=n.aTypedArray,a=n.aTypedArrayConstructor,l=n.exportTypedArrayMethod;l("map",function(e){return i(s(this),e,arguments.length>1?arguments[1]:void 0,function(e,t){return new(a(o(e,e.constructor)))(t)})})},"./node_modules/core-js/modules/es.typed-array.of.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/typed-array-constructors-require-wrappers.js"),o=n.aTypedArrayConstructor,s=n.exportTypedArrayStaticMethod;s("of",function(){for(var e=0,t=arguments.length,r=new(o(this))(t);t>e;)r[e]=arguments[e++];return r},i)},"./node_modules/core-js/modules/es.typed-array.reduce-right.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-reduce.js").right,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("reduceRight",function(e){return i(o(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)})},"./node_modules/core-js/modules/es.typed-array.reduce.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-reduce.js").left,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("reduce",function(e){return i(o(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)})},"./node_modules/core-js/modules/es.typed-array.reverse.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=n.aTypedArray,o=n.exportTypedArrayMethod,s=Math.floor;o("reverse",function(){for(var e,t=this,r=i(t).length,n=s(r/2),o=0;n>o;)e=t[o],t[o++]=t[--r],t[r]=e;return t})},"./node_modules/core-js/modules/es.typed-array.set.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/to-length.js"),o=r("./node_modules/core-js/internals/to-offset.js"),s=r("./node_modules/core-js/internals/to-object.js"),a=r("./node_modules/core-js/internals/fails.js"),l=n.aTypedArray,c=n.exportTypedArrayMethod,u=a(function(){new Int8Array(1).set({})});c("set",function(e){l(this);var t=o(arguments.length>1?arguments[1]:void 0,1),r=this.length,n=s(e),a=i(n.length),c=0;if(a+t>r)throw RangeError("Wrong length");for(;a>c;)this[t+c]=n[c++]},u)},"./node_modules/core-js/modules/es.typed-array.slice.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/species-constructor.js"),o=r("./node_modules/core-js/internals/fails.js"),s=n.aTypedArray,a=n.aTypedArrayConstructor,l=n.exportTypedArrayMethod,c=[].slice,u=o(function(){new Int8Array(1).slice()});l("slice",function(e,t){for(var r=c.call(s(this),e,t),n=i(this,this.constructor),o=0,l=r.length,u=new(a(n))(l);l>o;)u[o]=r[o++];return u},u)},"./node_modules/core-js/modules/es.typed-array.some.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/array-iteration.js").some,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("some",function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)})},"./node_modules/core-js/modules/es.typed-array.sort.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=n.aTypedArray,o=n.exportTypedArrayMethod,s=[].sort;o("sort",function(e){return s.call(i(this),e)})},"./node_modules/core-js/modules/es.typed-array.subarray.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js"),i=r("./node_modules/core-js/internals/to-length.js"),o=r("./node_modules/core-js/internals/to-absolute-index.js"),s=r("./node_modules/core-js/internals/species-constructor.js"),a=n.aTypedArray,l=n.exportTypedArrayMethod;l("subarray",function(e,t){var r=a(this),n=r.length,l=o(e,n);return new(s(r,r.constructor))(r.buffer,r.byteOffset+l*r.BYTES_PER_ELEMENT,i((void 0===t?n:o(t,n))-l))})},"./node_modules/core-js/modules/es.typed-array.to-locale-string.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/array-buffer-view-core.js"),o=r("./node_modules/core-js/internals/fails.js"),s=n.Int8Array,a=i.aTypedArray,l=i.exportTypedArrayMethod,c=[].toLocaleString,u=[].slice,d=!!s&&o(function(){c.call(new s(1))}),h=o(function(){return[1,2].toLocaleString()!=new s([1,2]).toLocaleString()})||!o(function(){s.prototype.toLocaleString.call([1,2])});l("toLocaleString",function(){return c.apply(d?u.call(a(this)):a(this),arguments)},h)},"./node_modules/core-js/modules/es.typed-array.to-string.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/array-buffer-view-core.js").exportTypedArrayMethod,i=r("./node_modules/core-js/internals/fails.js"),o=r("./node_modules/core-js/internals/global.js"),s=o.Uint8Array,a=s&&s.prototype||{},l=[].toString,c=[].join;i(function(){l.call({})})&&(l=function(){return c.call(this)});var u=a.toString!=l;n("toString",l,u)},"./node_modules/core-js/modules/es.typed-array.uint16-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/typed-array-constructor.js");n("Uint16",function(e){return function(t,r,n){return e(this,t,r,n)}})},"./node_modules/core-js/modules/es.typed-array.uint32-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/typed-array-constructor.js");n("Uint32",function(e){return function(t,r,n){return e(this,t,r,n)}})},"./node_modules/core-js/modules/es.typed-array.uint8-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/typed-array-constructor.js");n("Uint8",function(e){return function(t,r,n){return e(this,t,r,n)}})},"./node_modules/core-js/modules/es.typed-array.uint8-clamped-array.js":function(e,t,r){var n=r("./node_modules/core-js/internals/typed-array-constructor.js");n("Uint8",function(e){return function(t,r,n){return e(this,t,r,n)}},!0)},"./node_modules/core-js/modules/es.weak-map.js":function(e,t,r){"use strict";var n,i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/redefine-all.js"),s=r("./node_modules/core-js/internals/internal-metadata.js"),a=r("./node_modules/core-js/internals/collection.js"),l=r("./node_modules/core-js/internals/collection-weak.js"),c=r("./node_modules/core-js/internals/is-object.js"),u=r("./node_modules/core-js/internals/internal-state.js").enforce,d=r("./node_modules/core-js/internals/native-weak-map.js"),h=!i.ActiveXObject&&"ActiveXObject"in i,f=Object.isExtensible,p=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},m=e.exports=a("WeakMap",p,l);if(d&&h){n=l.getConstructor(p,"WeakMap",!0),s.REQUIRED=!0;var g=m.prototype,v=g["delete"],y=g.has,_=g.get,b=g.set;o(g,{"delete":function(e){if(c(e)&&!f(e)){var t=u(this);return t.frozen||(t.frozen=new n),v.call(this,e)||t.frozen["delete"](e)}return v.call(this,e)},has:function(e){if(c(e)&&!f(e)){var t=u(this);return t.frozen||(t.frozen=new n),y.call(this,e)||t.frozen.has(e)}return y.call(this,e)},get:function(e){if(c(e)&&!f(e)){var t=u(this);return t.frozen||(t.frozen=new n),y.call(this,e)?_.call(this,e):t.frozen.get(e)}return _.call(this,e)},set:function(e,t){if(c(e)&&!f(e)){var r=u(this);r.frozen||(r.frozen=new n),y.call(this,e)?b.call(this,e,t):r.frozen.set(e,t)}else b.call(this,e,t);return this}})}},"./node_modules/core-js/modules/es.weak-set.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/collection.js"),i=r("./node_modules/core-js/internals/collection-weak.js");n("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0);
}},i)},"./node_modules/core-js/modules/esnext.aggregate-error.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/object-get-prototype-of.js"),s=r("./node_modules/core-js/internals/object-set-prototype-of.js"),a=r("./node_modules/core-js/internals/object-create.js"),l=r("./node_modules/core-js/internals/object-define-property.js"),c=r("./node_modules/core-js/internals/create-property-descriptor.js"),u=r("./node_modules/core-js/internals/iterate.js"),d=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),h=r("./node_modules/core-js/internals/internal-state.js"),f=h.set,p=h.getterFor("AggregateError"),m=function(e,t){var r=this;if(!(r instanceof m))return new m(e,t);s&&(r=s(new Error(t),o(r)));var n=[];return u(e,n.push,n),i?f(r,{errors:n,type:"AggregateError"}):r.errors=n,void 0!==t&&d(r,"message",String(t)),r};m.prototype=a(Error.prototype,{constructor:c(5,m),message:c(5,""),name:c(5,"AggregateError")}),i&&l.f(m.prototype,"errors",{get:function(){return p(this).errors},configurable:!0}),n({global:!0},{AggregateError:m})},"./node_modules/core-js/modules/esnext.array.last-index.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/add-to-unscopables.js"),o=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/to-length.js"),a=r("./node_modules/core-js/internals/object-define-property.js").f;!n||"lastIndex"in[]||(a(Array.prototype,"lastIndex",{configurable:!0,get:function(){var e=o(this),t=s(e.length);return 0==t?0:t-1}}),i("lastIndex"))},"./node_modules/core-js/modules/esnext.array.last-item.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/descriptors.js"),i=r("./node_modules/core-js/internals/add-to-unscopables.js"),o=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/to-length.js"),a=r("./node_modules/core-js/internals/object-define-property.js").f;!n||"lastItem"in[]||(a(Array.prototype,"lastItem",{configurable:!0,get:function(){var e=o(this),t=s(e.length);return 0==t?void 0:e[t-1]},set:function(e){var t=o(this),r=s(t.length);return t[0==r?0:r-1]=e}}),i("lastItem"))},"./node_modules/core-js/modules/esnext.composite-key.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/composite-key.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/object-create.js"),a=function(){var e=o("Object","freeze");return e?e(s(null)):s(null)};n({global:!0},{compositeKey:function(){return i.apply(Object,arguments).get("object",a)}})},"./node_modules/core-js/modules/esnext.composite-symbol.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/composite-key.js"),o=r("./node_modules/core-js/internals/get-built-in.js");n({global:!0},{compositeSymbol:function(){return 1===arguments.length&&"string"==typeof arguments[0]?o("Symbol")["for"](arguments[0]):i.apply(null,arguments).get("symbol",o("Symbol"))}})},"./node_modules/core-js/modules/esnext.global-this.js":function(e,t,r){r("./node_modules/core-js/modules/es.global-this.js")},"./node_modules/core-js/modules/esnext.map.delete-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/collection-delete-all.js");n({target:"Map",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},"./node_modules/core-js/modules/esnext.map.every.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/function-bind-context.js"),a=r("./node_modules/core-js/internals/get-map-iterator.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{every:function(e){var t=o(this),r=a(t),n=s(e,arguments.length>1?arguments[1]:void 0,3);return!l(r,function(e,r){return n(r,e,t)?void 0:l.stop()},void 0,!0,!0).stopped}})},"./node_modules/core-js/modules/esnext.map.filter.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/function-bind-context.js"),c=r("./node_modules/core-js/internals/species-constructor.js"),u=r("./node_modules/core-js/internals/get-map-iterator.js"),d=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{filter:function(e){var t=s(this),r=u(t),n=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Map"))),h=a(i.set);return d(r,function(e,r){n(r,e,t)&&h.call(i,e,r)},void 0,!0,!0),i}})},"./node_modules/core-js/modules/esnext.map.find-key.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/function-bind-context.js"),a=r("./node_modules/core-js/internals/get-map-iterator.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{findKey:function(e){var t=o(this),r=a(t),n=s(e,arguments.length>1?arguments[1]:void 0,3);return l(r,function(e,r){return n(r,e,t)?l.stop(e):void 0},void 0,!0,!0).result}})},"./node_modules/core-js/modules/esnext.map.find.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/function-bind-context.js"),a=r("./node_modules/core-js/internals/get-map-iterator.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{find:function(e){var t=o(this),r=a(t),n=s(e,arguments.length>1?arguments[1]:void 0,3);return l(r,function(e,r){return n(r,e,t)?l.stop(r):void 0},void 0,!0,!0).result}})},"./node_modules/core-js/modules/esnext.map.from.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/collection-from.js");n({target:"Map",stat:!0},{from:i})},"./node_modules/core-js/modules/esnext.map.group-by.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/iterate.js"),o=r("./node_modules/core-js/internals/a-function.js");n({target:"Map",stat:!0},{groupBy:function(e,t){var r=new this;o(t);var n=o(r.has),s=o(r.get),a=o(r.set);return i(e,function(e){var i=t(e);n.call(r,i)?s.call(r,i).push(e):a.call(r,i,[e])}),r}})},"./node_modules/core-js/modules/esnext.map.includes.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/get-map-iterator.js"),a=r("./node_modules/core-js/internals/same-value-zero.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{includes:function(e){return l(s(o(this)),function(t,r){return a(r,e)?l.stop():void 0},void 0,!0,!0).stopped}})},"./node_modules/core-js/modules/esnext.map.key-by.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/iterate.js"),o=r("./node_modules/core-js/internals/a-function.js");n({target:"Map",stat:!0},{keyBy:function(e,t){var r=new this;o(t);var n=o(r.set);return i(e,function(e){n.call(r,t(e),e)}),r}})},"./node_modules/core-js/modules/esnext.map.key-of.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/get-map-iterator.js"),a=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{keyOf:function(e){return a(s(o(this)),function(t,r){return r===e?a.stop(t):void 0},void 0,!0,!0).result}})},"./node_modules/core-js/modules/esnext.map.map-keys.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/function-bind-context.js"),c=r("./node_modules/core-js/internals/species-constructor.js"),u=r("./node_modules/core-js/internals/get-map-iterator.js"),d=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{mapKeys:function(e){var t=s(this),r=u(t),n=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Map"))),h=a(i.set);return d(r,function(e,r){h.call(i,n(r,e,t),r)},void 0,!0,!0),i}})},"./node_modules/core-js/modules/esnext.map.map-values.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/function-bind-context.js"),c=r("./node_modules/core-js/internals/species-constructor.js"),u=r("./node_modules/core-js/internals/get-map-iterator.js"),d=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{mapValues:function(e){var t=s(this),r=u(t),n=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Map"))),h=a(i.set);return d(r,function(e,r){h.call(i,e,n(r,e,t))},void 0,!0,!0),i}})},"./node_modules/core-js/modules/esnext.map.merge.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/a-function.js"),a=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{merge:function(e){for(var t=o(this),r=s(t.set),n=0;n<arguments.length;)a(arguments[n++],r,t,!0);return t}})},"./node_modules/core-js/modules/esnext.map.of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/collection-of.js");n({target:"Map",stat:!0},{of:i})},"./node_modules/core-js/modules/esnext.map.reduce.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/a-function.js"),a=r("./node_modules/core-js/internals/get-map-iterator.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{reduce:function(e){var t=o(this),r=a(t),n=arguments.length<2,i=n?void 0:arguments[1];if(s(e),l(r,function(r,o){n?(n=!1,i=o):i=e(i,o,r,t)},void 0,!0,!0),n)throw TypeError("Reduce of empty map with no initial value");return i}})},"./node_modules/core-js/modules/esnext.map.some.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/function-bind-context.js"),a=r("./node_modules/core-js/internals/get-map-iterator.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Map",proto:!0,real:!0,forced:i},{some:function(e){var t=o(this),r=a(t),n=s(e,arguments.length>1?arguments[1]:void 0,3);return l(r,function(e,r){return n(r,e,t)?l.stop():void 0},void 0,!0,!0).stopped}})},"./node_modules/core-js/modules/esnext.map.update.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/a-function.js");n({target:"Map",proto:!0,real:!0,forced:i},{update:function(e,t){var r=o(this),n=arguments.length;s(t);var i=r.has(e);if(!i&&3>n)throw TypeError("Updating absent value");var a=i?r.get(e):s(n>2?arguments[2]:void 0)(e,r);return r.set(e,t(a,e,r)),r}})},"./node_modules/core-js/modules/esnext.math.clamp.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=Math.min,o=Math.max;n({target:"Math",stat:!0},{clamp:function(e,t,r){return i(r,o(t,e))}})},"./node_modules/core-js/modules/esnext.math.deg-per-rad.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Math",stat:!0},{DEG_PER_RAD:Math.PI/180})},"./node_modules/core-js/modules/esnext.math.degrees.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=180/Math.PI;n({target:"Math",stat:!0},{degrees:function(e){return e*i}})},"./node_modules/core-js/modules/esnext.math.fscale.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-scale.js"),o=r("./node_modules/core-js/internals/math-fround.js");n({target:"Math",stat:!0},{fscale:function(e,t,r,n,s){return o(i(e,t,r,n,s))}})},"./node_modules/core-js/modules/esnext.math.iaddh.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Math",stat:!0},{iaddh:function(e,t,r,n){var i=e>>>0,o=t>>>0,s=r>>>0;return o+(n>>>0)+((i&s|(i|s)&~(i+s>>>0))>>>31)|0}})},"./node_modules/core-js/modules/esnext.math.imulh.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Math",stat:!0},{imulh:function(e,t){var r=65535,n=+e,i=+t,o=n&r,s=i&r,a=n>>16,l=i>>16,c=(a*s>>>0)+(o*s>>>16);return a*l+(c>>16)+((o*l>>>0)+(c&r)>>16)}})},"./node_modules/core-js/modules/esnext.math.isubh.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Math",stat:!0},{isubh:function(e,t,r,n){var i=e>>>0,o=t>>>0,s=r>>>0;return o-(n>>>0)-((~i&s|~(i^s)&i-s>>>0)>>>31)|0}})},"./node_modules/core-js/modules/esnext.math.rad-per-deg.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Math",stat:!0},{RAD_PER_DEG:180/Math.PI})},"./node_modules/core-js/modules/esnext.math.radians.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=Math.PI/180;n({target:"Math",stat:!0},{radians:function(e){return e*i}})},"./node_modules/core-js/modules/esnext.math.scale.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/math-scale.js");n({target:"Math",stat:!0},{scale:i})},"./node_modules/core-js/modules/esnext.math.seeded-prng.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/an-object.js"),o=r("./node_modules/core-js/internals/number-is-finite.js"),s=r("./node_modules/core-js/internals/create-iterator-constructor.js"),a=r("./node_modules/core-js/internals/internal-state.js"),l="Seeded Random",c=l+" Generator",u=a.set,d=a.getterFor(c),h='Math.seededPRNG() argument should have a "seed" field with a finite value.',f=s(function(e){u(this,{type:c,seed:e%2147483647})},l,function(){var e=d(this),t=e.seed=(1103515245*e.seed+12345)%2147483647;return{value:(1073741823&t)/1073741823,done:!1}});n({target:"Math",stat:!0,forced:!0},{seededPRNG:function(e){var t=i(e).seed;if(!o(t))throw TypeError(h);return new f(t)}})},"./node_modules/core-js/modules/esnext.math.signbit.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Math",stat:!0},{signbit:function(e){return(e=+e)==e&&0==e?1/e==-(1/0):0>e}})},"./node_modules/core-js/modules/esnext.math.umulh.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js");n({target:"Math",stat:!0},{umulh:function(e,t){var r=65535,n=+e,i=+t,o=n&r,s=i&r,a=n>>>16,l=i>>>16,c=(a*s>>>0)+(o*s>>>16);return a*l+(c>>>16)+((o*l>>>0)+(c&r)>>>16)}})},"./node_modules/core-js/modules/esnext.number.from-string.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/to-integer.js"),o=r("./node_modules/core-js/internals/number-parse-int.js"),s="Invalid number representation",a="Invalid radix",l=/^[\da-z]+$/;n({target:"Number",stat:!0},{fromString:function(e,t){var r,n,c=1;if("string"!=typeof e)throw TypeError(s);if(!e.length)throw SyntaxError(s);if("-"==e.charAt(0)&&(c=-1,e=e.slice(1),!e.length))throw SyntaxError(s);if(r=void 0===t?10:i(t),2>r||r>36)throw RangeError(a);if(!l.test(e)||(n=o(e,r)).toString(r)!==e)throw SyntaxError(s);return c*n}})},"./node_modules/core-js/modules/esnext.observable.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/descriptors.js"),o=r("./node_modules/core-js/internals/set-species.js"),s=r("./node_modules/core-js/internals/a-function.js"),a=r("./node_modules/core-js/internals/an-object.js"),l=r("./node_modules/core-js/internals/is-object.js"),c=r("./node_modules/core-js/internals/an-instance.js"),u=r("./node_modules/core-js/internals/object-define-property.js").f,d=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),h=r("./node_modules/core-js/internals/redefine-all.js"),f=r("./node_modules/core-js/internals/get-iterator.js"),p=r("./node_modules/core-js/internals/iterate.js"),m=r("./node_modules/core-js/internals/host-report-errors.js"),g=r("./node_modules/core-js/internals/well-known-symbol.js"),v=r("./node_modules/core-js/internals/internal-state.js"),y=g("observable"),_=v.get,b=v.set,x=function(e){return null==e?void 0:s(e)},w=function(e){var t=e.cleanup;if(t){e.cleanup=void 0;try{t()}catch(r){m(r)}}},E=function(e){return void 0===e.observer},S=function(e,t){if(!i){e.closed=!0;var r=t.subscriptionObserver;r&&(r.closed=!0)}t.observer=void 0},A=function(e,t){var r,n=b(this,{cleanup:void 0,observer:a(e),subscriptionObserver:void 0});i||(this.closed=!1);try{(r=x(e.start))&&r.call(e,this)}catch(o){m(o)}if(!E(n)){var l=n.subscriptionObserver=new M(this);try{var c=t(l),u=c;null!=c&&(n.cleanup="function"==typeof c.unsubscribe?function(){u.unsubscribe()}:s(c))}catch(o){return void l.error(o)}E(n)&&w(n)}};A.prototype=h({},{unsubscribe:function(){var e=_(this);E(e)||(S(this,e),w(e))}}),i&&u(A.prototype,"closed",{configurable:!0,get:function(){return E(_(this))}});var M=function(e){b(this,{subscription:e}),i||(this.closed=!1)};M.prototype=h({},{next:function(e){var t=_(_(this).subscription);if(!E(t)){var r=t.observer;try{var n=x(r.next);n&&n.call(r,e)}catch(i){m(i)}}},error:function(e){var t=_(this).subscription,r=_(t);if(!E(r)){var n=r.observer;S(t,r);try{var i=x(n.error);i?i.call(n,e):m(e)}catch(o){m(o)}w(r)}},complete:function(){var e=_(this).subscription,t=_(e);if(!E(t)){var r=t.observer;S(e,t);try{var n=x(r.complete);n&&n.call(r)}catch(i){m(i)}w(t)}}}),i&&u(M.prototype,"closed",{configurable:!0,get:function(){return E(_(_(this).subscription))}});var T=function(e){c(this,T,"Observable"),b(this,{subscriber:s(e)})};h(T.prototype,{subscribe:function(e){var t=arguments.length;return new A("function"==typeof e?{next:e,error:t>1?arguments[1]:void 0,complete:t>2?arguments[2]:void 0}:l(e)?e:{},_(this).subscriber)}}),h(T,{from:function(e){var t="function"==typeof this?this:T,r=x(a(e)[y]);if(r){var n=a(r.call(e));return n.constructor===t?n:new t(function(e){return n.subscribe(e)})}var i=f(e);return new t(function(e){p(i,function(t){return e.next(t),e.closed?p.stop():void 0},void 0,!1,!0),e.complete()})},of:function(){for(var e="function"==typeof this?this:T,t=arguments.length,r=new Array(t),n=0;t>n;)r[n]=arguments[n++];return new e(function(e){for(var n=0;t>n;n++)if(e.next(r[n]),e.closed)return;e.complete()})}}),d(T.prototype,y,function(){return this}),n({global:!0},{Observable:T}),o("Observable")},"./node_modules/core-js/modules/esnext.promise.all-settled.js":function(e,t,r){r("./node_modules/core-js/modules/es.promise.all-settled.js")},"./node_modules/core-js/modules/esnext.promise.any.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/a-function.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/new-promise-capability.js"),a=r("./node_modules/core-js/internals/perform.js"),l=r("./node_modules/core-js/internals/iterate.js"),c="No one promise resolved";n({target:"Promise",stat:!0},{any:function(e){var t=this,r=s.f(t),n=r.resolve,u=r.reject,d=a(function(){var r=i(t.resolve),s=[],a=0,d=1,h=!1;l(e,function(e){var i=a++,l=!1;s.push(void 0),d++,r.call(t,e).then(function(e){l||h||(h=!0,n(e))},function(e){l||h||(l=!0,s[i]=e,--d||u(new(o("AggregateError"))(s,c)))})}),--d||u(new(o("AggregateError"))(s,c))});return d.error&&u(d.value),r.promise}})},"./node_modules/core-js/modules/esnext.promise.try.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/new-promise-capability.js"),o=r("./node_modules/core-js/internals/perform.js");n({target:"Promise",stat:!0},{"try":function(e){var t=i.f(this),r=o(e);return(r.error?t.reject:t.resolve)(r.value),t.promise}})},"./node_modules/core-js/modules/esnext.reflect.define-metadata.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/reflect-metadata.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=i.toKey,a=i.set;n({target:"Reflect",stat:!0},{defineMetadata:function(e,t,r){var n=arguments.length<4?void 0:s(arguments[3]);a(e,t,o(r),n)}})},"./node_modules/core-js/modules/esnext.reflect.delete-metadata.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/reflect-metadata.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=i.toKey,a=i.getMap,l=i.store;n({target:"Reflect",stat:!0},{deleteMetadata:function(e,t){var r=arguments.length<3?void 0:s(arguments[2]),n=a(o(t),r,!1);if(void 0===n||!n["delete"](e))return!1;if(n.size)return!0;var i=l.get(t);return i["delete"](r),!!i.size||l["delete"](t)}})},"./node_modules/core-js/modules/esnext.reflect.get-metadata-keys.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/modules/es.set.js"),o=r("./node_modules/core-js/internals/reflect-metadata.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/object-get-prototype-of.js"),l=r("./node_modules/core-js/internals/iterate.js"),c=o.keys,u=o.toKey,d=function(e){var t=[];return l(e,t.push,t),t},h=function(e,t){var r=c(e,t),n=a(e);if(null===n)return r;var o=h(n,t);return o.length?r.length?d(new i(r.concat(o))):o:r};n({target:"Reflect",stat:!0},{getMetadataKeys:function(e){var t=arguments.length<2?void 0:u(arguments[1]);return h(s(e),t)}})},"./node_modules/core-js/modules/esnext.reflect.get-metadata.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/reflect-metadata.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/object-get-prototype-of.js"),a=i.has,l=i.get,c=i.toKey,u=function(e,t,r){var n=a(e,t,r);if(n)return l(e,t,r);var i=s(t);return null!==i?u(e,i,r):void 0};n({target:"Reflect",stat:!0},{getMetadata:function(e,t){var r=arguments.length<3?void 0:c(arguments[2]);return u(e,o(t),r)}})},"./node_modules/core-js/modules/esnext.reflect.get-own-metadata-keys.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/reflect-metadata.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=i.keys,a=i.toKey;n({target:"Reflect",stat:!0},{getOwnMetadataKeys:function(e){var t=arguments.length<2?void 0:a(arguments[1]);return s(o(e),t)}})},"./node_modules/core-js/modules/esnext.reflect.get-own-metadata.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/reflect-metadata.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=i.get,a=i.toKey;n({target:"Reflect",stat:!0},{getOwnMetadata:function(e,t){var r=arguments.length<3?void 0:a(arguments[2]);return s(e,o(t),r)}})},"./node_modules/core-js/modules/esnext.reflect.has-metadata.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/reflect-metadata.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/object-get-prototype-of.js"),a=i.has,l=i.toKey,c=function(e,t,r){var n=a(e,t,r);if(n)return!0;var i=s(t);return null!==i?c(e,i,r):!1};n({target:"Reflect",stat:!0},{hasMetadata:function(e,t){var r=arguments.length<3?void 0:l(arguments[2]);return c(e,o(t),r)}})},"./node_modules/core-js/modules/esnext.reflect.has-own-metadata.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/reflect-metadata.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=i.has,a=i.toKey;n({target:"Reflect",stat:!0},{hasOwnMetadata:function(e,t){var r=arguments.length<3?void 0:a(arguments[2]);return s(e,o(t),r)}})},"./node_modules/core-js/modules/esnext.reflect.metadata.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/reflect-metadata.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=i.toKey,a=i.set;n({target:"Reflect",stat:!0},{metadata:function(e,t){return function(r,n){a(e,t,o(r),s(n))}}})},"./node_modules/core-js/modules/esnext.set.add-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/collection-add-all.js");n({target:"Set",proto:!0,real:!0,forced:i},{addAll:function(){return o.apply(this,arguments)}})},"./node_modules/core-js/modules/esnext.set.delete-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/collection-delete-all.js");n({target:"Set",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},"./node_modules/core-js/modules/esnext.set.difference.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/species-constructor.js"),c=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{difference:function(e){var t=s(this),r=new(l(t,o("Set")))(t),n=a(r["delete"]);return c(e,function(e){n.call(r,e)}),r}})},"./node_modules/core-js/modules/esnext.set.every.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/function-bind-context.js"),a=r("./node_modules/core-js/internals/get-set-iterator.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{every:function(e){var t=o(this),r=a(t),n=s(e,arguments.length>1?arguments[1]:void 0,3);return!l(r,function(e){return n(e,e,t)?void 0:l.stop()},void 0,!1,!0).stopped}})},"./node_modules/core-js/modules/esnext.set.filter.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/function-bind-context.js"),c=r("./node_modules/core-js/internals/species-constructor.js"),u=r("./node_modules/core-js/internals/get-set-iterator.js"),d=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{filter:function(e){var t=s(this),r=u(t),n=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Set"))),h=a(i.add);return d(r,function(e){n(e,e,t)&&h.call(i,e)},void 0,!1,!0),i}})},"./node_modules/core-js/modules/esnext.set.find.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/function-bind-context.js"),a=r("./node_modules/core-js/internals/get-set-iterator.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{find:function(e){var t=o(this),r=a(t),n=s(e,arguments.length>1?arguments[1]:void 0,3);return l(r,function(e){return n(e,e,t)?l.stop(e):void 0},void 0,!1,!0).result}})},"./node_modules/core-js/modules/esnext.set.from.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/collection-from.js");n({target:"Set",stat:!0},{from:i})},"./node_modules/core-js/modules/esnext.set.intersection.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/species-constructor.js"),c=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{intersection:function(e){var t=s(this),r=new(l(t,o("Set"))),n=a(t.has),i=a(r.add);return c(e,function(e){n.call(t,e)&&i.call(r,e)}),r}})},"./node_modules/core-js/modules/esnext.set.is-disjoint-from.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/a-function.js"),a=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:function(e){var t=o(this),r=s(t.has);return!a(e,function(e){return r.call(t,e)===!0?a.stop():void 0}).stopped}})},"./node_modules/core-js/modules/esnext.set.is-subset-of.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/get-iterator.js"),c=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:function(e){var t=l(this),r=s(e),n=r.has;return"function"!=typeof n&&(r=new(o("Set"))(e),n=a(r.has)),!c(t,function(e){return n.call(r,e)===!1?c.stop():void 0},void 0,!1,!0).stopped}})},"./node_modules/core-js/modules/esnext.set.is-superset-of.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/a-function.js"),a=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:function(e){var t=o(this),r=s(t.has);return!a(e,function(e){return r.call(t,e)===!1?a.stop():void 0}).stopped}})},"./node_modules/core-js/modules/esnext.set.join.js":function(e,t,r){
"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/get-set-iterator.js"),a=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{join:function(e){var t=o(this),r=s(t),n=void 0===e?",":String(e),i=[];return a(r,i.push,i,!1,!0),i.join(n)}})},"./node_modules/core-js/modules/esnext.set.map.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/function-bind-context.js"),c=r("./node_modules/core-js/internals/species-constructor.js"),u=r("./node_modules/core-js/internals/get-set-iterator.js"),d=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{map:function(e){var t=s(this),r=u(t),n=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Set"))),h=a(i.add);return d(r,function(e){h.call(i,n(e,e,t))},void 0,!1,!0),i}})},"./node_modules/core-js/modules/esnext.set.of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/collection-of.js");n({target:"Set",stat:!0},{of:i})},"./node_modules/core-js/modules/esnext.set.reduce.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/a-function.js"),a=r("./node_modules/core-js/internals/get-set-iterator.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{reduce:function(e){var t=o(this),r=a(t),n=arguments.length<2,i=n?void 0:arguments[1];if(s(e),l(r,function(r){n?(n=!1,i=r):i=e(i,r,r,t)},void 0,!1,!0),n)throw TypeError("Reduce of empty set with no initial value");return i}})},"./node_modules/core-js/modules/esnext.set.some.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/an-object.js"),s=r("./node_modules/core-js/internals/function-bind-context.js"),a=r("./node_modules/core-js/internals/get-set-iterator.js"),l=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{some:function(e){var t=o(this),r=a(t),n=s(e,arguments.length>1?arguments[1]:void 0,3);return l(r,function(e){return n(e,e,t)?l.stop():void 0},void 0,!1,!0).stopped}})},"./node_modules/core-js/modules/esnext.set.symmetric-difference.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/species-constructor.js"),c=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:function(e){var t=s(this),r=new(l(t,o("Set")))(t),n=a(r["delete"]),i=a(r.add);return c(e,function(e){n.call(r,e)||i.call(r,e)}),r}})},"./node_modules/core-js/modules/esnext.set.union.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/get-built-in.js"),s=r("./node_modules/core-js/internals/an-object.js"),a=r("./node_modules/core-js/internals/a-function.js"),l=r("./node_modules/core-js/internals/species-constructor.js"),c=r("./node_modules/core-js/internals/iterate.js");n({target:"Set",proto:!0,real:!0,forced:i},{union:function(e){var t=s(this),r=new(l(t,o("Set")))(t);return c(e,a(r.add),r),r}})},"./node_modules/core-js/modules/esnext.string.at.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/string-multibyte.js").charAt;n({target:"String",proto:!0},{at:function(e){return i(this,e)}})},"./node_modules/core-js/modules/esnext.string.code-points.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/create-iterator-constructor.js"),o=r("./node_modules/core-js/internals/require-object-coercible.js"),s=r("./node_modules/core-js/internals/internal-state.js"),a=r("./node_modules/core-js/internals/string-multibyte.js"),l=a.codeAt,c=a.charAt,u="String Iterator",d=s.set,h=s.getterFor(u),f=i(function(e){d(this,{type:u,string:e,index:0})},"String",function(){var e,t=h(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=c(r,n),t.index+=e.length,{value:{codePoint:l(e,0),position:n},done:!1})});n({target:"String",proto:!0},{codePoints:function(){return new f(String(o(this)))}})},"./node_modules/core-js/modules/esnext.string.match-all.js":function(e,t,r){r("./node_modules/core-js/modules/es.string.match-all.js")},"./node_modules/core-js/modules/esnext.string.replace-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/require-object-coercible.js"),o=r("./node_modules/core-js/internals/is-regexp.js"),s=r("./node_modules/core-js/internals/regexp-flags.js"),a=r("./node_modules/core-js/internals/well-known-symbol.js"),l=r("./node_modules/core-js/internals/is-pure.js"),c=a("replace"),u=RegExp.prototype;n({target:"String",proto:!0},{replaceAll:function d(e,t){var r,n,a,h,f,p,m,g,v,y=i(this);if(null!=e){if(r=o(e),r&&(n=String(i("flags"in u?e.flags:s.call(e))),!~n.indexOf("g")))throw TypeError("`.replaceAll` does not allow non-global regexes");if(a=e[c],void 0!==a)return a.call(e,y,t);if(l&&r)return String(y).replace(e,t)}if(h=String(y),f=String(e),""===f)return d.call(h,/(?:)/g,t);if(p=h.split(f),"function"!=typeof t)return p.join(String(t));for(m=p[0],g=m.length,v=1;v<p.length;v++)m+=String(t(f,g,h)),g+=f.length+p[v].length,m+=p[v];return m}})},"./node_modules/core-js/modules/esnext.symbol.dispose.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("dispose")},"./node_modules/core-js/modules/esnext.symbol.observable.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("observable")},"./node_modules/core-js/modules/esnext.symbol.pattern-match.js":function(e,t,r){var n=r("./node_modules/core-js/internals/define-well-known-symbol.js");n("patternMatch")},"./node_modules/core-js/modules/esnext.weak-map.delete-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/collection-delete-all.js");n({target:"WeakMap",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},"./node_modules/core-js/modules/esnext.weak-map.from.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/collection-from.js");n({target:"WeakMap",stat:!0},{from:i})},"./node_modules/core-js/modules/esnext.weak-map.of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/collection-of.js");n({target:"WeakMap",stat:!0},{of:i})},"./node_modules/core-js/modules/esnext.weak-set.add-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/collection-add-all.js");n({target:"WeakSet",proto:!0,real:!0,forced:i},{addAll:function(){return o.apply(this,arguments)}})},"./node_modules/core-js/modules/esnext.weak-set.delete-all.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/is-pure.js"),o=r("./node_modules/core-js/internals/collection-delete-all.js");n({target:"WeakSet",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},"./node_modules/core-js/modules/esnext.weak-set.from.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/collection-from.js");n({target:"WeakSet",stat:!0},{from:i})},"./node_modules/core-js/modules/esnext.weak-set.of.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/collection-of.js");n({target:"WeakSet",stat:!0},{of:i})},"./node_modules/core-js/modules/web.dom-collections.for-each.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/dom-iterables.js"),o=r("./node_modules/core-js/internals/array-for-each.js"),s=r("./node_modules/core-js/internals/create-non-enumerable-property.js");for(var a in i){var l=n[a],c=l&&l.prototype;if(c&&c.forEach!==o)try{s(c,"forEach",o)}catch(u){c.forEach=o}}},"./node_modules/core-js/modules/web.dom-collections.iterator.js":function(e,t,r){var n=r("./node_modules/core-js/internals/global.js"),i=r("./node_modules/core-js/internals/dom-iterables.js"),o=r("./node_modules/core-js/modules/es.array.iterator.js"),s=r("./node_modules/core-js/internals/create-non-enumerable-property.js"),a=r("./node_modules/core-js/internals/well-known-symbol.js"),l=a("iterator"),c=a("toStringTag"),u=o.values;for(var d in i){var h=n[d],f=h&&h.prototype;if(f){if(f[l]!==u)try{s(f,l,u)}catch(p){f[l]=u}if(f[c]||s(f,c,d),i[d])for(var m in o)if(f[m]!==o[m])try{s(f,m,o[m])}catch(p){f[m]=o[m]}}}},"./node_modules/core-js/modules/web.immediate.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/task.js"),s=!i.setImmediate||!i.clearImmediate;n({global:!0,bind:!0,enumerable:!0,forced:s},{setImmediate:o.set,clearImmediate:o.clear})},"./node_modules/core-js/modules/web.queue-microtask.js":function(e,t,r){var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/global.js"),o=r("./node_modules/core-js/internals/microtask.js"),s=r("./node_modules/core-js/internals/classof-raw.js"),a=i.process,l="process"==s(a);n({global:!0,enumerable:!0,noTargetGet:!0},{queueMicrotask:function(e){var t=l&&a.domain;o(t?t.bind(e):e)}})},"./node_modules/core-js/modules/web.url-search-params.js":function(e,t,r){"use strict";r("./node_modules/core-js/modules/es.array.iterator.js");var n=r("./node_modules/core-js/internals/export.js"),i=r("./node_modules/core-js/internals/get-built-in.js"),o=r("./node_modules/core-js/internals/native-url.js"),s=r("./node_modules/core-js/internals/redefine.js"),a=r("./node_modules/core-js/internals/redefine-all.js"),l=r("./node_modules/core-js/internals/set-to-string-tag.js"),c=r("./node_modules/core-js/internals/create-iterator-constructor.js"),u=r("./node_modules/core-js/internals/internal-state.js"),d=r("./node_modules/core-js/internals/an-instance.js"),h=r("./node_modules/core-js/internals/has.js"),f=r("./node_modules/core-js/internals/function-bind-context.js"),p=r("./node_modules/core-js/internals/classof.js"),m=r("./node_modules/core-js/internals/an-object.js"),g=r("./node_modules/core-js/internals/is-object.js"),v=r("./node_modules/core-js/internals/object-create.js"),y=r("./node_modules/core-js/internals/create-property-descriptor.js"),_=r("./node_modules/core-js/internals/get-iterator.js"),b=r("./node_modules/core-js/internals/get-iterator-method.js"),x=r("./node_modules/core-js/internals/well-known-symbol.js"),w=i("fetch"),E=i("Headers"),S=x("iterator"),A="URLSearchParams",M=A+"Iterator",T=u.set,C=u.getterFor(A),j=u.getterFor(M),P=/\+/g,L=Array(4),D=function(e){return L[e-1]||(L[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},I=function(e){try{return decodeURIComponent(e)}catch(t){return e}},R=function(e){var t=e.replace(P," "),r=4;try{return decodeURIComponent(t)}catch(n){for(;r;)t=t.replace(D(r--),I);return t}},O=/[!'()~]|%20/g,k={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},N=function(e){return k[e]},F=function(e){return encodeURIComponent(e).replace(O,N)},V=function(e,t){if(t)for(var r,n,i=t.split("&"),o=0;o<i.length;)r=i[o++],r.length&&(n=r.split("="),e.push({key:R(n.shift()),value:R(n.join("="))}))},U=function(e){this.entries.length=0,V(this.entries,e)},B=function(e,t){if(t>e)throw TypeError("Not enough arguments")},z=c(function(e,t){T(this,{type:M,iterator:_(C(e).entries),kind:t})},"Iterator",function(){var e=j(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r}),G=function(){d(this,G,A);var e,t,r,n,i,o,s,a,l,c=arguments.length>0?arguments[0]:void 0,u=this,f=[];if(T(u,{type:A,entries:f,updateURL:function(){},updateSearchParams:U}),void 0!==c)if(g(c))if(e=b(c),"function"==typeof e)for(t=e.call(c),r=t.next;!(n=r.call(t)).done;){if(i=_(m(n.value)),o=i.next,(s=o.call(i)).done||(a=o.call(i)).done||!o.call(i).done)throw TypeError("Expected sequence with length 2");f.push({key:s.value+"",value:a.value+""})}else for(l in c)h(c,l)&&f.push({key:l,value:c[l]+""});else V(f,"string"==typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")},H=G.prototype;a(H,{append:function(e,t){B(arguments.length,2);var r=C(this);r.entries.push({key:e+"",value:t+""}),r.updateURL()},"delete":function(e){B(arguments.length,1);for(var t=C(this),r=t.entries,n=e+"",i=0;i<r.length;)r[i].key===n?r.splice(i,1):i++;t.updateURL()},get:function(e){B(arguments.length,1);for(var t=C(this).entries,r=e+"",n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){B(arguments.length,1);for(var t=C(this).entries,r=e+"",n=[],i=0;i<t.length;i++)t[i].key===r&&n.push(t[i].value);return n},has:function(e){B(arguments.length,1);for(var t=C(this).entries,r=e+"",n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){B(arguments.length,1);for(var r,n=C(this),i=n.entries,o=!1,s=e+"",a=t+"",l=0;l<i.length;l++)r=i[l],r.key===s&&(o?i.splice(l--,1):(o=!0,r.value=a));o||i.push({key:s,value:a}),n.updateURL()},sort:function(){var e,t,r,n=C(this),i=n.entries,o=i.slice();for(i.length=0,r=0;r<o.length;r++){for(e=o[r],t=0;r>t;t++)if(i[t].key>e.key){i.splice(t,0,e);break}t===r&&i.push(e)}n.updateURL()},forEach:function(e){for(var t,r=C(this).entries,n=f(e,arguments.length>1?arguments[1]:void 0,3),i=0;i<r.length;)t=r[i++],n(t.value,t.key,this)},keys:function(){return new z(this,"keys")},values:function(){return new z(this,"values")},entries:function(){return new z(this,"entries")}},{enumerable:!0}),s(H,S,H.entries),s(H,"toString",function(){for(var e,t=C(this).entries,r=[],n=0;n<t.length;)e=t[n++],r.push(F(e.key)+"="+F(e.value));return r.join("&")},{enumerable:!0}),l(G,A),n({global:!0,forced:!o},{URLSearchParams:G}),o||"function"!=typeof w||"function"!=typeof E||n({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,r,n,i=[e];return arguments.length>1&&(t=arguments[1],g(t)&&(r=t.body,p(r)===A&&(n=t.headers?new E(t.headers):new E,n.has("content-type")||n.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=v(t,{body:y(0,String(r)),headers:y(0,n)}))),i.push(t)),w.apply(this,i)}}),e.exports={URLSearchParams:G,getState:C}},"./node_modules/core-js/modules/web.url.js":function(e,t,r){"use strict";r("./node_modules/core-js/modules/es.string.iterator.js");var n,i=r("./node_modules/core-js/internals/export.js"),o=r("./node_modules/core-js/internals/descriptors.js"),s=r("./node_modules/core-js/internals/native-url.js"),a=r("./node_modules/core-js/internals/global.js"),l=r("./node_modules/core-js/internals/object-define-properties.js"),c=r("./node_modules/core-js/internals/redefine.js"),u=r("./node_modules/core-js/internals/an-instance.js"),d=r("./node_modules/core-js/internals/has.js"),h=r("./node_modules/core-js/internals/object-assign.js"),f=r("./node_modules/core-js/internals/array-from.js"),p=r("./node_modules/core-js/internals/string-multibyte.js").codeAt,m=r("./node_modules/core-js/internals/string-punycode-to-ascii.js"),g=r("./node_modules/core-js/internals/set-to-string-tag.js"),v=r("./node_modules/core-js/modules/web.url-search-params.js"),y=r("./node_modules/core-js/internals/internal-state.js"),_=a.URL,b=v.URLSearchParams,x=v.getState,w=y.set,E=y.getterFor("URL"),S=Math.floor,A=Math.pow,M="Invalid authority",T="Invalid scheme",C="Invalid host",j="Invalid port",P=/[A-Za-z]/,L=/[\d+\-.A-Za-z]/,D=/\d/,I=/^(0x|0X)/,R=/^[0-7]+$/,O=/^\d+$/,k=/^[\dA-Fa-f]+$/,N=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,F=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,V=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,U=/[\u0009\u000A\u000D]/g,B=function(e,t){var r,n,i;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return C;if(r=G(t.slice(1,-1)),!r)return C;e.host=r}else if(J(e)){if(t=m(t),N.test(t))return C;if(r=z(t),null===r)return C;e.host=r}else{if(F.test(t))return C;for(r="",n=f(t),i=0;i<n.length;i++)r+=Q(n[i],q);e.host=r}},z=function(e){var t,r,n,i,o,s,a,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),t=l.length,t>4)return e;for(r=[],n=0;t>n;n++){if(i=l[n],""==i)return e;if(o=10,i.length>1&&"0"==i.charAt(0)&&(o=I.test(i)?16:8,i=i.slice(8==o?1:2)),""===i)s=0;else{if(!(10==o?O:8==o?R:k).test(i))return e;s=parseInt(i,o)}r.push(s)}for(n=0;t>n;n++)if(s=r[n],n==t-1){if(s>=A(256,5-t))return null}else if(s>255)return null;for(a=r.pop(),n=0;n<r.length;n++)a+=r[n]*A(256,3-n);return a},G=function(e){var t,r,n,i,o,s,a,l=[0,0,0,0,0,0,0,0],c=0,u=null,d=0,h=function(){return e.charAt(d)};if(":"==h()){if(":"!=e.charAt(1))return;d+=2,c++,u=c}for(;h();){if(8==c)return;if(":"!=h()){for(t=r=0;4>r&&k.test(h());)t=16*t+parseInt(h(),16),d++,r++;if("."==h()){if(0==r)return;if(d-=r,c>6)return;for(n=0;h();){if(i=null,n>0){if(!("."==h()&&4>n))return;d++}if(!D.test(h()))return;for(;D.test(h());){if(o=parseInt(h(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;d++}l[c]=256*l[c]+i,n++,(2==n||4==n)&&c++}if(4!=n)return;break}if(":"==h()){if(d++,!h())return}else if(h())return;l[c++]=t}else{if(null!==u)return;d++,c++,u=c}}if(null!==u)for(s=c-u,c=7;0!=c&&s>0;)a=l[c],l[c--]=l[u+s-1],l[u+--s]=a;else if(8!=c)return;return l},H=function(e){for(var t=null,r=1,n=null,i=0,o=0;8>o;o++)0!==e[o]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=o),++i);return i>r&&(t=n,r=i),t},W=function(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;4>r;r++)t.unshift(e%256),e=S(e/256);return t.join(".")}if("object"==typeof e){for(t="",n=H(e),r=0;8>r;r++)i&&0===e[r]||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=e[r].toString(16),7>r&&(t+=":")));return"["+t+"]"}return e},q={},X=h({},q,{" ":1,'"':1,"<":1,">":1,"`":1}),Y=h({},X,{"#":1,"?":1,"{":1,"}":1}),K=h({},Y,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Q=function(e,t){var r=p(e,0);return r>32&&127>r&&!d(t,e)?e:encodeURIComponent(e)},Z={ftp:21,file:null,http:80,https:443,ws:80,wss:443},J=function(e){return d(Z,e.scheme)},$=function(e){return""!=e.username||""!=e.password},ee=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},te=function(e,t){var r;return 2==e.length&&P.test(e.charAt(0))&&(":"==(r=e.charAt(1))||!t&&"|"==r)},re=function(e){var t;return e.length>1&&te(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},ne=function(e){var t=e.path,r=t.length;!r||"file"==e.scheme&&1==r&&te(t[0],!0)||t.pop()},ie=function(e){return"."===e||"%2e"===e.toLowerCase()},oe=function(e){return e=e.toLowerCase(),".."===e||"%2e."===e||".%2e"===e||"%2e%2e"===e},se={},ae={},le={},ce={},ue={},de={},he={},fe={},pe={},me={},ge={},ve={},ye={},_e={},be={},xe={},we={},Ee={},Se={},Ae={},Me={},Te=function(e,t,r,i){var o,s,a,l,c=r||se,u=0,h="",p=!1,m=!1,g=!1;for(r||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(V,"")),t=t.replace(U,""),o=f(t);u<=o.length;){switch(s=o[u],c){case se:if(!s||!P.test(s)){if(r)return T;c=le;continue}h+=s.toLowerCase(),c=ae;break;case ae:if(s&&(L.test(s)||"+"==s||"-"==s||"."==s))h+=s.toLowerCase();else{if(":"!=s){if(r)return T;h="",c=le,u=0;continue}if(r&&(J(e)!=d(Z,h)||"file"==h&&($(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=h,r)return void(J(e)&&Z[e.scheme]==e.port&&(e.port=null));h="","file"==e.scheme?c=_e:J(e)&&i&&i.scheme==e.scheme?c=ce:J(e)?c=fe:"/"==o[u+1]?(c=ue,u++):(e.cannotBeABaseURL=!0,e.path.push(""),c=Se)}break;case le:if(!i||i.cannotBeABaseURL&&"#"!=s)return T;if(i.cannotBeABaseURL&&"#"==s){e.scheme=i.scheme,e.path=i.path.slice(),e.query=i.query,e.fragment="",e.cannotBeABaseURL=!0,c=Me;break}c="file"==i.scheme?_e:de;continue;case ce:if("/"!=s||"/"!=o[u+1]){c=de;continue}c=pe,u++;break;case ue:if("/"==s){c=me;break}c=Ee;continue;case de:if(e.scheme=i.scheme,s==n)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query;else if("/"==s||"\\"==s&&J(e))c=he;else if("?"==s)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query="",c=Ae;else{if("#"!=s){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.path.pop(),c=Ee;continue}e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query,e.fragment="",c=Me}break;case he:if(!J(e)||"/"!=s&&"\\"!=s){if("/"!=s){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,c=Ee;continue}c=me}else c=pe;break;case fe:if(c=pe,"/"!=s||"/"!=h.charAt(u+1))continue;u++;break;case pe:if("/"!=s&&"\\"!=s){c=me;continue}break;case me:if("@"==s){p&&(h="%40"+h),p=!0,a=f(h);for(var v=0;v<a.length;v++){var y=a[v];if(":"!=y||g){var _=Q(y,K);g?e.password+=_:e.username+=_}else g=!0}h=""}else if(s==n||"/"==s||"?"==s||"#"==s||"\\"==s&&J(e)){if(p&&""==h)return M;u-=f(h).length+1,h="",c=ge}else h+=s;break;case ge:case ve:if(r&&"file"==e.scheme){c=xe;continue}if(":"!=s||m){if(s==n||"/"==s||"?"==s||"#"==s||"\\"==s&&J(e)){if(J(e)&&""==h)return C;if(r&&""==h&&($(e)||null!==e.port))return;if(l=B(e,h))return l;if(h="",c=we,r)return;continue}"["==s?m=!0:"]"==s&&(m=!1),h+=s}else{if(""==h)return C;if(l=B(e,h))return l;if(h="",c=ye,r==ve)return}break;case ye:if(!D.test(s)){if(s==n||"/"==s||"?"==s||"#"==s||"\\"==s&&J(e)||r){if(""!=h){var b=parseInt(h,10);if(b>65535)return j;e.port=J(e)&&b===Z[e.scheme]?null:b,h=""}if(r)return;c=we;continue}return j}h+=s;break;case _e:if(e.scheme="file","/"==s||"\\"==s)c=be;else{if(!i||"file"!=i.scheme){c=Ee;continue}if(s==n)e.host=i.host,e.path=i.path.slice(),e.query=i.query;else if("?"==s)e.host=i.host,e.path=i.path.slice(),e.query="",c=Ae;else{if("#"!=s){re(o.slice(u).join(""))||(e.host=i.host,e.path=i.path.slice(),ne(e)),c=Ee;continue}e.host=i.host,e.path=i.path.slice(),e.query=i.query,e.fragment="",c=Me}}break;case be:if("/"==s||"\\"==s){c=xe;break}i&&"file"==i.scheme&&!re(o.slice(u).join(""))&&(te(i.path[0],!0)?e.path.push(i.path[0]):e.host=i.host),c=Ee;continue;case xe:if(s==n||"/"==s||"\\"==s||"?"==s||"#"==s){if(!r&&te(h))c=Ee;else if(""==h){if(e.host="",r)return;c=we}else{if(l=B(e,h))return l;if("localhost"==e.host&&(e.host=""),r)return;h="",c=we}continue}h+=s;break;case we:if(J(e)){if(c=Ee,"/"!=s&&"\\"!=s)continue}else if(r||"?"!=s)if(r||"#"!=s){if(s!=n&&(c=Ee,"/"!=s))continue}else e.fragment="",c=Me;else e.query="",c=Ae;break;case Ee:if(s==n||"/"==s||"\\"==s&&J(e)||!r&&("?"==s||"#"==s)){if(oe(h)?(ne(e),"/"==s||"\\"==s&&J(e)||e.path.push("")):ie(h)?"/"==s||"\\"==s&&J(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&te(h)&&(e.host&&(e.host=""),h=h.charAt(0)+":"),e.path.push(h)),h="","file"==e.scheme&&(s==n||"?"==s||"#"==s))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==s?(e.query="",c=Ae):"#"==s&&(e.fragment="",c=Me)}else h+=Q(s,Y);break;case Se:"?"==s?(e.query="",c=Ae):"#"==s?(e.fragment="",c=Me):s!=n&&(e.path[0]+=Q(s,q));break;case Ae:r||"#"!=s?s!=n&&("'"==s&&J(e)?e.query+="%27":"#"==s?e.query+="%23":e.query+=Q(s,q)):(e.fragment="",c=Me);break;case Me:s!=n&&(e.fragment+=Q(s,X))}u++}},Ce=function(e){var t,r,n=u(this,Ce,"URL"),i=arguments.length>1?arguments[1]:void 0,s=String(e),a=w(n,{type:"URL"});if(void 0!==i)if(i instanceof Ce)t=E(i);else if(r=Te(t={},String(i)))throw TypeError(r);if(r=Te(a,s,null,t))throw TypeError(r);var l=a.searchParams=new b,c=x(l);c.updateSearchParams(a.query),c.updateURL=function(){a.query=String(l)||null},o||(n.href=Pe.call(n),n.origin=Le.call(n),n.protocol=De.call(n),n.username=Ie.call(n),n.password=Re.call(n),n.host=Oe.call(n),n.hostname=ke.call(n),n.port=Ne.call(n),n.pathname=Fe.call(n),n.search=Ve.call(n),n.searchParams=Ue.call(n),n.hash=Be.call(n))},je=Ce.prototype,Pe=function(){var e=E(this),t=e.scheme,r=e.username,n=e.password,i=e.host,o=e.port,s=e.path,a=e.query,l=e.fragment,c=t+":";return null!==i?(c+="//",$(e)&&(c+=r+(n?":"+n:"")+"@"),c+=W(i),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?s[0]:s.length?"/"+s.join("/"):"",null!==a&&(c+="?"+a),null!==l&&(c+="#"+l),c},Le=function(){var e=E(this),t=e.scheme,r=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(n){return"null"}return"file"!=t&&J(e)?t+"://"+W(e.host)+(null!==r?":"+r:""):"null"},De=function(){return E(this).scheme+":"},Ie=function(){return E(this).username},Re=function(){return E(this).password},Oe=function(){var e=E(this),t=e.host,r=e.port;return null===t?"":null===r?W(t):W(t)+":"+r},ke=function(){var e=E(this).host;return null===e?"":W(e)},Ne=function(){var e=E(this).port;return null===e?"":String(e)},Fe=function(){var e=E(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},Ve=function(){var e=E(this).query;return e?"?"+e:""},Ue=function(){return E(this).searchParams},Be=function(){var e=E(this).fragment;return e?"#"+e:""},ze=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(o&&l(je,{href:ze(Pe,function(e){var t=E(this),r=String(e),n=Te(t,r);if(n)throw TypeError(n);x(t.searchParams).updateSearchParams(t.query)}),origin:ze(Le),protocol:ze(De,function(e){var t=E(this);Te(t,String(e)+":",se)}),username:ze(Ie,function(e){var t=E(this),r=f(String(e));if(!ee(t)){t.username="";for(var n=0;n<r.length;n++)t.username+=Q(r[n],K)}}),password:ze(Re,function(e){var t=E(this),r=f(String(e));if(!ee(t)){t.password="";for(var n=0;n<r.length;n++)t.password+=Q(r[n],K)}}),host:ze(Oe,function(e){var t=E(this);t.cannotBeABaseURL||Te(t,String(e),ge)}),hostname:ze(ke,function(e){var t=E(this);t.cannotBeABaseURL||Te(t,String(e),ve)}),port:ze(Ne,function(e){var t=E(this);ee(t)||(e=String(e),""==e?t.port=null:Te(t,e,ye))}),pathname:ze(Fe,function(e){var t=E(this);t.cannotBeABaseURL||(t.path=[],Te(t,e+"",we))}),search:ze(Ve,function(e){var t=E(this);e=String(e),""==e?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",Te(t,e,Ae)),x(t.searchParams).updateSearchParams(t.query)}),searchParams:ze(Ue),hash:ze(Be,function(e){var t=E(this);return e=String(e),""==e?void(t.fragment=null):("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",void Te(t,e,Me))})}),c(je,"toJSON",function(){return Pe.call(this)},{enumerable:!0}),c(je,"toString",function(){return Pe.call(this)},{enumerable:!0}),_){var Ge=_.createObjectURL,He=_.revokeObjectURL;Ge&&c(Ce,"createObjectURL",function(e){return Ge.apply(_,arguments)}),He&&c(Ce,"revokeObjectURL",function(e){return He.apply(_,arguments)})}g(Ce,"URL"),i({global:!0,forced:!s,sham:!o},{URL:Ce})},"./node_modules/core-js/modules/web.url.to-json.js":function(e,t,r){"use strict";var n=r("./node_modules/core-js/internals/export.js");n({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},"./node_modules/mixpanel-browser/dist/mixpanel.cjs.js":function(e,t,r){"use strict";function n(e){switch(typeof e.className){case"string":return e.className;case"object":return e.className.baseVal||e.getAttribute("class")||"";default:return""}}function i(e){var t="";return c(e)&&e.childNodes&&e.childNodes.length&&me.each(e.childNodes,function(e){a(e)&&e.textContent&&(t+=me.trim(e.textContent).split(/(\s+)/).filter(u).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255))}),me.trim(t)}function o(e){return e&&1===e.nodeType}function s(e,t){return e&&e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function a(e){return e&&3===e.nodeType}function l(e,t){if(!e||s(e,"html")||!o(e))return!1;var r=e.tagName.toLowerCase();switch(r){case"html":return!1;case"form":return"submit"===t.type;case"input":return-1===["button","submit"].indexOf(e.getAttribute("type"))?"change"===t.type:"click"===t.type;case"select":case"textarea":return"change"===t.type;default:return"click"===t.type}}function c(e){for(var t=e;t.parentNode&&!s(t,"body");t=t.parentNode){var r=n(t).split(" ");if(me.includes(r,"mp-sensitive")||me.includes(r,"mp-no-track"))return!1}if(me.includes(n(e).split(" "),"mp-include"))return!0;if(s(e,"input")||s(e,"select")||s(e,"textarea")||"true"===e.getAttribute("contenteditable"))return!1;var i=e.type||"";if("string"==typeof i)switch(i.toLowerCase()){case"hidden":return!1;case"password":return!1}var o=e.name||e.id||"";if("string"==typeof o){var a=/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i;if(a.test(o.replace(/[^a-zA-Z0-9]/g,"")))return!1}return!0}function u(e){if(null===e||me.isUndefined(e))return!1;if("string"==typeof e){e=me.trim(e);var t=/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/;if(t.test((e||"").replace(/[- ]/g,"")))return!1;var r=/(^\d{3}-?\d{2}-?\d{4}$)/;if(r.test(e))return!1}return!0}function d(e,t){E(!0,e,t)}function h(e,t){E(!1,e,t)}function f(e,t){return"1"===x(e,t)}function p(e,t){return w(t)?!0:"0"===x(e,t)}function m(e){return S(e,function(e){return this.get_config(e)})}function g(e){return S(e,function(e){return this._get_config(e)})}function v(e){return S(e,function(e){return this._get_config(e)})}function y(e,t){t=t||{},_(t).remove(b(e,t),!!t.crossSubdomainCookie)}function _(e){return e=e||{},"localStorage"===e.persistenceType?me.localStorage:me.cookie}function b(e,t){return t=t||{},(t.persistencePrefix||Ee)+e}function x(e,t){return _(t).get(b(e,t))}function w(e){if(e&&e.ignoreDnt)return!1;var t=e&&e.window||Y,r=t.navigator||{},n=!1;return me.each([r.doNotTrack,r.msDoNotTrack,t.doNotTrack],function(e){me.includes([!0,1,"1","yes"],e)&&(n=!0)}),n}function E(e,t,r){me.isString(t)&&t.length&&(r=r||{},_(r).set(b(t,r),e?1:0,me.isNumber(r.cookieExpiration)?r.cookieExpiration:null,!!r.crossSubdomainCookie,!!r.secureCookie),r.track&&e&&r.track(r.trackEventName||"$opt_in",r.trackProperties))}function S(e,t){return function(){var r=!1;try{var n=t.call(this,"token"),i=t.call(this,"ignore_dnt"),o=t.call(this,"opt_out_tracking_persistence_type"),s=t.call(this,"opt_out_tracking_cookie_prefix"),a=t.call(this,"window");n&&(r=p(n,{ignoreDnt:i,persistenceType:o,persistencePrefix:s,window:a}))}catch(l){}if(!r)return e.apply(this,arguments);var c=arguments[arguments.length-1];"function"==typeof c&&c(0)}}function A(e){if(null===e)return null;switch(typeof e){case"object":return me.isDate(e)&&e.getTime()>=0?e.getTime():null;case"boolean":return Number(e);case"number":return e;case"string":return e=Number(e),isNaN(e)?0:e}return null}function M(e,t){if(!e.operator||e.operator!==wt||!e.children||1!==e.children.length)throw"Invalid cast operator: number "+e;return A(q(e.children[0],t))}function T(e){if(null===e)return!1;switch(typeof e){case"boolean":return e;case"number":return 0!==e;case"string":return e.length>0;case"object":return me.isArray(e)&&e.length>0?!0:me.isDate(e)&&e.getTime()>0?!0:me.isObject(e)&&!me.isEmptyObject(e)?!0:!1}return!1}function C(e,t){if(!e.operator||e.operator!==_t||!e.children||1!==e.children.length)throw"Invalid cast operator: boolean "+e;
return T(q(e.children[0],t))}function j(e,t){if(!e.operator||e.operator!==bt||!e.children||1!==e.children.length)throw"Invalid cast operator: datetime "+e;var r=q(e.children[0],t);if(null===r)return null;switch(typeof r){case"number":case"string":var n=new Date(r);return isNaN(n.getTime())?null:n;case"object":if(me.isDate(r))return r}return null}function P(e,t){if(!e.operator||e.operator!==xt||!e.children||1!==e.children.length)throw"Invalid cast operator: list "+e;var r=q(e.children[0],t);return null===r?null:me.isArray(r)?r:null}function L(e,t){if(!e.operator||e.operator!==Et||!e.children||1!==e.children.length)throw"Invalid cast operator: string "+e;var r=q(e.children[0],t);switch(typeof r){case"object":return me.isDate(r)?r.toJSON():JSON.stringify(r)}return String(r)}function D(e,t){if(!e.operator||e.operator!==it||!e.children||2!==e.children.length)throw"Invalid operator: AND "+e;return T(q(e.children[0],t))&&T(q(e.children[1],t))}function I(e,t){if(!e.operator||e.operator!==ot||!e.children||2!==e.children.length)throw"Invalid operator: OR "+e;return T(q(e.children[0],t))||T(q(e.children[1],t))}function R(e,t){if(!e.operator||-1===[st,at].indexOf(e.operator)||!e.children||2!==e.children.length)throw"Invalid operator: IN/NOT IN "+e;var r=q(e.children[0],t),n=q(e.children[1],t);if(!me.isArray(n)&&!me.isString(n))throw"Invalid operand for operator IN: invalid type"+n;var i=n.indexOf(r)>-1;return e.operator===at?!i:i}function O(e,t){if(!e.operator||e.operator!==lt||!e.children||e.children.length<2)throw"Invalid operator: PLUS "+e;var r=q(e.children[0],t),n=q(e.children[1],t);return"number"==typeof r&&"number"==typeof n?r+n:"string"==typeof r&&"string"==typeof n?r+n:null}function k(e,t){if(!e.operator||-1===[ct,ut,dt,ht].indexOf(e.operator)||!e.children||e.children.length<2)throw"Invalid arithmetic operator "+e;var r=q(e.children[0],t),n=q(e.children[1],t);if("number"==typeof r&&"number"==typeof n)switch(e.operator){case ct:return r-n;case ut:return r*n;case dt:return 0!==n?r/n:null;case ht:return 0===n?null:0===r?0:0>r&&n>0||r>0&&0>n?-(Math.floor(r/n)*n-r):r%n;default:throw"Unknown operator: "+e.operator}return null}function N(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function F(e,t){if(null===e&&e===t)return!0;if(typeof e==typeof t)switch(typeof e){case"number":case"string":case"boolean":return e===t;case"object":if(me.isArray(e)&&me.isArray(t))return N(e,t);if(me.isDate(e)&&me.isDate(t))return e.getTime()===t.getTime();if(me.isObject(e)&&me.isObject(t))return JSON.stringify(e)===JSON.stringify(t)}return!1}function V(e,t){if(!e.operator||-1===[ft,pt].indexOf(e.operator)||!e.children||2!==e.children.length)throw"Invalid equality operator "+e;var r=F(q(e.children[0],t),q(e.children[1],t));switch(e.operator){case ft:return r;case pt:return!r}}function U(e,t){if(!e.operator||-1===[mt,vt,gt,yt].indexOf(e.operator)||!e.children||2!==e.children.length)throw"Invalid comparison operator "+e;var r=q(e.children[0],t),n=q(e.children[1],t);if(typeof r==typeof n)if("number"==typeof n||me.isDate(n))switch(r=A(r),n=A(n),e.operator){case mt:return r>n;case vt:return r>=n;case gt:return n>r;case yt:return n>=r}else if("string"==typeof n){var i=r.localeCompare(n);switch(e.operator){case mt:return i>0;case vt:return i>=0;case gt:return 0>i;case yt:return 0>=i}}return null}function B(e,t){if(!e.operator||-1===[At,Mt].indexOf(e.operator)||!e.children||1!==e.children.length)throw"Invalid defined/not defined operator: "+e;var r=null!==q(e.children[0],t);return e.operator===Mt?!r:r}function z(e,t){if(!e.operator||e.operator!==St||!e.children||1!==e.children.length)throw"Invalid not operator: "+e;var r=q(e.children[0],t);return null===r?!0:"boolean"==typeof r?!r:null}function G(e,t){if(!e.operator)throw"Invalid operator: operator key missing "+e;switch(e.operator){case it:return D(e,t);case ot:return I(e,t);case st:case at:return R(e,t);case lt:return O(e,t);case ct:case ut:case dt:case ht:return k(e,t);case ft:case pt:return V(e,t);case mt:case gt:case vt:case yt:return U(e,t);case _t:return C(e,t);case bt:return j(e,t);case xt:return P(e,t);case wt:return M(e,t);case Et:return L(e,t);case At:case Mt:return B(e,t);case St:return z(e,t)}}function H(e){var t=e[Ke];if(!t||!t[Qe]||!t[Ze])throw"Invalid window: missing required keys "+JSON.stringify(e);var r=new Date;switch(t[Qe]){case Je:r.setTime(r.getTime()+-1*t[Ze]*60*60*1e3);break;case $e:r.setTime(r.getTime()+-1*t[Ze]*24*60*60*1e3);break;case et:r.setTime(r.getTime()+-1*t[Ze]*7*24*60*60*1e3);break;case tt:r.setTime(r.getTime()+-1*t[Ze]*30*24*60*60*1e3);break;default:throw"Invalid unit: "+t[Qe]}return r}function W(e,t){if(!e.property||!e.value)throw"Invalid operand: missing required keys "+e;switch(e.property){case rt:return void 0!==t[e.value]?t[e.value]:null;case nt:return e.value===Tt?new Date:"object"==typeof e.value?H(e.value):e.value;default:throw"Invalid operand: Invalid property type "+e.property}}function q(e,t){return e[Ye]?W(e,t):e[Xe]?G(e,t):void 0}function X(){return Pt=Dt,Lt=new Ut,Ht(),Lt.init(),Wt(),Lt}var Y,K={DEBUG:!1,LIB_VERSION:"2.34.0"};if("undefined"==typeof window){var Q={hostname:""};Y={navigator:{userAgent:""},document:{location:Q,referrer:""},screen:{width:0,height:0},location:Q}}else Y=window;var Z=Array.prototype,J=Function.prototype,$=Object.prototype,ee=Z.slice,te=$.toString,re=$.hasOwnProperty,ne=Y.console,ie=Y.navigator,oe=Y.document,se=Y.opera,ae=Y.screen,le=ie.userAgent,ce=J.bind,ue=Z.forEach,de=Z.indexOf,he=Array.isArray,fe={},pe=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,me={trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},ge={log:function(){if(K.DEBUG&&!me.isUndefined(ne)&&ne)try{ne.log.apply(ne,arguments)}catch(e){me.each(arguments,function(e){ne.log(e)})}},error:function(){if(K.DEBUG&&!me.isUndefined(ne)&&ne){var e=["Mixpanel error:"].concat(me.toArray(arguments));try{ne.error.apply(ne,e)}catch(t){me.each(e,function(e){ne.error(e)})}}},critical:function(){if(!me.isUndefined(ne)&&ne){var e=["Mixpanel error:"].concat(me.toArray(arguments));try{ne.error.apply(ne,e)}catch(t){me.each(e,function(e){ne.error(e)})}}}};me.bind=function(e,t){var r,n;if(ce&&e.bind===ce)return ce.apply(e,ee.call(arguments,1));if(!me.isFunction(e))throw new TypeError;return r=ee.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,r.concat(ee.call(arguments)));var i={};i.prototype=e.prototype;var o=new i;i.prototype=null;var s=e.apply(o,r.concat(ee.call(arguments)));return Object(s)===s?s:o}},me.bind_instance_methods=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=me.bind(e[t],e))},me.each=function(e,t,r){if(null!==e&&void 0!==e)if(ue&&e.forEach===ue)e.forEach(t,r);else if(e.length===+e.length){for(var n=0,i=e.length;i>n;n++)if(n in e&&t.call(r,e[n],n,e)===fe)return}else for(var o in e)if(re.call(e,o)&&t.call(r,e[o],o,e)===fe)return},me.escapeHTML=function(e){var t=e;return t&&me.isString(t)&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")),t},me.extend=function(e){return me.each(ee.call(arguments,1),function(t){for(var r in t)void 0!==t[r]&&(e[r]=t[r])}),e},me.isArray=he||function(e){return"[object Array]"===te.call(e)},me.isFunction=function(e){try{return/^\s*\bfunction\b/.test(e)}catch(t){return!1}},me.isArguments=function(e){return!(!e||!re.call(e,"callee"))},me.toArray=function(e){return e?e.toArray?e.toArray():me.isArray(e)?ee.call(e):me.isArguments(e)?ee.call(e):me.values(e):[]},me.keys=function(e){var t=[];return null===e?t:(me.each(e,function(e,r){t[t.length]=r}),t)},me.values=function(e){var t=[];return null===e?t:(me.each(e,function(e){t[t.length]=e}),t)},me.identity=function(e){return e},me.include=function(e,t){var r=!1;return null===e?r:de&&e.indexOf===de?-1!=e.indexOf(t):(me.each(e,function(e){return r||(r=e===t)?fe:void 0}),r)},me.includes=function(e,t){return-1!==e.indexOf(t)},me.inherit=function(e,t){return e.prototype=new t,e.prototype.constructor=e,e.superclass=t.prototype,e},me.isObject=function(e){return e===Object(e)&&!me.isArray(e)},me.isEmptyObject=function(e){if(me.isObject(e)){for(var t in e)if(re.call(e,t))return!1;return!0}return!1},me.isUndefined=function(e){return void 0===e},me.isString=function(e){return"[object String]"==te.call(e)},me.isDate=function(e){return"[object Date]"==te.call(e)},me.isNumber=function(e){return"[object Number]"==te.call(e)},me.isElement=function(e){return!(!e||1!==e.nodeType)},me.encodeDates=function(e){return me.each(e,function(t,r){me.isDate(t)?e[r]=me.formatDate(t):me.isObject(t)&&(e[r]=me.encodeDates(t))}),e},me.timestamp=function(){return Date.now=Date.now||function(){return+new Date},Date.now()},me.formatDate=function(e){function t(e){return 10>e?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())},me.safewrap=function(e){return function(){try{return e.apply(this,arguments)}catch(t){ge.critical("Implementation error. Please turn on debug and contact support@mixpanel.com."),K.DEBUG&&ge.critical(t)}}},me.safewrap_class=function(e,t){for(var r=0;r<t.length;r++)e.prototype[t[r]]=me.safewrap(e.prototype[t[r]])},me.safewrap_instance_methods=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=me.safewrap(e[t]))},me.strip_empty_properties=function(e){var t={};return me.each(e,function(e,r){me.isString(e)&&e.length>0&&(t[r]=e)}),t},me.truncate=function(e,t){var r;return"string"==typeof e?r=e.slice(0,t):me.isArray(e)?(r=[],me.each(e,function(e){r.push(me.truncate(e,t))})):me.isObject(e)?(r={},me.each(e,function(e,n){r[n]=me.truncate(e,t)})):r=e,r},me.JSONEncode=function(){return function(e){var t=e,r=function(e){var t=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return t.lastIndex=0,t.test(e)?'"'+e.replace(t,function(e){var t=r[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},n=function(e,t){var i="",o="    ",s=0,a="",l="",c=0,u=i,d=[],h=t[e];switch(h&&"object"==typeof h&&"function"==typeof h.toJSON&&(h=h.toJSON(e)),typeof h){case"string":return r(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h)return"null";if(i+=o,d=[],"[object Array]"===te.apply(h)){for(c=h.length,s=0;c>s;s+=1)d[s]=n(s,h)||"null";return l=0===d.length?"[]":i?"[\n"+i+d.join(",\n"+i)+"\n"+u+"]":"["+d.join(",")+"]",i=u,l}for(a in h)re.call(h,a)&&(l=n(a,h),l&&d.push(r(a)+(i?": ":":")+l));return l=0===d.length?"{}":i?"{"+d.join(",")+u+"}":"{"+d.join(",")+"}",i=u,l}};return n("",{"":t})}}(),me.JSONDecode=function(){var e,t,r,n,i={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},o=function(t){var n=new SyntaxError(t);throw n.at=e,n.text=r,n},s=function(n){return n&&n!==t&&o("Expected '"+n+"' instead of '"+t+"'"),t=r.charAt(e),e+=1,t},a=function(){var e,r="";for("-"===t&&(r="-",s("-"));t>="0"&&"9">=t;)r+=t,s();if("."===t)for(r+=".";s()&&t>="0"&&"9">=t;)r+=t;if("e"===t||"E"===t)for(r+=t,s(),("-"===t||"+"===t)&&(r+=t,s());t>="0"&&"9">=t;)r+=t,s();return e=+r,isFinite(e)?e:void o("Bad number")},l=function(){var e,r,n,a="";if('"'===t)for(;s();){if('"'===t)return s(),a;if("\\"===t)if(s(),"u"===t){for(n=0,r=0;4>r&&(e=parseInt(s(),16),isFinite(e));r+=1)n=16*n+e;a+=String.fromCharCode(n)}else{if("string"!=typeof i[t])break;a+=i[t]}else a+=t}o("Bad string")},c=function(){for(;t&&" ">=t;)s()},u=function(){switch(t){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}o('Unexpected "'+t+'"')},d=function(){var e=[];if("["===t){if(s("["),c(),"]"===t)return s("]"),e;for(;t;){if(e.push(n()),c(),"]"===t)return s("]"),e;s(","),c()}}o("Bad array")},h=function(){var e,r={};if("{"===t){if(s("{"),c(),"}"===t)return s("}"),r;for(;t;){if(e=l(),c(),s(":"),Object.hasOwnProperty.call(r,e)&&o('Duplicate key "'+e+'"'),r[e]=n(),c(),"}"===t)return s("}"),r;s(","),c()}}o("Bad object")};return n=function(){switch(c(),t){case"{":return h();case"[":return d();case'"':return l();case"-":return a();default:return t>="0"&&"9">=t?a():u()}},function(i){var s;return r=i,e=0,t=" ",s=n(),c(),t&&o("Syntax error"),s}}(),me.base64Encode=function(e){var t,r,n,i,o,s,a,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,d=0,h="",f=[];if(!e)return e;e=me.utf8Encode(e);do t=e.charCodeAt(u++),r=e.charCodeAt(u++),n=e.charCodeAt(u++),l=t<<16|r<<8|n,i=l>>18&63,o=l>>12&63,s=l>>6&63,a=63&l,f[d++]=c.charAt(i)+c.charAt(o)+c.charAt(s)+c.charAt(a);while(u<e.length);switch(h=f.join(""),e.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=h.slice(0,-1)+"="}return h},me.utf8Encode=function(e){e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var t,r,n,i="",o=0;for(t=r=0,o=e.length,n=0;o>n;n++){var s=e.charCodeAt(n),a=null;128>s?r++:a=s>127&&2048>s?String.fromCharCode(s>>6|192,63&s|128):String.fromCharCode(s>>12|224,s>>6&63|128,63&s|128),null!==a&&(r>t&&(i+=e.substring(t,r)),i+=a,t=r=n+1)}return r>t&&(i+=e.substring(t,e.length)),i},me.UUID=function(){var e=function(){for(var e=1*new Date,t=0;e==1*new Date;)t++;return e.toString(16)+t.toString(16)},t=function(){return Math.random().toString(16).replace(".","")},r=function(){function e(e,t){var r,n=0;for(r=0;r<t.length;r++)n|=i[r]<<8*r;return e^n}var t,r,n=le,i=[],o=0;for(t=0;t<n.length;t++)r=n.charCodeAt(t),i.unshift(255&r),i.length>=4&&(o=e(o,i),i=[]);return i.length>0&&(o=e(o,i)),o.toString(16)};return function(){var n=(ae.height*ae.width).toString(16);return e()+"-"+t()+"-"+r()+"-"+n+"-"+e()}}(),me.isBlockedUA=function(e){return/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(e)?!0:!1},me.HTTPBuildQuery=function(e,t){var r,n,i=[];return me.isUndefined(t)&&(t="&"),me.each(e,function(e,t){r=encodeURIComponent(e.toString()),n=encodeURIComponent(t),i[i.length]=n+"="+r}),i.join(t)},me.getQueryParam=function(e,t){t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\?&]"+t+"=([^&#]*)",n=new RegExp(r),i=n.exec(e);if(null===i||i&&"string"!=typeof i[1]&&i[1].length)return"";var o=i[1];try{o=decodeURIComponent(o)}catch(s){ge.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},me.getHashParam=function(e,t){var r=e.match(new RegExp(t+"=([^&]*)"));return r?r[1]:null},me.cookie={get:function(e){for(var t=e+"=",r=oe.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return null},parse:function(e){var t;try{t=me.JSONDecode(me.cookie.get(e))||{}}catch(r){}return t},set_seconds:function(e,t,r,n,i){var o="",s="",a="";if(n){var l=oe.location.hostname.match(pe),c=l?l[0]:"";o=c?"; domain=."+c:""}if(r){var u=new Date;u.setTime(u.getTime()+1e3*r),s="; expires="+u.toGMTString()}i&&(a="; secure"),oe.cookie=e+"="+encodeURIComponent(t)+s+"; path=/"+o+a},set:function(e,t,r,n,i){var o="",s="",a="";if(n){var l=oe.location.hostname.match(pe),c=l?l[0]:"";o=c?"; domain=."+c:""}if(r){var u=new Date;u.setTime(u.getTime()+24*r*60*60*1e3),s="; expires="+u.toGMTString()}i&&(a="; secure");var d=e+"="+encodeURIComponent(t)+s+"; path=/"+o+a;return oe.cookie=d,d},remove:function(e,t){me.cookie.set(e,"",-1,t)}};var ve=null;me.localStorage={is_supported:function(){if(null!==ve)return ve;var e=!0;try{var t="__mplssupport__",r="xyz";me.localStorage.set(t,r),me.localStorage.get(t)!==r&&(e=!1),me.localStorage.remove(t)}catch(n){e=!1}return e||ge.error("localStorage unsupported; falling back to cookie store"),ve=e,e},error:function(e){ge.error("localStorage error: "+e)},get:function(e){try{return window.localStorage.getItem(e)}catch(t){me.localStorage.error(t)}return null},parse:function(e){try{return me.JSONDecode(me.localStorage.get(e))||{}}catch(t){}return null},set:function(e,t){try{window.localStorage.setItem(e,t)}catch(r){me.localStorage.error(r)}},remove:function(e){try{window.localStorage.removeItem(e)}catch(t){me.localStorage.error(t)}}},me.register_event=function(){function e(e,r,n){var i=function(i){if(i=i||t(window.event)){var o,s,a=!0;return me.isFunction(n)&&(o=n(i)),s=r.call(e,i),(!1===o||!1===s)&&(a=!1),a}};return i}function t(e){return e&&(e.preventDefault=t.preventDefault,e.stopPropagation=t.stopPropagation),e}var r=function(t,r,n,i,o){if(!t)return void ge.error("No valid element provided to register_event");if(t.addEventListener&&!i)t.addEventListener(r,n,!!o);else{var s="on"+r,a=t[s];t[s]=e(t,n,a)}};return t.preventDefault=function(){this.returnValue=!1},t.stopPropagation=function(){this.cancelBubble=!0},r}();var ye=new RegExp('^(\\w*)\\[(\\w+)([=~\\|\\^\\$\\*]?)=?"?([^\\]"]*)"?\\]$');me.dom_query=function(){function e(e){return e.all?e.all:e.getElementsByTagName("*")}function t(e,t){var r=" "+t+" ";return(" "+e.className+" ").replace(n," ").indexOf(r)>=0}function r(r){if(!oe.getElementsByTagName)return[];var n,i,o,s,a,l,c,u,d,h,f=r.split(" "),p=[oe];for(l=0;l<f.length;l++)if(n=f[l].replace(/^\s+/,"").replace(/\s+$/,""),n.indexOf("#")>-1){i=n.split("#"),o=i[0];var m=i[1],g=oe.getElementById(m);if(!g||o&&g.nodeName.toLowerCase()!=o)return[];p=[g]}else if(n.indexOf(".")>-1){i=n.split("."),o=i[0];var v=i[1];for(o||(o="*"),s=[],a=0,c=0;c<p.length;c++)for(d="*"==o?e(p[c]):p[c].getElementsByTagName(o),u=0;u<d.length;u++)s[a++]=d[u];for(p=[],h=0,c=0;c<s.length;c++)s[c].className&&me.isString(s[c].className)&&t(s[c],v)&&(p[h++]=s[c])}else{var y=n.match(ye);if(y){o=y[1];var _=y[2],b=y[3],x=y[4];for(o||(o="*"),s=[],a=0,c=0;c<p.length;c++)for(d="*"==o?e(p[c]):p[c].getElementsByTagName(o),u=0;u<d.length;u++)s[a++]=d[u];p=[],h=0;var w;switch(b){case"=":w=function(e){return e.getAttribute(_)==x};break;case"~":w=function(e){return e.getAttribute(_).match(new RegExp("\\b"+x+"\\b"))};break;case"|":w=function(e){return e.getAttribute(_).match(new RegExp("^"+x+"-?"))};break;case"^":w=function(e){return 0===e.getAttribute(_).indexOf(x)};break;case"$":w=function(e){return e.getAttribute(_).lastIndexOf(x)==e.getAttribute(_).length-x.length};break;case"*":w=function(e){return e.getAttribute(_).indexOf(x)>-1};break;default:w=function(e){return e.getAttribute(_)}}for(p=[],h=0,c=0;c<s.length;c++)w(s[c])&&(p[h++]=s[c])}else{for(o=n,s=[],a=0,c=0;c<p.length;c++)for(d=p[c].getElementsByTagName(o),u=0;u<d.length;u++)s[a++]=d[u];p=s}}return p}var n=/[\t\r\n]/g;return function(e){return me.isElement(e)?[e]:me.isObject(e)&&!me.isUndefined(e.length)?e:r.call(this,e)}}(),me.info={campaignParams:function(){var e="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),t="",r={};return me.each(e,function(e){t=me.getQueryParam(oe.URL,e),t.length&&(r[e]=t)}),r},searchEngine:function(e){return 0===e.search("https?://(.*)google.([^/?]*)")?"google":0===e.search("https?://(.*)bing.com")?"bing":0===e.search("https?://(.*)yahoo.com")?"yahoo":0===e.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(e){var t=me.info.searchEngine(e),r="yahoo"!=t?"q":"p",n={};if(null!==t){n.$search_engine=t;var i=me.getQueryParam(e,r);i.length&&(n.mp_keyword=i)}return n},browser:function(e,t,r){return t=t||"",r||me.includes(e," OPR/")?me.includes(e,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":me.includes(e,"IEMobile")||me.includes(e,"WPDesktop")?"Internet Explorer Mobile":me.includes(e,"SamsungBrowser/")?"Samsung Internet":me.includes(e,"Edge")||me.includes(e,"Edg/")?"Microsoft Edge":me.includes(e,"FBIOS")?"Facebook Mobile":me.includes(e,"Chrome")?"Chrome":me.includes(e,"CriOS")?"Chrome iOS":me.includes(e,"UCWEB")||me.includes(e,"UCBrowser")?"UC Browser":me.includes(e,"FxiOS")?"Firefox iOS":me.includes(t,"Apple")?me.includes(e,"Mobile")?"Mobile Safari":"Safari":me.includes(e,"Android")?"Android Mobile":me.includes(e,"Konqueror")?"Konqueror":me.includes(e,"Firefox")?"Firefox":me.includes(e,"MSIE")||me.includes(e,"Trident/")?"Internet Explorer":me.includes(e,"Gecko")?"Mozilla":""},browserVersion:function(e,t,r){var n=me.info.browser(e,t,r),i={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge?\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Samsung Internet":/SamsungBrowser\/(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/},o=i[n];if(void 0===o)return null;var s=e.match(o);return s?parseFloat(s[s.length-2]):null},os:function(){var e=le;return/Windows/i.test(e)?/Phone/.test(e)||/WPDesktop/.test(e)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"Mac OS X":/Linux/.test(e)?"Linux":/CrOS/.test(e)?"Chrome OS":""},device:function(e){return/Windows Phone/i.test(e)||/WPDesktop/.test(e)?"Windows Phone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Android/.test(e)?"Android":""},referringDomain:function(e){var t=e.split("/");return t.length>=3?t[2]:""},properties:function(){return me.extend(me.strip_empty_properties({$os:me.info.os(),$browser:me.info.browser(le,ie.vendor,se),$referrer:oe.referrer,$referring_domain:me.info.referringDomain(oe.referrer),$device:me.info.device(le)}),{$current_url:Y.location.href,$browser_version:me.info.browserVersion(le,ie.vendor,se),$screen_height:ae.height,$screen_width:ae.width,mp_lib:"web",$lib_version:K.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),time:me.timestamp()/1e3})},people_properties:function(){return me.extend(me.strip_empty_properties({$os:me.info.os(),$browser:me.info.browser(le,ie.vendor,se)}),{$browser_version:me.info.browserVersion(le,ie.vendor,se)})},pageviewInfo:function(e){return me.strip_empty_properties({mp_page:e,mp_referrer:oe.referrer,mp_browser:me.info.browser(le,ie.vendor,se),mp_platform:me.info.os()})}},me.toArray=me.toArray,me.isObject=me.isObject,me.JSONEncode=me.JSONEncode,me.JSONDecode=me.JSONDecode,me.isBlockedUA=me.isBlockedUA,me.isEmptyObject=me.isEmptyObject,me.info=me.info,me.info.device=me.info.device,me.info.browser=me.info.browser,me.info.browserVersion=me.info.browserVersion,me.info.properties=me.info.properties;var _e={_initializedTokens:[],_previousElementSibling:function(e){if(e.previousElementSibling)return e.previousElementSibling;do e=e.previousSibling;while(e&&!o(e));return e},_loadScript:function(e,t){var r=document.createElement("script");r.type="text/javascript",r.src=e,r.onload=t;var n=document.getElementsByTagName("script");n.length>0?n[0].parentNode.insertBefore(r,n[0]):document.body.appendChild(r)},_getPropertiesFromElement:function(e){var t={classes:n(e).split(" "),tag_name:e.tagName.toLowerCase()};c(e)&&me.each(e.attributes,function(e){u(e.value)&&(t["attr__"+e.name]=e.value)});for(var r=1,i=1,o=e;o=this._previousElementSibling(o);)r++,o.tagName===e.tagName&&i++;return t.nth_child=r,t.nth_of_type=i,t},_getDefaultProperties:function(e){return{$event_type:e,$ce_version:1,$host:window.location.host,$pathname:window.location.pathname}},_extractCustomPropertyValue:function(e){var t=[];return me.each(document.querySelectorAll(e.css_selector),function(e){var r;["input","select"].indexOf(e.tagName.toLowerCase())>-1?r=e.value:e.textContent&&(r=e.textContent),u(r)&&t.push(r)}),t.join(", ")},_getCustomProperties:function(e){var t={};return me.each(this._customProperties,function(r){me.each(r.event_selectors,function(n){var i=document.querySelectorAll(n);me.each(i,function(n){me.includes(e,n)&&c(n)&&(t[r.name]=this._extractCustomPropertyValue(r))},this)},this)},this),t},_getEventTarget:function(e){return"undefined"==typeof e.target?e.srcElement:e.target},_trackEvent:function(e,t){var r=this._getEventTarget(e);if(a(r)&&(r=r.parentNode),l(r,e)){for(var o=[r],d=r;d.parentNode&&!s(d,"body");)o.push(d.parentNode),d=d.parentNode;var h,f=[],p=!1;if(me.each(o,function(e){var t=c(e);"a"===e.tagName.toLowerCase()&&(h=e.getAttribute("href"),h=t&&u(h)&&h);var r=n(e).split(" ");me.includes(r,"mp-no-track")&&(p=!0),f.push(this._getPropertiesFromElement(e))},this),p)return!1;var m,g=i(r);g&&g.length&&(m=g);var v=me.extend(this._getDefaultProperties(e.type),{$elements:f,$el_attr__href:h,$el_text:m},this._getCustomProperties(o));return t.track("$web_event",v),!0}},_navigate:function(e){window.location.href=e},_addDomEventHandlers:function(e){var t=me.bind(function(t){t=t||window.event,this._trackEvent(t,e)},this);me.register_event(document,"submit",t,!1,!0),me.register_event(document,"change",t,!1,!0),me.register_event(document,"click",t,!1,!0)},_customProperties:{},init:function(e){if(!document||!document.body){var t=this;return void setTimeout(function(){t.init(e)},500)}var r=e.get_config("token");if(!(this._initializedTokens.indexOf(r)>-1||(this._initializedTokens.push(r),this._maybeLoadEditor(e)))){var n=me.bind(function(t){t&&t.config&&t.config.enable_collect_everything===!0?(t.custom_properties&&(this._customProperties=t.custom_properties),e.track("$web_event",me.extend({$title:document.title},this._getDefaultProperties("pageview"))),this._addDomEventHandlers(e)):e.__autotrack_enabled=!1},this);e._send_request(e.get_config("api_host")+"/decide/",{verbose:!0,version:"1",lib:"web",token:r},{method:"GET",transport:"XHR"},e._prepare_callback(n))}},_editorParamsFromHash:function(e,t){var r;try{var n=me.getHashParam(t,"state");n=JSON.parse(decodeURIComponent(n));var i=me.getHashParam(t,"expires_in");r={accessToken:me.getHashParam(t,"access_token"),accessTokenExpiresAt:(new Date).getTime()+1e3*Number(i),bookmarkletMode:!!n.bookmarkletMode,projectId:n.projectId,projectOwnerId:n.projectOwnerId,projectToken:n.token,readOnly:n.readOnly,userFlags:n.userFlags,userId:n.userId},window.sessionStorage.setItem("editorParams",JSON.stringify(r)),n.desiredHash?window.location.hash=n.desiredHash:window.history?history.replaceState("",document.title,window.location.pathname+window.location.search):window.location.hash=""}catch(o){}return r},_maybeLoadEditor:function(e){try{var t=!1;if(me.getHashParam(window.location.hash,"state")){var r=me.getHashParam(window.location.hash,"state");r=JSON.parse(decodeURIComponent(r)),t="mpeditor"===r.action}var n,i=!!window.sessionStorage.getItem("_mpcehash");return t?n=this._editorParamsFromHash(e,window.location.hash):i?(n=this._editorParamsFromHash(e,window.sessionStorage.getItem("_mpcehash")),window.sessionStorage.removeItem("_mpcehash")):n=JSON.parse(window.sessionStorage.getItem("editorParams")||"{}"),n.projectToken&&e.get_config("token")===n.projectToken?(this._loadEditor(e,n),!0):!1}catch(o){return!1}},_loadEditor:function(e,t){if(!window._mpEditorLoaded){window._mpEditorLoaded=!0;var r=e.get_config("app_host")+"/js-bundle/reports/collect-everything/editor.js?_ts="+(new Date).getTime();return this._loadScript(r,function(){window.mp_load_editor(t)}),!0}return!1},enabledForProject:function(e,t,r){t=me.isUndefined(t)?10:t,r=me.isUndefined(r)?10:r;for(var n=0,i=0;i<e.length;i++)n+=e.charCodeAt(i);return r>n%t},isBrowserSupported:function(){return me.isFunction(document.querySelectorAll)}};me.bind_instance_methods(_e),me.safewrap_instance_methods(_e);var be=function(){};be.prototype.create_properties=function(){},be.prototype.event_handler=function(){},be.prototype.after_track_handler=function(){},be.prototype.init=function(e){return this.mp=e,this},be.prototype.track=function(e,t,r,n){var i=this,o=me.dom_query(e);return 0===o.length?void ge.error("The DOM query ("+e+") returned 0 elements"):(me.each(o,function(e){me.register_event(e,this.override_event,function(e){var o={},s=i.create_properties(r,this),a=i.mp.get_config("track_links_timeout");i.event_handler(e,this,o),window.setTimeout(i.track_callback(n,s,o,!0),a),i.mp.track(t,s,i.track_callback(n,s,o))})},this),!0)},be.prototype.track_callback=function(e,t,r,n){n=n||!1;var i=this;return function(){r.callback_fired||(r.callback_fired=!0,e&&e(n,t)===!1||i.after_track_handler(t,r,n))}},be.prototype.create_properties=function(e,t){var r;return r="function"==typeof e?e(t):me.extend({},e)};var xe=function(){this.override_event="click"};me.inherit(xe,be),xe.prototype.create_properties=function(e,t){var r=xe.superclass.create_properties.apply(this,arguments);return t.href&&(r.url=t.href),r},xe.prototype.event_handler=function(e,t,r){r.new_tab=2===e.which||e.metaKey||e.ctrlKey||"_blank"===t.target,r.href=t.href,r.new_tab||e.preventDefault()},xe.prototype.after_track_handler=function(e,t){t.new_tab||setTimeout(function(){window.location=t.href},0)};var we=function(){this.override_event="submit"};me.inherit(we,be),we.prototype.event_handler=function(e,t,r){r.element=t,e.preventDefault()},we.prototype.after_track_handler=function(e,t){setTimeout(function(){t.element.submit()},0)};var Ee="__mp_opt_in_out_",Se="$set",Ae="$set_once",Me="$unset",Te="$add",Ce="$append",je="$union",Pe="$remove",Le="$delete",De={set_action:function(e,t){var r={},n={};return me.isObject(e)?me.each(e,function(e,t){this._is_reserved_property(t)||(n[t]=e)},this):n[e]=t,r[Se]=n,r},unset_action:function(e){var t={},r=[];return me.isArray(e)||(e=[e]),me.each(e,function(e){this._is_reserved_property(e)||r.push(e)},this),t[Me]=r,t},set_once_action:function(e,t){var r={},n={};return me.isObject(e)?me.each(e,function(e,t){this._is_reserved_property(t)||(n[t]=e)},this):n[e]=t,r[Ae]=n,r},union_action:function(e,t){var r={},n={};return me.isObject(e)?me.each(e,function(e,t){this._is_reserved_property(t)||(n[t]=me.isArray(e)?e:[e])},this):n[e]=me.isArray(t)?t:[t],r[je]=n,r},append_action:function(e,t){var r={},n={};return me.isObject(e)?me.each(e,function(e,t){this._is_reserved_property(t)||(n[t]=e)},this):n[e]=t,r[Ce]=n,r},remove_action:function(e,t){var r={},n={};return me.isObject(e)?me.each(e,function(e,t){this._is_reserved_property(t)||(n[t]=e)},this):n[e]=t,r[Pe]=n,r},delete_action:function(){var e={};return e[Le]="",e}},Ie=function(){};me.extend(Ie.prototype,De),Ie.prototype._init=function(e,t,r){this._mixpanel=e,this._group_key=t,this._group_id=r},Ie.prototype.set=v(function(e,t,r){var n=this.set_action(e,t);return me.isObject(e)&&(r=t),this._send_request(n,r)}),Ie.prototype.set_once=v(function(e,t,r){var n=this.set_once_action(e,t);return me.isObject(e)&&(r=t),this._send_request(n,r)}),Ie.prototype.unset=v(function(e,t){var r=this.unset_action(e);return this._send_request(r,t)}),Ie.prototype.union=v(function(e,t,r){me.isObject(e)&&(r=t);var n=this.union_action(e,t);return this._send_request(n,r)}),Ie.prototype["delete"]=v(function(e){var t=this.delete_action();return this._send_request(t,e)}),Ie.prototype.remove=v(function(e,t,r){var n=this.remove_action(e,t);return this._send_request(n,r)}),Ie.prototype._send_request=function(e,t){e.$group_key=this._group_key,e.$group_id=this._group_id,e.$token=this._get_config("token");var r=me.encodeDates(e),n=me.truncate(r,255),i=me.JSONEncode(r),o=me.base64Encode(i);return ge.log(e),this._mixpanel._send_request(this._mixpanel.get_config("api_host")+"/groups/",{data:o},this._mixpanel._prepare_callback(t,n)),n},Ie.prototype._is_reserved_property=function(e){return"$group_key"===e||"$group_id"===e},Ie.prototype._get_config=function(e){return this._mixpanel.get_config(e)},Ie.prototype.toString=function(){return this._mixpanel.toString()+".group."+this._group_key+"."+this._group_id},Ie.prototype.remove=Ie.prototype.remove,Ie.prototype.set=Ie.prototype.set,Ie.prototype.set_once=Ie.prototype.set_once,
Ie.prototype.union=Ie.prototype.union,Ie.prototype.unset=Ie.prototype.unset,Ie.prototype.toString=Ie.prototype.toString;var Re="__mps",Oe="__mpso",ke="__mpus",Ne="__mpa",Fe="__mpap",Ve="__mpr",Ue="__mpu",Be="$people_distinct_id",ze="__alias",Ge="__cmpns",He="__timers",We=[Re,Oe,ke,Ne,Fe,Ve,Ue,Be,ze,Ge,He],qe=function(e){this.props={},this.campaign_params_saved=!1,e.persistence_name?this.name="mp_"+e.persistence_name:this.name="mp_"+e.token+"_mixpanel";var t=e.persistence;"cookie"!==t&&"localStorage"!==t&&(ge.critical("Unknown persistence type "+t+"; falling back to cookie"),t=e.persistence="cookie"),"localStorage"===t&&me.localStorage.is_supported()?this.storage=me.localStorage:this.storage=me.cookie,this.load(),this.update_config(e),this.upgrade(e),this.save()};qe.prototype.properties=function(){var e={};return me.each(this.props,function(t,r){me.include(We,r)||(e[r]=t)}),e},qe.prototype.load=function(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=me.extend({},e))}},qe.prototype.upgrade=function(e){var t,r,n=e.upgrade;n&&(t="mp_super_properties","string"==typeof n&&(t=n),r=this.storage.parse(t),this.storage.remove(t),this.storage.remove(t,!0),r&&(this.props=me.extend(this.props,r.all,r.events))),e.cookie_name||"mixpanel"===e.name||(t="mp_"+e.token+"_"+e.name,r=this.storage.parse(t),r&&(this.storage.remove(t),this.storage.remove(t,!0),this.register_once(r))),this.storage===me.localStorage&&(r=me.cookie.parse(this.name),me.cookie.remove(this.name),me.cookie.remove(this.name,!0),r&&this.register_once(r))},qe.prototype.save=function(){this.disabled||(this._expire_notification_campaigns(),this.storage.set(this.name,me.JSONEncode(this.props),this.expire_days,this.cross_subdomain,this.secure))},qe.prototype.remove=function(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)},qe.prototype.clear=function(){this.remove(),this.props={}},qe.prototype.register_once=function(e,t,r){return me.isObject(e)?("undefined"==typeof t&&(t="None"),this.expire_days="undefined"==typeof r?this.default_expiry:r,me.each(e,function(e,r){this.props.hasOwnProperty(r)&&this.props[r]!==t||(this.props[r]=e)},this),this.save(),!0):!1},qe.prototype.register=function(e,t){return me.isObject(e)?(this.expire_days="undefined"==typeof t?this.default_expiry:t,me.extend(this.props,e),this.save(),!0):!1},qe.prototype.unregister=function(e){e in this.props&&(delete this.props[e],this.save())},qe.prototype._expire_notification_campaigns=me.safewrap(function(){var e=this.props[Ge],t=K.DEBUG?6e4:36e5;if(e){for(var r in e)1*new Date-e[r]>t&&delete e[r];me.isEmptyObject(e)&&delete this.props[Ge]}}),qe.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register_once(me.info.campaignParams()),this.campaign_params_saved=!0)},qe.prototype.update_search_keyword=function(e){this.register(me.info.searchInfo(e))},qe.prototype.update_referrer_info=function(e){this.register_once({$initial_referrer:e||"$direct",$initial_referring_domain:me.info.referringDomain(e)||"$direct"},"")},qe.prototype.get_referrer_info=function(){return me.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})},qe.prototype.safe_merge=function(e){return me.each(this.props,function(t,r){r in e||(e[r]=t)}),e},qe.prototype.update_config=function(e){this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie)},qe.prototype.set_disabled=function(e){this.disabled=e,this.disabled?this.remove():this.save()},qe.prototype.set_cross_subdomain=function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())},qe.prototype.get_cross_subdomain=function(){return this.cross_subdomain},qe.prototype.set_secure=function(e){e!==this.secure&&(this.secure=e?!0:!1,this.remove(),this.save())},qe.prototype._add_to_people_queue=function(e,t){var r=this._get_queue_key(e),n=t[e],i=this._get_or_create_queue(Se),o=this._get_or_create_queue(Ae),s=this._get_or_create_queue(Me),a=this._get_or_create_queue(Te),l=this._get_or_create_queue(je),c=this._get_or_create_queue(Pe,[]),u=this._get_or_create_queue(Ce,[]);r===Re?(me.extend(i,n),this._pop_from_people_queue(Te,n),this._pop_from_people_queue(je,n),this._pop_from_people_queue(Me,n)):r===Oe?(me.each(n,function(e,t){t in o||(o[t]=e)}),this._pop_from_people_queue(Me,n)):r===ke?me.each(n,function(e){me.each([i,o,a,l],function(t){e in t&&delete t[e]}),me.each(u,function(t){e in t&&delete t[e]}),s[e]=!0}):r===Ne?(me.each(n,function(e,t){t in i?i[t]+=e:(t in a||(a[t]=0),a[t]+=e)},this),this._pop_from_people_queue(Me,n)):r===Ue?(me.each(n,function(e,t){me.isArray(e)&&(t in l||(l[t]=[]),l[t]=l[t].concat(e))}),this._pop_from_people_queue(Me,n)):r===Ve?(c.push(n),this._pop_from_people_queue(Ce,n)):r===Fe&&(u.push(n),this._pop_from_people_queue(Me,n)),ge.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):"),ge.log(t),this.save()},qe.prototype._pop_from_people_queue=function(e,t){var r=this._get_queue(e);me.isUndefined(r)||(me.each(t,function(t,n){e===Ce||e===Pe?me.each(r,function(e){e[n]===t&&delete e[n]}):delete r[n]},this),this.save())},qe.prototype._get_queue_key=function(e){return e===Se?Re:e===Ae?Oe:e===Me?ke:e===Te?Ne:e===Ce?Fe:e===Pe?Ve:e===je?Ue:void ge.error("Invalid queue:",e)},qe.prototype._get_queue=function(e){return this.props[this._get_queue_key(e)]},qe.prototype._get_or_create_queue=function(e,t){var r=this._get_queue_key(e);return t=me.isUndefined(t)?{}:t,this.props[r]||(this.props[r]=t)},qe.prototype.set_event_timer=function(e,t){var r=this.props[He]||{};r[e]=t,this.props[He]=r,this.save()},qe.prototype.remove_event_timer=function(e){var t=this.props[He]||{},r=t[e];return me.isUndefined(r)||(delete this.props[He][e],this.save()),r};var Xe="operator",Ye="property",Ke="window",Qe="unit",Ze="value",Je="hour",$e="day",et="week",tt="month",rt="event",nt="literal",it="and",ot="or",st="in",at="not in",lt="+",ct="-",ut="*",dt="/",ht="%",ft="==",pt="!=",mt=">",gt="<",vt=">=",yt="<=",_t="boolean",bt="datetime",xt="list",wt="number",Et="string",St="not",At="defined",Mt="not defined",Tt="now",Ct=function(e,t){me.bind_instance_methods(this),this.mixpanel=t,this.persistence=this.mixpanel.persistence,this.resource_protocol=this.mixpanel.get_config("inapp_protocol"),this.cdn_host=this.mixpanel.get_config("cdn"),this.campaign_id=me.escapeHTML(e.id),this.message_id=me.escapeHTML(e.message_id),this.body=(me.escapeHTML(e.body)||"").replace(/\n/g,"<br/>"),this.cta=me.escapeHTML(e.cta)||"Close",this.notif_type=me.escapeHTML(e.type)||"takeover",this.style=me.escapeHTML(e.style)||"light",this.title=me.escapeHTML(e.title)||"",this.video_width=Ct.VIDEO_WIDTH,this.video_height=Ct.VIDEO_HEIGHT,this.display_triggers=e.display_triggers||[],this.dest_url=e.cta_url||null,this.image_url=e.image_url||null,this.thumb_image_url=e.thumb_image_url||null,this.video_url=e.video_url||null,this.thumb_image_url&&0===this.thumb_image_url.indexOf("//")&&(this.thumb_image_url=this.thumb_image_url.replace("//",this.resource_protocol)),this.clickthrough=!0,this.dest_url||(this.dest_url="#dismiss",this.clickthrough=!1),this.mini="mini"===this.notif_type,this.mini||(this.notif_type="takeover"),this.notif_width=this.mini?Ct.NOTIF_WIDTH_MINI:Ct.NOTIF_WIDTH,this._set_client_config(),this.imgs_to_preload=this._init_image_html(),this._init_video()};Ct.ANIM_TIME=200,Ct.MARKUP_PREFIX="mixpanel-notification",Ct.BG_OPACITY=.6,Ct.NOTIF_TOP=25,Ct.NOTIF_START_TOP=200,Ct.NOTIF_WIDTH=388,Ct.NOTIF_WIDTH_MINI=420,Ct.NOTIF_HEIGHT_MINI=85,Ct.THUMB_BORDER_SIZE=5,Ct.THUMB_IMG_SIZE=60,Ct.THUMB_OFFSET=Math.round(Ct.THUMB_IMG_SIZE/2),Ct.VIDEO_WIDTH=595,Ct.VIDEO_HEIGHT=334,Ct.prototype.show=function(){var e=this;return this._set_client_config(),this.body_el?(this._init_styles(),this._init_notification_el(),void this._preload_images(this._attach_and_animate)):void setTimeout(function(){e.show()},300)},Ct.prototype.dismiss=me.safewrap(function(){this.marked_as_shown||this._mark_delivery({invisible:!0});var e=this.showing_video?this._get_el("video"):this._get_notification_display_el();if(this.use_transitions)this._remove_class("bg","visible"),this._add_class(e,"exiting"),setTimeout(this._remove_notification_el,Ct.ANIM_TIME);else{var t,r,n;this.mini?(t="right",r=20,n=-100):(t="top",r=Ct.NOTIF_TOP,n=Ct.NOTIF_START_TOP+Ct.NOTIF_TOP),this._animate_els([{el:this._get_el("bg"),attr:"opacity",start:Ct.BG_OPACITY,goal:0},{el:e,attr:"opacity",start:1,goal:0},{el:e,attr:t,start:r,goal:n}],Ct.ANIM_TIME,this._remove_notification_el)}}),Ct.prototype._add_class=me.safewrap(function(e,t){t=Ct.MARKUP_PREFIX+"-"+t,"string"==typeof e&&(e=this._get_el(e)),e.className?~(" "+e.className+" ").indexOf(" "+t+" ")||(e.className+=" "+t):e.className=t}),Ct.prototype._remove_class=me.safewrap(function(e,t){t=Ct.MARKUP_PREFIX+"-"+t,"string"==typeof e&&(e=this._get_el(e)),e.className&&(e.className=(" "+e.className+" ").replace(" "+t+" ","").replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,""))}),Ct.prototype._animate_els=me.safewrap(function(e,t,r,n){var i,o,s,a=this,l=!1,c=1*new Date;for(n=n||c,s=c-n,i=0;i<e.length;i++)if(o=e[i],"undefined"==typeof o.val&&(o.val=o.start),o.val!==o.goal){l=!0;var u=o.goal-o.start,d=o.goal>=o.start?1:-1;o.val=o.start+u*s/t,"opacity"!==o.attr&&(o.val=Math.round(o.val)),(d>0&&o.val>=o.goal||0>d&&o.val<=o.goal)&&(o.val=o.goal)}if(!l)return void(r&&r());for(i=0;i<e.length;i++)if(o=e[i],o.el){var h="opacity"===o.attr?"":"px";o.el.style[o.attr]=String(o.val)+h}setTimeout(function(){a._animate_els(e,t,r,n)},10)}),Ct.prototype._attach_and_animate=me.safewrap(function(){var e=this;if(!this.shown&&!this._get_shown_campaigns()[this.campaign_id]){this.shown=!0,this.body_el.appendChild(this.notification_el),setTimeout(function(){var t=e._get_notification_display_el();if(e.use_transitions)e.mini||e._add_class("bg","visible"),e._add_class(t,"visible"),e._mark_as_shown();else{var r,n,i;e.mini?(r="right",n=-100,i=20):(r="top",n=Ct.NOTIF_START_TOP+Ct.NOTIF_TOP,i=Ct.NOTIF_TOP),e._animate_els([{el:e._get_el("bg"),attr:"opacity",start:0,goal:Ct.BG_OPACITY},{el:t,attr:"opacity",start:0,goal:1},{el:t,attr:r,start:n,goal:i}],Ct.ANIM_TIME,e._mark_as_shown)}},100),me.register_event(e._get_el("cancel"),"click",function(t){t.preventDefault(),e.dismiss()});var t=e._get_el("button")||e._get_el("mini-content");me.register_event(t,"click",function(t){if(t.preventDefault(),e.show_video)e._track_event("$campaign_open",{$resource_type:"video"}),e._switch_to_video();else if(e.dismiss(),e.clickthrough){var r=null;e.mixpanel.get_config("inapp_link_new_window")?window.open(e.dest_url):r=function(){window.location.href=e.dest_url},e._track_event("$campaign_open",{$resource_type:"link"},r)}})}}),Ct.prototype._get_el=function(e){return document.getElementById(Ct.MARKUP_PREFIX+"-"+e)},Ct.prototype._get_notification_display_el=function(){return this._get_el(this.notif_type)},Ct.prototype._get_shown_campaigns=function(){return this.persistence.props[Ge]||(this.persistence.props[Ge]={})},Ct.prototype._matches_event_data=me.safewrap(function(e){for(var t=e.event||"",r=0;r<this.display_triggers.length;r++){var n=this.display_triggers[r],i=n.event||"";if("$any_event"===i||t===n.event){if(!n.selector||me.isEmptyObject(n.selector))return!0;if(q(n.selector,e.properties))return!0}}return!1}),Ct.prototype._browser_lte=function(e,t){return this.browser_versions[e]&&this.browser_versions[e]<=t},Ct.prototype._init_image_html=function(){var e=[];return this.mini?(this.thumb_image_url=this.thumb_image_url||this.cdn_host+"/site_media/images/icons/notifications/mini-news-dark.png",e.push(this.thumb_image_url)):(this.image_url?(e.push(this.image_url),this.img_html='<img id="img" src="'+this.image_url+'"/>'):this.img_html="",this.thumb_image_url?(e.push(this.thumb_image_url),this.thumb_img_html='<div id="thumbborder-wrapper"><div id="thumbborder"></div></div><img id="thumbnail" src="'+this.thumb_image_url+'" width="'+Ct.THUMB_IMG_SIZE+'" height="'+Ct.THUMB_IMG_SIZE+'"/><div id="thumbspacer"></div>'):this.thumb_img_html=""),e},Ct.prototype._init_notification_el=function(){var e="",t="",r="",n='<div id="cancel"><div id="cancel-icon"></div></div>';if(this.notification_el=document.createElement("div"),this.notification_el.id=Ct.MARKUP_PREFIX+"-wrapper",this.mini)e='<div id="mini"><div id="mainbox">'+n+'<div id="mini-content"><div id="mini-icon"><div id="mini-icon-img"></div></div><div id="body"><div id="body-text"><div>'+this.body+'</div></div></div></div></div><div id="mini-border"></div></div>';else{var i=this.clickthrough||this.show_video?"":'<div id="button-close"></div>',o=this.show_video?'<div id="button-play"></div>':"";this._browser_lte("ie",7)&&(i="",o=""),e='<div id="takeover">'+this.thumb_img_html+'<div id="mainbox">'+n+'<div id="content">'+this.img_html+'<div id="title">'+this.title+'</div><div id="body">'+this.body+'</div><div id="tagline"><a href="http://mixpanel.com?from=inapp" target="_blank">POWERED BY MIXPANEL</a></div></div><div id="button">'+i+'<a id="button-link" href="'+this.dest_url+'">'+this.cta+"</a>"+o+"</div></div></div>"}this.youtube_video?(t=this.resource_protocol+"www.youtube.com/embed/"+this.youtube_video+"?wmode=transparent&showinfo=0&modestbranding=0&rel=0&autoplay=1&loop=0&vq=hd1080",this.yt_custom&&(t+="&enablejsapi=1&html5=1&controls=0",r='<div id="video-controls"><div id="video-progress" class="video-progress-el"><div id="video-progress-total" class="video-progress-el"></div><div id="video-elapsed" class="video-progress-el"></div></div><div id="video-time" class="video-progress-el"></div></div>')):this.vimeo_video&&(t=this.resource_protocol+"player.vimeo.com/video/"+this.vimeo_video+"?autoplay=1&title=0&byline=0&portrait=0"),this.show_video&&(this.video_iframe='<iframe id="'+Ct.MARKUP_PREFIX+'-video-frame" width="'+this.video_width+'" height="'+this.video_height+'"  src="'+t+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen="1" scrolling="no"></iframe>',r='<div id="video-'+(this.flip_animate?"":"no")+'flip"><div id="video"><div id="video-holder"></div>'+r+"</div></div>");var s=r+e;this.flip_animate&&(s=(this.mini?e:"")+'<div id="flipcontainer"><div id="flipper">'+(this.mini?r:s)+"</div></div>"),this.notification_el.innerHTML=('<div id="overlay" class="'+this.notif_type+'"><div id="campaignid-'+this.campaign_id+'"><div id="bgwrapper"><div id="bg"></div>'+s+"</div></div></div>").replace(/class="/g,'class="'+Ct.MARKUP_PREFIX+"-").replace(/id="/g,'id="'+Ct.MARKUP_PREFIX+"-")},Ct.prototype._init_styles=function(){"dark"===this.style?this.style_vals={bg:"#1d1f25",bg_actions:"#282b32",bg_hover:"#3a4147",bg_light:"#4a5157",border_gray:"#32353c",cancel_opacity:"0.4",mini_hover:"#2a3137",text_title:"#fff",text_main:"#9498a3",text_tagline:"#464851",text_hover:"#ddd"}:this.style_vals={bg:"#fff",bg_actions:"#e7eaee",bg_hover:"#eceff3",bg_light:"#f5f5f5",border_gray:"#e4ecf2",cancel_opacity:"1.0",mini_hover:"#fafafa",text_title:"#5c6578",text_main:"#8b949b",text_tagline:"#ced9e6",text_hover:"#7c8598"};var e="0px 0px 35px 0px rgba(45, 49, 56, 0.7)",t=e,r=e,n=Ct.THUMB_IMG_SIZE+2*Ct.THUMB_BORDER_SIZE,i=Ct.ANIM_TIME/1e3+"s";this.mini&&(e="none");var o={},s=Ct.NOTIF_WIDTH_MINI+20;o["@media only screen and (max-width: "+(s-1)+"px)"]={"#overlay":{display:"none"}};var a={".flipped":{transform:"rotateY(180deg)"},"#overlay":{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",overflow:"auto","text-align":"center","z-index":"10000","font-family":'"Helvetica", "Arial", sans-serif',"-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"},"#overlay.mini":{height:"0",overflow:"visible"},"#overlay a":{width:"initial",padding:"0","text-decoration":"none","text-transform":"none",color:"inherit"},"#bgwrapper":{position:"relative",width:"100%",height:"100%"},"#bg":{position:"fixed",top:"0",left:"0",width:"100%",height:"100%","min-width":4*this.doc_width+"px","min-height":4*this.doc_height+"px","background-color":"black",opacity:"0.0","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=60)",filter:"alpha(opacity=60)",transition:"opacity "+i},"#bg.visible":{opacity:Ct.BG_OPACITY},".mini #bg":{width:"0",height:"0","min-width":"0"},"#flipcontainer":{perspective:"1000px",position:"absolute",width:"100%"},"#flipper":{position:"relative","transform-style":"preserve-3d",transition:"0.3s"},"#takeover":{position:"absolute",left:"50%",width:Ct.NOTIF_WIDTH+"px","margin-left":Math.round(-Ct.NOTIF_WIDTH/2)+"px","backface-visibility":"hidden",transform:"rotateY(0deg)",opacity:"0.0",top:Ct.NOTIF_START_TOP+"px",transition:"opacity "+i+", top "+i},"#takeover.visible":{opacity:"1.0",top:Ct.NOTIF_TOP+"px"},"#takeover.exiting":{opacity:"0.0",top:Ct.NOTIF_START_TOP+"px"},"#thumbspacer":{height:Ct.THUMB_OFFSET+"px"},"#thumbborder-wrapper":{position:"absolute",top:-Ct.THUMB_BORDER_SIZE+"px",left:Ct.NOTIF_WIDTH/2-Ct.THUMB_OFFSET-Ct.THUMB_BORDER_SIZE+"px",width:n+"px",height:n/2+"px",overflow:"hidden"},"#thumbborder":{position:"absolute",width:n+"px",height:n+"px","border-radius":n+"px","background-color":this.style_vals.bg_actions,opacity:"0.5"},"#thumbnail":{position:"absolute",top:"0px",left:Ct.NOTIF_WIDTH/2-Ct.THUMB_OFFSET+"px",width:Ct.THUMB_IMG_SIZE+"px",height:Ct.THUMB_IMG_SIZE+"px",overflow:"hidden","z-index":"100","border-radius":Ct.THUMB_IMG_SIZE+"px"},"#mini":{position:"absolute",right:"20px",top:Ct.NOTIF_TOP+"px",width:this.notif_width+"px",height:2*Ct.NOTIF_HEIGHT_MINI+"px","margin-top":20-Ct.NOTIF_HEIGHT_MINI+"px","backface-visibility":"hidden",opacity:"0.0",transform:"rotateX(90deg)",transition:"opacity 0.3s, transform 0.3s, right 0.3s"},"#mini.visible":{opacity:"1.0",transform:"rotateX(0deg)"},"#mini.exiting":{opacity:"0.0",right:"-150px"},"#mainbox":{"border-radius":"4px","box-shadow":e,"text-align":"center","background-color":this.style_vals.bg,"font-size":"14px",color:this.style_vals.text_main},"#mini #mainbox":{height:Ct.NOTIF_HEIGHT_MINI+"px","margin-top":Ct.NOTIF_HEIGHT_MINI+"px","border-radius":"3px",transition:"background-color "+i},"#mini-border":{height:Ct.NOTIF_HEIGHT_MINI+6+"px",width:Ct.NOTIF_WIDTH_MINI+6+"px",position:"absolute",top:"-3px",left:"-3px","margin-top":Ct.NOTIF_HEIGHT_MINI+"px","border-radius":"6px",opacity:"0.25","background-color":"#fff","z-index":"-1","box-shadow":r},"#mini-icon":{position:"relative",display:"inline-block",width:"75px",height:Ct.NOTIF_HEIGHT_MINI+"px","border-radius":"3px 0 0 3px","background-color":this.style_vals.bg_actions,background:"linear-gradient(135deg, "+this.style_vals.bg_light+" 0%, "+this.style_vals.bg_actions+" 100%)",transition:"background-color "+i},"#mini:hover #mini-icon":{"background-color":this.style_vals.mini_hover},"#mini:hover #mainbox":{"background-color":this.style_vals.mini_hover},"#mini-icon-img":{position:"absolute","background-image":"url("+this.thumb_image_url+")",width:"48px",height:"48px",top:"20px",left:"12px"},"#content":{padding:"30px 20px 0px 20px"},"#mini-content":{"text-align":"left",height:Ct.NOTIF_HEIGHT_MINI+"px",cursor:"pointer"},"#img":{width:"328px","margin-top":"30px","border-radius":"5px"},"#title":{"max-height":"600px",overflow:"hidden","word-wrap":"break-word",padding:"25px 0px 20px 0px","font-size":"19px","font-weight":"bold",color:this.style_vals.text_title},"#body":{"max-height":"600px","margin-bottom":"25px",overflow:"hidden","word-wrap":"break-word","line-height":"21px","font-size":"15px","font-weight":"normal","text-align":"left"},"#mini #body":{display:"inline-block","max-width":"250px",margin:"0 0 0 30px",height:Ct.NOTIF_HEIGHT_MINI+"px","font-size":"16px","letter-spacing":"0.8px",color:this.style_vals.text_title},"#mini #body-text":{display:"table",height:Ct.NOTIF_HEIGHT_MINI+"px"},"#mini #body-text div":{display:"table-cell","vertical-align":"middle"},"#tagline":{"margin-bottom":"15px","font-size":"10px","font-weight":"600","letter-spacing":"0.8px",color:"#ccd7e0","text-align":"left"},"#tagline a":{color:this.style_vals.text_tagline,transition:"color "+i},"#tagline a:hover":{color:this.style_vals.text_hover},"#cancel":{position:"absolute",right:"0",width:"8px",height:"8px",padding:"10px","border-radius":"20px",margin:"12px 12px 0 0","box-sizing":"content-box",cursor:"pointer",transition:"background-color "+i},"#mini #cancel":{margin:"7px 7px 0 0"},"#cancel-icon":{width:"8px",height:"8px",overflow:"hidden","background-image":"url("+this.cdn_host+"/site_media/images/icons/notifications/cancel-x.png)",opacity:this.style_vals.cancel_opacity},"#cancel:hover":{"background-color":this.style_vals.bg_hover},"#button":{display:"block",height:"60px","line-height":"60px","text-align":"center","background-color":this.style_vals.bg_actions,"border-radius":"0 0 4px 4px",overflow:"hidden",cursor:"pointer",transition:"background-color "+i},"#button-close":{display:"inline-block",width:"9px",height:"60px","margin-right":"8px","vertical-align":"top","background-image":"url("+this.cdn_host+"/site_media/images/icons/notifications/close-x-"+this.style+".png)","background-repeat":"no-repeat","background-position":"0px 25px"},"#button-play":{display:"inline-block",width:"30px",height:"60px","margin-left":"15px","background-image":"url("+this.cdn_host+"/site_media/images/icons/notifications/play-"+this.style+"-small.png)","background-repeat":"no-repeat","background-position":"0px 15px"},"a#button-link":{display:"inline-block","vertical-align":"top","text-align":"center","font-size":"17px","font-weight":"bold",overflow:"hidden","word-wrap":"break-word",color:this.style_vals.text_title,transition:"color "+i},"#button:hover":{"background-color":this.style_vals.bg_hover,color:this.style_vals.text_hover},"#button:hover a":{color:this.style_vals.text_hover},"#video-noflip":{position:"relative",top:2*-this.video_height+"px"},"#video-flip":{"backface-visibility":"hidden",transform:"rotateY(180deg)"},"#video":{position:"absolute",width:this.video_width-1+"px",height:this.video_height+"px",top:Ct.NOTIF_TOP+"px","margin-top":"100px",left:"50%","margin-left":Math.round(-this.video_width/2)+"px",overflow:"hidden","border-radius":"5px","box-shadow":t,transform:"translateZ(1px)",transition:"opacity "+i+", top "+i},"#video.exiting":{opacity:"0.0",top:this.video_height+"px"},"#video-holder":{position:"absolute",width:this.video_width-1+"px",height:this.video_height+"px",overflow:"hidden","border-radius":"5px"},"#video-frame":{"margin-left":"-1px",width:this.video_width+"px"},"#video-controls":{opacity:"0",transition:"opacity 0.5s"},"#video:hover #video-controls":{opacity:"1.0"},"#video .video-progress-el":{position:"absolute",bottom:"0",height:"25px","border-radius":"0 0 0 5px"},"#video-progress":{width:"90%"},"#video-progress-total":{width:"100%","background-color":this.style_vals.bg,opacity:"0.7"},"#video-elapsed":{width:"0","background-color":"#6cb6f5",opacity:"0.9"},"#video #video-time":{width:"10%",right:"0","font-size":"11px","line-height":"25px",color:this.style_vals.text_main,"background-color":"#666","border-radius":"0 0 5px 0"}};this._browser_lte("ie",8)&&me.extend(a,{"* html #overlay":{position:"absolute"},"* html #bg":{position:"absolute"},"html, body":{height:"100%"}}),this._browser_lte("ie",7)&&me.extend(a,{"#mini #body":{display:"inline",zoom:"1",border:"1px solid "+this.style_vals.bg_hover},"#mini #body-text":{padding:"20px"},"#mini #mini-icon":{display:"none"}});var l=["backface-visibility","border-radius","box-shadow","opacity","perspective","transform","transform-style","transition"],c=["khtml","moz","ms","o","webkit"];for(var u in a)for(var d=0;d<l.length;d++){var h=l[d];if(h in a[u])for(var f=a[u][h],p=0;p<c.length;p++)a[u]["-"+c[p]+"-"+h]=f}var m=function(e,t){var r=function(e){var t="";for(var r in e){var n=r.replace(/#/g,"#"+Ct.MARKUP_PREFIX+"-").replace(/\./g,"."+Ct.MARKUP_PREFIX+"-");t+="\n"+n+" {";var i=e[r];for(var o in i)t+=o+":"+i[o]+";";t+="}"}return t},n=function(e){var t="";for(var n in e)t+="\n"+n+" {"+r(e[n])+"\n}";return t},i=r(e)+n(t),o=document.head||document.getElementsByTagName("head")[0]||document.documentElement,s=document.createElement("style");o.appendChild(s),s.setAttribute("type","text/css"),s.styleSheet?s.styleSheet.cssText=i:s.textContent=i};m(a,o)},Ct.prototype._init_video=me.safewrap(function(){if(this.video_url){var e=this;e.yt_custom="postMessage"in window,e.dest_url=e.video_url;var t=e.video_url.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?/ ]{11})/i),r=e.video_url.match(/vimeo\.com\/.*?(\d+)/i);if(t){if(e.show_video=!0,e.youtube_video=t[1],e.yt_custom){window.onYouTubeIframeAPIReady=function(){e._get_el("video-frame")&&e._yt_video_ready()};var n=document.createElement("script");n.src=e.resource_protocol+"www.youtube.com/iframe_api";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)}}else r&&(e.show_video=!0,e.vimeo_video=r[1]);(e._browser_lte("ie",7)||e._browser_lte("firefox",3))&&(e.show_video=!1,e.clickthrough=!0)}}),Ct.prototype._mark_as_shown=me.safewrap(function(){var e=this;me.register_event(e._get_el("bg"),"click",function(){e.dismiss()});var t=function(e,t){var r={};return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(e,null):e.currentStyle&&(r=e.currentStyle),r[t]};if(this.campaign_id){var r=this._get_el("overlay");r&&"hidden"!==t(r,"visibility")&&"none"!==t(r,"display")&&this._mark_delivery()}}),Ct.prototype._mark_delivery=me.safewrap(function(e){this.marked_as_shown||(this.marked_as_shown=!0,this.campaign_id&&(this._get_shown_campaigns()[this.campaign_id]=1*new Date,this.persistence.save()),this._track_event("$campaign_delivery",e),this.mixpanel.people.append({$campaigns:this.campaign_id,$notifications:{campaign_id:this.campaign_id,message_id:this.message_id,type:"web",time:new Date}}))}),Ct.prototype._preload_images=function(e){var t=this;if(0===this.imgs_to_preload.length)return void e();for(var r=0,n=[],i=function(){r++,r===t.imgs_to_preload.length&&e&&(e(),e=null)},o=0;o<this.imgs_to_preload.length;o++){var s=new Image;s.onload=i,s.src=this.imgs_to_preload[o],s.complete&&i(),n.push(s)}this._browser_lte("ie",7)&&setTimeout(function(){var t=!0;for(o=0;o<n.length;o++)n[o].complete||(t=!1);t&&e&&(e(),e=null)},500)},Ct.prototype._remove_notification_el=me.safewrap(function(){window.clearInterval(this._video_progress_checker),this.notification_el.style.visibility="hidden",this.body_el.removeChild(this.notification_el)}),Ct.prototype._set_client_config=function(){var e=function(e){var t=navigator.userAgent.match(e);return t&&t[1]};this.browser_versions={},this.browser_versions.chrome=e(/Chrome\/(\d+)/),this.browser_versions.firefox=e(/Firefox\/(\d+)/),this.browser_versions.ie=e(/MSIE (\d+).+/),!this.browser_versions.ie&&!window.ActiveXObject&&"ActiveXObject"in window&&(this.browser_versions.ie=11),this.body_el=document.body||document.getElementsByTagName("body")[0],this.body_el&&(this.doc_width=Math.max(this.body_el.scrollWidth,document.documentElement.scrollWidth,this.body_el.offsetWidth,document.documentElement.offsetWidth,this.body_el.clientWidth,document.documentElement.clientWidth),this.doc_height=Math.max(this.body_el.scrollHeight,document.documentElement.scrollHeight,this.body_el.offsetHeight,document.documentElement.offsetHeight,this.body_el.clientHeight,document.documentElement.clientHeight));var t=this.browser_versions.ie,r=document.createElement("div").style,n=function(e){if(e in r)return!0;if(!t){e=e[0].toUpperCase()+e.slice(1);for(var n=["O"+e,"Webkit"+e,"Moz"+e],i=0;i<n.length;i++)if(n[i]in r)return!0}return!1};this.use_transitions=this.body_el&&n("transition")&&n("transform"),this.flip_animate=(this.browser_versions.chrome>=33||this.browser_versions.firefox>=15)&&this.body_el&&n("backfaceVisibility")&&n("perspective")&&n("transform")},Ct.prototype._switch_to_video=me.safewrap(function(){var e=this,t=[{el:e._get_notification_display_el(),attr:"opacity",start:1,goal:0},{el:e._get_notification_display_el(),attr:"top",start:Ct.NOTIF_TOP,goal:-500},{el:e._get_el("video-noflip"),attr:"opacity",start:0,goal:1},{el:e._get_el("video-noflip"),attr:"top",start:2*-e.video_height,goal:0}];if(e.mini){var r=e._get_el("bg"),n=e._get_el("overlay");r.style.width="100%",r.style.height="100%",n.style.width="100%",e._add_class(e._get_notification_display_el(),"exiting"),e._add_class(r,"visible"),t.push({el:e._get_el("bg"),attr:"opacity",start:0,goal:Ct.BG_OPACITY})}var i=e._get_el("video-holder");i.innerHTML=e.video_iframe;var o=function(){window.YT&&window.YT.loaded&&e._yt_video_ready(),e.showing_video=!0,e._get_notification_display_el().style.visibility="hidden"};e.flip_animate?(e._add_class("flipper","flipped"),setTimeout(o,Ct.ANIM_TIME)):e._animate_els(t,Ct.ANIM_TIME,o)}),Ct.prototype._track_event=function(e,t,r){this.campaign_id?(t=t||{},t=me.extend(t,{campaign_id:this.campaign_id,message_id:this.message_id,message_type:"web_inapp",message_subtype:this.notif_type}),this.mixpanel.track(e,t,r)):r&&r.call()},Ct.prototype._yt_video_ready=me.safewrap(function(){var e=this;if(!e.video_inited){e.video_inited=!0;var t=e._get_el("video-elapsed"),r=e._get_el("video-time"),n=e._get_el("video-progress");new window.YT.Player(Ct.MARKUP_PREFIX+"-video-frame",{events:{onReady:function(i){var o=i.target,s=o.getDuration(),a=function(e){return("00"+e).slice(-2)},l=function(e){var t=Math.round(s-e),n=Math.floor(t/60),i=Math.floor(n/60);t-=60*n,n-=60*i,r.innerHTML="-"+(i?i+":":"")+a(n)+":"+a(t)};l(0),e._video_progress_checker=window.setInterval(function(){var e=o.getCurrentTime();t.style.width=e/s*100+"%",l(e)},250),me.register_event(n,"click",function(e){var t=Math.max(0,e.pageX-n.getBoundingClientRect().left);o.seekTo(s*t/n.clientWidth,!0)})}}})}});var jt=function(){};me.extend(jt.prototype,De),jt.prototype._init=function(e){this._mixpanel=e},jt.prototype.set=g(function(e,t,r){var n=this.set_action(e,t);return me.isObject(e)&&(r=t),this._get_config("save_referrer")&&this._mixpanel.persistence.update_referrer_info(document.referrer),n[Se]=me.extend({},me.info.people_properties(),this._mixpanel.persistence.get_referrer_info(),n[Se]),this._send_request(n,r)}),jt.prototype.set_once=g(function(e,t,r){var n=this.set_once_action(e,t);return me.isObject(e)&&(r=t),this._send_request(n,r)}),jt.prototype.unset=g(function(e,t){var r=this.unset_action(e);return this._send_request(r,t)}),jt.prototype.increment=g(function(e,t,r){var n={},i={};return me.isObject(e)?(me.each(e,function(e,t){if(!this._is_reserved_property(t)){if(isNaN(parseFloat(e)))return void ge.error("Invalid increment value passed to mixpanel.people.increment - must be a number");i[t]=e}},this),r=t):(me.isUndefined(t)&&(t=1),i[e]=t),n[Te]=i,this._send_request(n,r)}),jt.prototype.append=g(function(e,t,r){me.isObject(e)&&(r=t);var n=this.append_action(e,t);return this._send_request(n,r)}),jt.prototype.remove=g(function(e,t,r){me.isObject(e)&&(r=t);var n=this.remove_action(e,t);return this._send_request(n,r)}),jt.prototype.union=g(function(e,t,r){me.isObject(e)&&(r=t);var n=this.union_action(e,t);return this._send_request(n,r)}),jt.prototype.track_charge=g(function(e,t,r){return!me.isNumber(e)&&(e=parseFloat(e),isNaN(e))?void ge.error("Invalid value passed to mixpanel.people.track_charge - must be a number"):this.append("$transactions",me.extend({$amount:e},t),r)}),jt.prototype.clear_charges=function(e){return this.set("$transactions",[],e)},jt.prototype.delete_user=function(){if(!this._identify_called())return void ge.error("mixpanel.people.delete_user() requires you to call identify() first");var e={$delete:this._mixpanel.get_distinct_id()};return this._send_request(e)},jt.prototype.toString=function(){return this._mixpanel.toString()+".people"},jt.prototype._send_request=function(e,t){e.$token=this._get_config("token"),e.$distinct_id=this._mixpanel.get_distinct_id();var r=this._mixpanel.get_property("$device_id"),n=this._mixpanel.get_property("$user_id"),i=this._mixpanel.get_property("$had_persisted_distinct_id");
r&&(e.$device_id=r),n&&(e.$user_id=n),i&&(e.$had_persisted_distinct_id=i);var o=me.encodeDates(e),s=me.truncate(o,255),a=me.JSONEncode(o),l=me.base64Encode(a);return this._identify_called()?(ge.log("MIXPANEL PEOPLE REQUEST:"),ge.log(s),this._mixpanel._send_request(this._get_config("api_host")+"/engage/",{data:l},this._mixpanel._prepare_callback(t,s)),s):(this._enqueue(e),me.isUndefined(t)||t(this._get_config("verbose")?{status:-1,error:null}:-1),s)},jt.prototype._get_config=function(e){return this._mixpanel.get_config(e)},jt.prototype._identify_called=function(){return this._mixpanel._flags.identify_called===!0},jt.prototype._enqueue=function(e){Se in e?this._mixpanel.persistence._add_to_people_queue(Se,e):Ae in e?this._mixpanel.persistence._add_to_people_queue(Ae,e):Me in e?this._mixpanel.persistence._add_to_people_queue(Me,e):Te in e?this._mixpanel.persistence._add_to_people_queue(Te,e):Ce in e?this._mixpanel.persistence._add_to_people_queue(Ce,e):Pe in e?this._mixpanel.persistence._add_to_people_queue(Pe,e):je in e?this._mixpanel.persistence._add_to_people_queue(je,e):ge.error("Invalid call to _enqueue():",e)},jt.prototype._flush_one_queue=function(e,t,r,n){var i=this,o=me.extend({},this._mixpanel.persistence._get_queue(e)),s=o;me.isUndefined(o)||!me.isObject(o)||me.isEmptyObject(o)||(i._mixpanel.persistence._pop_from_people_queue(e,o),n&&(s=n(o)),t.call(i,s,function(t,n){0===t&&i._mixpanel.persistence._add_to_people_queue(e,o),me.isUndefined(r)||r(t,n)}))},jt.prototype._flush=function(e,t,r,n,i,o,s){var a=this,l=this._mixpanel.persistence._get_queue(Ce),c=this._mixpanel.persistence._get_queue(Pe);if(this._flush_one_queue(Se,this.set,e),this._flush_one_queue(Ae,this.set_once,n),this._flush_one_queue(Me,this.unset,o,function(e){return me.keys(e)}),this._flush_one_queue(Te,this.increment,t),this._flush_one_queue(je,this.union,i),!me.isUndefined(l)&&me.isArray(l)&&l.length){for(var u,d=function(e,t){0===e&&a._mixpanel.persistence._add_to_people_queue(Ce,u),me.isUndefined(r)||r(e,t)},h=l.length-1;h>=0;h--)u=l.pop(),me.isEmptyObject(u)||a.append(u,d);a._mixpanel.persistence.save()}if(!me.isUndefined(c)&&me.isArray(c)&&c.length){for(var f,p=function(e,t){0===e&&a._mixpanel.persistence._add_to_people_queue(Pe,f),me.isUndefined(s)||s(e,t)},m=c.length-1;m>=0;m--)f=c.pop(),me.isEmptyObject(f)||a.remove(f,p);a._mixpanel.persistence.save()}},jt.prototype._is_reserved_property=function(e){return"$distinct_id"===e||"$token"===e||"$device_id"===e||"$user_id"===e||"$had_persisted_distinct_id"===e},jt.prototype.set=jt.prototype.set,jt.prototype.set_once=jt.prototype.set_once,jt.prototype.unset=jt.prototype.unset,jt.prototype.increment=jt.prototype.increment,jt.prototype.append=jt.prototype.append,jt.prototype.remove=jt.prototype.remove,jt.prototype.union=jt.prototype.union,jt.prototype.track_charge=jt.prototype.track_charge,jt.prototype.clear_charges=jt.prototype.clear_charges,jt.prototype.delete_user=jt.prototype.delete_user,jt.prototype.toString=jt.prototype.toString;var Pt,Lt,Dt=0,It=1,Rt="mixpanel",Ot=Y.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,kt=!Ot&&-1===le.indexOf("MSIE")&&-1===le.indexOf("Mozilla"),Nt=ie.sendBeacon;Nt&&(Nt=me.bind(Nt,ie));var Ft={api_host:"https://api-js.mixpanel.com",api_method:"POST",api_transport:"XHR",app_host:"https://mixpanel.com",autotrack:!0,cdn:"https://cdn.mxpnl.com",cross_subdomain_cookie:!0,persistence:"cookie",persistence_name:"",cookie_name:"",loaded:function(){},store_google:!0,save_referrer:!0,test:!1,verbose:!1,img:!1,track_pageview:!0,debug:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_persistence:!1,disable_cookie:!1,secure_cookie:!1,ip:!0,opt_out_tracking_by_default:!1,opt_out_persistence_by_default:!1,opt_out_tracking_persistence_type:"localStorage",opt_out_tracking_cookie_prefix:null,property_blacklist:[],xhr_headers:{},inapp_protocol:"//",inapp_link_new_window:!1,ignore_dnt:!1},Vt=!1,Ut=function(){},Bt=function(e,t,r){var n,i=r===Rt?Lt:Lt[r];if(i&&Pt===Dt)n=i;else{if(i&&!me.isArray(i))return void ge.error("You have already initialized "+r);n=new Ut}if(n._cached_groups={},n._user_decide_check_complete=!1,n._events_tracked_before_user_decide_check_complete=[],n._init(e,t,r),n.people=new jt,n.people._init(n),K.DEBUG=K.DEBUG||n.get_config("debug"),n.__autotrack_enabled=n.get_config("autotrack"),n.get_config("autotrack")){var o=100,s=100;_e.enabledForProject(n.get_config("token"),o,s)?_e.isBrowserSupported()?_e.init(n):(n.__autotrack_enabled=!1,ge.log("Disabling Automatic Event Collection because this browser is not supported")):(n.__autotrack_enabled=!1,ge.log("Not in active bucket: disabling Automatic Event Collection."))}return!me.isUndefined(i)&&me.isArray(i)&&(n._execute_array.call(n.people,i.people),n._execute_array(i)),n};Ut.prototype.init=function(e,t,r){if(me.isUndefined(r))return void ge.error("You must name your new library: init(token, config, name)");if(r===Rt)return void ge.error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");var n=Bt(e,t,r);return Lt[r]=n,n._loaded(),n},Ut.prototype._init=function(e,t,r){this.__loaded=!0,this.config={},this._triggered_notifs=[],this.set_config(me.extend({},Ft,t,{name:r,token:e,callback_fn:(r===Rt?r:Rt+"."+r)+"._jsc"})),this._jsc=function(){},this.__dom_loaded_queue=[],this.__request_queue=[],this.__disabled_events=[],this._flags={disable_all_events:!1,identify_called:!1},this.persistence=this.cookie=new qe(this.config),this._gdpr_init();var n=me.UUID();this.get_distinct_id()||this.register_once({distinct_id:n,$device_id:n},"")},Ut.prototype._loaded=function(){this.get_config("loaded")(this),this.get_config("track_pageview")&&this.track_pageview()},Ut.prototype._dom_loaded=function(){me.each(this.__dom_loaded_queue,function(e){this._track_dom.apply(this,e)},this),this.has_opted_out_tracking()||me.each(this.__request_queue,function(e){this._send_request.apply(this,e)},this),delete this.__dom_loaded_queue,delete this.__request_queue},Ut.prototype._track_dom=function(e,t){if(this.get_config("img"))return ge.error("You can't use DOM tracking functions with img = true."),!1;if(!Vt)return this.__dom_loaded_queue.push([e,t]),!1;var r=(new e).init(this);return r.track.apply(r,t)},Ut.prototype._prepare_callback=function(e,t){if(me.isUndefined(e))return null;if(Ot){var r=function(r){e(r,t)};return r}var n=this._jsc,i=""+Math.floor(1e8*Math.random()),o=this.get_config("callback_fn")+"["+i+"]";return n[i]=function(r){delete n[i],e(r,t)},o},Ut.prototype._send_request=function(e,t,r,n){if(kt)return void this.__request_queue.push(arguments);var i={method:this.get_config("api_method"),transport:this.get_config("api_transport")},o=null;n||!me.isFunction(r)&&"string"!=typeof r||(n=r,r=null),r=me.extend(i,r||{}),Ot||(r.method="GET");var s="POST"===r.method,a=Nt&&s&&"sendbeacon"===r.transport.toLowerCase(),l=this.get_config("verbose");if(t.verbose&&(l=!0),this.get_config("test")&&(t.test=1),l&&(t.verbose=1),this.get_config("img")&&(t.img=1),Ot||(n?t.callback=n:(l||this.get_config("test"))&&(t.callback="(function(){})")),t.ip=this.get_config("ip")?1:0,t._=(new Date).getTime().toString(),s&&(o="data="+t.data,delete t.data),e+="?"+me.HTTPBuildQuery(t),"img"in t){var c=oe.createElement("img");c.src=e,oe.body.appendChild(c)}else if(a)try{Nt(e,o)}catch(u){ge.error(u)}else if(Ot)try{var d=new XMLHttpRequest;d.open(r.method,e,!0);var h=this.get_config("xhr_headers");s&&(h["Content-Type"]="application/x-www-form-urlencoded"),me.each(h,function(e,t){d.setRequestHeader(t,e)}),d.withCredentials=!0,d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status){if(n)if(l){var e;try{e=me.JSONDecode(d.responseText)}catch(t){return void ge.error(t)}n(e)}else n(Number(d.responseText))}else{var r="Bad HTTP status: "+d.status+" "+d.statusText;ge.error(r),n&&n(l?{status:0,error:r}:0)}},d.send(o)}catch(u){ge.error(u)}else{var f=oe.createElement("script");f.type="text/javascript",f.async=!0,f.defer=!0,f.src=e;var p=oe.getElementsByTagName("script")[0];p.parentNode.insertBefore(f,p)}},Ut.prototype._execute_array=function(e){var t,r=[],n=[],i=[];me.each(e,function(e){e&&(t=e[0],me.isArray(t)?i.push(e):"function"==typeof e?e.call(this):me.isArray(e)&&"alias"===t?r.push(e):me.isArray(e)&&-1!==t.indexOf("track")&&"function"==typeof this[t]?i.push(e):n.push(e))},this);var o=function(e,t){me.each(e,function(e){if(me.isArray(e[0])){var r=t;me.each(e,function(e){r=r[e[0]].apply(r,e.slice(1))})}else this[e[0]].apply(this,e.slice(1))},t)};o(r,this),o(n,this),o(i,this)},Ut.prototype.push=function(e){this._execute_array([e])},Ut.prototype.disable=function(e){"undefined"==typeof e?this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(e)},Ut.prototype.track=m(function(e,t,r,n){n||"function"!=typeof r||(n=r,r=null),r=r||{};var i=r.transport;if(i&&(r.transport=i),"function"!=typeof n&&(n=function(){}),me.isUndefined(e))return void ge.error("No event name provided to mixpanel.track");if(this._event_is_disabled(e))return void n(0);t=t||{},t.token=this.get_config("token");var o=this.persistence.remove_event_timer(e);if(!me.isUndefined(o)){var s=(new Date).getTime()-o;t.$duration=parseFloat((s/1e3).toFixed(3))}this.persistence.update_search_keyword(oe.referrer),this.get_config("store_google")&&this.persistence.update_campaign_params(),this.get_config("save_referrer")&&this.persistence.update_referrer_info(oe.referrer),t=me.extend({},me.info.properties(),this.persistence.properties(),t);var a=this.get_config("property_blacklist");me.isArray(a)?me.each(a,function(e){delete t[e]}):ge.error("Invalid value for property_blacklist config: "+a);var l={event:e,properties:t},c=me.truncate(l,255),u=me.JSONEncode(c),d=me.base64Encode(u);return ge.log("MIXPANEL REQUEST:"),ge.log(c),this._send_request(this.get_config("api_host")+"/track/",{data:d},r,this._prepare_callback(n,c)),this._check_and_handle_triggered_notifications(l),c}),Ut.prototype.set_group=m(function(e,t,r){me.isArray(t)||(t=[t]);var n={};return n[e]=t,this.register(n),this.people.set(e,t,r)}),Ut.prototype.add_group=m(function(e,t,r){var n=this.get_property(e);if(void 0===n){var i={};i[e]=[t],this.register(i)}else-1===n.indexOf(t)&&(n.push(t),this.register(i));return this.people.union(e,t,r)}),Ut.prototype.remove_group=m(function(e,t,r){var n=this.get_property(e);if(void 0!==n){var i=n.indexOf(t);i>-1&&(n.splice(i,1),this.register({group_key:n})),0===n.length&&this.unregister(e)}return this.people.remove(e,t,r)}),Ut.prototype.track_with_groups=m(function(e,t,r,n){var i=me.extend({},t||{});return me.each(r,function(e,t){null!==e&&void 0!==e&&(i[t]=e)}),this.track(e,i,n)}),Ut.prototype._create_map_key=function(e,t){return e+"_"+JSON.stringify(t)},Ut.prototype._remove_group_from_cache=function(e,t){delete this._cached_groups[this._create_map_key(e,t)]},Ut.prototype.get_group=function(e,t){var r=this._create_map_key(e,t),n=this._cached_groups[r];return(void 0===n||n._group_key!==e||n._group_id!==t)&&(n=new Ie,n._init(this,e,t),this._cached_groups[r]=n),n},Ut.prototype.track_pageview=function(e){me.isUndefined(e)&&(e=oe.location.href),this.track("mp_page_view",me.info.pageviewInfo(e))},Ut.prototype.track_links=function(){return this._track_dom.call(this,xe,arguments)},Ut.prototype.track_forms=function(){return this._track_dom.call(this,we,arguments)},Ut.prototype.time_event=function(e){return me.isUndefined(e)?void ge.error("No event name provided to mixpanel.time_event"):void(this._event_is_disabled(e)||this.persistence.set_event_timer(e,(new Date).getTime()))},Ut.prototype.register=function(e,t){this.persistence.register(e,t)},Ut.prototype.register_once=function(e,t,r){this.persistence.register_once(e,t,r)},Ut.prototype.unregister=function(e){this.persistence.unregister(e)},Ut.prototype._register_single=function(e,t){var r={};r[e]=t,this.register(r)},Ut.prototype.identify=function(e,t,r,n,i,o,s,a){var l=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var c=l;this.register_once({$had_persisted_distinct_id:!0,$device_id:c},"")}e!==l&&e!==this.get_property(ze)&&(this.unregister(ze),this.register({distinct_id:e})),this._check_and_handle_notifications(this.get_distinct_id()),this._flags.identify_called=!0,this.people._flush(t,r,n,i,o,s,a),e!==l&&this.track("$identify",{distinct_id:e,$anon_distinct_id:l})},Ut.prototype.reset=function(){this.persistence.clear(),this._flags.identify_called=!1;var e=me.UUID();this.register_once({distinct_id:e,$device_id:e},"")},Ut.prototype.get_distinct_id=function(){return this.get_property("distinct_id")},Ut.prototype.alias=function(e,t){if(e===this.get_property(Be))return ge.critical("Attempting to create alias for existing People user - aborting."),-2;var r=this;return me.isUndefined(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(ze,e),this.track("$create_alias",{alias:e,distinct_id:t},function(){r.identify(e)})):(ge.error("alias matches current distinct_id - skipping api call."),this.identify(e),-1)},Ut.prototype.name_tag=function(e){this._register_single("mp_name_tag",e)},Ut.prototype.set_config=function(e){me.isObject(e)&&(me.extend(this.config,e),this.get_config("persistence_name")||(this.config.persistence_name=this.config.cookie_name),this.get_config("disable_persistence")||(this.config.disable_persistence=this.config.disable_cookie),this.persistence&&this.persistence.update_config(this.config),K.DEBUG=K.DEBUG||this.get_config("debug"))},Ut.prototype.get_config=function(e){return this.config[e]},Ut.prototype.get_property=function(e){return this.persistence.props[e]},Ut.prototype.toString=function(){var e=this.get_config("name");return e!==Rt&&(e=Rt+"."+e),e},Ut.prototype._event_is_disabled=function(e){return me.isBlockedUA(le)||this._flags.disable_all_events||me.include(this.__disabled_events,e)},Ut.prototype._check_and_handle_triggered_notifications=m(function(e){if(this._user_decide_check_complete)for(var t=this._triggered_notifs,r=0;r<t.length;r++){var n=new Ct(t[r],this);if(n._matches_event_data(e))return void this._show_notification(t[r])}else this._events_tracked_before_user_decide_check_complete.push(e)}),Ut.prototype._check_and_handle_notifications=m(function(e){if(e&&!this._flags.identify_called&&!this.get_config("disable_notifications")){ge.log("MIXPANEL NOTIFICATION CHECK");var t={verbose:!0,version:"3",lib:"web",token:this.get_config("token"),distinct_id:e};this._send_request(this.get_config("api_host")+"/decide/",t,{method:"GET",transport:"XHR"},this._prepare_callback(me.bind(function(e){if(e.notifications&&e.notifications.length>0){this._triggered_notifs=[];var t=[];me.each(e.notifications,function(e){(e.display_triggers&&e.display_triggers.length>0?this._triggered_notifs:t).push(e)},this),t.length>0&&this._show_notification.call(this,t[0])}this._handle_user_decide_check_complete()},this)))}}),Ut.prototype._handle_user_decide_check_complete=function(){this._user_decide_check_complete=!0;for(var e=this._events_tracked_before_user_decide_check_complete;e.length>0;){var t=e.shift();this._check_and_handle_triggered_notifications(t)}},Ut.prototype._show_notification=function(e){var t=new Ct(e,this);t.show()},Ut.prototype._gdpr_init=function(){var e="localStorage"===this.get_config("opt_out_tracking_persistence_type");e&&me.localStorage.is_supported()&&(!this.has_opted_in_tracking()&&this.has_opted_in_tracking({persistence_type:"cookie"})&&this.opt_in_tracking({enable_persistence:!1}),!this.has_opted_out_tracking()&&this.has_opted_out_tracking({persistence_type:"cookie"})&&this.opt_out_tracking({clear_persistence:!1}),this.clear_opt_in_out_tracking({persistence_type:"cookie",enable_persistence:!1})),this.has_opted_out_tracking()?this._gdpr_update_persistence({clear_persistence:!0}):this.has_opted_in_tracking()||!this.get_config("opt_out_tracking_by_default")&&!me.cookie.get("mp_optout")||(me.cookie.remove("mp_optout"),this.opt_out_tracking({clear_persistence:this.get_config("opt_out_persistence_by_default")}))},Ut.prototype._gdpr_update_persistence=function(e){var t;if(e&&e.clear_persistence)t=!0;else{if(!e||!e.enable_persistence)return;t=!1}this.get_config("disable_persistence")||this.persistence.disabled===t||this.persistence.set_disabled(t)},Ut.prototype._gdpr_call_func=function(e,t){return t=me.extend({track:me.bind(this.track,this),persistence_type:this.get_config("opt_out_tracking_persistence_type"),cookie_prefix:this.get_config("opt_out_tracking_cookie_prefix"),cookie_expiration:this.get_config("cookie_expiration"),cross_subdomain_cookie:this.get_config("cross_subdomain_cookie"),secure_cookie:this.get_config("secure_cookie"),ignore_dnt:this.get_config("ignore_dnt")},t),me.localStorage.is_supported()||(t.persistence_type="cookie"),e(this.get_config("token"),{track:t.track,trackEventName:t.track_event_name,trackProperties:t.track_properties,persistenceType:t.persistence_type,persistencePrefix:t.cookie_prefix,cookieExpiration:t.cookie_expiration,crossSubdomainCookie:t.cross_subdomain_cookie,secureCookie:t.secure_cookie,ignoreDnt:t.ignore_dnt})},Ut.prototype.opt_in_tracking=function(e){e=me.extend({enable_persistence:!0},e),this._gdpr_call_func(d,e),this._gdpr_update_persistence(e)},Ut.prototype.opt_out_tracking=function(e){e=me.extend({clear_persistence:!0,delete_user:!0},e),e.delete_user&&this.people&&this.people._identify_called()&&(this.people.delete_user(),this.people.clear_charges()),this._gdpr_call_func(h,e),this._gdpr_update_persistence(e)},Ut.prototype.has_opted_in_tracking=function(e){return this._gdpr_call_func(f,e)},Ut.prototype.has_opted_out_tracking=function(e){return this._gdpr_call_func(p,e)},Ut.prototype.clear_opt_in_out_tracking=function(e){e=me.extend({enable_persistence:!0},e),this._gdpr_call_func(y,e),this._gdpr_update_persistence(e)},Ut.prototype.init=Ut.prototype.init,Ut.prototype.reset=Ut.prototype.reset,Ut.prototype.disable=Ut.prototype.disable,Ut.prototype.time_event=Ut.prototype.time_event,Ut.prototype.track=Ut.prototype.track,Ut.prototype.track_links=Ut.prototype.track_links,Ut.prototype.track_forms=Ut.prototype.track_forms,Ut.prototype.track_pageview=Ut.prototype.track_pageview,Ut.prototype.register=Ut.prototype.register,Ut.prototype.register_once=Ut.prototype.register_once,Ut.prototype.unregister=Ut.prototype.unregister,Ut.prototype.identify=Ut.prototype.identify,Ut.prototype.alias=Ut.prototype.alias,Ut.prototype.name_tag=Ut.prototype.name_tag,Ut.prototype.set_config=Ut.prototype.set_config,Ut.prototype.get_config=Ut.prototype.get_config,Ut.prototype.get_property=Ut.prototype.get_property,Ut.prototype.get_distinct_id=Ut.prototype.get_distinct_id,Ut.prototype.toString=Ut.prototype.toString,Ut.prototype._check_and_handle_notifications=Ut.prototype._check_and_handle_notifications,Ut.prototype._handle_user_decide_check_complete=Ut.prototype._handle_user_decide_check_complete,Ut.prototype._show_notification=Ut.prototype._show_notification,Ut.prototype.opt_out_tracking=Ut.prototype.opt_out_tracking,Ut.prototype.opt_in_tracking=Ut.prototype.opt_in_tracking,Ut.prototype.has_opted_out_tracking=Ut.prototype.has_opted_out_tracking,Ut.prototype.has_opted_in_tracking=Ut.prototype.has_opted_in_tracking,Ut.prototype.clear_opt_in_out_tracking=Ut.prototype.clear_opt_in_out_tracking,Ut.prototype.get_group=Ut.prototype.get_group,Ut.prototype.set_group=Ut.prototype.set_group,Ut.prototype.add_group=Ut.prototype.add_group,Ut.prototype.remove_group=Ut.prototype.remove_group,Ut.prototype.track_with_groups=Ut.prototype.track_with_groups,qe.prototype.properties=qe.prototype.properties,qe.prototype.update_search_keyword=qe.prototype.update_search_keyword,qe.prototype.update_referrer_info=qe.prototype.update_referrer_info,qe.prototype.get_cross_subdomain=qe.prototype.get_cross_subdomain,qe.prototype.clear=qe.prototype.clear,me.safewrap_class(Ut,["identify","_check_and_handle_notifications","_show_notification"]);var zt={},Gt=function(){me.each(zt,function(e,t){t!==Rt&&(Lt[t]=e)}),Lt._=me},Ht=function(){Lt.init=function(e,t,r){if(r)return Lt[r]||(Lt[r]=zt[r]=Bt(e,t,r),Lt[r]._loaded()),Lt[r];var n=Lt;zt[Rt]?n=zt[Rt]:e&&(n=Bt(e,t,Rt),n._loaded(),zt[Rt]=n),Lt=n,Pt===It&&(Y[Rt]=Lt),Gt()}},Wt=function(){function e(){e.done||(e.done=!0,Vt=!0,kt=!1,me.each(zt,function(e){e._dom_loaded()}))}function t(){try{oe.documentElement.doScroll("left")}catch(r){return void setTimeout(t,1)}e()}if(oe.addEventListener)"complete"===oe.readyState?e():oe.addEventListener("DOMContentLoaded",e,!1);else if(oe.attachEvent){oe.attachEvent("onreadystatechange",e);var r=!1;try{r=null===Y.frameElement}catch(n){}oe.documentElement.doScroll&&r&&t()}me.register_event(Y,"load",e,!0)},qt=X();e.exports=qt},"./node_modules/node-libs-browser/mock/empty.js":function(e,t){},"./node_modules/pako/index.js":function(e,t,r){"use strict";var n=r("./node_modules/pako/lib/utils/common.js").assign,i=r("./node_modules/pako/lib/deflate.js"),o=r("./node_modules/pako/lib/inflate.js"),s=r("./node_modules/pako/lib/zlib/constants.js"),a={};n(a,i,o,s),e.exports=a},"./node_modules/pako/lib/deflate.js":function(e,t,r){"use strict";function n(e){if(!(this instanceof n))return new n(e);this.options=l.assign({level:y,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:_,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var r=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==m)throw new Error(u[r]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){var i;if(i="string"==typeof t.dictionary?c.string2buf(t.dictionary):"[object ArrayBuffer]"===h.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=a.deflateSetDictionary(this.strm,i),r!==m)throw new Error(u[r]);this._dict_set=!0}}function i(e,t){var r=new n(t);if(r.push(e,!0),r.err)throw r.msg||u[r.err];return r.result}function o(e,t){return t=t||{},t.raw=!0,i(e,t)}function s(e,t){return t=t||{},t.gzip=!0,i(e,t)}var a=r("./node_modules/pako/lib/zlib/deflate.js"),l=r("./node_modules/pako/lib/utils/common.js"),c=r("./node_modules/pako/lib/utils/strings.js"),u=r("./node_modules/pako/lib/zlib/messages.js"),d=r("./node_modules/pako/lib/zlib/zstream.js"),h=Object.prototype.toString,f=0,p=4,m=0,g=1,v=2,y=-1,_=0,b=8;n.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:t===!0?p:f,"string"==typeof e?i.input=c.string2buf(e):"[object ArrayBuffer]"===h.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new l.Buf8(o),i.next_out=0,i.avail_out=o),r=a.deflate(i,n),r!==g&&r!==m)return this.onEnd(r),this.ended=!0,!1;(0===i.avail_out||0===i.avail_in&&(n===p||n===v))&&("string"===this.options.to?this.onData(c.buf2binstring(l.shrinkBuf(i.output,i.next_out))):this.onData(l.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&r!==g);return n===p?(r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===m):n===v?(this.onEnd(m),i.avail_out=0,!0):!0},n.prototype.onData=function(e){this.chunks.push(e)},n.prototype.onEnd=function(e){e===m&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=n,t.deflate=i,t.deflateRaw=o,t.gzip=s},"./node_modules/pako/lib/inflate.js":function(e,t,r){"use strict";function n(e){if(!(this instanceof n))return new n(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var r=s.inflateInit2(this.strm,t.windowBits);if(r!==c.Z_OK)throw new Error(u[r]);if(this.header=new h,s.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=l.string2buf(t.dictionary):"[object ArrayBuffer]"===f.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=s.inflateSetDictionary(this.strm,t.dictionary),r!==c.Z_OK)))throw new Error(u[r])}function i(e,t){var r=new n(t);if(r.push(e,!0),r.err)throw r.msg||u[r.err];return r.result}function o(e,t){return t=t||{},t.raw=!0,i(e,t)}var s=r("./node_modules/pako/lib/zlib/inflate.js"),a=r("./node_modules/pako/lib/utils/common.js"),l=r("./node_modules/pako/lib/utils/strings.js"),c=r("./node_modules/pako/lib/zlib/constants.js"),u=r("./node_modules/pako/lib/zlib/messages.js"),d=r("./node_modules/pako/lib/zlib/zstream.js"),h=r("./node_modules/pako/lib/zlib/gzheader.js"),f=Object.prototype.toString;n.prototype.push=function(e,t){var r,n,i,o,u,d=this.strm,h=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;n=t===~~t?t:t===!0?c.Z_FINISH:c.Z_NO_FLUSH,"string"==typeof e?d.input=l.binstring2buf(e):"[object ArrayBuffer]"===f.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new a.Buf8(h),d.next_out=0,d.avail_out=h),r=s.inflate(d,c.Z_NO_FLUSH),r===c.Z_NEED_DICT&&p&&(r=s.inflateSetDictionary(this.strm,p)),r===c.Z_BUF_ERROR&&m===!0&&(r=c.Z_OK,m=!1),r!==c.Z_STREAM_END&&r!==c.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0===d.avail_out||r===c.Z_STREAM_END||0===d.avail_in&&(n===c.Z_FINISH||n===c.Z_SYNC_FLUSH))&&("string"===this.options.to?(i=l.utf8border(d.output,d.next_out),o=d.next_out-i,u=l.buf2string(d.output,i),d.next_out=o,d.avail_out=h-o,o&&a.arraySet(d.output,d.output,i,o,0),this.onData(u)):this.onData(a.shrinkBuf(d.output,d.next_out))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&r!==c.Z_STREAM_END);return r===c.Z_STREAM_END&&(n=c.Z_FINISH),n===c.Z_FINISH?(r=s.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c.Z_OK):n===c.Z_SYNC_FLUSH?(this.onEnd(c.Z_OK),d.avail_out=0,!0):!0},n.prototype.onData=function(e){this.chunks.push(e)},n.prototype.onEnd=function(e){e===c.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=n,t.inflate=i,t.inflateRaw=o,t.ungzip=i},"./node_modules/pako/lib/utils/common.js":function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)n(r,i)&&(e[i]=r[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)return void e.set(t.subarray(r,r+n),i);for(var o=0;n>o;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,s;for(n=0,t=0,r=e.length;r>t;t++)n+=e[t].length;for(s=new Uint8Array(n),i=0,t=0,r=e.length;r>t;t++)o=e[t],s.set(o,i),i+=o.length;return s}},s={arraySet:function(e,t,r,n,i){for(var o=0;n>o;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(i)},"./node_modules/pako/lib/utils/strings.js":function(e,t,r){"use strict";function n(e,t){if(65534>t&&(e.subarray&&s||!e.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var r="",n=0;t>n;n++)r+=String.fromCharCode(e[n]);return r}var i=r("./node_modules/pako/lib/utils/common.js"),o=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(a){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){s=!1}for(var l=new i.Buf8(256),c=0;256>c;c++)l[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;l[254]=l[254]=1,t.string2buf=function(e){var t,r,n,o,s,a=e.length,l=0;for(o=0;a>o;o++)r=e.charCodeAt(o),55296===(64512&r)&&a>o+1&&(n=e.charCodeAt(o+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),o++)),l+=128>r?1:2048>r?2:65536>r?3:4;for(t=new i.Buf8(l),s=0,o=0;l>s;o++)r=e.charCodeAt(o),55296===(64512&r)&&a>o+1&&(n=e.charCodeAt(o+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),o++)),128>r?t[s++]=r:2048>r?(t[s++]=192|r>>>6,t[s++]=128|63&r):65536>r?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|63&r):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|63&r);return t},t.buf2binstring=function(e){return n(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),r=0,n=t.length;n>r;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,i,o,s,a=t||e.length,c=new Array(2*a);for(i=0,r=0;a>r;)if(o=e[r++],128>o)c[i++]=o;else if(s=l[o],s>4)c[i++]=65533,r+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&a>r;)o=o<<6|63&e[r++],s--;s>1?c[i++]=65533:65536>o?c[i++]=o:(o-=65536,c[i++]=55296|o>>10&1023,c[i++]=56320|1023&o)}return n(c,i)},t.utf8border=function(e,t){var r;for(t=t||e.length,t>e.length&&(t=e.length),r=t-1;r>=0&&128===(192&e[r]);)r--;return 0>r?t:0===r?t:r+l[e[r]]>t?r:t}},"./node_modules/pako/lib/zlib/adler32.js":function(e,t,r){"use strict";function n(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,s=0;0!==r;){s=r>2e3?2e3:r,r-=s;do i=i+t[n++]|0,o=o+i|0;while(--s);i%=65521,o%=65521}return i|o<<16|0}e.exports=n},"./node_modules/pako/lib/zlib/constants.js":function(e,t,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"./node_modules/pako/lib/zlib/crc32.js":function(e,t,r){"use strict";function n(){for(var e,t=[],r=0;256>r;r++){e=r;for(var n=0;8>n;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}function i(e,t,r,n){var i=o,s=n+r;e^=-1;for(var a=n;s>a;a++)e=e>>>8^i[255&(e^t[a])];return-1^e}var o=n();e.exports=i},"./node_modules/pako/lib/zlib/deflate.js":function(e,t,r){"use strict";function n(e,t){return e.msg=R[t],t}function i(e){return(e<<1)-(e>4?9:0)}function o(e){for(var t=e.length;--t>=0;)e[t]=0}function s(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(P.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function a(e,t){L._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,s(e.strm)}function l(e,t){e.pending_buf[e.pending++]=t}function c(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function u(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,P.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=D(e.adler,t,i,r):2===e.state.wrap&&(e.adler=I(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function d(e,t){var r,n,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-de?e.strstart-(e.w_size-de):0,c=e.window,u=e.w_mask,d=e.prev,h=e.strstart+ue,f=c[o+s-1],p=c[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do if(r=t,c[r+s]===p&&c[r+s-1]===f&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do;while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&h>o);if(n=ue-(h-o),o=h-ue,n>s){if(e.match_start=t,s=n,n>=a)break;f=c[o+s-1],p=c[o+s]}}while((t=d[t&u])>l&&0!==--i);return s<=e.lookahead?s:e.lookahead}function h(e){var t,r,n,i,o,s=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,
e.strstart>=s+(s-de)){P.arraySet(e.window,e.window,s,s,0),e.match_start-=s,e.strstart-=s,e.block_start-=s,r=e.hash_size,t=r;do n=e.head[--t],e.head[t]=n>=s?n-s:0;while(--r);r=s,t=r;do n=e.prev[--t],e.prev[t]=n>=s?n-s:0;while(--r);i+=s}if(0===e.strm.avail_in)break;if(r=u(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=ce)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+ce-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<ce)););}while(e.lookahead<de&&0!==e.strm.avail_in)}function f(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(h(e),0===e.lookahead&&t===O)return be;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,a(e,!1),0===e.strm.avail_out))return be;if(e.strstart-e.block_start>=e.w_size-de&&(a(e,!1),0===e.strm.avail_out))return be}return e.insert=0,t===F?(a(e,!0),0===e.strm.avail_out?we:Ee):e.strstart>e.block_start&&(a(e,!1),0===e.strm.avail_out)?be:be}function p(e,t){for(var r,n;;){if(e.lookahead<de){if(h(e),e.lookahead<de&&t===O)return be;if(0===e.lookahead)break}if(r=0,e.lookahead>=ce&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ce-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-de&&(e.match_length=d(e,r)),e.match_length>=ce)if(n=L._tr_tally(e,e.strstart-e.match_start,e.match_length-ce),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ce){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ce-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=L._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(a(e,!1),0===e.strm.avail_out))return be}return e.insert=e.strstart<ce-1?e.strstart:ce-1,t===F?(a(e,!0),0===e.strm.avail_out?we:Ee):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?be:xe}function m(e,t){for(var r,n,i;;){if(e.lookahead<de){if(h(e),e.lookahead<de&&t===O)return be;if(0===e.lookahead)break}if(r=0,e.lookahead>=ce&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ce-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ce-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-de&&(e.match_length=d(e,r),e.match_length<=5&&(e.strategy===q||e.match_length===ce&&e.strstart-e.match_start>4096)&&(e.match_length=ce-1)),e.prev_length>=ce&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-ce,n=L._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-ce),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ce-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!==--e.prev_length);if(e.match_available=0,e.match_length=ce-1,e.strstart++,n&&(a(e,!1),0===e.strm.avail_out))return be}else if(e.match_available){if(n=L._tr_tally(e,0,e.window[e.strstart-1]),n&&a(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return be}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=L._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ce-1?e.strstart:ce-1,t===F?(a(e,!0),0===e.strm.avail_out?we:Ee):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?be:xe}function g(e,t){for(var r,n,i,o,s=e.window;;){if(e.lookahead<=ue){if(h(e),e.lookahead<=ue&&t===O)return be;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=ce&&e.strstart>0&&(i=e.strstart-1,n=s[i],n===s[++i]&&n===s[++i]&&n===s[++i])){o=e.strstart+ue;do;while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&o>i);e.match_length=ue-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ce?(r=L._tr_tally(e,1,e.match_length-ce),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=L._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(a(e,!1),0===e.strm.avail_out))return be}return e.insert=0,t===F?(a(e,!0),0===e.strm.avail_out?we:Ee):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?be:xe}function v(e,t){for(var r;;){if(0===e.lookahead&&(h(e),0===e.lookahead)){if(t===O)return be;break}if(e.match_length=0,r=L._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(a(e,!1),0===e.strm.avail_out))return be}return e.insert=0,t===F?(a(e,!0),0===e.strm.avail_out?we:Ee):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?be:xe}function y(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function _(e){e.window_size=2*e.w_size,o(e.head),e.max_lazy_match=j[e.level].max_lazy,e.good_match=j[e.level].good_length,e.nice_match=j[e.level].nice_length,e.max_chain_length=j[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ce-1,e.match_available=0,e.ins_h=0}function b(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=J,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new P.Buf16(2*ae),this.dyn_dtree=new P.Buf16(2*(2*oe+1)),this.bl_tree=new P.Buf16(2*(2*se+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new P.Buf16(le+1),this.heap=new P.Buf16(2*ie+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new P.Buf16(2*ie+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function x(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=Z,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?fe:ye,e.adler=2===t.wrap?0:1,t.last_flush=O,L._tr_init(t),U):n(e,z)}function w(e){var t=x(e);return t===U&&_(e.state),t}function E(e,t){return e&&e.state?2!==e.state.wrap?z:(e.state.gzhead=t,U):z}function S(e,t,r,i,o,s){if(!e)return z;var a=1;if(t===W&&(t=6),0>i?(a=0,i=-i):i>15&&(a=2,i-=16),1>o||o>$||r!==J||8>i||i>15||0>t||t>9||0>s||s>K)return n(e,z);8===i&&(i=9);var l=new b;return e.state=l,l.strm=e,l.wrap=a,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+ce-1)/ce),l.window=new P.Buf8(2*l.w_size),l.head=new P.Buf16(l.hash_size),l.prev=new P.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new P.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=s,l.method=r,w(e)}function A(e,t){return S(e,t,J,ee,te,Q)}function M(e,t){var r,a,u,d;if(!e||!e.state||t>V||0>t)return e?n(e,z):z;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||a.status===_e&&t!==F)return n(e,0===e.avail_out?H:z);if(a.strm=e,r=a.last_flush,a.last_flush=t,a.status===fe)if(2===a.wrap)e.adler=0,l(a,31),l(a,139),l(a,8),a.gzhead?(l(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),l(a,255&a.gzhead.time),l(a,a.gzhead.time>>8&255),l(a,a.gzhead.time>>16&255),l(a,a.gzhead.time>>24&255),l(a,9===a.level?2:a.strategy>=X||a.level<2?4:0),l(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(l(a,255&a.gzhead.extra.length),l(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=I(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=pe):(l(a,0),l(a,0),l(a,0),l(a,0),l(a,0),l(a,9===a.level?2:a.strategy>=X||a.level<2?4:0),l(a,Se),a.status=ye);else{var h=J+(a.w_bits-8<<4)<<8,f=-1;f=a.strategy>=X||a.level<2?0:a.level<6?1:6===a.level?2:3,h|=f<<6,0!==a.strstart&&(h|=he),h+=31-h%31,a.status=ye,c(a,h),0!==a.strstart&&(c(a,e.adler>>>16),c(a,65535&e.adler)),e.adler=1}if(a.status===pe)if(a.gzhead.extra){for(u=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>u&&(e.adler=I(e.adler,a.pending_buf,a.pending-u,u)),s(e),u=a.pending,a.pending!==a.pending_buf_size));)l(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>u&&(e.adler=I(e.adler,a.pending_buf,a.pending-u,u)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=me)}else a.status=me;if(a.status===me)if(a.gzhead.name){u=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>u&&(e.adler=I(e.adler,a.pending_buf,a.pending-u,u)),s(e),u=a.pending,a.pending===a.pending_buf_size)){d=1;break}d=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,l(a,d)}while(0!==d);a.gzhead.hcrc&&a.pending>u&&(e.adler=I(e.adler,a.pending_buf,a.pending-u,u)),0===d&&(a.gzindex=0,a.status=ge)}else a.status=ge;if(a.status===ge)if(a.gzhead.comment){u=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>u&&(e.adler=I(e.adler,a.pending_buf,a.pending-u,u)),s(e),u=a.pending,a.pending===a.pending_buf_size)){d=1;break}d=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,l(a,d)}while(0!==d);a.gzhead.hcrc&&a.pending>u&&(e.adler=I(e.adler,a.pending_buf,a.pending-u,u)),0===d&&(a.status=ve)}else a.status=ve;if(a.status===ve&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&s(e),a.pending+2<=a.pending_buf_size&&(l(a,255&e.adler),l(a,e.adler>>8&255),e.adler=0,a.status=ye)):a.status=ye),0!==a.pending){if(s(e),0===e.avail_out)return a.last_flush=-1,U}else if(0===e.avail_in&&i(t)<=i(r)&&t!==F)return n(e,H);if(a.status===_e&&0!==e.avail_in)return n(e,H);if(0!==e.avail_in||0!==a.lookahead||t!==O&&a.status!==_e){var p=a.strategy===X?v(a,t):a.strategy===Y?g(a,t):j[a.level].func(a,t);if((p===we||p===Ee)&&(a.status=_e),p===be||p===we)return 0===e.avail_out&&(a.last_flush=-1),U;if(p===xe&&(t===k?L._tr_align(a):t!==V&&(L._tr_stored_block(a,0,0,!1),t===N&&(o(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),s(e),0===e.avail_out))return a.last_flush=-1,U}return t!==F?U:a.wrap<=0?B:(2===a.wrap?(l(a,255&e.adler),l(a,e.adler>>8&255),l(a,e.adler>>16&255),l(a,e.adler>>24&255),l(a,255&e.total_in),l(a,e.total_in>>8&255),l(a,e.total_in>>16&255),l(a,e.total_in>>24&255)):(c(a,e.adler>>>16),c(a,65535&e.adler)),s(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?U:B)}function T(e){var t;return e&&e.state?(t=e.state.status,t!==fe&&t!==pe&&t!==me&&t!==ge&&t!==ve&&t!==ye&&t!==_e?n(e,z):(e.state=null,t===ye?n(e,G):U)):z}function C(e,t){var r,n,i,s,a,l,c,u,d=t.length;if(!e||!e.state)return z;if(r=e.state,s=r.wrap,2===s||1===s&&r.status!==fe||r.lookahead)return z;for(1===s&&(e.adler=D(e.adler,t,d,0)),r.wrap=0,d>=r.w_size&&(0===s&&(o(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new P.Buf8(r.w_size),P.arraySet(u,t,d-r.w_size,r.w_size,0),t=u,d=r.w_size),a=e.avail_in,l=e.next_in,c=e.input,e.avail_in=d,e.next_in=0,e.input=t,h(r);r.lookahead>=ce;){n=r.strstart,i=r.lookahead-(ce-1);do r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+ce-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++;while(--i);r.strstart=n,r.lookahead=ce-1,h(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=ce-1,r.match_available=0,e.next_in=l,e.input=c,e.avail_in=a,r.wrap=s,U}var j,P=r("./node_modules/pako/lib/utils/common.js"),L=r("./node_modules/pako/lib/zlib/trees.js"),D=r("./node_modules/pako/lib/zlib/adler32.js"),I=r("./node_modules/pako/lib/zlib/crc32.js"),R=r("./node_modules/pako/lib/zlib/messages.js"),O=0,k=1,N=3,F=4,V=5,U=0,B=1,z=-2,G=-3,H=-5,W=-1,q=1,X=2,Y=3,K=4,Q=0,Z=2,J=8,$=9,ee=15,te=8,re=29,ne=256,ie=ne+1+re,oe=30,se=19,ae=2*ie+1,le=15,ce=3,ue=258,de=ue+ce+1,he=32,fe=42,pe=69,me=73,ge=91,ve=103,ye=113,_e=666,be=1,xe=2,we=3,Ee=4,Se=3;j=[new y(0,0,0,0,f),new y(4,4,8,4,p),new y(4,5,16,8,p),new y(4,6,32,32,p),new y(4,4,16,16,m),new y(8,16,32,32,m),new y(8,16,128,128,m),new y(8,32,128,256,m),new y(32,128,258,1024,m),new y(32,258,258,4096,m)],t.deflateInit=A,t.deflateInit2=S,t.deflateReset=w,t.deflateResetKeep=x,t.deflateSetHeader=E,t.deflate=M,t.deflateEnd=T,t.deflateSetDictionary=C,t.deflateInfo="pako deflate (from Nodeca project)"},"./node_modules/pako/lib/zlib/gzheader.js":function(e,t,r){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=n},"./node_modules/pako/lib/zlib/inffast.js":function(e,t,r){"use strict";var n=30,i=12;e.exports=function(e,t){var r,o,s,a,l,c,u,d,h,f,p,m,g,v,y,_,b,x,w,E,S,A,M,T,C;r=e.state,o=e.next_in,T=e.input,s=o+(e.avail_in-5),a=e.next_out,C=e.output,l=a-(t-e.avail_out),c=a+(e.avail_out-257),u=r.dmax,d=r.wsize,h=r.whave,f=r.wnext,p=r.window,m=r.hold,g=r.bits,v=r.lencode,y=r.distcode,_=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;e:do{15>g&&(m+=T[o++]<<g,g+=8,m+=T[o++]<<g,g+=8),x=v[m&_];t:for(;;){if(w=x>>>24,m>>>=w,g-=w,w=x>>>16&255,0===w)C[a++]=65535&x;else{if(!(16&w)){if(0===(64&w)){x=v[(65535&x)+(m&(1<<w)-1)];continue t}if(32&w){r.mode=i;break e}e.msg="invalid literal/length code",r.mode=n;break e}E=65535&x,w&=15,w&&(w>g&&(m+=T[o++]<<g,g+=8),E+=m&(1<<w)-1,m>>>=w,g-=w),15>g&&(m+=T[o++]<<g,g+=8,m+=T[o++]<<g,g+=8),x=y[m&b];r:for(;;){if(w=x>>>24,m>>>=w,g-=w,w=x>>>16&255,!(16&w)){if(0===(64&w)){x=y[(65535&x)+(m&(1<<w)-1)];continue r}e.msg="invalid distance code",r.mode=n;break e}if(S=65535&x,w&=15,w>g&&(m+=T[o++]<<g,g+=8,w>g&&(m+=T[o++]<<g,g+=8)),S+=m&(1<<w)-1,S>u){e.msg="invalid distance too far back",r.mode=n;break e}if(m>>>=w,g-=w,w=a-l,S>w){if(w=S-w,w>h&&r.sane){e.msg="invalid distance too far back",r.mode=n;break e}if(A=0,M=p,0===f){if(A+=d-w,E>w){E-=w;do C[a++]=p[A++];while(--w);A=a-S,M=C}}else if(w>f){if(A+=d+f-w,w-=f,E>w){E-=w;do C[a++]=p[A++];while(--w);if(A=0,E>f){w=f,E-=w;do C[a++]=p[A++];while(--w);A=a-S,M=C}}}else if(A+=f-w,E>w){E-=w;do C[a++]=p[A++];while(--w);A=a-S,M=C}for(;E>2;)C[a++]=M[A++],C[a++]=M[A++],C[a++]=M[A++],E-=3;E&&(C[a++]=M[A++],E>1&&(C[a++]=M[A++]))}else{A=a-S;do C[a++]=C[A++],C[a++]=C[A++],C[a++]=C[A++],E-=3;while(E>2);E&&(C[a++]=C[A++],E>1&&(C[a++]=C[A++]))}break}}break}}while(s>o&&c>a);E=g>>3,o-=E,g-=E<<3,m&=(1<<g)-1,e.next_in=o,e.next_out=a,e.avail_in=s>o?5+(s-o):5-(o-s),e.avail_out=c>a?257+(c-a):257-(a-c),r.hold=m,r.bits=g}},"./node_modules/pako/lib/zlib/inflate.js":function(e,t,r){"use strict";function n(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=N,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new y.Buf32(me),t.distcode=t.distdyn=new y.Buf32(ge),t.sane=1,t.back=-1,j):D}function s(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,o(e)):D}function a(e,t){var r,n;return e&&e.state?(n=e.state,0>t?(r=0,t=-t):(r=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||t>15)?D:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,s(e))):D}function l(e,t){var r,n;return e?(n=new i,e.state=n,n.window=null,r=a(e,t),r!==j&&(e.state=null),r):D}function c(e){return l(e,ye)}function u(e){if(_e){var t;for(g=new y.Buf32(512),v=new y.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(w(S,e.lens,0,288,g,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;w(A,e.lens,0,32,v,0,e.work,{bits:5}),_e=!1}e.lencode=g,e.lenbits=9,e.distcode=v,e.distbits=5}function d(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new y.Buf8(o.wsize)),n>=o.wsize?(y.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),y.arraySet(o.window,t,r-n,i,o.wnext),n-=i,n?(y.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}function h(e,t){var r,i,o,s,a,l,c,h,f,p,m,g,v,me,ge,ve,ye,_e,be,xe,we,Ee,Se,Ae,Me=0,Te=new y.Buf8(4),Ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return D;r=e.state,r.mode===Y&&(r.mode=K),a=e.next_out,o=e.output,c=e.avail_out,s=e.next_in,i=e.input,l=e.avail_in,h=r.hold,f=r.bits,p=l,m=c,Ee=j;e:for(;;)switch(r.mode){case N:if(0===r.wrap){r.mode=K;break}for(;16>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if(2&r.wrap&&35615===h){r.check=0,Te[0]=255&h,Te[1]=h>>>8&255,r.check=b(r.check,Te,2,0),h=0,f=0,r.mode=F;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&h)<<8)+(h>>8))%31){e.msg="incorrect header check",r.mode=he;break}if((15&h)!==k){e.msg="unknown compression method",r.mode=he;break}if(h>>>=4,f-=4,we=(15&h)+8,0===r.wbits)r.wbits=we;else if(we>r.wbits){e.msg="invalid window size",r.mode=he;break}r.dmax=1<<we,e.adler=r.check=1,r.mode=512&h?q:Y,h=0,f=0;break;case F:for(;16>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if(r.flags=h,(255&r.flags)!==k){e.msg="unknown compression method",r.mode=he;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=he;break}r.head&&(r.head.text=h>>8&1),512&r.flags&&(Te[0]=255&h,Te[1]=h>>>8&255,r.check=b(r.check,Te,2,0)),h=0,f=0,r.mode=V;case V:for(;32>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}r.head&&(r.head.time=h),512&r.flags&&(Te[0]=255&h,Te[1]=h>>>8&255,Te[2]=h>>>16&255,Te[3]=h>>>24&255,r.check=b(r.check,Te,4,0)),h=0,f=0,r.mode=U;case U:for(;16>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}r.head&&(r.head.xflags=255&h,r.head.os=h>>8),512&r.flags&&(Te[0]=255&h,Te[1]=h>>>8&255,r.check=b(r.check,Te,2,0)),h=0,f=0,r.mode=B;case B:if(1024&r.flags){for(;16>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}r.length=h,r.head&&(r.head.extra_len=h),512&r.flags&&(Te[0]=255&h,Te[1]=h>>>8&255,r.check=b(r.check,Te,2,0)),h=0,f=0}else r.head&&(r.head.extra=null);r.mode=z;case z:if(1024&r.flags&&(g=r.length,g>l&&(g=l),g&&(r.head&&(we=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),y.arraySet(r.head.extra,i,s,g,we)),512&r.flags&&(r.check=b(r.check,i,g,s)),l-=g,s+=g,r.length-=g),r.length))break e;r.length=0,r.mode=G;case G:if(2048&r.flags){if(0===l)break e;g=0;do we=i[s+g++],r.head&&we&&r.length<65536&&(r.head.name+=String.fromCharCode(we));while(we&&l>g);if(512&r.flags&&(r.check=b(r.check,i,g,s)),l-=g,s+=g,we)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=H;case H:if(4096&r.flags){if(0===l)break e;g=0;do we=i[s+g++],r.head&&we&&r.length<65536&&(r.head.comment+=String.fromCharCode(we));while(we&&l>g);if(512&r.flags&&(r.check=b(r.check,i,g,s)),l-=g,s+=g,we)break e}else r.head&&(r.head.comment=null);r.mode=W;case W:if(512&r.flags){for(;16>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if(h!==(65535&r.check)){e.msg="header crc mismatch",r.mode=he;break}h=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Y;break;case q:for(;32>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}e.adler=r.check=n(h),h=0,f=0,r.mode=X;case X:if(0===r.havedict)return e.next_out=a,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=h,r.bits=f,L;e.adler=r.check=1,r.mode=Y;case Y:if(t===T||t===C)break e;case K:if(r.last){h>>>=7&f,f-=7&f,r.mode=ce;break}for(;3>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}switch(r.last=1&h,h>>>=1,f-=1,3&h){case 0:r.mode=Q;break;case 1:if(u(r),r.mode=re,t===C){h>>>=2,f-=2;break e}break;case 2:r.mode=$;break;case 3:e.msg="invalid block type",r.mode=he}h>>>=2,f-=2;break;case Q:for(h>>>=7&f,f-=7&f;32>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if((65535&h)!==(h>>>16^65535)){e.msg="invalid stored block lengths",r.mode=he;break}if(r.length=65535&h,h=0,f=0,r.mode=Z,t===C)break e;case Z:r.mode=J;case J:if(g=r.length){if(g>l&&(g=l),g>c&&(g=c),0===g)break e;y.arraySet(o,i,s,g,a),l-=g,s+=g,c-=g,a+=g,r.length-=g;break}r.mode=Y;break;case $:for(;14>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if(r.nlen=(31&h)+257,h>>>=5,f-=5,r.ndist=(31&h)+1,h>>>=5,f-=5,r.ncode=(15&h)+4,h>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=he;break}r.have=0,r.mode=ee;case ee:for(;r.have<r.ncode;){for(;3>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}r.lens[Ce[r.have++]]=7&h,h>>>=3,f-=3}for(;r.have<19;)r.lens[Ce[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Se={bits:r.lenbits},Ee=w(E,r.lens,0,19,r.lencode,0,r.work,Se),r.lenbits=Se.bits,Ee){e.msg="invalid code lengths set",r.mode=he;break}r.have=0,r.mode=te;case te:for(;r.have<r.nlen+r.ndist;){for(;Me=r.lencode[h&(1<<r.lenbits)-1],ge=Me>>>24,ve=Me>>>16&255,ye=65535&Me,!(f>=ge);){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if(16>ye)h>>>=ge,f-=ge,r.lens[r.have++]=ye;else{if(16===ye){for(Ae=ge+2;Ae>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if(h>>>=ge,f-=ge,0===r.have){e.msg="invalid bit length repeat",r.mode=he;break}we=r.lens[r.have-1],g=3+(3&h),h>>>=2,f-=2}else if(17===ye){for(Ae=ge+3;Ae>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}h>>>=ge,f-=ge,we=0,g=3+(7&h),h>>>=3,f-=3}else{for(Ae=ge+7;Ae>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}h>>>=ge,f-=ge,we=0,g=11+(127&h),h>>>=7,f-=7}if(r.have+g>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=he;break}for(;g--;)r.lens[r.have++]=we}}if(r.mode===he)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=he;break}if(r.lenbits=9,Se={bits:r.lenbits},Ee=w(S,r.lens,0,r.nlen,r.lencode,0,r.work,Se),r.lenbits=Se.bits,Ee){e.msg="invalid literal/lengths set",r.mode=he;break}if(r.distbits=6,r.distcode=r.distdyn,Se={bits:r.distbits},Ee=w(A,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Se),r.distbits=Se.bits,Ee){e.msg="invalid distances set",r.mode=he;break}if(r.mode=re,t===C)break e;case re:r.mode=ne;case ne:if(l>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=h,r.bits=f,x(e,m),a=e.next_out,o=e.output,c=e.avail_out,s=e.next_in,i=e.input,l=e.avail_in,h=r.hold,f=r.bits,r.mode===Y&&(r.back=-1);break}for(r.back=0;Me=r.lencode[h&(1<<r.lenbits)-1],ge=Me>>>24,ve=Me>>>16&255,ye=65535&Me,!(f>=ge);){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if(ve&&0===(240&ve)){for(_e=ge,be=ve,xe=ye;Me=r.lencode[xe+((h&(1<<_e+be)-1)>>_e)],ge=Me>>>24,ve=Me>>>16&255,ye=65535&Me,!(f>=_e+ge);){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}h>>>=_e,f-=_e,r.back+=_e}if(h>>>=ge,f-=ge,r.back+=ge,r.length=ye,0===ve){r.mode=le;break}if(32&ve){r.back=-1,r.mode=Y;break}if(64&ve){e.msg="invalid literal/length code",r.mode=he;break}r.extra=15&ve,r.mode=ie;case ie:if(r.extra){for(Ae=r.extra;Ae>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=oe;case oe:for(;Me=r.distcode[h&(1<<r.distbits)-1],ge=Me>>>24,ve=Me>>>16&255,ye=65535&Me,!(f>=ge);){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if(0===(240&ve)){for(_e=ge,be=ve,xe=ye;Me=r.distcode[xe+((h&(1<<_e+be)-1)>>_e)],ge=Me>>>24,ve=Me>>>16&255,ye=65535&Me,!(f>=_e+ge);){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}h>>>=_e,f-=_e,r.back+=_e}if(h>>>=ge,f-=ge,r.back+=ge,64&ve){e.msg="invalid distance code",r.mode=he;break}r.offset=ye,r.extra=15&ve,r.mode=se;case se:if(r.extra){for(Ae=r.extra;Ae>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=he;break}r.mode=ae;case ae:if(0===c)break e;if(g=m-c,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=he;break}g>r.wnext?(g-=r.wnext,v=r.wsize-g):v=r.wnext-g,g>r.length&&(g=r.length),me=r.window}else me=o,v=a-r.offset,g=r.length;g>c&&(g=c),c-=g,r.length-=g;do o[a++]=me[v++];while(--g);0===r.length&&(r.mode=ne);break;case le:if(0===c)break e;o[a++]=r.length,c--,r.mode=ne;break;case ce:if(r.wrap){for(;32>f;){if(0===l)break e;l--,h|=i[s++]<<f,f+=8}if(m-=c,e.total_out+=m,r.total+=m,m&&(e.adler=r.check=r.flags?b(r.check,o,m,a-m):_(r.check,o,m,a-m)),m=c,(r.flags?h:n(h))!==r.check){e.msg="incorrect data check",r.mode=he;break}h=0,f=0}r.mode=ue;case ue:if(r.wrap&&r.flags){for(;32>f;){if(0===l)break e;l--,h+=i[s++]<<f,f+=8}if(h!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=he;break}h=0,f=0}r.mode=de;case de:Ee=P;break e;case he:Ee=I;break e;case fe:return R;case pe:default:return D}return e.next_out=a,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=h,r.bits=f,(r.wsize||m!==e.avail_out&&r.mode<he&&(r.mode<ce||t!==M))&&d(e,e.output,e.next_out,m-e.avail_out)?(r.mode=fe,R):(p-=e.avail_in,m-=e.avail_out,e.total_in+=p,e.total_out+=m,r.total+=m,r.wrap&&m&&(e.adler=r.check=r.flags?b(r.check,o,m,e.next_out-m):_(r.check,o,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Y?128:0)+(r.mode===re||r.mode===Z?256:0),(0===p&&0===m||t===M)&&Ee===j&&(Ee=O),Ee)}function f(e){if(!e||!e.state)return D;var t=e.state;return t.window&&(t.window=null),e.state=null,j}function p(e,t){var r;return e&&e.state?(r=e.state,0===(2&r.wrap)?D:(r.head=t,t.done=!1,j)):D}function m(e,t){var r,n,i,o=t.length;return e&&e.state?(r=e.state,0!==r.wrap&&r.mode!==X?D:r.mode===X&&(n=1,n=_(n,t,o,0),n!==r.check)?I:(i=d(e,t,o,o))?(r.mode=fe,R):(r.havedict=1,j)):D}var g,v,y=r("./node_modules/pako/lib/utils/common.js"),_=r("./node_modules/pako/lib/zlib/adler32.js"),b=r("./node_modules/pako/lib/zlib/crc32.js"),x=r("./node_modules/pako/lib/zlib/inffast.js"),w=r("./node_modules/pako/lib/zlib/inftrees.js"),E=0,S=1,A=2,M=4,T=5,C=6,j=0,P=1,L=2,D=-2,I=-3,R=-4,O=-5,k=8,N=1,F=2,V=3,U=4,B=5,z=6,G=7,H=8,W=9,q=10,X=11,Y=12,K=13,Q=14,Z=15,J=16,$=17,ee=18,te=19,re=20,ne=21,ie=22,oe=23,se=24,ae=25,le=26,ce=27,ue=28,de=29,he=30,fe=31,pe=32,me=852,ge=592,ve=15,ye=ve,_e=!0;t.inflateReset=s,t.inflateReset2=a,t.inflateResetKeep=o,t.inflateInit=c,t.inflateInit2=l,t.inflate=h,t.inflateEnd=f,t.inflateGetHeader=p,t.inflateSetDictionary=m,t.inflateInfo="pako inflate (from Nodeca project)"},"./node_modules/pako/lib/zlib/inftrees.js":function(e,t,r){"use strict";var n=r("./node_modules/pako/lib/utils/common.js"),i=15,o=852,s=592,a=0,l=1,c=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,p,m,g,v,y){var _,b,x,w,E,S,A,M,T,C=y.bits,j=0,P=0,L=0,D=0,I=0,R=0,O=0,k=0,N=0,F=0,V=null,U=0,B=new n.Buf16(i+1),z=new n.Buf16(i+1),G=null,H=0;for(j=0;i>=j;j++)B[j]=0;for(P=0;p>P;P++)B[t[r+P]]++;for(I=C,D=i;D>=1&&0===B[D];D--);if(I>D&&(I=D),0===D)return m[g++]=20971520,m[g++]=20971520,y.bits=1,0;for(L=1;D>L&&0===B[L];L++);for(L>I&&(I=L),k=1,j=1;i>=j;j++)if(k<<=1,k-=B[j],0>k)return-1;if(k>0&&(e===a||1!==D))return-1;for(z[1]=0,j=1;i>j;j++)z[j+1]=z[j]+B[j];for(P=0;p>P;P++)0!==t[r+P]&&(v[z[t[r+P]]++]=P);if(e===a?(V=G=v,S=19):e===l?(V=u,U-=257,G=d,H-=257,S=256):(V=h,G=f,S=-1),F=0,P=0,j=L,E=g,R=I,O=0,x=-1,N=1<<I,w=N-1,e===l&&N>o||e===c&&N>s)return 1;for(;;){A=j-O,v[P]<S?(M=0,T=v[P]):v[P]>S?(M=G[H+v[P]],T=V[U+v[P]]):(M=96,T=0),_=1<<j-O,b=1<<R,L=b;do b-=_,m[E+(F>>O)+b]=A<<24|M<<16|T|0;while(0!==b);for(_=1<<j-1;F&_;)_>>=1;if(0!==_?(F&=_-1,F+=_):F=0,P++,0===--B[j]){if(j===D)break;j=t[r+v[P]]}if(j>I&&(F&w)!==x){for(0===O&&(O=I),E+=L,R=j-O,k=1<<R;D>R+O&&(k-=B[R+O],!(0>=k));)R++,k<<=1;if(N+=1<<R,e===l&&N>o||e===c&&N>s)return 1;x=F&w,m[x]=I<<24|R<<16|E-g|0}}return 0!==F&&(m[E+F]=j-O<<24|64<<16|0),y.bits=I,0}},"./node_modules/pako/lib/zlib/messages.js":function(e,t,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"./node_modules/pako/lib/zlib/trees.js":function(e,t,r){"use strict";function n(e){for(var t=e.length;--t>=0;)e[t]=0}function i(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function o(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function s(e){return 256>e?le[e]:le[256+(e>>>7)]}function a(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function l(e,t,r){e.bi_valid>K-r?(e.bi_buf|=t<<e.bi_valid&65535,a(e,e.bi_buf),e.bi_buf=t>>K-e.bi_valid,e.bi_valid+=r-K):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function c(e,t,r){l(e,r[2*t],r[2*t+1])}function u(e,t){var r=0;do r|=1&e,e>>>=1,r<<=1;while(--t>0);return r>>>1}function d(e){16===e.bi_valid?(a(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function h(e,t){var r,n,i,o,s,a,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(o=0;Y>=o;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;X>r;r++)n=e.heap[r],o=l[2*l[2*n+1]+1]+1,o>p&&(o=p,m++),l[2*n+1]=o,n>c||(e.bl_count[o]++,s=0,n>=f&&(s=h[n-f]),a=l[2*n],e.opt_len+=a*(o+s),d&&(e.static_len+=a*(u[2*n+1]+s)));if(0!==m){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(n=e.bl_count[o];0!==n;)i=e.heap[--r],i>c||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}function f(e,t,r){var n,i,o=new Array(Y+1),s=0;for(n=1;Y>=n;n++)o[n]=s=s+r[n-1]<<1;for(i=0;t>=i;i++){var a=e[2*i+1];0!==a&&(e[2*i]=u(o[a]++,a))}}function p(){var e,t,r,n,o,s=new Array(Y+1);for(r=0,n=0;z-1>n;n++)for(ue[n]=r,e=0;e<1<<te[n];e++)ce[r++]=n;for(ce[r-1]=n,o=0,n=0;16>n;n++)for(de[n]=o,e=0;e<1<<re[n];e++)le[o++]=n;for(o>>=7;W>n;n++)for(de[n]=o<<7,e=0;e<1<<re[n]-7;e++)le[256+o++]=n;for(t=0;Y>=t;t++)s[t]=0;for(e=0;143>=e;)se[2*e+1]=8,e++,s[8]++;for(;255>=e;)se[2*e+1]=9,e++,s[9]++;for(;279>=e;)se[2*e+1]=7,e++,s[7]++;for(;287>=e;)se[2*e+1]=8,e++,s[8]++;for(f(se,H+1,s),e=0;W>e;e++)ae[2*e+1]=5,ae[2*e]=u(e,5);he=new i(se,te,G+1,H,Y),fe=new i(ae,re,0,W,Y),pe=new i(new Array(0),ne,0,q,Q)}function m(e){var t;for(t=0;H>t;t++)e.dyn_ltree[2*t]=0;for(t=0;W>t;t++)e.dyn_dtree[2*t]=0;for(t=0;q>t;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Z]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function g(e){e.bi_valid>8?a(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function v(e,t,r,n){g(e),n&&(a(e,r),a(e,~r)),D.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}function y(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function _(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&y(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!y(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function b(e,t,r){var n,i,o,a,u=0;if(0!==e.last_lit)do n=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],i=e.pending_buf[e.l_buf+u],u++,0===n?c(e,i,t):(o=ce[i],c(e,o+G+1,t),a=te[o],
0!==a&&(i-=ue[o],l(e,i,a)),n--,o=s(n),c(e,o,r),a=re[o],0!==a&&(n-=de[o],l(e,n,a)));while(u<e.last_lit);c(e,Z,t)}function x(e,t){var r,n,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=X,r=0;l>r;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)i=e.heap[++e.heap_len]=2>c?++c:0,o[2*i]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)_(e,o,r);i=l;do r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],_(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,_(e,o,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],h(e,t),f(o,c,e.bl_count)}function w(e,t,r){var n,i,o=-1,s=t[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;r>=n;n++)i=s,s=t[2*(n+1)+1],++a<l&&i===s||(c>a?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*J]++):10>=a?e.bl_tree[2*$]++:e.bl_tree[2*ee]++,a=0,o=i,0===s?(l=138,c=3):i===s?(l=6,c=3):(l=7,c=4))}function E(e,t,r){var n,i,o=-1,s=t[1],a=0,u=7,d=4;for(0===s&&(u=138,d=3),n=0;r>=n;n++)if(i=s,s=t[2*(n+1)+1],!(++a<u&&i===s)){if(d>a){do c(e,i,e.bl_tree);while(0!==--a)}else 0!==i?(i!==o&&(c(e,i,e.bl_tree),a--),c(e,J,e.bl_tree),l(e,a-3,2)):10>=a?(c(e,$,e.bl_tree),l(e,a-3,3)):(c(e,ee,e.bl_tree),l(e,a-11,7));a=0,o=i,0===s?(u=138,d=3):i===s?(u=6,d=3):(u=7,d=4)}}function S(e){var t;for(w(e,e.dyn_ltree,e.l_desc.max_code),w(e,e.dyn_dtree,e.d_desc.max_code),x(e,e.bl_desc),t=q-1;t>=3&&0===e.bl_tree[2*ie[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function A(e,t,r,n){var i;for(l(e,t-257,5),l(e,r-1,5),l(e,n-4,4),i=0;n>i;i++)l(e,e.bl_tree[2*ie[i]+1],3);E(e,e.dyn_ltree,t-1),E(e,e.dyn_dtree,r-1)}function M(e){var t,r=4093624447;for(t=0;31>=t;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return R;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return O;for(t=32;G>t;t++)if(0!==e.dyn_ltree[2*t])return O;return R}function T(e){me||(p(),me=!0),e.l_desc=new o(e.dyn_ltree,he),e.d_desc=new o(e.dyn_dtree,fe),e.bl_desc=new o(e.bl_tree,pe),e.bi_buf=0,e.bi_valid=0,m(e)}function C(e,t,r,n){l(e,(N<<1)+(n?1:0),3),v(e,t,r,!0)}function j(e){l(e,F<<1,3),c(e,Z,se),d(e)}function P(e,t,r,n){var i,o,s=0;e.level>0?(e.strm.data_type===k&&(e.strm.data_type=M(e)),x(e,e.l_desc),x(e,e.d_desc),s=S(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,i>=o&&(i=o)):i=o=r+5,i>=r+4&&-1!==t?C(e,t,r,n):e.strategy===I||o===i?(l(e,(F<<1)+(n?1:0),3),b(e,se,ae)):(l(e,(V<<1)+(n?1:0),3),A(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),b(e,e.dyn_ltree,e.dyn_dtree)),m(e),n&&g(e)}function L(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(ce[r]+G+1)]++,e.dyn_dtree[2*s(t)]++),e.last_lit===e.lit_bufsize-1}var D=r("./node_modules/pako/lib/utils/common.js"),I=4,R=0,O=1,k=2,N=0,F=1,V=2,U=3,B=258,z=29,G=256,H=G+1+z,W=30,q=19,X=2*H+1,Y=15,K=16,Q=7,Z=256,J=16,$=17,ee=18,te=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],re=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=512,se=new Array(2*(H+2));n(se);var ae=new Array(2*W);n(ae);var le=new Array(oe);n(le);var ce=new Array(B-U+1);n(ce);var ue=new Array(z);n(ue);var de=new Array(W);n(de);var he,fe,pe,me=!1;t._tr_init=T,t._tr_stored_block=C,t._tr_flush_block=P,t._tr_tally=L,t._tr_align=j},"./node_modules/pako/lib/zlib/zstream.js":function(e,t,r){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=n},"./node_modules/pend/index.js":function(e,t){function r(){this.pending=0,this.max=1/0,this.listeners=[],this.waiting=[],this.error=null}function n(e){function t(t){if(n)throw new Error("callback called twice");if(n=!0,e.error=e.error||t,e.pending-=1,e.waiting.length>0&&e.pending<e.max)i(e,e.waiting.shift());else if(0===e.pending){var o=e.listeners;e.listeners=[],o.forEach(r)}}function r(t){t(e.error)}e.pending+=1;var n=!1;return t}function i(e,t){t(n(e))}e.exports=r,r.prototype.go=function(e){this.pending<this.max?i(this,e):this.waiting.push(e)},r.prototype.wait=function(e){0===this.pending?e(this.error):this.listeners.push(e)},r.prototype.hold=function(){return n(this)}},"./node_modules/process/browser.js":function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(u===setTimeout)return setTimeout(e,0);if((u===r||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function o(e){if(d===clearTimeout)return clearTimeout(e);if((d===n||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function s(){m&&f&&(m=!1,f.length?p=f.concat(p):g=-1,p.length&&a())}function a(){if(!m){var e=i(s);m=!0;for(var t=p.length;t;){for(f=p,p=[];++g<t;)f&&f[g].run();g=-1,t=p.length}f=null,m=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var u,d,h=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:r}catch(e){u=r}try{d="function"==typeof clearTimeout?clearTimeout:n}catch(e){d=n}}();var f,p=[],m=!1,g=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new l(e,t)),1!==p.length||m||i(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=c,h.addListener=c,h.once=c,h.off=c,h.removeListener=c,h.removeAllListeners=c,h.emit=c,h.prependListener=c,h.prependOnceListener=c,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},"./node_modules/regenerator-runtime/runtime.js":function(e,t,r){var n=function(e){"use strict";function t(e,t,r,i){var o=t&&t.prototype instanceof n?t:n,s=Object.create(o.prototype),a=new h(i||[]);return s._invoke=l(e,r,a),s}function r(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}function n(){}function i(){}function o(){}function s(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function a(e){function t(n,i,o,s){var a=r(e[n],e,i);if("throw"!==a.type){var l=a.arg,c=l.value;return c&&"object"==typeof c&&v.call(c,"__await")?Promise.resolve(c.__await).then(function(e){t("next",e,o,s)},function(e){t("throw",e,o,s)}):Promise.resolve(c).then(function(e){l.value=e,o(l)},function(e){return t("throw",e,o,s)})}s(a.arg)}function n(e,r){function n(){return new Promise(function(n,i){t(e,r,n,i)})}return i=i?i.then(n,n):n()}var i;this._invoke=n}function l(e,t,n){var i=w;return function(o,s){if(i===S)throw new Error("Generator is already running");if(i===A){if("throw"===o)throw s;return p()}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var l=c(a,n);if(l){if(l===M)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===w)throw i=A,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=S;var u=r(e,t,n);if("normal"===u.type){if(i=n.done?A:E,u.arg===M)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=A,n.method="throw",n.arg=u.arg)}}}function c(e,t){var n=e.iterator[t.method];if(n===m){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=m,c(e,t),"throw"===t.method))return M;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return M}var i=r(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,M;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=m),t.delegate=null,M):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,M)}function u(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function d(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(u,this),this.reset(!0)}function f(e){if(e){var t=e[_];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function i(){for(;++r<e.length;)if(v.call(e,r))return i.value=e[r],i.done=!1,i;return i.value=m,i.done=!0,i};return n.next=n}}return{next:p}}function p(){return{value:m,done:!0}}var m,g=Object.prototype,v=g.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},_=y.iterator||"@@iterator",b=y.asyncIterator||"@@asyncIterator",x=y.toStringTag||"@@toStringTag";e.wrap=t;var w="suspendedStart",E="suspendedYield",S="executing",A="completed",M={},T={};T[_]=function(){return this};var C=Object.getPrototypeOf,j=C&&C(C(f([])));j&&j!==g&&v.call(j,_)&&(T=j);var P=o.prototype=n.prototype=Object.create(T);return i.prototype=P.constructor=o,o.constructor=i,o[x]=i.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===i||"GeneratorFunction"===(t.displayName||t.name):!1},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,x in e||(e[x]="GeneratorFunction")),e.prototype=Object.create(P),e},e.awrap=function(e){return{__await:e}},s(a.prototype),a.prototype[b]=function(){return this},e.AsyncIterator=a,e.async=function(r,n,i,o){var s=new a(t(r,n,i,o));return e.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},s(P),P[x]="Generator",P[_]=function(){return this},P.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=f,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(d),!e)for(var t in this)"t"===t.charAt(0)&&v.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=m)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,n){return o.type="throw",o.arg=e,r.next=t,n&&(r.method="next",r.arg=m),!!n}if(this.done)throw e;for(var r=this,n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=v.call(i,"catchLoc"),a=v.call(i,"finallyLoc");if(s&&a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&v.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,M):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),M},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),d(r),M}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;d(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:f(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=m),M}},e}(e.exports);try{regeneratorRuntime=n}catch(i){Function("r","regeneratorRuntime = r")(n)}},"./node_modules/setimmediate/setImmediate.js":function(e,t,r){(function(e,t){!function(e,r){"use strict";function n(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return m[p]=n,f(p),p++}function i(e){delete m[e]}function o(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n)}}function s(e){if(g)setTimeout(s,0,e);else{var t=m[e];if(t){g=!0;try{o(t)}finally{i(e),g=!1}}}}function a(){f=function(e){t.nextTick(function(){s(e)})}}function l(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}function c(){var t="setImmediate$"+Math.random()+"$",r=function(r){r.source===e&&"string"==typeof r.data&&0===r.data.indexOf(t)&&s(+r.data.slice(t.length))};e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r),f=function(r){e.postMessage(t+r,"*")}}function u(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;s(t)},f=function(t){e.port2.postMessage(t)}}function d(){var e=v.documentElement;f=function(t){var r=v.createElement("script");r.onreadystatechange=function(){s(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}function h(){f=function(e){setTimeout(s,0,e)}}if(!e.setImmediate){var f,p=1,m={},g=!1,v=e.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(e);y=y&&y.setTimeout?y:e,"[object process]"==={}.toString.call(e.process)?a():l()?c():e.MessageChannel?u():v&&"onreadystatechange"in v.createElement("script")?d():h(),y.setImmediate=n,y.clearImmediate=i}}("undefined"==typeof self?"undefined"==typeof e?this:e:self)}).call(this,r("./node_modules/webpack/buildin/global.js"),r("./node_modules/process/browser.js"))},"./node_modules/timers-browserify/main.js":function(e,t,r){(function(e){function n(e,t){this._id=e,this._clearFn=t}var i="undefined"!=typeof e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;t.setTimeout=function(){return new n(o.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new n(o.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r("./node_modules/setimmediate/setImmediate.js"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||"undefined"!=typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||"undefined"!=typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/webpack/buildin/global.js":function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(n){"object"==typeof window&&(r=window)}e.exports=r},"./node_modules/webpack/buildin/module.js":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"./src/analytics/index.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}r.r(t),r.d(t,"analytics",function(){return c});var s=r("./src/logger/Logger.js"),a="mixpanel",l=function(){function e(){n(this,e),this.providers={},this.defaultProvider=a}return o(e,[{key:"register",value:function(e){var t=e.name.toLowerCase();if(!(t in this.providers))try{e.init(e.initOptions),this.providers[t]=e}catch(r){s.logger.warn('Failed to register analytics provider: "'.concat(e.name,'". ').concat(r))}}},{key:"optIn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";this._getProviders(t).forEach(function(t){return t.optIn(e)})}},{key:"optOut",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";this._getProviders(t).forEach(function(t){return t.optOut(e)})}},{key:"setDefaultProvider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e=e.toLowerCase(),e in this.providers?void(this.defaultProvider=e):void s.logger.warn("Provider not registered")}},{key:"hasOptedOut",value:function(e){return e=e||this.defaultProvider,e=e.toLowerCase(),e in this.providers?this.providers[e].hasOptedOut():void s.logger.warn("Provider not registered")}},{key:"getDistinctId",value:function(e){return e=e||this.defaultProvider,e=e.toLowerCase(),e in this.providers?this.providers[e].getDistinctId():void s.logger.warn("Provider not registered")}},{key:"track",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all";this._getProviders(r).forEach(function(r){return r.track(e,t)})}},{key:"identify",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";this._getProviders(t).forEach(function(t){return t.identify(e)})}},{key:"_getProviders",value:function(e){var t,r=this;return Array.isArray(e)?t=e.map(function(e){return e.toLowerCase()}).filter(function(e){return!(e in r.providers)}):"all"===e?t=Object.keys(this.providers):(e=e.toLowerCase(),t=e in this.providers?[e]:[]),t.map(function(e){return r.providers[e]})}}]),e}(),c=new l},"./src/analytics/providers/interface.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}r.r(t),r.d(t,"default",function(){return s});var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.initOptions=t}return o(e,[{key:"init",value:function(){}},{key:"optIn",value:function(e){}},{key:"optOut",value:function(e){}},{key:"hasOptedOut",value:function(){}},{key:"getDistinctId",value:function(){}},{key:"track",value:function(e,t){}},{key:"identify",value:function(e){}},{key:"name",get:function(){}}]),e}()},"./src/analytics/providers/mixpanel.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r.r(t),r.d(t,"Mixpanel",function(){return g}),r.d(t,"options",function(){return y});var h=r("./node_modules/mixpanel-browser/dist/mixpanel.cjs.js"),f=r.n(h),p=r("./src/analytics/providers/interface.js"),m="mixpanel",g=function(e){function t(e){return i(this,t),a(this,c(t).call(this,e))}return u(t,e),s(t,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.token)throw new Error("Mixpanel token is not defined");return f.a.init(e.token,e.config)}},{key:"hasOptedOut",value:function(){return f.a.has_opted_out_tracking()}},{key:"optOut",value:function(e){this.track("OptOutTracking"),f.a.opt_out_tracking(e)}},{key:"getDistinctId",value:function(){return f.a.get_distinct_id()}},{key:"optIn",value:function(e){this.track("OptInTracking"),f.a.opt_in_tracking(e)}},{key:"track",value:function(e,t){f.a.track(e,t)}},{key:"identify",value:function(e){f.a.identify(e)}},{key:"name",get:function(){return m}}]),t}(p["default"]),v=null;v="7cecb637d6468a8b61f388bbb82072ee";var y={token:v,config:{persistence:"localStorage",opt_out_tracking_by_default:!0}}},"./src/animation/Animation.js":function(e,t,r){"use strict";function n(e,t,r){this.root=e,this.handler=r.animationHandler,this.data=this.handler.init(t),this.hierarchy=this.handler.parse(e),this.viewer=r.viewer,this.animator=r,this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!1,this.delta=.5,this.interpolationType=o.INTERPOLATION_TYPE.LINEAR,this.setStartAndEndKeyTime()}function i(e,t){function r(e,t,r,n,i,o,s){var a=.5*(r-e),l=.5*(n-t);return(2*(t-r)+a+l)*s+(-3*(t-r)-2*a-l)*o+a*i+t}var n,i,o,s,a,l,c,u,d,h=[],f=[];return n=(e.length-1)*t,i=Math.floor(n),o=n-i,h[0]=0===i?i:i-1,h[1]=i,h[2]=i>e.length-2?i:i+1,h[3]=i>e.length-3?i:i+2,l=e[h[0]],c=e[h[1]],u=e[h[2]],d=e[h[3]],s=o*o,a=o*s,f[0]=r(l[0],c[0],u[0],d[0],o,s,a),f[1]=r(l[1],c[1],u[1],d[1],o,s,a),f[2]=r(l[2],c[2],u[2],d[2],o,s,a),f}r.r(t),r.d(t,"Animation",function(){return n}),r.d(t,"interpolateCatmullRom",function(){return i});var o=r("./src/animation/InterpolationType.js"),s=r("./src/application/GlobalManagerMixin.js");s.GlobalManagerMixin.call(n.prototype),n.prototype.setStartAndEndKeyTime=function(){if(this.data.hierarchy.length>0){var e=this.data.hierarchy[0].keys;this.startKeyTime=e[0].time,this.endKeyTime=e[e.length-1].time}else this.startKeyTime=this.endKeyTime=0},n.prototype.keyTypes=[],n.prototype.defaultKey={},n.prototype.play=function(e){this.currentTime=void 0!==e?e:0,this.isPlaying=!0,this.isPaused=!1,this.reset(),this.handler.play(this)},n.prototype.pause=function(){this.isPaused===!0?this.handler.play(this):this.handler.stop(this),this.isPaused=!this.isPaused},n.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.handler.stop(this)},n.prototype["goto"]=function(e){this.isPlaying||this.play(),this.isPaused||this.pause();var t=e-this.currentTime;this.update(t)},n.prototype.reset=function(){for(var e=0,t=this.hierarchy.length;t>e;e++){var r=this.hierarchy[e];void 0===r.animationCache&&(r.animationCache={}),void 0===r.animationCache[this.data.name]&&(r.animationCache[this.data.name]={prevKey:this.defaultKey,nextKey:this.defaultKey,originalMatrix:r.matrix});for(var n=r.animationCache[this.data.name],i=0;i<this.keyTypes.length;i++){for(var o=this.keyTypes[i],s=this.data.hierarchy[e].keys[0],a=this.getNextKeyWith(o,e,1);a.time<this.currentTime&&a.index>s.index;)s=a,a=this.getNextKeyWith(o,e,a.index+1);n.prevKey[o]=s,n.nextKey[o]=a}}this.setStartAndEndKeyTime()},n.prototype.getNextKeyWith=function(e,t,r){var n=this.data.hierarchy[t].keys;for(this.interpolationType===o.INTERPOLATION_TYPE.CATMULLROM||this.interpolationType===o.INTERPOLATION_TYPE.CATMULLROM_FORWARD?r=r<n.length-1?r:n.length-1:r%=n.length;r<n.length;r++)if(void 0!==n[r][e])return n[r];return this.data.hierarchy[t].keys[0]},n.prototype.getPrevKeyWith=function(e,t,r){var n=this.data.hierarchy[t].keys;for(r=this.interpolationType===o.INTERPOLATION_TYPE.CATMULLROM||this.interpolationType===o.INTERPOLATION_TYPE.CATMULLROM_FORWARD?r>0?r:0:r>=0?r:r+n.length;r>=0;r--)if(void 0!==n[r][e])return n[r];return this.data.hierarchy[t].keys[n.length-1]},n.prototype.isPlayingOutOfRange=function(){return this.isPaused===!1&&(this.currentTime<this.startKeyTime-this.delta||this.currentTime>this.endKeyTime+this.delta)},n.prototype.resetIfLooped=function(){this.loop===!0&&this.currentTime>this.endKeyTime&&(this.currentTime%=this.endKeyTime,this.reset())}},"./src/animation/AnimationHandler.js":function(e,t,r){"use strict";function n(){this.animations=[]}r.r(t),r.d(t,"AnimationHandler",function(){return n}),n.prototype.init=function(e){if(e.initialized===!0)return e;for(var t=0;t<e.hierarchy.length;t++){for(var r=0;r<e.hierarchy[t].keys.length;r++)if(e.hierarchy[t].keys[r].time<0&&(e.hierarchy[t].keys[r].time=0),void 0!==e.hierarchy[t].keys[r].rot&&!(e.hierarchy[t].keys[r].rot instanceof THREE.Quaternion)){var n=e.hierarchy[t].keys[r].rot;Array.isArray(n)||(n=[n._x,n._y,n._z,n._w]),e.hierarchy[t].keys[r].rot=(new THREE.Quaternion).fromArray(n)}for(var r=1;r<e.hierarchy[t].keys.length;r++)e.hierarchy[t].keys[r].time===e.hierarchy[t].keys[r-1].time&&(e.hierarchy[t].keys.splice(r,1),r--);for(var r=0;r<e.hierarchy[t].keys.length;r++)e.hierarchy[t].keys[r].index=r}return e.initialized=!0,e},n.prototype.parse=function(e){function t(e,r){if(r.push(e),e.children&&!(e instanceof THREE.Camera))for(var n=0;n<e.children.length;n++)t(e.children[n],r)}var r=[];return t(e,r),r},n.prototype.play=function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},n.prototype.stop=function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},n.prototype.update=function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].update(e)}},"./src/animation/InterpolationType.js":function(e,t,r){"use strict";r.r(t),r.d(t,"INTERPOLATION_TYPE",function(){return n});var n={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2}},"./src/animation/KeyFrameAnimator.js":function(e,t,r){"use strict";function n(e,t){this.animations=[],this.viewer=e,this.setGlobalManager(e.globalManager),this.keys=[],this.isPlaying=!1,this.isPaused=!0,this.updateFlag=0,this.duration=t,this.currentTime=0,this.onPlayCallback=null,this.animationHandler=new i.AnimationHandler,this.areCameraAnimationsPaused=!1,this.UPDATE_SCENE=1,this.UPDATE_CAMERA=2,this.followCam=!0,this._speedMod=1,this._loops=!1}r.r(t),r.d(t,"KeyFrameAnimator",function(){return n});var i=r("./src/animation/AnimationHandler.js"),o=r("./src/animation/type/MeshAnimation.js"),s=r("./src/animation/type/CameraAnimation.js"),a=r("./src/animation/type/VisibilityAnimation.js"),l=r("./src/animation/type/AnnotationAnimation.js"),c=r("./src/animation/type/PolylineAnimation.js"),u=r("./src/application/GlobalManagerMixin.js");u.GlobalManagerMixin.call(n.prototype),n.prototype.destroy=function(){this.stop(),this.viewer=null,this.keys=null,this.animations=null,this.isPlaying=!1,this.isPaused=!1,this.animationHandler=null},n.prototype.add=function(e){function t(e){function t(e,t,r){for(t=e.length;r=--t;)for(;r--;)e[t]!==e[r]||e.splice(r,1)}e.sort(function(e,t){return e-t}),t(e)}var r=this;if(!(!e.hierarchy||e.hierarchy.length<1||!e.hierarchy[0].keys||e.hierarchy[0].keys.length<2)){var n=null,i=this;if("camera"===e.type?(n=new s.CameraAnimation(i.viewer.camera,e,i),i.animations.push(n)):"annotation"===e.type?(n=new l.AnnotationAnimation(null,e,i),i.animations.push(n)):"polyline"===e.type?(n=new c.PolylineAnimation(null,e,i),i.animations.push(n)):"mesh"===e.type?i.viewer.model.getData().instanceTree.enumNodeFragments(e.id,function(t){var r=i.viewer.getFragmentProxy(i.viewer.model,t);r&&(n=new o.MeshAnimation(r,e,i),i.animations.push(n))},!0):"visibility"===e.type&&(n=new a.VisibilityAnimation(e,e.id,i),i.animations.push(n)),i.animations.forEach(function(e){return e.setGlobalManager(r.globalManager)}),n){for(var u=0,d=e.hierarchy.length;d>u;u++)for(var h=e.hierarchy[u].keys,f=0;f<h.length;f++)void 0===h[f].xk&&i.keys.push(h[f].time);t(i.keys)}this.updateFlag|=this.UPDATE_SCENE}},n.prototype.update=function(e){e*=this._speedMod,this.animationHandler.update(e);var t=this.updateFlag;return this.isPlaying&&!this.isPaused&&(this.currentTime+=e,this.currentTime=Math.min(this.currentTime,this.duration),this.onPlayCallback&&this.onPlayCallback(this.duration>0?this.currentTime/this.duration*100:0),this.currentTime>=this.duration&&(this._loops?this.play(0,this.onPlayCallback):this.pause()),t|=this.UPDATE_SCENE),this.updateFlag=0,t},n.prototype.play=function(e,t){if(this.onPlayCallback=t,this.currentTime>=this.duration&&this["goto"](0),this.isPlaying)return void this.pause();for(var r=0;r<this.animations.length;r++){var n=this.animations[r];n.play(e)}this.isPlaying=!0,this.isPaused=!1},n.prototype.setFollowCamera=function(e){this.followCam=e;for(var t=0;t<this.animations.length;t++){var r=this.animations[t];r.setFollowCamera&&r.setFollowCamera(e)}},n.prototype.isFollowingCamera=function(){return this.followCam},n.prototype.setSpeedModifier=function(e){this._speedMod=e},n.prototype.getSpeedModifier=function(){return this._speedMod},n.prototype.setLooping=function(e){this._loops=e},n.prototype.isLooping=function(){return this._loops},n.prototype.pause=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e];t.isPaused===this.isPaused&&t.pause()}this.isPaused=!this.isPaused,this.areCameraAnimationsPaused=this.isPaused},n.prototype.pauseCameraAnimations=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e];t instanceof s.CameraAnimation&&t.pause()}this.areCameraAnimationsPaused=!this.areCameraAnimationsPaused},n.prototype.stop=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e];t.stop()}this.isPlaying=!1,this.isPaused=!1},n.prototype["goto"]=function(e){if(void 0!==e){for(var t=0;t<this.animations.length;t++){var r=this.animations[t];r["goto"](e)}this.isPlaying=!0,this.isPaused=!0,this.currentTime=e,this.updateFlag|=this.UPDATE_SCENE}},n.prototype.next=function(){function e(e,t){for(var r=-1,n=0;n<t.length;n++)if(t[n]>e){r=t[n];break}return 0>r?t[t.length-1]:r}var t=e(this.currentTime,this.keys);this["goto"](t)},n.prototype.prev=function(){function e(e,t){for(var r=-1,n=t.length-1;n>-1;n--)if(t[n]<e){r=t[n];break}return 0>r?t[0]:r}var t=e(this.currentTime,this.keys);this["goto"](t)}},"./src/animation/type/AnnotationAnimation.js":function(e,t,r){"use strict";function n(e,t,r){function n(e,t,r){var n=this.getDocument(),s=o.container=n.createElement("div"),a=e.name;s.id=a,s.style.cursor="pointer",s.style.visibility=r;var l=n.createElement("div");l.id=a+"-txt",l.style.cssText="display: none;position: absolute;z-index: 1;",s.appendChild(l);var c=n.createElement("img"),u=e.custom&&e.custom.att&&1===e.custom.att;c.src=u?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABv1BMVEUAAAAAAAAAAAAAAAABAwEAAAAAAAAjSRkAAAAFDASJqnZhg1IqTyAjSRkpTx8hRxggRRcAAAAhRRcKFwgAAACau4R9mnFmiFUhSBgbOhMZNhIAAAAECQMgQxcAAAAAAAAAAAAHDwXB2q2jw4yfvoivyJ6fuI6mv5eSr4KAoWu2trZpiV3Nzc0wVSUhRxhNT01vb28AAAAgRBcAAAAAAAAAAAAhRxgeQBYAAAAAAAAAAAAfQRbP5MC0zqCqyJKpyJJBYje3z6WxyKOFpXF9nmkrTiG+wb5xkGVcf0xYfEg1WSpNTU0hRhgfQhYfQhZVVVVAQEAXMREcOhQcHBwSJw0AAAAAAAAWLxAVLQ8AAAAAAAAfQhYIEgYAAACbvn+DsGCGsmSUunaItGXc6dStypelxY2ZvX2Ntm2JtGnS48fB17G40aWNuWucxH6ny4mUvnPF27aPuHCEsGHV5czI3Lq52KGvzJqz1JmqyJOqzY6ew4OYwHiGs2OEsWHb29vL4LvM5bnD3q2+3KWkyoaLtWuKtmfOzs7IyMi21pyawXqPuG/g4ODX68fI4rTG4LCu0ZKszJKlx4qZwHuBnXR2iXENcZskAAAAXnRSTlMAEAIBCAsF6BUn+vPu7erjsZyBEwP99/TRk3JgRUQ1IxwO/v79/Pv6+fn09PPq08q7sqWDe2xrY01AMBj+/v7+/v37+fn59fXz8u/c1cbFxLWonZiIcm1lYVdSQT8de/EoFwAAAgVJREFUOMutklVz21AQRiNFlswYs+M6DTdN0kCDZWZmuAKDZFtgiO2YYm6TlOEHV53ptGs5j93Xc+a7e3d36P/W9prdZ/PZ17aPxphz3mR0x91G07wTG8TDo5R3HLGH3S6fGPdSo8Na/to6W2HZBEqwPCNULlu1BkFdQSyKx4qxOMoyDDJSRB/HnTcqWbSbTmVS6V3E57hvXicOBZd1gmfj6Z1kPrmTjrMMfRizumDA+k3UTcRSyWg0mkzFEgLNlU3rIIJcns0KqJjJq0I+U0SqUJlZJv8JugU3J/QnHEwu6MCMqPN1pq+H3sFxCgOC7RyT48Ev6qLUL/gmeJrJ/p0DzSnyxTtAGLMbv9dohv8zSbomSqUpOxB0AdNXsUbnGEEQmJzKq3JrLgCaJAzms5LI1enfVefEamc/YzYQYFB6/1xBUsQex3E9UZHkUvO6X48PwQjLTKEjVRVFqUqd8v6naQsMUCNcL8xTrVJZluXyl1K7OW1+7sL71x15cvVH43O7UGi3mmc8lkCE0ByMbvXazwueycbHxiXPrUdv3hLDGiF8au/d4sO7Novtnj9k0BO45uRGTp98f2JlK/RqYzN8TK8bGTjZLTXgfvDp6rMNA0ZADAOWHI6VTYwE4WAZjz/s3V5yvIxADosIPlh0BNXHSdA8LFIfDgE8WDg5hmmx9h/40fgXth2SDk3yjP4AAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABvFBMVEUAAAAAAAADAAAAAAAAAAACAAAAAAAAAAC5PznHVE8BAAAAAADbc27NXVeUDQaZDQaRBwAAAAAAAACHBgDuhoHVa2W9RD2QCAKYCAGPBgB0BQAAAAAAAACMBgAAAAADAAD2jonWb2n2jYjYbWfmeXPNzc3RYFqzODKfFA1RUVGKBgCVBwBvb2+WBwCBBgCFBgCWBwCLBgAAAAAAAACMBgCTBwByBQCTBwBbBACEBgAAAAAAAAAoAgBSBADgeHOoOzXmfnnofnjieHPGvr63t7e0tLTidW/ebmnba2XWZWDAT0qRHBfBSkRNTU2aFxGOBgBYTEsAAACNBgBAQEAAAABbBQAcHBxyBQBKBAAAAABfBAAAAAAAAAAsAgAkAgCJBgDZRT3MOTHQPDTVQjrlUkrjUEjRPjbOOjP/bGTvXFTqV0/fTETNOjL5Zl7eS0PzYFjxXlbiT0fUQTn0e3T7aGDWXFXbSEDTRj/PQTrOPjbb29vgamTxY1zoVE3STETTQjvSPzfOzs7IyMj5g3zzaWLXY13XYVrsXlbbU0zg4OD8lZD4gXq0eHXqd3HscWv2b2jrZmDQZWDdWVLkV1C5y9+5AAAAYHRSTlMAAgUBDggMEeDsIBj+8NHJxpxAEP754tDDtIFsYDkvI/78+/j08/DfycfHxbuvr5mTjYN0bWxkWVZTTDUjEfz8+/n59fT08vHw8PDw5NzV0Mq5uLWrm5iLfX1hV0g/ODZEwKduAAACAklEQVQ4y62SVXPbQBzEa1mWZYaY49ihBhtmKjMzw92JLLBsyxxT2mCZvnCVmU59VpO37Ms97G929nb+p05WXUvTE5GJ6aWuY+yFEdoVdAZd9MjCEYi5J0L3FZutSqVZdIYiPWaj/85j2yszAACGVyq7Lo+RIMZtxRaQOZaTwZZSLbrGLR2+aX54twVykpgVpRzgYbVGz5twYMPTV2ZkKZMupDOSzAiwfNazgQesDO9VASemU6lUWuQAgnyNXsEiiBlbEwE2W9CBQpbVAfRraIZoA5ZosII6EpB6MYrVpLxOQejowKsBL9UGSK+zCnnsF4omB7wkBkQHylDZ+rcDROD3hYcYQE0NHQhQ4f8uCQVG/XF9isJKLtI1TYBQQAgdPlqJzYcWMYBYd58/YJACD6UgpsTVA+51AhvKGgt9zQGN1xN4Dajs/vbtmBXf2mIP3/jGqiW9Q0nlGtn8tXBSnwGPWHYP5PcbLMs2JHFn+6p7WQ/ARTie3/rZm9+pZ+rfP/fawi8dhOFgqLlLX87dHOz/1D9ou/vsrcNiNgBrZzbf338yOXZvbDL2xm4ljCdn6j794cpswr/62p+wWy2m/042oQeMxudedK8mSdzGAy4/9vlm/STRtjGRTz9u3nnge2U3+O2h4o9GfXG7lcLKGWZY8ycduG3sQJCk0Tb+w3S0/Qemc4+eJchuZgAAAABJRU5ErkJggg==",
c.id=a+"-img",c.style.cssText="display: block;position: absolute;z-index: 1;",s.appendChild(c),t.api.container.appendChild(s),s.addEventListener("click",function(){l.style.display="none"===l.style.display?"block":"none"});var d=32512,h=.6,f=new i.SphereGeometry(.01),p=new i.MeshPhongMaterial({color:d,ambient:d,opacity:h,transparent:!0}),m=new i.Mesh(f,p);return m.visible=!1,void 0===t.overlayScenes.annotation&&t.createOverlayScene("annotation"),t.addOverlay("annotation",m),m}var o=this;null===e&&(e=n.call(this,t,r.viewer,"hidden")),s.Animation.call(this,e,t,r),this.id=t.name,this.text="",this.state="hidden",this.epsilon=.1,this.viewer.api.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(t){o.updateText(e.position,o.text)})}r.r(t),r.d(t,"AnnotationAnimation",function(){return n});var i=r("./thirdparty/three.js/three.js"),o=(r.n(i),r("./src/animation/InterpolationType.js")),s=r("./src/animation/Animation.js");n.prototype=Object.create(s.Animation.prototype),n.prototype.constructor=n,n.prototype.keyTypes=["pos","text","vis"],n.prototype.defaultKey={pos:0,text:"",vis:1},n.prototype.stop=function(){s.Animation.prototype.stop.call(this),this.container.parentNode.removeChild(this.container),this.viewer.removeOverlay("annotation",this.root),this.root=null},n.prototype.updateText=function(e,t){function r(e,t,r){var n=e.clone(),o=new i.Matrix4;return t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),o.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),n.applyProjection(o),{x:(n.x+1)*r.width/2+r.offsetLeft-12,y:(-n.y+1)*r.height/2+r.offsetTop+12}}var n=r(e,this.viewer.camera,this.viewer.canvas),o=this.getDocument(),s=o.getElementById(this.id+"-txt");s&&(s.innerHTML=t,s.style.left=n.x+"px",s.style.top=n.y+"px",this.text=t),s=o.getElementById(this.id+"-img"),s&&(s.style.left=n.x+"px",s.style.top=n.y-24+"px")},n.prototype.update=function(){var e=[],t=new i.Vector3,r=new i.Vector3;return function(n){if(this.isPlaying!==!1&&(this.currentTime+=n*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){var i=this.getDocument();if(this.isPaused&&this.currentTime<this.startKeyTime){var a=i.getElementById(this.id);return void(a&&(a.style.visibility=this.state))}for(var l=0,c=this.hierarchy.length;c>l;l++){for(var u=this.hierarchy[l],d=u.animationCache[this.data.name],h=0;h<this.keyTypes.length;h++){var f=this.keyTypes[h],p=d.prevKey[f],m=d.nextKey[f];if(m.time<=this.currentTime||p.time>=this.currentTime){for(p=this.data.hierarchy[l].keys[0],m=this.getNextKeyWith(f,l,1);m.time<this.currentTime&&m.index>p.index;)p=m,m=this.getNextKeyWith(f,l,m.index+1);d.prevKey[f]=p,d.nextKey[f]=m}var g=p[f],v=m[f];if(m.time!==p.time&&void 0!==g&&void 0!==v){var y=(this.currentTime-p.time)/(m.time-p.time);if(0>y&&(y=0),y>1&&(y=1),"pos"===f){if(this.interpolationType===o.INTERPOLATION_TYPE.LINEAR)r.x=g[0]+(v[0]-g[0])*y,r.y=g[1]+(v[1]-g[1])*y,r.z=g[2]+(v[2]-g[2])*y,u.position.copy(r);else if(this.interpolationType===o.INTERPOLATION_TYPE.CATMULLROM||this.interpolationType===o.INTERPOLATION_TYPE.CATMULLROM_FORWARD){e[0]=this.getPrevKeyWith("pos",l,p.index-1).pos,e[1]=g,e[2]=v,e[3]=this.getNextKeyWith("pos",l,m.index+1).pos,y=.33*y+.33;var _=Object(s.interpolateCatmullRom)(e,y);if(r.x=_[0],r.y=_[1],r.z=_[2],u.position.copy(r),this.interpolationType===o.INTERPOLATION_TYPE.CATMULLROM_FORWARD){var b=Object(s.interpolateCatmullRom)(e,1.01*y);t.set(b[0],b[1],b[2]),t.sub(vector),t.y=0,t.normalize();var x=Math.atan2(t.x,t.z);u.rotation.set(0,x,0)}}}else if("text"===f){var w=Math.abs(this.currentTime-m.time)<this.epsilon?v:g;this.updateText(u.position,w)}else if("vis"===f){var a=i.getElementById(this.id);if(a){var E=Math.abs(this.currentTime-m.time)<this.epsilon?v:g;a.style.visibility=E?"visible":"hidden"}}}}u.matrixAutoUpdate=!0,u.matrixWorldNeedsUpdate=!0}}}}()},"./src/animation/type/CameraAnimation.js":function(e,t,r){"use strict";function n(e,t,r){s.Animation.call(this,e,t,r),this.followCam=!0}r.r(t),r.d(t,"CameraAnimation",function(){return n});var i=r("./thirdparty/three.js/three.js"),o=(r.n(i),r("./src/animation/InterpolationType.js")),s=r("./src/animation/Animation.js");n.prototype=Object.create(s.Animation.prototype),n.prototype.constructor=n,n.prototype.keyTypes=["pos","up","target","fov","perspective"],n.prototype.defaultKey={pos:0,up:0,target:0,fov:0,perspective:0},n.prototype.setFollowCamera=function(e){this.followCam=e},n.prototype.update=function(){var e=[],t=new i.Vector3,r=new i.Vector3;return function(n){if(this.isPlaying!==!1&&(this.currentTime+=n*this.timeScale,this.resetIfLooped(),this.followCam&&!this.isPlayingOutOfRange())){for(var i=0,a=this.hierarchy.length;a>i;i++){for(var l=this.hierarchy[i],c=l.animationCache[this.data.name],u=0;u<this.keyTypes.length;u++){var d=this.keyTypes[u],h=c.prevKey[d],f=c.nextKey[d];if(f.time<=this.currentTime||h.time>=this.currentTime){for(h=this.data.hierarchy[i].keys[0],f=this.getNextKeyWith(d,i,1);f.time<this.currentTime&&f.index>h.index;)h=f,f=this.getNextKeyWith(d,i,f.index+1);c.prevKey[d]=h,c.nextKey[d]=f}var p=h[d],m=f[d];if(f.time!==h.time&&void 0!==p&&void 0!==m){var g=(this.currentTime-h.time)/(f.time-h.time);0>g&&(g=0),g>1&&(g=1);var v;if("pos"===d)v=l.position;else if("up"===d)v=l.up;else if("target"===d)v=l.target;else{if("fov"===d){l.setFov(p+(m-p)*g);continue}if("perspective"===d){var y=g>.5?m:p;y?l.toPerspective():l.toOrthographic();continue}}if(this.interpolationType===o.INTERPOLATION_TYPE.LINEAR)r.x=p[0]+(m[0]-p[0])*g,r.y=p[1]+(m[1]-p[1])*g,r.z=p[2]+(m[2]-p[2])*g,v.copy(r);else{e[0]=this.getPrevKeyWith(d,i,h.index-1)[d],e[1]=p,e[2]=m,e[3]=this.getNextKeyWith(d,i,f.index+1)[d],g=.33*g+.33;var _=Object(s.interpolateCatmullRom)(e,g);if(r.x=_[0],r.y=_[1],r.z=_[2],v.copy(r),this.interpolationType===o.INTERPOLATION_TYPE.CATMULLROM_FORWARD){var b=Object(s.interpolateCatmullRom)(e,1.01*g);t.set(b[0],b[1],b[2]),t.sub(v),t.y=0,t.normalize();var x=Math.atan2(t.x,t.z);l.rotation.set(0,x,0)}}}}l.matrixAutoUpdate=!0,l.matrixWorldNeedsUpdate=!0}l.lookAt(l.target),this.animator.updateFlag|=this.animator.UPDATE_CAMERA}}}()},"./src/animation/type/MeshAnimation.js":function(e,t,r){"use strict";function n(e,t,r){s.Animation.call(this,e,t,r),this.localMatrix=new i.Matrix4,this.root.getAnimTransform(),this.relativeTransform=t.custom&&t.custom.transform&&"abs"===t.custom.transform?!1:!0}r.r(t),r.d(t,"MeshAnimation",function(){return n});var i=r("./thirdparty/three.js/three.js"),o=(r.n(i),r("./src/animation/InterpolationType.js")),s=r("./src/animation/Animation.js");n.prototype=Object.create(s.Animation.prototype),n.prototype.constructor=n,n.prototype.keyTypes=["pos","rot","scl"],n.prototype.defaultKey={pos:0,rot:0,scl:0},n.prototype.update=function(){var e=[],t=new i.Vector3,r=new i.Vector3,n=new i.Quaternion,a=new i.Matrix4,l=new i.Matrix4;return function(c){if(this.isPlaying!==!1&&(this.currentTime+=c*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var u=0,d=this.hierarchy.length;d>u;u++){for(var h=this.hierarchy[u],f=h.animationCache[this.data.name],p=0;p<this.keyTypes.length;p++){var m=this.keyTypes[p],g=f.prevKey[m],v=f.nextKey[m];if(v.time<=this.currentTime||g.time>=this.currentTime){for(g=this.data.hierarchy[u].keys[0],v=this.getNextKeyWith(m,u,1);v.time<this.currentTime&&v.index>g.index;)g=v,v=this.getNextKeyWith(m,u,v.index+1);f.prevKey[m]=g,f.nextKey[m]=v}var y=g[m],_=v[m];if(v.time!==g.time&&void 0!==y&&void 0!==_){var b=(this.currentTime-g.time)/(v.time-g.time);if(0>b&&(b=0),b>1&&(b=1),"pos"===m)if(this.interpolationType===o.INTERPOLATION_TYPE.LINEAR)r.x=y[0]+(_[0]-y[0])*b,r.y=y[1]+(_[1]-y[1])*b,r.z=y[2]+(_[2]-y[2])*b,h.position.copy(r);else{e[0]=this.getPrevKeyWith("pos",u,g.index-1).pos,e[1]=y,e[2]=_,e[3]=this.getNextKeyWith("pos",u,v.index+1).pos,b=.33*b+.33;var x=Object(s.interpolateCatmullRom)(e,b);if(r.x=x[0],r.y=x[1],r.z=x[2],h.position.copy(r),this.interpolationType===o.INTERPOLATION_TYPE.CATMULLROM_FORWARD){var w=Object(s.interpolateCatmullRom)(e,1.01*b);t.set(w[0],w[1],w[2]),t.sub(vector),t.y=0,t.normalize();var E=Math.atan2(t.x,t.z);h.rotation.set(0,E,0)}}else"rot"===m?(i.Quaternion.slerp(y,_,n,b),h.quaternion.copy(n)):"scl"===m&&(r.x=y[0]+(_[0]-y[0])*b,r.y=y[1]+(_[1]-y[1])*b,r.z=y[2]+(_[2]-y[2])*b,h.scale.copy(r))}}if(!this.relativeTransform){var S=a.compose(h.position,h.quaternion,h.scale),A=l;h.getOriginalWorldMatrix(A),A.getInverse(A);var M=a.multiplyMatrices(S,A);M.decompose(h.position,h.quaternion,h.scale)}h.updateAnimTransform()}}}()},"./src/animation/type/PolylineAnimation.js":function(e,t,r){"use strict";function n(e,t,r){this.viewer=r.viewer,null===e&&(e=this.createPolyline([])),o.Animation.call(this,e,t,r),this.epsilon=.1}r.r(t),r.d(t,"PolylineAnimation",function(){return n});var i=r("./thirdparty/three.js/three.js"),o=(r.n(i),r("./src/animation/Animation.js"));n.prototype=Object.create(o.Animation.prototype),n.prototype.constructor=n,n.prototype.keyTypes=["points","vis"],n.prototype.defaultKey={points:[],vis:1},n.prototype.stop=function(){o.Animation.prototype.stop.call(this),this.viewer.removeOverlay("polyline",this.root),this.root=null},n.prototype.update=function(){function e(e){e.root&&(e.viewer.removeOverlay("polyline",e.root),e.root=null)}return function(t){if(this.isPlaying!==!1&&(this.currentTime+=t*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){if(this.isPaused&&this.currentTime<this.startKeyTime)return void e(this);for(var r=0,n=this.hierarchy.length;n>r;r++)for(var o=this.hierarchy[r],s=o.animationCache[this.data.name],a=0;a<this.keyTypes.length;a++){var l=this.keyTypes[a],c=s.prevKey[l],u=s.nextKey[l];if(u.time<=this.currentTime||c.time>=this.currentTime){for(c=this.data.hierarchy[r].keys[0],u=this.getNextKeyWith(l,r,1);u.time<this.currentTime&&u.index>c.index;)c=u,u=this.getNextKeyWith(l,r,u.index+1);s.prevKey[l]=c,s.nextKey[l]=u}var d=c[l],h=u[l];if(u.time!==c.time&&void 0!==d&&void 0!==h){var f=(this.currentTime-c.time)/(u.time-c.time);if(0>f&&(f=0),f>1&&(f=1),"points"===l){var p=.5>f?d:h;this.viewer.removeOverlay("polyline",this.root),this.root=null;for(var m=[],g=0;g<p.length;g++){var v=p[g].slice();if(0===g)v[0]=d[g][0]+(h[g][0]-d[g][0])*f,v[1]=d[g][1]+(h[g][1]-d[g][1])*f,v[2]=d[g][2]+(h[g][2]-d[g][2])*f;else if(g===p.length-1){var y=d.length-1,_=h.length-1;v[0]=d[y][0]+(h[_][0]-d[y][0])*f,v[1]=d[y][1]+(h[_][1]-d[y][1])*f,v[2]=d[y][2]+(h[_][2]-d[y][2])*f}var b=new i.Vector3(v[0],v[1],v[2]);m.push(b)}this.root=this.createPolyline(m)}else if("vis"===l){var x=Math.abs(this.currentTime-u.time)<this.epsilon?h:d;this.root.visible=x,x||e(this)}}}}}}(),n.prototype.createPolyline=function(e){for(var t=new i.Geometry,r=0;r<e.length;r++)t.vertices.push(e[r]);t.computeLineDistances();var n=new i.LineDashedMaterial({color:0,dashSize:1,gapSize:.5,linewidth:1}),o=new i.Line(t,n,i.LineStrip);return void 0===this.viewer.overlayScenes.polyline&&this.viewer.createOverlayScene("polyline"),this.viewer.addOverlay("polyline",o),o}},"./src/animation/type/VisibilityAnimation.js":function(e,t,r){"use strict";function n(e,t,r){var n=this;i.Animation.call(this,{},e,r),this.fragPointers=[];var o;this.nodeChildren=[],this.nodeFragments=[];var s=this.viewer.model.getData().instanceTree;s.enumNodeChildren(t,function(e){n.nodeChildren.push(e)},!0),s.enumNodeFragments(e.id,function(e){n.nodeFragments.push(e),o=n.viewer.getFragmentProxy(n.viewer.model,e),o&&(n.fragPointers.push(o),o.setMaterial(n.viewer.matman().cloneMaterial(o.getMaterial(),n.viewer.model)))},!0),this.nodeId=t,this.epsilon=.1}r.r(t),r.d(t,"VisibilityAnimation",function(){return n});var i=r("./src/animation/Animation.js");n.prototype=Object.create(i.Animation.prototype),n.prototype.constructor=n,n.prototype.keyTypes=["vis","opa"],n.prototype.defaultKey={viz:1,opa:1},n.prototype.getPrevAndNextKeys=function(e,t){for(var r=this.data.hierarchy[e].keys[0],n=this.getNextKeyWith(t,e,1);n.time<this.currentTime&&n.index>r.index;)r=n,n=this.getNextKeyWith(t,e,n.index+1);return{prevKey:r,nextKey:n}},n.prototype.update=function(){return function(e){if(this.isPlaying!==!1&&(this.currentTime+=e*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var t=0,r=this.hierarchy.length;r>t;t++){var n=this.hierarchy[t],i=n.animationCache[this.data.name],o=i.prevKey.vis,s=i.prevKey.vis,a=i.prevKey.opa,l=i.prevKey.opa;if(s.time<=this.currentTime||o.time>=this.currentTime){var c=this.getPrevAndNextKeys(t,"vis"),u=c.prevKey,d=c.nextKey;o=u,s=d,i.prevKey.vis=o,i.nextKey.vis=s}if(l.time<=this.currentTime||a.time>=this.currentTime){var h=this.getPrevAndNextKeys(t,"opa"),f=h.prevKey,p=h.nextKey;a=f,l=p,i.prevKey.opa=a,i.nextKey.opa=l}var m=o.vis,g=s.vis;if(void 0!==m&&void 0!==g&&o.time!==s.time){var v=Math.abs(this.currentTime-s.time)<this.epsilon,y=v?g:m;this.viewer.visibilityManager.setNodeOff(this.nodeId,!y,this.viewer.model,this.nodeChildren,this.nodeFragments)}if(m=a.opa,g=l.opa,void 0===m&&1===o.vis&&(m=1),void 0!==m&&void 0!==g&&a.time!==l.time){var _=(this.currentTime-a.time)/(l.time-a.time);0>_&&(_=0),_>1&&(_=1);for(var b=m+(g-m)*_,x=0;x<this.fragPointers.length;++x){var w=this.fragPointers[x].getMaterial();w.transparent=1!==b,w.opacity=b}b>0&&this.viewer.visibilityManager.setNodeOff(this.nodeId,!1,this.viewer.model,this.nodeChildren,this.nodeFragments)}}}}()},"./src/application/AggregatedView.js":function(e,t,r){"use strict";function n(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){function s(e){n(l,i,o,s,a,"next",e)}function a(e){n(l,i,o,s,a,"throw",e)}var l=e.apply(t,r);s(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}r.r(t),r.d(t,"AggregatedView",function(){return E});var l=r("./src/globals.js"),c=r("./src/compat.js"),u=Autodesk.Viewing,d=u.Private,h={BimWalk:"Autodesk.BimWalk",Bookmarks:"Autodesk.AEC.CanvasBookmarkExtension",Levels:"Autodesk.AEC.LevelsExtension",CrossFade:"Autodesk.CrossFadeEffects",Hyperlinks:"Autodesk.AEC.HyperlinkExtension",Minimap:"Autodesk.AEC.Minimap3DExtension",DropMe:"Autodesk.AEC.DropMeExtension",ZoomWindow:"Autodesk.Viewing.ZoomWindow",FusionOrbit:"Autodesk.Viewing.FusionOrbit",DiffTool:"Autodesk.DiffTool",ModelStructure:"Autodesk.ModelStructure"},f=function(e){return e instanceof u.BubbleNode?e.getModelKey():e instanceof u.Model?e.getDocumentNode().getModelKey():"string"==typeof e?e:void 0},p=function(e){return{model:null,node:e,visible:!1,url:null,loading:!1,error:!1}},m=function(e){var t=e.getData(),r=t.loadOptions.bubbleNode,n=e.is3d()&&t.metadata.stats&&!t.metadata.stats.num_fragments;if(n){r.name(),r.getRootNode().children[0].name()}},g=function(e){return isFinite(e.x)&&isFinite(e.y)&&isFinite(e.z)},v=function(e){return g(e.min)&&g(e.max)},y=function(e){var t=e.getUpVector();return t&&(new THREE.Vector3).fromArray(t)},_=function(e){return g(e.position)&&g(e.target)&&g(e.up)&&isFinite(e.orthoScale)},b=function(e,t,r){for(var n=0,i=0;i<e.length;i++){var o=e[i],s=o.getBoundingBox();if(r.intersectsBox(s)!==Autodesk.Viewing.Private.FrustumIntersector.OUTSIDE){var a=s.size().length,l=s.distanceToPoint(t);l>50*a||n++}}return n},x=function(e){var t=e.getVisibleModels();t=t.filter(function(e){return v(e.getBoundingBox())});for(var r=e.impl.camera.clone(),n=new Autodesk.Viewing.Private.FrustumIntersector,i=void 0,o=void 0,s=void 0,a=0;a<t.length;a++){var l=t[a];i||(i=y(l));var c=l.getDefaultCamera();if(c&&_(c)){var u=l.getBoundingBox();r.position.copy(c.position),r.target.copy(c.target),r.up.copy(c.up),r.isPerspective=c.isPerspective,r.near=u.distanceToPoint(r.position),r.far=r.near+u.size().length,r.updateMatrixWorld(),r.updateProjectionMatrix(),r.matrixWorldInverse.getInverse(r.matrixWorld),n.reset(r);var d=b(t,c.position,n);(!o||d>=s)&&(o=c,s=d)}}o&&(o.pivot=o.target,o.worlup=i,o.fov=45,e.autocam.setHomeViewFrom(o))},w=function(){function e(t){o(this,e),this.color=t,this.enabled=!0,this.active=!1}return a(e,[{key:"setEnabled",value:function(e,t){t!==this.enabled&&(this.enabled=t,this.active&&!t?(e.clearThemingColors(),this.active=!1):this.update(e))}},{key:"update",value:function(e){if(!this.active&&this.enabled){for(var t=e.myData.fragments.fragId2dbId,r=0;r<t.length;r++){var n=t[r];e.setThemingColor(n,this.color)}this.active=!0}}}]),e}(),E=function(){function e(){o(this,e),this.globalOffset=void 0,this.refPoint=void 0,this.modelItems={},this.resetOnNextModelAdd=!0,this.memTracker=null,this.cameraInitialized=!1,this.is3D=void 0,this.pendingCamera=null,this.extensionLoaded={},this.loadersInProgress={},this.diff={enabled:!1,diffBubble:void 0,primaryBubble:void 0,diffBubbleLabel:void 0,primaryBubbleLabel:void 0,progressCallback:void 0,refNames:void 0},this.modelIsGhosted={},this.diffCache=[],this.onDiffDone=void 0,this.waitForFirstModel=!1,this.loadPendingPromises={},this.onLoad=[],this.onUnload=[],this.modelThemingStates={}}return a(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initViewerInstance(e,t),this.memTracker=new u.ModelMemoryTracker(this.viewer,t.memoryLimit),this.viewer.impl.showTransparencyWhenMoving(),this.options=t,this._registerLmvEventListeners(),this._loadExtensions()}},{key:"initViewerInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.viewerClass||(t.headlessViewer?u.Viewer3D:u.GuiViewer3D),n=t.viewerConfig||{};n.disabledExtensions=n.disabledExtensions||{},n.disabledExtensions.hyperlink=!0,t.multiViewerFactory?this.viewer=t.multiViewerFactory.createViewer(e,t.viewerConfig,r):this.viewer=new r(e,t.viewerConfig),this.viewer.start(void 0,void 0,void 0,void 0,t.viewerStartOptions)}},{key:"_onError",value:function(){var e;(e=console).error.apply(e,arguments)}},{key:"reset",value:function(){this.hideAll(),this.pendingCamera=null,this.cameraInitialized=!1,this.resetOnNextModelAdd=!0,this._stopActiveTools(),this._unloadDiffTool(!0),this.refPoint=void 0,this.loadersInProgress={}}},{key:"getModel",value:function(e){var t=this._getItem(e);return t&&t.model}},{key:"getModelAndWait",value:function(e){var t=this;return new Promise(function(r){var n=function o(){var n=t.getModel(e);return n?(t.viewer.removeEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,o),t.onLoad.splice(t.onLoad.indexOf(o),1),r(n)):void 0},i=t.getModel(e);return i?r(i):(t.viewer.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,n),void t.onLoad.push(n))})}},{key:"isEmpty",value:function(){return!this.getVisibleNodes().length}},{key:"show",value:function(e,t){var r=this.isEmpty();r&&this._initForFirstViewable(e);var n,i=e.getModelKey(),o=this.getModel(i);return o?(this._showModel(o),n=Promise.resolve(o)):n=this.load(e,t),this.modelItems[i].visible=!0,this._updateModelTimestamps(),this._consolidateVisibleModels(),n}},{key:"hide",value:function(e){var t=this._getItem(e);t&&(!this.options.unloadUnfinishedModels||t.model&&t.model.isLoadDone()?t.model&&(this.viewer.hideModel(t.model.id),x(this.viewer)):(this.unload(t.node),x(this.viewer)),t.visible=!1,this._cleanupModels())}},{key:"isVisible",value:function(e){var t=this._getItem(e);return t&&t.visible}},{key:"hideAll",value:function(){for(var e in this.modelItems)this.hide(e)}},{key:"getVisibleNodes",value:function(){var e=[];for(var t in this.modelItems){var r=this.modelItems[t];r.visible&&e.push(r.node)}return e}},{key:"isOtgManifestMissing",value:function(e){if(e.is2D())return!1;var t=e.getOtgGraphicsNode();return t&&!t.error?!1:(t?this._onError("Otg translation failed for viewable '".concat(e.name(),"'. Error:"),t.error):this._onError("Otg node missing for viewable '".concat(e.name(),"'.")),this.onViewerNotification&&this.onViewerNotification("error","Model Translation failed for viewable: '".concat(e.name(),"'.")),!0)}},{key:"load",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!r&&this.options.getCustomLoadOptions&&(r=this.options.getCustomLoadOptions(e));var n=f(e),i=this.modelItems[n];if(i||(i=p(e),this.modelItems[n]=i),i.model)return Promise.resolve(i.model);if(i.loading||i.error)return Promise.reject("Model load was already triggered");if(e.is3D()){if(this.waitForFirstModel)return new Promise(function(e,r){t.loadPendingPromises[n]={resolve:e,reject:r}});this.options.ignoreGlobalOffset||this.globalOffset||(this.waitForFirstModel=!0)}if(i.loading=!0,this.options.disableSvf&&this.isOtgManifestMissing(e))return Promise.reject("OTG manifest missing");var o=e.getRootNode(),s=o.getDocument(),a={globalOffset:this.globalOffset,applyRefPoint:!0,isAEC:!0,bvhOptions:d.Consolidation.getDefaultBVHOptions(),useConsolidation:!1,loadAsHidden:!0,bubbleNode:e,disablePrecomputedNodeBoxes:!0,preserveView:!0,onFragmentListLoadProgress:function(){return t._updateDiffLoadProgress()},disable3DModelLayers:!0,keepCurrentModels:!0,headlessViewer:this.options.headlessViewer},l=this._onModelLoaded.bind(this),c=function(r){return t._onModelLoadFailed(e,r)};return r&&Object.assign(a,r),new Promise(function(r,n){t.viewer.loadDocumentNode(s,e,a).then(function(e){l(e),r(e)})["catch"](function(e){c(e),n(e)})})}},{key:"unloadUnderlayRaster",value:function(e){var t=this.viewer.getVisibleModels().concat(this.viewer.getHiddenModels()),r=t.find(function(t){var r=t.getDocumentNode();return r&&r.getDocument().getPath()===e.getDocument().getPath()&&r.guid()===e.guid()&&t.getData().underlayRaster});r&&this.viewer.unloadModel(r)}},{key:"unload",value:function(e){this.unloadUnderlayRaster(e),this.viewer.unloadDocumentNode(e);var t=this._getItem(e);t&&(t.loading&&this._onModelLoadEnded(t),t.model&&delete this.loadersInProgress[t.model.id]);var r=f(e);delete this.modelItems[r];var n=this.modelThemingStates[r];n&&(n.active=!1),this.onUnload.forEach(function(t){return t(e)})}},{key:"unloadAll",value:function(e){for(var t=Object.keys(this.modelItems).slice(),r=0;r<t.length;r++){var n=t[r],i=this.modelItems[n];(!e||e(i))&&this.unload(i.node)}}},{key:"setCameraGlobal",value:function(e){this.pendingCamera={position:e.position&&(new THREE.Vector3).copy(e.position),target:e.target&&(new THREE.Vector3).copy(e.target),up:e.up&&(new THREE.Vector3).copy(e.up),fov:e.fov,isPerspective:e.isPerspective},this._applyPendingCameraWhenReady()}},{key:"setCamera",value:function(e){this.viewer.impl.setViewFromCamera(e,!0),this.cameraInitialized=!0}},{key:"startBimWalk",value:function(){this.bimWalkStartPending=!0,this._startBimWalkWhenReady()}},{key:"stopBimWalk",value:function(){var e=this.viewer.getExtension(h.BimWalk);e&&e.isActive()&&e.deactivate(),this.bimWalkStartPending=!1}},{key:"isBimWalkActive",value:function(){var e=this.viewer.getExtension("Autodesk.BimWalk");return e&&e.activeStatus||this.bimWalkStartPending}},{key:"switchView",value:function(e,t){this.reset(),this.setNodes(e,t)}},{key:"setNodes",value:function(e,t){var r=this;e=e||[],e=e instanceof u.BubbleNode?[e]:e;var n=function(e){return!r.isVisible(e)},i=e.filter(n),o={};e.forEach(function(e){o[e.getModelKey()]=!0});var s=function(e){return void 0===o[e.getModelKey()]},a=this.getVisibleNodes().filter(s);a.forEach(function(e){r.hide(e)}),i.forEach(function(e){r.show(e)}),this._setDiff(t)}},{key:"getFloorSelector",value:function(){return this.levelsExtension&&this.levelsExtension.floorSelector}},{key:"setBookmarks",value:function(e){this.bookmarks=e,this._updateBookmarks()}},{key:"isLoadDone",value:function(){for(var e in this.modelItems){var t=this.modelItems[e],r=t&&t.model,n=!r&&!t.error,i=r&&!r.isLoadDone(),o=r&&r.getPropertyDb()&&!r.getPropertyDb().isLoadDone(),s=d.TextureLoader.requestsInProgress()>0;if(n||i||o||s)return!1}return!0}},{key:"waitForLoadDone",value:function(){var e=this;return new Promise(function(t){e.isLoadDone()&&t();var r=function n(){e.isLoadDone()&&(e.viewer.removeEventListener(u.GEOMETRY_LOADED_EVENT,n),e.viewer.removeEventListener(u.OBJECT_TREE_CREATED_EVENT,n),e.viewer.removeEventListener(u.TEXTURES_LOADED_EVENT,n),e.onUnload.splice(e.onUnload.indexOf(n),1),t())};e.viewer.addEventListener(u.GEOMETRY_LOADED_EVENT,r),e.viewer.addEventListener(u.OBJECT_TREE_CREATED_EVENT,r),e.viewer.addEventListener(u.TEXTURES_LOADED_EVENT,r),e.onUnload.push(r)})}},{key:"_setDiff",value:function(e){e?(this.diff.diffBubbles=e.diffBubbles,this.diff.primaryBubbles=e.primaryBubbles,this.diff.diffBubbleLabel=e.diffBubbleLabel,this.diff.primaryBubbleLabel=e.primaryBubbleLabel,this.diff.progressCallback=e.progressCallback,this.diff.supportBubbles=e.supportBubbles,this.diff.empty=e.empty,this.diff.refNames=e.refNames,e.supportBubbles&&(this.load(e.supportBubbles.primary),this.load(e.supportBubbles.diff)),!e.empty&&e.progressCallback&&this._signalDiffLoadProgress(0,!0),this.diffStartTime=performance.now()):(this.diff.diffBubbles=void 0,this.diff.primaryBubbles=void 0,this.diff.diffBubbleLabel=void 0,this.diff.primaryBubbleLabel=void 0,this.diff.progressCallback=void 0,this.diff.supportBubbles=void 0,this.diff.refNames=void 0),this.diff.enabled=Boolean(e),this.diffNeedsUpdate=!0,this._updateDiff()}},{key:"_showModel",value:function(e){if(!e.is3d()||e.hasGeometry()){var t=!0;this.viewer.showModel(e.id,t),x(this.viewer)}else{e.getDocumentNode().getRootNode().children[0].name()}}},{key:"_onModelAdded",value:function(e){var t=this,r=e.model;if(this.cameraInitialized||this._initCamera(r),!r.getData().underlayRaster){this.resetOnNextModelAdd&&(this.viewer.getExtension(h.ZoomWindow)&&this.viewer.unloadExtension(h.ZoomWindow),this.resetOnNextModelAdd=!1,this.options.headlessViewer||this.viewer.createUI(r),this.viewer.activateDefaultNavigationTools(!this.is3D),this._loadExtension(h.ZoomWindow)["catch"](function(e){return t._onError(e)}),this._startBimWalkWhenReady()),m(r);var n=e.model.getDocumentNode();if(n){var i=n.getModelKey();delete this.modelIsGhosted[i],this._updateGhosting()}}}},{key:"_onGeometryLoaded",value:function(e){this._consolidateVisibleModels(),this._updateDiff(),this.loadersInProgress[e.model.id]=100}},{key:"_onExtensionLoaded",value:function(e){var t=e.extensionId;this._startBimWalkWhenReady(),t===h.Levels&&(this.levelsExtension=this.viewer.getExtension(h.Levels)),t===h.Bookmarks&&this._updateBookmarks()}},{key:"_registerLmvEventListeners",value:function(){this.viewer.addEventListener(u.GEOMETRY_LOADED_EVENT,this._onGeometryLoaded.bind(this)),this.viewer.addEventListener(u.MODEL_ADDED_EVENT,this._onModelAdded.bind(this)),this.viewer.addEventListener(u.EXTENSION_LOADED_EVENT,this._onExtensionLoaded.bind(this)),this.viewer.addEventListener(u.PROGRESS_UPDATE_EVENT,this._onProgressUpdate.bind(this)),this.viewer.addEventListener(u.MODEL_ROOT_LOADED_EVENT,this._updateDiff.bind(this))}},{key:"_consolidateVisibleModels",value:function(){if(this._cleanupModels(),!Object(c.isMobileDevice)()){var e=Object(l.getParameterByName)("useConsolidation");if("false"!==e)for(var t=this.viewer.getVisibleModels(),r=0;r<t.length;r++){var n=t[r];if(this.memTracker.memoryExceeded())return;var i=n&&n.isLoadDone();if(!i)return;if(n.is2d())return;if(!n.isConsolidated()){var o=this.viewer.impl.glrenderer(),s=this.viewer.impl.getMaterials();n.consolidate(s,void 0,o,!0),this._cleanupModels()}}}}},{key:"_cleanupModels",value:function(){var e=this;this._updateModelTimestamps();var t=function(t){var r=t.getDocumentNode(),n=e._getItem(r);n&&n.visible||e.unload(r)};this.memTracker.cleanup(t)}},{key:"_updateModelTimestamps",value:function(){var e=this.viewer.getVisibleModels().slice(),t=this._getDiffSupportModels();this.diff.enabled&&t&&(t.diff&&e.push(t.diff),t.primary&&e.push(t.primary)),this.memTracker.updateModelTimestamps(e)}},{key:"_stopActiveTools",value:function(){var e=this.viewer.getExtension("Autodesk.Section");e&&e.isActive()&&e.enableSectionTool(!1),this.stopBimWalk();var t=!this.options.headlessViewer&&this.viewer.getPropertyPanel(!1);t&&t.isVisible()&&t.setVisible(!1)}},{key:"_onModelLoaded",value:function(e){var t=this._getItem(e);t&&(e.is3d()&&this.waitForFirstModel&&!this.options.ignoreGlobalOffset&&(this.globalOffset=(new THREE.Vector3).copy(e.myData.globalOffset),this._onGlobalOffsetChanged()),t.model=e,t.visible&&this._showModel(t.model),this._updateModelTimestamps(),this._updateDiffLoadProgress(),this._updateModelTheming(e),this._onModelLoadEnded(t))}},{key:"_onModelLoadFailed",value:function(e,t){this._onError("Failed to load model: ".concat(e.name(),". Error code: ").concat(t));var r=this._getItem(e);r&&(r.error=!0,this._onModelLoadEnded(r))}},{key:"_onModelLoadEnded",value:function(e){var t=this;e.loading=!1;var r=e.node;if(r.is3D()&&this.waitForFirstModel){this.waitForFirstModel=!1;var n=function(e){var r=t.modelItems[e].node,n=t.loadPendingPromises[e]||{},i=n.resolve,o=n.reject;t.load(r).then(function(e){i&&i(e)})["catch"](function(e){o&&o(e)})};for(var i in this.modelItems)n(i);this.loadPendingPromises={}}this.onLoad.forEach(function(e){return e(r)})}},{key:"_initCamera",value:function(e,t){this.viewer.impl.setViewFromFile(e,!t),this.viewer.impl.controls.recordHomeView(),this.cameraInitialized=!0,this.pendingCamera&&this._applyPendingCameraWhenReady()}},{key:"_getItem",value:function(e){var t=f(e);return this.modelItems[t]}},{key:"_updateRefPoint",value:function(e){var t=this.isEmpty();if(t&&e.is3D()&&!this.options.ignoreGlobalOffset){var r=e.getAecModelData();if(r){var n=r&&r.refPointTransformation;this.refPoint=n?{x:n[9],y:n[10],z:0}:{x:0,y:0,z:0};var i=4e6,o=this.globalOffset&&THREE.Vector3.prototype.distanceToSquared.call(this.refPoint,this.globalOffset);(!this.globalOffset||o>i)&&(this.globalOffset=(new THREE.Vector3).copy(this.refPoint),this.unloadAll(function(e){return e.model&&e.model.is3d()}),this._onGlobalOffsetChanged())}}}},{key:"_onGlobalOffsetChanged",value:function(){var e=this.viewer.getExtension(h.Bookmarks);e&&e.resetGlobalOffset(this.globalOffset)}},{key:"_getDefaultExtensions",value:function(){var e=this;return[{name:h.CrossFade,getLoadingCondition:function(){return!u.isMobileDevice()}},{name:h.Levels,getOptions:function(){return e.viewer.config}},{name:h.ModelStructure,getOptions:function(){return e.viewer.config}},{name:h.Hyperlinks,getOptions:function(){return{loadViewableCb:function(t,r){e.onHyperlink?e.onHyperlink(t,r):e.switchView([t])}}}},{name:h.Minimap,getLoadingCondition:function(){return!e.options.disableMinimap},getOptions:function(){return{trackUsage:e._trackMinimapUsage?e._trackMinimapUsage.bind(e):void 0}}},{name:h.Bookmarks,getLoadingCondition:function(){return e.is3D},getOptions:function(){return{globalOffset:e.globalOffset,onBookmark:function(t,r){e.onBookmark?e.onBookmark(t,r):e.switchView([t]),r.isPerspective&&e.startBimWalk()},clusterfck:e.options.clusterfck,clusteringThreshold:110}}},{name:h.DropMe,getLoadingCondition:function(){return e.is3D===!1},getOptions:function(){return{enableGuidance:!0,onDrop:e._handleDropMe.bind(e)}}}]}},{key:"_loadExtensions",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return this.extensions=this.options.extensions||this._getDefaultExtensions(),e=[],this.extensions.forEach(function(r){(!r.getLoadingCondition||r.getLoadingCondition(t))&&(e.push(t._loadExtension(r.name,r.getOptions&&r.getOptions(t),r.onLoadedCB)),t.extensionLoaded[r.name]=!0)}),r.abrupt("return",Promise.all(e));case 4:case"end":return r.stop()}},r,this)}));return e}()},{key:"_loadExtension",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(e,t,n){var i,o,s,a,l=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=this.options.extensionOptions,o=i&&i[e],s=Object.assign({},t,o),a=this.viewer.loadExtension(e,s),
n&&a.then(function(e){n(l,e)})["catch"](function(e){n(l,null,e)}),r.abrupt("return",a);case 6:case"end":return r.stop()}},r,this)}));return e}()},{key:"_updateExtensions",value:function(e){var t=this,r=function(e,r,n,i,o){var s=t.extensionLoaded[e];!s&&n?t._loadExtension(e,r,i)["catch"](function(e){return t._onError(e)}):s&&!n&&(o&&o(t),t.viewer.unloadExtension(e)),t.extensionLoaded[e]=n};this.extensions.forEach(function(n){n.getLoadingCondition&&r(n.name,n.getOptions&&n.getOptions(t),n.getLoadingCondition(t,e),n.onLoadedCB,n.onBeforeUnloadCB)})}},{key:"_initForFirstViewable",value:function(e){var t=this.is3D!==e.is3D();t&&(this.resetOnNextModelAdd||this.reset(),this.is3D=e.is3D()),this._updateExtensions(e),this._updateRefPoint(e)}},{key:"_updateBookmarks",value:function(){var e=this.viewer.getExtension(h.Bookmarks);e&&e.resetBookmarks(this.bookmarks)}},{key:"_applyPendingCameraWhenReady",value:function(){if(this.cameraInitialized){var e=this.pendingCamera;this.pendingCamera=null;var t=this.viewer.impl.camera;e.position&&t.position.copy(e.position),e.target&&t.target.copy(e.target),e.up&&t.up.copy(e.up),e.fov&&(t.fov=e.fov),void 0!==e.isPerspective&&(t.isPerspective=e.isPerspective);var r=this.globalOffset||this.viewer.model.getData().globalOffset;this.is3D&&!this.options.ignoreGlobalOffset&&(t.position.sub(r),t.target.sub(r)),this.viewer.impl.syncCamera()}}},{key:"_handleDropMe",value:function(e,t,r){function n(e){var t=e.impl.model,r=t&&t.getDocumentNode(),n=r&&r.getRootNode();if(n){var i=n&&n.search(u.BubbleNode.MODEL_NODE),o="08f99ae5-b8be-4f8d-881b-128675723c10",s=function(e){return e.parent&&e.parent.name()===o},a=i.filter(s);if(a[0])return a[0];var l=function(e){return"{3D}"==e.name},c=i.filter(l)[0];return c?c:i[0]}}if(this.onDrop)return void this.onDrop(e,t,r);var i=n(this.viewer);if(i&&(this.switchView(i),e&&t)){var o={position:e,target:e.clone().add(t),isPerspective:!0};this.setCameraGlobal(o)}}},{key:"_handleViewIn3D",value:function(e,t,r,n){var i={position:e,target:t,isPerspective:!0};this.setCameraGlobal(i),this.startBimWalk(),n&&n()}},{key:"_startBimWalkWhenReady",value:function(){if(this.bimWalkStartPending){var e=!this.resetOnNextModelAdd,t=this.viewer.getExtension(h.BimWalk),r=this.viewer.getExtension(h.FusionOrbit);e&&t&&r&&(t.activate(),this.bimWalkStartPending=!1)}}},{key:"_unloadDiffTool",value:function(e){var t=this.viewer.getExtension(h.DiffTool);t&&(e&&(this.diffCache.length=0),this.viewer.unloadExtension(h.DiffTool))}},{key:"_onProgressUpdate",value:function(e){e.model&&e.state===u.ProgressState.LOADING&&(this.loadersInProgress[e.model.id]=e.percent,this._updateDiffLoadProgress())}},{key:"_getDiffSupportModels",value:function(){var e=this.diff.supportBubbles;if(e)return{diff:this.getModel(this.diff.supportBubbles.diff),primary:this.getModel(this.diff.supportBubbles.primary)}}},{key:"_diffSupportModelsReady",value:function(){var e=this._getDiffSupportModels(),t=e.diff&&e.diff.isLoadDone(),r=e.primary&&e.primary.isLoadDone();return t&&r}},{key:"_updateGhosting",value:function(){var e={};this.diff.enabled&&this.diffBubbles&&(e=this.diffBubbles.forEach(function(t){return e[t.getModelKey()]}));for(var t in this.modelItems){var r=this.getModel(t);if(r){var n=this.diff.enabled&&!e[t],i=!!this.modelIsGhosted[t];n!=i&&(r.setAllVisibility(!n),n?this.modelIsGhosted[t]=!0:delete this.modelIsGhosted[t])}}}},{key:"getModels",value:function(e){var t=this;return e.map(function(e){return t.getModel(e)})}},{key:"setModelTheming",value:function(e){e=e||{};var t=this.modelThemingStates;this.modelThemingStates={};for(var r in e){var n=t[r],i=e[r],o=this.getModel(r);if(n){var s=!n.color.equals(i);s&&(n.color.copy(i),n.active=!1)}else n=new w(i);this.modelThemingStates[r]=n,o&&this._updateModelTheming(o)}for(var a in t){var l=t[a],c=!e[a],u=this.getModel(a);c&&l.active&&u&&this.viewer.clearThemingColors(u)}}},{key:"_signalDiffLoadProgress",value:function(e,t){if(t||e!==this._lastDiffLoadPercent){var r=u.i18n.t("Loading Model for Change Visualization");this.diff.progressCallback(e,r),this._lastDiffLoadPercent=e}}},{key:"_updateDiffLoadProgress",value:function(){var e=this;if(this.diffNeedsUpdate&&this.diff.enabled&&!this.diff.empty&&this.diff.progressCallback){var t=this.getModels(this.diff.diffBubbles),r=this.getModels(this.diff.primaryBubbles),n=t.concat(r),i=this._getDiffSupportModels();i&&n.push(i.diff,i.primary);var o=n.filter(Boolean).length,s=10;if(o<n.length){var a=Math.floor(s*o/n.length);return void this._signalDiffLoadProgress(a)}if(!this.is3D){var l=function(t,r){return t+(0|e.loadersInProgress[r.id])},c=n.reduce(l,0),u=100*n.length,d=s+Math.floor((100-s)*c/u);return void this._signalDiffLoadProgress(d)}var h=function(e,t){return e+t.getData().fragsLoadedNoGeom},f=function(e,t){return e+t.getData().metadata.stats.num_fragments},p=n.reduce(h,0),m=n.reduce(f,0),g=s+Math.floor((100-s)*p/m);this._signalDiffLoadProgress(g)}}},{key:"_updateDiff",value:function(){if(this.diffNeedsUpdate){if(this._updateGhosting(),this._updateDiffLoadProgress(),!this.diff.enabled)return this._unloadDiffTool(),void this._updateAllModelTheming();for(var e=this.getModels(this.diff.diffBubbles),t=this.getModels(this.diff.primaryBubbles),r=0;r<e.length;r++){var n=e[r],i=t[r],o=n instanceof u.Model&&(n.isOTG()||n.isLoadDone()),s=i instanceof u.Model&&(i.isOTG()||i.isLoadDone());if(!o||!s)return;if(!n.getPropertyDb()||!i.getPropertyDb())return}var a=void 0,l=!!this.diff.supportBubbles;if(l){if(!this._diffSupportModelsReady())return;a=this._getDiffSupportModels()}performance.now()-this.diffStartTime;this._updateAllModelTheming(),this._setDiffModels(e,t,a)}}},{key:"_setDiffModels",value:function(e,t,r){var n=this;if(this.diffNeedsUpdate=!1,!t.length)return void this._unloadDiffTool();var i=this.viewer.getExtension(h.DiffTool);if(i)i.replaceModels(e,t,r);else{var o={diffModels:e,primaryModels:t,supportModels:r,diffadp:!1,availableDiffModes:["overlay","sidebyside"],diffMode:"overlay",versionA:this.diff.primaryBubbleLabel,versionB:this.diff.diffBubbleLabel,refNames:this.diff.refNames,mimeType:"application/vnd.autodesk.revit",hotReload:!0,diffCache:this.diffCache,useSplitScreenExtension:!0,showDetailsSection:!0,progress:function(e,t){if(n.diff.progressCallback){if(t===Autodesk.DiffTool.DIFFTOOL_PROGRESS_STATES.LoadingPropDb)return void n.diff.progressCallback(e,u.i18n.t("Loading element properties"));100===e&&n.onDiffDone&&n.onDiffDone(),n.diff.progressCallback(e,u.i18n.t("Computing change visualization"))}},excludeFromDiff:function(e,t){return n.levelsExtension&&!n.levelsExtension.floorSelector.isVisible(e,t)},setNodesOff:function(e){var t=n.levelsExtension;t&&t.floorSelector._floorSelectorFilter.reApplyFilter(e)},hideModeSwitchButton:!0};this._loadExtension(h.DiffTool,o)["catch"](function(e){return n._onError(e)})}}},{key:"_updateModelTheming",value:function(e){var t=f(e),r=this.modelThemingStates[t];if(r){var n=this.viewer.getExtension(h.DiffTool),i=!n;r.setEnabled(e,i),r.update(e),this.viewer.impl.invalidate(!0)}}},{key:"_updateAllModelTheming",value:function(){for(var e in this.modelItems){var t=this.getModel(e);t&&this._updateModelTheming(t)}}}]),e}();E.ExtNames=h},"./src/application/CameraLS.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}r.r(t),r.d(t,"CameraLS",function(){return u});var s=r("./src/application/GlobalManagerMixin.js"),a=function(e){return isFinite(e.x)&&isFinite(e.y)&&isFinite(e.z)},l=function(e){var t=e.isPerspective||isFinite(e.orthoScale);return a(e.position)&&a(e.target)&&a(e.up)&&t},c=function(){function e(){n(this,e),this.cacheObj={}}return o(e,[{key:"setItem",value:function(e,t){this.cacheObj[e]=t}},{key:"getItem",value:function(e){return this.cacheObj[e]}}]),e}(),u=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useLocalStorage:!0};n(this,e),this.aggregatedView=t,this.options=r,this.key=void 0,this.options.useLocalStorage?this.cache=Autodesk.Viewing.Private.LocalStorage:this.cache=new c,this.unloadCb=this.saveCamera.bind(this),this.addWindowEventListener("beforeunload",this.unloadCb)}return o(e,[{key:"destroy",value:function(){this.unsetKey(),this.removeWindowEventListener("beforeunload",this.unloadCb)}},{key:"setKey",value:function(e){this.key=e}},{key:"unsetKey",value:function(){this.key=void 0}},{key:"saveCamera",value:function(){if(this.aggregatedView.cameraInitialized&&this.key){var e=this.aggregatedView.viewer.impl.camera,t=l(e);if(t){var r=this.aggregatedView.isBimWalkActive(),n=this.aggregatedView.is3D?this.aggregatedView.globalOffset:void 0;this.saveStartCamera(this.key,this.aggregatedView.viewer.impl.camera,r,n)}}}},{key:"saveStartCamera",value:function(e,t,r,n){var i=JSON.stringify({offset:n,position:t.position,target:t.target,up:t.up,orthoScale:t.orthoScale,isPerspective:t.isPerspective,fov:t.fov,startBimWalk:r});this.cache.setItem(e,i)}},{key:"clearItem",value:function(e){this.cache.setItem(e)}},{key:"loadCamera",value:function(){if(!this.key)return!1;var e=void 0;try{var t=this.cache.getItem(this.key);e=JSON.parse(t)}catch(r){}if(!(e&&e.position&&e.target&&e.up))return!1;var n=function(e){return new THREE.Vector3(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z))},i={position:n(e.position),target:n(e.target),up:n(e.up),isPerspective:Boolean(e.isPerspective),fov:parseFloat(e.fov)};if(e.orthoScale&&(i.orthoScale=parseFloat(e.orthoScale)),!l(i))return!1;var o=e.offset?n(e.offset):void 0;if(o){if(!a(o))return;i.position.add(o),i.target.add(o)}this.aggregatedView.setCameraGlobal(i),e.startBimWalk&&this.aggregatedView.startBimWalk()}}]),e}();s.GlobalManagerMixin.call(u.prototype)},"./src/application/Document.js":function(e,t,r){"use strict";function n(e,t,r){this.myPath=t,this.myData=e,e&&(this.docRoot=new i.BubbleNode(e),this.docRoot.setDocument(this)),this.myNumViews={},this.acmSessionId=r;var n=this;this.docRoot.traverse(function(e){if(e.isViewPreset()){var t=e.findParentGeom2Dor3D(),r=n.myNumViews[t.guid()]||0;n.myNumViews[t.guid()]=r+1}});var o=this.docRoot.findAllViewables();0===o.length&&c.logger.error("Document contains no viewables.")}r.r(t),r.d(t,"Document",function(){return n});var i=r("./src/application/bubble.js"),o=r("./src/file-loaders/net/ErrorCodes.js"),s=r("./src/file-loaders/net/endpoints.js"),a=r("./src/file-loaders/net/Xhr.js"),l=r("./src/compat.js"),c=r("./src/logger/Logger.js"),u=r("./src/envinit.js"),d=r("./src/globals.js"),h=Object(l.getGlobal)(),f=h;n.load=function(e,t,r,i){function l(e){s.endpoint.isOtgBackend()&&(f=f?e.urn+","+f:e.urn);var i=new n(e,m,f),a=i.getRoot().search({type:"geometry"}).length;if(a>0)p=i.getGlobalMessages(),t&&t(i,p);else if(r){p=i.getGlobalMessages();var l=o.ErrorCodes.BAD_DATA_NO_VIEWABLE_CONTENT,c="No viewable content";r(l,c,p)}}function c(e,t,n){if(401===e&&void 0===h.LMV_THIRD_PARTY_COOKIE)h.LMV_THIRD_PARTY_COOKIE=!1,Object(u.refreshRequestHeader)(u.token.accessToken),d();else if(r){var i="Error: "+e+" ("+t+")",s=Object(o.getErrorCode)(e);r(s,i,e,t,n)}}function d(){var e=!i||s.endpoint.isOtgBackend()&&!i["x-ads-acm-scopes"];f||e?a.ViewingService.getManifest(s.endpoint.initLoadContext(),m,l,c):(i.oauth2AccessToken||(i.oauth2AccessToken=u.token.accessToken),a.ViewingService.getACMSession(s.endpoint.getApiEndpoint(),i,function(e){f=e;var t={queryParams:f?"acmsession="+f:""};s.endpoint.setAcmSession(f),a.ViewingService.getManifest(s.endpoint.initLoadContext(t),m,l,c)},r))}var f,p,m=n.getDocumentPath(e);d()},n.getDocumentPath=function(e){if(-1===e.indexOf("urn:")){if(-1!==e.indexOf("://"))return e;var t=e;return"undefined"!=typeof window?(0!==t.indexOf("/")&&(t="/"+t),f.location.protocol+"//"+f.location.host+t):t}return e},n.requestThumbnailWithSecurity=function(e,t){var r=function(e){t(null,e)},n=function(){t("error",null)},i={responseType:"blob",skipAssetCallback:!0,size:e.width,guid:e.guid,acmsession:e.acmsession},o="urn:"+e.urn,l=void 0,c=Object(s.getEnv)();l=u.EnvironmentConfigurations[c].UPSTREAM,a.ViewingService.getThumbnail(s.endpoint.initLoadContext({endpoint:l}),o,r,n,i)},n.prototype.getAcmSessionId=function(e){return n.getAcmSessionId(e,this.acmSessionId)},n.getAcmSessionId=function(e,t){if(!e)return"";var r=e.indexOf("urn:adsk.fluent")>=0;return!r&&s.endpoint.isOtgBackend()?t.split(",")[1]||"":t},n.prototype.getFullPath=function(e){if(!e)return e;var t=e;if(Object(s.isOffline)())-1==t.indexOf(Object(s.getOfflineResourcePrefix)())&&(t=decodeURIComponent(Object(s.getOfflineResourcePrefix)())+t.substr(t.indexOf("/")));else if(0===e.indexOf("urn")){var r=0===e.indexOf("urn:adsk.fluent");if(!r&&s.endpoint.isOtgBackend()){var n=Object(s.getEnv)(),i=u.EnvironmentConfigurations[n];t=s.endpoint.getItemApi(i.UPSTREAM,e,i.UPSTREAM_API_DATA)}else t=s.endpoint.getItemApi(null,e),s.endpoint.ENDPOINT_API_MODEL_DERIVATIVE_V2===s.endpoint.getApiFlavor()&&(t=decodeURIComponent(t))}else 0===e.indexOf("$file$")&&(t=this.myPath.replace("/bubble.json","")+e.replace("$file$",""));return t},n.prototype.getThumbnailOptions=function(e,t,r){var n=t?t:200,i=r?r:200,o=e.urn||this.myData.urn;return{urn:o,width:n,height:i,guid:e.guid,acmsession:this.getAcmSessionId(o)}},n.prototype.getThumbnailPath=function(e,t,r){var n=this.getThumbnailOptions(e,t,r),i=s.endpoint.getThumbnailApi(null,n.urn)+"?width="+n.width+"&height="+n.height;n.guid&&(i+="&guid="+n.guid),n.acmsession&&(i+="&acmsession="+n.acmsession);var o=s.endpoint.getQueryParams();return o&&(i+="&"+o),i},n.prototype.getLeafletZipParams=function(e,t){for(var r,n,i=t.search({role:"leaflet-zip"},!1),o=0;o<i.length;o++){n={},r=i[o]._raw();var s=r.urn;n.urnZip=this.getFullPath(s),n.centralDirOffset=r.central_dir_offset,n.centralDirLength=r.central_dir_length,n.centralDirEntries=r.central_dir_entries,n.zipMaxLevel=r.max_level-e.levelOffset,n.loadFromZip=!!(n.urnZip&&n.centralDirOffset&&n.centralDirLength&&n.centralDirEntries),n.fileTable={},e.zips||(e.zips=[]),e.zips.push(n)}e.zips.sort(function(e,t){return e.zipMaxLevel-t.zipMaxLevel})},n.prototype.getLeafletParams=function(e,t,r){function n(e){for(var t=20,r=1,n=0,i=0;t>i;i++){if(r*=2,r>e)return n;n++}return c.logger.log("unexpected leaflet tileSize"),0}e.tileSize=r.tileSize?r.tileSize:512,e.texWidth=r.resolution[0],e.texHeight=r.resolution[1],e.paperWidth=r.paperWidth,e.paperHeight=r.paperHeight,e.paperUnits=r.paperUnits,e.urlPattern=r.urn,e.mime=r.mime,e.isLeaflet=!0,e.levelOffset=n(e.tileSize),this.getLeafletZipParams(e,t),e.loadFromZip=e.zips&&e.zips[0].loadFromZip,e.zips&&Object(s.isOffline)()&&Object(l.isMobileDevice)()&&(e.zips=e.zips.slice(0,1),e.maxLevel=e.zips[0].zipMaxLevel)},n.prototype.derivePdfUrnHack=function(e,t){var r=e.parent.children.slice();r.sort(function(e,t){return e._raw().order-t._raw().order});var n,o=75;n=r.length<=o?r[r.length-1]:r[74];var s=n.search(i.BubbleNode.GEOMETRY_F2D_NODE),a=s[0];if(a){var l=a.urn().indexOf("/"),c=a.urn().slice(0,l),u=e._raw().order,d=0|u%o,h=(0|u/o)+1,f=c+"/output/".concat(d,"/").concat(d,".pdf");return t.page=h,t.isPdf=!0,f}return null},n.prototype.getViewableUrn=function(e,t){var r;if(e instanceof i.BubbleNode)r=e;else{var n=this.docRoot.search(e);r=n.length>0?n[0]:new i.BubbleNode(e)}if(r.isGeometry()){if(r.is3D())return r.getViewableRootPath();if(r.is2D()){var o=1<<20,s=r.data.totalRasterPixels;"number"!=typeof s&&(s=1/0);var a=o>s,c="true"===Object(d.getParameterByName)("vectorPdf")||Object(l.getGlobal)().LMV_VECTOR_PDF||this.myData&&this.myData.isVectorPDF||!!r.data.isVectorPDF,u="false"===Object(d.getParameterByName)("vectorPdf")||Object(l.getGlobal)().LMV_RASTER_PDF;c?a=!0:u&&(a=!1);var h=r.search(i.BubbleNode.PDF_PAGE_NODE),f=r.search(i.BubbleNode.LEAFLET_NODE);if(a&&f.length>0&&t&&(this.getLeafletParams(t,r,f[0]._raw()),t.tempRasterPath=f[0].urn()),a&&h.length)return t.isPdf=!0,t.page=h[0].data.page||1,h[0].urn();if(f.length>0&&t){if(c){var p=this.derivePdfUrnHack(r,t);if(p)return p}return this.getLeafletParams(t,r,f[0]._raw()),f[0].urn()}var m=r.search(i.BubbleNode.IMAGE_NODE);if(m.length)return m[0].urn();var g=r.search(i.BubbleNode.GEOMETRY_F2D_NODE);if(g.length)return g[0].urn()}}else if(r.isViewPreset()){var v=this.getViewGeometry(r,!0);if(v)return this.getViewableUrn(v,t)}return""},n.prototype.getViewablePath=function(e,t){var r=this.getViewableUrn(e,t);return r?this.getFullPath(r):""},n.prototype.downloadAecModelData=function(e){var t=this.docRoot.findViewableParent(),r=t&&t.data.aec_model_data;if(r)return e&&e(r),Promise.resolve(r);var n=this.docRoot.search({role:"Autodesk.AEC.ModelData"}),i=n[0];if(!i)return e&&e(),Promise.resolve(null);var o={};this.acmSessionId&&(o.queryParams="acmsession="+this.acmSessionId);var l=i.getViewableRootPath(),c=this.getFullPath(l);return new Promise(function(t){var r=function(r){var n=i.findViewableParent();n.data.aec_model_data=r,e&&e(r),t(r)};a.ViewingService.getItem(s.endpoint.initLoadContext(o),c,function(e){return r(e)},function(){return r()},{responseType:"json"})})},n.getAecModelData=function(e){if(Array.isArray(e)){var t=new Map,r=e.map(function(e){var r=e.getDocument(),n=t.get(r);if(n)return n;var i=r.downloadAecModelData();return t[r]=i,i});return Promise.all(r)}var n=e.getDocument();return n.downloadAecModelData()},n.prototype.getRoot=function(){return this.docRoot},n.prototype.getPath=function(){return this.myPath},n.prototype.getViewGeometry=function(e){var t=e.findParentGeom2Dor3D();return t},n.prototype.getNumViews=function(e){var t=e.guid;return e instanceof i.BubbleNode&&(t=e.guid()),this.myNumViews[t]||0},n.prototype.getMessages=function(e,t){var r=[];if(!e)return r;for(var n=e;n&&(!t||n.parent);)n._raw().messages&&(r=r.concat(n._raw().messages)),n=n.parent;return r},n.prototype.getGlobalMessages=function(){var e=[],t=0,r=0;this.getRoot().traverse(function(n){var i=n._raw().messages||[],o=i.filter(function(e){return"error"===e.type});o.length>0&&(t+=1),"inprogress"===n._raw().status&&(r+=1),e=e.concat(i)});var n="translated";n=t>0?"failed":n,n=r>0?"processing":n;for(var i=e.length;i--;e[i].$translation=n);return e}},"./src/application/EventDispatcher.js":function(e,t,r){"use strict";r.r(t),r.d(t,"EventDispatcher",function(){return n});var n=function(){};n.prototype={constructor:n,apply:function(e){e.addEventListener=n.prototype.addEventListener,e.hasEventListener=n.prototype.hasEventListener,e.removeEventListener=n.prototype.removeEventListener,e.clearListeners=n.prototype.clearListeners,e.fireEvent=n.prototype.fireEvent,e.dispatchEvent=n.prototype.fireEvent,e.debugEvents=n.prototype.debugEvents},addEventListener:function(e,t,r){if(e){void 0===this.listeners&&(this.listeners={}),"undefined"==typeof this.listeners[e]&&(this.listeners[e]=[]);for(var n=r&&r.priority||0,i=this.listeners[e].length,o=this.listeners[e].length-1;o>=0&&n>this.listeners[e][o].priority;o--)i--;this.listeners[e].splice(i,0,{callbackFn:t,once:r?!!r.once:!1,priority:n})}},hasEventListener:function(e,t){if(!e)return!1;if(void 0===this.listeners)return!1;var r=this.listeners[e];if(!r||0===r.length)return!1;for(var n=0,i=r.length;i>n;++n)if(r[n].callbackFn===t)return!0;return!1},removeEventListener:function(e,t){if(e){if(void 0===this.listeners)return void(this.listeners={});var r=this.listeners[e];if(r)for(var n=0,i=r.length;i>n;++n)if(r[n].callbackFn===t){r.splice(n,1);break}}},clearListeners:function(){this.listeners=null},dispatchEvent:function(e){if(void 0===this.listeners)return void(this.listeners={});if("string"==typeof e&&(e={type:e}),!e.target)try{e.target=this}catch(t){}if(!e.type)throw new Error("event type unknown.");if(this._doDebug,Array.isArray(this.listeners[e.type])){for(var r=this.listeners[e.type].slice(),n=[],i=0,o=r.length;o>i;++i)r[i].callbackFn.call(this,e),r[i].once&&n.push(r[i].callbackFn);for(var s=0;s<n.length;++s)this.removeEventListener(e.type,n[s])}},debugEvents:function(e){this._doDebug=e}},n.prototype.fireEvent=n.prototype.dispatchEvent,"undefined"!=typeof Autodesk&&(Autodesk.Viewing.EventDispatcher=n)},"./src/application/EventTypes.js":function(e,t,r){"use strict";var n=e.exports;n.ESCAPE_EVENT="escape",n.PROGRESS_UPDATE_EVENT="progress",n.FULLSCREEN_MODE_EVENT="fullScreenMode",n.NAVIGATION_MODE_CHANGED_EVENT="navmode",n.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored",n.VIEWER_RESIZE_EVENT="viewerResize",n.VIEWER_INITIALIZED="viewerInitialized",n.VIEWER_UNINITIALIZED="viewerUninitialized",n.LOADER_LOAD_FILE_EVENT="loaderLoadFile",n.LOADER_LOAD_ERROR_EVENT="loaderLoadError",n.MODEL_ROOT_LOADED_EVENT="svfLoaded",n.GEOMETRY_LOADED_EVENT="geometryLoaded",n.TEXTURES_LOADED_EVENT="texturesLoaded",n.OBJECT_TREE_CREATED_EVENT="propertyDbLoaded",n.OBJECT_TREE_UNAVAILABLE_EVENT="propertyDbUnavailable",n.OBJECT_TREE_LOAD_PROGRESS_EVENT="propertyDbLoadProgress",n.MODEL_UNLOADED_EVENT="modelUnloaded",n.MODEL_ADDED_EVENT="modelAdded",n.MODEL_REMOVED_EVENT="modelRemoved",n.MODEL_LAYERS_LOADED_EVENT="modelLayersLoaded",n.MODEL_TRANSFORM_CHANGED_EVENT="modelTransformChanged",n.EXTENSION_LOADED_EVENT="extensionLoaded",n.EXTENSION_UNLOADED_EVENT="extensionUnloaded",n.SELECTION_CHANGED_EVENT="selection",n.AGGREGATE_SELECTION_CHANGED_EVENT="aggregateSelection",n.ISOLATE_EVENT="isolate",n.AGGREGATE_ISOLATION_CHANGED_EVENT="aggregateIsolation",n.HIDE_EVENT="hide",n.AGGREGATE_HIDDEN_CHANGED_EVENT="aggregateHidden",n.SHOW_EVENT="show",n.SHOW_PROPERTIES_EVENT="showProperties",n.SHOW_ALL_EVENT="showAll",n.CAMERA_CHANGE_EVENT="cameraChanged",n.EXPLODE_CHANGE_EVENT="explodeChanged",n.FIT_TO_VIEW_EVENT="fitToView",n.AGGREGATE_FIT_TO_VIEW_EVENT="aggregateFitToView",n.CUTPLANES_CHANGE_EVENT="cutplanesChanged",n.TOOL_CHANGE_EVENT="toolChanged",n.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged",n.FINAL_FRAME_RENDERED_CHANGED_EVENT="finalFrameRenderedChanged",n.RENDER_PRESENTED_EVENT="renderPresented",n.LAYER_VISIBILITY_CHANGED_EVENT="layerVisibility",n.PREF_CHANGED_EVENT="PrefChanged",n.PREF_RESET_EVENT="PrefReset",n.RESTORE_DEFAULT_SETTINGS_EVENT="restoreDefaultSettings",n.ANIMATION_READY_EVENT="animationReady",n.CAMERA_TRANSITION_COMPLETED="cameraTransitionCompleted",n.HYPERLINK_EVENT="hyperlink",n.HYPERLINK_NAVIGATE="hyperlink_navigate",n.LOAD_GEOMETRY_EVENT="load_geometry",n.LOAD_MISSING_GEOMETRY="loadMissingGeometry",n.WEBGL_CONTEXT_LOST_EVENT="webglcontextlost",n.CANCEL_LEAFLET_SCREENSHOT="cancelLeafletScreenshot",n.SET_VIEW_EVENT="setView",n.RENDER_FIRST_PIXEL="renderFirstPixel",n.PROFILE_CHANGE_EVENT="profileChanged",n.RENDER_SCENE_PART="renderScenePart",n.OBJECT_UNDER_MOUSE_CHANGED="hoverObjectChanged"},"./src/application/EventUtils.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e){var t=e.target&&e.target.ownerDocument;return t?t.defaultView||t.parentWindow:Object(a.getGlobal)()}r.r(t),r.d(t,"EventUtils",function(){return u});var a=r("./src/compat.js"),l=!1,c=!1,u=function(){function e(){n(this,e)}return o(e,null,[{key:"isRightClick",value:function(e){var t=s(e);if(!(e instanceof t.MouseEvent))return!1;var r=e.button;"buttons"in e&&(!c||1&e.buttons?2===r&&1&e.buttons&&(r=0,c=!0):(c=!1,r=0));var n=l?0:2;return r===n}},{key:"isMiddleClick",value:function(e){var t=s(e);return e instanceof t.MouseEvent?1===e.button:!1}},{key:"setUseLeftHandedInput",value:function(e){l=e}}]),e}();Autodesk.Viewing.isRightClick=u.isRightClick,Autodesk.Viewing.isMiddleClick=u.isMiddleClick},"./src/application/Extension.js":function(e,t,r){"use strict";r.r(t),r.d(t,"Extension",function(){return o});var n=r("./src/globalization/i18init.js"),i=r("./src/application/GlobalManagerMixin.js"),o=function(e,t){this.viewer=e,i.GlobalManagerMixin.call(this),this.setGlobalManager(e.globalManager),this.options=t||{},this.id="",this.modes=[],this.mode="",this.name="",this.activeStatus=!1};o.prototype.load=function(){return!0},o.prototype.unload=function(){return!0},o.prototype.activate=function(e){return!0},o.prototype.deactivate=function(){return!0},o.prototype.getName=function(){return this.name},o.prototype.getModes=function(){return this.modes},o.prototype.isActive=function(e){return e?this.activeStatus&&this.mode===e:this.activeStatus},o.prototype.getState=function(e){},o.prototype.restoreState=function(e,t){return!0},o.prototype.extendLocalization=function(e){return Object(n.extendLocalization)(e)},o.prototype.getCache=function(){this.viewer.extensionCache||(this.viewer.extensionCache={});var e=this.viewer.extensionCache[this.id];return e||(e=this.viewer.extensionCache[this.id]={}),e},o.prototype.onToolbarCreated=function(e){},"undefined"!=typeof Autodesk&&(Autodesk.Viewing.Extension=o)},"./src/application/ExtensionManager.js":function(e,t,r){"use strict";r.r(t),function(e){function n(e,t){return s(e)||o(e,t)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function o(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(l){i=!0,o=l}finally{try{n||null==a["return"]||a["return"]()}finally{if(i)throw o}}return r}}function s(e){return Array.isArray(e)?e:void 0}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}r.d(t,"theExtensionManager",function(){return p}),r.d(t,"ExtensionMixin",function(){return m});var u=r("./src/logger/Logger.js"),d=r("./src/resource-loader.js"),h=r("./src/application/EventTypes.js"),f=(r.n(h),function(){function e(){a(this,e),this.registeredExtensions=new Map}return c(e,[{key:"registerExtension",value:function(e,t){if(this.registeredExtensions.has(e)){var r=this.registeredExtensions.get(e);if(r.EXTENSION_CLASS)return!1;r.EXTENSION_CLASS=t}else this.registeredExtensions.set(e,{EXTENSION_CLASS:t});return!0}},{key:"getExtensionClass",value:function(e){return this.registeredExtensions.has(e)?this.registeredExtensions.get(e).EXTENSION_CLASS:null}},{key:"unregisterExtension",value:function(e){return this.registeredExtensions.has(e)?(this.registeredExtensions["delete"](e),!0):!1}},{key:"registerExternalExtension",value:function(e,t){return this.registeredExtensions.has(e)?!1:(this.registeredExtensions.set(e,{EXTENSION_CLASS:null,externalPathOrCallback:t}),!0)}},{key:"getExternalPath",value:function(e){return this.registeredExtensions.has(e)?this.registeredExtensions.get(e).externalPathOrCallback:null}},{key:"getRegisteredExtensions",value:function(){return Array.from(this.registeredExtensions).map(function(e){var t=n(e,2),r=t[0],i=t[1];return{id:r,inMemory:!!i.EXTENSION_CLASS,isAsync:!!i.externalPathOrCallback}})}},{key:"downloadExtension",value:function(e){if(!this.registeredExtensions.has(e))return Promise.reject("Extension not found: "+e+". Has it been registered(1)?");var t=this.registeredExtensions.get(e);if(!t.externalPathOrCallback)return Promise.reject("Extension not found: "+e+". Has it been registered(2)?");if(t.downloadPromise)return t.downloadPromise;var r;return r="string"==typeof t.externalPathOrCallback?d.theResourceLoader.loadScript(t.externalPathOrCallback,e):t.externalPathOrCallback(),t.downloadPromise=r.then(function(){if(delete t.downloadPromise,!t.EXTENSION_CLASS)throw new Error("Extension not found: "+e+". Has it been registered(3)?");return t.EXTENSION_CLASS}),t.downloadPromise}},{key:"popuplateOptions",value:function(e){this.registeredExtensions.forEach(function(t){t.EXTENSION_CLASS.populateDefaultOptions(e)})}},{key:"isDownloading",value:function(e){return this.registeredExtensions.has(e)?!!this.registeredExtensions.get(e).downloadPromise:!1}},{key:"isAvailable",value:function(e){return!!this.getExtensionClass(e)}}]),e}()),p=new f,m=function(){};m.prototype={loadExtension:function(e,t){var r=this;return this.loadedExtensions=this.loadedExtensions||{},p.isAvailable(e)?this.loadExtensionLocal(e,t):(this.loadExtensionPromises=this.loadExtensionPromises||{},e in this.loadExtensionPromises?this.loadExtensionPromises[e]:(this.loadExtensionPromises[e]=p.downloadExtension(e).then(function(){if(delete r.loadExtensionPromises[e],!r.loadedExtensions)return void u.logger.info("Abort loadExtension('".concat(e,"') - teardown in progress"));if(r.cancelledExtensions&&e in r.cancelledExtensions)throw delete r.cancelledExtensions[e],new Error("Abort loadExtension('".concat(e,"') - extension has been unloaded"));return r.loadExtensionLocal(e,t)}),this.loadExtensionPromises[e]))},getExtension:function(e,t){var r=this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e]:null;return r&&t&&t(r),r},unloadExtension:function(e){if(this.cancelledExtensions=this.cancelledExtensions||{},p.isDownloading(e))return this.cancelledExtensions[e]=!0,!1;var t=!1,r=this.getExtension(e);return r?(t=r.unload(),u.logger.info("Extension unloaded: "+e),delete this.loadedExtensions[e],this.dispatchEvent({type:h.EXTENSION_UNLOADED_EVENT,extensionId:e})):u.logger.warn("Extension not found: "+e),t},loadExtensionLocal:function(t,r){var n=this,i=p.getExtensionClass(t);if(!i)return Promise.reject("Extension not found : "+t);var o=this.getExtension(t);if(o)return Promise.resolve(o);if(this.loadingExtensions&&t in this.loadingExtensions)return this.loadingExtensions[t];o=new i(this,r),o.id=t;var s=o.load();if(!s)return Promise.reject("Extension failed to .load() : "+t);var a=function(){n.loadedExtensions[t]=o,n.onPostExtensionLoad(o),u.logger.info("Extension loaded: "+t),e(function(){n.getExtension(t)&&n.dispatchEvent({type:h.EXTENSION_LOADED_EVENT,extensionId:t})})};return s instanceof Promise?(this.loadingExtensions=this.loadingExtensions||{},this.loadingExtensions[t]=s.then(function(){return a(),o})["finally"](function(){delete n.loadingExtensions[t]}),this.loadingExtensions[t]):(a(),Promise.resolve(o))},onPostExtensionLoad:function(e){},forEachExtension:function(e){var t=this.loadedExtensions||{};for(var r in t)t.hasOwnProperty(r)&&e(t[r])},apply:function(e){var t=m.prototype;e.loadExtension=t.loadExtension,e.getExtension=t.getExtension,e.unloadExtension=t.unloadExtension,e.loadExtensionLocal=t.loadExtensionLocal,e.forEachExtension=t.forEachExtension,e.onPostExtensionLoad=t.onPostExtensionLoad}}}.call(this,r("./node_modules/timers-browserify/main.js").setImmediate)},"./src/application/FileLoader.js":function(e,t,r){"use strict";function n(e){this.viewer=e}r.r(t),r.d(t,"FileLoader",function(){return n}),n.prototype.constructor=n,n.prototype.loadFile=function(e,t,r,n){return!1},n.prototype.is3d=function(){return!1}},"./src/application/FileLoaderManager.js":function(e,t,r){"use strict";function n(e,t,r){return a[e]?!1:(a[e]={loader:r,extensions:t},!0)}function i(e){return a[e]?a[e].loader:null}function o(e){return a[e]?(delete a[e],!0):!1}function s(e){e=e?e.toLowerCase():"";for(var t in a){var r=a[t];if(r)for(var n=0;n<r.extensions.length;n++)if(r.extensions[n].toLowerCase()===e)return r.loader}return null}r.r(t),r.d(t,"FileLoaderManager",function(){return l});var a={},l={registerFileLoader:n,getFileLoader:i,getFileLoaderForExtension:s,unregisterFileLoader:o}},"./src/application/GlobalManager.js":function(e,t,r){"use strict";function n(e){return s(e)||o(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(e){return Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)?Array.from(e):void 0;
}function s(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function a(e,t){return u(e)||c(e,t)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function c(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(l){i=!0,o=l}finally{try{n||null==a["return"]||a["return"]()}finally{if(i)throw o}}return r}}function u(e){return Array.isArray(e)?e:void 0}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),e}function p(e){return!!e.opener}function m(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;n>o;o++)i[o-2]=arguments[o];p(this.inner)||(this.registeredEventListeners.has(e)?this.registeredEventListeners.get(e).set(t,i):this.registeredEventListeners.set(e,new Map([[t,i]]))),(r=this.inner).addEventListener.apply(r,[e,t].concat(i))}function g(e,t){var r;p(this.inner)||this.registeredEventListeners.has(e)&&this.registeredEventListeners.get(e).has(t)&&this.registeredEventListeners.get(e)["delete"](t);for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;n>o;o++)i[o-2]=arguments[o];(r=this.inner).removeEventListener.apply(r,[e,t].concat(i))}r.r(t),r.d(t,"GlobalManager",function(){return y});var v=Autodesk.Viewing,y=function(){function e(){d(this,e),this._window={inner:null,registeredEventListeners:new Map},this._document={inner:null,registeredEventListeners:new Map},this._window.inner=v.getGlobal(),this._document.inner=this._window.inner.document,this.addWindowEventListener=m.bind(this._window),this.removeWindowEventListener=g.bind(this._window),this.addDocumentEventListener=m.bind(this._document),this.removeDocumentEventListener=g.bind(this._document)}return f(e,[{key:"getWindow",value:function(){return this._window.inner}},{key:"getDocument",value:function(){return this._document.inner}},{key:"setWindow",value:function(e){if(e&&e!==this._window.inner){var t=!0,r=!1,i=void 0;try{for(var o,s=this._window.registeredEventListeners.entries()[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var l=a(o.value,2),c=l[0],u=l[1],d=!0,h=!1,f=void 0;try{for(var p,m=u.entries()[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var g,v=a(p.value,2),y=v[0],_=v[1];e.addEventListener.apply(e,[c,y].concat(n(_))),(g=this._window.inner).removeEventListener.apply(g,[c,y].concat(n(_)))}}catch(b){h=!0,f=b}finally{try{d||null==m["return"]||m["return"]()}finally{if(h)throw f}}}}catch(b){r=!0,i=b}finally{try{t||null==s["return"]||s["return"]()}finally{if(r)throw i}}var x=!0,w=!1,E=void 0;try{for(var S,A=this._document.registeredEventListeners.entries()[Symbol.iterator]();!(x=(S=A.next()).done);x=!0){var M=a(S.value,2),T=M[0],C=M[1],j=!0,P=!1,L=void 0;try{for(var D,I=C.entries()[Symbol.iterator]();!(j=(D=I.next()).done);j=!0){var R,O,k=a(D.value,2),N=k[0],F=k[1];(R=e.document).addEventListener.apply(R,[T,N].concat(n(F))),(O=this._document.inner).removeEventListener.apply(O,[T,N].concat(n(F)))}}catch(b){P=!0,L=b}finally{try{j||null==I["return"]||I["return"]()}finally{if(P)throw L}}}}catch(b){w=!0,E=b}finally{try{x||null==A["return"]||A["return"]()}finally{if(w)throw E}}this._window.inner=e,this._document.inner=e.document}}}]),e}()},"./src/application/GlobalManagerMixin.js":function(e,t,r){"use strict";function n(){this.globalManager=o,this.setGlobalManager=function(e){this.globalManager=e,this.onSetGlobalManager(this.globalManager)},this.onSetGlobalManager=function(e){},this.getWindow=function(){return this.globalManager.getWindow()},this.getDocument=function(){return this.globalManager.getDocument()},this.setWindow=function(e){return this.globalManager.setWindow(e)},this.addWindowEventListener=function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;n>o;o++)i[o-2]=arguments[o];(r=this.globalManager).addWindowEventListener.apply(r,[e,t].concat(i))},this.removeWindowEventListener=function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;n>o;o++)i[o-2]=arguments[o];(r=this.globalManager).removeWindowEventListener.apply(r,[e,t].concat(i))},this.addDocumentEventListener=function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;n>o;o++)i[o-2]=arguments[o];(r=this.globalManager).addDocumentEventListener.apply(r,[e,t].concat(i))},this.removeDocumentEventListener=function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;n>o;o++)i[o-2]=arguments[o];(r=this.globalManager).removeDocumentEventListener.apply(r,[e,t].concat(i))}}r.r(t),r.d(t,"GlobalManagerMixin",function(){return n});var i=r("./src/application/GlobalManager.js"),o=new i.GlobalManager;Autodesk.Viewing.GlobalManager=i.GlobalManager,Autodesk.Viewing.GlobalManagerMixin=n},"./src/application/LightPresets.js":function(e,t,r){"use strict";function n(e,t){Object(i.ObjectAssign)(t,e),t.name=e.name+" (copy)"}r.r(t),r.d(t,"DefaultLightPreset",function(){return o}),r.d(t,"DefaultLightPreset2d",function(){return s}),r.d(t,"DefaultToneMapMethod",function(){return a}),r.d(t,"BackgroundPresets",function(){return l}),r.d(t,"LightPresets",function(){return u}),r.d(t,"copyLightPreset",function(){return n});var i=r("./src/compat.js"),o=1,s=0,a=1,l={"Fusion Grey":[230,230,230,150,150,150],"Sky Blue":[226,244,255,156,172,180],Snow:[181,186,199,181,186,199],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],AutoCADModel:[30,40,48,30,40,48],"Dark Grey":[51,51,51,51,51,51],"Dark Sky":[51,51,51,51,51,51],"Infinity Pool":[255,255,255,255,255,255],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],"RaaS SBS":[1,1,1,90,90,90],Plaza:[79,102,130,79,102,130],Field:[202,226,252,202,201,190],Boardwalk:[216,230,248,230,228,220],Custom:[230,230,230,150,150,150]},c=l,u=[{name:"Simple Grey",path:null,tonemap:0,E_bias:0,directLightColor:[1,.84,.67],ambientColor:[.2,.225,.25],lightMultiplier:1,bgColorGradient:c["Fusion Grey"],darkerFade:!1,rotation:0},{name:"Sharp Highlights",path:"SharpHighlights",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.5,-.2,-.06],bgColorGradient:c["Photo Booth"],darkerFade:!0,rotation:0},{name:"Dark Sky",path:"DarkSky",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:1,lightDirection:[.1,-.55,-1],bgColorGradient:c["Dark Sky"],darkerFade:!1,rotation:0},{name:"Grey Room",path:"GreyRoom",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c["Grey Room"],darkerFade:!0,rotation:0},{name:"Photo Booth",path:"PhotoBooth",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c["Photo Booth"],darkerFade:!0,rotation:0},{name:"Tranquility",path:"TranquilityBlue",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c.Tranquility,darkerFade:!1,rotation:0},{name:"Infinity Pool",path:"InfinityPool",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,.84,.67],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c["Infinity Pool"],darkerFade:!1,rotation:0},{name:"Simple White",path:null,tonemap:0,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25,.25,.25],lightMultiplier:1,bgColorGradient:c.White,saoRadius:.06,saoIntensity:.15,darkerFade:!0,rotation:0},{name:"Riverbank",path:"riverbank",type:"logluv",tonemap:a,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],darkerFade:!1,rotation:0},{name:"Contrast",path:"IDViz",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Midnight,darkerFade:!1,rotation:0},{name:"Rim Highlights",path:"RimHighlights",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.35,-.35,-.5],bgColorGradient:c["Photo Booth"],darkerFade:!0,rotation:0},{name:"Cool Light",path:"CoolLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:c["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Warm Light",path:"WarmLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:c["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Soft Light",path:"SoftLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.5,0],bgColorGradient:c["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Grid Light",path:"GridLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.6,0],bgColorGradient:c["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Plaza",path:"Plaza",type:"logluv",tonemap:a,E_bias:-14,directLightColor:[.9,.9,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.2,-.18,.72],bgColorGradient:c.Plaza,darkerFade:!1,rotation:0},{name:"Snow Field",path:"SnowField",type:"logluv",tonemap:a,E_bias:-10.461343,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[0,-1,0],bgColorGradient:c.Snow,darkerFade:!1,rotation:0},{name:"Field",path:"field",type:"logluv",tonemap:a,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Field,useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Boardwalk",path:"boardwalk",type:"logluv",tonemap:a,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Boardwalk,useIrradianceAsBackground:!0,darkerFade:!1,rotation:0},{name:"Flat Shading",path:null,tonemap:0,E_bias:0,directLightColor:[0,0,0],ambientColor:[0,0,0],lightMultiplier:0,bgColorGradient:c["Fusion Grey"],darkerFade:!1,rotation:0}],d=[{name:"Harbor",path:"Harbor",type:"logluv",tonemap:a,E_bias:1.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],useIrradianceAsBackground:!0,saoIntensity:.5,darkerFade:!1,rotation:0},{name:"Night",path:"Night",type:"logluv",tonemap:1,E_bias:4,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Midnight,useIrradianceAsBackground:!1,darkerFade:!1,rotation:0},{name:"Parking",path:"Parking",type:"logluv",tonemap:a,E_bias:2.8,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],useIrradianceAsBackground:!1,saoIntensity:.5,darkerFade:!1,rotation:0},{name:"River Road",path:"RiverRoad",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Fusion Grey"],useIrradianceAsBackground:!1,saoIntensity:.7,darkerFade:!1,rotation:0},{name:"Crossroads",path:"crossroads",type:"logluv",tonemap:a,E_bias:-5.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Seaport",path:"seaport",type:"logluv",tonemap:a,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!1,rotation:0},{name:"Glacier",path:"glacier",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Midnight,darkerFade:!1,rotation:0},{name:"RaaS Test Env",path:"Reflection",type:"logluv",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["RaaS SBS"],darkerFade:!1,rotation:0},{name:"City Night",path:"CityNight",type:"logluv",tonemap:a,E_bias:1.6,directLightColor:[1,1,1],lightMultiplier:.2,bgColorGradient:c.Midnight,useIrradianceAsBackground:!1,darkerFade:!1,rotation:0}];Object(i.getGlobal)().ENABLE_DEBUG&&Array.prototype.push.apply(u,d)},"./src/application/LoadingSpinner.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}r.r(t),r.d(t,"LoadingSpinner",function(){return a});var s=r("./src/application/GlobalManagerMixin.js"),a=function(){function e(){n(this,e),this.domElement=null}return o(e,[{key:"createDom",value:function(e){var t=this.getDocument(),r=t.createElement("div");r.className="spinner",e&&e.appendChild(r);for(var n=1;3>=n;n++){var i=t.createElement("div");i.className="bounce"+n,r.appendChild(i)}return this.domElement=r,this.hide(),r}},{key:"show",value:function(){this.domElement&&(this.domElement.style.display="block")}},{key:"hide",value:function(){this.domElement&&(this.domElement.style.display="None")}},{key:"destroy",value:function(){this.domElement=null}}]),e}();s.GlobalManagerMixin.call(a.prototype)},"./src/application/LocalStorage.js":function(e,t,r){"use strict";function n(){if("undefined"==typeof window)return!1;try{var e="lmv_viewer_test_localStorage",t=a.localStorage;return t?(t.setItem(e,"1"),t.removeItem(e),!0):!1}catch(r){return!1}}function i(){l||(this._data={})}r.r(t),r.d(t,"LocalStorage",function(){return c});var o=r("./src/logger/Logger.js"),s=r("./src/compat.js"),a=Object(s.getGlobal)(),l=n();i.prototype.getItem=function(e){return l?a.localStorage.getItem(e):this._data.hasOwnProperty(e)?this._data[e]:null},i.prototype.setItem=function(e,t){if(l)try{a.localStorage.setItem(e,t)}catch(r){o.logger.debug("avp.LocalStorage: Failed to setItem()")}else this._data[e]=String(t)},i.prototype.removeItem=function(e){l?a.localStorage.removeItem(e):delete this._data[id]},i.prototype.clear=function(){l?a.localStorage.clear():this._data={}},i.prototype.isSupported=function(){return l};var c=new i},"./src/application/Model.js":function(e,t,r){"use strict";function n(e){i.RenderModel.call(this,e),this.myData=e,this.topology=null,this.topologyPromise=null,this.svfUUID=null,this.defaultCameraHash=null,this.getInstanceTree=function(){return this.myData?this.myData.instanceTree:null},this.getBoundingBox=function(){if(!this.myData)return null;var e=this.myData.bbox,t=this.getFragmentList();return t&&t.matrix?(new THREE.Box3).copy(e).applyMatrix4(t.matrix):e},this.getFuzzyBox=function(){function e(){function e(e){i(e,t),t.center(n);var r=t.size(o).length();s.add(n.multiplyScalar(r)),a+=r}for(var t=new THREE.Box3,n=new THREE.Vector3,o=new THREE.Vector3,s=new THREE.Vector3,a=0,l=0;l<r.getCount();l++)e(l);return s.multiplyScalar(1/a),s}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.getFragmentList(),n=Boolean(t.ignoreTransforms),i=null;if(n){var o=new Array(6);i=function(e,t){r.getOriginalWorldBounds(e,o),t.min.fromArray(o),t.max.fromArray(o,3)}}else i=function(e,t){r.getWorldBounds(e,t)};for(var s=t.center||e(),a=t.quantil||.75,l=new THREE.Box3,c=[],u=0;u<r.getCount();u++)if(i(u,l),!l.empty()){var d=l.distanceToPoint(s);0==d&&(d=s.distanceTo(l.center())),c.push({fragId:u,distance:d})}c.sort(function(e,t){return e.distance-t.distance});for(var h=new THREE.Box3,u=0;u<c.length*a;u++){var f=c[u];i(f.fragId,l),h.union(l)}return h},this.is2d=function(){return!(!this.myData||!this.myData.is2d)},this.is3d=function(){return!this.is2d()},this.isOTG=function(){return this.myData&&!!this.myData.isOTG},this.isPdf=function(){return!(!this.myData||!this.myData.isPdf)},this.isLeaflet=function(){return!(!this.myData||!this.myData.isLeaflet)}}r.r(t),r.d(t,"ModelUnits",function(){return u}),r.d(t,"Model",function(){return n});var i=r("./src/wgs/scene/RenderModel.js"),o=(r("./src/application/LocalStorage.js"),r("./src/application/EventDispatcher.js")),s=r("./src/file-loaders/net/Xhr.js"),a=(r("./src/logger/Logger.js"),r("./src/wgs/scene/LmvMatrix4.js")),l=r("./src/compat.js"),c=r("./src/wgs/scene/FragmentList.js"),u={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in",POINT:"pt"};o.EventDispatcher.prototype.apply(n.prototype),n.prototype.constructor=n,n.prototype.getData=function(){return this.myData},n.prototype.setUUID=function(e){this.svfUUID=btoa(Object(s.pathToURL)(e))},n.prototype.getDocumentNode=function(){var e=this.getData();return e.loadOptions?e.loadOptions.bubbleNode||null:null},n.prototype.getRoot=function(){var e=this.getData();return e&&e.instanceTree?e.instanceTree.root:null},n.prototype.getRootId=function(){var e=this.getData();return e&&e.instanceTree&&e.instanceTree.getRootId()||0},n.prototype.getUnitData=function(e){var t={unitString:null,unitScale:1};switch(e){case"meter":case"meters":case"m":return t.unitString=u.METER,t.unitScale=1,t;case"foot":case"feet":case"ft":return t.unitString=u.FOOT,t.unitScale=.3048,t;case"feet and inches":case"inch":case"inches":case"in":return t.unitString=u.INCH,t.unitScale=.0254,t;case"centimeter":case"centimeters":case"cm":return t.unitString=u.CENTIMETER,t.unitScale=.01,t;case"millimeter":case"millimeters":case"mm":return t.unitString=u.MILLIMETER,t.unitScale=.001,t;case"point":case"points":case"pt":return t.unitString=u.POINT,t.unitScale=.0254/72,t;default:return t}},n.prototype.getUnitScale=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.overriddenUnits?t.overriddenUnits:t&&t.scalingUnit?t.scalingUnit:this.getMetadata("distance unit","value",null)}return e&&(e=e.toLowerCase()),this.getUnitData(e).unitScale},n.prototype.getUnitString=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.overriddenUnits?t.overriddenUnits:t&&t.scalingUnit?t.scalingUnit:this.getMetadata("distance unit","value",null)}return e&&(e=e.toLowerCase()),this.getUnitData(e).unitString},n.prototype.getDisplayUnit=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.scalingUnit?t.scalingUnit:this.getMetadata("distance unit","value",null)}return e&&(e=e.toLowerCase()),this.getUnitData(e).unitString},n.prototype.getMetadata=function(e,t,r){var n=this.getData();if(n){var i=n.metadata;if(i){var o=i[e];if(void 0!==o){if(!t)return o;var s=o[t];if(void 0!==s)return s}}}return r},n.prototype.getDefaultCamera=function(){var e=this.getData();if(!e)return null;var t=null,r=e.cameras?e.cameras.length:0;if(r>0){var n=this.getMetadata("default camera","index",null);if(null!==n&&e.cameras[n])t=e.cameras[n];else{for(var i=0;r>i;i++){var o=e.cameras[i];if(o.isPerspective){t=o;break}}t||(t=e.cameras[0])}}return t},n.prototype.isAEC=function(){return!!this.getData().loadOptions.isAEC},n.prototype.hasPageShadow=function(){return this.getData().hasPageShadow},n.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)},n.prototype.geomPolyCount=function(){var e=this.getGeometryList();return e?e.geomPolyCount:null},n.prototype.instancePolyCount=function(){var e=this.getGeometryList();return e?e.instancePolyCount:null},n.prototype.isLoadDone=function(){var e=this.getData();return!(!e||!e.loadDone)},n.prototype.isObjectTreeCreated=function(){return!!this.getData().instanceTree},n.prototype.getPropertyDb=function(){var e=this.getData();return e&&e.propDbLoader},n.prototype.getProperties=function(e,t,r){var n=this.getPropertyDb();return!n||0>=e?void(r&&r()):void n.getProperties(e,t,r)},n.prototype.getProperties2=function(e,t,r,n){var i=this.getPropertyDb();return!i||0>=e?void(r&&r()):void i.getProperties2(e,t,r,n)},n.prototype.getBulkProperties=function(e,t,r,n){Array.isArray(t)&&(t={propFilter:t}),t=t||{};var i=t.propFilter||null,o=t.ignoreHidden||!1,s=this.getPropertyDb();return s?void s.getBulkProperties(e,i,r,n,o):void(n&&n())},n.prototype.getBulkProperties2=function(e,t,r,n){var i=this.getPropertyDb();return i?void i.getBulkProperties2(e,t,r,n):void(n&&n())},n.prototype.getExternalIdMapping=function(e,t){var r=this.getPropertyDb();return r?void r.getExternalIdMapping(e,t):void(t&&t())},n.prototype.getLayerToNodeIdMapping=function(e,t){var r=this.getPropertyDb();return r?void r.getLayerToNodeIdMapping(e,t):void(t&&t())},n.prototype.getObjectTree=function(e,t){var r=this.getData().instanceTree;if(r)return void e(r);var n=this.getPropertyDb();return n?void n.getObjectTree(e,t):void(t&&t())},n.prototype.isObjectTreeLoaded=function(){var e=this.getPropertyDb();return e?e.isObjectTreeLoaded():!1},n.prototype.search=function(e,t,r,n){var i=this.getPropertyDb();return i?void i.searchProperties(e,n,t,r):void(r&&r())},n.prototype.findProperty=function(e){var t=this.getPropertyDb();return t?t.findProperty(e):Promise.reject("Model doesn't have any properties.")};var d=function(e){var t=.001,r=e;if(Math.abs(r[0])<t)if(Math.abs(r[4])>t)for(var n=0;4>n;n++){var i=r[n];r[n]=r[n+4],r[n+4]=i}else for(var n=0;4>n;n++){var i=r[n];r[n]=r[n+8],r[n+8]=i}if(Math.abs(r[5])<t)for(var n=4;8>n;n++){var i=r[n];r[n]=r[n+4],r[n+4]=i}},h=function(e,t,r,n){var i,o,s,a,l,c,u=!1;s=n[r[r.length-1]].x,a=n[r[r.length-1]].y,i=a>=t;for(var d=0,h=r.length;h>d;++d)l=n[r[d]].x,c=n[r[d]].y,o=c>=t,i!=o&&(c-t)*(s-l)>=(l-e)*(a-c)==o&&(u=!u),i=o,s=l,a=c;return u};n.prototype.pointInPolygon=function(e,t,r,n){for(var i=!1,o=0;o<r.length;o++)h(e,t,r[o],n)&&(i=!i);return i},n.prototype.getPageToModelTransform=function(e){var t=this.getData();if(t.pageToModelTransform)return t.pageToModelTransform;var r=t,n=r.metadata,i=n.page_dimensions,o=r.viewports&&r.viewports[e];if(!o)return new THREE.Matrix4;r.viewportTransforms||(r.viewportTransforms=new Array(r.viewports.length));var s=r.viewportTransforms[e];if(s)return s;var l=new a.LmvMatrix4(!0).set(i.logical_width/i.page_width,0,0,i.logical_offset_x,0,i.logical_height/i.page_height,0,i.logical_offset_y,0,0,1,0,0,0,0,1),c=o.transform.slice();d(c);var u=new a.LmvMatrix4(!0);u.elements.set(c);var h=new a.LmvMatrix4(!0);return h.getInverse(u),h.multiply(l),r.viewportTransforms[e]=h,h},n.prototype.pageToModel=function(e,t,r,n){function i(e){if(e){var t=(new THREE.Vector3).set(e.x,e.y,0).applyMatrix4(o);e.x=t.x,e.y=t.y}}var o=this.getPageToModelTransform(r);if(n){var s=new THREE.Matrix4;s.getInverse(o),o=s}i(e),i(t)},n.prototype.pointInClip=function(e,t){for(var r=this.getData().clips,n=[],i=1;i<r.length;i++)if(i!==t){for(var o=[],s=[],a=r[i].contourCounts,l=r[i].points,c=0,u=[],d=0;d<a.length;d++){for(var h=0;h<a[d];h++)o.push(c),c++;s.push(o),o=[]}for(var d=0;d<l.length;d+=2){var f={x:l[d],y:l[d+1]};u.push(f)}var p=this.pointInPolygon(e.x,e.y,s,u);p&&n.push(i)}return n},n.prototype.getClip=function(e){for(var t=this.getData().clips,r=[],n=[],i=t[e].contourCounts,o=t[e].points,s=0,a=[],l=0;l<i.length;l++){for(var c=0;c<i[l];c++)r.push(s),s++;n.push(r),r=[]}for(var l=0;l<o.length;l+=2){var u={x:o[l],y:o[l+1]};a.push(u)}return{contours:n,points:a}},n.prototype.getTopoIndex=function(e){var t=this.getData();if(t&&t.fragments){var r=t.fragments.topoIndexes;if(r)return r[e]}},n.prototype.getTopology=function(e){return this.topology?this.topology[e]:null},n.prototype.hasTopology=function(){return!!this.topology},n.prototype.fetchTopology=function(e){if(this.topology)return Promise.resolve(this.topology);var t=this.getData();if(!t.topologyPath)return Promise.reject({error:"no-topology"});var r=e||(Object(l.isMobileDevice)()?20:100);if(t.topologySizeMB>r)return Promise.reject({error:"topology-too-big",limitMB:r,topologyMB:t.topologySizeMB});if(!this.topologyPromise){var n=this;this.topologyPromise=new Promise(function(e,t){n.loader.fetchTopologyFile(n.getData().topologyPath,function(r){r&&r.topology?(n.topology=r.topology,e(r.topology)):t(r)})})}return this.topologyPromise},n.prototype.hasGeometry=function(){var e=this.getData();return e?e.isLeaflet?!0:e.fragments.length>0:!1},n.prototype.getFragmentPointer=function(e){return e?new c.FragmentPointer(this.getFragmentList(),e):null},n.prototype.clone=function(){var e=new n(this.myData);return e.topology=this.topology,e.topologyPromise=this.topologyPromise,e.svfUUID=this.svfUUID,e.defaultCameraHash=this.defaultCameraHash,e.setInnerAttributes(this.getInnerAttributes()),e}},"./src/application/ModelLayers.js":function(e,t,r){"use strict";function n(e){this.viewer=e,this.matman=e.matman(),this.model=null,this.root=null,this.initialized=!1,this.layerToIndex={},this.indexToLayer=[null],this.nodeToLayer=[]}function i(e){var t=e.getData(),r=m;return t&&t.layersRoot&&(r=t.layersRoot),Promise.resolve(r)}function o(e){if(e.getData().loadOptions.skipPropertyDb)return Promise.resolve(null);var t=e.getPropertyDb();return!t||e.getData().loadOptions.disable3DModelLayers?Promise.resolve(m):t.findLayers()}function s(e,t){var r=e.model,n=e.indexToLayer;if(r.is2d()){if(!r.getData().layerCount)return;var i=[];for(var o in e.layerToIndex)i.push(e.layerToIndex[o]);e.matman.setLayerVisible(i,t,r.id),e.viewer.invalidate(!0)}else{var s=[],l=t?e.viewer.visibilityManager.show:e.viewer.visibilityManager.hide;a(e,function(e,i){n[i].visible!==t&&(s.push(e),s.length===p&&(l(s,r),s.length=0))}),s.length>0&&l(s,r)}for(var c=n.length,u=1;c>u;++u){var d=n[u];d&&(d.visible=t)}}function a(e,t){var r=e.nodeToLayer;if(r&&r.length){var n=e.model.getData().instanceTree.nodeAccess;for(var i in n.dbIdToIndex){var o=n.dbIdToIndex[i],s=r[o]||0;0!==s&&t(0|i,s)}}}function l(e,t){return"number"==typeof t?t:e.layerToIndex[t.name||t]||0}function c(e){return!e.layer.isLayer}function u(e){if(!e)return[];var t=[],r=0;d(e,function(e){t.push(e),e.isLayer&&(r=Math.max(r,0|e.index))});for(var n=0;n<t.length;++n)t[n].isLayer||(t[n].index=++r);return t}function d(e,t){for(var r=0;r<e.length;++r){var n=e[r];t(n),n.children&&d(n.children,t)}}r.r(t),r.d(t,"ModelLayers",function(){return n});var h=r("./src/logger/Logger.js"),f=r("./src/application/EventTypes.js"),p=(r.n(f),1024),m={name:"root",id:"root",isLayer:!1,children:[],childCount:0},g=n.prototype;g.addModel=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;if(!this.initialized&&(e.is2d()||!t)){var r=function(t){var r=this.model.getData(),n=r.instanceTree;if(t){t.children=t.children||[];var i=u(t.children);t.childCount=i.length,this.indexToLayer=new Array(t.childCount+1),this.indexToLayer[0]=null;for(var o=0;o<t.childCount;++o){var s=i[o],a=void 0==s.visible?!0:s.visible;this.layerToIndex[s.name]=s.index,this.indexToLayer[s.index]={layer:s,visible:a}}if(!this.model.is2d()&&0!==t.childCount){this.nodeToLayer=t.childCount<=256?new Uint8Array(n.nodeAccess.getNumNodes()):new Uint16Array(n.nodeAccess.getNumNodes());var l=function(e){if(this.model){var t=this.model.getData(),r=t.instanceTree;for(var n in e)if(e.hasOwnProperty(n))for(var i=this.layerToIndex[n],o=e[n],s=0,a=o.length;a>s;++s){var l=r.nodeAccess.getIndex(o[s]);this.nodeToLayer[l]=i}}}.bind(this),c=function(){h.logger.warn("ModelLayers error: coudn't get layers from property database.")}.bind(this);e.getLayerToNodeIdMapping(l,c)}}}.bind(this),n=function(t){this.root=t,this.initialized=!0,this.activateLayerState("Initial"),this.viewer.api.dispatchEvent({type:f.MODEL_LAYERS_LOADED_EVENT,model:e,root:t})}.bind(this);this.model=e,(e.is2d()?i(e):o(e)).then(function(e){r(e),n(e)})["catch"](function(e){h.logger.warn(e),n(m)})}},g.removeModel=function(e){this.model===e&&(this.model=null,this.root=null,this.initialized=!1,this.layerToIndex={},this.indexToLayer=[null],this.nodeToLayer=[])},g.getRoot=function(){return this.initialized||h.logger.warn("Autodesk.Viewing.ModelLayers.getRoot couldn't peform action, layers are still being loaded"),this.root},g.showAllLayers=function(){return this.initialized?void s(this,!0):void h.logger.warn("Autodesk.Viewing.ModelLayers.showAllLayers couldn't peform action, layers are still being loaded")},g.hideAllLayers=function(){return this.initialized?void s(this,!1):void h.logger.warn("Autodesk.Viewing.ModelLayers.hideAllLayers couldn't peform action, layers are still being loaded")},g.isLayerVisible=function(e){if(!this.initialized)return h.logger.warn("Autodesk.Viewing.ModelLayers.isLayerVisible couldn't peform action, layers are still being loaded"),!1;var t=l(this,e),r=this.indexToLayer[t];if(c(r)){for(var n=r.layer.children,i=0;i<n.length;++i){var o=n[i].index,s=this.indexToLayer[o];if(s.visible)return!0}return!1}return r.visible},g.setLayerVisible=function(e,t){if(!this.initialized)return void h.logger.warn("Autodesk.Viewing.ModelLayers.setLayersVisible couldn't peform action, layers are still being loaded");var r=Array.isArray(e)?e:[e];r=e.map(function(e){return l(this,e)}.bind(this));for(var n=r.length,i=0;n>i;++i){var o=r[i],s=this.indexToLayer[o];if(c(s)){var u=s.layer.children;u.forEach(function(e){r.push(e.index)})}}var d=this.model,f=this.indexToLayer;if(d.is2d())this.matman.setLayerVisible(r,t,d.id),this.viewer.invalidate(!0);else{var m=f.map(function(e){return!(null!==e&&-1!==r.indexOf(e.layer.index)&&e.visible!==t)}),g=[],v=t?this.viewer.visibilityManager.show:this.viewer.visibilityManager.hide;a(this,function(e,t){m[t]||(g.push(e),g.length===p&&(v(g,d),g.length=0))}),g.length>0&&v(g,d)}for(var y=r.length,i=0;y>i;++i){var _=this.indexToLayer[r[i]];_&&(_.visible=t)}},g.getVisibleLayerIndices=function(){if(!this.initialized)return h.logger.warn("Autodesk.Viewing.ModelLayers.getVisibleLayerIndices couldn't peform action, layers are still being loaded"),[];for(var e=[],t=this.indexToLayer,r=t.length,n=1;r>n;++n){var i=t[n];i&&i.visible&&!c(i)&&e.push(i.layer.index)}return e},g.allLayersVisible=function(){if(!this.initialized)return!0;for(var e=this.indexToLayer,t=e.length,r=1;t>r;++r){var n=e[r];if(n&&!n.visible)return!1}return!0},g.activateLayerState=function(e){if(!this.initialized||!this.model)return void h.logger.warn("Autodesk.Viewing.ModelLayers.activateLayerState couldn't peform action, layers are still being loaded");var t=this.model.getData().metadata,r=t?t.layer_states:null;if(!this.model.is3d()&&r&&e){var n;for(n=0;n<r.length&&r[n].name!==e;n++);if(n<r.length){var i=r[n],o=i.visible_layers,s={};if(o&&0<o.length)for(var a=0;a<o.length;a++)s[o[a]]=1;var l=[],c=[];for(var u in t.layers){var d=t.layers[u].name;u=0|u,1===s[d]?l.push(u):c.push(u)}this.setLayerVisible(l,!0),this.setLayerVisible(c,!1)}}},g.getLayerStates=function(){function e(e,t){var r=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t);if(r.length!==n.length)return!1;for(var i=0;i<r.length;++i){var o=r[i];if(e[o]!==t[o])return!1}return!0}if(!this.initialized)return h.logger.warn("Autodesk.Viewing.ModelLayers.getLayerStates couldn't peform action, layers are still being loaded"),null;var t=this.model,r=t?t.getData().metadata:null,n=r?r.layers:null,i=r?r.layer_states:null;if(this.model.is3d()||!n||!i)return null;var o,s={},a={};for(var l in n)if(n.hasOwnProperty(l)){var c=parseInt(l),u=n[l];o="string"==typeof u?u:u.name,s[o]=!0,this.isLayerVisible(c)&&(a[o]=!0)}for(var d=[],f=0;f<i.length;++f){var p=i[f],m=p.visible_layers,g={};if(!p.hidden){if(m&&0<m.length)for(var v=0;v<m.length;++v)o=m[v],s.hasOwnProperty(o)&&(g[o]=!0);d.push({name:p.name,description:p.description,active:e(a,g)})}}return 0<d.length?d:null}},"./src/application/ModelMemoryTracker.js":function(e,t,r){"use strict";function n(e){return e&&e.byteLength||0}function i(e){return n(e.boxes)+n(e.transforms)+n(e.fragId2dbId)+n(e.geomDataIndexes)+n(e.materials)}function o(e){return n(e.geomids)+n(e.materialids)+n(e.vizflags)+(e.boxes!==e.fragments.boxes?n(e.boxes):0)+(e.transforms!==e.fragments.transforms?n(e.transforms):0)}function s(e){var t=e.nodes.nodesRaw?e.nodes.nodesRaw:e.nodes;
return n(t)+n(e.primitives)}function a(e){var t=e.nodeAccess;return n(t.children)+n(t.nameSuffixes)+n(t.names)+n(t.nodeBoxes)+n(t.nodes)}function l(e){for(var t=Autodesk.Viewing.Private,r=0,n=0;n<e.length;n++){var l=e[n],c=l.getData(),u=l.getConsolidation();if(u&&(r+=u.byteSize),c.isLeaflet)f||(f=!0);else{if(!c.isOTG){var d=l.getGeometryList();r+=d.geomMemory}var h=c.fragments;h&&(r+=i(h));var p=l.getFragmentList();p&&(r+=o(p));var m=c.bvh;m&&(r+=s(m));var g=c.instanceTree;g&&(r+=a(g))}}return isFinite(r)||t.logger.warn("Memory estimate result was not a number"),r}function c(e){var t=e.impl.geomCache(),r=t?t.byteSize:0,n=e.impl.modelQueue(),i=n.getModels(),o=n.getHiddenModels(),s=l(i),a=l(o);return r+s+a}function u(e,t){function r(e){return e.lruTimestamp===o}function n(){for(var e=i.impl.modelQueue(),t=e.getHiddenModels(),n=[],o=0;o<t.length;o++){var s=t[o];r(s)||n.push(s)}var a=function(e,t){return e.lurTimestamp-t.lruTimestamp};return n.sort(a),n}var i=e,o=0,s=t||h;this.updateModelTimestamps=function(e){o++;for(var t=0;t<e.length;t++){var r=e[t];r.lruTimestamp=o}},this.memoryExceeded=function(){var e=c(i);return e>=s},this.getMemLimit=function(){return s},this.cleanup=function(e){var t=e||i.impl.unloadModel.bind(i.impl);if(this.memoryExceeded()){for(var r=n(),o=0;o<r.length;o++){var s=r[o];if(s.isConsolidated&&(s.unconsolidate(),!this.memoryExceeded()))return}var a=i.impl.geomCache();for(o=0;o<r.length;o++)if(s=r[o],t(s),a&&a.cleanup(),!this.memoryExceeded())return}}}r.r(t),r.d(t,"estimateMemUsage",function(){return c}),r.d(t,"ModelMemoryTracker",function(){return u});var d=1048576,h=1e3*d,f=!1},"./src/application/OverlayManager.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}r.r(t),r.d(t,"OverlayManager",function(){return s});var s=function(){function e(t){n(this,e),this.impl=t}return o(e,[{key:"dtor",value:function(){this.impl=null}},{key:"addScene",value:function(e){return e?this.impl.overlayScenes.hasOwnProperty(e)?!0:(this.impl.createOverlayScene(e),!0):!1}},{key:"removeScene",value:function(e){return e?(this.impl.removeOverlayScene(e),!0):!1}},{key:"clearScene",value:function(e){this.impl.clearOverlay(e)}},{key:"hasScene",value:function(e){return e?this.impl.overlayScenes.hasOwnProperty(e):!1}},{key:"addMesh",value:function(e,t){return e&&t&&this.impl.overlayScenes.hasOwnProperty(t)?(e=Array.isArray(e)?e:[e],this.impl.addMultipleOverlays(t,e),!0):!1}},{key:"removeMesh",value:function(e,t){return e&&t&&this.impl.overlayScenes.hasOwnProperty(t)?(e=Array.isArray(e)?e:[e],this.impl.removeMultipleOverlays(t,e),!0):!1}},{key:"hasMesh",value:function(e,t){var r=this.impl.overlayScenes[t];if(!r)return!1;for(var n=r.scene.children,i=0,o=n.length;o>i;++i)if(n[i]===e)return!0;return!1}}]),e}()},"./src/application/PreferenceNames.js":function(e,t,r){"use strict";r.r(t),r.d(t,"Prefs3D",function(){return n}),r.d(t,"Prefs2D",function(){return i}),r.d(t,"Prefs",function(){return o}),r.d(t,"VIEW_TYPES",function(){return s});var n={VIEW_CUBE:"viewCube",VIEW_CUBE_COMPASS:"viewCubeCompass",VIEW_TYPE:"viewType",ALWAYS_USE_PIVOT:"alwaysUsePivot",ZOOM_TOWARDS_PIVOT:"zoomTowardsPivot",SELECTION_SETS_PIVOT:"selectionSetsPivot",REVERSE_HORIZONTAL_LOOK_DIRECTION:"reverseHorizontalLookDirection",REVERSE_VERTICAL_LOOK_DIRECTION:"reverseVerticalLookDirection",ORBIT_PAST_WORLD_POLES:"orbitPastWorldPoles",CLICK_TO_SET_COI:"clickToSetCOI",GHOSTING:"ghosting",OPTIMIZE_NAVIGATION:"optimizeNavigation",AMBIENT_SHADOWS:"ambientShadows",ANTIALIASING:"antialiasing",GROUND_SHADOW:"groundShadow",GROUND_REFLECTION:"groundReflection",LINE_RENDERING:"lineRendering",EDGE_RENDERING:"edgeRendering",LIGHT_PRESET:"lightPreset",ENV_MAP_BACKGROUND:"envMapBackground",FIRST_PERSON_TOOL_POPUP:"firstPersonToolPopup",BIM_WALK_TOOL_POPUP:"bimWalkToolPopup",BIM_WALK_NAVIGATOR_TYPE:"bimWalkNavigatorType",BIM_WALK_GRAVITY:"bimWalkGravity",DEFAULT_NAVIGATION_TOOL_3D:"defaultNavigationTool3D",SELECTION_MODE:"selectionMode",ENABLE_CUSTOM_ORBIT_TOOL_CURSOR:"enableCustomOrbitToolCursor",EXPLODE_STRATEGY:"explodeStrategy",FORCE_DOUBLE_SIDED:"forceDoubleSided"},i={GRAYSCALE:"grayscale",SWAP_BLACK_AND_WHITE:"swapBlackAndWhite",LOADING_ANIMATION:"loadingAnimation",FORCE_PDF_CALIBRATION:"forcePDFCalibration",FORCE_LEAFLET_CALIBRATION:"forceLeafletCalibration",DISABLE_PDF_HIGHLIGHT:"disablePdfHighlight"},o={PROGRESSIVE_RENDERING:"progressiveRendering",OPEN_PROPERTIES_ON_SELECT:"openPropertiesOnSelect",POINT_RENDERING:"pointRendering",BACKGROUND_COLOR_PRESET:"backgroundColorPreset",REVERSE_MOUSE_ZOOM_DIR:"reverseMouseZoomDir",LEFT_HANDED_MOUSE_SETUP:"leftHandedMouseSetup",FUSION_ORBIT:"fusionOrbit",FUSION_ORBIT_CONSTRAINED:"fusionOrbitConstrained",WHEEL_SETS_PIVOT:"wheelSetsPivot",RESTORE_SESSION_MEASUREMENTS:"restoreMeasurements",DISPLAY_UNITS:"displayUnits",DISPLAY_UNITS_PRECISION:"displayUnitsPrecision"},s={DEFAULT:0,ORTHOGRAPHIC:1,PERSPECTIVE:2,PERSPECTIVE_ORTHO_FACES:3}},"./src/application/Preferences.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){function r(){var e=t.prefix+"test";try{var r=d.localStorage;return r.setItem(e,"1"),r.removeItem(e),!0}catch(n){return!1}}function i(e,r){if(m){if(g.hasTag(e,"no-storage"))return;var n=t.prefix+e;return"undefined"!=typeof r?(r instanceof l.EnumType&&(r=r.toString()),d.localStorage[n]=r):r=d.localStorage[n],r}}function a(e,t){if("string"!=typeof e||"function"==typeof g[e])return void s.logger.log("Preferences: invalid name="+e);var r=i(e),n=!1;if(void 0!==r)try{r=JSON.parse(r),"__enum"===r.type&&(r=l.EnumType.deSerialize(r)),n=!0}catch(o){}g[e]=n?r:t,p[e]={}}function c(e){m&&(e=t.prefix+e,delete localStorage[e])}var u=this;u.setGlobalManager(e.globalManager);var d=u.getWindow();"string"==typeof t&&(t={prefix:t}),t||(t={}),t.prefix||(t.prefix="Autodesk.Viewing.Preferences."),t.hasOwnProperty("localStorage")||(t.localStorage=!0);var h={},f={},p={},m=t.localStorage&&r(),g=this;e.addEventListener(o.PREF_CHANGED_EVENT,function(e){var t=f[e.name];t&&t.forEach(function(t){var r=t.changed;r&&"function"==typeof r&&r(e.value)})}),e.addEventListener(o.PREF_RESET_EVENT,function(e){var t=f[e.name];t&&t.forEach(function(t){var r=t.reset;r&&"function"==typeof r&&r(e.value)})}),this.load=function(e){h=e;for(var t in h)h.hasOwnProperty(t)&&a(t,h[t])},this.addTags=function(e,t){if(!t||!e)return!1;t=Array.isArray(t)?t:[t];for(var r=0;r<t.length;++r)this.tag(t[r],e);return!0},this.tag=function(e,t){if(e){t?Array.isArray(t)||(t=[t]):t=Object.keys(h);for(var r=0;r<t.length;++r)p[t[r]]&&(p[t[r]][e]=!0)}},this.untag=function(e,t){if(e){t?Array.isArray(t)||(t=[t]):t=Object.keys(h);for(var r=0;r<t.length;++r)p[t[r]]&&(p[t[r]][e]=!1)}},this.hasTag=function(e,t){var r=p[e];return r?r[t]===!0:!1},this.add=function(t,r,n,i){return!h.hasOwnProperty(t)||i?(this.setDefault(t,r),a(t,r),this.addTags(t,n),i&&e.dispatchEvent({type:o.PREF_CHANGED_EVENT,name:t,value:this.get(t)}),!0):(s.logger.log("Preferences: "+t+" already exists"),!1)},this.setDefault=function(e,t){t instanceof l.EnumType&&(t=t.value),e&&!isNaN(t)&&(h[e]=t)},this.remove=function(e,t){return h.hasOwnProperty(e)?(delete h[e],delete p[e],delete this[e],t&&c(e),!0):!1},this.clearWebStorage=function(){if(m){var e=d.localStorage;for(var r in e)e.hasOwnProperty(r)&&-1!==r.indexOf(t.prefix)&&delete localStorage[r]}},this.reset=function(t,r){t&&void 0===r&&(r=!0);for(var n in h)if(h.hasOwnProperty(n)){if(t){var i=!!p[n][t];if(r&&!i||!r&&i)continue}this.set(n,h[n],!1)&&e.dispatchEvent({type:o.PREF_RESET_EVENT,name:n,value:this.get(n)}),c(n)}},this.get=function(e){return this[e]instanceof l.EnumType?this[e].value:this[e]},this.set=function(t,r,s){function a(e,t){var r=function(e){return"object"===n(e)?JSON.stringify(e):e};return r(e)===r(t)}return r=r instanceof l.EnumType?r.value:r,a(this.get(t),r)?!1:(this[t]instanceof l.EnumType?this[t].value=r:this[t]=r,i(t,r),(void 0===s||s)&&e.dispatchEvent({type:o.PREF_CHANGED_EVENT,name:t,value:r}),!0)},this.dispatchEvent=function(t){var r=this.get(t),n=o.PREF_CHANGED_EVENT;e.dispatchEvent({type:n,name:t,value:r})},this.addListeners=function(e,t,r){f[e]||(f[e]=[]),r||(r=t),f[e].push({changed:t,reset:r})},this.removeListeners=function(e,t,r){if(void 0!==f[e]){if(!t&&!r)return void delete f[e];r||(r=t);for(var n=0;n<f[e].length;++n)if(f[e][n].changed===t&&f[e][n].reset===r){f[e].splice(n,1);break}}},this.clearListeners=function(){f={}},this.setUseLocalStorage=function(e){m=!!e}}r.r(t),r.d(t,"Preferences",function(){return i});var o=r("./src/application/EventTypes.js"),s=(r.n(o),r("./src/logger/Logger.js")),a=r("./src/application/GlobalManagerMixin.js"),l=r("./src/application/ProfileSettings.js");a.GlobalManagerMixin.call(i.prototype)},"./src/application/Profile.js":function(e,t,r){"use strict";function n(e,t){if(s.LocalStorage.isSupported()){var r="Autodesk.Viewing.ProfileName",n=l.localStorage.getItem(r);n!==e&&(s.LocalStorage.setItem(r,e),t.clearWebStorage())}}function i(e){if(e){var t=Autodesk.Viewing,r=t.ProfileSettings.Default,i=[];if(this.name=e.hasOwnProperty("name")?e.name:"Custom",this.label=e.label,this.description=e.description,this.persistent=Array.isArray(e.persistent)?e.persistent:r.persistent,this.settings=Object.assign({},r.settings),e.hasOwnProperty("settings")){var s=e.settings;i=Object.keys(s),this.settings=Object.assign(this.settings,s)}var a=[],l=[];if(e.hasOwnProperty("extensions")){var c=e.extensions.load,u=e.extensions.unload;a=c?c.slice():a,l=u?u.slice():l}this.extensions={load:a,unload:l},this.apply=function(e){if(!e)return!1;n(this.name,e);var r=this.settings,s=[t.ProfileSettings.Default.name,t.ProfileSettings.AEC.name],a=Object.values(o.Prefs3D),l=Object.values(o.Prefs2D);for(var c in r)if(r.hasOwnProperty(c)){var u=r[c],d=-1!==i.indexOf(c)&&-1===s.indexOf(this.name)?["ignore-producer"]:[];-1!==a.indexOf(c)?d.push("3d"):-1!==l.indexOf(c)?d.push("2d"):(d.push("2d"),d.push("3d")),-1===this.persistent.indexOf(c)&&d.push("no-storage");var h=e.get(c);void 0!==h?(e.addTags(c,d),h!==u&&e.set(c,u)):e.add(c,u,d,!0)}return!0}}}r.r(t),r.d(t,"Profile",function(){return i});var o=r("./src/application/PreferenceNames.js"),s=r("./src/application/LocalStorage.js"),a=r("./src/compat.js"),l=Object(a.getGlobal)()},"./src/application/ProfileManager.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}r.r(t),r.d(t,"ProfileManager",function(){return l});var s=r("./src/logger/Logger.js"),a=r("./src/application/Profile.js"),l=function(){function e(){n(this,e),this.registered={};var t=Autodesk.Viewing.ProfileSettings;this.PROFILE_DEFAULT=new a.Profile(t.Default),this.registerProfile("default",this.PROFILE_DEFAULT),this.PROFILE_AEC=new a.Profile(t.AEC),this.registerProfile("rvt",this.PROFILE_AEC),this.registerProfile("ifc",this.PROFILE_AEC),this.PROFILE_NAVIS=new a.Profile(t.Navis),this.registerProfile("nwc",this.PROFILE_NAVIS),this.registerProfile("nwd",this.PROFILE_NAVIS),this.PROFILE_FLUENT=new a.Profile(t.Fluent),this.registerProfile("fluent",this.PROFILE_FLUENT)}return o(e,[{key:"registerProfile",value:function(e,t){return t?(e=e||"default",void(this.registered[e]=t instanceof a.Profile?t:new a.Profile(t))):void s.logger.log("ProfileManager: missing profileSettings when registering a profile.")}},{key:"unregisterProfile",value:function(e){return e?void delete this.registered[e]:void s.logger.log("ProfileManager: missing fileExt when unregistering a profile.")}},{key:"getProfiles",value:function(){return Object.assign({},this.registered)}},{key:"getProfileOrDefault",value:function(e){if(!e)return s.logger.log("ProfileManager: missing fileExt for getProfile. Returning the default Profile."),this.registered["default"];var t=this.registered[e];return t?t:(s.logger.log("ProfileManager: No profile registered for ".concat(e,". Returning the default Profile.")),this.registered["default"])}}]),e}()},"./src/application/ProfileSettings.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e){e||(l.logger.log("ProfileSettings.clone: missing profileSettings, using DefaultProfileSettings..."),e=g);var t={};return t.settings=Object.assign({},e.settings),t.extensions={},e.hasOwnProperty("extensions")?(t.extensions.load=e.extensions.hasOwnProperty("load")?e.extensions.load.slice():[],t.extensions.unload=e.extensions.hasOwnProperty("unload")?e.extensions.unload.slice():[]):t.extensions={load:[],unload:[]},t.persistent=e.persistent.slice(),t}r.r(t),r.d(t,"EnumType",function(){return f}),r.d(t,"DefaultSettings",function(){return m}),r.d(t,"ProfileSettings",function(){return b});var a=r("./src/application/PreferenceNames.js"),l=r("./src/logger/Logger.js"),c=r("./src/wgs/scene/SelectionMode.js"),u=r("./src/compat.js"),d=r("./src/application/LightPresets.js"),h=r("./src/measurement/DisplayUnits.js"),f=function(){function e(t,r){if(n(this,e),!Array.isArray(t)||0===t.length)throw new Error("Invalid ".concat(t));this.values=new Set(t),this.current=r in t?r:t[0]}return o(e,[{key:"toString",value:function(){return JSON.stringify({type:"__enum",values:Array.from(this.values),current:this.current})}},{key:"value",get:function(){return this.current},set:function(e){this.values.has(e)&&(this.current=e)}}],[{key:"deSerialize",value:function(t){return"__enum"===t.type?new e(t.values,t.current):void 0}}]),e}(),p={};p[a.Prefs3D.AMBIENT_SHADOWS]=!0,p[a.Prefs3D.ANTIALIASING]=!Object(u.isMobileDevice)(),p[a.Prefs3D.GROUND_SHADOW]=!0,p[a.Prefs3D.GROUND_REFLECTION]=!1,p[a.Prefs3D.GHOSTING]=!0,p[a.Prefs3D.VIEW_CUBE]=!Object(u.isMobileDevice)(),p[a.Prefs3D.VIEW_CUBE_COMPASS]=!1,p[a.Prefs3D.VIEW_TYPE]=a.VIEW_TYPES.DEFAULT,p[a.Prefs3D.LINE_RENDERING]=!0,p[a.Prefs3D.LIGHT_PRESET]=d.DefaultLightPreset,p[a.Prefs3D.EDGE_RENDERING]=!1,p[a.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION]=!1,p[a.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION]=!1,p[a.Prefs3D.ALWAYS_USE_PIVOT]=!1,p[a.Prefs3D.ZOOM_TOWARDS_PIVOT]=!1,p[a.Prefs3D.ORBIT_PAST_WORLD_POLES]=!0,p[a.Prefs3D.CLICK_TO_SET_COI]=!1,p[a.Prefs3D.OPTIMIZE_NAVIGATION]=Object(u.isMobileDevice)(),p[a.Prefs3D.ENV_MAP_BACKGROUND]=!1,p[a.Prefs3D.FIRST_PERSON_TOOL_POPUP]=!0,p[a.Prefs3D.BIM_WALK_TOOL_POPUP]=!0,p[a.Prefs3D.BIM_WALK_NAVIGATOR_TYPE]="default",p[a.Prefs3D.BIM_WALK_GRAVITY]=!0,p[a.Prefs3D.DEFAULT_NAVIGATION_TOOL_3D]="default",p[a.Prefs3D.SELECTION_MODE]=c.SelectionMode.LEAF_OBJECT,p[a.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR]=!0,p[a.Prefs3D.EXPLODE_STRATEGY]="hierarchy",p[a.Prefs3D.SELECTION_SETS_PIVOT]=!1,p[a.Prefs3D.FORCE_DOUBLE_SIDED]=!1,p[a.Prefs2D.GRAYSCALE]=!1,p[a.Prefs2D.SWAP_BLACK_AND_WHITE]=!1,p[a.Prefs2D.LOADING_ANIMATION]=!0,p[a.Prefs2D.FORCE_PDF_CALIBRATION]=!1,p[a.Prefs2D.FORCE_LEAFLET_CALIBRATION]=!0,p[a.Prefs2D.DISABLE_PDF_HIGHLIGHT]=!1,p[a.Prefs.PROGRESSIVE_RENDERING]=!0,p[a.Prefs.OPEN_PROPERTIES_ON_SELECT]=!1,p[a.Prefs.POINT_RENDERING]=!0,p[a.Prefs.BACKGROUND_COLOR_PRESET]=null,p[a.Prefs.REVERSE_MOUSE_ZOOM_DIR]=!1,p[a.Prefs.LEFT_HANDED_MOUSE_SETUP]=!1,p[a.Prefs.FUSION_ORBIT]=!0,p[a.Prefs.FUSION_ORBIT_CONSTRAINED]=!0,p[a.Prefs.WHEEL_SETS_PIVOT]=!1,p[a.Prefs.RESTORE_SESSION_MEASUREMENTS]=!0,p[a.Prefs.DISPLAY_UNITS]=new f(h.displayUnitsEnum),p[a.Prefs.DISPLAY_UNITS_PRECISION]=new f(h.displayUnitsPrecisionEnum);var m=p,g={};g.name="Default",g.label="Manufacturing (Default)",g.description="Default Viewer settings.",g.settings=p,g.persistent=[a.Prefs3D.ALWAYS_USE_PIVOT,a.Prefs3D.ZOOM_TOWARDS_PIVOT,a.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,a.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,a.Prefs3D.ORBIT_PAST_WORLD_POLES,a.Prefs3D.CLICK_TO_SET_COI,a.Prefs3D.GHOSTING,a.Prefs3D.OPTIMIZE_NAVIGATION,a.Prefs3D.AMBIENT_SHADOWS,a.Prefs3D.ANTIALIASING,a.Prefs3D.GROUND_SHADOW,a.Prefs3D.GROUND_REFLECTION,a.Prefs3D.FIRST_PERSON_TOOL_POPUP,a.Prefs3D.BIM_WALK_TOOL_POPUP,a.Prefs3D.BIM_WALK_GRAVITY,a.Prefs3D.VIEW_TYPE,a.Prefs2D.SWAP_BLACK_AND_WHITE,a.Prefs2D.LOADING_ANIMATION,a.Prefs.OPEN_PROPERTIES_ON_SELECT,a.Prefs.REVERSE_MOUSE_ZOOM_DIR,a.Prefs.LEFT_HANDED_MOUSE_SETUP,a.Prefs.WHEEL_SETS_PIVOT],g.extensions={load:[],unload:[]};var v=s(g);v.name="AEC",v.label="Construction (AEC)",v.description="A common set of preferences designed for the Construction industry.",v.settings[a.Prefs.REVERSE_MOUSE_ZOOM_DIR]=!0,v.settings[a.Prefs3D.EDGE_RENDERING]=!Object(u.isMobileDevice)(),v.settings[a.Prefs3D.LIGHT_PRESET]=Object(u.getGlobal)().DefaultLightPresetAec||"Boardwalk",v.settings[a.Prefs3D.ENV_MAP_BACKGROUND]=!0,v.settings[a.Prefs3D.VIEW_CUBE_COMPASS]=!0,v.settings[a.Prefs3D.SELECTION_SETS_PIVOT]=!0,v.extensions={load:[],unload:[]};var y=s(v);y.name="Fluent",y.label="Design Collaboration",y.description="User experience that matches Design Collaboration.",y.settings[a.Prefs.WHEEL_SETS_PIVOT]=!0,y.settings[a.Prefs.RESTORE_SESSION_MEASUREMENTS]=!1,y.settings[a.Prefs2D.FORCE_PDF_CALIBRATION]=!0,y.settings[a.Prefs3D.ALWAYS_USE_PIVOT]=!0,y.settings[a.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR]=!1,y.extensions={load:[],unload:[]},y.persistent.splice(y.persistent.indexOf(a.Prefs3D.VIEW_TYPE),1);var _=s(v);_.name="Navis",_.label="Navisworks",_.description="Provides a user experience similar to Autodesk Navisworks desktop application.",_.settings[a.Prefs3D.BIM_WALK_TOOL_POPUP]=!1,_.settings[a.Prefs3D.BIM_WALK_NAVIGATOR_TYPE]="aec",_.settings[a.Prefs3D.DEFAULT_NAVIGATION_TOOL_3D]="extractor_defined";var b={Default:g,AEC:v,Fluent:y,Navis:_,clone:s}},"./src/application/ProgressState.js":function(e,t,r){"use strict";r.r(t),r.d(t,"ProgressState",function(){return n});var n={ROOT_LOADED:0,LOADING:1,RENDERING:2}},"./src/application/ScreenModeDelegate.js":function(e,t,r){"use strict";function n(e,t){for(var r=0;r<h.length;++r)t.addDocumentEventListener(h[r],e,!1)}function i(e,t){for(var r=0;r<h.length;++r)t.removeDocumentEventListener(h[r],e,!1)}function o(e){this.viewer=e,this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this),this.getMode()===f.kFullScreen&&n(this.bindFullscreenEventListener,this.viewer.globalManager)}function s(e){o.call(this,e)}function a(e){o.call(this,e)}function l(){}r.r(t),r.d(t,"ScreenMode",function(){return f}),r.d(t,"ScreenModeDelegate",function(){return o}),r.d(t,"AppScreenModeDelegate",function(){return s}),r.d(t,"ApplicationScreenModeDelegate",function(){return p}),r.d(t,"NullScreenModeDelegate",function(){return a}),r.d(t,"ScreenModeMixin",function(){return l});var c=r("./src/compat.js"),u=r("./src/application/EventTypes.js"),d=(r.n(u),r("./src/logger/Logger.js")),h=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"],f={kNormal:0,kFullBrowser:1,kFullScreen:2};o.prototype.uninitialize=function(){i(this.bindFullscreenEventListener,this.viewer.globalManager),this.viewer=null},o.prototype.isModeSupported=function(e){return!0},o.prototype.setMode=function(e){var t=this.getMode();return e!==t&&this.isModeSupported(e)?(this.doScreenModeChange(t,e),this.onScreenModeChanged(t,e),!0):!1},o.prototype.getMode=function(){throw"Implement getMode() in derived class"},o.prototype.getNextMode=function(){var e,t=this.getMode(),r=f;return t===r.kNormal&&this.isModeSupported(r.kFullBrowser)?e=r.kFullBrowser:t===r.kNormal&&this.isModeSupported(r.kFullScreen)?e=r.kFullScreen:t===r.kFullBrowser&&this.isModeSupported(r.kFullScreen)?e=r.kFullScreen:t===r.kFullBrowser&&this.isModeSupported(r.kNormal)?e=r.kNormal:t===r.kFullScreen&&this.isModeSupported(r.kNormal)?e=r.kNormal:t===r.kFullScreen&&this.isModeSupported(r.kFullBrowser)&&(e=r.kFullBrowser),e},o.prototype.getEscapeMode=function(){return this.getMode()!==f.kNormal?f.kNormal:void 0},o.prototype.fullscreenEventListener=function(){var e=this.viewer.globalManager.getDocument();Object(c.inFullscreen)(e)?this.viewer.resize():(this.doScreenModeChange(f.kFullScreen,f.kNormal),this.onScreenModeChanged(f.kFullScreen,f.kNormal))},o.prototype.doScreenModeChange=function(e,t){throw"Implement doScreenModeChange() in derived class"},o.prototype.onScreenModeChanged=function(e,t){e===f.kFullScreen?i(this.bindFullscreenEventListener,this.viewer.globalManager):t===f.kFullScreen&&n(this.bindFullscreenEventListener,this.viewer.globalManager),this.viewer.resize(),this.viewer.dispatchEvent({type:u.FULLSCREEN_MODE_EVENT,mode:t})},s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.isModeSupported=function(e){return e!==f.kFullBrowser},s.prototype.getMode=function(){var e=this.viewer.globalManager.getDocument();return Object(c.inFullscreen)(e)?f.kFullScreen:f.kNormal},s.prototype.doScreenModeChange=function(e,t){var r=this.viewer.container;if(t===f.kNormal){r.classList.remove("viewer-fill-browser");var n=this.viewer.globalManager.getDocument();Object(c.exitFullscreen)(n)}else t===f.kFullScreen&&(r.classList.add("viewer-fill-browser"),Object(c.launchFullscreen)(r))};var p=s;a.prototype=Object.create(o.prototype),a.prototype.constructor=o,a.prototype.isModeSupported=function(e){return!1},a.prototype.getMode=function(){return f.kNormal},l.prototype={setScreenModeDelegate:function(e){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),e?this.screenModeDelegateClass=e:null===e?this.screenModeDelegateClass=a:this.screenModeDelegateClass=s},getScreenModeDelegate:function(){return this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this)),this.screenModeDelegate},isScreenModeSupported:function(e){return this.getScreenModeDelegate().isModeSupported(e)},canChangeScreenMode:function(){return this.isScreenModeSupported(Autodesk.Viewing.ScreenMode.kNormal)},setScreenMode:function(e){var t={category:"screen_mode",value:e};return d.logger.track(t),this.getScreenModeDelegate().setMode(e)},getScreenMode:function(){return this.getScreenModeDelegate().getMode()},nextScreenMode:function(){var e=this.getScreenModeDelegate().getNextMode();return void 0!==e?this.setScreenMode(e):!1},escapeScreenMode:function(){var e=this.getScreenModeDelegate().getEscapeMode();return void 0!==e?this.setScreenMode(e):!1},apply:function(e){var t=l.prototype;e.setScreenModeDelegate=t.setScreenModeDelegate,e.getScreenModeDelegate=t.getScreenModeDelegate,e.isScreenModeSupported=t.isScreenModeSupported,e.canChangeScreenMode=t.canChangeScreenMode,e.setScreenMode=t.setScreenMode,e.getScreenMode=t.getScreenMode,e.nextScreenMode=t.nextScreenMode,e.escapeScreenMode=t.escapeScreenMode}}},"./src/application/ScreenShot.js":function(e,t,r){"use strict";function n(e,t,r,n,i){function o(){function e(){s.progressiveRender=d,s.resize(c,u,!0),t.canvas.toBlob(function(e){var t=Object(a.getGlobal)().URL.createObjectURL(e);n?n(t):Object(a.getGlobal)().open(t)},"image/png")}var t=l.targetToCanvas(m||l.getColorTarget());m&&(m.dispose(),m=void 0,s.glrenderer().setRenderTarget(null)),i?i(t.ctx,e):e()}var s=e.impl,l=s.renderer(),c=l.settings.logicalWidth,u=l.settings.logicalHeight,d=s.progressiveRender,p=s.glrenderer().getPixelRatio();t&&r||(t=c,r=u),s.progressiveRender=!1,s.resize(t/p,r/p,!0),s.tick(performance.now());var m=new h.WebGLRenderTarget(t,r,{minFilter:h.LinearFilter,magFilter:h.LinearFilter,format:h.RGBFormat,type:h.UnsignedByteType}),g=l.getOffscreenTarget();if(l.setOffscreenTarget(m),l.presentBuffer(),l.setOffscreenTarget(g),e.model.getData().isLeaflet){var v=function(){y=!0,s.progressiveRender=d,s.resize(c,u,!0)},y=!1;e.addEventListener(f.CANCEL_LEAFLET_SCREENSHOT,v,{once:!0}),s.invalidate(!0),e.model.getIterator().callWhenRefined(function(){y||(e.removeEventListener(f.CANCEL_LEAFLET_SCREENSHOT,v),o())})}else o();m&&m.dispose()}r.r(t),r.d(t,"ScreenShot",function(){return E});var i=r("./src/wgs/globals.js"),o=r("./src/wgs/scene/FrustumIntersector.js"),s=r("./src/wgs/render/RenderContext.js"),a=r("./src/compat.js"),l=r("./src/wgs/scene/RenderBatch.js"),c=r("./src/wgs/scene/MeshFlags.js"),u=r("./src/wgs/scene/SceneMath.js"),d=r("./src/wgs/scene/RenderFlags.js"),h=r("./thirdparty/three.js/three.js"),f=(r.n(h),r("./src/application/EventTypes.js")),p=(r.n(f),function(e,t,r,n,p){var m=p.getMaterials(),g=p.glrenderer(),v=p.renderer(),y=p.modelQueue();n=n||{};for(var _=[],b=n.models||y.getModels(),x=0;x<b.length;x++){var w=b[x],E=w.getIterator();if(E&&E.getGeomScenes)for(var S=E.getGeomScenes(),A=0;A<S.length;A++){var M=S[A];M&&_.push(M)}}var T=n.camera||p.camera;T===p.camera&&(T=T.clone()),T.clientWidth=e,T.clientHeight=t;var C=new o.FrustumIntersector,j=n.excludeCutPlanes?[]:m.getCutPlanes();C.reset(T,j),C.areaCullThreshold=i.PIXEL_CULLING_THRESHOLD,g.pushViewport();var P=g.getPixelRatio();g.setPixelRatio(1);var L;n.renderContext?L=n.renderContext:(L=new s.RenderContext,L.init(g,e,t,{offscreen:!0})),m.addOverrideMaterial("normalsMaterial_screenshot",L.getDepthMaterial()),m.addOverrideMaterial("edgeMaterial_screenshot",L.getEdgeMaterial());var D=n.renderConfig||v.getConfig();L.applyConfig(D),L.beginScene(p.scene,T,p.noLights,!0),g.popViewport(),g.setPixelRatio(P);for(var I=20,R=0,O=void 0,k={stop:function(){O&&(Object(a.getGlobal)().clearTimeout(O),G())},finished:function(){return!!O}},N=-1,F=[],V=0;V<b.length;V++){var U=b[V];if(U.getData().isLeaflet){var B=U.getIterator();F.push({iter:B,viewId:B.registerView(),ready:!1})}}var z=function(){for(var e=!0,t=0;t<F.length;t++){var r=F[t];r.ready||(r.ready=r.iter.reset(C,T,r.viewId)),e=e&&r.ready}if(e=e||n.dontWaitForLeafletTiles)for(var i=0;i<F.length;i++){var o=F[i],s=o.iter.getScene(o.viewId);_.push(s)}return e},G=function(){F.forEach(function(e){return e.iter.unregisterView(e.viewId)}),F.length=0},H=n.fragOptions,W=H?[]:void 0,q=function(e){var t=!!H&&e instanceof l.RenderBatch;if(t){var r=e.frags,n=function(e,t){W[t]=r.vizflags[e];var n=H.isFragOff&&H.isFragOff(e);void 0!==n&&r.setFlagFragment(e,c.MeshFlags.MESH_HIDE,n);var i=H.isFragVisible&&H.isFragVisible(e);void 0!==i&&r.setFlagFragment(e,c.MeshFlags.MESH_VISIBLE,i)};e.forEachNoMesh(n)}},X=function(e){var t=!!H&&e instanceof l.RenderBatch;if(t){var r=e.frags,n=function(e,t){var n=W[t],i=!!(n&c.MeshFlags.MESH_HIDE),o=!!(n&c.MeshFlags.MESH_VISIBLE);r.setFlagFragment(e,c.MeshFlags.MESH_HIDE,i),r.setFlagFragment(e,c.MeshFlags.MESH_VISIBLE,o)};e.forEachNoMesh(n)}},Y=function(){var e=void 0;if(n.models){e=new h.Box3;for(var t=0;t<b.length;t++){var r=b[t];e.union(r.getBoundingBox())}}else e=p.getVisibleBounds();var i=n.hasOwnProperty("is2d")?n.is2d:p.is2d,o=L.settings.deviceHeight,s=n.excludeCutPlanes?void 0:m.getCutPlanesRaw(),a=s&&s[0],l=b[0]&&b[0].getBoundingBox();return u.SceneMath.getPixelsPerUnit(T,i,e,o,a,l)},K=Y(),Q=[],Z=null,J=function(e){n.excludeThemingColors&&e instanceof l.RenderBatch&&(e.frags.is2d||(Z=e.frags.db2ThemingColor,e.frags.db2ThemingColor=Q))},$=function(e){Z&&(e.frags.db2ThemingColor=Z,Z=null)},ee=new h.Vector4(0,0,-1,-1e20),te=[],re=null,ne=function(){re=m.getCutPlanes();var e=re.length;if(te.length!==e){te.length=e;for(var t=0;e>t;t++)te[t]=ee}v.toggleTwoSided(m.setCutPlanes(te))},ie=function(){v.toggleTwoSided(m.setCutPlanes(re))},oe=function(){G();var e=L.getColorTarget(),t=D.aoEnabled||D.antialias;if(t&&(D.aoEnabled&&L.computeSSAO(),e=L.getNamedTarget("overlay"),L.getBlendPass().uniforms.tOverlay.value=null,L.setOffscreenTarget(e),L.presentBuffer()),n.returnAsTarget)return void r(L,e,T);var i=L.targetToCanvas(e);i.canvas.toBlob(function(e){var t=Object(a.getGlobal)().URL.createObjectURL(e);r&&r(t)})},se=function ae(){var r=!z();if(r)return void(O=Object(a.getGlobal)().setTimeout(ae,0));var i=performance.now();g.pushViewport();var o=g.getPixelRatio();g.setPixelRatio(1),g.setViewport(0,0,e,t);var s=p.getPixelsPerUnit(p.camera,p.getVisibleBounds());for(m.updatePixelScale(K,e,t),n.excludeCutPlanes&&ne(),n.beforeRender&&n.beforeRender();R<_.length;){var c=_[R];q(c),J(c),c instanceof l.RenderBatch&&c.applyVisibility(d.RenderFlags.RENDER_NORMAL,C);var u={type:f.RENDER_SCENE_PART,scene:c,wantColor:!0,wantSAO:!0,wantID:!1,context:L};p.api.dispatchEvent(u),u.preventDefault||(L.renderScenePart(c,!0,!0,!1,!1),(c.frags&&!c.frags.areAllVisible()||H)&&(c instanceof l.RenderBatch&&c.applyVisibility(d.RenderFlags.RENDER_HIDDEN,C),v.setEdgeColor(p.edgeColorGhosted),c.overrideMaterial=p.fadeMaterial,L.renderScenePart(c,!0,!0,!1,!1),v.setEdgeColor(p.edgeColorMain),c.overrideMaterial=null)),$(c),X(c),R++;var h=performance.now()-i;if(h>I)break}if(g.popViewport(),g.setPixelRatio(o),m.updatePixelScale(s,v.settings.deviceWidth,v.settings.deviceHeight),n.excludeCutPlanes&&ie(),n.afterRender&&n.afterRender(),R===_.length?oe():O=Object(a.getGlobal)().setTimeout(ae,0),n.onProgress){var y=Math.floor(100*R/_.length);y!==N&&(N=y,n.onProgress(y))}};return se(),k}),m=function(e,t,r,n,i){var o=i.fullPage,s=i.bounds,l=i.getCropBounds,c=i.margin,u=i.overlayRenderer,d=i.overlayRendererExtraOptions;o&&(s=e.impl.getVisibleBounds());var h=e.impl.getCanvasBoundingClientRect(),f=h.width,m=e.navigation.getCamera();s&&(m=w(e,s,c));var g=y(e,m);try{if(o){var v=g.size(),b=f/Math.max(v.x,v.y);t=Math.floor(t*b),r=Math.floor(r*b)}var x=function(i){if(o){var c=t/f;g.min.x*=c,g.min.y*=c,g.max.x*=c,g.max.y*=c,_(i,g,n)}else if(l){var u=l(e,m,s);_(i,u,n)}else i.toBlob(function(e){var i=Object(a.getGlobal)().URL.createObjectURL(e);n(i,t,r)})},E=e.impl.selector.getSelection();return e.clearSelection(),p(t,r,function(n,i,o){if(e.impl.selector.setSelection(E),u){var s={width:t,height:r,ctx:n,target:i,screenshotCamera:o,onRenderDone:x};u(e,s,d)}else{var a=n.targetToCanvas(i),l=a.canvas;x(l)}},{returnAsTarget:!0,camera:m},e.impl)}catch(S){n(null)}},g=function(e,t,r){var n=e.impl.getCanvasBoundingClientRect(),i=Math.floor(n.width),o=Math.floor(n.height),s=function(e,r,n){return e?void b(e,r,n,function(e){t(e,r,n)}):void t(null)};m(e,i,o,s,r)},v=function(e){var t=e.impl.getVisibleBounds();if(e.model.hasPageShadow()){t=t.clone();var r=e.model.getMetadata("page_dimensions","page_width");t.max.x-=.0075*r,t.min.y+=.0075*r}return t},y=function(e,t){var r=v(e),n=e.worldToClient(r.min,t),i=e.worldToClient(r.max,t),o=(new h.Box3).setFromPoints([n,i]);return o},_=function(e,t,r){var n=Object(a.getGlobal)().document,i=n.createElement("canvas"),o=i.getContext("2d"),s=t.size(),l=Math.min(Math.floor(s.x),e.width),c=Math.min(Math.floor(s.y),e.height);i.width=l,i.height=c;var u=Math.max(Math.floor(t.min.x),0),d=Math.max(Math.floor(t.min.y),0),h=l,f=c;o.drawImage(e,u,d,h,f,0,0,l,c),i.toBlob(function(e){var t=Object(a.getGlobal)().URL.createObjectURL(e);r(t,l,c)},"image/png")},b=function(e,t,r,n){var i=Object(a.getGlobal)().document,o=i.createElement("canvas"),s=o.getContext("2d"),l=new Image;o.width=t,o.height=r,l.src=e,l.onload=function(){s.drawImage(l,0,0,t,r);var e=o.toDataURL("image/png");n(e)}},x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.size(),n=Math.max(r.x,r.y,t);e.expandByVector(new h.Vector3((n-r.x)/2,(n-r.y)/2,0))},w=function(e,t,r){r=r||e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN;var n={horizontal:e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN,vertical:e.navigation.FIT_TO_VIEW_VERTICAL_MARGIN};e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=r,e.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=r;var i=e.getState({viewport:!0});e.navigation.fitBounds(!0,t,!1);
var o=e.navigation.getCamera().clone();return e.restoreState(i,void 0,!0),e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=n.horizontal,e.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=n.vertical,e.impl.updateNearFarValues(o,t),o},E={getScreenShotLegacy:n,getScreenShot:p,getScreenShotWithBounds:m,getScreenShotAtScreenSize:g,getSceneWorldBounds:v,getSceneClientBounds:y,cropImage:_,blobToImage:b,makeBoundsSquare:x,getCameraWithFitBounds:w}},"./src/application/Thumbnails.js":function(e,t,r){"use strict";function n(e,t){if(!e)return Promise.reject(new Error("Missing instance of BubbleNode"));var r=e.findParentGeom2Dor3D();if(!r)return Promise.reject(new Error("No thumbnail available."));t=t||{};var n=t.size||u;return e.getRootNode().data.isVectorPDF||r.data.isVectorPDF?new Promise(function(t){var r=e.data,o=e.getRootNode().data.getPDF(),s=n,a=n,l="".concat(r.guid,"/thumbnail/").concat(s,"x").concat(a);i(o,r.page,s,a,l,t)}):new Promise(function(t,r){var i=e.getRootNode(),o={urn:i.urn(),width:n,height:n,guid:encodeURIComponent(e.guid()),acmsession:s.endpoint.getAcmSession()},l=function(e){var r=new FileReader;r.onload=function(e){var r=e.target.result;t(r)},r.readAsDataURL(e)},u=function(e){r(new Error("Thumbnail is unavailable."))},d={responseType:"blob",skipAssetCallback:!0,size:n,guid:o.guid,acmsession:o.acmSession},h="urn:"+o.urn;e.data.thumbnailUrn&&(h=i.getDocument().getFullPath(e.data.thumbnailUrn));var f=void 0,p=Object(s.getEnv)();f=c.EnvironmentConfigurations[p].UPSTREAM,a.ViewingService.getThumbnail(Object(s.initLoadContext)({endpoint:f}),h,l,u,d)})}function i(e,t,r,n,i,s){var a=o.LocalStorage.getItem(i);a?s(a):e.getPage(t).then(function(e){var t=Object(l.getGlobal)().document,a=t.createElement("canvas");a.width=r,a.height=n;var c=a.getContext("2d"),u={scale:1},d=e.getViewport(u),h=Math.min(a.width/d.width,a.height/d.height);e.render({canvasContext:c,viewport:e.getViewport({scale:h})}).promise.then(function(){a.toBlob(function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){o.LocalStorage.setItem(i,t.result),s(t.result)}},"image/png")})})}r.r(t),r.d(t,"Thumbnails",function(){return d});var o=r("./src/application/LocalStorage.js"),s=r("./src/file-loaders/net/endpoints.js"),a=r("./src/file-loaders/net/Xhr.js"),l=r("./src/compat.js"),c=r("./src/envinit.js"),u=200,d={getUrlForBubbleNode:n}},"./src/application/Viewer3D.css":function(e,t,r){},"./src/application/Viewer3D.js":function(e,t,r){"use strict";function n(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){function s(e){n(l,i,o,s,a,"next",e)}function a(e){n(l,i,o,s,a,"throw",e)}var l=e.apply(t,r);s(void 0)})}}function o(e,t,r,n){var i=$.getGlobal(),o={url:e,lmvViewerVersion:i.LMV_VIEWER_VERSION,lmvFileExtension:t,returnValue:r,lmvBuildType:i.LMV_BUILD_TYPE};if(n){o.isOtg=n.isOtg(),o.geometrySize=n.data.size||0;var s=n.findViewableParent();try{var a=s&&s.name(),l=a&&a.lastIndexOf("."),c=l>=0&&a.substring(l+1);c&&(o.seedFileExt=c.toLowerCase())}catch(u){}}J.analytics.track("LoadModel",o)}function s(){if($.getGlobal().WebGLRenderingContext){for(var e=$.getGlobal().document.createElement("canvas"),t=["webgl","experimental-webgl","moz-webgl","webkit-3d"],r=!1,n=0;4>n;n++)try{if(r=e.getContext(t[n]),r&&"function"==typeof r.getParameter)return 1}catch(i){}return 0}return-1}function a(e,t){if(this.setGlobalManager(new Y.GlobalManager),e){if(this.clientContainer=e,this.container=this.getDocument().createElement("div"),this.container.classList.add("adsk-viewing-viewer"),this.container.style.height="100%",this.container.style.width="100%",this.container.style.overflow="hidden",this.container.classList.add(Object(u.isTouchDevice)()?"touch":"notouch"),this.clientContainer.appendChild(this.container),this.config=t||{},this.contextMenu=null,this.contextMenuCallbacks={},this.started=!1,this.theme=this.config.theme||"dark-theme",this.container.classList.add(this.theme),this.containerLayerOrder=this.config.containerLayerOrder||te,Object(u.isChrome)()&&this.container.classList.add("quality-text"),"CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";this.canvasWrap=this.getDocument().createElement("div"),this.canvasWrap.classList.add("canvas-wrap"),this.canvas=this.getDocument().createElement("canvas"),this.canvas.tabIndex=0,this.canvas.setAttribute("data-viewer-canvas","true"),this.canvasWrap.appendChild(this.canvas),this.container.appendChild(this.canvasWrap),this.canvas.viewer=this}var r={prefix:"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.",localStorage:!Object(u.isNodeJS)()};this._displayEdges=null,this._setDoubleSided=null,this.prefs=new p.Preferences(this,r),this.profile=null,this.profileManager=new v.ProfileManager,this._hotkeyManager=new S.HotkeyManager,this.extensionCache=null,this.running=!1,this._pushedTool="",this._defaultNavigationTool="",this.id=ee++,this.impl=new V.Viewer3DImpl(this.canvas,this),this.overlays=new X.OverlayManager(this.impl),this._loadingSpinner=new G.LoadingSpinner,this._loadingSpinner.setGlobalManager(this.globalManager),this.trackADPTimer=[]}function l(e,t){return new Promise(function(r,n){function i(t){2===a&&r({viewer:e,model:t})}function o(r){r.model.getData().loadOptions.bubbleNode===t.bubbleNode&&(e.removeEventListener(L.GEOMETRY_LOADED_EVENT,o),a++,t.skipPropertyDb?i(r.model):r.model.getProperties(1,function(e){return i(r.model)},function(e){return n(e)}))}function s(r){r.model.getData().loadOptions.bubbleNode===t.bubbleNode&&(e.removeEventListener(L.TEXTURES_LOADED_EVENT,s),a++,i(r.model))}var a=0;e.addEventListener(L.GEOMETRY_LOADED_EVENT,o),e.addEventListener(L.TEXTURES_LOADED_EVENT,s)})}r.r(t),r.d(t,"Viewer3D",function(){return a}),r.d(t,"waitForCompleteLoad",function(){return l});var c=r("./thirdparty/three.js/three.js"),u=(r.n(c),r("./src/compat.js")),d=r("./src/logger/Logger.js"),h=r("./src/application/Profile.js"),f=r("./src/application/PreferenceNames.js"),p=r("./src/application/Preferences.js"),m=r("./src/application/ProfileSettings.js"),g=r("./src/measurement/DisplayUnits.js"),v=r("./src/application/ProfileManager.js"),y=r("./src/globals.js"),_=r("./src/file-loaders/net/ErrorCodes.js"),b=r("./src/application/EventDispatcher.js"),x=r("./src/application/EventUtils.js"),w=r("./src/application/ScreenModeDelegate.js"),E=r("./src/application/ExtensionManager.js"),S=r("./src/tools/HotkeyManager.js"),A=r("./src/tools/Navigation.js"),M=r("./src/tools/ToolController.js"),T=r("./src/tools/ViewingUtilities.js"),C=r("./src/tools/DefaultHandler.js"),j=r("./src/tools/GestureHandler.js"),P=r("./src/globalization/i18next.js"),L=(r("./src/file-loaders/net/endpoints.js"),r("./src/application/EventTypes.js")),D=(r.n(L),r("./src/application/FileLoaderManager.js")),I=r("./src/file-loaders/main/PropDbLoader.js"),R=r("./src/resource-loader.js"),O=r("./src/application/ViewerState.js"),k=r("./src/net/LiveReviewClient.js"),N=r("./src/tools/OrbitDollyPanTool.js"),F=r("./src/tools/autocam/Autocam.js"),V=r("./src/application/Viewer3DImpl.js"),U=r("./src/application/bubble.js"),B=r("./src/wgs/scene/consolidation/Consolidation.js"),z=r("./src/tools/KeyCode.js"),G=r("./src/application/LoadingSpinner.js"),H=r("./src/wgs/scene/SceneMath.js"),W=r("./src/application/ScreenShot.js"),q=r("./src/file-loaders/loader-extensions.js"),X=r("./src/application/OverlayManager.js"),Y=r("./src/application/GlobalManager.js"),K=r("./src/application/GlobalManagerMixin.js"),Q=r("./src/application/LightPresets.js"),Z=r("./src/wgs/scene/ModelExploder.js"),J=r("./src/analytics/index.js"),$=Autodesk.Viewing,ee=0,te=["markups-svg","pushpin-container"];b.EventDispatcher.prototype.apply(a.prototype),w.ScreenModeMixin.prototype.apply(a.prototype),E.ExtensionMixin.prototype.apply(a.prototype),K.GlobalManagerMixin.call(a.prototype),a.prototype.constructor=a,Object.defineProperty(a.prototype,"model",{get:function(){return this.impl.model},set:function(){throw"Do not set viewer.model"}}),a.ViewerCount=0,a.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"]},clickShift:{onObject:["selectToggle"]},disableSpinner:!1,disableMouseWheel:!1,disableTwoFingerSwipe:!1},Object.defineProperty(a.prototype,"scene",{get:function(){return this.impl.scene},set:function(){throw"Do not set viewer.scene"}}),Object.defineProperty(a.prototype,"sceneAfter",{get:function(){return this.impl.sceneAfter},set:function(){throw"Do not set viewer.sceneAfter"}}),a.createHeadlessViewer=function(){var e=new a;return e.impl.initialize(),e.impl.setLightPreset(0),e},a.prototype.start=function(e,t,r,n,i){if(this.started)return 0;this.started=!0;var o=this,s=o.initialize(i);return 0!==s?(n&&setTimeout(function(){n(s)},1),s):(setTimeout(function(){o.setUp(o.config)},1),e&&this.loadModel(e,t,r,n),0)},a.prototype.startWithDocumentNode=function(e,t,r){var n=this;return new Promise(function(i,o){if(n.started)return 0;n.started=!0;var s=n.initialize();if(0!==s)return void setTimeout(function(){o(s)},1);setTimeout(function(){n.setUp(n.config)},1);var a=n.loadDocumentNode(e,t,r);a.then(i)["catch"](o)})},a.prototype.registerUniversalHotkeys=function(){var e,t,r,n=this;e=function(){return n.navigation.setRequestFitToView(!0),!0},n._hotkeyManager.pushHotkeys("Autodesk.FitToView",[{keycodes:[z.KeyCode.f],onPress:e}]),e=function(){return n.navigation.setRequestHomeView(!0),!0},n._hotkeyManager.pushHotkeys("Autodesk.Home",[{keycodes:[z.KeyCode.h],onPress:e},{keycodes:[z.KeyCode.HOME],onPress:e}]),t=function(){return n.objectContextMenu&&n.objectContextMenu.hide()?!0:(n.dispatchEvent({type:L.ESCAPE_EVENT}),!0)},n._hotkeyManager.pushHotkeys("Autodesk.Escape",[{keycodes:[z.KeyCode.ESCAPE],onRelease:t}]),e=function(){return r=n.getActiveNavigationTool(),n.setActiveNavigationTool("pan")},t=function(){return n.setActiveNavigationTool(r)};var i=[{keycodes:[z.KeyCode.SHIFT],onPress:e,onRelease:t},{keycodes:[z.KeyCode.SPACE],onPress:e,onRelease:t}];n._hotkeyManager.pushHotkeys("Autodesk.Pan",i,{tryUntilSuccess:!0})},a.prototype.createControls=function(){var e=this,t=e.impl;return e.navigation=new A.Navigation(t.camera),e.__initAutoCam(t),e.utilities=new T.ViewingUtilities(t,e.autocam,e.navigation),e.clickHandler=new C.DefaultHandler(t,e.navigation,e.utilities),e.toolController=new M.ToolController(t,e,e.autocam,e.utilities,e.clickHandler),e.toolController.registerTool(new j.GestureHandler(e)),e.toolController.registerTool(e._hotkeyManager),e.toolController.activateTool(e._hotkeyManager.getName()),e.registerUniversalHotkeys(),e.toolController.registerTool(new N.OrbitDollyPanTool(t,e,this.config.navToolsConfig)),e.toolController},a.prototype.initialize=function(e){this.setScreenModeDelegate(this.config?this.config.screenModeDelegate:void 0);var t=this.getDimensions();if(this.canvas.width=t.width,this.canvas.height=t.height,Object(u.isIOSDevice)()&&this.getWindow().devicePixelRatio&&(this.canvas.width/=this.getWindow().devicePixelRatio,this.canvas.height/=this.getWindow().devicePixelRatio),this.impl.initialize(e),!this.impl.glrenderer()){var r=s();if(0>=r)return-1===r?_.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED:_.ErrorCodes.BROWSER_WEBGL_DISABLED}var n=this;if(Object(u.isIOSDevice)()){var i;this.onResizeCallback=function(e){clearTimeout(i),i=setTimeout(n.resize.bind(n),500)}}else this.onResizeCallback=function(e){var t=n.impl.camera.clientWidth,r=n.impl.camera.clientHeight,i=n.container.clientWidth,o=n.container.clientHeight;(t!==i||r!==o)&&n.resize()};this.addWindowEventListener("resize",this.onResizeCallback,!1),this.onScrollCallback=function(e){n.impl.canvasBoundingclientRectDirty=!0},this.addWindowEventListener("scroll",this.onScrollCallback),this.initContextMenu(),this.localize(),this.impl.controls=this.createControls(),this.initializePrefListeners(),this.setDefaultNavigationTool("orbit"),this.impl.controls&&this.impl.controls.setAutocam(this.autocam);var o=this.config&&this.config.canvasConfig?this.config.canvasConfig:a.kDefaultCanvasConfig;return this.setCanvasClickBehavior(o),o.disableSpinner||(this.loadSpinner=this._loadingSpinner.createDom(this.container)),this.viewerState=new O.ViewerState(this),this.config&&this.config.hasOwnProperty("startOnInitialize")&&!this.config.startOnInitialize||this.run(),this.getWindow().NOP_VIEWER=this,this.addEventListener(L.MODEL_ADDED_EVENT,function(e){n.onModelAdded(e.model,e.preserveTools)}),this.addEventListener(L.GEOMETRY_LOADED_EVENT,function(e){e.model.is2d()&&!e.model.isLeaflet()&&n.navigation.setMinimumLineWidth(e.model.loader.svf.minLineWidth)}),this.dispatchEvent(L.VIEWER_INITIALIZED),this.trackADPSettingsOptions(),this.trackADPExtensionsLoaded(),a.ViewerCount++,0},a.prototype.setUp=function(e){if(this.config=e||{},Array.isArray(this.config.extensions))for(var t=this.config.extensions,r=0;r<t.length;++r)this.loadExtension(t[r],this.config);var n=Object(y.getParameterByName)("lmv_viewer_debug");"true"===n&&this.loadExtension("Autodesk.Debug",this.config);var i=this.config.canvasConfig||a.kDefaultCanvasConfig;this.setCanvasClickBehavior(i),this._onAggregatedSelectionChanged=this._onAggregatedSelectionChanged.bind(this),this.addEventListener(L.AGGREGATE_SELECTION_CHANGED_EVENT,this._onAggregatedSelectionChanged)},a.prototype.tearDown=function(){if(this.clearSelection(),this.removeEventListener(L.AGGREGATE_SELECTION_CHANGED_EVENT,this._onAggregatedSelectionChanged),this.loadedExtensions){for(var e in this.loadedExtensions)try{this.unloadExtension(e)}catch(t){d.logger.error("Failed to unload extension: "+e,t,Object(_.errorCodeString)(_.ErrorCodes.VIEWER_INTERNAL_ERROR)),d.logger.track({category:"error_unload_extension",extensionId:e,error_message:t.message,call_stack:t.stack})}this.loadedExtensions=null}for(this.toolController&&(this.toolController.enableMouseButtons(!1),this.toolController.deactivateTool("gestures")),d.logger.reportRuntimeStats(!0),this._loadingSpinner.show(),this.liveReviewClient&&(this.liveReviewClient.destroy(),this.liveReviewClient=null);this.trackADPTimer.length>0;)clearTimeout(this.trackADPTimer.pop());this.impl.unloadCurrentModel(),this.impl.setCutPlaneSet("__set_view",void 0)},a.prototype._onAggregatedSelectionChanged=function(){if(this.navigation.getSelectionSetsPivot()){var e=this.impl.selector.getAggregateSelection();if(e.length){var t=this.impl.get3DBounds(e);this.utilities.setPivotPoint(t.center(),!0,!0),this.utilities.pivotActive(this.navigation.getPivotSetFlag(),!0)}}},a.prototype.run=function(){this.running||(this.resize(),this.running=!0,this.impl.run())},a.prototype.localize=function(){P.i18n.localize()},a.prototype.__initAutoCam=function(e){function t(e){i.autocamCamera.isPerspective!==o.isPerspective&&(i.autocamCamera.isPerspective?i.navigation.toPerspective():i.navigation.toOrthographic()),i.navigation.setVerticalFov(i.autocamCamera.fov,!1),i.navigation.setView(i.autocamCamera.position,i.autocamCamera.target),i.navigation.setPivotPoint(i.autocamCamera.pivot),i.navigation.setCameraUpVector(i.autocamCamera.up),e&&i.navigation.setWorldUpVector(i.autocamCamera.worldup),i.impl.syncCamera(e)}function r(e){i.utilities?i.utilities.pivotActive(e,!1):i.impl.controls.pivotActive(e,!1)}function n(){i.fireEvent({type:L.CAMERA_TRANSITION_COMPLETED})}var i=this,o=e.camera;o.pivot||(o.pivot=new c.Vector3(0,0,0)),o.target||(o.target=new c.Vector3(0,0,0)),o.worldup||(o.worldup=o.up.clone()),i.autocamCamera=o.clone(),i.autocamCamera.target=o.target.clone(),i.autocamCamera.pivot=o.pivot.clone(),i.autocamCamera.worldup=o.worldup.clone(),i.autocam=new F.Autocam(i.autocamCamera,i.navigation,i.canvas),i.autocam.setGlobalManager(this.globalManager),i.autocam.registerCallbackCameraChanged(t),i.autocam.registerCallbackPivotDisplay(r),i.autocam.registerCallbackTransitionCompleted(n),i.addEventListener("cameraChanged",function(e){var t=e.camera;i.autocam.sync(t)}),i.autocam.sync(o)},a.prototype.uninitialize=function(){this.removeWindowEventListener("resize",this.onResizeCallback,!1),this.onResizeCallback=null,this.removeWindowEventListener("scroll",this.onScrollCallback),this.onScrollCallback=null,this.canvas?this.canvas.removeEventListener("mousedown",this.onMouseDown):this.container&&this.container.removeEventListener("mousedown",this.onMouseDown),this.onMouseDown=null,this.canvas?this.canvas.removeEventListener("mouseup",this.onMouseUp):this.container&&this.container.removeEventListener("mouseup",this.onMouseUp),this.onMouseUp=null,this.canvas.parentNode.removeChild(this.canvas),this.canvas.viewer=null,V.InitParametersSetting.canvas===this.canvas&&(V.InitParametersSetting.canvas=null),this.canvas=null,this.canvasWrap=null,this.viewerState=null,d.logger.reportRuntimeStats(),d.logger.track({category:"viewer_destroy"},!0),this.toolController&&(this.toolController.uninitialize(),this.toolController=null,this.clickHandler=null,this.utilities=null),this.navigation&&(this.navigation.uninitialize(),this.navigation=null),this.impl&&(this.impl.dtor(),this.impl=null),this.overlays&&(this.overlays.dtor(),this.overlays=null),this.loadSpinner=null,this._loadingSpinner.destroy(),this.prefs&&this.prefs.clearListeners(),this.prefs=null,this.profile=null,this.profileManager=null,this.autocam.dtor(),this.autocam=null,this.autocamCamera=null,this._hotkeyManager.popHotkeys("Autodesk.FitToView"),this._hotkeyManager.popHotkeys("Autodesk.Home"),this._hotkeyManager.popHotkeys("Autodesk.Escape"),this._hotkeyManager.popHotkeys("Autodesk.Pan"),this._hotkeyManager.popHotkeys("Autodesk.Orbit"),a.ViewerCount--,0===a.ViewerCount&&Object(I.clearPropertyWorkerCache)(),this.onDefaultContextMenu&&(this.container.removeEventListener("contextmenu",this.onDefaultContextMenu,!1),this.onDefaultContextMenu=null),this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this._displayEdges&&(this.removeEventListener(L.GEOMETRY_LOADED_EVENT,this._displayEdges),this._displayEdges=null),this._setDoubleSided&&(this.removeEventListener(L.MODEL_ADDED_EVENT,this._setDoubleSided),this._setDoubleSided=null),this.extensionCache=null,this.clientContainer=null,this.config=null,this.contextMenu=null,this.contextMenuCallbacks=null,this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.dispatchEvent(L.VIEWER_UNINITIALIZED),this.listeners={},$.getGlobal().NOP_VIEWER===this&&($.getGlobal().NOP_VIEWER=null),d.logger.log("viewer destroy")},a.prototype.finish=function(){this.tearDown(),this.uninitialize()},a.prototype.setLoadHeuristics=function(e){var t=e.bubbleNode;if(t){var r=t.findViewableParent();if(r){var n=r.name();e.fileExt=n.slice(n.length-3).toLowerCase();var i=["rvt","nwd","nwc","ifc"];"undefined"==typeof e.isAEC&&-1!==i.indexOf(e.fileExt)&&(e.isAEC=!0)}}if(e.isAEC){if("undefined"==typeof e.useConsolidation){var o=Object(y.getParameterByName)("useConsolidation")||"";e.useConsolidation="true"===o?!0:"false"===o?!1:void 0}"undefined"==typeof e.useConsolidation&&(e.useConsolidation=!Object(u.isMobileDevice)()&&!Object(u.isNodeJS)()),"undefined"==typeof e.createWireframe&&(e.createWireframe=!Object(u.isMobileDevice)()),"undefined"==typeof e.disablePrecomputedNodeBoxes&&(e.disablePrecomputedNodeBoxes=!0)}else"undefined"==typeof e.createWireframe&&(e.createWireframe=!Object(u.isMobileDevice)()&&this.prefs.edgeRendering);e.useConsolidation&&!e.bvhOptions&&(e.bvhOptions={},B.Consolidation.applyBVHDefaults(e.bvhOptions))},a.prototype.trackADPSettingsOptions=function(){var e=this;this.trackADPTimer.push(setTimeout(function(){if(e.prefs){var t={category:"settingOptionsStatus",switchSheetColorWhiteToBlack:e.prefs.swapBlackAndWhite,leftHandedMouseSetup:e.prefs.leftHandedMouseSetup,openPropertiesOnSelect:e.prefs.openPropertiesOnSelect,orbitPastWorldPoles:e.prefs.orbitPastWorldPoles,reverseMouseZoomDirection:e.prefs.reverseMouseZoomDir,fusionStyleOrbit:e.prefs.fusionOrbit,setPivotWithLeftMouseButton:e.prefs.clickToSetCOI,zoomTowardPivot:e.prefs.zoomTowardsPivot,viewCubeActsOnPivot:e.prefs.alwaysUsePivot,showViewCube:e.prefs.viewCube,environmentImageVisible:e.prefs.envMapBackground,displayEdges:e.prefs.edgeRendering,displayPoints:e.prefs.pointRendering,displayLines:e.prefs.lineRendering,ghostHiddenObjects:e.prefs.ghosting,groundReflection:e.prefs.groundReflection,groundShadow:e.prefs.groundShadow,ambientShadows:e.prefs.ambientShadows,antiAliasing:e.prefs.antialiasing,progressiveModelDisplay:e.prefs.progressiveRendering,smoothNavigation:e.prefs.optimizeNavigation};d.logger.track(t)}},3e4))},a.prototype.trackADPExtensionsLoaded=function(){var e=this,t={};t.category="loaded_extensions",this.trackADPTimer.push(setTimeout(function(){if(e.loadedExtensions)for(var r in e.loadedExtensions)t[r]=r;d.logger.track(t)},3e4))},a.prototype.activateDefaultNavigationTools=function(e){if(!Object(u.isNodeJS)()){var t=e?"pan":"orbit";this.setDefaultNavigationTool(t),this.setActiveNavigationTool(t),this.toolController&&(this.toolController.enableMouseButtons(!0),this.toolController.activateTool("gestures"))}},a.prototype.registerDimensionSpecificHotkeys=function(e){if(this._hotkeyManager)if(e)this._hotkeyManager.popHotkeys("Autodesk.Orbit");else{var t,r=this,n=function(){return t=r.getActiveNavigationTool(),r.setActiveNavigationTool("orbit")},i=function(){return r.setActiveNavigationTool(t)},o=[{keycodes:[z.KeyCode.ALT],onPress:n,onRelease:i}];this._hotkeyManager.pushHotkeys("Autodesk.Orbit",o,{tryUntilSuccess:!0})}},a.prototype.onModelAdded=function(e,t){e.is2d()&&!e.isLeaflet()&&this.navigation.setMinimumLineWidth(e.loader.svf.minLineWidth);var r=this.impl.modelQueue().getModels(),n=1===r.length;n&&this.initializeFirstModelPresets(e,t)},a.prototype.initializeFirstModelPresets=function(e,t,r){e.is2d()&&this.activateLayerState("Initial"),r||e.getData().loadOptions.preserveView||(this.setActiveNavigationTool(),this.impl.setViewFromFile(e,!0),this.toolController.recordHomeView()),this.registerDimensionSpecificHotkeys(e.is2d()),t||this.activateDefaultNavigationTools(e.is2d()),this.navigation.setIs2D(this.impl.modelQueue().areAll2D());var n=e.getData();n.isLeaflet?this.navigation.setConstraints2D(n.bbox,n.maxPixelPerUnit):this.navigation.setConstraints2D()},a.prototype.loadModel=function(){var e=i(regeneratorRuntime.mark(function t(e,r,n,i,s){var a,l,c,h,p,v,b,x,w,E,S,A;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v=function(e,t,r){a._loadingSpinner.hide(),i&&i(e,t,r)},p=function(e,t){return a.impl._removeLoadingFile(h),e?(a.dispatchEvent({type:L.LOADER_LOAD_ERROR_EVENT,error:e,loader:h}),void v(e.code,e.msg,e.args)):(t.getData().underlayRaster=r.underlayRaster&&t.getLeaflet(),r.loadAsHidden?a.impl.modelQueue().addHiddenModel(t):a.impl.addModel(t),t.loader&&t.loader.notifiesFirstPixel?a.addEventListener(L.RENDER_FIRST_PIXEL,function(){a._loadingSpinner.hide()},{once:!0}):a._loadingSpinner.hide(),void(n&&n(t)))},a=this,l=a.impl._reserveLoadingFile(),r=r||{},"undefined"==typeof r.skipPropertyDb&&(c=Object(y.getParameterByName)("skipPropertyDb")||"",r.skipPropertyDb="true"===c?!0:"false"===c?!1:void 0),b=e.toLowerCase().match(/\.([a-z0-9]+)(\?|$)/),x=b?b[1]:null,w=this.config&&this.config.loaderExtensions&&this.config.loaderExtensions[x]||x in q["default"]&&q["default"][x],!w||this.isExtensionLoaded(w)){t.next=19;break}return t.prev=9,t.next=12,this.loadExtension(w);case 12:t.next=19;break;case 14:return t.prev=14,t.t0=t["catch"](9),a.impl._removeLoadingFile(l),i&&i(_.ErrorCodes.VIEWER_INTERNAL_ERROR,t.t0.toString()),t.abrupt("return",!1);case 19:if(E=r&&r.fileLoader?r.fileLoader:D.FileLoaderManager.getFileLoaderForExtension(x)){t.next=25;break}return a.impl._removeLoadingFile(l),d.logger.error("File extension not supported:"+x,Object(_.errorCodeString)(_.ErrorCodes.UNSUPORTED_FILE_EXTENSION)),v(_.ErrorCodes.UNSUPORTED_FILE_EXTENSION,"File extension not supported",0,x),t.abrupt("return",!1);case 25:return this.setLoadHeuristics(r),this.impl.hasModels()||this._loadingSpinner.show(),"function"==typeof E.getExistingInstance&&(h=E.getExistingInstance(e,r,this.config)),h||(h=new E(this.impl,this.config)),a.impl._addLoadingFile(l,h),S=h.loadFile(e,r,p,s),S||a.impl._removeLoadingFile(h),this.fireEvent({type:L.LOADER_LOAD_FILE_EVENT,loader:h}),r.skipPrefs?(void 0===this.prefs.get(f.Prefs.DISPLAY_UNITS)&&this.prefs.set(f.Prefs.DISPLAY_UNITS,new m.EnumType(g.displayUnitsEnum)),void 0===this.prefs.get(f.Prefs.DISPLAY_UNITS_PRECISION)&&this.prefs.set(f.Prefs.DISPLAY_UNITS_PRECISION,new m.EnumType(g.displayUnitsPrecisionEnum))):(Object(u.isNodeJS)()||this.profile||(A=this.chooseProfile(r),this.setProfile(A)),this.impl.setRenderingPrefsFor2D(!h.is3d())),o(e,x,S,r.bubbleNode),t.abrupt("return",S);case 36:case"end":return t.stop()}},t,this,[[9,14]])}));return function(t,r,n,i,o){return e.apply(this,arguments)}}(),a.prototype.isLoadDone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.geometry,r=void 0===t?!0:t,n=e.propDb,i=void 0===n?!0:n,o=e.textures,s=void 0===o?!0:o,a=e.hidden,l=void 0===a?!1:a,c=e.onlyModels,u=void 0===c?void 0:c;if(!u){if(!this.started)return!0;if(this.impl._hasLoadingFile())return!1}if(s&&Autodesk.Viewing.Private.TextureLoader.requestsInProgress()>0)return!1;r=r||s;var d=function(e){return!e||(r?e.isLoadDone():e.modelRootLoaded)&&(!i||!e.getPropertyDb()||e.getPropertyDb().isLoadDone())};if(u)return Array.isArray(u)?u.every(d):d(u);var h=this.impl.modelQueue();return h.getModels().every(d)&&(!l||h.getHiddenModels().every(d))},a.prototype.waitForLoadDone=function(e){var t=this;return new Promise(function(r,n){var i=e||{},o=i.geometry,s=void 0===o?!0:o,a=i.propDb,l=void 0===a?!0:a,c=i.textures,u=void 0===c?!0:c,d=i.hidden,h=void 0===d?!1:d,f=i.onlyModels,p=void 0===f?void 0:f;s=s||u;var m={geometry:s,propDb:l,textures:u,hidden:h,onlyModels:p},g=function(){return t.started&&(t.impl._hasLoadingFile()>0||t.impl.modelQueue().getModels().length>0||t.impl.modelQueue().getHiddenModels().length>0)},v=!p&&g();if(v&&t.isLoadDone(m))return void r();var y,_=function(){v=v||g(),v&&t.isLoadDone(m)&&(y(),r())},b=function(e){y();var t=new Error("Error loading model");t.loader=e.loader,t.error=e.error,n(t)};y=function(){s&&t.removeEventListener(L.GEOMETRY_LOADED_EVENT,_),l&&(t.removeEventListener(L.OBJECT_TREE_CREATED_EVENT,_),t.removeEventListener(L.OBJECT_TREE_UNAVAILABLE_EVENT,_)),u&&t.removeEventListener(L.TEXTURES_LOADED_EVENT,_),t.removeEventListener(L.LOADER_LOAD_FILE_EVENT,_),t.removeEventListener(L.MODEL_ADDED_EVENT,_),t.removeEventListener(L.MODEL_REMOVED_EVENT,_),t.removeEventListener(L.LOADER_LOAD_ERROR_EVENT,b),t.removeEventListener(L.MODEL_ROOT_LOADED_EVENT,_),t.removeEventListener(L.VIEWER_UNINITIALIZED,r)},s&&t.addEventListener(L.GEOMETRY_LOADED_EVENT,_),l&&(t.addEventListener(L.OBJECT_TREE_CREATED_EVENT,_),t.addEventListener(L.OBJECT_TREE_UNAVAILABLE_EVENT,_)),u&&t.addEventListener(L.TEXTURES_LOADED_EVENT,_),t.addEventListener(L.LOADER_LOAD_FILE_EVENT,_),t.addEventListener(L.MODEL_ADDED_EVENT,_),t.addEventListener(L.MODEL_REMOVED_EVENT,_),t.addEventListener(L.LOADER_LOAD_ERROR_EVENT,b),t.addEventListener(L.MODEL_ROOT_LOADED_EVENT,_,{priority:-1e6}),t.addEventListener(L.VIEWER_UNINITIALIZED,function(){return n(new Error("Promise reject because viewer finished"))})})},a.prototype.unloadModel=function(e){e||(e=this.model),this.impl.unloadModel(e)},a.prototype.loadDocumentNode=function(e,t,r){var n=this,i=t,o={},s=e.getViewableUrn(i,o),a=i.findPropertyDbPath();s=e.getFullPath(s),a=e.getFullPath(a);var l={sharedPropertyDbPath:a,acmSessionId:e.getAcmSessionId(s),bubbleNode:i,applyRefPoint:!1,loadOptions:o,page:o.page||1};r=r||{};for(var c in l)r.hasOwnProperty(c)||(r[c]=l[c]);if(!r.keepCurrentModels&&this.impl.hasModels()){var u=this.config;this.tearDown(),this.setUp(u)}var d=i.findParentGeom2Dor3D(),h=d.extensions();Array.isArray(h)&&h.forEach(function(e){n.loadExtension(e,n.config)});var f=o.isPdf?this.loadExtension("Autodesk.PDF",this.config):Promise.resolve(),p=!r.disableUnderlayRaster&&o.tempRasterPath,m=p?this._loadTempRasterModel(e,r,i):Promise.resolve();return f.then(function(){return m}).then(function(){return new Promise(function(e,t){n.loadModel(s,r,function(t){var o=r.loadAsHidden||r.preserveView;o||"view"!==i.type()||n.setView(i,{skipTransition:!0}),e(t)},function(e){t(e)})})})},a.prototype.unloadDocumentNode=function(e){var t=this.impl.findModel(e,!0);if(t)return this.impl.unloadModel(t),!0;if(!this.impl.loaders)return!1;for(var r=0;r<this.impl.loaders.length;r++){var n=this.impl.loaders[r],i=n.options&&n.options.bubbleNode;if(i===e)return n.dtor(),this.impl.loaders.splice(r,1),!0}return!1},a.prototype._loadTempRasterModel=function(e,t,r){var n=this;return new Promise(function(i,o){if(t.loadAsHidden)return i();t.underlayRaster=!0,t.loadOptions.fitPaperSize=!0;var s=function(e){var t=e.getDocumentNode();return t&&t.getDocument().getPath()===r.getDocument().getPath()&&t.guid()===r.guid()&&!e.getData().isLeaflet},a=function h(e){var t=e.model;s(t)&&(n.initializeFirstModelPresets(t,!1,!0),n.removeEventListener(L.MODEL_ADDED_EVENT,h))};n.addEventListener(L.MODEL_ADDED_EVENT,a);var l=function f(e){var t=e.model;s(t)&&(t.getFragmentList().setObject2DVisible(-1,!0),n.removeEventListener(L.MODEL_REMOVED_EVENT,f),n.removeEventListener(L.MODEL_ADDED_EVENT,a),n.removeEventListener(L.GEOMETRY_LOADED_EVENT,u))};n.addEventListener(L.MODEL_REMOVED_EVENT,l);var c,u=function p(e){var t=e.model;s(t)&&(t.getFragmentList().setObject2DVisible(-1,!0),n.removeEventListener(L.MODEL_REMOVED_EVENT,l),c&&(n.unloadModel(c),c=null),n.removeEventListener(L.GEOMETRY_LOADED_EVENT,p))};n.addEventListener(L.GEOMETRY_LOADED_EVENT,u);var d=e.getFullPath(t.loadOptions.tempRasterPath);n.loadModel(d,t,function(e){t.loadOptions.fitPaperSize=void 0,t.underlayRaster=void 0,t.hideBackground=!0,c=e,i(e)},function(e){return t.loadOptions.fitPaperSize=void 0,t.underlayRaster=void 0,e===_.ErrorCodes.LOAD_CANCELED?o("load canceled"):void i()})})},a.prototype.getDimensions=function(){if(this.container){var e={};return this.getScreenMode()===w.ScreenMode.kFullScreen?(e.width=screen.width,e.height=screen.height):e=this.container.getBoundingClientRect(),{width:e.width,height:e.height}}return null},a.prototype.resize=function(){this.container.clientWidth>0&&this.container.clientHeight>0&&this.impl.resize(this.container.clientWidth,this.container.clientHeight)},a.prototype.getHotkeyManager=function(){return this._hotkeyManager},a.prototype.getCamera=function(){return this.impl.camera},a.prototype.getState=function(e){return this.viewerState.getState(e)},a.prototype.restoreState=function(e,t,r){var n=this.viewerState.restoreState(e,t,r);return n&&this.dispatchEvent({type:L.VIEWER_STATE_RESTORED_EVENT,value:n}),n},a.prototype.setView=function(e,t){if(!this.model)return!1;if(!(e&&e instanceof U.BubbleNode))return!1;var r=t?t.skipTransition:!1,n=t?t.useExactCamera:!0;if(e.getViewBox())return this.setViewFromViewBox(e.getViewBox(),e.name(),r),this.dispatchEvent({type:L.SET_VIEW_EVENT,view:e}),!0;var i=this.getCameraFromViewArray(e.data.camera);if(!i)return!1;this.impl.setViewFromCamera(i,r,n);var o=e.data.sectionPlane,s=e.data.sectionBox,a=e.data.sectionBoxTransform,l=this.model.getData().globalOffset;if(o){for(var u=[],d=0;d<o.length;d+=4){var h=new c.Vector4(o[d+0],o[d+1],o[d+2],o[d+3]);l&&(h.w+=c.Vector3.prototype.dot.call(l,new c.Vector3(o[d+0],o[d+1],o[d+2]))),u.push(h)}this.impl.setCutPlaneSet("__set_view",u)}else if(s&&a){var f=(new c.Matrix4).fromArray([a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]);if(l){var p=(new c.Matrix4).makeTranslation(-l.x,-l.y,-l.z);f.multiply(p)}var m=new c.Vector3(s[0],s[1],s[2]),g=new c.Vector3(s[3],s[4],s[5]),v=new c.Box3(m,g);v.applyMatrix4(f);var y=H.SceneMath.box2CutPlanes(v);this.impl.setCutPlaneSet("__set_view",y)}else this.impl.setCutPlaneSet("__set_view",void 0);
return this.dispatchEvent({type:L.SET_VIEW_EVENT,view:e}),!0},a.prototype.setViewType=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setViewType is not applicable to 2D"):void this.prefs.set(f.Prefs3D.VIEW_TYPE,e)},a.prototype.setViewFromArray=function(e){var t=this.getCameraFromViewArray(e);this.impl.setViewFromCamera(t,!1,!0)},a.prototype.getCameraFromViewArray=function(e,t){t=t||this.model;var r=this.model&&this.model.getData().placementWithOffset;return U.BubbleNode.readCameraFromArray(e,r)},a.prototype.getViewArrayFromCamera=function(){var e=this.model?this.model.getData().globalOffset:{x:0,y:0,z:0};return this.impl.getViewArrayFromCamera(e)},a.prototype.setViewFromViewBox=function(e,t,r){var n=this.model;if(n&&!n.is2d())return void d.logger.warn("Viewer3D.setViewFromViewBox is not applicable to 3D");if(t&&t.length){var i,o=n.getData().metadata,s=o.views;for(i=0;i<s.length&&s[i].name!=t;i++);if(i<s.length){var a=s[i].layer_state;a&&this.activateLayerState(a)}}this.impl.setViewFromViewBox(this.model,e,t,r)},a.prototype.activateLayerState=function(e){this.impl.layers.activateLayerState(e),this.dispatchEvent({type:L.LAYER_VISIBILITY_CHANGED_EVENT})},a.prototype.getLayerStates=function(){return this.impl.layers.getLayerStates()},a.prototype.setViewFromFile=function(e){this.setActiveNavigationTool(),this.impl.setViewFromFile(e||this.model)},a.prototype.getProperties=function(e,t,r){this.model?this.model.getProperties(e,t,r):r&&r(_.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist")},a.prototype.getObjectTree=function(e,t){this.model?this.model.getObjectTree(e,t):t&&t(_.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist")},a.prototype.setCanvasClickBehavior=function(e){if(this.impl.controls.hasOwnProperty("setClickBehavior")&&this.impl.controls.setClickBehavior(e),this.clickHandler&&this.clickHandler.setClickBehavior(e),e&&e.disableMouseWheel&&this.toolController.setMouseWheelInputEnabled(!1),e&&e.disableTwoFingerSwipe){var t=this.toolController.getTool("gestures");t&&t.disableTwoFingerSwipe()}},a.prototype.search=function(e,t,r,n){this.searchText=e,this.model?this.model.search(e,t,r,n):r&&r(_.ErrorCodes.BAD_DATA,"Search failed since model does not exist")},a.prototype.getHiddenNodes=function(e){return e=e||this.model,this.impl.visibilityManager.getHiddenNodes(e)},a.prototype.getIsolatedNodes=function(e){return e=e||this.model,e&&e.is2d()?(d.logger.warn("Viewer3D.getIsolatedNodes is not yet implemented for 2D"),[]):this.impl.visibilityManager.getIsolatedNodes(e)},a.prototype.isolate=function(e,t){if(t=t||this.model){t.getData();this.impl.visibilityManager.isolate(e,t)}},a.prototype.setBackgroundColor=function(e,t,r,n,i,o){this.impl.setClearColors(e,t,r,n,i,o)},a.prototype.setBackgroundOpacity=function(e){this.impl.setClearAlpha(e)},a.prototype.toggleSelect=function(e,t,r){return t=t||this.model,t&&t.is2d()?void d.logger.warn("Viewer3D.toggleSelect is not yet implemented for 2D"):void this.impl.selector.toggleSelection(e,t,r)},a.prototype.select=function(e,t,r){"number"==typeof e&&(e=[e]),t=t||this.model,this.impl.selector.setSelection(e,t,r)},a.prototype.clearSelection=function(){this.impl.selector.clearSelection()},a.prototype.getSelectionVisibility=function(){return this.impl.selector.getSelectionVisibility()},a.prototype.getSelectionCount=function(){return this.impl.selector.getSelectionLength()},a.prototype.setSelectionMode=function(e){this.prefs.set(f.Prefs3D.SELECTION_MODE,e)},a.prototype.getSelection=function(){return this.impl.selector.getSelection()},a.prototype.lockSelection=function(e,t,r){r=r||this.model,this.impl.selector.lockSelection(e,t,r)},a.prototype.unlockSelection=function(e,t){this.impl.selector.unlockSelection(e,t)},a.prototype.isSelectionLocked=function(e,t){return this.impl.selector.isNodeSelectionLocked(e,t)},a.prototype.getAggregateSelection=function(e){var t=this.impl.selector.getAggregateSelection();if(e)for(var r=0;r<t.length;r++)for(var n=0;n<t[r].selection.length;n++)e(t[r].model,t[r].selection[n]);return t},a.prototype.getAggregateIsolation=function(){var e=this.impl.visibilityManager.getAggregateIsolatedNodes();return e},a.prototype.getAggregateHiddenNodes=function(){var e=this.impl.visibilityManager.getAggregateHiddenNodes();return e},a.prototype.hide=function(e,t){t=t||this.model,this.impl.visibilityManager.hide(e,t)},a.prototype.show=function(e,t){t=t||this.model,this.impl.visibilityManager.show(e,t)},a.prototype.showAll=function(){this.impl.visibilityManager.aggregateIsolate([]),this.impl.layers.showAllLayers(),this.fireEvent({type:L.SHOW_ALL_EVENT})},a.prototype.toggleVisibility=function(e,t){this.impl.visibilityManager.toggleVisibility(e,t)},a.prototype.areAllVisible=function(){return this.impl.isWholeModelVisible(this.model)},a.prototype.isNodeVisible=function(e,t){return t=t||this.model,this.impl.isNodeVisible(e,t)},a.prototype.lockVisible=function(e,t,r){r=r||this.model,this.impl.visibilityManager.lockNodeVisible(e,t,r)},a.prototype.toggleLockVisible=function(e,t){this.impl.visibilityManager.toggleVisibleLocked(e,t)},a.prototype.isVisibleLocked=function(e,t){return this.impl.visibilityManager.isNodeVisibleLocked(e,t)},a.prototype.explode=function(e){if(this.model){if(this.model.is2d())return void d.logger.warn("Viewer3D.explode is not applicable to 2D");var t=this.impl.explode(e);t&&d.logger.track({name:"explode_count",aggregate:"count"})}},a.prototype.getExplodeScale=function(){return this.model&&this.model.is2d()?(d.logger.warn("Viewer3D.getExplodeScale is not applicable to 2D"),0):this.impl.getExplodeScale()},a.prototype.lockExplode=function(e,t,r){return r=r||this.model,r&&r.is2d()?(d.logger.warn("Viewer3D.lockExplode is not applicable to 2D"),0):this.impl.lockExplode(e,t,r)},a.prototype.isExplodeLocked=function(e,t){return t=t||this.model,t&&t.is2d()?(d.logger.warn("Viewer3D.isExplodeLocked is not applicable to 2D"),0):this.impl.isExplodeLocked(e,t)},a.prototype.toggleLockExplode=function(e,t){return t=t||this.model,t&&t.is2d()?(d.logger.warn("Viewer3D.toggleLockExplode is not applicable to 2D"),0):this.impl.lockExplode(e,!this.isExplodeLocked(e,t),t)},a.prototype.setQualityLevel=function(e,t){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setQualityLevel is not applicable to 2D"):(this.prefs.set(f.Prefs3D.AMBIENT_SHADOWS,e),void this.prefs.set(f.Prefs3D.ANTIALIASING,t))},a.prototype.setGhosting=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setGhosting is not applicable to 2D"):void this.prefs.set(f.Prefs3D.GHOSTING,e)},a.prototype.setGroundShadow=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setGroundShadow is not applicable to 2D"):void this.prefs.set(f.Prefs3D.GROUND_SHADOW,e)},a.prototype.setGroundReflection=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setGroundReflection is not applicable to 2D"):void this.prefs.set(f.Prefs3D.GROUND_REFLECTION,e)},a.prototype.setEnvMapBackground=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setEnvMapBackground is not applicable to 2D"):void this.prefs.set(f.Prefs3D.ENV_MAP_BACKGROUND,e)},a.prototype.setFirstPersonToolPopup=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setFirstPersonToolPopup is not applicable to 2D"):void this.prefs.set(f.Prefs3D.FIRST_PERSON_TOOL_POPUP,e)},a.prototype.getFirstPersonToolPopup=function(){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.getFirstPersonToolPopup is not applicable to 2D"):this.prefs.firstPersonToolPopup},a.prototype.setBimWalkToolPopup=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setBimWalkToolPopup is not applicable to 2D"):void this.prefs.set(f.Prefs3D.BIM_WALK_TOOL_POPUP,e)},a.prototype.getBimWalkToolPopup=function(){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.getBimWalkToolPopup is not applicable to 2D"):this.prefs.bimWalkToolPopup},a.prototype.setProgressiveRendering=function(e){this.prefs.set(f.Prefs.PROGRESSIVE_RENDERING,e)},a.prototype.setGrayscale=function(e){return this.model&&this.model.is3d()?void d.logger.warn("Viewer3D.setGrayscale is not applicable to 3D"):void this.prefs.set(f.Prefs2D.GRAYSCALE,e)},a.prototype.setSwapBlackAndWhite=function(e){return this.model&&this.model.is3d()?void d.logger.warn("Viewer3D.setSwapBlackAndWhite is not applicable to 3D"):void this.prefs.set(f.Prefs2D.SWAP_BLACK_AND_WHITE,e)},a.prototype.setOptimizeNavigation=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setOptimizeNaviation is not applicable to 2D"):void this.prefs.set(f.Prefs3D.OPTIMIZE_NAVIGATION,e)},a.prototype.initializePrefListeners=function(){var e=this;this.prefs.addListeners(f.Prefs3D.ANTIALIASING,function(t){var r=e.prefs.get(f.Prefs3D.AMBIENT_SHADOWS);e.impl.togglePostProcess(r,t)}),this.prefs.addListeners(f.Prefs3D.AMBIENT_SHADOWS,function(t){var r=e.prefs.get(f.Prefs3D.ANTIALIASING);e.impl.togglePostProcess(t,r)}),this.prefs.addListeners(f.Prefs3D.GROUND_SHADOW,function(t){e.impl.toggleGroundShadow(t)}),this.prefs.addListeners(f.Prefs3D.GROUND_REFLECTION,function(t){e.impl.toggleGroundReflection(t)}),this.prefs.addListeners(f.Prefs3D.ENV_MAP_BACKGROUND,function(t){e.impl.toggleEnvMapBackground(t)}),this.prefs.addListeners(f.Prefs.PROGRESSIVE_RENDERING,function(t){e.impl.toggleProgressive(t)}),this.prefs.addListeners(f.Prefs3D.VIEW_TYPE,function(t){var r=e.prefs.get(f.Prefs3D.VIEW_TYPE),n=e.impl.getModelCamera(e.model);if(n){var i=n.isPerspective;if(!isNaN(i)){var o=i?f.VIEW_TYPES.PERSPECTIVE:f.VIEW_TYPES.ORTHOGRAPHIC;e.prefs.setDefault(f.Prefs3D.VIEW_TYPE,o),r===f.VIEW_TYPES.DEFAULT&&(e.prefs[f.Prefs3D.VIEW_TYPE]=o)}}e.autocam.setViewType(t)}),this.prefs.addListeners(f.Prefs2D.GRAYSCALE,function(t){e.impl.toggleGrayscale(t)}),this.prefs.addListeners(f.Prefs2D.SWAP_BLACK_AND_WHITE,function(t){e.impl.toggleSwapBlackAndWhite(t)}),this.prefs.addListeners(f.Prefs3D.OPTIMIZE_NAVIGATION,function(t){e.impl.setOptimizeNavigation(t)}),this.prefs.addListeners(f.Prefs3D.GHOSTING,function(t){e.impl.toggleGhosting(t)}),this.prefs.addListeners(f.Prefs3D.LINE_RENDERING,function(t){e.impl.hideLines(!t)}),this.prefs.addListeners(f.Prefs.POINT_RENDERING,function(t){e.impl.hidePoints(!t)}),this.prefs.addListeners(f.Prefs3D.EDGE_RENDERING,function(t){e._displayEdges=function(){e.impl.setDisplayEdges(t)},t||e.model&&e.model.isLoadDone()?e._displayEdges():e.addEventListener(L.GEOMETRY_LOADED_EVENT,e._displayEdges)}),this.prefs.addListeners(f.Prefs3D.LIGHT_PRESET,function(t){if("string"==typeof t){for(var r=t,n=-1,i=0;i<Q.LightPresets.length;i++)if(Q.LightPresets[i].name===r){n=i;break}if(!(n>=0))return void d.logger.warn("Invalid Prefs3D.LIGHT_PRESET: "+t);t=n}e.impl.setLightPreset(t)}),this.prefs.addListeners(f.Prefs3D.ALWAYS_USE_PIVOT,function(t){e.navigation.setUsePivotAlways(t)}),this.prefs.addListeners(f.Prefs.REVERSE_MOUSE_ZOOM_DIR,function(t){e.navigation.setReverseZoomDirection(t)}),this.prefs.addListeners(f.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,function(t){e.navigation.setReverseHorizontalLookDirection(t)}),this.prefs.addListeners(f.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,function(t){e.navigation.setReverseVerticalLookDirection(t)}),this.prefs.addListeners(f.Prefs3D.ZOOM_TOWARDS_PIVOT,function(t){e.navigation.setZoomTowardsPivot(t)}),this.prefs.addListeners(f.Prefs3D.SELECTION_SETS_PIVOT,function(t){e.navigation.setSelectionSetsPivot(t)}),this.prefs.addListeners(f.Prefs3D.ORBIT_PAST_WORLD_POLES,function(t){e.navigation.setOrbitPastWorldPoles(t)}),this.prefs.addListeners(f.Prefs.LEFT_HANDED_MOUSE_SETUP,function(t){e.navigation.setUseLeftHandedInput(t),x.EventUtils.setUseLeftHandedInput(t)}),this.prefs.addListeners(f.Prefs.WHEEL_SETS_PIVOT,function(t){e.navigation.setWheelSetsPivot(t)}),this.prefs.addListeners(f.Prefs3D.SELECTION_MODE,function(t){e.impl.selector.setSelectionMode(t)}),this.prefs.addListeners(f.Prefs.BACKGROUND_COLOR_PRESET,function(t){if(t)try{var r=JSON.parse(t);e.impl.setClearColors(r[0],r[1],r[2],r[3],r[4],r[5])}catch(n){d.logger.warn("Invalid Prefs.BACKGROUND_COLOR_PRESET: "+r)}}),this.prefs.addListeners(f.Prefs3D.EXPLODE_STRATEGY,function(t){Z.ModelExploder.setStrategy(t)&&e.impl.refreshExplode()}),this.prefs.addListeners(f.Prefs2D.LOADING_ANIMATION,function(t){e.impl.onLoadingAnimationChanged(t)});var t={};this.prefs.addListeners(f.Prefs3D.FORCE_DOUBLE_SIDED,function(r){function n(e){return"boolean"==typeof r?r:!!r[e.id]}e._setDoubleSided=function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,o=r.model,s=n(o),a=o.getData();t.hasOwnProperty(o.id)||(t[o.id]=!!a.doubleSided);var l=s||!!a.doubleSided;l!==t[o.id]&&(e.impl.setDoubleSided(l,o,i),t[o.id]=l)};var i=e.impl.modelQueue().getModels();0===i.length?e.addEventListener(L.MODEL_ADDED_EVENT,e._setDoubleSided):(i.forEach(function(t){e._setDoubleSided({model:t},!1)}),e.impl.sceneUpdated())})},a.prototype.setNavigationLock=function(e){this.navigation.getIsLocked()!==e&&(this.navigation.setIsLocked(e),this.dispatchEvent({type:L.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()}))},a.prototype.getNavigationLock=function(){return this.navigation.getIsLocked()},a.prototype.setNavigationLockSettings=function(e){this.navigation.setLockSettings(e),this.dispatchEvent({type:L.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()})},a.prototype.getNavigationLockSettings=function(){return this.navigation.getLockSettings()},a.prototype.setActiveNavigationTool=function(e){if(e===this._pushedTool||!e&&!this._pushedTool)return!0;if(this._pushedTool){if(!this.impl.controls.deactivateTool(this._pushedTool))return!1;this.impl.controls.setToolActiveName(this.getDefaultNavigationToolName()),this._pushedTool=null}var t=!e||e===this.getDefaultNavigationToolName();return t&&null===this._pushedTool?(this.dispatchEvent({type:L.NAVIGATION_MODE_CHANGED_EVENT,id:this.getDefaultNavigationToolName()}),!0):this.impl.controls.activateTool(e)?(this._pushedTool=e,this.dispatchEvent({type:L.NAVIGATION_MODE_CHANGED_EVENT,id:this._pushedTool}),!0):!1},a.prototype.getActiveNavigationTool=function(){return this._pushedTool?this._pushedTool:this._defaultNavigationTool},a.prototype.setDefaultNavigationTool=function(e){this._defaultNavigationTool&&this.impl.controls.deactivateTool(this._defaultNavigationTool);var t=this._pushedTool;this._pushedTool=null,t&&this.impl.controls.deactivateTool(t),this.impl.controls.activateTool(e),this._defaultNavigationTool=e,t&&(this.impl.controls.activateTool(t),this._pushedTool=t)},a.prototype.getDefaultNavigationToolName=function(){return this._defaultNavigationTool},a.prototype.getFOV=function(){return this.navigation.getVerticalFov()},a.prototype.setFOV=function(e){this.navigation.setVerticalFov(e,!0)},a.prototype.getFocalLength=function(){return this.navigation.getFocalLength()},a.prototype.setFocalLength=function(e){this.navigation.setFocalLength(e,!0)},a.prototype.hideLines=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.hideLines is not applicable to 2D"):void this.prefs.set(f.Prefs3D.LINE_RENDERING,!e)},a.prototype.hidePoints=function(e){this.prefs.set(f.Prefs.POINT_RENDERING,!e)},a.prototype.setDisplayEdges=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setDisplayEdges is not applicable to 2D"):void this.prefs.set(f.Prefs3D.EDGE_RENDERING,e)},a.prototype.applyCamera=function(e,t){this.impl.setViewFromCamera(e,!0),t&&this.fitToView()},a.prototype.fitToView=function(e,t,r){var n=[];e&&(e.length>0&&e[0].model?n=e:e.length>0&&n.push({model:t||this.model,selection:e})),this.impl.fitToView(n,r)},a.prototype.setClickConfig=function(e,t,r){var n=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(e in n){var i=n[e];if(t in i)return i[t]=r,!0}return!1},a.prototype.getClickConfig=function(e,t){var r=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(e in r){var n=r[e];if(t in n)return n[t]}return null},a.prototype.setClickToSetCOI=function(e,t){t!==!1&&this.prefs.set(f.Prefs3D.CLICK_TO_SET_COI,e);var r=this.getClickConfig("click","onObject");e?-1===r.indexOf("setCOI")&&this.setClickConfig("click","onObject",["setCOI"]):r.indexOf("setCOI")>=0&&this.setClickConfig("click","onObject",["selectOnly"])},a.prototype.setProfile=function(e){var t=this;if(!e)return!1;this.profile=e,this.profile.apply(this.prefs);var r=this.profile.extensions&&this.profile.extensions.unload||[],n=this.profile.extensions&&this.profile.extensions.load||[];r.forEach(function(e){t.isExtensionLoaded(e)&&t.unloadExtension(e)}),n.forEach(function(e){t.isExtensionLoaded(e)||t.loadExtension(e,t.config)}),this.dispatchEvent({type:Autodesk.Viewing.PROFILE_CHANGE_EVENT,profile:e})},a.prototype.initSettings=function(e){if(!this.profile){var t=new h.Profile(e);this.setProfile(t)}},a.prototype.setLightPreset=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setLightPreset is not applicable to 2D"):void this.prefs.set(f.Prefs3D.LIGHT_PRESET,e)},a.prototype.setUsePivotAlways=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setUsePivotAlways is not applicable to 2D"):void this.prefs.set(f.Prefs3D.ALWAYS_USE_PIVOT,e)},a.prototype.setReverseZoomDirection=function(e){this.prefs.set(f.Prefs.REVERSE_MOUSE_ZOOM_DIR,e)},a.prototype.setReverseHorizontalLookDirection=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setReverseHorizontalLookDirection is not applicable to 2D"):void this.prefs.set(f.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,e)},a.prototype.setReverseVerticalLookDirection=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setReverseVerticalLookDirection is not applicable to 2D"):void this.prefs.set(f.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,e)},a.prototype.setZoomTowardsPivot=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setZoomTowardsPivot is not applicable to 2D"):void this.prefs.set(f.Prefs3D.ZOOM_TOWARDS_PIVOT,e)},a.prototype.setOrbitPastWorldPoles=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setOrbitPastWorldPoles is not applicable to 2D"):void this.prefs.set(f.Prefs3D.ORBIT_PAST_WORLD_POLES,e)},a.prototype.setUseLeftHandedInput=function(e){this.prefs.set(f.Prefs.LEFT_HANDED_MOUSE_SETUP,e)},a.prototype.setDisplayUnits=function(e){this.prefs.set(f.Prefs.DISPLAY_UNITS,e)},a.prototype.setDisplayUnitsPrecision=function(e){(null===e||void 0===e)&&(e=""),this.prefs.set(f.Prefs.DISPLAY_UNITS_PRECISION,e)},a.prototype.setLayerVisible=function(e,t,r){var n=this.impl.layers;null===e?t?n.showAllLayers():n.hideAllLayers():(Array.isArray(e)||(e=[e]),r&&n.hideAllLayers(),this.impl.setLayerVisible(e,t)),this.dispatchEvent({type:L.LAYER_VISIBILITY_CHANGED_EVENT})},a.prototype.isLayerVisible=function(e){return!!(e&&e.isLayer&&this.impl.isLayerVisible(e))},a.prototype.anyLayerHidden=function(){for(var e=this.impl.getLayersRoot(),t=e&&e.children,r=t?t.length:0,n=0;r>n;++n)if(!this.impl.layers.isLayerVisible(t[n]))return!0;return!1},a.prototype.allLayersHidden=function(){for(var e=this.impl.getLayersRoot(),t=e&&e.children,r=t?t.length:0,n=0;r>n;++n)if(this.impl.layers.isLayerVisible(t[n]))return!1;return!0},a.prototype.setGroundShadowColor=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setGroundShadowColor is not applicable to 2D"):void this.impl.setGroundShadowColor(e)},a.prototype.setGroundShadowAlpha=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setGroundShadowAlpha is not applicable to 2D"):void this.impl.setGroundShadowAlpha(e)},a.prototype.setGroundReflectionColor=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setGroundReflectionColor is not applicable to 2D"):void this.impl.setGroundReflectionColor(e)},a.prototype.setGroundReflectionAlpha=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.setGroundReflectionAlpha is not applicable to 2D"):void this.impl.setGroundReflectionAlpha(e)},a.prototype.getCutPlanes=function(){return this.model&&this.model.is2d()?(d.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"),[]):this.impl.getCutPlanes()},a.prototype.setCutPlanes=function(e){return this.model&&this.model.is2d()?void d.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"):void this.impl.setCutPlaneSet("__set_view",e)},a.prototype.getScreenShot=function(e,t,r,n){return W.ScreenShot.getScreenShotLegacy(this,e,t,r,n)},a.prototype.setContextMenu=function(e){this.contextMenu&&this.contextMenu.hide(),this.contextMenu=e||null},a.prototype.setDefaultContextMenu=function(){var e=Autodesk.Viewing.Extensions;return e&&e.ViewerObjectContextMenu?(this.setContextMenu(new e.ViewerObjectContextMenu(this)),!0):!1},a.prototype.triggerContextMenu=function(e){return this.config&&this.config.onTriggerContextMenuCallback&&this.config.onTriggerContextMenuCallback(e),this.contextMenu?(this.contextMenu.show(e),!0):!1},a.prototype.triggerSelectionChanged=function(e){this.config&&this.config.onTriggerSelectionChangedCallback&&this.config.onTriggerSelectionChangedCallback(e)},a.prototype.triggerDoubleTapCallback=function(e){this.config&&this.config.onTriggerDoubleTapCallback&&this.config.onTriggerDoubleTapCallback(e)},a.prototype.triggerSingleTapCallback=function(e){this.config&&this.config.onTriggerSingleTapCallback&&this.config.onTriggerSingleTapCallback(e)},a.prototype.triggerSwipeCallback=function(e){this.config&&this.config.onTriggerSwipeCallback&&this.config.onTriggerSwipeCallback(e)},a.prototype.initContextMenu=function(){var e=!this.config||(this.config.hasOwnProperty("disableBrowserContextMenu")?this.config.disableBrowserContextMenu:!0);e&&(this.onDefaultContextMenu=function(e){e.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1));var t=this,r=this.canvas||this.container;this.onMouseDown=function(e){x.EventUtils.isRightClick(e)&&(t.startX=e.clientX,t.startY=e.clientY)},r.addEventListener("mousedown",this.onMouseDown),this.onMouseUp=function(e){return x.EventUtils.isRightClick(e)&&e.clientX===t.startX&&e.clientY===t.startY&&t.triggerContextMenu(e),!0},r.addEventListener("mouseup",this.onMouseUp,!1)},a.prototype.registerContextMenuCallback=function(e,t){this.contextMenuCallbacks[e]=t},a.prototype.unregisterContextMenuCallback=function(e){return e in this.contextMenuCallbacks?(delete this.contextMenuCallbacks[e],!0):!1},a.prototype.runContextMenuCallbacks=function(e,t){for(var r in this.contextMenuCallbacks)this.contextMenuCallbacks.hasOwnProperty(r)&&this.contextMenuCallbacks[r](e,t)},a.prototype.joinLiveReview=function(e){var t=this;this.liveReviewClient||(this.liveReviewClient=new k.LiveReviewClient(this)),R.theResourceLoader.loadScript("socket.io-1.3.5.js","lmv_io").then(function(){t.liveReviewClient.joinLiveReviewSession(e)})},a.prototype.leaveLiveReview=function(){this.liveReviewClient&&this.liveReviewClient.leaveLiveReviewSession()},a.prototype.setModelUnits=function(e){this.model&&(this.model.getData().overriddenUnits=e)},a.prototype.worldToClient=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.impl.camera;return this.impl.worldToClient(e,t)},a.prototype.clientToWorld=function(e,t,r,n){return this.impl.clientToWorld(e,t,r,n)},a.prototype.modelHasTopology=function(){return this.model&&this.model.hasTopology()?!0:!1},a.prototype.setSelectionColor=function(e,t){this.impl.setSelectionColor(e,t)},a.prototype.set2dSelectionColor=function(e,t){this.impl.set2dSelectionColor(e,t)},a.prototype.setTheme=function(e){for(var t=this.container.classList,r=0;r<t.length;++r){var n=t[r].indexOf("-theme");-1!==n&&t.remove(t[r--])}t.add(e)},a.prototype.setThemingColor=function(e,t,r,n){r=r||this.model,r.setThemingColor(e,t,n),this.impl.invalidate(!0)},a.prototype.clearThemingColors=function(e){e=e||this.model,e.clearThemingColors(),this.impl.invalidate(!0)},a.prototype.transferModel=function(e,t){var r=this.impl.findModel(e);if(r){var n=[];this.getAggregateSelection(function(t,r){t.id==e&&n.push(r)});var i=this.impl.visibilityManager.getIsolatedNodes(r),o=this.impl.visibilityManager.getHiddenNodes(r),s=this.impl.matman().exportModelMaterials(r),a=r.loader;r.loader=null,this.impl.unloadModel(r),r.loader=a,r.isAEC()&&r.is3d()&&t.impl.setLightPresetForAec(),t.impl.setRenderingPrefsFor2D(r.is2d()),t.impl.addModel(r),t.impl.matman().importModelMaterials(s,e),t._loadingSpinner.hide(),r.loader&&r.loader.viewer3DImpl===this.impl&&(r.loader.viewer3DImpl=t.impl),r.getData().loadDone&&t.impl.onLoadComplete(r),t.impl.selector.setSelection(n,r),0!=i.length?t.impl.visibilityManager.isolate(i,r):0!=o.length&&t.impl.visibilityManager.hide(o,r)}},a.prototype.hideModel=function(e){var t=this.impl.modelQueue();return(e="number"==typeof e?t.findModel(e):e)?(this.impl.removeModel(e),t.addHiddenModel(e),!0):!1},a.prototype.showModel=function(e,t){var r=this.impl.modelQueue();return(e="number"==typeof e?r.findHiddenModel(e):e)?(r.removeHiddenModel(e),this.impl.addModel(e,t),!0):!1},a.prototype.getVisibleModels=function(){var e=this.impl.modelQueue();return e.getModels().slice()},a.prototype.getHiddenModels=function(){var e=this.impl.modelQueue();return e.getHiddenModels().slice()},a.prototype.restoreDefaultSettings=function(){var e=this.model,t=e.is2d()?"2d":"3d";this.prefs.reset(t),this.impl.setupLighting(e),e.isAEC()&&e.is3d()&&this.impl.setLightPresetForAec(),this.impl.setRenderingPrefsFor2D(!e.is3d()),this.fireEvent({type:L.RESTORE_DEFAULT_SETTINGS_EVENT})},a.prototype.disableHighlight=function(e){this.impl.disableHighlight(e)},a.prototype.disableSelection=function(e){e&&this.clearSelection(),this.impl.disableSelection(e)},a.prototype.isHighlightDisabled=function(){return this.impl.selector.highlightDisabled},a.prototype.isHighlightPaused=function(){return this.impl.selector.highlightPaused},a.prototype.isHighlightActive=function(){return!(this.impl.selector.highlightDisabled||this.impl.selector.highlightPaused)},a.prototype.isSelectionDisabled=function(){return this.impl.selector.selectionDisabled},a.prototype.activateExtension=function(e,t){if(this.loadedExtensions&&e in this.loadedExtensions){var r=this.loadedExtensions[e];return r.activate(t)}return d.logger.warn("Extension is not loaded or doesn't exist"),!1},a.prototype.deactivateExtension=function(e){if(this.loadedExtensions&&e in this.loadedExtensions){var t=this.loadedExtensions[e];return t.deactivate()}return d.logger.warn("Extension is not loaded or doesn't exist"),!1},a.prototype.isExtensionActive=function(e,t){if(this.loadedExtensions&&e in this.loadedExtensions){var r=this.loadedExtensions[e],n=r.isActive(t);return n}return d.logger.warn("Extension is not loaded or doesn't exist"),!1},a.prototype.isExtensionLoaded=function(e){return this.loadedExtensions&&e in this.loadedExtensions},a.prototype.getLoadedExtensions=function(){return this.loadedExtensions||[]},a.prototype.getExtensionModes=function(e){if(this.loadedExtensions&&e in this.loadedExtensions){var t=this.loadedExtensions[e];return t.getModes()}return[]},a.prototype.reorderElements=function(e){var t=e.getAttribute("layer-order-id"),r=this.containerLayerOrder.indexOf(t),n=null;if(-1!==r)for(var i=r+1;i<this.containerLayerOrder.length&&!n;i++)n=this.container.querySelector('[layer-order-id="'+this.containerLayerOrder[i]+'"]');n?this.container.insertBefore(e,n):this.container.appendChild(e)},a.prototype.appendOrderedElementToViewer=function(e){var t=this.container.querySelector('[layer-order-id="'+e+'"]');if(t)return t;var r=this.getDocument().createElement("div");return r.setAttribute("layer-order-id",e),this.reorderElements(r),r},a.prototype.hitTest=function(e,t,r){return this.impl.hitTest(e,t,r)},a.prototype.refresh=function(e){this.impl.invalidate(e,!1,!e)},a.prototype.chooseProfile=function(e){var t=this.profileManager.PROFILE_DEFAULT;return this.config&&this.config.profileSettings?t=new h.Profile(this.config.profileSettings):e&&e.useFileProfile?t=this.profileManager.getProfileOrDefault(e.fileExt):e.isAEC&&(t=this.profileManager.PROFILE_AEC),t}},"./src/application/Viewer3DImpl.js":function(e,t,r){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Object(o.isNodeJS)()){var r=Object.assign({},G,t);r.canvas=e;var n=new y.WebGLRenderer(r);return n.context?(n.autoClear=!1,n.sortObjects=!1,n):null}}function i(e,t){function r(e){var t=at.phase,r=!0,n=t==_.RenderFlags.RENDER_NORMAL,i=Ce.settings.idbuffer&&t!=_.RenderFlags.RENDER_HIDDEN,o=t==_.RenderFlags.RENDER_HIDDEN?be.edgeColorGhosted:be.edgeColorMain;Ce.setEdgeColor(o),t==_.RenderFlags.RENDER_HIDDEN?e.overrideMaterial=be.fadeMaterial:t==_.RenderFlags.RENDER_HIGHLIGHTED&&(e.overrideMaterial=be.highlightMaterial);var s={type:I.RENDER_SCENE_PART,scene:e,wantColor:r,wantSAO:n,wantID:i,context:Ce};be.api.dispatchEvent(s),s.preventDefault||Ce.renderScenePart(e,r,n,i),e.overrideMaterial=null}function i(e){et++,e>=Je&&Je>0&&($e=.8*$e+.2*(e-Je)),be.fpsCallback&&be.fpsCallback(be.fps())}function y(e){if(be.keyFrameAnimator){var t=Je>0?(e-Je)/1e3:0,r=be.keyFrameAnimator.update(t);if(r&&(be.sceneUpdated(!0),r&be.keyFrameAnimator.UPDATE_CAMERA))return!0}return!1}function F(e){Ee&&(be.canvasBoundingclientRectDirty=!0,be.camera.aspect=Se/Ae,be.camera.clientWidth=Se,be.camera.clientHeight=Ae,Ce.setSize(Se,Ae),be.controls.handleResize(),De&&De.setSize(Se,Ae),be.invalidate(!0,!0,!0),Ee=!1,e||be.api.dispatchEvent({type:I.VIEWER_RESIZE_EVENT,width:Se,height:Ae}))}function G(){if((Le.enabled||De)&&!be.is2d){var e;if(e=be.model&&!be.model.isLoadDone()?be.model.getData().bbox:be.getVisibleBounds(!0,!1)){var t=be.camera,r=e.clone(),n=new L.Vector3(1,0,0),i=ze.clone();t.worldUpTransform&&(r.applyMatrix4(t.worldUpTransform),n.applyMatrix4(t.worldUpTransform),i.applyMatrix4(t.worldUpTransform)),r.min.y-=.005*(r.max.y-r.min.y),je&&je.expandByGroundShadow(r,i);var o=r.size(),s=r.center();if(je||(o.x*=1.25,o.z*=1.25,o.x=o.z=Math.max(o.x,o.z)),t.worldUpTransform){var a=(new L.Matrix4).getInverse(t.worldUpTransform);s.applyMatrix4(a)}if(Le.setTransform(s,o,t.worldup,n),De){var l=(new L.Vector3).subVectors(s,t.worldup.clone().multiplyScalar(o.y/2));De.setTransform(l,t.worldup,o)}je&&je.setGroundShadowTransform(s,o,t.worldup,n)}}}function H(){return Ye?(G(),Le.setDirty(),Ye=!1,!0):!1}function W(e){for(var t in be.selectionMeshes){var r=be.selectionMeshes[t];if(r.model){var n=r.model.getFragmentList();r.geometry===n.getGeometry(r.fragId)&&n.getWorldMatrix(r.fragId,r.matrix)}}}function q(){je&&(je.state=b.SHADOWMAP_NEEDS_UPDATE)}function X(){this.highResTimeStamp=-1,this.screenDrawn=gt.NOTHING_DRAWN,this.screenHasChanged=!1,this.frameBudget=0,this.frameRemaining=0,this.phase=_.RenderFlags.RENDER_NORMAL,this.signalProgressByRendering=!1,this.tickCount=0,this.beginFrameAvg=0,this.lastBeginFrameTimeStamp=0,this.RENDERMODE_FULL=0,this.RENDERMODE_PROGRESSIVE=1,this.RENDERMODE_SILENT=2,this.renderType=this.RENDERMODE_FULL,this.INITIAL_GROUND_SHADOW=.2,this.cmdListActive=!1,this.cmdIndex=0,this.continueExecution=!0,this.encounteredAlwaysDo=!1,this.finishedFullRender=!0,this.groundShadowInPost=!1,this.drawOverlay=!1,this.cmdIsOpen=!1,this.allocArraySize=0,this.cmdListLength=0,this.cmdList=[],this.paramList=[],this.CMD_NORMAL_SEQUENCE=0,this.CMD_DO_AFTER=1,this.CMD_ALWAYS_DO=2,this.isActive=function(){return this.cmdListActive},this.setFrame=function(e){this.frameBudget=e},this.beginCommandSet=function(){this.cmdListActive=!0,this.cmdIndex=0,this.cmdListLength=0,this.encounteredAlwaysDo=!1,this.tickCount=0,this.screenDrawn=gt.NOTHING_DRAWN,this.screenHasChanged=!1},this.endCommandSet=function(){this.cmdIsOpen&&(this.cmdIsOpen=!1,this.cmdListLength++)},this._internalSetParam=function(e,t){this.paramList[this.cmdIndex][e]=t;
},this.addCommand=function(e,t){for(this.cmdIsOpen&&this.cmdListLength++,this.cmdIsOpen=!0;this.allocArraySize<=this.cmdListLength;)this.cmdList[this.cmdListLength]={},this.paramList[this.cmdListLength]={},this.allocArraySize++;return this.cmdList[this.cmdListLength]=e,this.paramList[this.cmdListLength].executionLevel=t||this.CMD_NORMAL_SEQUENCE,this.encounteredAlwaysDo=this.encounteredAlwaysDo||t===this.CMD_ALWAYS_DO,this.cmdListLength},this.setParam=function(e,t){this.cmdIsOpen?this.paramList[this.cmdListLength][e]=t:B&&g.logger.error("ERROR: cannot set param when no command is open!")},this.getParam=function(e){return B&&void 0===this.paramList[this.cmdIndex][e]&&g.logger.error("ERROR: parameter "+e+" was never set for this command! Go fix it."),this.paramList[this.cmdIndex][e]},this.executeCommandList=function(){if(at.cmdListActive){this.tickCount>0&&(at.lastBeginFrameTimeStamp=0),this.frameRemaining=this.frameBudget,B&&this.cmdIsOpen&&g.logger.error("ERROR: should call endCommandSet before executing"),this.continueExecution=!0;var e;if(z&&0===this.tickCount,this.encounteredAlwaysDo)for(var t=0;t<this.cmdIndex;)this.paramList[t].executionLevel>=at.CMD_ALWAYS_DO&&this.cmdList[t](),t++;for(;this.cmdIndex<this.cmdListLength;)(this.continueExecution||this.paramList[this.cmdIndex].executionLevel>=at.CMD_DO_AFTER)&&this.cmdList[this.cmdIndex]()&&(e=this.cmdIndex,this.continueExecution=!1),this.cmdIndex++;return this.continueExecution?this.cmdListActive=!1:this.cmdIndex=e,this.tickCount++,!this.continueExecution}return at.lastBeginFrameTimeStamp=0,!0}}function Y(){if(at.renderType===at.RENDERMODE_PROGRESSIVE)if(at.getParam("GenerateGroundShadow.afterBeauty")){if(at.frameRemaining=Le.prepareGroundShadow(be.modelQueue(),0,at.frameRemaining),Le.getStatus()==x.GroundFlags.GROUND_RENDERED){if(at.getParam("GenerateGroundShadow.signalRedraw"))return be.requestSilentRender(),!0;at.groundShadowInPost=!0}}else 0===at.tickCount&&Le.prepareGroundShadow(be.modelQueue(),10);else at.frameRemaining=Le.prepareGroundShadow(be.modelQueue(),0,at.frameRemaining);return at.frameRemaining<0&&Le.getStatus()===x.GroundFlags.GROUND_UNFINISHED}function K(){return Le.getStatus()!==x.GroundFlags.GROUND_UNFINISHED&&be.renderGroundShadow(),!1}function Q(){return at.renderType===at.RENDERMODE_PROGRESSIVE?at.getParam("GenerateGroundReflection.afterBeauty")?(at.frameRemaining=De.prepareGroundReflection(Le,be,!1,0,at.frameRemaining),De.getStatus()==x.GroundFlags.GROUND_RENDERED&&(at.screenDrawn|=gt.REFLECTION_DRAWN,at.groundShadowInPost&&Me.hasTransparentMaterial()&&be.requestDeferredSilentRender())):0===at.tickCount&&De.prepareGroundReflection(Le,be,!0,10):at.frameRemaining=De.prepareGroundReflection(Le,be,!1,0,at.frameRemaining),at.frameRemaining<0&&De.getStatus()===x.GroundFlags.GROUND_UNFINISHED}function Z(){if(je.state===b.SHADOWMAP_NEEDS_UPDATE)at.frameRemaining=je.startUpdate(Ie,at.frameRemaining,be.camera,ze,Me);else if(je.state==b.SHADOWMAP_INCOMPLETE&&(at.frameRemaining=je.continueUpdate(Ie,at.frameRemaining,Me),je.state==b.SHADOWMAP_VALID))return be.requestSilentRender(),!0;return at.frameRemaining<0&&je.state!==b.SHADOWMAP_VALID}function J(){je.state=b.SHADOWMAP_NEEDS_UPDATE}function $(){if(at.signalProgressByRendering&&be.signalProgress(0,a.ProgressState.RENDERING),at.renderType===at.RENDERMODE_PROGRESSIVE){if(at.lastBeginFrameTimeStamp>0){var e=at.highResTimeStamp-at.lastBeginFrameTimeStamp;at.beginFrameAvg=.75*at.beginFrameAvg+.25*e}at.lastBeginFrameTimeStamp=at.highResTimeStamp,at.beginFrameAvg<Oe&&at.frameBudget<Re?(be.targetFrameBudget+=1,be.targetFrameBudget>Re&&(be.targetFrameBudget=Re)):at.beginFrameAvg>Oe&&at.frameBudget>ke&&(be.targetFrameBudget*=.75+.25*Oe/at.beginFrameAvg,be.targetFrameBudget<ke&&(be.targetFrameBudget=ke))}var t=at.getParam("BeginScene.clear");return Ce.beginScene(be.scene,be.camera,be.lightsOn?be.lights:be.no_lights,t),t&&(at.screenDrawn|=gt.BACKGROUND_DRAWN),at.getParam("BeginScene.signalCameraChanged")&&be.api.dispatchEvent(be.cameraChangedEvent),!1}function ee(){return at.phase=at.getParam("BeginPhase.phase"),Ie.reset(be.camera,at.phase,at.getParam("BeginPhase.moved"),Me.getCutPlanes()),!1}function te(){return Ie.isEmpty()||Ie.isDone()||(at.screenDrawn|=gt.MODEL_DRAWN,at.frameRemaining=Ie.renderSome(r,at.frameRemaining),at.signalProgressByRendering&&be.signalProgress(100*Ie.getRenderProgress(),a.ProgressState.RENDERING)),!Ie.isDone()}function re(){return at.phase=_.RenderFlags.RENDER_FINISHED,Ce.renderScenePart(be.sceneAfter,!0,!0,!0),!1}function ne(){return at.phase=_.RenderFlags.RENDER_FINISHED,!1}function ie(){be.signalProgress(100,a.ProgressState.RENDERING)}function oe(){return be.isOverlayDirty()&&(be.clearOverlayDirtyFlag(),at.drawOverlay=!0),at.drawOverlay&&(!Ie.isEmpty()&&Ie.isDone()||be.showOverlaysWhileMoving?(be.renderOverlays(),at.screenDrawn|=gt.OVERLAY_DRAWN):(Ce.clearAllOverlays(),at.drawOverlay=!1)),!1}function se(){at.screenDrawn|=gt.ALL_DRAWN}function ae(){if(at.screenDrawn&&(at.phase===_.RenderFlags.RENDER_FINISHED||at.tickCount%be.frameDisplayRate===0)){var e=!at.getParam("PostAndPresent.performAO")||(at.screenDrawn&(gt.BACKGROUND_DRAWN|gt.MODEL_DRAWN))==gt.BACKGROUND_DRAWN;Ce.composeFinalFrame(e),at.screenHasChanged=!0,at.screenDrawn=gt.NOTHING_DRAWN,i(at.highResTimeStamp),be.api.dispatchEvent({type:I.RENDER_PRESENTED_EVENT})}return!1}function le(){return B&&Ce.getAOEnabled()===!1&&g.logger.error("AO should be on at this point!"),Ce.setAOEnabled(!1),!1}function ce(){return B&&Ce.getAOEnabled()===!0&&g.logger.error("AO should be off at this point!"),Ce.setAOEnabled(!0),!1}function ue(){return be.requestSilentRender(),!1}function de(){return at.finishedFullRender=!0,!1}function he(){for(var e in be.selectionMeshes){var t=be.selectionMeshes[e];t.model&&t.model.isConsolidated()&&t.model.updateRenderProxy(t,t.fragId)}}function fe(e){return Me._getMaterialHash(e,"selection2d")}function pe(){if(!Object(o.isMobileDevice)()){var e=Ie.getModels().length,t=Ce.mrtFlags();if(e>1&&t.mrtIdBuffer<2){var r=Ce.setIdTargetCount(2);r&&Me.toggleMRTSetting(Ce.mrtFlags())}}}function me(e,t){t.updateMatrixWorld(!0),t.traverse(function(t){var r=t.geometry,n=t.model&&"number"==typeof t.fragId;if(n&&!r.boundingBox){var i=n&&t.model.getFragmentList();return void(i&&(i.getWorldBounds(t.fragId,bt),e.union(bt)))}void 0!==r&&t.visible&&(r.boundingBox||r.computeBoundingBox(),bt.copy(r.boundingBox),bt.applyMatrix4(t.matrixWorld),e.union(bt))})}function ge(){var e=be.overlayScenes;for(var t in e)e.hasOwnProperty(t)&&me(xt,e[t].scene);return me(xt,be.scene),me(xt,be.sceneAfter),xt}function ve(e,t,r,n){var i=e.getFragmentList().getVizmesh(t),o=new P.VertexBufferReader(i.geometry);o.enumGeomsForVisibleLayer(r,n)}function ye(e,t,r,n){var i=e.getFragmentList().getVizmesh(t),o=new P.VertexBufferReader(i.geometry);o.enumGeomsForObject(r,n)}var _e=this,be=this;this.setGlobalManager(t.globalManager);var xe,we,Ee,Se,Ae,Me,Te,Ce,je,Pe,Le,De,Ie,Re=1e3/15,Oe=1e3/30,ke=1,Ne=-1,Fe=-1,Ve=null,Ue="y",Be=null,ze=null,Ge=null,He=!1,We=!1,qe=!1,Xe={type:I.PROGRESS_UPDATE_EVENT,state:a.ProgressState.LOADING,percent:0},Ye=!1,Ke=!1,Qe=!1,Ze=0,Je=0,$e=1e3/60,et=0,tt=!0,rt=!1,nt=!1,it=1,ot=null,st=null;this.edgeColorMain=new L.Vector4(0,0,0,.3),this.edgeColorGhosted=new L.Vector4(0,0,0,.1);var at,lt,ct,ut=Object(o.getGlobal)(),dt=function(e){var t=e.model;_e.canvas&&t&&t.getData()&&t.getData().stdSurfMats&&t.getData().stdSurfMats.materials&&_e.api.loadExtension("Autodesk.StandardSurface").then(function(e){e&&e.processModel(t)})},ht=function(e){return e.model.modelRootLoaded=!0},ft={},pt="",mt=!0;e&&(this.interval=setInterval(function(){tt||60>et||be.track({name:"fps",value:Number(be.fps().toFixed(2)),aggregate:"last"})},3e4)),this.api=t,this.canvas=e,this.loader=null,this.canvasBoundingclientRectDirty=!0,this.nearRadius=0,this.defaultLoadingAnimationDuration=300,this.lastTime2dGeometryCreated=0,this.initialize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(xe=new L.Vector3(0,1,0),Ie=new l.RenderScene,Te=t.glrenderer||n(e,t.webglInitParams),Te||Object(o.isNodeJS)()){Te&&(this.onWebGLcontextLost=this.onWebGLcontextLost.bind(this),Te.webglcontextlost=this.onWebGLcontextLost,Te.refCount++),Ce=t.renderer||new c.RenderContext,Ce.init(Te,e?e.clientWidth:0,e?e.clientHeight:0,{useIdBufferSelection:t.useIdBufferSelection}),Me=t.materialManager||new u.MaterialManager(Te),Me.refCount++,this.camera=new D.UnifiedCamera(e?e.clientWidth:512,e?e.clientHeight:512),this.lightsOn=!1,this.lights=[],this.no_lights=[],ot=(new L.Color).setRGB(1,1,1),st=(new L.Color).setRGB(1,1,1),this.cameraChangedEvent={type:I.CAMERA_CHANGE_EVENT,camera:this.camera},Be=new L.Vector3(1,1,1),ze=(new L.Vector3).copy(Be),Ge=new L.Vector3(-1,0,1),this.scene=new L.Scene,this.sceneAfter=new L.Scene,this.sceneAfter.sortObjects=!1,this.overlayScenes={},_t(),this.createOverlayScene("selection",this.selectionMaterialBase,this.selectionMaterialTop),this.createOverlayScene("selection_points",null,null),this.selectionMeshes={},this.fadeMaterial=new L.MeshPhongMaterial({color:16777215,opacity:.1,reflectivity:0,transparent:!0,depthWrite:!1}),this.fadeMaterial.packedNormals=!0,Me.addInstancingSupport(this.fadeMaterial),Me.addMaterial("__fadeMaterial__",this.fadeMaterial,!0),this.setSelectionColor(6724095),Me.togglePolygonOffset(!0),Ce.setDepthMaterialOffset(Me.getPolygonOffsetOn(),Me.getPolygonOffsetFactor(),Me.getPolygonOffsetUnits()),this.progressiveRender=!0,this.swapBlackAndWhite=!1,this.targetFrameBudget=Oe,this.frameDisplayRate=5,Object(o.isMobileDevice)()&&(Re*=2,Oe*=2,this.targetFrameBudget/=2,this.frameDisplayRate/=2),this.interruptBudget=1e10,this.controls={update:function(e){this.camera.lookAt(this.camera.target),this.camera.updateProjectionMatrix(),this.camera.dirty=!1},handleResize:function(){},recordHomeView:function(){},uninitialize:function(){},isToolActivated:function(){return!1}},this.selector=new d.MultiModelSelector(this),this.visibilityManager=new h.MultiModelVisibilityManager(this),this.showGhosting=!0,this.showOverlaysWhileMoving=!0,this.skipAOWhenMoving=!1,this.keyFrameAnimator=null,this.zoomBoundsChanged=!0;var r=f.LightPresets[f.DefaultLightPreset].bgColorGradient;this.setClearColors(r[0],r[1],r[2],r[3],r[4],r[5]),Le=new p.GroundShadow(Te),Le.enabled=!0,at=new X,Me.addMaterialNonHDR("groundShadowDepthMaterial",Le.getDepthMaterial()),Me.addOverrideMaterial("normalsMaterial",Ce.getDepthMaterial()),Me.addOverrideMaterial("edgeMaterial",Ce.getEdgeMaterial()),Ce.beginScene(this.scene,this.camera,this.noLights,!0),Ce.composeFinalFrame(!0,o.isIE11),this.api.addEventListener(I.MODEL_ROOT_LOADED_EVENT,dt),this.api.addEventListener(I.MODEL_ROOT_LOADED_EVENT,ht)}},this.renderGroundShadow=function(e){je?je.state==b.SHADOWMAP_VALID&&je.renderGroundShadow(be.camera,e||Ce.getColorTarget()):(Le.renderShadow(be.camera,e||Ce.getColorTarget()),Le.rendered=!0)};var gt={NOTHING_DRAWN:0,MODEL_DRAWN:1,BACKGROUND_DRAWN:2,OVERLAY_DRAWN:4,REFLECTION_DRAWN:8,ALL_DRAWN:15};this.tick=function(e){at.highResTimeStamp=e=e||0,Te.updateTimestamp(e);var t=Me.updateMaterials();be.invalidate(t.needsClear,t.needsRender,t.overlayDirty);var r=y(e),n=be.controls.update(e),i=Ie&&Ie.update(e),o=n||r||Pe||i;Pe=!1;var s=Ee;F(),He=He||o,qe=qe||o;var a=!1;qe?W(e):Ce.overlayUpdate()&&!qe&&(qe=a=!0),this.isLoadingAnimationEnabled()&&Je-be.lastTime2dGeometryCreated<=Te.getLoadingAnimationDuration()&&(We=!0);var l=be.model&&be.model.loader&&be.model.loader.pagingProxy&&be.model.loader.pagingProxy.getMemoryInfo();at.signalProgressByRendering=be.model&&be.model.isLoadDone()&&!be.model.getData().isLeaflet&&!l,H()&&(He=!0);var c=He,u=Ie.frameResumePossible();if(He=He||!u,Qe=Qe||Ke&&!at.cmdListActive,He||We||qe||Qe)if(at.drawOverlay=qe,He||We||Qe){var d,h=c?w.ResetFlags.RESET_RELOAD:w.ResetFlags.RESET_NORMAL;He||We?(be.progressiveRender?(at.renderType=at.RENDERMODE_PROGRESSIVE,d=be.targetFrameBudget):(at.renderType=at.RENDERMODE_FULL,d=be.interruptBudget),He&&(Ke=Qe=!1)):(at.renderType=at.RENDERMODE_SILENT,d=be.targetFrameBudget,He=!0,h=w.ResetFlags.RESET_REDRAW,Ke=Qe=!1),be.skipCameraUpdate||be.updateCameraMatrices(),at.setFrame(d),at.finishedFullRender=!1,at.beginCommandSet();var f=Le.enabled&&!be.is2d&&!tt,p=!!De&&!be.is2d&&!tt,m=o||s,g=o&&be.skipAOWhenMoving&&Ce.getAOEnabled();at.addCommand($),at.setParam("BeginScene.signalCameraChanged",m),at.setParam("BeginScene.clear",He),g&&at.addCommand(le,at.CMD_ALWAYS_DO),Ie&&(je&&je.state!==b.SHADOWMAP_VALID&&at.addCommand(Z),f&&(at.addCommand(Y),at.setParam("GenerateGroundShadow.afterBeauty",!1),at.setParam("GenerateGroundShadow.signalRedraw",!1)),p?(De.setDirty(),at.addCommand(Q),at.setParam("GenerateGroundReflection.afterBeauty",!1)):f&&He&&at.addCommand(K),Ie.hasHighlighted()&&(at.addCommand(ee),at.setParam("BeginPhase.phase",_.RenderFlags.RENDER_HIGHLIGHTED),at.setParam("BeginPhase.moved",h),h=!1,at.addCommand(te)),at.addCommand(ee),at.setParam("BeginPhase.phase",_.RenderFlags.RENDER_NORMAL),at.setParam("BeginPhase.moved",h),h=!1,at.addCommand(te),!Ie.areAllVisible()&&be.showGhosting?(p&&at.renderType===at.RENDERMODE_PROGRESSIVE||(at.addCommand(ee),at.setParam("BeginPhase.phase",_.RenderFlags.RENDER_HIDDEN),at.setParam("BeginPhase.moved",h),at.addCommand(te)),at.addCommand(re)):at.addCommand(re),at.signalProgressByRendering&&at.addCommand(ie)),at.addCommand(oe,at.renderType===at.RENDERMODE_PROGRESSIVE?at.CMD_DO_AFTER:at.CMD_NORMAL_SEQUENCE),at.addCommand(ae,at.renderType===at.RENDERMODE_PROGRESSIVE?at.CMD_DO_AFTER:at.CMD_NORMAL_SEQUENCE),at.setParam("PostAndPresent.performAO",Ce.getAOEnabled()&&!g),at.renderType===at.RENDERMODE_PROGRESSIVE&&Ie&&(je&&je.state!==b.SHADOWMAP_VALID&&(at.addCommand(J),at.addCommand(Z)),f&&(at.addCommand(Y),at.setParam("GenerateGroundShadow.afterBeauty",!0),at.setParam("GenerateGroundShadow.signalRedraw",!p),at.signalProgressByRendering&&at.addCommand(ie)),p&&(at.groundShadowInPost=!1,at.addCommand(Q),at.setParam("GenerateGroundReflection.afterBeauty",!0),!Ie.areAllVisible()&&be.showGhosting&&(at.addCommand(ee),at.setParam("BeginPhase.phase",_.RenderFlags.RENDER_HIDDEN),at.setParam("BeginPhase.moved",h),at.addCommand(te)),at.addCommand(ne),at.addCommand(ae),at.setParam("PostAndPresent.performAO",Ce.getAOEnabled()&&!g),at.signalProgressByRendering&&at.addCommand(ie))),g&&(at.addCommand(ce,at.CMD_ALWAYS_DO),at.addCommand(ue)),at.addCommand(de),at.endCommandSet(),He=!1,We=!1,qe=!1}else at.finishedFullRender&&(at.beginCommandSet(),a?at.addCommand(se):at.addCommand(oe,!0),at.addCommand(ae,!0),at.setParam("PostAndPresent.performAO",Ce.getAOEnabled()),at.endCommandSet(),qe=!1);ct=at.cmdListActive,be.onBeforeRender&&be.onBeforeRender(ct),at.executeCommandList(),ct!==mt&&(be.api.dispatchEvent({type:I.FINAL_FRAME_RENDERED_CHANGED_EVENT,value:{finalFrame:!ct}}),mt=ct),Je=at.highResTimeStamp},this.setLmvDisplay=function(e){ut=e},this.run=function(){we=0,setTimeout(function(){!function e(t){we=ut.requestAnimationFrame(e),be.tick(t)}()},1)},this.stop=function(){var e=be.getWindow();e.cancelAnimationFrame(we)},this.toggleProgressive=function(e){this.progressiveRender=e,He=!0},this.updateClearColors=function(){var e=this.clearColorTop;if(this.is2d&&this.swapBlackAndWhite){var t=1===e.x&&1===e.y&&1===e.z,r=0===e.x&&0===e.y&&0===e.z;t?e=new L.Color(0,0,0):r&&(e=new L.Color(1,1,1))}Ce.setClearColors(e,this.clearColorBottom)},this.toggleSwapBlackAndWhite=function(e){this.swapBlackAndWhite=e,this.updateClearColors(),He=!0},this.toggleGrayscale=function(e){Me.setGrayscale(e),He=!0},this.toggleGhosting=function(e){this.showGhosting=e,He=!0},this.toggleOverlaysWhileMoving=function(e){this.showOverlaysWhileMoving=e},this.togglePostProcess=function(e,t){Ce.initPostPipeline(e,t),this.fireRenderOptionChanged(),He=!0},this.toggleGroundShadow=function(e){Le.enabled!==e&&(Le.enabled=e,Le.clear(),e&&Le.setDirty(),G(),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.isGroundShadowEnabled=function(){return Le&&Le.enabled},this.setGroundShadowColor=function(e){Le.enabled&&(Le.setColor(e),this.invalidate(!0,!1,!1))},this.setGroundShadowAlpha=function(e){Le.enabled&&(Le.setAlpha(e),this.invalidate(!0,!1,!1))},this.toggleGroundReflection=function(e){e&&De||!e&&!De||(e?(De=new E.GroundReflection(Te,this.canvas.clientWidth,this.canvas.clientHeight,{clearPass:Ce.getClearPass()}),De.setClearColors(this.clearColorTop,this.clearColorBottom,Object(o.isMobileDevice)()),De.toggleEnvMapBackground(rt),De.setEnvRotation(Ce.getEnvRotation()),G()):(De.cleanup(),De=void 0),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.setGroundReflectionColor=function(e){De&&(De.setColor(e),this.invalidate(!0,!1,!1))},this.setGroundReflectionAlpha=function(e){De&&(De.setAlpha(e),this.invalidate(!0,!1,!1))},this.toggleEnvMapBackground=function(e){rt=e,Ce.toggleEnvMapBackground(e),De&&De.toggleEnvMapBackground(e),this.invalidate(!0,!0,!1)},this.isEnvMapBackground=function(){return rt},this.setOptimizeNavigation=function(e){this.skipAOWhenMoving=e},this.renderOverlays=function(){he();var e=this.lightsOn;e||this.toggleLights(!0,!0);var t;this.dir_light1&&(t=this.dir_light1.intensity,this.dir_light1.intensity=1),Ce.renderOverlays(this.overlayScenes,this.lightsOn?this.lights:this.no_lights),e||this.toggleLights(!1,!0),this.dir_light1&&(this.dir_light1.intensity=t)},this.setLayerVisible=function(e,t){this.layers.setLayerVisible(e,t)},this.isLayerVisible=function(e){return this.layers.isLayerVisible(e)},this.getVisibleLayerIndices=function(){return this.layers.getVisibleLayerIndices()},this.setNearRadius=function(e,t){this.nearRadius!==e&&(this.nearRadius=e,t&&this.invalidate(!0))},this.getNearRadius=function(){return this.nearRadius},this.updateNearFarValues=function(){function e(){t=new L.Matrix4,r=new L.Matrix4,n=new L.Box3}var t,r,n;return function(i,o){if(n||e(),t.compose(i.position,i.quaternion,i.scale),r.getInverse(t),n.copy(o),De){var s=new L.Vector3;s.multiplyVectors(n.max,i.worldup);var a=new L.Vector3;a.multiplyVectors(n.min,i.worldup),s.sub(a),s.x>=0?n.min.x-=s.x:n.max.x-=s.x,s.y>=0?n.min.y-=s.y:n.max.y-=s.y,s.z>=0?n.min.z-=s.z:n.max.z-=s.z}je&&je.groundShapeBox&&n.union(je.groundShapeBox),n.applyMatrix4(r);var l=1e-5*(n.max.z-n.min.z),c=.5*(n.max.y-n.min.y),u=-(n.max.z+l)-c,d=-(n.min.z-l)+c;i.isPerspective&&(this.nearRadius>0?(u=Math.max(u,Math.min(this.nearRadius,1e-4*Math.abs(d-u))),d=Math.min(d,1e4*u)):(u=Math.max(u,Math.min(1,1e-4*Math.abs(d-u))),0>d&&(d=1e-4),u=Math.max(u,1e-5*d))),d=Math.max(d,u),i.near=u,i.far=d,i.updateProjectionMatrix(),i.updateMatrixWorld(),i.matrixWorldInverse.getInverse(i.matrixWorld)}}(),this.getPixelsPerUnit=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.model,n=Ce.settings.deviceHeight,i=r.is2d(),o=Me.getCutPlanesRaw(),s=o[0],a=r.getBoundingBox();return N.SceneMath.getPixelsPerUnit(e,i,t,n,s,a)},this.updateCameraMatrices=function(){var e=this.camera;e.worldup&&this.setWorldUp(e.worldup);var t=this.getVisibleBounds(!0,qe);if(this.updateNearFarValues(e,t),this.model){var r=this.getPixelsPerUnit(e,t);this.model.is2d()?(Me.updatePixelScale(r,Ce.settings.deviceWidth,Ce.settings.deviceHeight),Me.updateSwapBlackAndWhite(this.swapBlackAndWhite)):Me.updatePixelScale(r,Ce.settings.deviceWidth,Ce.settings.deviceHeight)}},this.initLights=function(){this.dir_light1=new L.DirectionalLight(ot,it),this.dir_light1.position.copy(Ge),this.amb_light=new L.AmbientLight(st),this.lights=[this.dir_light1,this.amb_light],this.camera.add(this.dir_light1),this.camera.add(this.dir_light1.target),nt=!0};var vt=function(e,t,r,n){var i=f.LightPresets[Ne],o=i&&i.ambientColor,s=i&&i.directLightColor;o=o||st.toArray(),s=s||ot.toArray(),r?(n&&e?e.color.setRGB(.5*s[0],.5*s[1],.5*s[2]):e&&e.color.setRGB(o[0],o[1],o[2]),t&&t.color.setRGB(s[0],s[1],s[2])):e&&n&&e.color.setRGB(o[0],o[1],o[2])};this.toggleLights=function(e,t){this.amb_light&&(this.lightsOn=e,vt(this.amb_light,this.dir_light1,e,t))},this.syncCamera=function(e){this.camera.updateCameraMatrices(),e&&this.setWorldUp(this.api.navigation.getWorldUpVector()),Pe=!0},this.getModelCamera=function(e){if(e){var t,r=e.getDefaultCamera();return t=r?r:D.UnifiedCamera.getViewParamsFromBox(e.getBoundingBox(),e.is2d(),this.camera.aspect,this.camera.up,this.camera.fov)}},this.setViewFromFile=function(e,t){if(e){var r=this.getModelCamera(e),n=e.getMetadata("navigation hint","value",null),i=this.controls.isToolActivated("freeorbit")||t&&"Freeorbit"===n;this.setViewFromCamera(r,t,i)}},this.adjustOrthoCamera=function(e){if(!e.isPerspective&&this.model){var t=this.model.getBoundingBox(),r=t.size(),n=e.target.clone().sub(e.position),i=n.length();if(i>1e3*r.length()){var o=e.position.distanceTo(t.center());e.target.copy(e.position).add(n.normalize().multiplyScalar(o))}else if(Math.abs(i-e.orthoScale)/i>1e-5){g.logger.warn("Ortho scale does not match eye-target distance. One of them is likely wrong, but which one?");var s=0===e.fov&&1===e.orthoScale,a=!s;a&&e.position.copy(e.target).add(n.normalize().multiplyScalar(-e.orthoScale))}}},this.setViewFromCamera=function(e,t,r){this.adjustOrthoCamera(e);var n,i=this.model?this.model.getUpVector():null;n=i?(new L.Vector3).fromArray(i):r?e.up.clone():R.Navigation.snapToAxis(e.up.clone()),r?this.api.prefs&&this.api.prefs.set("fusionOrbitConstrained",n.equals(e.up)):e.up=n;var o=this.api.navigation;if(o){var s=this.camera;if(t)s.up.copy(e.up),s.position.copy(e.position),s.target.copy(e.target),e.isPerspective?s.fov=e.fov:(s.saveFov=e.fov,s.fov=D.UnifiedCamera.ORTHO_FOV),s.isPerspective=e.isPerspective,s.orthoScale=e.orthoScale,s.dirty=!0,o.setWorldUpVector(r?n:s.up),o.setView(s.position,s.target),o.setPivotPoint(s.target),this.syncCamera(!0);else if(s.isPerspective=e.isPerspective,e.isPerspective||(s.saveFov=e.fov,e.fov=D.UnifiedCamera.ORTHO_FOV),r)o.setRequestTransitionWithUp(!0,e.position,e.target,e.fov,e.up,n);else{var a=this.model.getData().bbox;if(!a.containsPoint(e.target)){var l=a.center().distanceTo(e.position),c=e.target.clone().sub(e.position).normalize().multiplyScalar(l);e.target.copy(e.position.clone().add(c))}var u=o.computeOrthogonalUp(e.position,e.target);o.setRequestTransitionWithUp(!0,e.position,e.target,e.fov,u,n)}}Pe=!0},this.getViewArrayFromCamera=function(e){var t,r=e||{x:0,y:0,z:0},n=this.camera,i=this.model.getUpVector();t=i?(new L.Vector3).fromArray(i):R.Navigation.snapToAxis(n.up.clone());var o=this.api.navigation.getPivotPoint(),s=[n.position.x+r.x,n.position.y+r.y,n.position.z+r.z,o.x+r.x,o.y+r.y,o.z+r.z,t.x,t.y,t.z,n.aspect,L.Math.degToRad(n.fov),n.orthoScale,n.isPerspective?0:1];return s},this.setViewFromViewBox=function(e,t,r,n){if(e.is2d()){var i={},o=e.getBoundingBox(),s={width:t[2]-t[0],height:t[3]-t[1]};s.aspect=s.width/s.height,s.centerX=t[0]+s.width/2,s.centerY=t[1]+s.height/2;var a=this.camera.aspect;a>s.aspect?i.orthoScale=s.height:i.orthoScale=s.width/a,i.isPerspective=!1,i.position=new L.Vector3(s.centerX,s.centerY,o.center().z+i.orthoScale),i.target=new L.Vector3(s.centerX,s.centerY,o.center().z),i.target.y+=1e-6*s.height,i.up=new L.Vector3(0,0,1),this.setViewFromCamera(i,n,!1)}},this.setWorldUp=function(e){if(!xe.equals(e)){xe.copy(e);var t=Math.abs(e.x);Ue="x",Math.abs(e.y)>t&&(Ue="y",t=Math.abs(e.y)),Math.abs(e.z)>t&&(Ue="z");var r=function(e,t){var r=(new L.Vector3).crossVectors(t,e).normalize(),n=Math.acos(e.dot(t));return(new L.Matrix4).makeRotationAxis(r,n)},n=new L.Vector3(0,1,0);be.camera.worldUpTransform=r(n,e),this.sceneUpdated(!1)}},this.addModel=function(e,t){if(e){var r=!!this.model,n=e.is2d();if(this.model||e.getData().underlayRaster||(this.model=e,Ce.setUnitScale(e.getUnitScale())),this.layers||(this.layers=new S.ModelLayers(this)),e.getData().underlayRaster||this.layers.addModel(e,!0),Ie.addModel(e),this.selector.addModel(e),this.visibilityManager.addModel(e),this._setModelPreferences(e),n){var i=e.getData();i.layerCount&&Me.initLayersTexture(i.layerCount,i.layersMap,e.id);var o=Me.create2DMaterial(null,{},!0,!1,function(){be.invalidate(!1,!0,!1)}),s=Me.findMaterial(null,o);if(r||(this.is2d&&Ce.exit2DMode(),Ce.enter2DMode(s,this.matman().get2dSelectionColor())),!r){this.is2d||this.saveLightPreset(),this.is2d=!0,this.setLightPreset(f.DefaultLightPreset2d),this.setRenderingPrefsFor2D(!0);var a=e.getData();if(a.hidePaper){var l=a.bgColor,c=l>>16&255,u=l>>8&255,d=255&l;this.setClearColors(c,u,d,c,u,d)}}}else!r&&this.is2d&&(this.is2d=void 0,Ce.exit2DMode());this.updateClearColors(),this.setupLighting(e),pe(),this.fireRenderOptionChanged(),this.invalidate(!0),this.api.fireEvent({type:I.MODEL_ADDED_EVENT,model:e,preserveTools:t,isOverlay:r})}},this._setModelPreferences=function(e){e.hideLines(!this.api.prefs.lineRendering),e.hidePoints(!this.api.prefs.pointRendering),e.selector.setSelectionMode(this.api.prefs.get(V.Prefs3D.SELECTION_MODE))},this.setupLighting=function(e){e=e||this.model,Object(o.isNodeJS)()||!e||e.is2d()||(this.setLightPresetFromFile(e)||(Fe>=0?(this.setLightPreset(Fe,!0,Ve),Fe=-1,Ve=null):this.setLightPreset(Ne,!1)),this.setAOHeuristics(e))},this.getSvfMaterialId=function(e){return this.model.getFragmentList().getSvfMaterialId(e)},this.getMaterials=function(){return Me},this.setupMesh=function(e,t,r,n){var i={geometry:t,matrix:n,isLine:t.isLines,isWideLine:t.isWideLines,isPoint:t.isPoints,is2d:t.is2d};return r&&(i.material=this.matman().setupMaterial(e,t,r)),e.is2d()&&(i.geometry.creationTime=Je,this.lastTime2dGeometryCreated=Je),i},this.init2dSelection=function(e){var t=fe(e);if(!this.overlayScenes[t]){var r=Me.initSelectionTexture(e.getData().maxObjectNumber,e.id),n=Me.create2DMaterial(e,{},!1,r,function(){be.invalidate(!1,!0,!1)}),i=Me.findMaterial(e,n);this.createOverlayScene(t,i)}},this.onLoadComplete=function(e){tt=!1,this.signalProgress(100,a.ProgressState.LOADING),this.modelVisible(e.id)&&((Le&&Le.enabled||De)&&this.sceneUpdated(!1,!0),this.invalidate(!!De,!0,!1)),this.is2d&&e.is2d()&&this.init2dSelection(e);var t=e.getGeometryList();t&&t.printStats(),e.hasGeometry()?Me.hasTransparentMaterial()&&this.requestSilentRender():g.logger.warn("Loaded model has no geometry."),this.handleInitialVisibility(e),this.api.dispatchEvent({type:I.GEOMETRY_LOADED_EVENT,model:e})},this.onTextureLoadComplete=function(e){this.api.dispatchEvent({type:I.TEXTURES_LOADED_EVENT,model:e}),this.requestSilentRender()},this.signalProgress=function(e,t,r){Xe.percent===e&&Xe.state===t&&r&&Xe.model&&Xe.model.id===r.id||(Xe.percent=e,Xe.state=t,r&&(Xe.model=r),this.api.dispatchEvent(Xe))},this.resize=function(e,t,r){Ee=!0,Se=e,Ae=t,r&&F(!0)},this.unloadModel=function(e,t){(this.removeModel(e)||Ie.removeHiddenModel(e))&&(t||(e.dtor(this.glrenderer()),Me.cleanup(e),e.loader&&(e.loader.dtor(),e.loader=null)),e.is2d()&&this.overlayScenes[e.id]&&this.removeOverlayScene(fe(e)),this.api.dispatchEvent({type:I.MODEL_UNLOADED_EVENT,model:e}))},this._reserveLoadingFile=function(){this.loaders||(this.loaders=[]);var e={dtor:function(){}};return this.loaders.push(e),e},this._hasLoadingFile=function(){return this.loaders&&this.loaders.length>0},this._addLoadingFile=function(e,t){if(this.loaders){var r=this.loaders.indexOf(e);r>=0&&(this.loaders[r]=t)}},this._removeLoadingFile=function(e){if(this.loaders){var t=this.loaders.indexOf(e);t>=0&&this.loaders.splice(t,1)}},this.removeModel=function(e){return Ie.removeModel(e)?(this.keyFrameAnimator&&(this.keyFrameAnimator.destroy(),this.keyFrameAnimator=null),this.selector.removeModel(e),this.visibilityManager.removeModel(e),this.layers.removeModel(e),e===this.model&&(this.model=null,Ie.isEmpty()||(this.model=Ie.getModels()[0])),pe(),this.invalidate(!0,!0,!0),this.api.fireEvent({type:I.MODEL_REMOVED_EVENT,model:e}),!0):!1},this.cancelLoad=function(e){if(this.loaders)for(var t=0;t<this.loaders.length;t++){var r=this.loaders[t];if(r.currentLoadPath===e){r.dtor(),this.loaders.splice(t,1);break}}},this.unloadCurrentModel=function(){this.model&&(this.is2d?(this.is2d=void 0,this.removeOverlayScene(fe(this.model)),Ce.exit2DMode()):Fe=Ne,Ce.beginScene(this.scene,this.camera,this.lightsOn?this.lights:this.no_lights,!0),Ce.composeFinalFrame(!0)),this.loaders&&(this.loaders.forEach(function(e){e.dtor()}),this.loaders=[]);for(var e=Ie.getModels(),t=e.length-1;t>=0;t--)this.unloadModel(e[t]);this.model=null};var yt=function(e,t,r){t.depthWrite=!1,t.depthTest=!0,t.side=L.DoubleSide,r.depthWrite=!1,r.depthTest=!0,r.side=L.DoubleSide,Me.addInstancingSupport(t),Me.addInstancingSupport(r),be.createOverlayScene(e,t,r)},_t=function(){be.selectionMaterialBase=new L.MeshPhongMaterial({specular:526344,ambient:0,opacity:1,transparent:!1}),be.selectionMaterialTop=new L.MeshPhongMaterial({specular:526344,ambient:0,opacity:.15,transparent:!0}),be.selectionMaterialTop.packedNormals=!0,be.selectionMaterialBase.packedNormals=!0,yt("selection",be.selectionMaterialBase,be.selectionMaterialTop),be.highlightMaterial=new L.MeshPhongMaterial({specular:526344,ambient:0,opacity:1,transparent:!1}),be.highlightMaterial.packedNormals=!0,Me.addInstancingSupport(be.highlightMaterial),Me.addMaterial("__highlightMaterial__",be.highlightMaterial,!0)};this.createOverlayScene=function(e,t,r,n){t&&Me.addOverrideMaterial(e+"_pre",t),r&&Me.addOverrideMaterial(e+"_post",r);var i=new L.Scene;i.__lights=this.scene.__lights,this.overlayScenes[e]={scene:i,camera:n,materialName:e,materialPre:t,materialPost:r}},this.removeOverlayScene=function(e){var t=this.overlayScenes[e];if(t){var r=this.overlayScenes[e];r.materialPre&&Me.removeMaterial(r.materialName+"_pre"),r.materialPost&&Me.removeMaterial(r.materialName+"_post"),delete this.overlayScenes[e],this.invalidate(!1,!1,!0)}},this.addOverlay=function(e,t){this.overlayScenes[e]&&(this.overlayScenes[e].scene.add(t),this.invalidate(!1,!1,!0))},this.addMultipleOverlays=function(e,t){for(var r in t)t.hasOwnProperty(r)&&this.addOverlay(e,t[r])},this.removeOverlay=function(e,t){this.overlayScenes[e]&&(this.overlayScenes[e].scene.remove(t),this.invalidate(!1,!1,!0))},this.removeMultipleOverlays=function(e,t){for(var r in t)t.hasOwnProperty(r)&&this.removeOverlay(e,t[r])},this.clearOverlay=function(e){if(this.overlayScenes[e]){var t,r,n=this.overlayScenes[e].scene;for(r=n.children.length-1;r>=0;--r)t=n.children[r],t&&n.remove(t);this.invalidate(!1,!1,!0)}},this.setClearColors=function(e,t,r,n,i,s){this.clearColorTop=new L.Vector3(e/255,t/255,r/255),this.clearColorBottom=new L.Vector3(n/255,i/255,s/255),this.updateClearColors(),De&&De.setClearColors(this.clearColorTop,this.clearColorBottom,Object(o.isMobileDevice)()),He=!0,this.fireRenderOptionChanged()},this.setClearAlpha=function(e){Ce.setClearAlpha(e)};var bt=new L.Box3,xt=new L.Box3;this.getVisibleBounds=function(e,t){var r=new L.Box3;return Ie.isEmpty()||(me(r,this.scene),r=Ie.getVisibleBounds(e).union(r),t&&(r=ge().union(r))),r},this.getFitBounds=function(e){var t;return e||null===this.selector||(t=this.selector.getSelectionBounds()),(!t||t.empty())&&(t=this.getVisibleBounds()),t},this.getRenderProxy=function(e,t){return e.getFragmentList().getVizmesh(t)},this.getLayersRoot=function(){return this.layers.getRoot()},this.getFragmentProxy=function(e,t){return new A.FragmentPointer(e.getFragmentList(),t)},this.getRenderProxyCount=function(e){return e.getFragmentList().getCount()},this.getRenderProxyDbIds=function(e,t){return e.getFragmentList().getDbIds(t)},this.isWholeModelVisible=function(e){return Ie?Ie.areAllVisible():!0},this.isNodeVisible=function(e,t){return this.visibilityManager.isNodeVisible(t,e)},this.highlightObjectNode=function(e,t,r,n){t=e.reverseMapDbId(t),e.is2d()&&(Me.highlightObject2D(t,r,e.id),this.invalidate(!1,!1,!0)),this.renderer().setDbIdForEdgeDetection(r&&!n?t:0,r?e.id:0);var i=this,o=e.getData().instanceTree;if(o&&!e.is2d())o.enumNodeFragments(t,function(t){i.highlightFragment(e,t,r,n)},!1);else{var s=t;if(e.is2d()&&(s=e.getData().fragments.dbId2fragId[t]),Array.isArray(s))for(var a=0;a<s.length;a++)i.highlightFragment(e,s[a],r,n);else i.highlightFragment(e,s,r,n)}},this.highlightFragment=function(e,t,r,n){
var i=this.getRenderProxy(e,t);if(i){var o=!n||i.is2d||i.isPoint||i.themingColor,s=e.id+":"+t;if(o){var a="selection";if(e.is2d()&&(a=fe(e)),i.isPoint&&(a+="_points"),r)if(i.is2d&&this.selectionMeshes.hasOwnProperty(s))++this.selectionMeshes[s]._lmv_highlightCount;else{var l;if(!i||!i.geometry)return;if(i.isPoint){var c=i.material.clone();c.color=this.selectionMaterialBase.color,c.needsUpdate=!0,l=new L.Mesh(i.geometry,c)}else l=new L.Mesh(i.geometry,i.material);l.matrix.copy(i.matrixWorld),l.matrixAutoUpdate=!1,l.matrixWorldNeedsUpdate=!0,l.frustumCulled=!1,l.model=e,l.fragId=t,l._lmv_highlightCount=1,this.addOverlay(a,l),this.selectionMeshes[s]=l}else if(this.selectionMeshes.hasOwnProperty(s)){var u=this.selectionMeshes[s];--u._lmv_highlightCount<=0&&(this.removeOverlay(a,u),delete this.selectionMeshes[s])}}o&&r||e.setHighlighted(t,r)&&this.invalidate(!0)}},this.explode=function(e){return e=Number(e),e==Ze?!1:(Ze=e,this.refreshExplode(),this.api.dispatchEvent({type:I.EXPLODE_CHANGE_EVENT,scale:e}),!0)},this.refreshExplode=function(){Ie.explode(Ze),this.sceneUpdated(!0)},this.getExplodeScale=function(){return Ze},this.lockExplode=function(e,t,r){r=r||this.model;var n=r.getData().instanceTree;if(!n)return!1;var i,o=function(e,r){return n.enumNodeChildren(r,function(r){e=n.lockNodeExplode(r,t)||e},!0),e};return i=Array.isArray(e)?e.reduce(o,!1):o(!1,e),i&&Ze>0&&(Ie.explode(Ze),this.sceneUpdated(!0)),i},this.isExplodeLocked=function(e,t){t=t||this.model;var r=t.getData().instanceTree;return r&&r.isNodeExplodeLocked(e)},this.setGhostingBrightness=function(e){function t(e){e.color=r}var r=new L.Color(e?1052688:16777215);t(this.fadeMaterial),this.fadeMaterial.variants&&this.fadeMaterial.variants.forEach(t)},this.loadCubeMapFromColors=function(e,t){var r=Object(M.CreateCubeMapFromColors)(e,t);return r.isBgColor=!0,Me.setReflectionMap(r),r},this.loadCubeMap=function(e,t){this._reflectionMapPath=e;var r=function(t){e===be._reflectionMapPath&&Me&&(Me.setReflectionMap(t),be.invalidate(!0),t?f.LightPresets[Ne].useIrradianceAsBackground||Ce.setCubeMap(t):be.loadCubeMapFromColors(be.clearColorTop,be.clearColorBottom))};return v.TextureLoader.loadCubeMap(e,t,r)},this.loadIrradianceMap=function(e,t){this._irradianceMapPath=e;var r=function(t){e===be._irradianceMapPath&&Me&&(Me.setIrradianceMap(t),be.invalidate(!0),f.LightPresets[Ne].useIrradianceAsBackground&&Ce.setCubeMap(t))};return v.TextureLoader.loadCubeMap(e,t,r)},this.setCurrentLightPreset=function(e){Ne=e},this.setLightPreset=function(e,t,r){if(Object(o.isNodeJS)()&&(e=0),nt||this.initLights(),Ne===e&&!t)return void(r&&r());if((0>e||f.LightPresets.length<=e)&&(e=f.DefaultLightPreset),Ne=e,Ie.isEmpty())return Fe=Ne,void(Ve=r);var n=f.LightPresets[e],i=n.bgColorGradient;if(i||(i=f.BackgroundPresets.Custom),this.setClearColors(i[0],i[1],i[2],i[3],i[4],i[5]),void 0!==n.useIrradianceAsBackground&&(this.api.prefs.hasTag("envMapBackground","ignore-producer")?g.logger.debug("setLightPreset(): envMapBackground is locked. No changes."):(this.api.prefs.tag("no-storage","envMapBackground"),this.api.setEnvMapBackground(n.useIrradianceAsBackground))),n.path){var s="res/environments/"+n.path,a=Object(T.getResourceUrl)(s+"_mipdrop."+(n.type||"")+".dds"),l=Object(T.getResourceUrl)(s+"_irr."+(n.type||"")+".dds");this.loadIrradianceMap(l,n.E_bias),this.loadCubeMap(a,n.E_bias),Me.setEnvExposure(-n.E_bias),Ce.setEnvExposure(-n.E_bias),this.setTonemapExposureBias(n.E_bias),this.setTonemapMethod(n.tonemap),this.setGhostingBrightness(n.darkerFade)}else{var c=this.loadCubeMapFromColors(this.clearColorTop,this.clearColorBottom);Ce.setCubeMap(c),Me.setIrradianceMap(null),Me.setEnvExposure(-n.E_bias||0),Ce.setEnvExposure(-n.E_bias||0),this.setTonemapExposureBias(n.E_bias||0),this.setTonemapMethod(n.tonemap||0),this.setGhostingBrightness(n.darkerFade),Ce.toggleEnvMapBackground(rt),this.invalidate(!0)}var u=C.SAOShader.uniforms.radius.value,d=C.SAOShader.uniforms.intensity.value;n.hasOwnProperty("saoRadius")&&(u=n.saoRadius),n.hasOwnProperty("saoIntensity")&&(d=n.saoIntensity),Ce.setAOOptions(u,d);var h=it;null!==n.lightMultiplier&&void 0!==n.lightMultiplier&&(h=n.lightMultiplier),ze.copy(Be),n.lightDirection&&ze.fromArray(n.lightDirection).negate(),je&&q(),this.dir_light1&&(this.dir_light1.intensity=h,n.lightDirection?this.dir_light1.position.set(-n.lightDirection[0],-n.lightDirection[1],-n.lightDirection[2]):this.dir_light1.position.copy(Ge)),Me.setEnvRotation(n.rotation||0),Ce.setEnvRotation(n.rotation||0),De&&De.setEnvRotation(n.rotation||0),this.toggleLights(0!==h),this.invalidate(!0,!1,!0),this.fireRenderOptionChanged(),r&&r()},this.setLightPresetFromFile=function(e){if(!e||e.is2d())return!1;var t,r=e.getMetadata("renderEnvironmentGroundReflection","value",null);t=this.api.prefs.hasTag(V.Prefs3D.GROUND_REFLECTION,"ignore-producer"),null===r||t||(this.api.prefs.tag("no-storage",V.Prefs3D.GROUND_REFLECTION),this.api.setGroundReflection(r));var n=e.getMetadata("renderEnvironmentGroundShadow","value",null);t=this.api.prefs.hasTag(V.Prefs3D.GROUND_SHADOW,"ignore-producer"),null===n||t||(this.api.prefs.tag("no-storage",V.Prefs3D.GROUND_SHADOW),this.api.setGroundShadow(n));var i=e.getMetadata("renderEnvironmentAmbientShadows","value",null);t=this.api.prefs.hasTag(V.Prefs3D.AMBIENT_SHADOWS,"ignore-producer"),null===i||t||(this.api.prefs.tag("no-storage",V.Prefs3D.AMBIENT_SHADOWS),this.api.setQualityLevel(i,Ce.getAntialiasing()));var s=e.getMetadata("renderEnvironmentDisplayLines","value",null);t=this.api.prefs.hasTag(V.Prefs3D.LINE_RENDERING,"ignore-producer"),null===s||t||(this.api.prefs.tag("no-storage",V.Prefs3D.LINE_RENDERING),this.api.hideLines(!s));var a=e.getMetadata("renderEnvironmentDisplayPoints","value",null);t=this.api.prefs.hasTag(V.Prefs.POINT_RENDERING,"ignore-producer"),null===a||t||(this.api.prefs.tag("no-storage",V.Prefs.POINT_RENDERING),this.api.hidePoints(!a));var l=e.getMetadata("renderEnvironmentDisplayEdges","value",null);t=this.api.prefs.hasTag(V.Prefs3D.EDGE_RENDERING,"ignore-producer"),null===l||t||(this.api.prefs.tag("no-storage",V.Prefs3D.EDGE_RENDERING),this.api.setDisplayEdges(!Object(o.isMobileDevice)()&&!!l));var c=e.getMetadata("renderEnvironmentStyle","value",null),u=f.LightPresets.filter(function(e){return e.name===c})[0];if(t=this.api.prefs.hasTag(V.Prefs3D.LIGHT_PRESET,"ignore-producer"),u&&!t){this.api.prefs.tag("no-storage",V.Prefs3D.LIGHT_PRESET);var d=U;d||(d=U={},f.LightPresets.push(d)),Object(f.copyLightPreset)(u,d),d.name="(Custom: Model defined)";var h=e.getMetadata("renderEnvironmentExposureBias","value",null),p=e.getMetadata("renderEnvironmentExposureBase","value",null);null!==h&&null!==p&&(d.E_bias=h+p);var m=e.getMetadata("renderEnvironmentBackgroundColor","value",null);t=this.api.prefs.hasTag(V.Prefs.BACKGROUND_COLOR_PRESET,"ignore-producer"),m&&!t&&(d.bgColorGradient=[255*m[0],255*m[1],255*m[2],255*m[0],255*m[1],255*m[2]]);var g=e.getMetadata("renderEnvironmentRotation","value",null);null!==g&&(d.rotation=g);var v=f.LightPresets.indexOf(d);this.setLightPreset(v,!0)}var y=e.getMetadata("renderEnvironmentBackgroundFromEnvironment","value",null);return t=this.api.prefs.hasTag(V.Prefs3D.ENV_MAP_BACKGROUND,"ignore-producer"),null===y||t||(this.api.prefs.tag("no-storage",V.Prefs3D.ENV_MAP_BACKGROUND),this.api.setEnvMapBackground(y)),u},this.setLightPresetForAec=function(){for(var e=Object(o.getGlobal)().DefaultLightPresetAec||"Boardwalk",t=-1,r=0;r<f.LightPresets.length;r++)if(f.LightPresets[r].name===e){t=r;break}return t>=0&&(this.api.prefs.hasTag("lightPreset","ignore-producer")?g.logger.debug("setLightPresetForAec(): lightPreset is locked. No changes."):(this.api.prefs.tag("no-storage","lightPreset"),this.setLightPreset(t,!0,function(){this.api.prefs.tag("ignore-producer","envMapBackground")}.bind(this)),this.saveLightPreset())),this.api.prefs.hasTag("edgeRendering","ignore-producer")?g.logger.debug("setLightPresetForAec(): edgeRendering is locked. No changes."):(this.api.prefs.tag("no-storage","edgeRendering"),this.api.setDisplayEdges(!Object(o.isMobileDevice)())),!0},this.setAOHeuristics=function(e){var t=e.getUnitScale(),r=e.getMetadata("renderEnvironmentAmbientShadows","radius",void 0),n=e.getMetadata("renderEnvironmentAmbientShadows","intensity",void 0),i=e.getMetadata("renderEnvironmentAmbientShadows","opacity",void 0);if(void 0!==r||void 0!==n||void 0!==i)Ce.setAOOptions(r/t,n,i);else if(e.isAEC()){var o=t>.3;o?Ce.setAOOptions(4/t,1,.625):Ce.setAOOptions(.25/t,1,.625)}else{var s=e.getData().bbox,a=s.size().length();Ce.setAOOptions(Math.min(10,.05*a))}},this.setTonemapMethod=function(e){e!=Ce.getToneMapMethod()&&(Ce.setTonemapMethod(e),Me.setTonemapMethod(e),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setTonemapExposureBias=function(e){e!=Ce.getExposureBias()&&(Ce.setTonemapExposureBias(e),Me.setTonemapExposureBias(e),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setRenderingPrefsFor2D=function(e){if(!Object(o.isNodeJS)()){var t=e?!1:!!this.api.prefs.envMapBackground;this.toggleEnvMapBackground(t)}},this.dtor=function(){var e=be.getWindow();e.cancelAnimationFrame(we),this.api.removeEventListener(I.MODEL_ROOT_LOADED_EVENT,dt),this.api.removeEventListener(I.MODEL_ROOT_LOADED_EVENT,ht),this.unloadCurrentModel(),this.controls=null,this.canvas=null,clearInterval(this.interval),this.loader=null,this.selector.dtor(),this.selector=null,this.model=null,this.layers=null,this.visibilityManager=null,lt&&(lt.removeViewer(this.api),lt=null),Ie=null,Ce=null,Me.refCount--,0===Me.refCount&&Me.dtor(),Me=null,Te&&(Te.refCount--,0===Te.refCount&&(Te.webglcontextlost=null,Te.domElement=null,Te.context=null),Te=null)},this.hideLines=function(e){Ie&&!Ie.isEmpty()&&(Ie.hideLines(e),this.sceneUpdated(!0))},this.hidePoints=function(e){Ie&&!Ie.isEmpty()&&(Ie.hidePoints(e),this.sceneUpdated(!0))},this.setDisplayEdges=function(e){Ce.toggleEdges(e);var t=e;e||(t=!(!this.model||!this.model.getData().hasLines)),Me.togglePolygonOffset(t),Ce.setDepthMaterialOffset(Me.getPolygonOffsetOn(),Me.getPolygonOffsetFactor(),Me.getPolygonOffsetUnits()),this.invalidate(!0)},this.setDoubleSided=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0;if(t=t||this.model,!t.is2d()){var n=t.getData();n&&(this.matman().setDoubleSided(e,t),r&&this.sceneUpdated())}},this.getAllCutPlanes=function(){var e=void 0;for(var t in ft){var r=ft[t];r&&r.length&&(e=e?t===pt?r.concat(e):e.concat(r):r)}return e},this.updateCutPlanes=function(){var e=this.getAllCutPlanes();this.setCutPlanes(e)},this.setCutPlaneSet=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0;if(ft[e]=t?t.slice():void 0,r)this.updateCutPlanes();else{var n=this.getAllCutPlanes();this.setCutPlanesInScene(n)}},this.setCutPlaneSetFor2DRendering=function(e){pt=e,this.updateCutPlanes()},this.getCutPlaneSet=function(e){return ft[e]||[]},this.getCutPlaneSets=function(){var e=[];for(var t in ft){var r=ft[t];r&&r.length&&e.push(t)}return e},this.getCutPlanes=function(){return Me.getCutPlanes()},this.setCutPlanesInScene=function(e){Ce.toggleTwoSided(Me.setCutPlanes(e)),this.sceneUpdated()},this.setCutPlanes=function(e){this.setCutPlanesInScene(e),this.api.dispatchEvent({type:I.CUTPLANES_CHANGE_EVENT,planes:e})},this.fireRenderOptionChanged=function(){Me.toggleMRTSetting(Ce.mrtFlags()),this.api.dispatchEvent({type:I.RENDER_OPTION_CHANGED_EVENT})},this.viewportToRay=function(e,t){var r=this.camera;e.z=-1;var n=new L.Vector3(e.x,e.y,1);return e=e.unproject(r),n=n.unproject(r),n.sub(e).normalize(),t||(t=new L.Ray),t.set(r.isPerspective?r.position:e,n),t},this.rayIntersect=function(e,t,r,n,i){for(var o=Ie.rayIntersect(e.origin,e.direction,t,r,n,i),s=[this.scene,this.sceneAfter],a=0;a<s.length;a++){var l=s[a];if(l.children.length){var c=new L.Raycaster(e.origin,e.direction,this.camera.near,this.camera.far);me(xt,l),c.linePrecision=Math.min(1,.5*xt.size().length()*.001);var u=i||[];j.VBIntersector.intersectObject(l,c,u,!0),u.length&&(!o||u[0].distance<o.distance)&&(o=u[0])}}return o?(void 0===o.dbId&&void 0!==o.fragId&&(o.dbId=o.model.getFragmentList().getDbIds(o.fragId),o.model.getData().instanceTree||(o.dbId=o.fragId)),o.intersectPoint=o.point,o):null},this.castRayViewport=function(){var e;return function(t,r,n,i,o){return e=e||new L.Ray,Ie?(this.viewportToRay(t,e),this.rayIntersect(e,r,n,i,o)):{}}}(),this.getCanvasBoundingClientRect=function(){return this.canvasBoundingclientRectDirty&&(this.canvasBoundingclientRectDirty=!1,this.boundingClientRect=this.canvas.getBoundingClientRect()),this.boundingClientRect},this.clientToViewport=function(e,t){var r=this.getCanvasBoundingClientRect();return new L.Vector3((e+.5)/r.width*2-1,2*-((t+.5)/r.height)+1,1)},this.viewportToClient=function(e,t){var r=this.getCanvasBoundingClientRect();return new L.Vector3(.5*(e+1)*r.width-.5,(t-1)*-.5*r.height-.5,0)},this.castRay=function(e,t,r){return this.castRayViewport(this.clientToViewport(e,t),r)},this.intersectGroundViewport=function(e){var t="z";this.is2d||(t=Ue);var r=this.model&&this.model.getBoundingBox();return N.SceneMath.intersectGroundViewport(e,this.camera,t,r)},this.intersectGround=function(e,t){return this.intersectGroundViewport(this.clientToViewport(e,t))},this._2dHitTestViewport=function(e,t,r){var n=[0,0],i=Ce.idAtPixels(e.x,e.y,t,n);if(r>i)return null;var o=Ie.findModel(n[1])||this.model;if(!o)return null;var s=this.intersectGroundViewport(e),a=o.getData().fragments,l=a?a.dbId2fragId[i]:-1;return{intersectPoint:s,dbId:o.remapDbId(i),fragId:l,model:o}},this.hitTestViewport=function(e,t,r,n,i){var s;if(be.is2d){var a=Object(o.isMobileDevice)()?45:5;s=this._2dHitTestViewport(e,a,1)}else s=this.castRayViewport(e,t,r,n,i);return s},this.hitTest=function(e,t,r,n){return be.hitTestViewport(this.clientToViewport(e,t),r,n)},this.snappingHitTestViewport=function(e,t){var r;if(this.model&&this.model.getData().isLeaflet){var n=this.intersectGroundViewport(e);r={intersectPoint:n}}else if(be.is2d){var i=Object(o.isMobileDevice)()?45:17;r=this._2dHitTestViewport(e,i,0)}else{var s=Ce.idAtPixel(e.x,e.y);r=this.castRayViewport(e,t,s>0?[s]:null)}return r},this.snappingHitTest=function(e,t,r){return this.snappingHitTestViewport(this.clientToViewport(e,t),r)},this.clearHighlight=function(){Ce.rolloverObjectId(-1),this.invalidate(!1,!1,!0)},this.rollOverIdChanged=function(){this.api.fireEvent({type:I.OBJECT_UNDER_MOUSE_CHANGED,dbId:Ce.getRollOverDbId(),modelId:Ce.getRollOverModelId()}),this.invalidate(!1,!1,!0)},this.rolloverObjectViewport=function(e){if(!this.model||!(this.model.getData().isLeaflet||this.model.getData().isPdf&&this.api.prefs.get(V.Prefs2D.DISABLE_PDF_HIGHLIGHT))){var t=Ce.idAtPixel(e.x,e.y);return this.selector&&this.selector.isNodeSelectionLocked(t,this.model)?void this.clearHighlight():void(Ce.rolloverObjectViewport(e.x,e.y)&&this.rollOverIdChanged())}},this.rolloverObject=function(e,t){this.selector.highlightPaused||this.selector.highlightDisabled||this.rolloverObjectViewport(this.clientToViewport(e,t))},this.pauseHighlight=function(e){this.selector.highlightPaused=e,e&&this.clearHighlight()},this.disableHighlight=function(e){this.selector.highlightDisabled=e,e&&this.clearHighlight()},this.disableSelection=function(e){this.selector.selectionDisabled=e},this.cancelLeafletScreenshot=function(){be.api.dispatchEvent({type:I.CANCEL_LEAFLET_SCREENSHOT})},this.getScreenShotProgressive=function(e,t,r,n){return s.ScreenShot.getScreenShot(e,t,r,n,this)},this.modelQueue=function(){return Ie},this.glrenderer=function(){return Te},this.renderer=function(){return Ce},this.setGeomCache=function(e){lt=e,lt.addViewer(be.api)},this.geomCache=function(){return lt||this.setGeomCache(new m.OtgResourceCache),lt},this.shadowMaps=function(){return je},this.worldUp=function(){return xe},this.worldUpName=function(){return Ue},this.setUserRenderContext=function(e,t){Ce=e?e:new c.RenderContext,t||(Ce.init(Te,this.canvas.clientWidth,this.canvas.clientHeight),Ce.setClearColors(this.clearColorTop,this.clearColorBottom)),this.invalidate(!0),this.sceneUpdated(!1)},this.setUserGroundShadow=function(e){var t=Le;return Le=e,t},this.invalidate=function(e,t,r){He=e||He,We=t||We,qe=r||qe},this.isOverlayDirty=function(){return qe},this.clearOverlayDirtyFlag=function(){qe=!1},this.sceneUpdated=function(e,t){this.invalidate(!t,!1,!t),Ie&&e&&(Ie.invalidateVisibleBounds(),this.zoomBoundsChanged=!0),Ye=!0,q()},this.requestSilentRender=function(){Ke=Qe=!0},this.requestDeferredSilentRender=function(){Ke=!0},this.currentLightPreset=function(){return Ne},this.saveLightPreset=function(){Fe=Ne},this.matman=function(){return Me},this.fps=function(){return 1e3/$e},this.setFPSTargets=function(e,t,r){Re=1e3/r,ke=1,Oe=1e3/t,this.targetFrameBudget=Object(o.isMobileDevice)()?Oe/4:Oe},this.track=function(e){g.logger.track(e)},this.worldToClient=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.camera,r=new L.Vector4(e.x,e.y,e.z,1);return r.applyMatrix4(t.matrixWorldInverse),r.applyMatrix4(t.projectionMatrix),r.w>0&&(r.x/=r.w,r.y/=r.w,r.z/=r.w),this.viewportToClient(r.x,r.y)},this.clientToWorld=function(e,t,r,n){var i=null,o=this.model,s=o.getData();if(o.is2d()){var a=this.intersectGround(e,t);if(a){a.z=0;var l=s.bbox;(n||s.hidePaper||l.containsPoint(a))&&(i={point:a,model:o})}}else i=this.hitTest(e,t,r),i&&(i.point=i.intersectPoint);return i},this.set2dSelectionColor=function(e,t){this.matman().set2dSelectionColor(e,t),this.invalidate(!1,!1,!0)},this.setSelectionColor=function(e,t){t=t||O.SelectionType.MIXED;var r=new L.Color(e);r.multiplyScalar(.5);var n=function i(t){t.color.set(e),t.emissive.set(r),t.variants&&t.variants.forEach(i)};switch(t){default:case O.SelectionType.MIXED:n(this.selectionMaterialBase),n(this.selectionMaterialTop),Ce.setSelectionColor(e),n(this.highlightMaterial),this.invalidate(!0);break;case O.SelectionType.REGULAR:n(this.highlightMaterial),this.invalidate(!0);break;case O.SelectionType.OVERLAYED:n(this.selectionMaterialBase),n(this.selectionMaterialTop),Ce.setSelectionColor(e),this.invalidate(!1,!1,!0)}},this.updateViewportId=function(e){Me.updateViewportId(e),this.invalidate(!0)},this.findModel=function(e,t){var r;r="number"==typeof e?function(t){return t.id==e}:e instanceof k.BubbleNode?function(t){return t.getDocumentNode()==e}:e;var n=Ie.getModels().find(r);return t&&!n&&(n=Ie.getHiddenModels().find(r)),n},this.getFrameRate=function(){return this.frameDisplayRate},this.setFrameRate=function(e){this.frameDisplayRate=1>e?1:e},this.setShadowLightDirection=function(e){ze.copy(e),q(),this.invalidate(!0,!1,!1),G()},this.getShadowLightDirection=function(e){var t=e?e:new L.Vector3;return t.copy(ze),t},this.toggleShadows=function(e){!!je!=!!e&&(e?je=new b.ShadowMaps(Te):(je.cleanup(Me),je=null),G(),this.invalidate(!0,!0,!1))},this.showTransparencyWhenMoving=function(e){Ie.enableNonResumableFrames=e},this.fitToView=function(e,t){if(t=!!t,0===e.length){var r=Ie.getModels();e=r.map(function(e){return{model:e,selection:[]}})}for(var n=0,i=0,o=0;o<e.length;++o){var s=e[o].model;if(!s)return!1;s.is2d()?n++:i++}var a=!1;return(a=n===e.length?this._fitToView2d(e,t):this._fitToView3d(e,t))?(1===Ie.getModels().length&&this.api.dispatchEvent({type:I.FIT_TO_VIEW_EVENT,nodeIdArray:e[0].selection,immediate:t,model:e[0].model}),this.api.dispatchEvent({type:I.AGGREGATE_FIT_TO_VIEW_EVENT,selection:e,immediate:t}),!0):!1},this._fitToView2d=function(e,t){e.length>1&&g.logger.warn("fitToView() doesn't support multiple 2D models. Using the first one...");var r=e[0].model,n=e[0].selection,i=new L.Box3,o=new P.BoundsCallback(i);if(n&&0!==n.length)this.computeSelectionBounds(n,r,o);else if(this.api.anyLayerHidden())for(var s=r.getData().fragments,a=this.getVisibleLayerIndices(),l=0;l<s.length;l++)ve(r,l,a,o);else i=this.getFitBounds(!0);return i.empty()?!1:(this.api.navigation.fitBounds(t,i),!0)},this.computeSelectionBounds=function(e,t,r){if(!r)var n=new L.Box3,r=new P.BoundsCallback(n);for(var i=t.getData().fragments.dbId2fragId,o=0;o<e.length;o++){var s=t.reverseMapDbId(e[o]),a=i[s];if(Array.isArray(a))for(var l=0;l<a.length;l++)ye(t,a[l],s,r);else"number"==typeof a&&ye(t,a,s,r)}return r.bounds},this.get3DBounds=function(e){for(var t=!1,r=0;r<e.length;++r)if(e[r].selection.length>0){t=!0;break}var n=new L.Box3,i=new L.Box3;if(t)for(var o=0;o<e.length;++o){var s=e[o].selection;if(0!==s.length){var a=e[o].model,l=a.getInstanceTree(),c=a.getFragmentList();if(l)for(var u=0;u<s.length;++u){var d=parseInt(s[u]);l.enumNodeFragments(d,function(e){c.getWorldBounds(e,i),n.union(i)},!0)}}}else n.union(this.getVisibleBounds(!1,!1));return n},this.setModelTransform=function(e,t){if(e.setModelTransform(t),this.sceneUpdated(),e.isConsolidated()){for(var r in be.selectionMeshes){var n=be.selectionMeshes[r];n.model===e&&(n.needsUpdate=!0)}this.api.fireEvent({type:I.MODEL_TRANSFORM_CHANGED_EVENT,model:e,matrix:t})}},this._fitToView3d=function(e,t){var r=this.get3DBounds(e);return r.empty()?!1:(this.api.navigation.fitBounds(t,r),!0)},this.onWebGLcontextLost=function(e){this.api.fireEvent({type:I.WEBGL_CONTEXT_LOST_EVENT})},this.modelVisible=function(e){var t=Ie.findModel(e);return!!t},this.handleInitialVisibility=function(e){function t(t){var n=e.getFragmentList();if(!n.areAllVisible()){var i=[];t&&(t.enumNodeChildren(e.getRootId(),function(e){var r=t.enumNodeFragments(e,function(e){return n.isFragVisible(e)},!0);r||t.isNodeHidden(e)||t.isNodeOff(e)||i.push(e)},!0),i.length&&r.hide(i,e))}}var r=this.api;e.getObjectTree(t)},this._signalNoMeshes=function(){Ie.isEmpty()&&(this._geometryAvailable=0)},this._signalMeshAvailable=function(){0===this._geometryAvailable&&(this._geometryAvailable=1,this.api.fireEvent({type:I.RENDER_FIRST_PIXEL}))},this.hasModels=function(){return!Ie.isEmpty()},this.onLoadingAnimationChanged=function(e){Te.setLoadingAnimationDuration(e?this.defaultLoadingAnimationDuration:-1),this.invalidate(!1,!0,!1)},this.isLoadingAnimationEnabled=function(){return this.api.prefs.get(V.Prefs2D.LOADING_ANIMATION)&&(!this.model||this.model.is2d())}}r.r(t),r.d(t,"InitParametersSetting",function(){return G}),r.d(t,"createRenderer",function(){return n}),r.d(t,"Viewer3DImpl",function(){return i});var o=r("./src/compat.js"),s=r("./src/application/ScreenShot.js"),a=r("./src/application/ProgressState.js"),l=r("./src/wgs/scene/RenderScene.js"),c=r("./src/wgs/render/RenderContext.js"),u=r("./src/wgs/render/MaterialManager.js"),d=r("./src/tools/Selector.js"),h=r("./src/tools/VisibilityManager.js"),f=r("./src/application/LightPresets.js"),p=r("./src/wgs/render/GroundShadow.js"),m=r("./src/file-loaders/main/OtgResourceCache.js"),g=r("./src/logger/Logger.js"),v=r("./src/file-loaders/main/TextureLoader.js"),y=r("./src/wgs/render/WebGLRenderer.js"),_=r("./src/wgs/scene/RenderFlags.js"),b=r("./src/wgs/render/ShadowMap.js"),x=r("./src/wgs/render/GroundFlags.js"),w=r("./src/wgs/scene/ResetFlags.js"),E=r("./src/wgs/render/GroundReflection.js"),S=r("./src/application/ModelLayers.js"),A=r("./src/wgs/scene/FragmentList.js"),M=r("./src/wgs/render/DecodeEnvMap.js"),T=r("./src/globals.js"),C=r("./src/wgs/render/SAOShader.js"),j=r("./src/wgs/scene/VBIntersector.js"),P=r("./src/wgs/scene/VertexBufferReader.js"),L=r("./thirdparty/three.js/three.js"),D=(r.n(L),r("./src/tools/UnifiedCamera.js")),I=r("./src/application/EventTypes.js"),R=(r.n(I),r("./src/tools/Navigation.js")),O=r("./src/tools/SelectionType.js"),k=r("./src/application/bubble.js"),N=r("./src/wgs/scene/SceneMath.js"),F=r("./src/application/GlobalManagerMixin.js"),V=r("./src/application/PreferenceNames.js"),U=null,B=Object(o.getGlobal)().ENABLE_DEBUG,z=Object(o.getGlobal)().ENABLE_DEBUG_RCS,G={canvas:null,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!1,depth:!1};i.prototype.constructor=i,F.GlobalManagerMixin.call(i.prototype)},"./src/application/ViewerState.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){function t(t,r){var n=!!e.getExtension("Autodesk.AEC.LevelsExtension");if(n&&void 0===t.floorGuid){var i=r.length;if(3===i||8===i){var o=r[i-2],s=r[i-1];0===o.x&&0===o.y&&-1===o.z&&0===s.x&&0===s.y&&1===s.z&&r.splice(-2,2)}}}var r=!0;this.getVisibleModel=function(t){for(var r=e.getVisibleModels(),n=0;n<r.length;++n){var i=r[n];if(this.getSeedUrn(i)===t)return i}},this.createObjectSets=function(t){var r=t.objectSet;Array.isArray(r)||(t.objectSet=r=[]);for(var n=e.getVisibleModels(),i=0;i<n.length;i++){var o=n[i],s=this.getSeedUrn(o),a=this.getSelectedNodes(o);r[i]={id:a,idType:"lmv"},n.length>1&&(r[i].seedUrn=s),o.is2d()?(r[i].isolated=this.getVisibleLayers2d(o),r[i].allLayers=this.areAllLayersVisible(o),r[i].hidden=[]):(r[i].isolated=e.getIsolatedNodes(o),r[i].hidden=e.getHiddenNodes(o),r[i].explodeScale=e.getExplodeScale())}},this.getState=function(t){var n=e.navigation,i={};i.seedURN=this.getSeedUrn(),this.createObjectSets(i);var o=i.viewport;o||(o=i.viewport={});var s=n.getCamera().isPerspective;o.name="",o.eye=n.getPosition().toArray(),o.target=n.getTarget().toArray(),o.up=n.getCameraUpVector().toArray(),o.worldUpVector=n.getWorldUpVector().toArray(),o.pivotPoint=n.getPivotPoint().toArray(),o.distanceToOrbit=n.getPivotPlaneDistance(),o.aspectRatio=this.getAspectRatio(),o.projection=s?"perspective":"orthographic",o.isOrthographic=!s,s?o.fieldOfView=n.getVerticalFov():o.orthographicHeight=this.getOrthographicHeight();var a=i.renderOptions;if(a||(a=i.renderOptions={}),a.environment=this.getEnvironmentName(),a.ambientOcclusion={enabled:e.impl.renderer().getAOEnabled(),radius:e.impl.renderer().getAORadius(),intensity:e.impl.renderer().getAOIntensity()},a.toneMap={method:e.impl.renderer().getToneMapMethod(),exposure:e.impl.renderer().getExposureBias(),lightMultiplier:this.getToneMapIntensity()},a.appearance={ghostHidden:e.impl.showGhosting,ambientShadow:e.prefs.ambientShadows,antiAliasing:e.impl.renderer().settings.antialias,progressiveDisplay:e.prefs.progressiveRendering,swapBlackAndWhite:e.prefs.swapBlackAndWhite,displayLines:e.prefs.lineRendering,displayPoints:e.prefs.pointRendering},e.model&&!e.model.is2d())for(var l=i.cutplanes=[],c=e.impl.getCutPlaneSet("__set_view"),u=0;u<c.length;u++)l.push(c[u].toArray());for(var d in e.loadedExtensions){var h=e.loadedExtensions[d];h.getState&&h.getState(i)}return t&&t!==r&&this.applyFilter(i,t),i},this.restoreObjectSet=function(t){var r=t.objectSet;if(Array.isArray(r)&&0!==r.length){for(var n=[],i=[],o=[],s=e.model,a=0;a<r.length;++a){var l=r[a];if("lmv"===l.idType){var c=l.seedUrn;if(!c||(s=this.getVisibleModel(c))){var u=l.id;if(u&&(u=this.toIntArray(u),o.push({model:s,ids:u})),s.is2d()){var d=l.isolated;if(Array.isArray(d)&&d.length>0){e.setLayerVisible(null,!1);for(var h=0;h<d.length;++h)d[h]=parseInt(d[h]);e.impl.setLayerVisible(d,!0)}else l.allLayers||e.setLayerVisible(null,!1)}else{var f=l.isolated||[],p=l.hidden||[];f=this.toIntArray(f),n.push({model:s,ids:f}),0===f.length&&p.length>0&&(p=this.toIntArray(p),i.push({model:s,ids:p}))}if("explodeScale"in l){var m=parseFloat(l.explodeScale);e.explode&&e.explode(m)}}}}o.length>0&&e.impl.selector.setAggregateSelection(o),n.length>0&&e.impl.visibilityManager.aggregateIsolate(n,{hideLoadedModels:!1}),i.length>0&&e.impl.visibilityManager.aggregateHide(i)}},this.restoreState=function(n,i,o){if(!n)return s.logger.warn("restoreState has no viewer state to restore from."),!1;if(!e||!e.model)return s.logger.warn("restoreState has no viewer or model to restore."),!1;i&&i!==r&&(n=JSON.parse(JSON.stringify(n)),this.applyFilter(n,i));var a=e.navigation,l=e.model.is2d(),c=!l;this.restoreObjectSet(n);var u=n.viewport;if(u){var d=this.getVector3FromArray(u.eye,a.getPosition()),h=this.getVector3FromArray(u.up,a.getCameraUpVector()),f=this.getVector3FromArray(u.target,a.getTarget()),p="fieldOfView"in u?parseFloat(u.fieldOfView):a.getVerticalFov(),m=this.getVector3FromArray(u.worldUpVector,null);if(!m){var g=e.model?e.model.getUpVector():null;m=g?(new THREE.Vector3).fromArray(g):new THREE.Vector3(0,1,0)}var v=this.getVector3FromArray(u.pivotPoint,a.getPivotPoint()),y=a.getCamera().isPerspective;"isOrthographic"in u&&(y=!u.isOrthographic);var _=this.getOrthographicHeight();"orthographicHeight"in u&&(_=Number(u.orthographicHeight));var b={position:d,target:f,up:h,worldup:m,aspect:e.impl.camera.aspect,fov:p,orthoScale:_,isPerspective:y,pivot:v};this.restoreCameraState(b,o)}var x=n.renderOptions;if(x){var w=e.impl.renderer(),E=e.prefs,S=E.ambientShadows,A=E.antialiasing,M=x.ambientOcclusion;if(M){"enabled"in M&&(S=M.enabled);var T="radius"in M?M.radius:null,C="intensity"in M?M.intensity:null;null!==T&&null!==C&&(T!==w.getAORadius()||C!==w.getAOIntensity())&&(w.setAOOptions(T,C),w.composeFinalFrame())}if("environment"in x){var j=this.getLightPresetIndex(x.environment);-1!==j&&j!==E.get("lightPreset")&&c&&e.setLightPreset(j)}var P=x.toneMap;if(P){var L=!1,D="exposure"in P?P.exposure:null,I="lightMultiplier"in P?P.lightMultiplier:null;null!==D&&D!==w.getExposureBias()&&(w.setTonemapExposureBias(D),L=!0),null!==I&&e.impl.dir_light1&&I!==this.getToneMapIntensity()&&(e.impl.dir_light1.intensity=Math.pow(2,I),L=!0),L&&e.impl.invalidate(!0)}var R=x.appearance;R&&("antiAliasing"in R&&(A=R.antiAliasing),"progressiveDisplay"in R&&R.progressiveDisplay!==E.get("progressiveRendering")&&e.setProgressiveRendering(R.progressiveDisplay),"swapBlackAndWhite"in R&&R.swapBlackAndWhite!==E.get("swapBlackAndWhite")&&e.setSwapBlackAndWhite(R.swapBlackAndWhite),"ghostHidden"in R&&R.ghostHidden!==E.get("ghosting")&&c&&e.setGhosting(R.ghostHidden),"displayLines"in R&&R.displayLines!==E.get("lineRendering")&&e.hideLines(!R.displayLines),"displayPoints"in R&&R.displayPoints!==E.get("pointRendering")&&e.hidePoints(!R.displayPoints)),c&&S!==E.ambientShadows&&A!==E.antialiasing&&e.setQualityLevel(S,A)}if(Array.isArray(n.cutplanes)&&e.model&&c){for(var O=[],k=0;k<n.cutplanes.length;k++){var N=n.cutplanes[k];Array.isArray(N)&&N.length>=4&&O.push(new THREE.Vector4(N[0],N[1],N[2],N[3]))}t(n,O),e.impl.setCutPlaneSet("__set_view",O)}for(var F in e.loadedExtensions){var V=e.loadedExtensions[F];V.restoreState&&V.restoreState(n,o)}return!0},this.getEnvironmentName=function(){var t=a.LightPresets[e.impl.currentLightPreset()];return t?t.name:"none"},this.restoreCameraState=function(t,r){e.impl.adjustOrthoCamera(t);var n=e.navigation;r?(t.isPerspective?n.toPerspective():n.toOrthographic(),n.setCameraUpVector(t.up),n.setWorldUpVector(t.worldup),n.setView(t.position,t.target),n.setPivotPoint(t.pivot),n.setVerticalFov(t.fov,!1),e.impl.syncCamera(!0)):(e.impl.camera.isPerspective=t.isPerspective,n.setRequestTransitionWithUp(!0,t.position,t.target,t.fov,t.up,t.worldup,t.pivot))},this.areEqual=function(e,t,r){function i(e,t){if(e=e||[],t=t||[],e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function o(e,t,r){return e=e||[],t=t||[],e.length!==t.length?!1:0===e.length?!1:s(e[0],t[0],r)||s(e[1],t[1],r)||s(e[2],t[2],r)}function s(e,t,r){var i=e?parseFloat(e):null,o=e?parseFloat(t):null,s=n(i),a=n(o);return"number"===s&&"number"===a?Math.abs(e-t)<r:(e=e?e:null,t=t?t:null,e===t)}var a=e,l=t,c=1e-9;if(r&&r!==!0&&(a=this.applyFilter(a,r),l=this.applyFilter(l,r)),a.seedURN!==l.seedURN)return!1;var u=a.objectSet||[],d=l.objectSet||[];if(u.length!==d.length)return!1;var h=u[0]||{},f=d[0]||{};if(!(h.idType===f.idType&&s(h.explodeScale,f.explodeScale,c)&&i(h.id,f.id)&&i(h.isolated,f.isolated)&&i(h.hidden,f.hidden)))return!1;var p=a.viewport||{},m=l.viewport||{};return p.name===m.name&&p.projection===m.projection&&p.isOrthographic===m.isOrthographic&&s(p.distanceToOrbit,m.distanceToOrbit,c)&&s(p.fieldOfView,m.fieldOfView,c)&&s(p.orthographicHeight,m.orthographicHeight,c)&&o(p.eye,m.eye,c)&&o(p.target,m.target,c)&&o(p.up,m.up,c)&&o(p.worldUpVector,m.worldUpVector,c)&&o(p.pivotPoint,m.pivotPoint,c)?!0:!1;
},this.toIntArray=function(e){var t=[];if(Array.isArray(e))for(var r=0,n=e.length;n>r;++r)t.push(parseInt(e[r]));return t},this.getVector3FromArray=function(e,t){return e instanceof Array&&e.length>2?(e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),e[2]=parseFloat(e[2]),(new THREE.Vector3).fromArray(e)):t},this.getSelectedNodes=function(t){return t=t||e.model,t.selector?t.selector.getSelection():[]},this.getVisibleLayers2d=function(t){return t&&t!==e.model?(s.logger.warn("[getVisibleLayers2d] multiple models not yet supported."),[]):e.impl.getVisibleLayerIndices()},this.areAllLayersVisible=function(t){return t&&t!==e.model?(s.logger.warn("[areAllLayersVisible] multiple models not yet supported."),!0):e.impl.layers.allLayersVisible()},this.getAspectRatio=function(){var t=e.navigation.getScreenViewport(),r=t.width/t.height;return r},this.getOrthographicHeight=function(){var t=e.navigation.getCamera();return t.isPerspective?0:Math.abs(2*t.orthographicCamera.top)},this.getSeedUrn=function(t){return t=t||e.model,t&&t.loader?t.loader.svfUrn||"":""},this.getToneMapIntensity=function(){var t=0;return e.impl.dir_light1&&(t=0!=e.impl.dir_light1.intensity?Math.log(e.impl.dir_light1.intensity)/Math.log(2):-1e-20),t},this.getLightPresetIndex=function(e){for(var t=0;t<a.LightPresets.length;t++)if(a.LightPresets[t].name===e)return t;return-1},this.applyFilter=function(e,t){if(t!==!0)for(var r in e)if(e.hasOwnProperty(r)){var n=t[r];void 0===n?delete e[r]:"boolean"==typeof n?n===!1&&delete e[r]:n instanceof Object?e[r]instanceof Object?this.applyFilter(e[r],t[r]):s.logger.warn("[applyFilter] A - Invalid filter Object for key ["+r+"]"):s.logger.warn("[applyFilter] B - Invalid filter value for key ["+r+"]")}},this.normalizeCoordinates=function(t){var r=t.viewport;if(r){if(r.normalized)return void s.logger.warn("invalid normalization of state.viewport. Ignoring command.");r.normalized=!0;var n=l.SceneMath.getNormalizingMatrix(e.model);if(o(r,n),"orthographicHeight"in r){var i=e.model.myData.bbox,a=i.max.y-i.min.y,c=r.orthographicHeight/a;r.orthographicHeight=c}}},this.denormalizeCoordinates=function(t){var r=t.viewport;if(r){if(!r.normalized)return void s.logger.warn("invalid denormalization of state.viewport. Ignoring command.");delete r.normalized;var n=l.SceneMath.getNormalizingMatrix(e.model),i=(new THREE.Matrix4).getInverse(n);if(o(r,i),"orthographicHeight"in r){var a=e.model.myData.bbox,c=a.max.y-a.min.y,u=r.orthographicHeight*c;r.orthographicHeight=u}}}}function o(e,t){var r=new THREE.Vector3(e.eye[0],e.eye[1],e.eye[2]),n=new THREE.Vector3(e.pivotPoint[0],e.pivotPoint[1],e.pivotPoint[2]),i=new THREE.Vector3(e.target[0],e.target[1],e.target[2]);r.applyMatrix4(t),n.applyMatrix4(t),i.applyMatrix4(t),e.eye[0]=r.x,e.eye[1]=r.y,e.eye[2]=r.z,e.pivotPoint[0]=n.x,e.pivotPoint[1]=n.y,e.pivotPoint[2]=n.z,e.target[0]=i.x,e.target[1]=i.y,e.target[2]=i.z}r.r(t),r.d(t,"ViewerState",function(){return i});var s=r("./src/logger/Logger.js"),a=r("./src/application/LightPresets.js"),l=r("./src/wgs/scene/SceneMath.js");i.prototype.constructor=i},"./src/application/bubble.js":function(e,t,r){"use strict";function n(e){return"application/autodesk-db"==e.mime&&e.urn?0===e.urn.indexOf("urn:adsk.objects:os.object")?e.urn.substr(0,e.urn.lastIndexOf("%2F")+3):e.urn.substr(0,e.urn.lastIndexOf("/")+1):null}r.r(t),r.d(t,"BubbleNode",function(){return o});var i=1,o=function s(e,t){if(this.parent=t,this.id=i++,this.data=e,this.isLeaf="geometry"===e.type&&("3d"===e.role||"2d"===e.role||"lod"===e.role),Array.isArray(e.children)||Array.isArray(e.derivatives)){this.children=[];for(var r=e.children||e.derivatives,o=r.length,a=0;o>a;a++)this.children[a]=new s(r[a],this);this.children.length>1&&this.children.sort(function(e,t){return e.data.hasOwnProperty("order")&&t.data.hasOwnProperty("order")?e.data.order-t.data.order:0});for(var a=0;o>a;a++){var l=n(r[a]);l&&(this.sharedPropertyDbPath=l),"lod"===r[a].role&&(this.lodNode=this.children[a])}}};o.prototype.constructor=o,o.prototype.setDocument=function(e){this.lmvDocument=e},o.prototype.getDocument=function(){for(var e=this;e.parent;)e=e.parent;return e.lmvDocument},o.prototype.isOtg=function(){return!!this._getOtgManifest()},o.prototype._getOtgManifest=function(){if("undefined"!=typeof DISABLE_OTG&&DISABLE_OTG)return null;var e=this.findViewableParent();if(!e)return null;var t=e.data.otg_manifest;return t},o.prototype.getOtgGraphicsNode=function(){if(this.isViewPreset())return this.findParentGeom2Dor3D().getOtgGraphicsNode();var e=this._getOtgManifest();return e&&e.views&&e.views[this.guid()]},o.prototype.getPropertyDbManifest=function(){var e,t=this._getOtgManifest();if(t&&t.pdb_manifest){var r=t.pdb_manifest;e={propertydb:{},isOtg:!0};for(var n=0;n<r.assets.length;n++){var i,o=r.assets[n];i=o.isShared?t.paths.shared_root+r.pdb_shared_rel_path:t.paths.version_root+r.pdb_version_rel_path,e.propertydb[o.tag]=[{path:i+o.uri,isShared:o.isShared}]}var s=this.getOtgGraphicsNode();s||(e.needsDbIdRemap=!0)}else{var i=this.findPropertyDbPath();null===i&&(i=""),0===i.indexOf("$file$")&&(i="");var a=this.getDocument();a&&0===i.indexOf("urn")&&(i=a.getFullPath(i)),e={propertydb:{attrs:[{path:i+"objects_attrs.json.gz"}],values:[{path:i+"objects_vals.json.gz"}],avs:[{path:i+"objects_avs.json.gz"}],offsets:[{path:i+"objects_offs.json.gz"}],ids:[{path:i+"objects_ids.json.gz"}]}}}return e},o.prototype.getRootNode=function(){return this.parent?this.parent.getRootNode():this},o.prototype.isForgeManifest=function(){var e=this.getRootNode();return"manifest"===e.data.type},o.prototype.findPropertyDbPath=function(){var e=this._getOtgManifest(),t=e&&e.pdb_manifest;if(t&&t.assets&&t.assets.length){var r=e.paths.version_root,n=e.pdb_manifest.pdb_version_rel_path;return r+n}return this.sharedPropertyDbPath?this.sharedPropertyDbPath:this.parent?this.parent.findPropertyDbPath():null},o.prototype._raw=function(){return this.data},o.prototype.name=function(){return this.data.name||""},o.prototype.guid=function(){return this.data.guid},o.prototype.type=function(){return this.data.type},o.prototype.extensions=function(){return this.data.extensions?Array.isArray(this.data.extensions)?this.data.extensions:[this.data.extensions]:void 0},o.prototype.urn=function(e){var t=this.data.urn;if(!e)return t;for(var r=this.parent;!t&&r;)t=r.data.urn,r=r.parent;return t},o.prototype.isGeomLeaf=function(){return this.isLeaf},o.prototype.isViewable=function(){return"viewable"===this.data.role||"svf"===this.data.outputType},o.prototype.getLodNode=function(){return this.lodNode},o.prototype.isGeometry=function(){return"geometry"===this.data.type},o.prototype.isViewPreset=function(){return"view"===this.data.type},o.prototype.is2D=function(){return"2d"===this.data.role},o.prototype.is3D=function(){return"3d"===this.data.role},o.prototype.is2DGeom=function(){return this.isGeometry()&&this.is2D()},o.prototype.is3DGeom=function(){return this.isGeometry()&&this.is3D()},o.prototype.useAsDefault=function(){return this.data.useAsDefault===!0},o.prototype.getDefaultGeometry=function(){for(var e=this.search({type:"geometry"}),t=0;t<e.length;++t)if(e[t].useAsDefault())return e[t];return e[0]},o.prototype.getPlacementTransform=function(){return null},o.prototype.getHash=function(){return null},o.prototype.getViewBox=function(){return this.data.viewbox},o.prototype.isMetadata=function(){if(this.data.role){if(-1!==this.data.role.indexOf("Autodesk.CloudPlatform.DesignDescription"))return!0;if("Autodesk.CloudPlatform.PropertyDatabase"===this.data.role)return!0}return!1},o.prototype.findViewableParent=function(){for(var e=null,t=this;t;)t.isViewable()&&(e=t),t=t.parent;if(!e&&!this.parent&&this.children)for(var r=0;r<this.children.length;r++){var n=this.children[r];if(n.isViewable()){e=n;break}}return e},o.prototype.findParentGeom2Dor3D=function(e){for(var t=this;t&&!t.is2DGeom()&&!t.is3DGeom();)t=t.parent;if(!t&&this.isViewPreset()){var r=this.findGeometryFromSiblings();t=r[0],e&&e.fallbackParent&&(t=e.fallbackParent)}return t},o.prototype.findGeometryFromSiblings=function(){var e=this.parent;if(!e)return[];for(var t=[],r=0,n=e.children.length;n>r;++r){var i=e.children[r];if(i!==this){var o;i.traverse(function(e){return e.isGeometry()&&(e.is2D()||e.is3D())?(o=e,!0):void 0}),o&&t.push(o)}}return t},o.prototype.findAllViewables=function(){var e=[],t=this.isForgeManifest();t&&(e=this.search({outputType:"svf"}));var r=this.search({role:"viewable"});return e.concat(r)},o.prototype.getViewableRootPath=function(e){var t=this.getOtgGraphicsNode();if(t&&!t.error){var r=this._getOtgManifest();return r.paths.version_root+t.urn}if(!this.isGeomLeaf())return this.urn();if(!e&&this.is2D()){var n=this.search({role:"leaflet"});if(n&&n.length)return n[0].urn()}var i=this.is2D()?"application/autodesk-f2d":"application/autodesk-svf",o=this.search({mime:i});if(o&&o.length){var s=o[0].urn();return s}return null},o.prototype.getNamedViews=function(){var e=this.search({type:"view"});return e=e.filter(function(e){return e.data.name&&Array.isArray(e.data.camera)?!0:!1})},o.prototype.findByGuid=function(e){var t=null;return this.traverse(function(r){return r.data.guid===e?(t=r,!0):void 0}),t},o.prototype.search=function(e){var t=[];return this.traverse(function(r){var n=!0;for(var i in e)if(!r.data.hasOwnProperty(i)||r.data[i]!==e[i]){n=!1;break}n&&t.push(r)}),t},o.prototype.traverse=function(e){if(e(this))return!0;if(this.children)for(var t=0;t<this.children.length;t++)if(this.children[t].traverse(e))return!0;return!1},o.prototype.getShallowCopySource=function(e){if(!this.isViewable())return null;e||(e=this.parent.urn());var t=this.urn();return t!==e&&t&&(e=t),e},o.prototype.getAecModelData=function(){var e=this.findViewableParent();return e?(!e.data.aec_model_data,e.data.aec_model_data):null},o.prototype.extractRefPointTransform=function(){var e=this.getAecModelData();return e&&e.refPointTransformation&&o.readMatrixFromArray12(e.refPointTransformation)},o.prototype.extractCamera=function(){if(this.data.camera)return o.readCameraFromArray(this.data.camera);var e=this.isGeometry()&&this.search({type:"view"})[0];return e?e.extractCamera():null},o.prototype.getLevel=function(){var e=this.data.levelNumber;return Array.isArray(e)?e[0]:e},o.prototype.getLevelName=function(){return this.data.levelName||this.getLevel()},o.prototype.isSheet=function(){for(var e=this.parent;e;){if("Sheets"===e.name())return!0;e=e.parent}return!1},o.prototype.isMasterView=function(){for(var e=o.MASTER_VIEW_NODE.name,t=this;t;){if(t.name()===e)return!0;t=t.parent}return!1},o.prototype.getModelName=function(){var e=this.getRootNode(),t=e.children[0];return t.name()},o.prototype.getModelKey=function(){var e="".concat(this.getViewableRootPath()).concat(this.originModel).concat(this.guid());return decodeURIComponent(e)},o.readCameraFromArray=function(e,t){if(!Array.isArray(e))return null;if(t&&!t.elements){var r=new THREE.Matrix4;r.setPosition(t),t=r}var n={position:new THREE.Vector3(e[0],e[1],e[2]),target:new THREE.Vector3(e[3],e[4],e[5]),up:new THREE.Vector3(e[6],e[7],e[8]),aspect:e[9],fov:THREE.Math.radToDeg(e[10]),orthoScale:e[11],isPerspective:!e[12]};return t&&(n.position.applyMatrix4(t),n.target.applyMatrix4(t),n.up.transformDirection(t)),0===e[10]&&1===e[11]&&1===e[12]&&(n.orthoScale=n.position.distanceTo(n.target)),n},o.readMatrixFromArray12=function(e){return(new THREE.Matrix4).fromArray([e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,e[9],e[10],e[11],1])},o.MODEL_NODE={role:"3d",type:"geometry"},o.GEOMETRY_SVF_NODE={role:"graphics",mime:"application/autodesk-svf"},o.SHEET_NODE={role:"2d",type:"geometry"},o.LEAFLET_NODE={role:"leaflet"},o.PDF_PAGE_NODE={role:"pdf-page"},o.IMAGE_NODE={role:"image"},o.GEOMETRY_F2D_NODE={role:"graphics",mime:"application/autodesk-f2d"},o.VIEWABLE_NODE={role:"viewable"},o.AEC_MODEL_DATA={role:"Autodesk.AEC.ModelData"},o.MASTER_VIEW_NODE={name:"08f99ae5-b8be-4f8d-881b-128675723c10"}},"./src/compat.js":function(e,t,r){"use strict";r.r(t),function(e){function n(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:e}function i(e,t){e.requestFullscreen?e.requestFullscreen(t):e.mozRequestFullScreen?e.mozRequestFullScreen(t):e.webkitRequestFullscreen?e.webkitRequestFullscreen(t):e.msRequestFullscreen&&e.msRequestFullscreen(t)}function o(e){s(e)&&(e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.msExitFullscreen&&e.msExitFullscreen())}function s(e){return"webkitIsFullScreen"in e?!!e.webkitIsFullScreen:"fullscreenElement"in e?!!e.fullscreenElement:"mozFullScreenElement"in e?!!e.mozFullScreenElement:"msFullscreenElement"in e?!!e.msFullscreenElement:!!e.querySelector(".viewer-fill-browser")}function a(e){return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement}function l(e){return e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen}function c(e){e=e||navigator.userAgent;var t=e.match(/Android\s([0-9\.]*)/);return t?t[1]:!1}function u(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)}function d(){return P}function h(){return L}function f(){return M?d()||h():!1}function p(){if(!M)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")}function m(){if(!M)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("firefox")}function g(){if(!M)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("chrome")}function v(){if(!M)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("mac os")}function y(){if(!M)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("win32")||-1!==e.indexOf("windows")}function _(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function b(e){var t=S.hasOwnProperty("pageXOffset")?S.pageXOffset:A.documentElement.scrollLeft,r=S.hasOwnProperty("pageYOffset")?S.pageYOffset:A.documentElement.scrollTop,n="undefined"==typeof e.pageX?e.changedTouches[0].pageX:e.pageX,i="undefined"==typeof e.pageY?e.changedTouches[0].pageY:e.pageY,o=A.elementFromPoint(n-t,i-r);return o&&"CANVAS"===o.nodeName?o.getAttribute(!0)?!0:(e.preventDefault(),!1):!0}function x(){f()&&p()&&(A.documentElement.addEventListener("touchstart",b,!0),A.documentElement.addEventListener("touchmove",b,!0),A.documentElement.addEventListener("touchcanceled",b,!0),A.documentElement.addEventListener("touchend",b,!0))}function w(){f()&&p()&&(A.documentElement.removeEventListener("touchstart",b,!0),A.documentElement.removeEventListener("touchmove",b,!0),A.documentElement.removeEventListener("touchcanceled",b,!0),A.documentElement.removeEventListener("touchend",b,!0))}function E(e){e.target.className&&(e.target.className.indexOf("fullscreen")>-1||e.target.className.indexOf("webvr")>-1)||(e.preventDefault(),e.stopPropagation(),e.target.click())}r.d(t,"getGlobal",function(){return n}),r.d(t,"isBrowser",function(){return M}),r.d(t,"isNodeJS",function(){return T}),r.d(t,"isIE11",function(){return C}),r.d(t,"isIE11Only",function(){return j}),r.d(t,"launchFullscreen",function(){return i}),r.d(t,"exitFullscreen",function(){return o}),r.d(t,"inFullscreen",function(){return s}),r.d(t,"fullscreenElement",function(){return a}),r.d(t,"isFullscreenAvailable",function(){return l}),r.d(t,"getAndroidVersion",function(){return c}),r.d(t,"isTouchDevice",function(){return u}),r.d(t,"isIOSDevice",function(){return d}),r.d(t,"isAndroidDevice",function(){return h}),r.d(t,"isMobileDevice",function(){return f}),r.d(t,"isSafari",function(){return p}),r.d(t,"isFirefox",function(){return m}),r.d(t,"isChrome",function(){return g}),r.d(t,"isMac",function(){return v}),r.d(t,"isWindows",function(){return y}),r.d(t,"ObjectAssign",function(){return _}),r.d(t,"disableDocumentTouchSafari",function(){return x}),r.d(t,"enableDocumentTouchSafari",function(){return w}),r.d(t,"touchStartToClick",function(){return E});var S=n(),A=S&&S.document,M="undefined"!=typeof navigator,T=function(){return!M},C=M&&!!navigator.userAgent.match(/Edge|Trident\/7\./),j=M&&!!navigator.userAgent.match(/Trident\/7\./);"undefined"!=typeof window&&C&&!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=A.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}e.prototype=S.CustomEvent.prototype,S.CustomEvent=e}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){if(!t||t>this.byteLength?t=this.byteLength:0>t&&(t=this.byteLength+t,0>t&&(t=0)),0>e&&(e=this.byteLength+e,0>e&&(e=0)),e>=t)return new ArrayBuffer;for(var r=t-e,n=new Uint8Array(this,e,r),i=new Uint8Array(r),o=0;r>o;o++)i[o]=n[o];return i.buffer}),function(){Math.log2=Math.log2||function(e){return Math.log(e)/Math.LN2}}(),"undefined"!=typeof window&&(S.BlobBuilder=S.BlobBuilder||S.WebKitBlobBuilder||S.MozBlobBuilder||S.MSBlobBuilder);var P=M&&(/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),L=M&&-1!==navigator.userAgent.toLowerCase().indexOf("android");!function(){var e=n();e.performance||(e.performance=Date)}(),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},String.prototype.repeat=String.prototype.repeat||function(e){if(1>e)return"";for(var t="",r=this.valueOf();e>1;)1&e&&(t+=r),e>>=1,r+=r;return t+r},Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{enumerable:!1,value:function(e,t,r){t=void 0===t?0:t,r=void 0===r?this.length:r;for(var n=t;r>n;++n)this[n]=e}}),Int32Array.prototype.lastIndexOf=Int32Array.prototype.lastIndexOf||function(e,t){return Array.prototype.lastIndexOf.call(this,e,t)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{enumerable:!1,value:function(e,t){for(var r=this.length,n=0;r>n;++n){var i=this[n];if(e.call(t,i,n,this))return i}}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r},writable:!0,configurable:!0}),"undefined"==typeof window||!C&&!d()||HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,r){var n=this;setTimeout(function(){for(var i=atob(n.toDataURL(t,r).split(",")[1]),o=i.length,s=new Uint8Array(o),a=0;o>a;a++)s[a]=i.charCodeAt(a);e(new Blob([s],{type:t||"image/png"}))})}}),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,t){if(t="undefined"!=typeof t?t:this.length,"[object Array]"===Object.prototype.toString.call(this))return _slice.call(this,e,t);var r,n,i=[],o=this.length,s=e||0;s=s>=0?s:Math.max(0,o+s);var a="number"==typeof t?Math.min(t,o):o;if(0>t&&(a=o+t),n=a-s,n>0)if(i=new Array(n),this.charAt)for(r=0;n>r;r++)i[r]=this.charAt(s+r);else for(r=0;n>r;r++)i[r]=this[s+r];return i})}.call(this,r("./node_modules/webpack/buildin/global.js"))},"./src/envinit.js":function(e,t,r){"use strict";function n(){return j}function i(e){var t;if(e&&e.env&&(t=e.env),t||(t=Object(g.getParameterByName)("env")),Object(y.setOfflineResourcePrefix)(e&&e.offlineResourcePrefix||""),Object(y.setOffline)(e&&"true"===e.offline),!t)switch(M.location.hostname){case"developer-dev.api.autodesk.com":t="AutodeskDevelopment";break;case"developer-stg.api.autodesk.com":t="AutodeskStaging";break;case"developer.api.autodesk.com":t="AutodeskProduction";break;case"localhost.autodesk.com":t="Local";break;case"":t="Local";break;case"127.0.0.1":t="Local";break;default:t="AutodeskProduction"}Object(y.setEnv)(t),"undefined"!=typeof window&&v.logger.info("Host name : "+window.location.hostname),v.logger.info("Environment initialized as : "+t)}function o(e){var t=["viewer3D.js","viewer3D.min.js","viewerCE.js","viewerCE.min.js"];e&&e.hasOwnProperty("libraryName")&&t.push(e.libraryName);for(var r,n,i=!1,o=0;o<t.length;o++){var s=Object(g.getScript)(t[o]);n=s?s.src:"";var a=n.indexOf(t[o]);if(a>=0){r=n.substr(0,a),(n.indexOf("&v=",a)>0||n.indexOf("?v=",a)>0)&&(i=!0);break}}if(A.LMV_RESOURCE_ROOT=r||A.LMV_RESOURCE_ROOT,i){for(var l=!1,c=["dev","stg","prod"],o=0;o<c.length;++o){var u=I[c[o]];if(-1!==A.LMV_RESOURCE_ROOT.indexOf(u)){l=!0;break}}l&&(A.LMV_RESOURCE_ROOT+=A.LMV_VIEWER_VERSION+"/")}}function s(e){var t=e.endpoint;if(!t){var r=k[Object(y.getEnv)()];t=r.ROOT}var n=e.api||t.ENDPOINT_API_DERIVATIVE_SERVICE_V2;return y.endpoint.setEndpointAndApi(t,n),Object(_.isNodeJS)()?void 0:(o(e),Promise.resolve())}function a(e,t,r){t=t||function(){},x.ViewingService.rawGet(y.endpoint.getApiEndpoint(),null,"/auth/settoken",t,r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0,postData:"access-token="+e})}function l(e){y.endpoint.HTTP_REQUEST_HEADERS.Authorization="Bearer "+e}function c(e,t,r){if(T.accessToken=e,y.endpoint.getUseCookie()){var n=function(t){v.logger.warn("Failed to set token in cookie. Will use header instead."),y.endpoint.setUseCookie(!1),l(e),r&&r(t)};a(e,t,n)}else l(e),t&&t()}function u(e){return new Promise(function(t){d(t,e)})}function d(e,t){function r(n,i){o=n;var s=!T.tokenRefreshInterval;s?c(o,e,e):c(o),"number"!=typeof i&&(i=3599);var a=i-5;0>=a&&(a=i),T.tokenRefreshInterval=setTimeout(function(){t.getAccessToken(r)},1e3*a)}var n=t?t.shouldInitializeAuth:void 0;if(void 0===n){var i=Object(g.getParameterByName)("auth");n="false"!==i.toLowerCase()}if("Local"==Object(y.getEnv)()||!n)return setTimeout(e,0),void y.endpoint.setUseCredentials("undefined"!=typeof t.useCredentials?t.useCredentials:!1);y.endpoint.setUseCredentials("undefined"!=typeof t.useCredentials?t.useCredentials:!0),y.endpoint.setUseCookie(t.useCookie),T.tokenRefreshInterval&&(clearTimeout(T.tokenRefreshInterval),T.tokenRefreshInterval=null);var o;t&&t.getAccessToken?(T.getAccessToken=t.getAccessToken,o=t.getAccessToken(r),"string"==typeof o&&o&&c(o,e)):t&&t.accessToken?(o=t.accessToken,c(o,e)):(o=Object(g.getParameterByName)("accessToken"),o||v.logger.error("No access token is provided, but authorization requested. This is a problem."),c(o,e))}function h(e){v.logger.initialize(e);var t=Object(g.getParameterByName)("logLevel");t&&v.logger.setLevel(parseInt(t))}function f(e){e&&"Local"===e.env||y.endpoint.getCdnRedirectUrl()&&x.ViewingService.rawGet(y.endpoint.getCdnRedirectUrl(),null,null,function(e){e&&e.length&&(y.endpoint.setCdnUrl(e),v.logger.info("CDN_ROOT is: "+e))},function(){},{withCredentials:!1,responseType:"text"})}function p(e,t){if(Object(_.isNodeJS)())return i(e),s(e),h(e),f(e),void d(t,e);e.webGLHelpLink&&(j=e.webGLHelpLink),i(e);var r=s(e);h(e),f(e),Object(w.initializeLocalization)(e),Object(_.disableDocumentTouchSafari)(),E.analytics.register(new S.Mixpanel(S.options)),Object(b.initWorkerScript)();var n=u(e);Promise.all([r,n]).then(t)}function m(){v.logger.shutdown(),Autodesk.Viewing.Private.shutdownPropWorker()}r.r(t),r.d(t,"token",function(){return C}),r.d(t,"getWebGLHelpLink",function(){return n}),r.d(t,"EnvironmentConfigurations",function(){return k}),r.d(t,"initializeEnvironmentVariable",function(){return i}),r.d(t,"initializeResourceRoot",function(){return o}),r.d(t,"initializeServiceEndPoints",function(){return s}),r.d(t,"refreshCookie",function(){return a}),r.d(t,"refreshRequestHeader",function(){return l}),r.d(t,"refreshToken",function(){return c}),r.d(t,"initializeAuth",function(){return d}),r.d(t,"initializeLogger",function(){return h}),r.d(t,"Initializer",function(){return p}),r.d(t,"shutdown",function(){return m});var g=r("./src/globals.js"),v=(r("./src/resource-loader.js"),r("./src/logger/Logger.js")),y=r("./src/file-loaders/net/endpoints.js"),_=r("./src/compat.js"),b=r("./src/file-loaders/main/WorkerCreator.js"),x=(r.n(b),r("./src/file-loaders/net/Xhr.js")),w=r("./src/globalization/i18init.js"),E=r("./src/analytics/index.js"),S=r("./src/analytics/providers/mixpanel.js"),A=Object(_.getGlobal)(),M=A,T={accessToken:null,getAccessToken:null,tokenRefreshInterval:null},C=T,j=null,P={local:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},dev:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},stg:{RTC:["https://rtc-stg.api.autodesk.com:443","https://lmv.autodesk.com:443"]},prod:{RTC:["https://rtc.api.autodesk.com:443","https://lmv.autodesk.com:443"]}},L="";if(Object(_.getGlobal)().location){var D=Object(_.getGlobal)().location;L=D.protocol+"//"+D.host}var I={local:"",dev:"https://developer-dev.api.autodesk.com",stg:"https://developer-stg.api.autodesk.com",prod:"https://developer.api.autodesk.com"},R={dev:"https://us.otgs-dev.autodesk.com",stg:"https://us.otgs-stg.autodesk.com",prod:"https://us.otgs.autodesk.com",stg_eu:"https://eu.otgs-stg.autodesk.com",prod_eu:"https://eu.otgs.autodesk.com"},O={v2:"derivativeV2",v2_eu:"derivativeV2_EU"},k={Local:{ROOT:"",LMV:P.local},Development:{ROOT:I.dev,LMV:P.dev,bubbleManifest:!0},Staging:{ROOT:I.stg,LMV:P.stg,bubbleManifest:!0},Production:{ROOT:I.prod,LMV:P.prod,bubbleManifest:!0},AutodeskDevelopment:{ROOT:I.dev,LMV:P.dev},AutodeskStaging:{ROOT:I.stg,LMV:P.stg},AutodeskProduction:{ROOT:I.prod,LMV:P.prod},FluentLocal:{ROOT:L,LMV:L},FluentDev:{ROOT:R.dev,LMV:P.dev,UPSTREAM:I.stg,UPSTREAM_API_DATA:O.v2},FluentStaging:{ROOT:R.stg,LMV:P.stg,UPSTREAM:I.stg,UPSTREAM_API_DATA:O.v2},FluentProduction:{ROOT:R.prod,LMV:P.prod,UPSTREAM:I.prod,UPSTREAM_API_DATA:O.v2},FluentStagingEU:{ROOT:R.stg_eu,LMV:P.stg,UPSTREAM:I.stg,UPSTREAM_API_DATA:O.v2_eu},FluentProductionEU:{ROOT:R.prod_eu,LMV:P.prod,UPSTREAM:I.prod,UPSTREAM_API_DATA:O.v2_eu}}},"./src/file-loaders/lmvtk/common/InputStream.js":function(e,t,r){"use strict";function n(e){this.buffer=e,this.offset=0,this.byteLength=e.length}r.r(t),r.d(t,"InputStream",function(){return n});var i=r("./src/file-loaders/lmvtk/common/StringUtils.js"),o=new ArrayBuffer(8),s=new Uint8Array(o),a=new Uint16Array(o),l=new Int32Array(o),c=new Uint32Array(o),u=new Float32Array(o),d=new Float64Array(o);n.prototype.seek=function(e){this.offset=e},n.prototype.getBytes=function(e){var t=new Uint8Array(this.buffer.buffer,this.offset,e);return this.offset+=e,t},n.prototype.getVarints=function(){var e,t=0,r=0;do e=this.buffer[this.offset++],t|=(127&e)<<r,r+=7;while(128&e);return t},n.prototype.getUint8=function(){return this.buffer[this.offset++]},n.prototype.getUint16=function(){return s[0]=this.buffer[this.offset++],s[1]=this.buffer[this.offset++],a[0]},n.prototype.getInt16=function(){var e=this.getUint16();return e>32767&&(e=4294901760|e),e},n.prototype.getInt32=function(){var e=this.buffer,t=s,r=this.offset;return t[0]=e[r],t[1]=e[r+1],t[2]=e[r+2],t[3]=e[r+3],this.offset+=4,l[0]},n.prototype.getUint32=function(){var e=this.buffer,t=s,r=this.offset;return t[0]=e[r],t[1]=e[r+1],t[2]=e[r+2],t[3]=e[r+3],this.offset+=4,c[0]},n.prototype.getFloat32=function(){var e=this.buffer,t=s,r=this.offset;return t[0]=e[r],t[1]=e[r+1],t[2]=e[r+2],t[3]=e[r+3],this.offset+=4,u[0]},n.prototype.getIndicesArray=function(e,t,r){for(var n=this.buffer,i=new Uint8Array(e,t,2*r),o=this.offset,s=0,a=2*r;a>s;s+=2)i[s]=n[o],i[s+1]=n[o+1],o+=4;this.offset=o},n.prototype.getVector3Array=function(e,t,r,n){var i=this.buffer,o=this.offset,s=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(3===n&&0===r){var a=12*t;s.set(i.subarray(o,o+a)),this.offset+=a}else{n*=4;for(var l=4*r,c=0;t>c;c++){for(var u=0;12>u;u++)s[l+u]=i[o++];l+=n}this.offset=o}},n.prototype.getVector2Array=function(e,t,r,n){var i=this.buffer,o=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),s=this.offset;n*=4;for(var a=4*r,l=0;t>l;l++){for(var c=0;8>c;c++)o[a+c]=i[s++];a+=n}this.offset=s},n.prototype.getVector4=function(e,t){for(var r=this.buffer,n=s,i=this.offset,o=u,a=0;4>a;a++)n[0]=r[i],n[1]=r[i+1],n[2]=r[i+2],n[3]=r[i+3],e[t+a]=o[0],i+=4;this.offset=i},n.prototype.getFloat64=function(){for(var e=this.buffer,t=s,r=this.offset,n=0;8>n;n++)t[n]=e[r+n];return this.offset+=8,d[0]},n.prototype.getString=function(e){var t=Object(i.utf8ArrayToString)(this.buffer,this.offset,e);return this.offset+=e,t},n.prototype.reset=function(e){this.buffer=e,this.offset=0,this.byteLength=e.length}},"./src/file-loaders/lmvtk/common/StringUtils.js":function(e,t,r){"use strict";function n(e,t,r){var n,i,o,s,a,l;for(n="",o=r,i=0;o>i;)switch(s=e[t+i++],s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(s);break;case 12:case 13:a=e[t+i++],n+=String.fromCharCode((31&s)<<6|63&a);break;case 14:a=e[t+i++],l=e[t+i++],n+=String.fromCharCode((15&s)<<12|(63&a)<<6|(63&l)<<0)}return n}function i(e,t,r){var n,i,o,s,a,l,c,u,d=32768;for(n="",a=[],o=r,l=0,i=0;o>i;){switch(s=e[t+i++],s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a.push(String.fromCharCode(s));break;case 12:case 13:c=e[t+i++],a.push(String.fromCharCode((31&s)<<6|63&c));break;case 14:c=e[t+i++],u=e[t+i++],a.push(String.fromCharCode((15&s)<<12|(63&c)<<6|(63&u)<<0))}(++l>=d||i>=o)&&(n+=a.join(""),a.length=0,l=0)}return n}function o(e,t,r){var n,i,o,s=r||0;if(i=e.length,t)for(n=0;i>n;n++)o=e.charCodeAt(n),o>=1&&127>=o?t[s++]=o:o>2047?(t[s++]=224|o>>12&15,t[s++]=128|o>>6&63,t[s++]=128|o>>0&63):(t[s++]=192|o>>6&31,t[s++]=128|o>>0&63);else for(n=0;i>n;n++)o=e.charCodeAt(n),o>=1&&127>=o?s++:s+=o>2047?3:2;return s-(r||0)}function s(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=e.length),h)return r>f?i(e,t,r):n(e,t,r);for(var o="",s=t,a=t+r;a>s;s++)o+=String.fromCharCode(e[s]);return decodeURIComponent(escape(o))}function a(e){var t=s(e,0,e.length);return JSON.parse(t)}function l(e,t){if(void 0===t)return"";for(var r=t;r<e.length-1;){var n=e[r];if(44==n&&(10==e[r+1]||13==e[r+1]))break;if(10==n||13==n)break;r++}var i=s(e,t,r-t);try{return JSON.parse(i)}catch(o){return i}}function c(e,t){var r=0,n=t;for(34==e[n]&&n++;n<e.length-1;){var i=e[n];if(44==i&&(10==e[n+1]||13==e[n+1]))break;if(10==i||13==i||34==i)break;i>=48&&57>=i&&(r=10*r+(i-48)),n++}return r}function u(e,t){for(var r=0,n=0,i=e.length;i>n;n++)44==e[n]&&r++;r++;var o=new Uint32Array(r+(t?1:0));n=0;for(var s=e.length;91!=e[n]&&s>n;)n++;if(n==e.length)return null;n++;var a=!1;r=0;for(var l=0;s>n;){var c=e[n];c>=48&&57>=c?(l=10*l+(c-48),a=!0):44==c||93==c?a&&(o[r++]=l,a=!1,l=0):(a=!1,l=0),n++}return o}function d(e){for(var t=0,r=e.length-1,n=0;r>n;n++)44!=e[n]||10!=e[n+1]&&13!=e[n+1]||t++;if(!t)return null;t++;var i=new Uint32Array(t);for(n=0,t=0;91!=e[n]&&r>n;)n++;n++,i[t++]=n;for(var o=!1;r>n;)10==e[n]||13==e[n]?o=!0:o&&(o=!1,i[t++]=n),n++;return i}r.r(t),r.d(t,"utf8BlobToStr",function(){return n}),r.d(t,"safeUtf8BlobToStr",function(){return i}),r.d(t,"utf16to8",function(){return o}),r.d(t,"utf8ArrayToString",function(){return s}),r.d(t,"blobToJson",function(){return a}),r.d(t,"subBlobToJson",function(){return l}),r.d(t,"subBlobToJsonInt",function(){return c}),r.d(t,"parseIntArray",function(){return u}),r.d(t,"findValueOffsets",function(){return d});var h=!0,f=1048576},"./src/file-loaders/lmvtk/common/SvfPlacementUtils.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){switch(e){case"meter":case"meters":case"m":return 1;case"feet and inches":case"foot":case"feet":case"ft":return.3048;case"inch":case"inches":case"in":return.0254;case"centimeter":case"centimeters":case"cm":return.01;case"millimeter":case"millimeters":case"mm":return.001;default:return 1}}function o(e){for(var t=e.elements,r=0;4>r;r++)for(var n=0;4>n;n++)if(r===n){if(1!==t[4*r+n])return!1}else if(0!==t[4*r+n])return!1;return!0}function s(e,t){if(e.placementTransform=t.placementTransform,t.applyScaling){var r="m";e.metadata["distance unit"]&&(r=e.metadata["distance unit"].value),
e.scalingUnit=r,"object"===n(t.applyScaling)?(t.applyScaling.from&&(r=t.applyScaling.from),t.applyScaling.to&&(e.scalingUnit=t.applyScaling.to)):e.scalingUnit=t.applyScaling;var s=i(r)/i(e.scalingUnit);if(1!=s){var a=new f.LmvMatrix4(!0),l=new f.LmvMatrix4(!0);l.elements[0]=s,l.elements[5]=s,l.elements[10]=s,t.placementTransform&&a.copy(t.placementTransform),e.placementTransform=t.placementTransform=a.multiply(l)}}var c=e.metadata["custom values"];if(c&&c.refPointTransform){e.refPointTransform=new f.LmvMatrix4(!0);var u=e.refPointTransform.elements,d=c.refPointTransform;u[0]=d[0],u[1]=d[1],u[2]=d[2],u[4]=d[3],u[5]=d[4],u[6]=d[5],u[8]=d[6],u[9]=d[7],u[10]=d[8],u[12]=d[9],u[13]=d[10],u[14]=d[11]}else{var h=e.metadata.georeference,p=h&&h.refPointLMV,m=0;if(c&&c.hasOwnProperty("angleToTrueNorth")&&(m=Math.PI/180*c.angleToTrueNorth),p||m){var g=new f.LmvMatrix4(!0),v=g.elements;v[0]=v[5]=Math.cos(m),v[1]=-Math.sin(m),v[4]=Math.sin(m);var y=new f.LmvMatrix4(!0);v=y.elements,p&&(v[12]=-p[0],v[13]=-p[1],v[14]=-p[2]),e.refPointTransform=g.multiply(y)}}if(t.applyRefPoint&&e.refPointTransform){var _=new f.LmvMatrix4(!0);t.placementTransform&&_.copy(t.placementTransform),_.multiply(e.refPointTransform),e.placementTransform=t.placementTransform=_}else!t.applyRefPoint&&t.placementTransform&&(e.placementTransform=new f.LmvMatrix4(!0).copy(t.placementTransform));return e.placementTransform&&o(e.placementTransform)&&(e.placementTransform=null),e.placementTransform}function a(e,t){var r=e.globalOffset;if(r.x||r.y||r.z){if(t){var n=new f.LmvMatrix4(!0);n.copy(t),t=n,t.elements[12]-=r.x,t.elements[13]-=r.y,t.elements[14]-=r.z}else t=new f.LmvMatrix4(!0),t.makeTranslation(-r.x,-r.y,-r.z);e.placementWithOffset=t}else e.placementWithOffset=t}function l(e,t){if(e.metadata){var r=e.metadata["world bounding box"],n=new d.LmvVector3(r.minXYZ[0],r.minXYZ[1],r.minXYZ[2]),i=new d.LmvVector3(r.maxXYZ[0],r.maxXYZ[1],r.maxXYZ[2]);e.bbox=new h.LmvBox3(n,i);var o=s(e,t);o&&!e.bbox.empty()&&e.bbox.applyMatrix4(o),t.globalOffset?e.globalOffset=t.globalOffset:e.globalOffset=e.bbox.center(),a(e,o),e.bbox.empty()||(e.bbox.min.sub(e.globalOffset),e.bbox.max.sub(e.globalOffset)),e.metadata.hasOwnProperty("double sided geometry")&&e.metadata["double sided geometry"].value&&(e.doubleSided=!0)}}function c(e,t){e[0]-=t.x,e[1]-=t.y,e[2]-=t.z}function u(e){if(e.animations){var t=e.animations.animations;if(t)for(var r=e.globalOffset,n=(new f.LmvMatrix4).makeTranslation(r.x,r.y,r.z),i=(new f.LmvMatrix4).makeTranslation(-r.x,-r.y,-r.z),o=new f.LmvMatrix4,s=new f.LmvMatrix4,a=0;a<t.length;a++){var l=t[a];if(l.hierarchy)for(var u=0;u<l.hierarchy.length;u++){var d=l.hierarchy[u].keys;if(d)for(var h=0;h<d.length;h++){var p=d[h].pos;if(p){var m=r,g=d[h].rot;g&&(o.makeRotationFromQuaternion({x:g[0],y:g[1],z:g[2],w:g[3]}),s.multiplyMatrices(n,o).multiply(i),m={x:s.elements[12],y:s.elements[13],z:s.elements[14]}),c(p,m)}var v=d[h].target;v&&c(v,r);var y=d[h].points;if(y)for(var _=0;_<y.length;_++)c(y[_],r)}}}}}r.r(t),r.d(t,"derivePlacementTransform",function(){return s}),r.d(t,"calculatePlacementWithOffset",function(){return a}),r.d(t,"initPlacement",function(){return l}),r.d(t,"transformAnimations",function(){return u});var d=r("./src/wgs/scene/LmvVector3.js"),h=r("./src/wgs/scene/LmvBox3.js"),f=r("./src/wgs/scene/LmvMatrix4.js")},"./src/file-loaders/lmvtk/common/VertexBufferBuilder.js":function(e,t,r){"use strict";function n(e,t,r,n){var i=t||65536;this.FULL_COUNT=0|(r||32767),this.useInstancing=e,this.useCompactBuffers=n,this.stride=10,this.allocVcount=4*(this.useInstancing?i/4:i),this.vb=new ArrayBuffer(this.stride*this.allocVcount),this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.ib=this.useInstancing?null:new Uint16Array(i),this.minLineWidth=Number.MAX_VALUE,this.reset(0)}function i(e){return E[0]=e,E[0]}r.r(t),r.d(t,"VertexBufferBuilder",function(){return n});var o=2*Math.PI,s=0,a=1,l=2,c=3,u=4,d=5,h=6,f=7,p=0,m=1,g=2,v=3,y=6,_=7,b=8,x=9,w=[0,1,3,0,3,2];n.prototype.reset=function(e){this.vcount=e,this.icount=0,this.minx=this.miny=1/0,this.maxx=this.maxy=-(1/0),this.dbIds={},this.lastDbId=null,this.colors={},this.numEllipticals=0,this.numCirculars=0,this.numTriangleGeoms=0,this.hasLineStyles=!1,this.changeTracking={},this.stride=10},n.prototype.expandStride=function(){var e=2,t=this.stride;if(!(t>=12)){for(var r=this.stride+e,n=new ArrayBuffer(r*this.allocVcount),i=new Uint8Array(this.vb),o=new Uint8Array(n),s=0,a=this.vcount;a>s;s++)for(var l=s*t*4,c=s*r*4,u=0;4*t>u;u++)o[c+u]=i[l+u];this.vb=n,this.vbf=new Float32Array(n),this.vbi=new Int32Array(n),this.stride=r}},n.prototype.addToBounds=function(e,t){e<this.minx&&(this.minx=e),e>this.maxx&&(this.maxx=e),t<this.miny&&(this.miny=t),t>this.maxy&&(this.maxy=t)};var E=new Int32Array(1);n.prototype.trackChanges=function(e,t,r,n,o,s){function a(t,r){void 0===l[t]?l[t]=e:l[t]===r&&(l[t+"Varies"]=!0)}if(r!==this.lastDbId&&(this.dbIds[i(r)]=1,this.lastDbId=r),s&&(this.hasLineStyles=!0),this.useCompactBuffers){var l=this.changeTracking;a("geomType",e),a("color",t),a("dbId",r),a("layerId",n),a("viewportId",o),a("linePattern",s),this.colors[i(t)]=1}},n.prototype.setCommonVertexAttribs=function(e,t,r,n,i,o,s,a){this.trackChanges(r,n,i,o,s,a),t=255&t,r=255&r,a=255&a,o=65535&o,s=65535&s,this.vbi[e+b]=t|r<<8|a<<16,this.vbi[e+y]=n,this.vbi[e+_]=i,this.vbi[e+x]=o|s<<16},n.prototype.addVertexTriangleGeom=function(e,t,r,n,i,o,s,a,l,c){for(var u=this.vcount,h=this.vbf,f=this.useInstancing?1:4,m=0;f>m;m++){var g=(u+m)*this.stride;h[g]=e,h[g+1]=t,h[g+2]=r,h[g+3]=n,h[g+4]=i,h[g+5]=o,this.setCommonVertexAttribs(g,p+m,d,s,a,l,c,0),this.vcount++}return u},n.prototype.addVertexLine=function(e,t,r,n,i,s,l,c,u,d,h){var f=this.vcount,m=this.vbf;c>=0&&s>0&&n>0&&(this.minLineWidth=Math.min(this.minLineWidth,s));for(var g=this.useInstancing?1:4,v=0;g>v;v++){var y=(f+v)*this.stride;m[y]=e,m[y+1]=t,m[y+2]=(r+Math.PI)/o,m[y+3]=n,m[y+4]=.5*s,m[y+5]=i,this.setCommonVertexAttribs(y,p+v,a,l,c,u,d,h),this.vcount++}return f},n.prototype.addVertexTexQuad=function(e,t,r,n,i,s,a,l,c){for(var d=this.vcount,h=this.vbf,f=this.useInstancing?1:4,m=0;f>m;m++){var g=(d+m)*this.stride;h[g]=e,h[g+1]=t,h[g+2]=i/o,h[g+3]=r,h[g+4]=n,this.setCommonVertexAttribs(g,p+m,u,s,a,l,c,0),this.vcount++}return d},n.prototype.addVertexArc=function(e,t,r,n,i,s,a,u,d,h,f,m){for(var g=this.vcount,v=this.vbf,y=i==s?l:c,_=this.useInstancing?1:4,b=0;_>b;b++){var x=(g+b)*this.stride;v[x]=e,v[x+1]=t,v[x+2]=r/o,v[x+3]=n/o,v[x+4]=.5*u,v[x+5]=i,y===c&&(v[x+10]=s,v[x+11]=a),this.setCommonVertexAttribs(x,p+b,y,d,h,f,m,0),this.vcount++}return g},n.prototype.addVertex=function(e,t,r,n,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:s;if(!this.useInstancing){var l=this.vcount,c=this.stride*l,u=this.vbf;return u[c]=e,u[c+1]=t,this.setCommonVertexAttribs(c,0,a,r,n,i,o,0),this.vcount++,l}},n.prototype.addVertexPolytriangle=function(e,t,r,n,i,o){this.useInstancing||(this.addVertex(e,t,r,n,i,o),this.addToBounds(e,t))},n.prototype.addVertexMSDFPolytriangle=function(e,t,r,n,i,o,s,a){this.addVertexTexPolytriangle(e,t,r,n,i,o,s,a,h)},n.prototype.addIndices=function(e,t){if(!this.useInstancing){var r=this.ib,n=this.icount;if(n+e.length>=r.length){for(var i=new Uint16Array(2*Math.max(e.length,r.length)),o=0;n>o;++o)i[o]=r[o];this.ib=r=i}for(var o=0;o<e.length;++o)r[n+o]=t+e[o];this.icount+=e.length}},n.prototype.finalizeQuad=function(e){this.useInstancing||this.addIndices(w,e)},n.prototype.addSegment=function(e,t,r,n,i,o,s,a,l,c,u){var d=r-e,h=n-t,f=d||h?Math.atan2(h,d):0,p=d||h?Math.sqrt(d*d+h*h):0,m=this.addVertexLine(e,t,f,p,i,o,s,a,l,c,u);this.finalizeQuad(m),this.addToBounds(e,t),this.addToBounds(r,n)},n.prototype.addTriangleGeom=function(e,t,r,n,i,o,s,a,l,c){this.numTriangleGeoms++;var u=this.addVertexTriangleGeom(e,t,r,n,i,o,s,a,l,c);this.finalizeQuad(u),this.addToBounds(e,t),this.addToBounds(r,n),this.addToBounds(i,o)},n.prototype.addArc=function(e,t,r,n,i,s,a,l,c,u,d,h){i==s?this.numCirculars++:(this.numEllipticals++,this.expandStride());var f=S(r,n);r=f.start,n=f.end,0==r&&0==n&&(n=o);var p=Math.abs(r-n);if(p>1e-4&&Math.abs(p-o)>1e-4){var m=e+i*Math.cos(r),g=t+s*Math.sin(r);this.addSegment(m,g,m,g,0,l,c,u,d,h);var v=e+i*Math.cos(n),y=t+s*Math.sin(n);this.addSegment(v,y,v,y,0,l,c,u,d,h)}else this.addToBounds(e-i,t-s),this.addToBounds(e+i,t+s);var _=33554431,b=this.addVertexLine(e,t,0,1e-4,0,0,_,u,d,h);this.finalizeQuad(b);var x=this.addVertexArc(e,t,r,n,i,s,a,l,c,u,d,h);this.finalizeQuad(x);var y,v,g,m,p},n.prototype.addTexturedQuad=function(e,t,r,n,i,o,s,a,l){var c=this.addVertexTexQuad(e,t,r,n,i,o,s,a,l);this.finalizeQuad(c);var u=.5*Math.cos(i),d=.5*Math.sin(i),h=Math.abs(r*u)+Math.abs(n*d),f=Math.abs(r*d)+Math.abs(n*u);this.addToBounds(e-h,t-f),this.addToBounds(e+h,t+f)},n.prototype.addVertexImagePolytriangle=function(e,t,r,n,i,o,s,a){return this.addVertexTexPolytriangle(e,t,r,n,i,o,s,a,f)},n.prototype.addVertexTexPolytriangle=function(e,t,r,n,i,o,s,a,l){if(!this.useInstancing){var c=this.vcount,u=this.vbf;this.addVertex(e,t,i,o,s,a,l),u[c*this.stride+2]=r,u[c*this.stride+3]=n,this.addToBounds(e,t)}},n.prototype.isFull=function(e){e=e||3;var t=this.useInstancing?4:1;return this.vcount*t+e>this.FULL_COUNT},n.prototype.makeCompactVertexLayout=function(){function e(e){return 0|Math.round((e-T)/A*65535)}function t(e){return 0|Math.round((e-C)/M*65535)}function r(e){return 0|Math.round(e/j*65535)}function n(e){return 0|65535*e}function i(e){return 0>e?32768+32767*Math.min(1,-e/1024):e?0|Math.round(e/j*32767)||1:e}var o=Object.keys(this.colors),h=Object.keys(this.dbIds);if(10!==this.stride)return null;var f=o.length+h.length;if(o.length+h.length>65536)return null;var p=new Int32Array(f+1);p[0]=0;for(var m=1,g=0;g<o.length;g++,m++)p[m]=parseInt(o[g]),this.colors[o[g]]=m;for(var g=0;g<h.length;g++,m++)p[m]=parseInt(h[g]),this.dbIds[h[g]]=m;for(var v=6,w=new ArrayBuffer(4*v*this.vcount),E=new Int32Array(w),S=new Uint16Array(w),A=this.maxx-this.minx||1,M=this.maxy-this.miny||1,T=this.minx,C=this.miny,j=Math.max(A,M),g=0;g<this.vcount;g++){var P=this.stride*g,L=v*g,D=2*L,I=this.vbi[P+b]>>8&255;switch(I){case s:S[D]=e(this.vbf[P]),S[D+1]=t(this.vbf[P+1]);break;case a:S[D]=e(this.vbf[P]),S[D+1]=t(this.vbf[P+1]),S[D+2]=n(this.vbf[P+2]),S[D+3]=r(this.vbf[P+3]),S[D+4]=i(this.vbf[P+4]);break;case l:S[D]=e(this.vbf[P]),S[D+1]=t(this.vbf[P+1]),S[D+2]=n(this.vbf[P+2]),S[D+3]=n(this.vbf[P+3]),S[D+4]=i(this.vbf[P+4]),S[D+5]=r(this.vbf[P+5]);break;case c:break;case u:S[D]=e(this.vbf[P]),S[D+1]=t(this.vbf[P+1]),S[D+2]=n(this.vbf[P+2]),S[D+3]=r(this.vbf[P+3]),S[D+4]=r(this.vbf[P+4]);break;case d:S[D]=e(this.vbf[P]),S[D+1]=t(this.vbf[P+1]),S[D+2]=e(this.vbf[P+2]),S[D+3]=t(this.vbf[P+3]),S[D+4]=e(this.vbf[P+4]),S[D+5]=t(this.vbf[P+5])}S[D+6]=this.colors[this.vbi[P+y]]||0,S[D+7]=this.dbIds[this.vbi[P+_]]||0,E[L+4]=this.vbi[P+b],E[L+5]=this.vbi[P+x]}var R={};R.vb=new Float32Array(w),R.vbstride=v;var O=this.useInstancing?1:0;return R.vblayout={fields1:{offset:0,itemSize:2,bytesPerItem:2,divisor:O,normalize:!0},fields2:{offset:1,itemSize:4,bytesPerItem:2,divisor:O,normalize:!0},uvIdColor:{offset:3,itemSize:2,bytesPerItem:2,divisor:O,normalize:!1},flags4b:{offset:4,itemSize:4,bytesPerItem:1,divisor:O,normalize:!1},layerVp4b:{offset:5,itemSize:4,bytesPerItem:1,divisor:O,normalize:!1}},R.unpackXform={x:A,y:M,z:T,w:C},R.texData=p,R},n.prototype.makeWideVertexLayout=function(){var e={};e.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4)),e.vbstride=this.stride;var t=this.useInstancing?1:0;return e.vblayout={fields1:{offset:0,itemSize:2,bytesPerItem:4,divisor:t,normalize:!1},fields2:{offset:2,itemSize:4,bytesPerItem:4,divisor:t,normalize:!1},color4b:{offset:y,itemSize:4,bytesPerItem:1,divisor:t,normalize:!0},dbId4b:{offset:_,itemSize:4,bytesPerItem:1,divisor:t,normalize:!1},flags4b:{offset:b,itemSize:4,bytesPerItem:1,divisor:t,normalize:!1},layerVp4b:{offset:x,itemSize:4,bytesPerItem:1,divisor:t,normalize:!1}},e.vblayout.extraParams={offset:this.stride-2,itemSize:2,bytesPerItem:4,divisor:t,normalize:!1},e},n.prototype.toMesh=function(){var e=null;if(this.useCompactBuffers&&(e=this.makeCompactVertexLayout()),e||(e=this.makeWideVertexLayout()),this.useInstancing){e.numInstances=this.vcount;var t=new Int32Array([p,m,g,v]);e.vblayout.instFlags4b={offset:0,itemSize:4,bytesPerItem:1,divisor:0,normalize:!1},e.vblayout.instFlags4b.array=t.buffer;e.indices=new Uint16Array(w)}else e.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));e.dbIds=this.dbIds;var r=this.maxx-this.minx,n=this.maxy-this.miny,i=Math.max(r,n);e.boundingBox={min:{x:this.minx,y:this.miny,z:.001*-i},max:{x:this.maxx,y:this.maxy,z:.001*i}};e.boundingSphere={center:{x:.5*(this.minx+this.maxx),y:.5*(this.miny+this.maxy),z:0},radius:.5*Math.sqrt(r*r+n*n)};return e};var S=function(e,t){function r(){function r(e,t){return Math.abs(e-t)<.001}r(e,0)&&(e=0),r(t,0)&&(t=0),r(e,o)&&(e=o),r(t,o)&&(t=o)}if(r(),e>t)for(;e>o;)e-=o,t-=o;else for(;t>o;)e-=o,t-=o;return r(),0>e&&t>0&&(e+=o),{start:e,end:t}}},"./src/file-loaders/lmvtk/otg/HashStrings.js":function(e,t){function r(e,t,r){for(var n=20===r?u:[],i=0;r>i;i+=2){var o=e[t+i],s=e[t+i+1];n[i/2]=s<<8|o}return String.fromCharCode.apply(null,n)}function n(e){for(var t=10===e.length?c:[],r=0;r<e.length;r++){var n=e.charCodeAt(r);t[2*r]=s[255&n],t[2*r+1]=s[n>>8&255]}return t.join("")}function i(e){return e>=48&&57>=e?e-48:e>=65&&70>=e?e-55:e>=97&&102>=e?e-87:0}function o(e,t,r){for(var o=10===e.length?n(e):e,s=r,a=0;a<o.length;a+=2){var l=i(o.charCodeAt(a)),c=i(o.charCodeAt(a+1));t[s++]=l<<4|c}}for(var s=new Array(256),a=0;256>a;a++){var l=a.toString(16);1===l.length&&(l="0"+l),s[a]=l}var c=new Array(20),u=new Array(10);e.exports={getHexStringPacked:r,unpackHexString:n,hexToBin:o}},"./src/file-loaders/lmvtk/otg/Otg.js":function(e,t,r){"use strict";function n(){this.materials=null,this.fragments=null,this.geompacks=[],this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[],dbid:[]},this.bbox=null,this.animations=null,this.pendingRequests=0,this.globalOffset={x:0,y:0,z:0},this.pendingRequests=0,this.initialLoadProgress=0,this.materialIdToHash=[],this.aborted=!1}r.r(t),r.d(t,"FLUENT_URN_PREFIX",function(){return p}),r.d(t,"DS_OTG_CDN_PREFIX",function(){return m}),r.d(t,"OtgPackage",function(){return n});var i=r("./src/file-loaders/net/Xhr.js"),o=r("./src/logger/Logger.js"),s=r("./src/file-loaders/lmvtk/common/SvfPlacementUtils.js"),a=r("./src/file-loaders/lmvtk/otg/HashStrings.js"),l=(r.n(a),r("./src/wgs/scene/LmvVector3.js")),c=r("./src/wgs/scene/MeshFlags.js"),u=r("./src/wgs/scene/LmvBox3.js"),d=r("./src/wgs/scene/LmvMatrix4.js"),h=r("./src/wgs/scene/IntArray.js"),f=r("./src/file-loaders/lmvtk/otg/ProgressiveReadContext.js"),p="urn:adsk.fluent:",m="$otg_cdn$";n.prototype.getMaterialHash=function(e){var t=this.materialIdToHash[e];if(t)return t;var r=this.materialHashes.byteStride,n=Object(a.getHexStringPacked)(this.materialHashes.hashes,e*r,r);return this.materialIdToHash[e]=n,n},n.prototype.getGeometryHash=function(e){var t=this.geomMetadata.byteStride,r=Object(a.getHexStringPacked)(this.geomMetadata.hashes,e*t,t);return r},n.prototype.initEmptyLists=function(e){var t=this,r=t.fragments={};r.length=t.metadata.stats.num_fragments,r.numLoaded=0,r.boxes=e.fragmentTransformsDouble?new Float64Array(6*r.length):new Float32Array(6*r.length),r.transforms=e.fragmentTransformsDouble?new Float64Array(12*r.length):new Float32Array(12*r.length),r.materials=Object(h.allocateUintArray)(r.length,t.metadata.stats.num_materials),r.geomDataIndexes=Object(h.allocateUintArray)(r.length,t.metadata.stats.num_geoms),r.fragId2dbId=new Int32Array(r.length),r.visibilityFlags=new Uint8Array(r.length),r.mesh2frag={},r.topoIndexes=null,t.geomMetadata={hashes:null,byteStride:0,version:0,numLoaded:0,hashToIndex:{}},t.materialHashes={hashes:null,byteStride:0,version:0,numLoaded:0},t.materials={name:"LMVTK Simple Materials",version:"1.0",scene:{SceneUnit:8215,YIsUp:0},materials:{}}},n.prototype.loadAsyncResource=function(e,t,r,n){function o(e){s.pendingRequests--,n(e)}var s=this;this.pendingRequests++,t=Object(i.pathToURL)(t,e.basePath),i.ViewingService.getItem(e,t,o,e.onFailureCallback,{responseType:r||"arraybuffer"})},n.prototype.loadAsyncProgressive=function(e,t,r,n,o){function s(t,i){r.onEnd(t,i),l.postLoad(e,n,r,t)}function a(e,t){return l.aborted?!0:void r.onData(e,t,!1)}var l=this;t=Object(i.pathToURL)(t,e.basePath),i.ViewingService.getItem(e,t,s,o||e.onFailureCallback,{responseType:"text",onprogress:a})},n.prototype.loadMetadata=function(e,t){var r=this;this.loadAsyncResource(e,t,"json",function(n){r.metadata=n,r.manifest=r.metadata.manifest,r.numGeoms=r.metadata.stats.num_geoms,r.processMetadata(e),r.initEmptyLists(e);var i=r.metadata.manifest,o=i.shared_assets.pdb;for(var a in o)r.propertydb[a]&&r.propertydb[a].push({path:o[a],isShared:!0});var l=i.assets.pdb;for(var a in l)r.propertydb[a]&&r.propertydb[a].push({path:l[a],isShared:!1});i.assets.animations&&r.loadAsyncResource(e,i.assets.animations,"json",function(e){r.animations=e,Object(s.transformAnimations)(r)}),i.assets.topology&&r.loadAsyncResource(e,t,"json",function(e){r.topology=e}),e.onLoaderEvent("otg_root"),r.postLoad(e,"metadata")})},n.prototype.loadFragmentList=function(e,t){function r(t,r){if(r-=1,!n.metadata)return!1;var l=t.idata(),u=t.fdata(),d=0,f=n.fragments,m=f.geomDataIndexes[r]=l[d],g=f.materials[r]=l[d+1],v=f.fragId2dbId[r]=l[d+2],y=l[d+3];if(m>n.geomMetadata.numLoaded||g>n.materialHashes.numLoaded)return!1;var _=f.mesh2frag[m];void 0===_?f.mesh2frag[m]=r:Array.isArray(_)?_.push(r):f.mesh2frag[m]=[_,r];var b=n.dbIdFilter?n.dbIdFilter[v]:!0,x=!b||1&y?c.MeshFlags.MESH_NOTLOADED:0;f.visibilityFlags[r]=x;var w=n.metadata.fragmentTransformsOffset||p,E=d+4;i.set(u[E+0]+w.x,u[E+1]+w.y,u[E+2]+w.z),s.x=u[E+3],s.y=u[E+4],s.z=u[E+5],s.w=u[E+6],o.set(u[E+7],u[E+8],u[E+9]),a.compose(i,s,o),n.placementWithOffset&&a.multiplyMatrices(n.placementWithOffset,a);var S=a.elements,A=f.transforms,M=12*r;return A[M+0]=S[0],A[M+1]=S[1],A[M+2]=S[2],A[M+3]=S[4],A[M+4]=S[5],A[M+5]=S[6],A[M+6]=S[8],A[M+7]=S[9],A[M+8]=S[10],A[M+9]=S[12],A[M+10]=S[13],A[M+11]=S[14],h.min.x=-.5,h.min.y=-.5,h.min.z=-.5,h.max.x=.5,h.max.y=.5,h.max.z=.5,h.applyMatrix4(a),f.boxesLoaded||(A=f.boxes,M=6*r,A[M+0]=h.min.x,A[M+1]=h.min.y,A[M+2]=h.min.z,A[M+3]=h.max.x,A[M+4]=h.max.y,A[M+5]=h.max.z),f.numLoaded=r+1,e.onLoaderEvent("fragment",r),!0}var n=this,i=new l.LmvVector3,o=new l.LmvVector3,s={x:0,y:0,z:0,w:1},a=new d.LmvMatrix4(!0),h=new u.LmvBox3,p={x:0,y:0,z:0},m=new f.ProgressiveReadContext(r,52);return this.loadAsyncProgressive(e,t,m,"all_fragments"),m},n.prototype.handleHashListRequestFailures=function(e){this.metadata&&(this.geomHashListFailure&&this.metadata.stats.num_geoms>0&&e.onFailureCallback.apply(e,this.geomHashListFailure),this.matHashListFailure&&this.metadata.stats.num_materials>0&&e.onFailureCallback.apply(e,this.matHashListFailure),this.geomHashListFailure=null,this.matHashListFailure=null)},n.prototype.loadGeometryHashList=function(e,t){function r(e,t){return n.metadata?(n.geomMetadata.hashes||(n.geomMetadata.hashes=new Uint8Array(e.byteStride()*(n.numGeoms+1)),n.geomMetadata.byteStride=e.byteStride(),n.geomMetadata.version=e.version()),n.geomMetadata.hashes.set(e.bdata(),t*e.byteStride()),n.geomMetadata.numLoaded=t,!0):!1}var n=this,i=function(){n.geomHashListFailure=arguments,n.handleHashListRequestFailures(e),n.postLoad(e,"geometry_ptrs",o)},o=new f.ProgressiveReadContext(r,20);return this.loadAsyncProgressive(e,t,o,"geometry_ptrs",i),o},n.prototype.loadMaterialHashList=function(e,t){function r(e,t){return n.metadata?(n.materialHashes.hashes||(n.numMaterials=n.metadata.stats.num_materials,n.materialHashes.hashes=new Uint8Array(e.byteStride()*(n.numMaterials+1)),n.materialHashes.byteStride=e.byteStride(),n.materialHashes.version=e.version()),n.materialHashes.hashes.set(e.bdata(),t*e.byteStride()),n.materialHashes.numLoaded=t,!0):!1}var n=this,i=function(){n.matHashListFailure=arguments,n.handleHashListRequestFailures(e),n.postLoad(e,"material_ptrs",o)},o=new f.ProgressiveReadContext(r,20);return this.loadAsyncProgressive(e,t,o,"material_ptrs",i),o},n.prototype.processMetadata=function(e){var t=this,r=t.metadata;Object(s.initPlacement)(t,e);var n=t.placementWithOffset;if(r.cameras&&(t.cameras=r.cameras,n))for(var i=0;i<t.cameras.length;i++){var o=t.cameras[i];o.position=new l.LmvVector3(o.position.x,o.position.y,o.position.z),o.position.applyMatrix4(n),o.target=new l.LmvVector3(o.target.x,o.target.y,o.target.z),o.target.applyMatrix4(n),o.up=new l.LmvVector3(o.up.x,o.up.y,o.up.z),o.up.transformDirection(n)}},n.prototype.beginLoad=function(e,t){this.loadMetadata(e,t);var r=e.objectIds;if(r){this.dbIdFilter={};for(var n=0,i=r.length;i>n;n++)this.dbIdFilter[r[n]]=1}this.materialsCtx=this.loadMaterialHashList(e,"materials_ptrs.hl"),this.geometryCtx=this.loadGeometryHashList(e,"geometry_ptrs.hl"),this.fragmentsCtx=this.loadFragmentList(e,"fragments.fl")},n.prototype.makeSharedResourcePath=function(e,t,r){if(10===r.length&&(r=Object(a.unpackHexString)(r)),e){var n=this.manifest.shared_assets.global_sharding||0,o=r,s="";n&&(s="/"+r.slice(0,n),o=r.slice(n));var l=this.manifest.shared_assets[t];if(0===l.indexOf(p)||0===l.indexOf(m))l=l.slice(l.indexOf("/"));else{var c=l.split("/");l="/"+(c[c.length-1]||c[c.length-2])+"/"}return e+s+l+o}var n=this.manifest.shared_assets.global_sharding||2,o=r,s="";n&&(s="/"+r.slice(0,n)+"/",o=r.slice(n));var u=Object(i.pathToURL)(this.basePath);return u+this.manifest.shared_assets[t]+s+o},n.prototype.postLoad=function(e,t,r,n){t&&this.initialLoadProgress++,4===this.initialLoadProgress?(this.materialsCtx.flush(),this.geometryCtx.flush(),this.fragmentsCtx.flush(),this.materialsCtx=null,this.geometryCtx=null,this.fragmentsCtx=null,this.fragments.numLoaded<this.metadata.stats.num_fragments&&o.logger.warn("Fragments actually loaded fewer than expected."),e.onLoaderEvent("all_fragments")):"metadata"===t&&(this.materialsCtx.flush(),this.geometryCtx.flush(),this.fragmentsCtx.flush())},n.prototype.abort=function(){this.aborted=!0}},"./src/file-loaders/lmvtk/otg/OtgGeomCodec.js":function(e,t,r){"use strict";function n(e){var t=e[0];e[0]=e[1],e[1]=e[2],e[2]=t}function i(e){for(var t=[],r=0;r<e.length;r+=3)t.push([e[r],e[r+1],e[r+2]]);for(var r=0;r<t.length;r++)for(var i=t[r];i[0]>i[1]||i[0]>i[2];)n(i);t.sort(function(e,t){return e[0]-t[0]});var i=t[0],o=0;e[o]=i[0],e[o+1]=i[1]-i[0],e[o+2]=i[2]-i[0],o+=3;for(var r=1;r<t.length;r++,o+=3)i=t[r],e[o]=i[0]-t[r-1][0],e[o+1]=i[1]-i[0],e[o+2]=i[2]-i[0]}function o(e){for(var t=[],r=0;r<e.length;r+=2)t.push([e[r],e[r+1]]);for(var r=0;r<t.length;r++){var n=t[r];if(n[0]>n[1]){var i=n[0];n[0]=n[1],n[1]=i}}t.sort(function(e,t){return e[0]-t[0]});var n=t[0],o=0;e[o]=n[0],e[o+1]=n[1]-n[0],o+=2;for(var r=1;r<t.length;r++,o+=2)n=t[r],e[o]=n[0]-t[r-1][0],e[o+1]=n[1]-n[0]}function s(e){if(e.length){e[1]+=e[0],e[2]+=e[0];for(var t=3;t<e.length;t+=3)e[t]+=e[t-3],e[t+1]+=e[t],e[t+2]+=e[t]}}function a(e){if(e.length){e[1]+=e[0];for(var t=2;t<e.length;t+=2)e[t]+=e[t-2],e[t+1]+=e[t]}}function l(e){var t=w[e];return"undefined"!=typeof t?t:0===e.indexOf("uv")?_.TextureUV:_.TextureUV}function c(e){var t=E[e];return t?t:_.TextureUV}function u(e){var t=b.FLOAT,r=e.bytesPerItem||4;return 1===r?t=e.normalize?b.UBYTE_NORM:b.UBYTE:2===r&&(t=e.normalize?b.USHORT_NORM:b.USHORT),t<<4|15&e.itemSize}function d(e){var t=b.USHORT,r=e.bytesPerItem||2;return 1===r?t=b.UBYTE:2===r?t=b.USHORT:4===r&&(t=b.UINT),t<<4|15&e.itemSize}function h(){}function f(e){this.buffer=e,this.readOffset=0,this.meshFlag=0,this.numBuffers=0,this.numAttributes=0,this.bufferOffsets=[],this.attributes=[],this.buffers=[]}function p(e){var t=new h,r=[];if(!e.vb)return null;r=[e.vb.byteLength,e.ib.byteLength],e.iblines&&r.push(e.iblines.byteLength);var n=Object.keys(e.attributes),s=0;e.isLines&&(s|=x.LINES),e.isWideLines&&(s|=x.WIDE_LINES),e.isPoints&&(s|=x.POINTS),t.beginHeader(s,n.length,r);for(var a=0;a<n.length;a++){var c=e.attributes[n[a]],u=l(n[a]);"index"===n[a]?t.addAttribute(u,c,0,1):"indexlines"===n[a]?t.addAttribute(u,c,0,2):t.addAttribute(u,c,e.vbstride,0)}t.endHeader();var d=Buffer.from(e.vb.buffer,e.vb.byteOffset,e.vb.byteLength);t.addBuffer(d),e.isLines?o(e.ib):i(e.ib),d=Buffer.from(e.ib.buffer,e.ib.byteOffset,e.ib.byteLength),t.addBuffer(d),e.iblines&&(o(e.iblines),d=Buffer.from(e.iblines.buffer,e.iblines.byteOffset,e.iblines.byteLength),t.addBuffer(d));var f=t.end();return f}function m(e,t){var r=new f(e);if(!r.read())return null;for(var n={vblayout:{},vb:new Float32Array(r.buffers[0].buffer,r.buffers[0].byteOffset,r.buffers[0].byteLength/4),isLines:(3&r.meshFlag)===x.LINES,isWideLines:(3&r.meshFlag)===x.WIDE_LINES,isPoints:(3&r.meshFlag)===x.POINTS,boundingBox:A,boundingSphere:M},i=0;i<r.attributes.length;i++){var o=r.attributes[i];if(o.name===_.Index){var l=r.buffers[1];1===o.bytesPerItem?n.indices=l:2===o.bytesPerItem?n.indices=new Uint16Array(l.buffer,l.byteOffset,l.byteLength/o.bytesPerItem):4===o.bytesPerItem&&(n.indices=new Uint32Array(l.buffer,l.byteOffset,l.byteLength/o.bytesPerItem)),n.isLines?a(n.indices):s(n.indices)}else if(o.name===_.IndexEdges){if(!t){var u=r.buffers[2];1===o.bytesPerItem?n.iblines=u:2===o.bytesPerItem?n.iblines=new Uint16Array(u.buffer,u.byteOffset,u.byteLength/o.bytesPerItem):4===o.bytesPerItem&&(n.iblines=new Uint32Array(u.buffer,u.byteOffset,u.byteLength/o.bytesPerItem)),a(n.iblines)}}else{var d=c(o.name);n.vbstride?n.vbstride!==o.itemStride:n.vbstride=o.itemStride,o.itemOffset>=o.itemStride||(n.vblayout[d]={bytesPerItem:o.bytesPerItem,offset:o.itemOffset,normalize:o.normalize,itemSize:o.itemSize})}}var h={mesh:n,packId:0,meshIndex:0};return h}r.r(t),r.d(t,"serializeLmvBufferGeom",function(){return p}),r.d(t,"readLmvBufferGeom",function(){return m});var g=r("./src/compat.js"),v=r("./src/file-loaders/lmvtk/common/InputStream.js"),y=r("./src/wgs/scene/LmvBox3.js"),_={Index:0,IndexEdges:1,Position:2,Normal:3,TextureUV:4,Color:5},b={BYTE:0,SHORT:1,UBYTE:2,USHORT:3,BYTE_NORM:4,SHORT_NORM:5,UBYTE_NORM:6,USHORT_NORM:7,FLOAT:8,INT:9,UINT:10},x={TRIANGLES:0,LINES:1,POINTS:2,WIDE_LINES:3},w={position:_.Position,normal:_.Normal,index:_.Index,indexlines:_.IndexEdges,color:_.Color},E={};E[_.Position]="position",E[_.Normal]="normal",E[_.Index]="index",E[_.IndexEdges]="indexlines",E[_.Color]="color",E[_.TextureUV]="uv";var S={};S[b.BYTE]=1,S[b.SHORT]=2,S[b.UBYTE]=1,S[b.USHORT]=2,S[b.BYTE_NORM]=1,S[b.SHORT_NORM]=2,S[b.UBYTE_NORM]=1,S[b.USHORT_NORM]=2,S[b.FLOAT]=4,S[b.INT]=4,S[b.UINT]=4,h.prototype.beginHeader=function(e,t,r){var n=8,i=r.length;for(n+=4*(i-1),n+=5*t;n%4!==0;)n++;for(var o=0,s=0;s<r.length;s++)o+=r[s];this.buffer=Buffer.alloc(n+o),this.writeOffset=0;for(var a="OTG0",s=0;4>s;s++)this.writeOffset=this.buffer.writeUInt8(a.charCodeAt(s),this.writeOffset);this.writeOffset=this.buffer.writeUInt16LE(e,this.writeOffset),this.writeOffset=this.buffer.writeUInt8(i,this.writeOffset),this.writeOffset=this.buffer.writeUInt8(t,this.writeOffset);for(var l=r[0],s=1;s<r.length;s++)this.writeOffset=this.buffer.writeUInt32LE(l,this.writeOffset),l+=r[s]},h.prototype.addAttribute=function(e,t,r,n){this.writeOffset=this.buffer.writeUInt8(e,this.writeOffset),e===_.Index||e===_.IndexEdges?(this.writeOffset=this.buffer.writeUInt8(d(t),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(t.itemOffset||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(r||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(n,this.writeOffset)):(this.writeOffset=this.buffer.writeUInt8(u(t),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(t.itemOffset||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(r||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(n,this.writeOffset))},h.prototype.endHeader=function(){for(;this.writeOffset%4!==0;)this.writeOffset=this.buffer.writeUInt8(0,this.writeOffset)},h.prototype.addBuffer=function(e){e.copy(this.buffer,this.writeOffset),this.writeOffset+=e.length},h.prototype.end=function(){return this.writeOffset!==this.buffer.length,this.buffer},f.prototype.readNodeJS=function(){var e=this.buffer.toString("ascii",0,4);if("OTG0"!==e)return!1;if(this.readOffset=4,this.meshFlag=this.buffer.readUInt16LE(this.readOffset),this.readOffset+=2,this.numBuffers=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.numAttributes=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.numBuffers){this.bufferOffsets.push(0);for(var t=1;t<this.numBuffers;t++){var r=this.buffer.readUInt32LE(this.readOffset);this.readOffset+=4,this.bufferOffsets.push(r)}}for(var t=0;t<this.numAttributes;t++){var n={};n.name=this.buffer.readUInt8(this.readOffset),this.readOffset++;var i=this.buffer.readUInt8(this.readOffset);this.readOffset++,n.itemSize=15&i,n.type=i>>4,n.bytesPerItem=S[n.type],n.normalize=n.type===b.BYTE_NORM||n.type===b.SHORT_NORM||n.type===b.UBYTE_NORM||n.type===b.USHORT_NORM,n.itemOffset=this.buffer.readUInt8(this.readOffset)/4,this.readOffset++,n.itemStride=this.buffer.readUInt8(this.readOffset)/4,this.readOffset++,n.bufferIndex=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.attributes.push(n)}for(;this.readOffset%4!==0;)this.readOffset++;for(var t=0;t<this.bufferOffsets.length;t++){var o,s=this.readOffset+this.bufferOffsets[t];o=t<this.bufferOffsets.length-1?this.readOffset+this.bufferOffsets[t+1]:this.buffer.length,this.buffers.push(this.buffer.slice(s,o))}return!0},f.prototype.readWeb=function(){var e=new v.InputStream(this.buffer),t=e.getString(4);if("OTG0"!==t)return!1;if(this.meshFlag=e.getUint16(),this.numBuffers=e.getUint8(),this.numAttributes=e.getUint8(),this.numBuffers){this.bufferOffsets.push(0);for(var r=1;r<this.numBuffers;r++){var n=e.getUint32();this.bufferOffsets.push(n)}}for(var r=0;r<this.numAttributes;r++){var i={};i.name=e.getUint8();var o=e.getUint8();i.itemSize=15&o,i.type=o>>4,i.bytesPerItem=S[i.type],i.normalize=i.type===b.BYTE_NORM||i.type===b.SHORT_NORM||i.type===b.UBYTE_NORM||i.type===b.USHORT_NORM,i.itemOffset=e.getUint8()/4,i.itemStride=e.getUint8()/4,i.bufferIndex=e.getUint8(),this.attributes.push(i)}for(;e.offset%4!==0;)e.offset++;for(var r=0;r<this.bufferOffsets.length;r++){var s,a=e.offset+this.bufferOffsets[r];s=r<this.bufferOffsets.length-1?e.offset+this.bufferOffsets[r+1]:e.byteLength,this.buffers.push(this.buffer.subarray(a,s))}return!0},f.prototype.read=function(){return Object(g.isNodeJS)()&&this.buffer instanceof Buffer?this.readNodeJS():this.readWeb()};var A=new y.LmvBox3;A.min.x=-.5,A.min.y=-.5,A.min.z=-.5,A.max.x=.5,A.max.y=.5,A.max.z=.5;var M={center:{x:0,y:0,z:0},radius:Math.sqrt(.75)}},"./src/file-loaders/lmvtk/otg/OtgPriorityQueue.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e){var t=e.max.x-e.min.x,r=e.max.y-e.min.y,n=e.max.z-e.min.z;return 2*(t*r+r*n+n*t)}function a(e,t,r){var n=6*t;return r.min.y=e[n+1],r.min.z=e[n+2],r.min.x=e[n+0],r.max.x=e[n+3],r.max.y=e[n+4],r.max.z=e[n+5],r}function l(e,t,r){return Math.abs(e.x-t.x)<r&&Math.abs(e.y-t.y)<r&&Math.abs(e.z-t.z)<r}function c(e,t){return t.importance-e.importance}function u(e,t,r){var n=a(t,e,g),i=r.intersectsBox(n);if(i===p.OUTSIDE)return 0;var o=i===p.CONTAINS,s=r.projectedBoxArea(n,o),l=m(r.eye,n.min,n.max);return l=Math.max(l,.01),s/l}function d(e,t){var r=e.getFragmentList(),n=r.getGeometry(t);if(r.getWorldBounds(t,g),n){var i=n.importance||0,o=s(g);n.importance=Math.max(i,o)}}r.r(t),r.d(t,"computeFragImportance",function(){return u}),r.d(t,"updateGeomImportance",function(){return d}),r.d(t,"OtgPriorityQueue",function(){return v});var h=r("./src/wgs/scene/LmvVector3.js"),f=r("./src/wgs/scene/LmvBox3.js"),p=r("./src/wgs/scene/FrustumIntersector.js"),m=function(){
var e=null;return function(t,r,n){return e||(e=new h.LmvVector3),e.copy(t),e.max(r),e.min(n),e.distanceToSquared(t)}}(),g=new f.LmvBox3,v=function(){function e(){n(this,e),this.viewers=[],this.waitingTasks=[],this.urgentHashes={},this.prevNumTasks=0,this.fullSortDone=!1,this.lastCamPos={},this.lastCamTarget={},this.lastVisibleModelIds={}}return o(e,[{key:"addViewer",value:function(e){this.viewers.push(e),this.lastCamPos[e.id]=new h.LmvVector3,this.lastCamTarget[e.id]=new h.LmvVector3,this.lastVisibleModelIds[e.id]=[]}},{key:"removeViewer",value:function(e){var t=this.viewers.indexOf(e);-1!==t&&(delete this.lastCamPos[e.id],delete this.lastCamTarget[e.id],delete this.lastVisibleModelIds[e.id],this.viewers.splice(t,1))}},{key:"checkCameraChanged",value:function(){for(var e=!1,t=0;t<this.viewers.length;t++){var r=this.viewers[t],n=r.impl.camera,i=n.position,o=n.target,s=.01;l(this.lastCamPos[r.id],i,s)&&l(this.lastCamTarget[r.id],o,s)||(this.lastCamPos[r.id].copy(i),this.lastCamTarget[r.id].copy(o),e=!0)}return e}},{key:"checkModelsChanged",value:function(){for(var e=!1,t=0;t<this.viewers.length;t++){var r=this.viewers[t],n=r.impl.modelQueue(),i=n.getModels();i.length!==this.lastVisibleModelIds[r.id].length&&(this.lastVisibleModelIds[r.id].length=i.length,e=!0);for(var o=0;o<i.length;o++){var s=this.lastVisibleModelIds[r.id][o],a=i[o].id;s!==a&&(this.lastVisibleModelIds[r.id][o]=a,e=!0)}}return e}},{key:"validateRequestPriorities",value:function(){var e=this.checkCameraChanged(),t=this.checkModelsChanged();if(e||t)for(var r=0;r<this.waitingTasks.length;r++)this.waitingTasks[r].importanceNeedsUpdate=!0}},{key:"updateRequestPriorities",value:function(){var e=performance.now(),t=10;this.validateRequestPriorities();for(var r={},n=[],i=0;i<this.viewers.length;i++){var o=this.viewers[i],s=o.impl.modelQueue(),a=s.frustum();n=n.concat(s.getModels()),a.reset(o.impl.camera),r[o.id]=a}var l=!1,d=0===this.prevNumTasks||this.waitingTasks.length-this.prevNumTasks>3e3||!this.fullSortDone;this.fullSortDone=!d,this.prevNumTasks=this.waitingTasks.length;for(var i=0;i<this.waitingTasks.length;i++){var h=this.waitingTasks[i];if(h.importanceNeedsUpdate)if(this.urgentHashes[h.hash])h.importance=1/0;else{if(i%10===0){var f=performance.now()-e;if(f>t){l=!0;break}}h.importanceNeedsUpdate=!1,h.importance=0;for(var p=0,m=h.hash,g=0;g<n.length;g++){var v=n[g];if(v.isOTG()){var y=v.myData,_=y.fragments,b=_.boxes,x=y.geomMetadata.hashToIndex[m];if(x&&_.mesh2frag)for(var w=_.mesh2frag[x],E=0;E<this.viewers.length;E++){var o=this.viewers[E];if(-1!==o.impl.modelQueue().getModels().indexOf(v))if("number"==typeof w){var S=u(w,b,r[o.id]);p+=S}else if(Array.isArray(w))for(var E=0;E<w.length;E++){var A=w[E],S=u(A,b,r[o.id]);p+=S}}}}if(h.importance=p,!d){for(var g=i;g>0&&p>this.waitingTasks[g-1].importance;)this.waitingTasks[g]=this.waitingTasks[g-1],g--;this.waitingTasks[g]=h}}}return d&&!l&&(this.waitingTasks.sort(c),this.fullSortDone=!0),!l}},{key:"makeUrgent",value:function(e){var t=0;for(var r in e)e[r]===!0&&(this.urgentHashes[r]=!0,t++);if(0===t)return 0;for(var n=0;n<this.waitingTasks.length;n++){var i=this.waitingTasks[n];this.urgentHashes[i.hash]&&(i.importance=1/0)}return this.waitingTasks.sort(c),t}},{key:"removeUrgent",value:function(e){delete this.urgentHashes[e]}},{key:"addTask",value:function(e){this.waitingTasks.push(e)}},{key:"takeTask",value:function(){return this.waitingTasks.shift()}},{key:"isEmpty",value:function(){return 0===this.waitingTasks.length}}]),e}()},"./src/file-loaders/lmvtk/otg/ProgressiveReadContext.js":function(e,t,r){"use strict";function n(e,t){function r(e){var r=new Uint8Array(4);if("string"==typeof e)for(var u=0;4>u;u++)r[u]=e.charCodeAt(u);else for(var d=0;4>d;d++)r[d]=e[d];o=r[1]<<8|r[0],o||(o=t||0),o||i.logger.error("Unknwon byte stride."),o%4&&i.logger.error("Expected byte size to be multiple of 4, but got "+o),s=r[3]<<8|r[2],n=o/4,a=new Uint8Array(o),l=new Float32Array(a.buffer),c=new Uint32Array(a.buffer)}var n,o,s,a,l,c,u=0;this.onData=function(t,n,i){void 0===n&&(n=t.length);for(var s="string"==typeof t;;){if(!u&&n>=4)r(t),u++;else if(4>n)return!1;var l=u*o,c=l+o;if(c>n)return i;if(s)for(var d=0;o>d;d++)a[d]=255&t.charCodeAt(d+l);else for(var h=0;o>h;h++)a[h]=t[h+l];if(!e(this,u))return!1;u++}},this.onEnd=function(e,t){var r=this.onData(e,t,!0);r||(this.rawData=e,this.rawLength=t)},this.flush=function(){if(this.rawData){var e=this.onData(this.rawData,this.rawLength,!0);e&&(this.rawData=null)}},this.idata=function(){return c},this.fdata=function(){return l},this.bdata=function(){return a},this.version=function(){return s},this.byteStride=function(){return o}}r.r(t),r.d(t,"ProgressiveReadContext",function(){return n});var i=r("./src/logger/Logger.js")},"./src/file-loaders/loader-extensions.js":function(e,t,r){"use strict";r.r(t),t["default"]=Object.freeze({pdf:"Autodesk.PDF",scalaris:"Autodesk.Scalaris",dwf:"Autodesk.DWF",dwfx:"Autodesk.DWF"})},"./src/file-loaders/main/F2DLoader.js":function(e,t,r){"use strict";function n(e){this.viewer3DImpl=e,this.loading=!1,this.tmpMatrix=new v.Matrix4,this.logger=i.logger,this.loadTime=0}r.r(t),r.d(t,"OUTPUT_TYPE",function(){return x}),r.d(t,"F2DLoader",function(){return n});var i=r("./src/logger/Logger.js"),o=r("./src/wgs/scene/BufferGeometry.js"),s=r("./src/file-loaders/net/ErrorCodes.js"),a=r("./src/application/ProgressState.js"),l=r("./src/application/FileLoaderManager.js"),c=r("./src/file-loaders/net/Xhr.js"),u=r("./src/file-loaders/main/WorkerCreator.js"),d=(r.n(u),r("./src/file-loaders/main/PropDbLoader.js")),h=r("./src/compat.js"),f=r("./src/application/EventTypes.js"),p=(r.n(f),r("./src/file-loaders/main/TextureLoader.js")),m=r("./src/file-loaders/net/endpoints.js"),g=r("./src/application/Model.js"),v=r("./thirdparty/three.js/three.js"),y=(r.n(v),"PARSE_F2D"),_="STREAM_F2D",b="PARSE_F2D_FRAME",x={GEOMETRY:"geometry",VERTEX_BUFFER:"vertexBuffer"};n.prototype.dtor=function(){this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,i.logger.debug("F2D loader dtor: on init worker script.")),this.streamingWorker&&(this.streamingWorker.terminate(),this.streamingWorker=null,i.logger.debug("F2D loader dtor: on streaming worker.")),this.parsingWorker&&(this.parsingWorker.terminate(),this.parsingWorker=null,i.logger.debug("F2D loader dtor: on parsing worker.")),this.svf&&this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null),this.viewer3DImpl=null,this.loading=!1,this.tmpMatrix=null,this.logger=null,this.loadTime=0,this.svf=null,this.model=null,this.options=null},n.prototype.isValid=function(){return!!this.viewer3DImpl},n.prototype.loadFile=function(e,t,r,n){if(!this.viewer3DImpl)return i.logger.log("F2D loader was already destructed. So no longer usable."),!1;if(this.loading)return i.logger.log("Loading of F2D already in progress. Ignoring new request."),!1;this.loading=!0;var o=e.indexOf("urn:");if(-1!=o){e=decodeURIComponent(e);var s=e.substr(o,e.substr(o).indexOf("/"));i.logger.log("Extracted URN: "+s);var a=s.lastIndexOf(":");this.svfUrn=s.substr(a+1)}else this.svfUrn=e;this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e,this.acmSessionId=t.acmSessionId,this.queryParams="",this.acmSessionId&&(this.queryParams="acmsession="+this.acmSessionId),this.options=t,this.options.placementTransform?this.modelScale=this.options.modelScale||this.options.placementTransform.getMaxScaleOnAxis():this.modelScale=this.options.modelScale||1,this.isf2d=!0;var l=this;return this.initWorkerScriptToken=Object(u.initWorkerScript)(function(){l.loadFydoCB(e,t,r,n)}),!0},n.prototype.loadFydoCB=function(e,t,r,n){this.t0=Date.now();var o=Object(c.pathToURL)(e);this.streamingWorker=Object(u.createWorker)(!0),this.parsingWorker=Object(u.createWorker)();var l,d,p=this,g=!0,w=this.viewer3DImpl.glrenderer();w&&(l=w.supportsInstancedArrays(),d=w.isWebGL2());var E=function(){p.parsingWorker.terminate(),p.parsingWorker=null},S=function(e){if(p.isValid()){g&&n&&(g=!1,n());var c;e.data&&"F2DBLOB"==e.data.type?(c={operation:y,data:e.data.buffer,metadata:e.data.metadata,manifest:e.data.manifest,basePath:e.data.basePath,f2dLoadOptions:{modelSpace:t.modelSpace,bgColor:t.bgColor,noShadow:t.noShadow,isMobile:Object(h.isMobileDevice)(),supportsInstancing:l,isWebGL2:d,excludeTextGeometry:t.excludeTextGeometry,outputType:t.outputType||x.VERTEX_BUFFER},url:o},p.parsingWorker.doOperation(c,[c.data]),p.streamingWorker.terminate(),p.streamingWorker=null):e.data&&"F2DSTREAM"==e.data.type?(c={operation:b,data:e.data.frames,url:o,f2dLoadOptions:{modelSpace:t.modelSpace,bgColor:t.bgColor,noShadow:t.noShadow,isMobile:Object(h.isMobileDevice)(),supportsInstancing:l,isWebGL2:d,excludeTextGeometry:t.excludeTextGeometry,outputType:t.outputType||x.VERTEX_BUFFER}},e.data.metadata&&(c.metadata=e.data.metadata,c.manifest=e.data.manifest),e.data.finalFrame&&(c.finalFrame=!0,p.streamingWorker.terminate(),p.streamingWorker=null,p.fileMemorySize/=2),e.data.progress&&p.viewer3DImpl.signalProgress(100*e.data.progress,a.ProgressState.LOADING),p.parsingWorker.doOperation(c,c.data?[c.data]:void 0)):e.data&&"F2DAssetURL"==e.data.type||e.data&&e.data.assetRequest||e.data&&e.data.progress||(e.data&&e.data.debug?i.logger.debug(e.data.message):e.data&&e.data.error?(p.loading=!1,p.streamingWorker.terminate(),p.streamingWorker=null,r&&r(e.data.error)):(i.logger.error("F2D download failed.",Object(s.errorCodeString)(s.ErrorCodes.NETWORK_FAILURE)),p.loading=!1,p.streamingWorker.terminate(),p.streamingWorker=null))}},A=function(e){if(p.isValid()&&(g&&n&&(g=!1,n()),e.data&&e.data.f2d)){p.svf=e.data.f2d;var t=e.data.f2d.geometry;E(),i.logger.info("Num polylines: "+t.numPolylines),i.logger.info("Line segments: "+t.numLineSegs),i.logger.info("Circular arcs: "+t.numCircles),i.logger.info("Ellipitcal arcs:"+t.numEllipses),p.onModelRootLoadDone(p.svf),r&&r(null,p.model),p.viewer3DImpl.api.dispatchEvent({type:f.MODEL_ROOT_LOADED_EVENT,svf:p.svf,model:p.model}),p.onGeomLoadDone()}},M=function(e){if(p.isValid()){g&&n&&(g=!1,n());var t,o;if(e.data&&e.data.f2d){for(t=p.svf=e.data.f2d,E(),i.logger.info("Num polylines: "+t.numPolylines),i.logger.info("Line segments: "+t.numLineSegs),i.logger.info("Circular arcs: "+t.numCircles),i.logger.info("Ellipitcal arcs:"+t.numEllipses),i.logger.info("Plain triangles:"+t.numTriangles),i.logger.info("Total # of op codes generated by fydo.parse: "+t.opCount),p.onModelRootLoadDone(p.svf),r&&r(null,p.model),p.viewer3DImpl.api.dispatchEvent({type:f.MODEL_ROOT_LOADED_EVENT,svf:p.svf,model:p.model}),o=0;o<t.meshes.length;o++)p.processReceivedMesh2D(t.meshes[o],o);t.meshes=null,p.onGeomLoadDone(),p.loading=!1}else if(e.data&&e.data.f2dframe){var a=0;if(e.data.meshes){var l=e.data.bbox;p.svf.bbox=new v.Box3(l.min,l.max),a=e.data.baseIndex}else p.svf=e.data.f2dframe,a=e.data.baseIndex;if(t=p.svf,t.fragments&&t.fragments.initialized||(p.onModelRootLoadDone(t),r&&r(null,p.model),p.viewer3DImpl.api.dispatchEvent({type:f.MODEL_ROOT_LOADED_EVENT,svf:t,model:p.model})),e.data.meshes&&e.data.meshes.length)for(o=0;o<e.data.meshes.length;o++)p.processReceivedMesh2D(e.data.meshes[o],a+o);if(e.data.finalFrame){var c=e.data.cumulativeProps;for(var u in c)t[u]=c[u];E(),p.onGeomLoadDone(),p.loading=!1}}else e.data&&e.data.progress||(e.data&&e.data.debug?i.logger.debug(e.data.message):e.data&&e.data.error?(p.loading=!1,E(),i.logger.error("Error while processing F2d: "+JSON.stringify(e.data.error.args)),r&&r(e.data.error)):(i.logger.error("F2D download failed.",Object(s.errorCodeString)(s.ErrorCodes.NETWORK_FAILURE)),p.loading=!1,E()))}};this.streamingWorker.addEventListener("message",S,!1);var T=t.outputType===x.GEOMETRY?A:M;this.parsingWorker.addEventListener("message",T,!1);var C={operation:_,url:o,objectIds:t.ids,queryParams:this.queryParams};return this.streamingWorker.doOperation(m.endpoint.initLoadContext(C)),!0},n.prototype.processReceivedMesh=function(e){var t=e.packId+":"+e.meshIndex,r=this.svf,n=r.fragments,s=n.mesh2frag[t];if(void 0===s)return void i.logger.warn("Mesh "+t+" was not referenced by any fragments.");Array.isArray(s)||(s=[s]);var a=e.mesh;if(o.BufferGeometryUtils.meshToGeometry(e),e.geometry.unpackXform=a.unpackXform,a.texData){var l=new v.DataTexture(new Uint8Array(a.texData.buffer),a.texData.length,1,v.RGBAFormat,v.UnsignedByteType,v.UVMapping,v.ClampToEdgeWrapping,v.ClampToEdgeWrapping,v.NearestFilter,v.NearestFilter,0);l.generateMipmaps=!1,l.flipY=!1,l.needsUpdate=!0,e.geometry.tIdColor=l,e.geometry.vIdColorTexSize=new v.Vector2(a.texData.length,1)}var c=s.length,u=this.model;u.getGeometryList().addGeometry(e.geometry,c,e.meshIndex+1);for(var d=e.geometry.attributes.index.array||e.geometry.ib,h=d.length/3,f=0;f<s.length;f++){var p=0|s[f];u.getFragmentList().getOriginalWorldMatrix(p,this.tmpMatrix),this.options.placementTransform&&(this.tmpMatrix=(new v.Matrix4).multiplyMatrices(this.options.placementTransform,this.tmpMatrix));var m=n.materials[p].toString();n.polygonCounts&&(n.polygonCounts[p]=h);var g=this.viewer3DImpl.setupMesh(this.model,e.geometry,m,this.tmpMatrix);u.activateFragment(p,g)}n.mesh2frag[t]=null,n.numLoaded+=s.length;var y=n.numLoaded;r.geomPolyCount>r.nextRepaintPolys&&(r.numRepaints++,r.nextRepaintPolys+=1e4*Math.pow(1.5,r.numRepaints),this.viewer3DImpl.invalidate(!1,!0)),y%20==0&&this.viewer3DImpl.invalidate(!1,!0)},n.prototype.processReceivedMesh2D=function(e,t){t>=this.bufferCount&&(this.bufferCount=t+1);var r={mesh:e,is2d:!0,packId:"0",meshIndex:t},n="0:"+t,i=this.svf.fragments;if(!i.fragId2dbId[t]){var o=Object.keys(r.mesh.dbIds).map(function(e){return parseInt(e)});i.fragId2dbId[t]=o;for(var s=0;s<o.length;s++){var a=o[s],l=i.dbId2fragId[a];Array.isArray(l)?l.push(t):"undefined"!=typeof l?i.dbId2fragId[a]=[l,t]:i.dbId2fragId[a]=t}e.material.modelScale=this.modelScale,e.material.opacity=this.options.opacity,e.material.doNotCut=this.options.doNotCut;var c=this.viewer3DImpl;i.materials[t]=this.viewer3DImpl.matman().create2DMaterial(this.model,e.material,!1,!1,function(e,t){var r=t.getData();p.TextureLoader.requestsInProgress()||!r.loadDone||r.texLoadDone||(r.texLoadDone=!0,c.onTextureLoadComplete(t)),Object(h.isMobileDevice)()&&p.TextureLoader.requestsInProgress()||c.invalidate(!1,!0,!1)}),i.length++}i.mesh2frag[n]=t,this.processReceivedMesh(r)},n.prototype.onModelRootLoadDone=function(e){e.fragments={},e.fragments.mesh2frag={},e.fragments.materials=[],e.fragments.fragId2dbId=[],e.fragments.dbId2fragId={},e.fragments.length=0,e.fragments.initialized=!0,e.geomMemory=0,e.fragments.numLoaded=0,e.gpuNumMeshes=0,e.gpuMeshMemory=0,e.nextRepaintPolys=1e4,e.numRepaints=0,e.urn=this.svfUrn,e.acmSessionId=this.acmSessionId,e.basePath="";var t=this.currentLoadPath.lastIndexOf("/");-1!=t&&(e.basePath=this.currentLoadPath.substr(0,t+1)),e.loadOptions=this.options;var r=Date.now();this.loadTime+=r-this.t0,i.logger.log("SVF load: "+(r-this.t0)),this.t0=r,e.bbox=(new v.Box3).copy(e.bbox);var n=this.model=new g.Model(e);n.loader=this,n.initialize(),this.options.skipPropertyDb||(this.svf.propDbLoader=new d.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api)),i.logger.log("scene bounds: "+JSON.stringify(e.bbox));var o={category:"metadata_load_stats",urn:e.urn,layers:e.layerCount};i.logger.track(o),this.viewer3DImpl.signalProgress(5,a.ProgressState.ROOT_LOADED,this.model),this.viewer3DImpl.invalidate(!1,!1)},n.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0,this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null;var e=Date.now(),t="Fragments load time: "+(e-this.t0);this.loadTime+=e-this.t0,p.TextureLoader.loadModelTextures(this.model,this.viewer3DImpl),this.options.skipPropertyDb||this.loadPropertyDb(),i.logger.log(t);var r={category:"model_load_stats",is_f2d:!0,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,urn:this.svfUrn};i.logger.track(r,!0),this.currentLoadPath=null,this.isf2d=void 0,this.viewer3DImpl.onLoadComplete(this.model)},n.prototype.loadPropertyDb=function(){this.svf.propDbLoader&&this.svf.propDbLoader.load()},n.prototype.is3d=function(){return!1},l.FileLoaderManager.registerFileLoader("f2d",["f2d"],n)},"./src/file-loaders/main/LeafletLoader.js":function(e,t,r){"use strict";function n(e){var t=e;this.isLeafletLoader=!0,this.loading=!1;var r=function(e,t){var r=[80,75,1,2],n=t;if(e[n++]!==r[0]||e[n++]!==r[1]||e[n++]!==r[2]||e[n++]!==r[3])return s.logger.error("invalid file header signature"),null;var i={};return i.version=e[n++],i.os=e[n++],i.needVersion=e[n++]|e[n++]<<8,i.flags=e[n++]|e[n++]<<8,i.compression=e[n++]|e[n++]<<8,i.time=e[n++]|e[n++]<<8,i.date=e[n++]|e[n++]<<8,i.crc32=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.compressedSize=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.plainSize=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.fileNameLength=e[n++]|e[n++]<<8,i.extraFieldLength=e[n++]|e[n++]<<8,i.fileCommentLength=e[n++]|e[n++]<<8,i.diskNumberStart=e[n++]|e[n++]<<8,i.internalFileAttributes=e[n++]|e[n++]<<8,i.externalFileAttributes=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24,i.relativeOffset=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.filename=String.fromCharCode.apply(null,e.slice(n,n+=i.fileNameLength)),i.extraField=e.slice(n,n+=i.extraFieldLength),i.comment=e.slice(n,n+i.fileCommentLength),i.length=n-t,i},n=function(e){var t=[80,75,3,4],r=0;if(e[r++]!==t[0]||e[r++]!==t[1]||e[r++]!==t[2]||e[r++]!==t[3])return s.logger.error("invalid local file header signature"),null;var n={};return n.needVersion=e[r++]|e[r++]<<8,n.flags=e[r++]|e[r++]<<8,n.compression=e[r++]|e[r++]<<8,n.time=e[r++]|e[r++]<<8,n.date=e[r++]|e[r++]<<8,n.crc32=(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,n.compressedSize=(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,n.plainSize=(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,n.fileNameLength=e[r++]|e[r++]<<8,n.extraFieldLength=e[r++]|e[r++]<<8,n.filename=String.fromCharCode.apply(null,e.slice(r,r+=n.fileNameLength)),n.extraField=e.slice(r,r+=n.extraFieldLength),n.length=r,n},u=function(e){var t=n(e),r=t.length,i=t.compressedSize,o=e.slice(r,r+i);return o},m=function(e,t,n){for(var i,o=0,s={},a=null,l=0;n>l;++l){if(i=r(e,o),!i)return null;a&&(a.contentSize=i.relativeOffset-a.relativeOffset),o+=i.length,s[i.filename]=i,a=i}return a.contentSize=t-a.relativeOffset,s},g=function(e,t,r,n,i,o){var s=null,l={};Object(h.isOffline)()||(t&&(s="acmsession="+t),l.range={min:r,max:n+r});var c=Object(h.initLoadContext)({queryParams:s});a.ViewingService.getItem(c,e,i,o,l)};this.continueLoadFile=function(e,r,n,a,c,u){function h(){function a(r){this.bbox=new p.Box3,this.basePath=e,this.is2d=!0;var n=r&&r.paperWidth>=0?r.paperWidth:c.texWidth,o=r&&r.paperHeight>=0?r.paperHeight:c.texHeight;this.pageToModelTransform=c.getPageToModelTransform(n,o),this.metadata={},this.metadata.page_dimensions={};var s=this.metadata.page_dimensions;s.page_width=n,s.page_height=o,s.page_units=r&&r.paperUnits,this.loadDone=!0,this.isLeaflet=!0,t.signalProgress(100,i.ProgressState.LOADING),c.texWidth>0&&(this.maxPixelPerUnit=c.texWidth/c.getQuadWidth(),c.isSimpleImage&&(this.maxPixelPerUnit*=10))}if(!g.loading)return void n({code:o.ErrorCodes.LOAD_CANCELED,msg:"Load canceled"},null);var l=new a(r.loadOptions);l.loadOptions=r,y.getVisibleBounds(l.bbox);var u=new d.Model(l);u.initFromCustomIterator(y),u.loader=g,t.api.dispatchEvent({type:f.MODEL_ROOT_LOADED_EVENT,svf:l,model:u}),y.callWhenRefined(function(){var e=Date.now();l.loadTime=e-g.t0,s.logger.log("SVF load: "+l.loadTime)}),n(null,u),g.loading=!1}var m,g=this;if(r.loadOptions&&r.loadOptions.loadFromZip){var v=r.loadOptions.mime.split("/")[1];m="{z}/{x}_{y}."+v}else m=e;c.initFromLoadOptions(m,r.loadOptions,u);var y=null;a&&a();var _=!c.valid();_&&c.initForSimpleImage(e),c.onRootLoaded=h,c.onDone=n,c.pixelRatio=t.glrenderer().getPixelRatio(),y=new l.ModelIteratorTexQuad(c,t.getMaterials()),y.requestRootTile()},this.loadFile=function(e,t,r,n){if(this.loading)return s.logger.log("Loading of Leaflet already in progress. Ignoring new request."),!1;var i=this;this.options=t,this.t0=Date.now();var a=new l.TexQuadConfig,d=null,f=t.acmSessionId;if(t.loadOptions&&t.loadOptions.loadFromZip){d=function(e,t,r){for(var n,i=e.split("/")[0]-a.levelOffset,o=0;o<a.zips.length;o++)if(i<=a.zips[o].zipMaxLevel){n=a.zips[o];break}if(!n)return r("Failed loading texture - tile's level doesn't exists."),!1;var s=n.fileTable[e];if(!s)return r("Failed loading texture - entry does not exist inside fileTable."),!1;var l={extractImage:u},d=s.relativeOffset,h=s.relativeOffset+s.contentSize;n.rawData?l.rawData=n.rawData.slice(d,h):l.range={min:d,max:h},c.TextureLoader.loadTextureWithSecurity(n.urnZip,p.UVMapping,t,r,f,!0,l)};var v=function(){return t.loadOptions.zips.every(function(e){return Object.keys(e.fileTable).length>0})};t.loadOptions.zips.forEach(function(l){var c=l.centralDirOffset,u=l.centralDirLength,p=l.centralDirEntries,y=function(o){Object(h.isOffline)()&&(l.rawData=o,o=o.slice(c,c+u));var s=m(o,c,p);return s?(l.fileTable=s,void(v()&&i.continueLoadFile(e,t,r,n,a,d))):(r("Failed parsing central directory of the zip.",null),!1)},_=function(e){s.logger.error("Zip download failed: "+e.statusText,Object(o.errorCodeString)(o.ErrorCodes.NETWORK_FAILURE)),r("Zip download failed: "+e.statusText,null)};g(l.urnZip,f,c,u,y,_)})}else d=function(e,t,r){c.TextureLoader.loadTextureWithSecurity(e,p.UVMapping,t,r,f,!0)},this.continueLoadFile(e,t,r,n,a,d);return this.loading=!0,!0},this.dtor=function(){this.loading=!1}}r.r(t),r.d(t,"LeafletLoader",function(){return n});var i=r("./src/application/ProgressState.js"),o=r("./src/file-loaders/net/ErrorCodes.js"),s=r("./src/logger/Logger.js"),a=r("./src/file-loaders/net/Xhr.js"),l=r("./src/wgs/scene/leaflet/ModelIteratorTexQuad.js"),c=r("./src/file-loaders/main/TextureLoader.js"),u=r("./src/application/FileLoaderManager.js"),d=r("./src/application/Model.js"),h=r("./src/file-loaders/net/endpoints.js"),f=r("./src/application/EventTypes.js"),p=(r.n(f),r("./thirdparty/three.js/three.js"));r.n(p);n.prototype.is3d=function(){return!1},u.FileLoaderManager.registerFileLoader("Leaflet",["jpeg","jpg","png"],n)},"./src/file-loaders/main/OtgLoader.js":function(e,t,r){"use strict";function n(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){function s(e){n(l,i,o,s,a,"next",e)}function a(e){n(l,i,o,s,a,"throw",e)}var l=e.apply(t,r);s(void 0)})}}function o(e){this.viewer3DImpl=e,this.loading=!1,this.tmpMatrix=new l.LmvMatrix4,this.tmpBox=new c.LmvBox3,this.logger=d.logger,this.loadTime=0,this.pendingMaterials={},this.pendingMaterialsCount=0,this.pendingMeshes={},this.pendingMeshesCount=0,this.operationsDone=0}function s(e,t){for(var r=t.data.boxes,n=t.data.boxStride,i=r.length/n,o=0,s=0,a=0;i>o;o++,s+=n,a+=6)e[a+0]=r[s+0],e[a+1]=r[s+1],e[a+2]=r[s+2],e[a+3]=r[s+3],e[a+4]=r[s+4],e[a+5]=r[s+5]}function a(e){return Math.floor(100*e.fragsLoaded/e.metadata.stats.num_fragments)}r.r(t),r.d(t,"OtgLoader",function(){return o});var l=r("./src/wgs/scene/LmvMatrix4.js"),c=r("./src/wgs/scene/LmvBox3.js"),u=r("./src/wgs/scene/LmvVector3.js"),d=r("./src/logger/Logger.js"),h=r("./src/file-loaders/main/TextureLoader.js"),f=r("./src/wgs/scene/BVHBuilder.js"),p=r("./src/wgs/scene/MeshFlags.js"),m=r("./src/file-loaders/main/PropDbLoader.js"),g=r("./src/file-loaders/main/WorkerCreator.js"),v=(r.n(g),r("./src/file-loaders/net/endpoints.js")),y=r("./src/file-loaders/net/Xhr.js"),_=r("./src/file-loaders/lmvtk/otg/Otg.js"),b=r("./src/application/FileLoaderManager.js"),x=r("./src/application/Model.js"),w=r("./src/application/EventTypes.js"),E=(r.n(w),r("./src/application/ProgressState.js")),S=r("./src/compat.js"),A=r("./src/file-loaders/main/OtgResourceCache.js"),M=r("./src/file-loaders/lmvtk/common/StringUtils.js"),T="LOAD_OTG_BVH";o.prototype.dtor=function(){this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,d.logger.debug("SVF loader dtor: on init worker script.")),this.bvhWorker&&(this.bvhWorker.clearAllEventListenerWithIntercept(),this.bvhWorker.terminate(),this.bvhWorker=null,d.logger.debug("SVF loader dtor: on svf worker.")),this.svf&&(!this.svf.loadDone,this.svf.abort(),this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null)),this.viewer3DImpl.geomCache()&&this.model&&(this.loading&&this.viewer3DImpl.geomCache().cancelRequests(this.svf.geomMetadata.hashToIndex),this.removeMeshReceiveListener()),this.viewer3DImpl=null,this.model=null,this.svf=null,this.logger=null,this.tmpMatrix=null,this.loading=!1,this.loadTime=0},o.prototype.isValid=function(){return null!=this.viewer3DImpl},o.prototype.removeMeshReceiveListener=function(){this.meshReceiveListener&&(this.viewer3DImpl.geomCache().updateMruTimestamps(),this.viewer3DImpl.geomCache().removeEventListener(A.MESH_RECEIVE_EVENT,this.meshReceiveListener),this.viewer3DImpl.geomCache().removeEventListener(A.MESH_FAILED_EVENT,this.meshReceiveListener),this.viewer3DImpl.geomCache().removeEventListener(A.MATERIAL_RECEIVE_EVENT,this.materialReceiveListener),this.viewer3DImpl.geomCache().removeEventListener(A.MATERIAL_FAILED_EVENT,this.materialReceiveListener),this.meshReceiveListener=null)},o.prototype.loadFile=function(e,t,r,n){if(!this.viewer3DImpl)return d.logger.log("SVF loader was already destructed. So no longer usable."),!1;if(this.loading)return d.logger.log("Loading of SVF already in progress. Ignoring new request."),!1;if(this.loading=!0,t.acmSessionId)this.svfUrn=t.acmSessionId.split(",")[0];else{var i=e.indexOf(_.FLUENT_URN_PREFIX);if(-1===i&&(i=e.indexOf(_.DS_OTG_CDN_PREFIX)),-1!==i){var o=e.split("/"),s=o[1],a=o[2],l=s+"?version="+a,c=btoa(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");this.svfUrn=c}}this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e;var u="",h=this.currentLoadPath.lastIndexOf("/");-1!=h&&(u=this.currentLoadPath.substr(0,h+1)),this.basePath=u,this.acmSessionId=t.acmSessionId,this.options=t,this.queryParams=t.acmSessionId?"acmsession="+t.acmSessionId:"";var f={basePath:u,objectIds:t.ids,globalOffset:t.globalOffset,fragmentTransformsDouble:t.fragmentTransformsDouble,placementTransform:t.placementTransform,applyRefPoint:t.applyRefPoint,queryParams:this.queryParams,bvhOptions:t.bvhOptions||{isWeakDevice:Object(S.isMobileDevice)()},applyScaling:t.applyScaling,loadInstanceTree:t.loadInstanceTree};return this.loadContext=Object(v.initLoadContext)(f),f.raiseError=function(e,t,n){var i={code:e,msg:t,args:n};r&&r(i)},f.onFailureCallback=y.ViewingService.defaultFailureCallback.bind(f),this.loadModelRoot(f,r),n&&n(),!0},o.prototype.loadModelRoot=function(e,t){this.t0=(new Date).getTime(),this.firstPixelTimestamp=null;var r=this,n=!1,i={};this.initWorkerScriptToken=Object(g.initWorkerScript)(function(){n=!0;for(var t in i)i.hasOwnProperty(t)&&i[t].forEach(function(r){e.onLoaderEvent(t,r)});i={}});var o=this.svf=new _.OtgPackage;return o.basePath=e.basePath,e.onLoaderEvent=function(e,s){if(r.svf){if(!n)return i.hasOwnProperty(e)||(i[e]=[]),void i[e].push(s);if("otg_root"===e){r.onModelRootLoadDone(o),t&&t(null,r.model),r.makeBVHInWorker();var a=r.viewer3DImpl.geomCache();a||d.logger.error("geomCache is required for loading OTG models."),a.initWorker(r.options.acmSessionId),r.meshReceiveListener=function(e){e.error&&e.error.args?r.onMeshError(e):r.onMeshReceived(e.geom)},a.addEventListener(A.MESH_RECEIVE_EVENT,r.meshReceiveListener),a.addEventListener(A.MESH_FAILED_EVENT,r.meshReceiveListener),r.materialReceiveListener=function(e){!e.error&&e.material&&e.material.length?r.onMaterialLoaded(Object(M.blobToJson)(e.material),e.hash):r.onMaterialLoaded(null,e.hash)},a.addEventListener(A.MATERIAL_RECEIVE_EVENT,r.materialReceiveListener),a.addEventListener(A.MATERIAL_FAILED_EVENT,r.materialReceiveListener),r.svf.loadDone=!1}else if("fragment"===e)r.options.skipMeshLoad||r.tryToActivateFragment(s,"fragment"),r.options.onFragmentListLoadProgress&&r.trackFragmentListLoadProgress();else if("all_fragments"===e)r.options.skipPropertyDb||r.loadPropertyDb(),r.viewer3DImpl.api.fireEvent({type:w.MODEL_ROOT_LOADED_EVENT,svf:o,model:r.model}),r.options.skipMeshLoad||!r.svf.fragments.length?r.onGeomLoadDone():r.onOperationComplete();else if("bvh"===e){var l=s;r.model&&(r.model.setBVH(l.nodes,l.primitives,r.options.bvhOptions),r.viewer3DImpl&&r.viewer3DImpl.modelVisible(r.model.id)&&r.viewer3DImpl.invalidate(!1,!0)),r.onOperationComplete()}}},o.beginLoad(e,Object(y.pathToURL)(r.currentLoadPath)),!0},o.prototype.makeBVHInWorker=function(){var e=this;e.bvhWorker=Object(g.createWorkerWithIntercept)();var t=function(t){if(t.data.bvh){var r=t.data.bvh;e.model&&(e.svf.bvh=r,e.model.setBVH(new f.NodeArray(r.nodes,r.useLeanNodes),r.primitives,e.options.bvhOptions),e.viewer3DImpl&&e.viewer3DImpl.modelVisible(e.model.id)&&e.viewer3DImpl.invalidate(!1,!0)),e.bvhWorker.clearAllEventListenerWithIntercept(),e.bvhWorker.terminate(),e.bvhWorker=null,e.onOperationComplete()}if(t.data.boxes&&e.model){var n=e.model.myData.fragments;s(n.boxes,t),n.boxesLoaded=!0,e.model.visibleBoundsDirty=!0}};e.bvhWorker.addEventListenerWithIntercept(t);var r=Object.assign({},e.loadContext);r.operation=T,r.raiseError=null,r.onFailureCallback=null,r.onLoaderEvent=null,r.fragments_extra=Object(y.pathToURL)(e.basePath)+e.svf.manifest.assets.fragments_extra,r.placementTransform=e.svf.placementTransform,r.placementWithOffset=e.svf.placementWithOffset,r.fragmentTransformsOffset=e.svf.metadata.fragmentTransformsOffset,r.globalOffset=e.svf.globalOffset,r.fragments_extra?e.bvhWorker.doOperation(r):e.onOperationComplete()},o.prototype.tryToActivateFragment=function(e,t){var r=this.svf,n=this.model;if(n){var i=r.fragments.visibilityFlags[e],o=i&p.MeshFlags.MESH_NOTLOADED;if(o)return n.getFragmentList().setFlagFragment(e,p.MeshFlags.MESH_NOTLOADED,!0),void this.trackGeomLoadProgress(r,e,!1);var s=!1,a=r.fragments.materials[e],l=r.getMaterialHash(a),c=this.findOrLoadMaterial(n,l,a);c||("fragment"===t&&this.pendingMaterials[l].push(e),"material"!==t&&(s=!0));var u=r.fragments.geomDataIndexes[e];if(0===u)return void((c||"material"===t)&&this.trackGeomLoadProgress(r,e,!1));n.getFragmentList().getOriginalWorldMatrix(e,this.tmpMatrix);var d=n.getGeometryList().getGeometry(u);if(d||("fragment"===t&&this.loadGeometry(u,e),s=!0),!s){var h=this.viewer3DImpl.setupMesh(n,d,l,this.tmpMatrix);h.geomId=u,n.activateFragment(e,h,!!r.placementTransform),this.viewer3DImpl.geomCache().updateGeomImportance(n,e),this.trackGeomLoadProgress(r,e,!1)}}},o.prototype.onModelRootLoadDone=function(e){e.isOTG=!0,e.geomMetadata.hashToIndex={},e.failedFrags={},e.failedMeshes={},e.failedMaterials={},e.geomMemory=0,e.gpuNumMeshes=0,e.gpuMeshMemory=0,e.fragsLoaded=0,e.fragsLoadedNoGeom=0,e.nextRepaintPolys=0,e.numRepaints=0,e.urn=this.svfUrn,e.acmSessionId=this.acmSessionId,e.basePath=this.basePath,e.loadOptions=this.options;var t=Date.now();this.loadTime+=t-this.t0,d.logger.log("SVF load: "+(t-this.t0));var r=this.model=new x.Model(e);if(r.loader=this,r.initialize(),this.t0=t,e.bbox=(new c.LmvBox3).copy(e.bbox),e.refPointTransform&&(e.refPointTransform=new l.LmvMatrix4(!0).copy(e.refPointTransform)),e.placementTransform&&(e.placementTransform=new l.LmvMatrix4(!0).copy(e.placementTransform)),e.cameras)for(var n=0;n<e.cameras.length;n++){var i=e.cameras[n];i.position=(new u.LmvVector3).copy(i.position),i.target=(new u.LmvVector3).copy(i.target),i.up=(new u.LmvVector3).copy(i.up)}d.logger.log("scene bounds: "+JSON.stringify(e.bbox));var o={category:"metadata_load_stats",urn:e.urn,has_topology:!!e.topology,has_animations:!!e.animations,materials:e.metadata.stats.num_materials,is_mobile:Object(S.isMobileDevice)()};d.logger.track(o),this.viewer3DImpl.signalProgress(5,E.ProgressState.ROOT_LOADED,this.model),e.handleHashListRequestFailures(this.loadContext),
e.propDbLoader=new m.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api)},o.prototype.trackGeomLoadProgress=function(e,t,r){if(r){if(e.failedFrags[t])return;e.failedFrags[t]=1}var n=a(e);e.fragsLoaded++;var i=a(e);i>n&&this.viewer3DImpl.signalProgress(i,E.ProgressState.LOADING,this.model);var o=this.model.getGeometryList();o.geomPolyCount>e.nextRepaintPolys&&(this.firstPixelTimestamp=this.firstPixelTimestamp||Date.now(),e.numRepaints++,e.nextRepaintPolys+=1e5*Math.pow(1.5,e.numRepaints),this.viewer3DImpl.modelVisible(this.model.id)&&this.viewer3DImpl.invalidate(!1,!0)),e.fragsLoaded===e.metadata.stats.num_fragments&&this.onOperationComplete()},o.prototype.trackFragmentListLoadProgress=function(){function e(e){return Math.floor(100*e.fragsLoadedNoGeom/e.metadata.stats.num_fragments)}var t=this.svf,r=e(t);t.fragsLoadedNoGeom++;var n=e(t);n>r&&this.options.onFragmentListLoadProgress(this.model,n)},o.prototype.onOperationComplete=function(){this.operationsDone++,3===this.operationsDone&&this.onGeomLoadDone()},o.prototype.onMaterialLoaded=function(){var e=i(regeneratorRuntime.mark(function t(e,r,n){var i,o,s,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.loading){t.next=2;break}return t.abrupt("return");case 2:if(i=this.pendingMaterials[r]){t.next=5;break}return t.abrupt("return");case 5:if(o=this.viewer3DImpl.matman(),!e){t.next=21;break}return e.hash=r,t.prev=8,t.next=11,o.convertSharedMaterial(this.model,e,r);case 11:s=t.sent,h.TextureLoader.loadMaterialTextures(this.model,s,this.viewer3DImpl),o.hasTwoSidedMaterials()&&this.viewer3DImpl.renderer().toggleTwoSided(!0),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](8),this.svf.failedMaterials[r]=1;case 19:t.next=22;break;case 21:this.svf.failedMaterials[r]=1;case 22:for(a=0;a<i.length;a++)this.tryToActivateFragment(i[a],"material");this.pendingMaterialsCount--,delete this.pendingMaterials[r];case 25:case"end":return t.stop()}},t,this,[[8,16]])}));return function(t,r,n){return e.apply(this,arguments)}}(),o.prototype.findOrLoadMaterial=function(e,t,r){if(this.pendingMaterials[t])return!1;var n=this.svf,i=this.viewer3DImpl.matman(),o=i.findMaterial(e,t);if(o)return!0;this.pendingMaterialsCount++,this.pendingMaterials[t]=[];var s=!!this.loadContext.otg_cdn,a=n.makeSharedResourcePath(this.loadContext.otg_cdn,"materials",t),l=this.viewer3DImpl.geomCache();return l.requestMaterial(a,s,t,r,this.queryParams),!1},o.prototype.loadGeometry=function(e,t){var r=this.svf,n=r.getGeometryHash(e);if(this.pendingMeshes[n])return this.pendingMeshes[n].push(t),!1;this.pendingMeshesCount++,this.pendingMeshes[n]=[t];var i=!!this.loadContext.otg_cdn;r.geomMetadata.hashToIndex[n]=e;var o=r.makeSharedResourcePath(this.loadContext.otg_cdn,"geometry",n),s=this.viewer3DImpl.geomCache();s.requestGeometry(o,i,n,e,this.queryParams)},o.prototype.onMeshError=function(e){var t=e.error.args.hash;this.svf.failedMeshes[t]=1;var r=this.pendingMeshes[t];if(r){for(var n=0;n<r.length;n++)this.trackGeomLoadProgress(this.svf,r[n],!0);delete this.svf.geomMetadata.hashToIndex[t],delete this.pendingMeshes[t],this.pendingMeshesCount--}},o.prototype.onMeshReceived=function(e){var t=this.model;if(t){var r=t.getGeometryList(),n=this.svf.geomMetadata.hashToIndex[e.hash];if(void 0!==n){var i=r.getGeometry(n),o=this.pendingMeshes[e.hash];if(!i){r.addGeometry(e,o&&o.length||1,n),this.svf.loadDone;for(var s=0;s<o.length;s++)this.tryToActivateFragment(o[s],"geom");delete this.svf.geomMetadata.hashToIndex[e.hash],delete this.pendingMeshes[e.hash],this.pendingMeshesCount--}}}},o.prototype.onGeomLoadDone=function(){if(this.svf.loadDone=!0,this.removeMeshReceiveListener(),h.TextureLoader.loadModelTextures(this.model,this.viewer3DImpl),this.options.skipMeshLoad)return this.currentLoadPath=null,void this.viewer3DImpl.onLoadComplete(this.model);this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null,this.svf.geomMetadata.hashes=null;var e=Date.now(),t="Fragments load time: "+(e-this.t0);this.loadTime+=e-this.t0;var r=this.firstPixelTimestamp-this.t0;if(t+=" (first pixel time: "+r+")",d.logger.log(t),this.options.useConsolidation){var n=this.viewer3DImpl.glrenderer();this.model.consolidate(this.viewer3DImpl.getMaterials(),this.options.consolidationMemoryLimit,n)}var i={category:"model_load_stats",is_f2d:!1,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.svf.metadata.stats.num_geoms,fragments_count:this.svf.metadata.stats.num_fragments,urn:this.svfUrn};r>0&&(i.first_pixel_time=r),d.logger.track(i,!0),this.currentLoadPath=null,this.viewer3DImpl.onLoadComplete(this.model)},o.prototype.loadPropertyDb=function(){this.svf.propDbLoader.load()},o.prototype.is3d=function(){return!0},b.FileLoaderManager.registerFileLoader("json",["json"],o)},"./src/file-loaders/main/OtgResourceCache.js":function(e,t,r){"use strict";r.r(t),function(e){function n(e){var t=Object(c.initLoadContext)(e);return t.disableIndexedDb=y,t.disableWebSocket=_,t.isInlineWorker=Autodesk.Viewing.Private.ENABLE_INLINE_WORKER,t}function i(e,t){return e.importance-t.importance}function o(){function t(){L=!1}function r(e){if(e.data){if(A.waitingTasks.length&&!S&&(S=setTimeout(c,0)),e.data.error){var t=e.data.error,r=t.args?t.args.hash:void 0,n=t.args?t.args.type:"g";return void(r&&("m"===n?(h.set(r,t),M.fireEvent({type:v,error:t})):(u.set(r,t),M.fireEvent({type:m,error:t})),delete y[t.hash],w--))}if(e.data.material){var i=e.data,r=i.hash,o=i.material;h.set(r,o),M.fireEvent({type:g,material:o,hash:r}),delete y[i.hash],w--}else for(var s=e.data,l=0;l<s.length;l++){var i=s[l];if(i.hash&&i.mesh){a.BufferGeometryUtils.meshToGeometry(i);var r=i.hash,d=i.geometry;u.set(r,d),M.byteSize+=d.byteSize,M.cleanup(),M.fireEvent({type:p,geom:d}),delete y[i.hash]}w--}}}function o(e){return"number"==typeof e?e%_:0|Math.random()*_}function c(){var e=E*_-w;if(0===e)return void(S=setTimeout(c,30));var t=A.updateRequestPriorities();t||(e=Math.min(e,10*_));for(var r=[],i=0;!A.isEmpty()&&e>i;){var s=A.takeTask(),a=o(s.geomIdx),l=r[a];l?(l.urls.push(s.url),l.hashes.push(s.hash)):(l={operation:"LOAD_CDN_RESOURCE_OTG",type:"g",urls:[s.url],hashes:[s.hash],isCDN:s.isCDN,queryParams:s.queryParams},r[a]=l),i++}for(var u=0;u<r.length;u++){var l=r[u];l&&(b[u].doOperation(n(l)),w+=l.urls.length)}S=void 0}for(var u=new Map,h=new Map,y={},_=Object(s.isMobileDevice)()?2:8,b=[],x=0;_>x;x++)b.push(Object(l.createWorkerWithIntercept)());this.initialized=!0,this.byteSize=0,this.refCount=0;var w=0,E=100,S=void 0,A=new f.OtgPriorityQueue,M=this,T=1048576,C=100*T,j=50*T,P=0,L=!1,D=[];this.addViewer=function(e){e.addEventListener(d.MODEL_UNLOADED_EVENT,t),D.push(e),A.addViewer(e)},this.removeViewer=function(e){var r=D.indexOf(e);-1!==r&&(e.removeEventListener(d.MODEL_UNLOADED_EVENT,t),A.removeViewer(e),D.splice(r,1)),0===D.length&&this.dtor()},this.dtor=function(){D=[];for(var e=0;_>e;e++)b[e].clearAllEventListenerWithIntercept(),b[e].terminate();this.initialized=!1};for(var x=0;_>x;x++)b[x].addEventListenerWithIntercept(r);this.initWorker=function(e){for(var t=0;_>t;t++){var r={operation:"INIT_WORKER_OTG",authorizeUrns:[e]};b[t].doOperation(n(r))}},this.updateMruTimestamps=function(){for(var e=0;_>e;e++){var t={operation:"UPDATE_MRU_TIMESTAMPS_OTG",endSession:A.isEmpty()};b[e].doOperation(n(t))}},this.requestGeometry=function(t,r,n,i,o){var s=this,a=u.get(n);if(a&&a.args)return void e(function(){return s.fireEvent({type:m,error:a,hash:n,repeated:!0})});if(a)return void e(function(){return s.fireEvent({type:p,geom:a})});var l=y[n];if(l&&l.refcount)return l.importanceNeedsUpdate=!0,void l.refcount++;var d={operation:"LOAD_CDN_RESOURCE_OTG",type:"g",url:t,isCDN:r,hash:n,queryParams:o,importance:0,geomIdx:i,importanceNeedsUpdate:!0,refcount:1};A.addTask(d),y[n]=d,S||(S=setTimeout(c,0))},this.requestMaterial=function(t,r,i,s,a){var l=this,c=h.get(i);if(c&&c.args)return void e(function(){return l.fireEvent({type:v,error:c,hash:i,repeated:!0})});if(c)return void e(function(){return l.fireEvent({type:g,material:c,hash:i})});var u=y[i];if(u&&u.refcount)return void u.refcount++;var d={operation:"LOAD_CDN_RESOURCE_OTG",type:"m",urls:[t],hashes:[i],isCDN:r,queryParams:a,refcount:1};y[i]=d;var f=o(s);b[f].doOperation(n(d)),w++},this.cancelRequests=function(e){for(var t in e){var r=y[t];r&&r.refcount--}for(var n=[],i=0;i<A.waitingTasks.length;i++){var o=A.waitingTasks[i];y[o.hash].refcount?n.push(o):delete y[o.hash]}A.waitingTasks=n},this.updateGeomImportance=function(e,t){return Object(f.updateGeomImportance)(e,t)},this.cleanup=function(){var e=[];if(!(this.byteSize<C)){for(var t=[],r=0;r<D.length;r++){var n=D[r].impl.modelQueue();t=t.concat(n.getModels().concat(D[r].getHiddenModels()))}if(!L){P++;for(var r=0;r<t.length;r++){var o=t[r],s=o.getData();if(o.isOTG()){var a=s.geomMetadata.hashes;if(a)for(var l=a.length/s.geomMetadata.byteStride,c=1;l>c;c++){var d=s.getGeometryHash(c),h=u.get(d);h&&(h.timeStamp=P)}}}e.length>0;for(var d in u){var h=u.get(d);h.timeStamp!==P&&e.push(h)}e.sort(i);for(var f=C-j,r=0;r<e.length&&this.byteSize>=f;r++){var h=e[r];delete u["delete"](h.hash),this.byteSize-=h.byteSize,h.dispose()}r===e.length&&(L=!0),e.length=0}}},this.waitForGeometry=function(e,t){function r(r,a){A.removeUrgent(r),!e[r]!=!0&&(e[r]=a,o++,s>o||(M.removeEventListener(p,n),M.removeEventListener(m,i),t(e)))}function n(e){r(e.geom.hash,e.geom)}function i(e){r(e.error.args.hash,void 0)}var o=0,s=A.makeUrgent(e);if(0===s&&e)return void t(e);c(),this.addEventListener(p,n),this.addEventListener(m,i);for(var a in e){var l=u.get(a);l&&r(a,l)}},this.getGeometry=function(e){return u.get(e)}}r.d(t,"MESH_RECEIVE_EVENT",function(){return p}),r.d(t,"MESH_FAILED_EVENT",function(){return m}),r.d(t,"MATERIAL_RECEIVE_EVENT",function(){return g}),r.d(t,"MATERIAL_FAILED_EVENT",function(){return v}),r.d(t,"OtgResourceCache",function(){return o});var s=r("./src/compat.js"),a=r("./src/wgs/scene/BufferGeometry.js"),l=r("./src/file-loaders/main/WorkerCreator.js"),c=(r.n(l),r("./src/file-loaders/net/endpoints.js")),u=r("./src/application/EventDispatcher.js"),d=r("./src/application/EventTypes.js"),h=(r.n(d),r("./src/globals.js")),f=r("./src/file-loaders/lmvtk/otg/OtgPriorityQueue.js"),p="meshReceived",m="meshFailed",g="materialReceived",v="materialFailed",y="true"===Object(h.getParameterByName)("disableIndexedDb").toLowerCase()||Object(s.getGlobal)().DISABLE_INDEXED_DB,_="true"===Object(h.getParameterByName)("disableWebSocket").toLowerCase()||Object(s.getGlobal)().DISABLE_WEBSOCKET;u.EventDispatcher.prototype.apply(o.prototype)}.call(this,r("./node_modules/timers-browserify/main.js").setImmediate)},"./src/file-loaders/main/PropDbLoader.js":function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){var t=e.data;if(t&&t.debug)return void f.logger.debug(t.message);var r=t&&t.cbId&&R[t.cbId];if(r){if(t.progress)return void(r[2]&&r[2](t.progress));t.error?r[1]&&r[1](t.error):r[0]&&r[0](t.result),delete R[t.cbId]}}function a(e,t,r){var n=I++;return R[n]=[e,t,r],n}function l(e){delete R[e]}function c(){return h}function u(){h&&(h.clearAllEventListenerWithIntercept(),h.terminate(),h=void 0)}function d(){h&&h.doOperation({operation:j,clearCaches:!0})}r.r(t),r.d(t,"getPropWorker",function(){return c}),r.d(t,"shutdownPropWorker",function(){return u}),r.d(t,"clearPropertyWorkerCache",function(){return d}),r.d(t,"PropDbLoader",function(){return k});var h,f=r("./src/logger/Logger.js"),p=r("./src/file-loaders/net/Xhr.js"),m=r("./src/file-loaders/net/ErrorCodes.js"),g=r("./src/application/EventTypes.js"),v=(r.n(g),r("./src/file-loaders/net/endpoints.js")),y=r("./src/wgs/scene/InstanceTree.js"),_=r("./src/wgs/scene/InstanceTreeStorage.js"),b=r("./src/file-loaders/main/WorkerCreator.js"),x=(r.n(b),r("./src/application/EventDispatcher.js")),w="GET_PROPERTIES",E="SEARCH_PROPERTIES",S="FIND_PROPERTY",A="FIND_LAYERS",M="BUILD_EXTERNAL_ID_MAPPING",T="BUILD_LAYER_TO_NODE_ID_MAPPING",C="LOAD_PROPERTYDB",j="UNLOAD_PROPERTYDB",P="DIFF_PROPERTIES",L="USER_FUNCTION",D="LOAD_EXTERNAL_IDS",I=1,R={},O={NotLoaded:0,Available:1,Loading:2,Failed:3},k=function(e,t,r){var n,i,o;this.eventTarget=r||new x.EventDispatcher,this.model=t,this.svf=t&&t.getData(),this.dbPath="",this.sharedDbPath=!1;var s=this.svf&&this.svf.is2d&&this.svf.loadOptions.bubbleNode&&this.svf.loadOptions.bubbleNode.findViewableParent()._getOtgManifest();if(this.svf&&!s&&this.svf.propertydb&&this.svf.propertydb.avs.length){this.dbFiles=this.svf.propertydb;for(var a in this.dbFiles)this.dbFiles[a][0]&&(this.dbFiles[a][0].path=this.dbFiles[a][0].path.replace(/\\/g,"/"));var l=Object(p.pathToURL)(this.svf.basePath);if(e){var c=p.ViewingService.simplifyPath(l+this.svf.propertydb.avs[0].path);if(c=c.slice(0,c.lastIndexOf("/")+1),c===e){var u={};for(var a in this.dbFiles){var d=this.dbFiles[a][0],h=d.path;h=p.ViewingService.simplifyPath(l+h),0===h.indexOf(e)&&(h=h.slice(e.length)),u[a]=[{path:h,isShared:d.isShared}]}this.dbFiles=u,this.dbPath=e,this.sharedDbPath=!0}else this.dbPath=l,this.sharedDbPath=!1}else this.dbPath=l,this.sharedDbPath=!1}else{if(this.sharedDbPath=!0,this.svf&&this.svf.loadOptions.bubbleNode){this.dbPath=e;var m=this.svf.loadOptions.bubbleNode.getPropertyDbManifest();this.dbFiles=m.propertydb,this.needsDbIdRemap=m.needsDbIdRemap}else f.logger.warn("Deprecated shared property database initialization without bubbleNode in Model load options."),this.dbPath=e,this.dbFiles={attrs:[],avs:[],ids:[],values:[],offsets:[]};f.logger.log("Using shared db path "+e)}this.queryParams="";var g=null===(n=this.model)||void 0===n?void 0:null===(i=n.getDocumentNode())||void 0===i?void 0:null===(o=i.getDocument())||void 0===o?void 0:o.getAcmSessionId(this.dbPath);g=g||this.svf.acmSessionId,this.svf&&g&&(this.queryParams="acmsession="+g),this.loadProgress=0,this.cbId=void 0,this.idLoadState=O.NotLoaded,this.waitingForExternalIds=[]};k.prototype.dtor=function(){this.asyncPropertyOperation({operation:j},function(){},function(){});var e=Boolean(this.cbId),t=this.instanceTree||this.propertyDbError;e&&!t&&(l(this.cbId),this.propertyDbError={propDbWasUnloaded:!0},this.eventTarget.dispatchEvent({type:g.OBJECT_TREE_UNAVAILABLE_EVENT,svf:this.svf,model:this.model,target:this})),this.model=null,this.svf=null},k.prototype.processLoadResult=function(e){var t=this;if(e.instanceTreeStorage){var r=new _.InstanceTreeAccess(e.instanceTreeStorage,e.rootId,e.instanceBoxes);t.instanceTree=new y.InstanceTree(r,e.objectCount,e.maxTreeDepth),t.svf&&(t.svf.instanceTree=t.instanceTree,t.instanceTree.setFragmentList(t.model.getFragmentList()))}e.objectCount&&(t.hasObjectProperties=e.objectCount,t.svf&&(t.svf.hasObjectProperties=e.objectCount)),e.dbidOldToNew&&this.model.setDbIdRemap(e.dbidOldToNew),t.onLoadProgress(100),t.eventTarget.dispatchEvent({type:g.OBJECT_TREE_CREATED_EVENT,svf:t.svf,model:t.model,target:t})},k.prototype.processLoadError=function(e){var t=this;t.propertyDbError=e,t.onLoadProgress(100),t.eventTarget.dispatchEvent({type:g.OBJECT_TREE_UNAVAILABLE_EVENT,svf:t.svf,model:t.model,target:t})},k.prototype.load=function(e){var t=this;if(e=e||{},this.svf&&this.svf.instanceTree&&this.svf.instanceBoxes)return void setTimeout(function(){t.processLoadResult(t.svf)},0);h||(h=Object(b.createWorkerWithIntercept)(!0),h.addEventListenerWithIntercept(s));var r=function(e){t.processLoadResult(e)},n=function(e){t.processLoadError(e)},o=function(e){t.onLoadProgress(e.percent)};this.cbId=a(r,n,o);var l=this.svf&&this.svf.loadOptions,c=!(l&&l.disablePrecomputedNodeBoxes),u=!(!l||!l.skipExternalIds);u||(this.idLoadState=O.Available);var d=i({operation:C,dbPath:this.dbPath,sharedDbPath:this.sharedDbPath,propertydb:this.dbFiles,fragToDbId:this.svf&&this.svf.fragments.fragId2dbId,fragBoxes:c&&this.svf&&this.svf.fragments.boxes,needsDbIdRemap:this.needsDbIdRemap,cbId:this.cbId,queryParams:this.queryParams,skipExternalIds:u},e);h.doOperation(Object(v.initLoadContext)(d))},k.prototype.asyncPropertyOperation=function(e,t,r,n){var i=this;if(e.dbPath=this.dbPath,i.instanceTree||i.hasObjectProperties)e.cbId=a(t,r,n),h.doOperation(e);else if(i.propertyDbError)r&&r(i.propertyDbError);else{var o=function s(o){i.eventTarget.removeEventListener(g.OBJECT_TREE_CREATED_EVENT,s),i.eventTarget.removeEventListener(g.OBJECT_TREE_UNAVAILABLE_EVENT,s),i.instanceTree||i.hasObjectProperties||i.propertyDbError?i.asyncPropertyOperation(e,t,r,n):r&&r({code:m.ErrorCodes.UNKNOWN_FAILURE,msg:"Failed to load properties"})};i.eventTarget.addEventListener(g.OBJECT_TREE_CREATED_EVENT,o),i.eventTarget.addEventListener(g.OBJECT_TREE_UNAVAILABLE_EVENT,o)}},k.prototype.getProperties=function(e,t,r){this.idLoadState===O.NotLoaded&&f.logger.warn("Calling getProperties() will cause loading of the potentially large externalIDs file. Use getProperties2() to avoid this warning."),this.getProperties2(e,t,r,{needsExternalId:!0})},k.prototype.getProperties2=function(e,t,r,n){var i=this,o=function(){i.asyncPropertyOperation({operation:w,dbId:e},t,r)};n&&n.needsExternalId?this.loadExternalIds().then(o)["catch"](r):o()},k.prototype.getBulkProperties=function(e,t,r,n,i){var o={ignoreHidden:i,propFilter:t,needsExternalId:!t||t.includes("externalId")};o.needsExternalId&&this.idLoadState===O.NotLoaded&&f.logger.warn("Calling getProperties() will cause loading of the potentially large externalIDs file. Use getProperties2() to avoid this warning."),this.getBulkProperties2(e,o,r,n)},k.prototype.getBulkProperties2=function(e,t,r,n){var i=this;t=t||{};var o=function(){i.asyncPropertyOperation({operation:w,dbIds:e,propFilter:t.propFilter,ignoreHidden:t.ignoreHidden},r,n)};t&&t.needsExternalId?this.loadExternalIds().then(o)["catch"](n):o()},k.prototype.searchProperties=function(e,t,r,n){this.asyncPropertyOperation({operation:E,searchText:e,attributeNames:t},r,n)},k.prototype.findProperty=function(e){var t=this;return new Promise(function(r,n){t.asyncPropertyOperation({operation:S,propertyName:e},r,n)})},k.prototype.diffProperties=function(e,t,r,n,i){this.asyncPropertyOperation({operation:P,dbPath2:e,diffOptions:n},t,r,i)},k.prototype.findLayers=function(){var e=this;return new Promise(function(t,r){e.asyncPropertyOperation({operation:A},t,r)})},k.prototype.getExternalIdMapping=function(e,t,r){var n=this,i=function(){n.asyncPropertyOperation({operation:M,extIdFilter:r},e,t)};return this.loadExternalIds().then(i)},k.prototype.getLayerToNodeIdMapping=function(e,t){this.asyncPropertyOperation({operation:T},e,t)},k.prototype.executeUserFunction=function(e,t){var r=this;if("function"==typeof e)e=e.toString();else if("string"!=typeof e)return Promise.reject("Expected Function or string.");var n;try{n=new Blob([e],{type:"application/javascript"})}catch(i){var o=new BlobBuilder;o.append(e),n=o.getBlob()}var s=URL.createObjectURL(n);return new Promise(function(e,n){r.asyncPropertyOperation({operation:L,userFunction:s,userData:t},e,n)})},k.prototype.isObjectTreeLoaded=function(){return!!this.instanceTree},k.prototype.getObjectTree=function(e,t){var r=this;if(r.instanceTree)e(r.instanceTree);else if(r.propertyDbError)t&&t(r.propertyDbError);else if("hasObjectProperties"in r)r.svf&&r.svf.is2d&&t?t("F2D files do not have an InstanceTree."):e(null);else{var n=function i(){r.eventTarget.removeEventListener(g.OBJECT_TREE_CREATED_EVENT,i),r.eventTarget.removeEventListener(g.OBJECT_TREE_UNAVAILABLE_EVENT,i),r.getObjectTree(e,t)};r.eventTarget.addEventListener(g.OBJECT_TREE_CREATED_EVENT,n),r.eventTarget.addEventListener(g.OBJECT_TREE_UNAVAILABLE_EVENT,n)}},k.prototype.onLoadProgress=function(e){this.eventTarget.dispatchEvent({type:g.OBJECT_TREE_LOAD_PROGRESS_EVENT,percent:e,svf:this.svf,model:this.model,target:this}),this.loadProgress=e},k.prototype.getLoadProgress=function(){return this.loadProgress},k.prototype.isLoadDone=function(){return 100==this.loadProgress},k.prototype.loadExternalIds=function(){var e=this;switch(this.idLoadState){case O.Available:return Promise.resolve();case O.Failed:return Promise.reject();case O.NotLoaded:this.idLoadState=O.Loading;var t=function(){e.idLoadState=O.Available,e.waitingForExternalIds.forEach(function(e){return e.resolve()})},r=function(){e.idLoadState=O.Failed,e.waitingForExternalIds.forEach(function(e){return e.reject()})},n={operation:D,idsFile:this.dbFiles.ids[0],queryParams:this.queryParams};Object(v.initLoadContext)(n),this.asyncPropertyOperation(n,t,r)}return new Promise(function(t,r){e.waitingForExternalIds.push({resolve:t,reject:r})})}},"./src/file-loaders/main/SvfLoader.js":function(e,t,r){"use strict";function n(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){function s(e){n(l,i,o,s,a,"next",e)}function a(e){n(l,i,o,s,a,"throw",e)}var l=e.apply(t,r);s(void 0)})}}r.r(t),r.d(t,"SvfLoader",function(){return j});var o=r("./src/compat.js"),s=r("./src/logger/Logger.js"),a=r("./src/wgs/scene/LmvMatrix4.js"),l=r("./src/file-loaders/net/ErrorCodes.js"),c=r("./src/wgs/scene/BVHBuilder.js"),u=r("./src/wgs/scene/MeshFlags.js"),d=r("./src/wgs/scene/BufferGeometry.js"),h=r("./src/wgs/render/MaterialConverter.js"),f=r("./src/file-loaders/net/Xhr.js"),p=r("./src/file-loaders/main/PropDbLoader.js"),m=r("./src/file-loaders/main/TextureLoader.js"),g=r("./src/file-loaders/main/WorkerCreator.js"),v=(r.n(g),r("./src/application/EventTypes.js")),y=(r.n(v),r("./src/application/Model.js")),_=r("./thirdparty/three.js/three.js"),b=(r.n(_),r("./src/application/FileLoaderManager.js")),x=r("./src/file-loaders/net/endpoints.js"),w=r("./src/application/ProgressState.js"),E=Autodesk.Viewing,S=Object(o.isNodeJS)()?10:Object(o.isMobileDevice)()?2:6,A="LOAD_GEOMETRY",M="LOAD_SVF",T="LOAD_SVF_CONTD",C="FETCH_TOPOLOGY",j=function(e){this.viewer3DImpl=e,this.next_pack=0,this.loading=!1,this.loadedPacksCount=0,this.tmpMatrix=new _.Matrix4,this.tmpBox=new _.Box3,this.fetchingTopology=!1,this.loadTime=0,this.notifiesFirstPixel=!0};j.prototype.dtor=function(){if(this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,s.logger.debug("SVF loader dtor: on init worker script.")),this.svfWorker&&(this.svfWorker.clearAllEventListenerWithIntercept(),this.svfWorker.terminate(),this.svfWorker=null,s.logger.debug("SVF loader dtor: on svf worker.")),this.pack_workers){for(var e=0;e<this.pack_workers.length;e++)this.pack_workers[e].clearAllEventListenerWithIntercept(),this.pack_workers[e].terminate();this.pack_workers=null,s.logger.debug("SVF loader dtor: on geom worker.")}this.svf&&this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null),this.tmpMatrix=null,this.tmpBox=null,this.svf=null,this.model=null,this.next_pack=0,this.loading=!1,this.loadedPacksCount=0,this.loadTime=0,this.viewer3DImpl=null},j.prototype.initWorkerScript=g.initWorkerScript,j.prototype.createWorkerWithIntercept=g.createWorkerWithIntercept,j.prototype.startWorkers=function(){for(var e=this,t=this.svf,r=Math.min(t.geompacks.length,E.NUM_WORKER_THREADS||S),n=0;r>n;n++){var i=t.geompacks[this.next_pack++];i.loading=!0,Object(o.isNodeJS)()?this.loadGeometryPack(i.id,i.uri):!function(t){setTimeout(function(){e.loadGeometryPack(t.id,t.uri)},200*n)}(i)}},j.prototype.createModel=function(e){var t=this.model=new y.Model(e);return t.loader=this,t.initialize(),t},j.prototype.isValid=function(){return this.viewer3DImpl},j.prototype.loadFile=function(e,t,r,n){if(!this.viewer3DImpl)return s.logger.log("SVF loader was already destructed. So no longer usable."),!1;if(this.loading)return s.logger.log("Loading of SVF already in progress. Ignoring new request."),!1;this.loading=!0;var i=e.indexOf("urn:");if(-1!=i){e=decodeURIComponent(e);var o=e.substr(i,e.substr(i).indexOf("/"));s.logger.log("Extracted URN: "+o);var a=o.lastIndexOf(":");this.svfUrn=o.substr(a+1)}else this.svfUrn=e;this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e;var l=this.currentLoadPath.lastIndexOf("/");-1!=l&&(this.basePath=this.currentLoadPath.substr(0,l+1)),this.acmSessionId=t.acmSessionId,this.queryParams="",this.acmSessionId&&(this.queryParams="acmsession="+this.acmSessionId),this.options=t;var c=this;return this.initWorkerScriptToken=this.initWorkerScript(function(){c.loadSvfCB(e,t,r,n)}),!0},j.prototype.loadSvfCB=function(e,t,r,n){this.t0=(new Date).getTime(),this.firstPixelTimestamp=null,this.failedToLoadSomeGeometryPacks=null,this.failedToLoadPacksCount=0;var a=!0,u=this,d={url:Object(f.pathToURL)(e),basePath:this.currentLoadPath,objectIds:t.ids,globalOffset:t.globalOffset,fragmentTransformsDouble:t.fragmentTransformsDouble,placementTransform:t.placementTransform,applyRefPoint:t.applyRefPoint,queryParams:this.queryParams,bvhOptions:t.bvhOptions||{isWeakDevice:Object(o.isMobileDevice)()},applyScaling:t.applyScaling,loadInstanceTree:t.loadInstanceTree};this.viewer3DImpl._signalNoMeshes();var h=this.svfWorker=this.createWorkerWithIntercept(),p=function(){var e=i(regeneratorRuntime.mark(function t(e){var i,o,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=function(){h.clearAllEventListenerWithIntercept(),h.terminate(),u.svfWorker=null,h=null},a&&n&&(a=!1,n()),!e.data||!e.data.manifest){t.next=9;break}u.interceptManifest(e.data.manifest),d.operation=T,d.manifest=e.data.manifest,h.doOperation(d),t.next=26;break;case 9:if(!e.data||!e.data.svf){t.next=25;break}return o=u.svf=e.data.svf,u.failedToLoadSomeGeometryPacks&&(r&&r(u.failedToLoadSomeGeometryPacks),u.failedToLoadSomeGeometryPacks=null),t.next=14,u.onModelRootLoadDone(o);case 14:r&&r(null,u.model),u.viewer3DImpl.api.dispatchEvent({type:v.MODEL_ROOT_LOADED_EVENT,svf:o,model:u.model}),o.loadDone=!1,f=!1,o.metadata&&o.metadata.gltf&&(f=!0),f||(0==o.geompacks.length?u.onGeomLoadDone():u.startWorkers()),1==e.data.progress&&(u.loading=!1,i()),o.fragments.polygonCounts||(o.fragments.polygonCounts=new Int32Array(o.fragments.length)),e.data.bvh&&(o.bvh=e.data.bvh,u.model.setBVH(new c.NodeArray(o.bvh.nodes,o.bvh.useLeanNodes),o.bvh.primitives,u.options.bvhOptions),u.viewer3DImpl.invalidate(!1,!0)),t.next=26;break;case 25:e.data&&e.data.bvh?(u.svf&&!u.svf.bvh&&(u.svf.bvh=e.data.bvh,u.model.setBVH(new c.NodeArray(u.svf.bvh.nodes,u.svf.bvh.useLeanNodes),u.svf.bvh.primitives,u.options.bvhOptions),u.viewer3DImpl.invalidate(!1,!0)),u.loading=!1,i()):e.data&&e.data.mesh?(u.processReceivedMesh(e.data),1===e.data.progress&&(u.onGeomLoadDone(),u.loading=!1,i())):e.data&&e.data.progress?1==e.data.progress&&(u.loading=!1,i()):e.data&&e.data.error?(u.loading=!1,i(),s.logger.error("Error while processing SVF: "+JSON.stringify(e.data.error.args)),r&&r(e.data.error,null)):e.data&&e.data.debug?s.logger.debug(e.data.message):(s.logger.error("SVF download failed.",Object(l.errorCodeString)(l.ErrorCodes.NETWORK_FAILURE)),u.loading=!1,i());case 26:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}();return h.addEventListenerWithIntercept(p),d.operation=M,d.interceptManifest=!!this.interceptManifest,h.doOperation(Object(x.initLoadContext)(d)),!0},j.prototype.loadGeometryPack=function(e,t){var r,n,i,o,a=this;if(this.svf&&this.isValid()){var l=function(e){if(e.data&&e.data.meshes){for(var t=e.data.meshes,r={packId:e.data.packId,meshIndex:0,mesh:null},n=0;n<t.length;n++){var i=t[n];i&&(r.meshIndex=n,r.mesh=i,a.processReceivedMesh(r))}if(e.data.progress>=1){a.pack_workers[e.data.workerId].queued-=1,a.loadedPacksCount++,a.viewer3DImpl.signalProgress(100*a.loadedPacksCount/a.svf.geompacks.length,w.ProgressState.LOADING,a.model);var l=!0;for(o=0;o<a.pack_workers.length;o++)if(0!=a.pack_workers[o].queued){l=!1;break}if(l){for(o=0;o<a.pack_workers.length;o++)a.pack_workers[o].clearAllEventListenerWithIntercept(),a.pack_workers[o].terminate();a.pack_workers=null}a.loadedPacksCount+a.failedToLoadPacksCount==a.svf.geompacks.length&&a.onGeomLoadDone()}}else if(e.data&&e.data.progress){if(a.pack_workers[e.data.workerId].queued-=1,a.next_pack<a.svf.geompacks.length){var c=null;if(!c||c.loading)for(;a.next_pack<a.svf.geompacks.length&&(c=a.svf.geompacks[a.next_pack++],c.loading););c&&!c.loading?(c.loading=!0,a.loadGeometryPack(c.id,c.uri)):(a.viewer3DImpl.modelQueue().enforceBvh=!1,a.svf.fragments.packIds=null)}}else e.data&&e.data.debug?s.logger.debug(e.data.message):e.data&&e.data.error?(++a.failedToLoadPacksCount,a.failedToLoadSomeGeometryPacks={code:e.data.error.code,msg:e.data.error.msg}):a.pack_workers[e.data.workerId].queued-=2},c=this.pack_workers;if(c||(c=this.pack_workers=[]),c.length<(E.NUM_WORKER_THREADS||S)){var u=!0;for(i=0;i<c.length;i++)if(0===c[i].queued){u=!1;break}if(u){var d=this.createWorkerWithIntercept();d.addEventListenerWithIntercept(l),d.queued=0,c.push(d)}}var h=0,p=c[0].queued;for(i=1;i<c.length;i++)c[i].queued<p&&(h=i,p=c[i].queued);r=c[h],r.queued+=2,n=h;var m=Object(f.pathToURL)(this.svf.basePath+t),g={operation:A,url:m,packId:parseInt(e),workerId:n,createWireframe:this.options.createWireframe||this.model.getMetadata("renderEnvironmentDisplayEdges","value",!1),packNormals:this.options.packNormals,queryParams:this.queryParams};r.doOperation(Object(x.initLoadContext)(g))}},j.prototype.processReceivedMesh=function(e){var t=e.packId+":"+e.meshIndex,r=this.svf,n=r.fragments,i=this.model,o=n.mesh2frag[t];if(void 0===o)return void s.logger.warn("Mesh "+t+" was not referenced by any fragments.");Array.isArray(o)||(o=[o]),d.BufferGeometryUtils.meshToGeometry(e),e.geometry.packId=e.packId;for(var a=o.length,l=i.getFragmentList().getGeometryId(o[0]),c=i.getGeometryList().addGeometry(e.geometry,a,l),h=e.geometry.attributes.index.array||e.geometry.ib,f=h.length/3,p=0;p<o.length;p++){var g=0|o[p];if(r.loadOptions.skipHiddenFragments){var v=!(n.visibilityFlags[g]&u.MeshFlags.MESH_VISIBLE);if(v)continue}i.getFragmentList().getOriginalWorldMatrix(g,this.tmpMatrix);var y=n.materials[g].toString(),_=this.viewer3DImpl.matman().findMaterial(i,y);_&&!_.texturesLoaded&&m.TextureLoader.loadMaterialTextures(i,_,this.viewer3DImpl),n.polygonCounts&&(n.polygonCounts[g]=f);var b=this.viewer3DImpl.setupMesh(this.model,e.geometry,y,this.tmpMatrix);i.activateFragment(g,b,!!r.placementTransform)}this.options.onMeshReceived&&this.options.onMeshReceived(this.model,c,o),n.mesh2frag[t]=null,n.numLoaded+=o.length,this.viewer3DImpl._signalMeshAvailable();var x=i.getGeometryList();x.geomPolyCount>r.nextRepaintPolys&&(this.firstPixelTimestamp=this.firstPixelTimestamp||Date.now(),r.numRepaints++,r.nextRepaintPolys+=1e4*Math.pow(1.5,r.numRepaints),this.viewer3DImpl.invalidate(!1,!0))},j.prototype.onModelRootLoadDone=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,l,c,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.geomMemory=0,e.fragments.numLoaded=0,e.gpuNumMeshes=0,e.gpuMeshMemory=0,e.nextRepaintPolys=0,e.numRepaints=0,e.urn=this.svfUrn,e.acmSessionId=this.acmSessionId,e.basePath=this.basePath,e.loadOptions=this.options,e.verylargebbox&&this.viewer3DImpl.setNearRadius(this.options.nearRadius||1),r=Date.now(),this.loadTime+=r-this.t0,s.logger.log("SVF load: "+(r-this.t0)),n=this.createModel(e),this.options.skipPropertyDb||this.loadPropertyDb(),t.next=18,this.convertMaterials(n);case 18:if(i=t.sent,this.viewer3DImpl.matman().hasTwoSidedMaterials()&&this.viewer3DImpl.renderer().toggleTwoSided(!0),
this.t1=r,e.bbox=(new _.Box3).copy(e.bbox),e.refPointTransform&&(e.refPointTransform=new a.LmvMatrix4(!0).copy(e.refPointTransform)),e.placementTransform&&(e.placementTransform=new a.LmvMatrix4(!0).copy(e.placementTransform)),e.cameras)for(l=0;l<e.cameras.length;l++)c=e.cameras[l],c.position=(new _.Vector3).copy(c.position),c.target=(new _.Vector3).copy(c.target),c.up=(new _.Vector3).copy(c.up),isFinite(c.position.x+c.position.y+c.position.z+c.target.x+c.target.y+c.target.z+c.up.x+c.up.y+c.up.z)||(c.target=e.bbox.center(),c.position.copy(c.target),c.position.z+=e.bbox.max.z-e.bbox.min.z,c.up={x:0,y:1,z:0}),isFinite(c.aspect)||(c.aspect=1),isFinite(c.fov)||(c.fov=90),isFinite(c.orthoScale)||(c.orthoScale=1);s.logger.log("scene bounds: "+JSON.stringify(e.bbox)),u={category:"metadata_load_stats",urn:e.urn,has_topology:!!e.topologyPath,has_animations:!!e.animations,cameras:e.cameras?e.cameras.length:0,lights:e.lights?e.lights.length:0,materials:i,is_mobile:Object(o.isMobileDevice)()},s.logger.track(u),this.viewer3DImpl.signalProgress(5,w.ProgressState.ROOT_LOADED,this.model),this.viewer3DImpl.invalidate(!1,!1);case 30:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),j.prototype.convertMaterials=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,o,s,a,l,c,u,d,f,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.viewer3DImpl.matman(),n=e.getData(),i=0,n.materials){t.next=5;break}return t.abrupt("return",i);case 5:if(!n.gltfMaterials){t.next=9;break}s=n.materials.materials;for(o in s)a=s[o],l=h.MaterialConverter.convertMaterialGltf(a,n),c=r._getMaterialHash(e,o),r.addMaterial(c,l,!1),i++;return t.abrupt("return",i);case 9:u=n.materials.materials,d=n.proteinMaterials?n.proteinMaterials.materials:null,t.t0=regeneratorRuntime.keys(u);case 12:if((t.t1=t.t0()).done){t.next=21;break}return o=t.t1.value,f=d&&d[o]&&h.MaterialConverter.isPrismMaterial(d[o]),p=f?d[o]:u[o],t.next=18,r.convertOneMaterial(e,p,r._getMaterialHash(e,o));case 18:i++,t.next=12;break;case 21:return t.abrupt("return",i);case 22:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),j.prototype.makeBVH=function(e){var t=performance.now(),r=e.materials?e.materials.materials:null;e.bvh=new c.BVHBuilder(e.fragments,r),e.bvh.build(this.options.bvhOptions||{isWeakDevice:Object(o.isMobileDevice)()});var n=performance.now();s.logger.log("BVH build time: "+(n-t))},j.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0,m.TextureLoader.loadModelTextures(this.model,this.viewer3DImpl),this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null,this.svf.fragments.visibilityFlags=null;var e=Date.now(),t="Fragments load time: "+(e-this.t1);this.loadTime+=e-this.t0;var r=this.firstPixelTimestamp-this.t0;t+=" (first pixel time: "+r+")",(!this.svf.bvh||this.svf.placementTransform)&&(this.makeBVH(this.svf),this.model.setBVH(this.svf.bvh.nodes,this.svf.bvh.primitives,this.options.bvhOptions)),s.logger.log(t),this.options.useConsolidation&&this.model.consolidate(this.viewer3DImpl.getMaterials(),this.options.consolidationMemoryLimit,this.viewer3DImpl.glrenderer());var n={category:"model_load_stats",is_f2d:!1,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,fragments_count:this.model.getFragmentList().getCount(),urn:this.svfUrn};r>0&&(n.first_pixel_time=r),s.logger.track(n,!0),this.currentLoadPath=null,this.viewer3DImpl.onLoadComplete(this.model)},j.prototype.loadPropertyDb=function(){this.svf.propDbLoader=new p.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api),this.svf.propDbLoader.load()},j.prototype.fetchTopologyFile=function(e,t){function r(e){if(e.data["status-topology"])return i=(new Date).getTime(),a=Math.round((i-c)/1e3),void s.logger.log("Topology file downloaded. ("+a+" seconds). Processing...");var r=e.data["fetch-topology"];r&&(o=(new Date).getTime(),a=Math.round((o-i)/1e3),r.topology?s.logger.log("Topology file processed successfully! ("+a+" seconds)."):s.logger.log("Topology file processed, but an error ocurred. ("+a+" seconds)."),t(r),u.fetchingTopology=!1,n.clearAllEventListenerWithIntercept(),n.terminate(),n=null)}if(!this.fetchingTopology){this.fetchingTopology=!0;var n=this.createWorkerWithIntercept();n.addEventListenerWithIntercept(r);var i,o,a,l={path:e,queryParams:this.queryParams},c=(new Date).getTime();s.logger.log("Fetching topology file..."),l.operation=C,n.doOperation(Object(x.initLoadContext)(l));var u=this}},j.prototype.is3d=function(){return!0},b.FileLoaderManager.registerFileLoader("svf",["svf","gltf","glb"],j)},"./src/file-loaders/main/TextureLoader.js":function(e,t,r){"use strict";function n(e,t){var r,n,i=e.width,o=e.height;if(0===(i&i-1)&&0===(o&o-1)){if(k>=i*o)return void t(e);r=i,n=o}else{for(r=1;i>1.5*r;)r*=2;for(n=1;o>1.5*n;)n*=2}for(;r*n>k;)r=Math.max(r/2,1),n=Math.max(n/2,1);var s=L.createElement("canvas"),a=s.getContext("2d");s.width=r,s.height=n,a.drawImage(e,0,0,r,n);var l=new Image;l.wasNPOT=!0,l.src=s.toDataURL(),l.onload=function(){t(l)},l.onerror=function(e){A.logger.error(e,Object(w.errorCodeString)(w.ErrorCodes.UNKNOWN_FAILURE)),t(null)}}function i(e,t,r){var n=e.width,i=e.height,o=L.createElement("canvas"),s=o.getContext("2d");return s.globalCompositeOperation="copy",o.width=n,o.height=i,t&&(s.fillStyle=r||"#FFFFFF",s.fillRect(0,0,n,i)),s.drawImage(e,0,0,n,i),o}function o(e){return e.format===M.AlphaFormat||e.format===M.RGBAFormat}function s(e){return e.clampS||e.clampT}function a(e){return e.minFilter!==M.NearestFilter&&e.minFilter!==M.LinearFilter}function l(e){e.image.wasNPOT===!0&&o(e)&&s(e)&&a(e)&&Object(x.isChrome)()&&Object(x.isWindows)()&&(e.minFilter=M.LinearFilter,e.generateMipmaps=!1,e.needsUpdate=!0)}function c(e){var t=new Uint8Array(e),r=new Blob([t],{type:"image/jpeg"}),n=P.URL||P.webkitURL;return n.createObjectURL(r)}function u(e,t,r,i,o,s,a){var l=C.endpoint.getUseCredentials(),c=C.endpoint.getUseCookie();l&&c?M.ImageUtils.crossOrigin="use-credentials":C.endpoint.getUseCredentials()?M.ImageUtils.crossOrigin="anonymous":M.ImageUtils.crossOrigin="";var u="";l&&o&&(u="acmsession="+o),a&&a.queryParams&&(u=u?u+"&":"",u+=a.queryParams);var f=C.endpoint.initLoadContext({queryParams:u});I++,D.go(function(o){var u=function(e,t){I--,t&&i?i(t):r(e),o()},p=s?u:function(e){function t(t){e&&(e.image=t),I--,r(e),o()}e&&e.image?n(e.image,t):t()},m=function(e){I--,A.logger.error("Texture load error",e),r(null),o()};if(Object(x.isNodeJS)())return void h(e,f,t,u,a);if(".dds"===e.slice(e.length-4).toLocaleLowerCase())if(Object(x.isIOSDevice)()){var g=e.slice(0,e.length-4)+".pvr";(new PVRLoader).load(g+"?"+f.queryParams,u,m)}else(new T.DDSLoader).load(e+"?"+f.queryParams,u,m);else if(l&&!c||a&&(a.rawData||a.extractImage))d(e,f,t,p,a);else{var v=/(\w+):\/\//gi.exec(e);v&&!/^(https?|file|blob:https?):\/\//gi.test(e)?Autodesk.Viewing.Private.ViewingService.rawGet("","",e,function(r){function n(e){var t=Array.prototype.map.call(e,function(e){return String.fromCharCode(e)}).join("");return btoa(t)}var i=/\.(\w+)$/gi.exec(e);i=i?i[1]:"png";var o="data:image/".concat(i,";base64, ")+n(r);M.ImageUtils.loadTexture(o,t,p,m)},console.error):M.ImageUtils.loadTexture(f.queryParams?e+"?"+f.queryParams:e,t,p,m)}})}function d(e,t,r,n,i){function o(e){i&&i.extractImage&&(e=i.extractImage(e));var t=new Image;a.image=t,l(a),t.onload=function(){a.needsUpdate=!0,n&&n(a),P.URL.revokeObjectURL(t.src)},t.onerror=function(e){A.logger.error(e,Object(w.errorCodeString)(w.ErrorCodes.UNKNOWN_FAILURE)),n&&n(null)},t.src=c(e)}function s(e,t){var r="Error: "+e+" ("+t+")";A.logger.error(r,Object(w.errorCodeString)(w.ErrorCodes.NETWORK_SERVER_ERROR)),n&&n(null,{msg:t,args:e})}var a=new M.Texture(void 0,r);return i&&i.rawData?o(i.rawData):b.ViewingService.getItem(t,e,o,s,i),a}function h(e,t,r,n,i){function o(e){i&&i.extractImage&&(e=i.extractImage(e)),a.image={data:e,width:void 0,height:void 0},a.needsUpdate=!0,n&&n(a)}function s(e,t){var r="Error: "+e+" ("+t+")";A.logger.error(r,Object(w.errorCodeString)(w.ErrorCodes.NETWORK_SERVER_ERROR)),n&&n(null,{msg:t,args:e})}var a=new M.DataTexture(void 0,r);return b.ViewingService.getItem(t,e,o,s),a}function f(e,t,r){function n(e){for(var t=null,r=0;r<o.manifest.assets.length;++r){var n=o.manifest.assets[r];if(n.id.toLowerCase()==e.toLowerCase()){var i=n.URI;-1===i.indexOf("://")&&(i=o.basePath+i),t=Object(b.pathToURL)(i);break}}return t||(t=Object(b.pathToURL)(o.basePath+e)),t}function i(e){var t=C.endpoint.initLoadContext({}),r=o.makeSharedResourcePath(t.otg_cdn,"textures",e);return r}var o=t.getData();e=e.replace(/\\/g,"/");var s=t.isOTG()?i(e):n(e);return u(s,M.UVMapping,r,null,o.acmSessionId)}function p(e,t,r){if(t.textureMaps&&!t.texturesLoaded){t.texturesLoaded=!0;var n=e.getData(),i=t.textureMaps;for(var o in i){var s=i[o];if(!r.matman().loadTextureFromCache(e,t,s,o)){f(s.uri,e,function(t){return function(i){if(i){var o=n.materials.scene.SceneUnit,s=r.renderer()?r.renderer().getMaxAnisotropy():0,a=t.converter||E.MaterialConverter.convertTexture;a(t,i,o,s)}var l=r.matman();l&&(l.setTextureInCache(e,t,i),n.loadOptions.onTextureReceived&&n.loadOptions.onTextureReceived(l,t,i,!v()),!v()&&r&&n.loadDone&&!n.texLoadDone&&(n.texLoadDone=!0,r.onTextureLoadComplete(e)))}}(s))}}}}function m(e,t){var r=t.matman(),n=r._getModelHash(e),i=0;if(e.isOTG())i=e.getData().metadata.stats.num_textures||0;else for(var o in r._materials)if(-1!==o.indexOf(n)){var s=r._materials[o];s.textureMaps&&(i+=Object.keys(s.textureMaps).length)}y(i);for(var o in r._materials)if(-1!==o.indexOf(n)){var s=r._materials[o];p(e,s,t)}var a=e.getData();!v()&&t&&a.loadDone&&!a.texLoadDone&&(a.texLoadDone=!0,t.onTextureLoadComplete(e))}function g(e,t,r){var n,i=function(n){n?(n.mapping=M.CubeReflectionMapping,n.LogLuv=-1!==e.indexOf("logluv"),n.RGBM=-1!==e.indexOf("rgbm"),Object(S.DecodeEnvMap)(n,t,!1,r)):r&&r(n)};return M.ImageUtils.crossOrigin="",Array.isArray(e)?(n=M.ImageUtils.loadTextureCube(e,M.CubeReflectionMapping,i),n.format=M.RGBFormat):"string"==typeof e?-1!==e.toLowerCase().indexOf(".dds")?n=(new T.DDSLoader).load(e,i):(n=M.ImageUtils.loadTexture(e,M.SphericalReflectionMapping,r),n.format=M.RGBFormat):e?r&&r(e):r&&r(null),n}function v(){return I}function y(e){e>=0&&(O=e,k=Math.max(16384,R/(4*O)))}function _(e){var t=4;switch(e.format){case M.AlphaFormat:t=1;break;case M.RGBFormat:t=3;break;case M.LuminanceFormat:t=1;break;case M.LuminanceAlphaFormat:t=2}switch(e.type){case M.ShortType:case M.UnsignedShortType:case M.HalfFloatType:t*=2;break;case M.IntType:case M.UnsignedIntType:case M.FloatType:t*=4;break;case M.UnsignedShort4444Type:case M.UnsignedShort5551Type:case M.UnsignedShort565Type:t=2}var r=t*e.image.width;return r+=e.unpackAlignment-1,r-=r%e.unpackAlignment,e.image.height*r}r.r(t),r.d(t,"TextureLoader",function(){return N});var b=r("./src/file-loaders/net/Xhr.js"),x=r("./src/compat.js"),w=r("./src/file-loaders/net/ErrorCodes.js"),E=r("./src/wgs/render/MaterialConverter.js"),S=r("./src/wgs/render/DecodeEnvMap.js"),A=r("./src/logger/Logger.js"),M=r("./thirdparty/three.js/three.js"),T=(r.n(M),r("./thirdparty/three.js/DDSLoader.js")),C=r("./src/file-loaders/net/endpoints.js"),j=r("./node_modules/pend/index.js"),P=Object(x.getGlobal)(),L=P.document,D=new j;D.max=Object(x.isMobileDevice)()?4:6;var I=0,R=Object(x.isMobileDevice)()?32:1/0;R*=1048576;var O=0,k=1/0,N={loadTextureWithSecurity:u,loadMaterialTextures:p,loadModelTextures:m,loadCubeMap:g,requestsInProgress:v,calculateTextureSize:_,imageToCanvas:i}},"./src/file-loaders/main/WorkerCreator.js":function(e,t,r){var n=r("./src/compat.js"),i=n.isNodeJS,o=n.getGlobal,s=r("./src/globals.js").getResourceUrl;i()?!function(){function t(){return new o}function n(){return t()}function i(e,t){e&&e()}var o=r("../workers/MainWorker-node").MainWorker;e.exports={createWorker:t,initWorkerScript:i,createWorkerWithIntercept:n}}():!function(){function t(){c=null}function r(e,t){if(a.ENABLE_INLINE_WORKER&&!c){if(d.push({successCB:e}),!u){var r=new XMLHttpRequest,n=l,i=s(l);i&&(n=i),r.open("GET",n,!0),r.withCredentials=!1,r.onload=function(){var e=o();u=!1;var t;e.URL=e.URL||e.webkitURL;try{t=new Blob([r.responseText],{type:"application/javascript"})}catch(n){var i=new BlobBuilder;i.append(r.responseText),t=i.getBlob()}c=URL.createObjectURL(t);var s=d.concat();d=[];for(var a=0;a<s.length;++a)s[a].successCB&&s[a].successCB()},u=!0,r.send()}var h={};return h.cancel=function(){var t=-1;return d.some(function(r,n){return r.successCB==e?(t=n,!0):!1})?(d.splice(t,1),!0):!1},h}return e&&e(),null}function n(e){var t;return t=a.ENABLE_INLINE_WORKER?new Worker(c):new Worker(s(l)),t.doOperation=t.postMessage,e===!0&&a.ViewingService.forwardProtocolHandlerToWorker(t),t}function i(e){function t(e){if(!i)return null;for(var t=0;t<i.length;++t)if(i[t].arg===e){var r=i[t].callback;return i.splice(t,1),0===i.length&&(i=null),r}return null}var r=n(e);r.checkEvent=function(e){return e.data&&e.data.assetRequest?!0:!1};var i=[];return r.addEventListenerWithIntercept=function(e){var t=function(t){r.checkEvent(t)||e(t)};return i||(i=[]),i.push({arg:e,callback:t}),r.addEventListener("message",t,!1),t},r.removeEventListenerWithIntercept=function(e){var n=t(e);n&&r.removeEventListener("message",n,!1)},r.clearAllEventListenerWithIntercept=function(){if(i)for(var e=i.concat(),t=0;t<e.length;++t)r.removeEventListenerWithIntercept(e[t].arg)},r}var a=Autodesk.Viewing.Private,l=a.LMV_WORKER_URL||"src/file-loaders/workers/MainWorker-web.js",c=null,u=!1,d=[];e.exports={createWorker:n,initWorkerScript:r,createWorkerWithIntercept:i,clearWorkerDataURL:t}}()},"./src/file-loaders/main/WorkerCreatorWasm.js":function(e,t,r){"use strict";function n(e){function t(e){var t=Autodesk.Viewing.Private;return new Promise(function(r){if(t.ENABLE_INLINE_WORKER){var n=new XMLHttpRequest;n.open("GET",e,!0),n.withCredentials=!1,n.onload=function(){var e,t=a();t.URL=t.URL||t.webkitURL;try{e=new Blob([n.responseText],{type:"application/javascript"})}catch(i){var o=new BlobBuilder;o.append(n.responseText),e=o.getBlob()}r(URL.createObjectURL(e))},n.send()}else r(e)})}function r(e,t,r){return new Promise(function(o,a){var l=n(e,t,s),c=l.channel;l.inUse=!0,r(c.port1),c.port1.onmessage=function(t){l.inUse=!1;var r=t.data.eventType,n=t.data.eventData;"ERROR"===r?a(n):o(n),i(l,s[e])}})}function n(e,t){var r,n;return s&&s.hasOwnProperty(e)?(r=s[e][0],n=r.inUse):(s[e]=[],n=!0),n&&(r={channel:new MessageChannel,inUse:!1},s[e].push(r),t.postMessage({eventType:"SET_CHANNEL_PORT",eventData:{method:e,port:r.channel.port2}},[r.channel.port2])),r}function i(e,t){for(var r=1;r<t.length;r++){var n=t[r],i=n.channel,o=e.channel;if(i===o)return t.splice(r,1),!0}return!1}var s={},l=o("wasm.worker.js");return new Promise(function(n,i){t(l).then(function(t){var s=new Worker(t),a={},l=o(e);s.postMessage({eventType:"INITIALIZE",eventData:l}),s.addEventListener("message",function(e){var t=e.data.eventType;if("INITIALIZED"===t){var i=e.data.eventData;i.forEach(function(e){a[e]=function(){var t=arguments;return r(e,s,function(r){r.postMessage({eventData:{method:e,arguments:Array.from(t)}})})}});var o="getBuffer";return a[o]=function(){return r(o,s,function(e){e.postMessage({eventType:"GET_BUFFER"})})},void n(a)}}),s.addEventListener("error",function(e){i(e)})})})}r.r(t),r.d(t,"loadWasmWorker",function(){return n});var i=r("./src/globals.js"),o=i.getResourceUrl,s=r("./src/compat.js"),a=s.getGlobal},"./src/file-loaders/net/ErrorCodes.js":function(e,t,r){"use strict";function n(e){return"ErrorCode:"+e+"."}function i(e){return 403===e||401===e?o.NETWORK_ACCESS_DENIED:404===e?o.NETWORK_FILE_NOT_FOUND:e>=500?o.NETWORK_SERVER_ERROR:o.NETWORK_UNHANDLED_RESPONSE_CODE}r.r(t),r.d(t,"ErrorCodes",function(){return o}),r.d(t,"errorCodeString",function(){return n}),r.d(t,"getErrorCode",function(){return i});var o={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,BAD_DATA_MODEL_IS_EMPTY:11,RTC_ERROR:12,UNSUPORTED_FILE_EXTENSION:13,VIEWER_INTERNAL_ERROR:14,WEBGL_LOST_CONTEXT:15,LOAD_CANCELED:16}},"./src/file-loaders/net/Xhr.js":function(e,t,r){"use strict";function n(e){var t=e.split("/");if(0==t.length)return e;for(var r=[],n=0;n<t.length;++n){var i=t[n];"."!==i&&(".."===i&&r.length?r.pop():r.push(i))}return 0==r.length?"":r.join("/")}function i(e,t){if(-1!==e.indexOf("://")||0===e.indexOf("urn:"))return e;if(t)return t+e;if("undefined"==typeof window)return e;var r=Object(h.getGlobal)(),n=r.location.pathname,i=n.lastIndexOf("/");n=n.substr(0,i+1);var o=r.location.protocol+"//"+r.location.host+n+e;return o}function o(e,t){for(var r=e.length-t,n=new ArrayBuffer(r),i=new Uint8Array(n,0),o=0,s=t;r>o;o++,s++)i[o]=255&e.charCodeAt(s);return i}function s(e,t){return-1!==t.indexOf("file://")?!1:-1!==t.indexOf("://")?!0:e?!0:void 0}function a(e,t){t.hasOwnProperty("responseType")||(t.responseType="arraybuffer"),t.hasOwnProperty("withCredentials")||(t.withCredentials=!!e.auth),t.headers=e.headers,t.queryParams=e.queryParams,t.endpoint=e.endpoint}r.r(t),r.d(t,"ViewingService",function(){return p}),r.d(t,"pathToURL",function(){return i}),r.d(t,"textToArrayBuffer",function(){return o});var l=r("./src/logger/Logger.js"),c=r("./src/file-loaders/net/ErrorCodes.js"),u=r("./src/file-loaders/lmvtk/common/StringUtils.js"),d=r("./src/file-loaders/net/endpoints.js"),h=r("./src/compat.js"),f=r("./node_modules/pako/index.js"),p={};p.WORKER_REGISTER_FILE_PORT="REGISTER_FILE_PORT",p.WORKER_READ_FILE="READ_FILE";var m=!1;if(p.simplifyPath=n,p.OSS_PREFIX="urn:adsk.objects:os.object:",p.generateUrl=function(e,t,r){if(r=r||"",Object(h.isNodeJS)()&&!s(e,r))return r;r=n(r);var i=r.indexOf("urn:"),o=r.indexOf("?");if(r=-1!=i?-1!==o?r.slice(0,i)+encodeURIComponent(r.slice(i,o))+r.slice(o):r.slice(0,i)+encodeURIComponent(r.slice(i)):encodeURI(r),!t||0!==decodeURIComponent(r).indexOf("urn:"))return s(null,r)?r:e+r;switch("items"!==t&&(r=r.substr(6)),t){case"items":return d.endpoint.getItemApi(e,r);case"bubbles":return d.endpoint.getManifestApi(e,r);case"thumbnails":return d.endpoint.getThumbnailApi(e,r)}},Object(h.isNodeJS)())!function(){function e(e,t,r,o){function s(e){if("json"===o.responseType)try{return JSON.parse(e.toString("utf8"))}catch(t){r(t)}return e}0===e.indexOf("file://")&&(e=e.substr(7)),n.readFile(e,function(n,a){n?r(0,0,{httpStatusText:n,url:e}):31===a[0]&&139===a[1]?i.gunzip(a,null,function(n,i){n?r(0,0,{httpStatusText:n,url:e}):(i=s(i),o.ondata&&o.ondata(i),t(i))}):(a=s(a),o.ondata&&o.ondata(a),t(a))})}function t(e,t){return"gzip"===e.headers["content-encoding"]?!0:t.endsWith(".json.gz")?!0:t.endsWith("FragmentList.pack")?!0:t.endsWith("LightList.bin")?!0:t.endsWith("CameraList.bin")?!0:t.endsWith("CameraDefinitions.bin")?!0:t.endsWith("LightDefinitions.bin")?!0:!1}var n=r("./node_modules/node-libs-browser/mock/empty.js"),i=r("./node_modules/node-libs-browser/mock/empty.js"),o=r("./node_modules/node-libs-browser/mock/empty.js"),a=r("./node_modules/node-libs-browser/mock/empty.js"),u=r("./node_modules/node-libs-browser/mock/empty.js"),d=new o.Agent({keepAlive:!0,keepAliveMsecs:100,maxSockets:10}),h=new a.Agent({keepAlive:!0,keepAliveMsecs:100,maxSockets:10}),f=new o.Agent({maxSockets:10});p.rawGet=function(r,n,m,g,v,y){if(y=y||{},m=p.generateUrl(r,n,m),!s(r,m))return void e(m,g,v,y);if(y.queryParams){var _=-1===m.indexOf("?")?"?":"&";m=m+_+y.queryParams}var b=u.parse(m),x={host:b.hostname,port:b.port,method:y.method||"GET",path:b.path,headers:{},retryCount:0,agent:"https:"===b.protocol?d:h};if(x.host.endsWith(".api.autodesk.com")&&(x.path.startsWith("/derivativeservice")||x.path.startsWith("/modelderivative"))&&(x.agent=f),y.headers)for(var w in y.headers)x.headers[w]=y.headers[w];x.headers["accept-encoding"]||(x.headers["accept-encoding"]="gzip, deflate"),y.range&&(x.headers.Range="bytes="+y.range.min+"-"+y.range.max),(y.ondata||y.onprogress)&&(y.responseType="arraybuffer");var E=("https:"===b.protocol?o:a).request(x,function(e){var r=!(e.statusCode>=200&&e.statusCode<400),n=e;r||!t(e,b.pathname)||y.skipDecompress||(n=e.pipe(i.createGunzip())),"json"!==y.responseType&&"text"!==y.responseType&&y.responseType||n.setEncoding("utf8");var o=[],s=Buffer.allocUnsafe(65536),a=0;n.on("data",function(e){if(y.onprogress){if(e.length+a>s.length){var t=Buffer.allocUnsafe(0|Math.ceil(1.5*s.length));s.copy(t,0,0,a),s=t}e.copy(s,a,0,e.length),a+=e.length;var r=y.onprogress(s,a);return void(r&&E.abort())}o.push(e),y.ondata&&y.ondata(e)}),n.on("end",function(){if(e.statusCode>=200&&e.statusCode<400){if("json"===y.responseType){var t=JSON.parse(o.join(""));return void g(t)}if("text"===y.responseType||""===y.responseType){var r=o.join("");return void g(r)}var n=y.onprogress?s:Buffer.concat(o);if(!y.skipDecompress&&31===n[0]&&139===n[1]){l.logger.warn("An LMV resource ("+m+") was double compressed, or Content-Encoding header missing");try{n=i.gunzipSync(n),a=n.length}catch(u){v(c.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:m,exception:u.toString(),stack:u.stack})}}200===E.status&&y.range&&(n=new Uint8Array(n,y.range.min,y.range.max-y.range.min)),g(n,a)}else v&&v(e.statusCode,e.statusMessage,{url:m})})});E.on("error",function(e){v&&v(e.code,e.message,{url:m})}),y.postData&&E.write(y.postData),E.end()}}();else{var g=r("./node_modules/pend/index.js"),v=new g;v.max=25;var y={},_={},b={};p.registerProtocolPort=function(e,t){if(!/^(http(s)?|file):/gi.test(e)){if(!t)return void(y[e]&&y[e]instanceof MessagePort&&(y[e].onmessage=void 0,y[e]=void 0));y[e]=t,t.onmessage=function(e){var t=e.data.url;if(_[t])if(e.data.error)r.onFailureWrapped(c.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:t,exception:e.data.error.message,stack:e.data.error.stack});else{var r=_[t],n=e.data.buffer;if(_[t]=void 0,31===n[0]&&139===n[1]&&t.match(/(.f2d|.gz)$/gi))try{n=f.ungzip(n),r.options&&r.options.ondata&&r.options.ondata(n),r.onSuccessWrapped(n)}catch(i){r.onFailureWrapped(c.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:t,exception:i.toString(),stack:i.stack})}else r.onSuccessWrapped(n)}else if(b[t]){var o=[];e.data&&e.data.buffer&&e.data.buffer.buffer instanceof ArrayBuffer&&o.push(e.data.buffer.buffer),b[t].postMessage(e.data,o),b[t]=void 0}}}},p.handlerProtocol=function(e,t,r,n,i){var o=y[e];_[t]={onSuccessWrapped:r,onFailureWrapped:n,options:i},o.postMessage({operation:p.WORKER_READ_FILE,url:t})},p.forwardProtocolHandlerToWorker=function(e){var t={},r=new MessageChannel;r.port1.onmessage=function(e){var t=new URL(e.data.url);y[t.protocol].postMessage(e.data),b[t]=r.port1};for(var n in y)y[n]instanceof MessagePort&&(t[n]=r.port2);e.doOperation({operation:p.WORKER_REGISTER_FILE_PORT,protocolPortMap:t},[r.port2])},p.rawGet=function(e,t,r,n,i,o){v.go(function(s){var a=function(){s();for(var e=arguments.length,t=new Array(e),r=0;e>r;r++)t[r]=arguments[r];i&&i.apply(i,t)},l=function(){s();for(var e=arguments.length,t=new Array(e),r=0;e>r;r++)t[r]=arguments[r];n&&n.apply(n,t)},c=/^(\w+:)\/\//gi.exec(r);c&&2==c.length&&y[c[1]]?p.handlerProtocol(c[1],r,l,a,o):p._rawGet(e,t,r,l,a,o)})},p._rawGet=function(e,t,r,n,i,s){function a(e){i&&i(v.status,v.statusText,{url:r})}function d(e){if("json"===s.responseType)try{if(e instanceof Uint8Array)return Object(u.blobToJson)(e);if("string"==typeof e)return JSON.parse(e)}catch(t){}return e}function h(e){if(v.status>=200&&v.status<400)if(v.response&&v.response instanceof ArrayBuffer){var t;if(t=200===v.status&&s.range?new Uint8Array(v.response,s.range.min,s.range.max-s.range.min):new Uint8Array(v.response),!s.skipDecompress&&31===t[0]&&139===t[1]){m||(m=!0,l.logger.warn("An LMV resource ("+r+") was not uncompressed by the browser. This hurts performance. Check the Content-Encoding header returned by the server and check whether you're getting double-compressed streams. The warning prints only once but it's likely the problem affects multiple resources."));try{t=f.ungzip(t)}catch(o){i(c.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:r,exception:o.toString(),stack:o.stack})}}n&&n(d(t))}else{var u=v.response;u||s.responseType&&"text"!==s.responseType||(u=v.responseText),n&&n(d(u))}else a(e)}if(s=s||{},r=p.generateUrl(e,t,r),s.queryParams){var g=-1===r.indexOf("?")?"?":"&";r=r+g+s.queryParams}var v=new XMLHttpRequest;try{var y=s.hasOwnProperty("asynchronous")?s.asynchronous:!0;if(v.open(s.method||(s.noBody?"HEAD":"GET"),r,y),s.hasOwnProperty("responseType")&&(v.responseType=s.responseType),v.withCredentials=!0,s.hasOwnProperty("withCredentials")&&(v.withCredentials=s.withCredentials),s.range&&v.setRequestHeader("Range","bytes="+s.range.min+"-"+s.range.max),s.headers)for(var _ in s.headers)v.setRequestHeader(_,s.headers[_]),"authorization"===_.toLocaleLowerCase()&&(v.withCredentials=!1);y&&(v.onload=h,v.onerror=a,v.ontimeout=a,(s.ondata||s.onprogress)&&(v.overrideMimeType("text/plain; charset=x-user-defined"),s._dlProgress={streamOffset:0},v.onreadystatechange=function(){if(v.readyState>2&&200===v.status)if(s.ondata){var e=v.responseText;if(s._dlProgress.streamOffset>=e.length)return;var t=o(e,s._dlProgress.streamOffset);s._dlProgress.streamOffset=e.length,s.ondata(t)}else if(s.onprogress){var r=s.onprogress(v.responseText);r&&v.abort()}})),v.send(s.postData),y||h()}catch(b){i(v.status,v.statusText,{url:r,exception:b})}}}p.defaultFailureCallback=function(e,t,r){403==e?this.raiseError(c.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:r.url,httpStatus:e,httpStatusText:t}):404==e?this.raiseError(c.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:r.url,httpStatus:e,httpStatusText:t}):e>=500&&600>e?this.raiseError(c.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:r.url,httpStatus:e,httpStatusText:t}):r.exception?this.raiseError(c.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:r.url,exception:r.exception.toString(),stack:r.exception.stack}):this.raiseError(c.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:r.url,httpStatus:e,httpStatusText:t,data:r})},p.getItem=function(e,t,r,n,i){if(i=i||{},a(e,i),i.range&&!e.supportsRangeRequests){var o="start="+i.range.min+"&end="+i.range.max;i.queryParams?i.queryParams+="&"+o:i.queryParams=o,i.range=void 0}p.rawGet(e.endpoint,"items",t,r,n,i)},p.getManifest=function(e,t,r,n,i){i=i||{},i.hasOwnProperty("responseType")||(i.responseType="json"),a(e,i),p.rawGet(e.endpoint,"bubbles",t,r,n,i)},p.getThumbnail=function(e,t,r,n,i){i=i||{},a(e,i);var o=i.queryParams||"",s=[];if(-1===o.indexOf("guid=")&&i.guid&&s.push("guid="+encodeURIComponent(i.guid)),-1===o.indexOf("role=")){var l=i.role||"rendered";s.push("role="+l)}if(-1===o.indexOf("width=")){var c=i.size||400;s.push("width="+c)}if(-1===o.indexOf("height=")){var c=i.size||400;s.push("height="+c)}-1===o.indexOf("acmsession=")&&i.acmsession&&s.push("acmsession="+i.acmsession);var u=s.join("&");i.queryParams?i.queryParams=i.queryParams+"&"+u:i.queryParams=u,p.rawGet(e.endpoint,"thumbnails",t,r,n,i)},p.getACMSession=function(e,t,r,n){var i,o={};for(var s in t)"oauth2AccessToken"===s?i=t[s]:-1!==s.indexOf("x-ads-acm")&&(o[s]=t[s]);o.application="autodesk";var a=new XMLHttpRequest;a.open("POST",e+"/oss-ext/v2/acmsessions",!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer "+i),a.responseType="json",a.onload=function(){if(200===a.status&&a.response){var e="string"==typeof a.response?JSON.parse(a.response):a.response;e&&e.acmsession?r(e.acmsession):n(a.status,"Can't get acm session from response.")}else n(a.status)},a.onerror=n,a.ontimeout=n,a.send(JSON.stringify(o)),delete o.application}},"./src/file-loaders/net/endpoints.js":function(e,t,r){"use strict";function n(){return b}function i(e){b=e}function o(){return x}function s(e){x=e}function a(e){w=e}function l(){return w}r.r(t),r.d(t,"getEnv",function(){return n}),r.d(t,"setEnv",function(){return i}),r.d(t,"isOffline",function(){return o}),r.d(t,"setOffline",function(){return s}),r.d(t,"setOfflineResourcePrefix",function(){return a}),r.d(t,"getOfflineResourcePrefix",function(){return l}),r.d(t,"endpoint",function(){return E}),r.d(t,"initLoadContext",function(){return S});var c=r("./src/compat.js"),u=r("./src/globals.js"),d=Object(c.getGlobal)(),h={},f=null;h.ENDPOINT_API_DERIVATIVE_SERVICE_V2="derivativeV2",h.ENDPOINT_API_MODEL_DERIVATIVE_V2="modelDerivativeV2",h.ENDPOINT_API_FLUENT="fluent";var p={derivativeV2:{baseURL:"/derivativeservice/v2",itemURL:"/derivativeservice/v2/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn"},derivativeV2_EU:{baseURL:"/derivativeservice/v2/regions/eu",itemURL:"/derivativeservice/v2/regions/eu/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/regions/eu/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/eu/thumbnails/:urn"},modelDerivativeV2:{baseURL:"/modelderivative/v2/",itemURL:"/modelderivative/v2/designdata/:urn/manifest/:derivativeurn",manifestURL:"/modelderivative/v2/designdata/:urn/manifest",thumbnailsURL:"/modelderivative/v2/designdata/:urn/thumbnail"},fluent:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"}},m="",g=h.ENDPOINT_API_DERIVATIVE_SERVICE_V2,v=!1,y=!1,_="";h.HTTP_REQUEST_HEADERS={},h.queryParams={},h.setEndpointAndApi=function(e,t){m=e,t&&(g=t)},h.getEndpointAndApi=function(){return m+p[g].baseURL},h.getApiEndpoint=function(){return m},h.getApiFlavor=function(){return g},h.getCdnUrl=function(){return f||(m?m+p[g].cdnURL:void 0)},h.getCdnWebSocketEndpoint=function(){return m+(p[g].cdnWS||"")},h.setCdnUrl=function(e){f=e},h.getCdnRedirectUrl=function(){var e=p[g].cdnRedirectURL;return e?m+e:null},h.setAcmSession=function(e){_=e},h.getAcmSession=function(){return _},h.getManifestApi=function(e,t,r){var n=e||m;return r=r||g,n+=p[r].manifestURL,t=t||"",n=n.replace(":urn",t)},h.getItemApi=function(e,t,r){var n=r||g,i=(e||m)+p[n].itemURL;t=t||"";var o=decodeURIComponent(t);if(-1!==i.indexOf(":urn")){var s=o.split("/"),a=s[0]||"";a=a.split(":"),a=a[a.length-1]||"",i=i.replace(":urn",a)}return n===h.ENDPOINT_API_MODEL_DERIVATIVE_V2&&(t=encodeURIComponent(o)),i=i.replace(":derivativeurn",t)},h.getThumbnailApi=function(e,t,r){var n=(e||m)+p[r||g].thumbnailsURL;return n.replace(":urn",t||"")},h.getUseCredentials=function(){return v},h.getDomainParam=function(){return this.getUseCredentials()&&!Object(c.isNodeJS)()?"domain="+encodeURIComponent(d.location.origin):""},h.addQueryParam=function(e,t){this.queryParams[e]=t},h.deleteQueryParam=function(e){delete this.queryParams[e]},h.getQueryParams=function(e){var t=this.getUseCredentials()&&!Object(c.isNodeJS)()?"domain="+encodeURIComponent(d.location.origin):"",r=Object(u.getParameterByName)("bypassds");r&&(t=t?t+"&bypassds=1":"bypassds=1");var n=[];for(var i in this.queryParams)n.push(encodeURIComponent(i)+"="+encodeURIComponent(this.queryParams[i]));return n.length&&(t?t+="&"+n.join("&"):t=n.join("&")),t&&e&&(e.queryParams?e.queryParams+="&"+t:e.queryParams=t),t},h.setUseCredentials=function(e){v=e},h.setUseCookie=function(e){y=e},h.getUseCookie=function(){return y},h.isOtgBackend=function(){return this.getApiFlavor()===this.ENDPOINT_API_FLUENT},h.initLoadContext=function(e){e=e||{},e.auth=this.getUseCredentials(),e.endpoint||(e.endpoint=this.getApiEndpoint()),e.api||(e.api=this.getApiFlavor()),e.headers||(e.headers={});for(var t in this.HTTP_REQUEST_HEADERS)e.headers[t]=this.HTTP_REQUEST_HEADERS[t];return e.api===this.ENDPOINT_API_FLUENT,
this.getQueryParams(e),e.otg_cdn=f||this.getCdnUrl(),e.otg_ws=this.getCdnWebSocketEndpoint(),e};var b,x=!1,w="",E=h,S=h.initLoadContext.bind(h)},"./src/globalization/i18init.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.r(t),r.d(t,"extendLocalization",function(){return a}),r.d(t,"setLanguage",function(){return l}),r.d(t,"initializeLocalization",function(){return c});var i=r("./src/compat.js"),o=r("./src/globalization/i18next.js"),s=r("./src/globalization/langs.js"),a=(r.n(s),function(e){return null!==e&&"object"===n(e)?(Object.keys(e).forEach(function(t){o.i18n.addResourceBundle(t,"allstrings",e[t],!0,!0)}),!0):!1}),l=function(e,t){var r={lng:e,resGetPath:"res/locales/__lng__/__ns__.json",ns:{namespaces:["allstrings"],defaultNs:"allstrings"},fallbackLng:"en",debug:!1,useCookie:!1};Object(i.getGlobal)().LOCALIZATION_REL_PATH="res/locales/"+e+"/",o.i18n.init(r,function(e){o.i18n.clearDebugLocString(),t&&t()})},c=function(e){var t=e&&e.language||navigator.language,r=s.Lang.getSupported(t);l(r)}},"./src/globalization/i18next.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){O="aaaa",ee()}function o(){O=null,ee()}function s(e,t){if(!t||"function"==typeof t)return e;for(var r in t)e[r]=t[r];return e}function a(e,t,r){var n,i=0,o=e.length,s=void 0===o||"[object Array]"!==Object.prototype.toString.apply(e)||"function"==typeof e;if(r)if(s){for(n in e)if(t.apply(e[n],r)===!1)break}else for(;o>i&&t.apply(e[i++],r)!==!1;);else if(s){for(n in e)if(t.call(e[n],n,e[n])===!1)break}else for(;o>i&&t.call(e[i],i,e[i++])!==!1;);return e}function l(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,function(e){return H[e]}):e}function c(e){var t=function(e){if(I.XMLHttpRequest)return e(null,new XMLHttpRequest);if(I.ActiveXObject)try{return e(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(t){return e(null,new ActiveXObject("Microsoft.XMLHTTP"))}return e(new Error)},r=function(e){if("string"==typeof e)return e;var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")},n=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},i=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=n(e);var r,i,o,s,a,l,c,u="",d=0;do r=e.charCodeAt(d++),i=e.charCodeAt(d++),o=e.charCodeAt(d++),s=r>>2,a=(3&r)<<4|i>>4,l=(15&i)<<2|o>>6,c=63&o,isNaN(i)?l=c=64:isNaN(o)&&(c=64),u+=t.charAt(s)+t.charAt(a)+t.charAt(l)+t.charAt(c),r=i=o="",s=a=l=c="";while(d<e.length);return u},o=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e},s=function c(e,n,i,s){"function"==typeof i&&(s=i,i={}),i.doNotCache=i.doNotCache||!1,i.data=i.data||{},i.headers=i.headers||{},i.jsonp=i.jsonp||!1,i.async=void 0===i.async?!0:i.async;var a,l=o({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},c.headers,i.headers);if(a="application/json"===l["content-type"]?JSON.stringify(i.data):r(i.data),"GET"===e){var u=[];if(a&&(u.push(a),a=null),i.doNotCache&&u.push("_="+(new Date).getTime()),i.jsonp&&(u.push("callback="+i.jsonp),u.push("jsonp="+i.jsonp)),u=u.join("&"),u.length>1&&(n+=n.indexOf("?")>-1?"&"+u:"?"+u),i.jsonp){var d=R.getElementsByTagName("head")[0],h=R.createElement("script");return h.type="text/javascript",h.src=n,void d.appendChild(h)}}t(function(t,r){if(t)return s(t);r.open(e,n,i.async);for(var o in l)l.hasOwnProperty(o)&&r.setRequestHeader(o,l[o]);r.onreadystatechange=function(){if(4===r.readyState){var e=r.responseText||"";if(!s)return;s(r.status,e)}},r.send(a)})},a={authBasic:function(e,t){s.headers.Authorization="Basic "+i(e+":"+t)},connect:function(e,t,r){return s("CONNECT",e,t,r)},del:function(e,t,r){return s("DELETE",e,t,r)},get:function(e,t,r){return s("GET",e,t,r)},head:function(e,t,r){return s("HEAD",e,t,r)},headers:function(e){s.headers=e||{}},isAllowed:function(e,t,r){this.options(e,function(e,n){r(-1!==n.text().indexOf(t))})},options:function(e,t,r){return s("OPTIONS",e,t,r)},patch:function(e,t,r){return s("PATCH",e,t,r)},post:function(e,t,r){return s("POST",e,t,r)},put:function(e,t,r){return s("PUT",e,t,r)},trace:function(e,t,r){return s("TRACE",e,t,r)}},l=e.type?e.type.toLowerCase():"get";a[l](e.url,e,function(t,r){200===t?e.success(r,t,null):e.error(r,t,null)})}function u(e,t){"function"==typeof e&&(t=e,e={}),e=e||{},X.extend(G,e),delete G.fixLng,"string"==typeof G.ns&&(G.ns={namespaces:[G.ns],defaultNs:G.ns}),"string"==typeof G.fallbackNS&&(G.fallbackNS=[G.fallbackNS]),("string"==typeof G.fallbackLng||"boolean"==typeof G.fallbackLng)&&(G.fallbackLng=[G.fallbackLng]),G.interpolationPrefixEscaped=X.regexEscape(G.interpolationPrefix),G.interpolationSuffixEscaped=X.regexEscape(G.interpolationSuffix),G.lng||(G.lng=X.detectLanguage()),G.lng?G.useCookie&&X.cookie.create(G.cookieName,G.lng,G.cookieExpirationTime,G.cookieDomain):(G.lng=G.fallbackLng[0],G.useCookie&&X.cookie.remove(G.cookieName)),B=X.toLanguages(G.lng),k=B[0],X.log("currentLng set to: "+k);var r=S;if(e.fixLng&&(r=function(e,t){return t=t||{},t.lng=t.lng||r.lng,S(e,t)},r.lng=k),K.setCurrentLng(k),G.resStore)return X.each(G.resStore,function(e,t){X.each(t,function(t,r){h(e,t,r)})}),z=!0,void(t&&t(r));var n=X.toLanguages(G.lng);"string"==typeof G.preload&&(G.preload=[G.preload]);for(var i=0,o=G.preload.length;o>i;i++)for(var s=X.toLanguages(G.preload[i]),a=0,l=s.length;l>a;a++)n.indexOf(s[a])<0&&n.push(s[a]);Autodesk.Viewing.i18n.sync.load(n,G,function(e,n){X.each(n,function(e,t){X.each(t,function(t,r){h(e,t,r)})}),z=!0,t&&t(r)})}function d(e,t){"string"==typeof e&&(e=[e]);for(var r=0,n=e.length;n>r;r++)G.preload.indexOf(e[r])<0&&G.preload.push(e[r]);return u(t)}function h(e,t,r){"string"!=typeof t?(r=t,t=G.ns.defaultNs):G.ns.namespaces.indexOf(t)<0&&G.ns.namespaces.push(t),V[e]=V[e]||{},V[e][t]=V[e][t]||{},X.extend(V[e][t],r)}function f(e,t){"string"!=typeof t&&(t=G.ns.defaultNs),V[e]=V[e]||{},V[e][t]={}}function p(e){G.ns.defaultNs=e}function m(e,t){g([e],t)}function g(e,t){var r={dynamicLoad:G.dynamicLoad,resGetPath:G.resGetPath,getAsync:G.getAsync,customLoad:G.customLoad,ns:{namespaces:e,defaultNs:""}},n=X.toLanguages(G.lng);"string"==typeof G.preload&&(G.preload=[G.preload]);for(var i=0,o=G.preload.length;o>i;i++)for(var s=X.toLanguages(G.preload[i]),a=0,l=s.length;l>a;a++)n.indexOf(s[a])<0&&n.push(s[a]);for(var c=[],u=0,d=n.length;d>u;u++){var h=!1,f=V[n[u]];if(f)for(var p=0,m=e.length;m>p;p++)f[e[p]]||(h=!0);else h=!0;h&&c.push(n[u])}c.length?Y._fetch(c,r,function(r,n){var i=e.length*c.length;X.each(e,function(e,r){G.ns.namespaces.indexOf(r)<0&&G.ns.namespaces.push(r),X.each(c,function(e,o){V[o]=V[o]||{},V[o][r]=n[o][r],i--,0===i&&t&&(G.useLocalStorage&&Y._storeLocal(V),t())})})}):t&&t()}function v(e,t,r){return"function"==typeof t?(r=t,t={}):t||(t={}),t.lng=e,u(t,r)}function y(){return k}function _(e,t,r,i){if(!e)return e;if(i=i||t,e.indexOf(i.interpolationPrefix||G.interpolationPrefix)<0)return e;var o=i.interpolationPrefix?X.regexEscape(i.interpolationPrefix):G.interpolationPrefixEscaped,s=i.interpolationSuffix?X.regexEscape(i.interpolationSuffix):G.interpolationSuffixEscaped,a="HTML"+s;return X.each(t,function(t,l){var c=r?r+G.keyseparator+t:t;"object"===n(l)&&null!==l?e=_(e,l,c,i):i.escapeInterpolation||G.escapeInterpolation?(e=e.replace(new RegExp([o,c,a].join(""),"g"),l),e=e.replace(new RegExp([o,c,s].join(""),"g"),X.escape(l))):e=e.replace(new RegExp([o,c,s].join(""),"g"),l)}),e}function b(e,t){var r=",",n="{",i="}",o=X.extend({},t);for(delete o.postProcess;-1!=e.indexOf(G.reusePrefix)&&(U++,!(U>G.maxRecursion));){var s=e.lastIndexOf(G.reusePrefix),a=e.indexOf(G.reuseSuffix,s)+G.reuseSuffix.length,l=e.substring(s,a),c=l.replace(G.reusePrefix,"").replace(G.reuseSuffix,"");if(-1!=c.indexOf(r)){var u=c.indexOf(r);if(-1!=c.indexOf(n,u)&&-1!=c.indexOf(i,u)){var d=c.indexOf(n,u),h=c.indexOf(i,d)+i.length;try{o=X.extend(o,JSON.parse(c.substring(d,h))),c=c.substring(0,u)}catch(f){}}}var p=T(c,o);e=e.replace(l,p)}return e}function x(e){return e.context&&("string"==typeof e.context||"number"==typeof e.context)}function w(e){return void 0!==e.count&&"string"!=typeof e.count&&1!==e.count}function E(e,t){t=t||{};var r=A(e,t),n=C(e,t);return void 0!==n||n===r}function S(e,t){if(t=t||{},!z){X.log("i18next not finished initialization. you might have called t function before loading resources finished.");var r=e.indexOf(":");0>r?r=0:r++;var n=t.defaultValue||e.substr(r);return n&&(n=_(n,t)),n}return U=0,T.apply(null,arguments)}function A(e,t){return void 0!==t.defaultValue?t.defaultValue:e}function M(){for(var e=[],t=1;t<arguments.length;t++)e.push(arguments[t]);return{postProcess:"sprintf",sprintf:e}}function T(e,t){if(t&&"object"!==n(t)?"sprintf"===G.shortcutFunction?t=M.apply(null,arguments):"defaultValue"===G.shortcutFunction&&(t={defaultValue:t}):t=t||{},void 0===e||null===e)return"";"string"==typeof e&&(e=[e]);var r=e[0];if(e.length>1)for(var i=0;i<e.length&&(r=e[i],!E(r,t));i++);var o,s=A(r,t),a=C(r,t),l=t.lng?X.toLanguages(t.lng):B,c=t.ns||G.ns.defaultNs;r.indexOf(G.nsseparator)>-1&&(o=r.split(G.nsseparator),c=o[0],r=o[1]),void 0===a&&G.sendMissing&&(t.lng?Y.postMissing(l[0],c,r,s,l):Y.postMissing(G.lng,c,r,s,l));var u=t.postProcess||G.postProcess;if(void 0!==a&&u&&Q[u]&&(a=Q[u](a,r,t)),O&&void 0!==a)return O;var d=s;if(s.indexOf(G.nsseparator)>-1&&(o=s.split(G.nsseparator),d=o[1]),d===r&&G.parseMissingKey&&(s=G.parseMissingKey(s)),void 0===a&&(s=_(s,t),s=b(s,t),u&&Q[u])){var h=A(r,t);a=Q[u](h,r,t)}return void 0!==a?a:s}function C(e,t){t=t||{};var r,n,i=A(e,t),o=B;if(!V)return i;if("cimode"===o[0].toLowerCase())return i;if(t.lng&&(o=X.toLanguages(t.lng),!V[o[0]])){var s=G.getAsync;G.getAsync=!1,Y.load(o,G,function(e,t){X.extend(V,t),G.getAsync=s})}var a=t.ns||G.ns.defaultNs;if(e.indexOf(G.nsseparator)>-1){var l=e.split(G.nsseparator);a=l[0],e=l[1]}if(x(t)){r=X.extend({},t),delete r.context,r.defaultValue=G.contextNotFound;var c=a+G.nsseparator+e+"_"+t.context;if(n=S(c,r),n!=G.contextNotFound)return _(n,{context:t.context})}if(w(t)){r=X.extend({},t),delete r.count,r.defaultValue=G.pluralNotFound;var u=a+G.nsseparator+e+G.pluralSuffix,d=K.get(o[0],t.count);if(d>=0?u=u+"_"+d:1===d&&(u=a+G.nsseparator+e),n=S(u,r),n!=G.pluralNotFound)return _(n,{count:t.count,interpolationPrefix:t.interpolationPrefix,interpolationSuffix:t.interpolationSuffix})}for(var h,f=e.split(G.keyseparator),p=0,m=o.length;m>p&&void 0===h;p++){for(var g=o[p],v=0,y=V[g]&&V[g][a];f[v];)y=y&&y[f[v]],v++;if(void 0!==y){var E=Object.prototype.toString.apply(y);if("string"==typeof y)y=_(y,t),y=b(y,t);else if("[object Array]"!==E||G.returnObjectTrees||t.returnObjectTrees){if(null===y&&G.fallbackOnNull===!0)y=void 0;else if(null!==y)if(G.returnObjectTrees||t.returnObjectTrees){if("[object Number]"!==E&&"[object Function]"!==E&&"[object RegExp]"!==E){var M="[object Array]"===E?[]:{};X.each(y,function(r){M[r]=T(a+G.nsseparator+e+G.keyseparator+r,t)}),y=M}}else G.objectTreeKeyHandler&&"function"==typeof G.objectTreeKeyHandler?y=G.objectTreeKeyHandler(e,y,g,a,t):(y="key '"+a+":"+e+" ("+g+")' returned an object instead of string.",X.log(y))}else y=y.join("\n"),y=_(y,t),y=b(y,t);"string"==typeof y&&""===y.trim()&&G.fallbackOnEmpty===!0&&(y=void 0),h=y}}if(void 0===h&&!t.isFallbackLookup&&(G.fallbackToDefaultNS===!0||G.fallbackNS&&G.fallbackNS.length>0))if(t.isFallbackLookup=!0,G.fallbackNS.length){for(var j=0,P=G.fallbackNS.length;P>j;j++)if(h=C(G.fallbackNS[j]+G.nsseparator+e,t)){var L=h.indexOf(G.nsseparator)>-1?h.split(G.nsseparator)[1]:h,D=i.indexOf(G.nsseparator)>-1?i.split(G.nsseparator)[1]:i;if(L!==D)break}}else h=C(e,t);return h}function j(){var e,t=[];if("undefined"!=typeof window&&(!function(){for(var e=I.location.search.substring(1),r=e.split("&"),n=0;n<r.length;n++){var i=r[n].indexOf("=");if(i>0){var o=r[n].substring(0,i),s=r[n].substring(i+1);t[o]=s}}}(),t[G.detectLngQS]&&(e=t[G.detectLngQS])),!e&&"undefined"!=typeof R&&G.useCookie){var r=X.cookie.read(G.cookieName);r&&(e=r)}return e||"undefined"==typeof navigator||(e=navigator.language?navigator.language:navigator.userLanguage),e}r.r(t),r.d(t,"i18n",function(){return te});var P=r("./src/globals.js"),L=r("./src/compat.js"),D=Object(L.getGlobal)(),I=D,R=I&&I.document,O=null;Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),r=t.length>>>0;if(0===r)return-1;var n=0;if(arguments.length>0&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&n!=1/0&&n!=-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=r)return-1;for(var i=n>=0?n:Math.max(r-Math.abs(n),0);r>i;i++)if(i in t&&t[i]===e)return i;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),r=t.length>>>0;if(0===r)return-1;var n=r;arguments.length>1&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&n!=1/0&&n!=-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))));for(var i=n>=0?Math.min(n,r-1):r-Math.abs(n);i>=0;i--)if(i in t&&t[i]===e)return i;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var k,N=D,F=N.jQuery||N.Zepto,V={},U=0,B=[],z=!1,G={lng:void 0,load:"current",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"res/locales/__lng__/__ns__.json",resPostPath:"res/locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048e5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,shortcutFunction:"sprintf"},H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},W={create:function(e,t,r,n){var i;if(r){var o=new Date;o.setTime(o.getTime()+60*r*1e3),i="; expires="+o.toGMTString()}else i="";n=n?"domain="+n+";":"",R.cookie=e+"="+t+i+";"+n+"path=/"},read:function(e){for(var t=e+"=",r=R.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null},remove:function(e){this.create(e,"",-1)}},q={create:function(e,t,r,n){},read:function(e){return null},remove:function(e){}},X={extend:F?F.extend:s,each:F?F.each:a,ajax:F?F.ajax:"undefined"!=typeof R?c:function(){},cookie:"undefined"!=typeof R?W:q,detectLanguage:j,escape:l,log:function(e){G.debug&&"undefined"!=typeof console},toLanguages:function(e){var t=[];if("string"==typeof e&&e.indexOf("-")>-1){var r=e.split("-");e=G.lowerCaseLng?r[0].toLowerCase()+"-"+r[1].toLowerCase():r[0].toLowerCase()+"-"+r[1].toUpperCase(),"unspecific"!==G.load&&t.push(e),"current"!==G.load&&t.push(r[0])}else t.push(e);for(var n=0;n<G.fallbackLng.length;n++)-1===t.indexOf(G.fallbackLng[n])&&G.fallbackLng[n]&&t.push(G.fallbackLng[n]);return t},regexEscape:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}};X.applyReplacement=_;var Y={load:function(e,t,r){t.useLocalStorage?Y._loadLocal(e,t,function(n,i){for(var o=[],s=0,a=e.length;a>s;s++)i[e[s]]||o.push(e[s]);o.length>0?Y._fetch(o,t,function(e,t){X.extend(i,t),Y._storeLocal(t),r(null,i)}):r(null,i)}):Y._fetch(e,t,function(e,t){r(null,t)})},_loadLocal:function(e,t,r){var n={},i=(new Date).getTime();if(I.localStorage){var o=e.length;X.each(e,function(e,s){var a=I.localStorage.getItem("res_"+s);a&&(a=JSON.parse(a),a.i18nStamp&&a.i18nStamp+t.localStorageExpirationTime>i&&(n[s]=a)),o--,0===o&&r(null,n)})}},_storeLocal:function(e){if(I.localStorage)for(var t in e)e[t].i18nStamp=(new Date).getTime(),I.localStorage.setItem("res_"+t,JSON.stringify(e[t]))},_fetch:function(e,t,r){var n=t.ns,i={};if(t.dynamicLoad){var o=function(e,t){r(null,t)};if("function"==typeof t.customLoad)t.customLoad(e,n.namespaces,t,o);else{var s=_(t.resGetPath,{lng:e.join("+"),ns:n.namespaces.join("+")});s=Object(P.getResourceUrl)(s),X.ajax({url:s,success:function(e,t,r){X.log("loaded: "+s),o(null,e.json())},error:function(e,t,r){X.log("failed loading: "+s),o("failed loading resource.json error: "+r)},dataType:"text",async:t.getAsync})}}else{var a,l=n.namespaces.length*e.length;X.each(n.namespaces,function(n,o){X.each(e,function(e,n){var s=function(e,t){e&&(a=a||[],a.push(e)),i[n]=i[n]||{},i[n][o]=t,l--,0===l&&r(a,i)};"function"==typeof t.customLoad?t.customLoad(n,o,t,s):Y._fetchOne(n,o,t,s)})})}},_fetchOne:function(e,t,r,n){var i=_(r.resGetPath,{lng:e,ns:t});i=Object(P.getResourceUrl)(i),X.ajax({url:i,success:function(e,t,r){X.log("loaded: "+i);var o=e;n(null,JSON.parse(o))},error:function(e,t,r){if(t&&200==t||e&&e.status&&200==e.status)X.log("There is a typo in: "+i);else if(t&&404==t||e&&e.status&&404==e.status)X.log("Does not exist: "+i);else{var o=t?t:e&&e.status?e.status:null;X.log(o+" when loading "+i)}n(r,{})},dataType:"text",async:r.getAsync})},postMissing:function(e,t,r,n,i){var o={};o[r]=n;var s=[];if("fallback"===G.sendMissingTo&&G.fallbackLng[0]!==!1)for(var a=0;a<G.fallbackLng.length;a++)s.push({lng:G.fallbackLng[a],url:_(G.resPostPath,{lng:G.fallbackLng[a],ns:t})});else if("current"===G.sendMissingTo||"fallback"===G.sendMissingTo&&G.fallbackLng[0]===!1)s.push({lng:e,url:_(G.resPostPath,{lng:e,ns:t})});else if("all"===G.sendMissingTo)for(var a=0,l=i.length;l>a;a++)s.push({lng:i[a],url:_(G.resPostPath,{lng:i[a],ns:t})});for(var c=0,u=s.length;u>c;c++){var d=s[c];X.ajax({url:d.url,type:G.sendType,data:o,success:function(e,i,o){X.log("posted missing key '"+r+"' to: "+d.url);for(var s=r.split("."),a=0,l=V[d.lng][t];s[a];)l=a===s.length-1?l[s[a]]=n:l[s[a]]=l[s[a]]||{},a++},error:function(e,t,n){X.log("failed posting missing key '"+r+"' to: "+d.url)},dataType:"json",async:G.postAsync})}}},K={rules:{ach:{name:"Acholi",numbers:[1,2],plurals:function(e){return Number(e>1)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ak:{name:"Akan",numbers:[1,2],plurals:function(e){return Number(e>1)}},am:{name:"Amharic",numbers:[1,2],plurals:function(e){return Number(e>1)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(e){return Number(0===e?0:1==e?1:2==e?2:e%100>=3&&10>=e%100?3:e%100>=11?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ay:{name:"Aymar\xe1",numbers:[1],plurals:function(e){return 0}},az:{name:"Azerbaijani",numbers:[1,2],plurals:function(e){return Number(1!=e)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bo:{name:"Tibetan",numbers:[1],plurals:function(e){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(e){return Number(e>1)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},cgg:{name:"Chiga",numbers:[1],plurals:function(e){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},de:{name:"German",numbers:[1,2],plurals:function(e){return Number(1!=e)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(e){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(e){return Number(1!=e)}},en:{name:"English",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es:{name:"Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},et:{name:"Estonian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eu:{name:"Basque",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fa:{name:"Persian",numbers:[1],plurals:function(e){return 0}},fi:{name:"Finnish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(e){return Number(e>1)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fr:{name:"French",numbers:[1,2],plurals:function(e){return Number(e>1)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(e){return Number(1==e?0:2==e?1:7>e?2:11>e?3:4)}},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&20>e?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gun:{name:"Gun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(e){return Number(1!=e)}},he:{name:"Hebrew",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hr:{name:"Croatian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(e){return Number(1!=e)}},id:{name:"Indonesian",numbers:[1],plurals:function(e){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(e){return Number(e%10!=1||e%100==11)}},it:{name:"Italian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ja:{name:"Japanese",numbers:[1],plurals:function(e){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(e){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(e){return Number(0!==e)}},ka:{name:"Georgian",numbers:[1],plurals:function(e){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(e){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(e){return 0}},kn:{name:"Kannada",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ko:{name:"Korean",numbers:[1],plurals:function(e){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(e){return Number(1==e?0:2==e?1:3==e?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(e){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(e){return Number(e>1)}},lo:{name:"Lao",numbers:[1],plurals:function(e){return 0}},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(10>e%100||e%100>=20)?1:2)}},lv:{name:"Latvian",numbers:[1,2,0],plurals:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(e){return Number(e>1)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(e){return Number(e>1)}},mi:{name:"Maori",numbers:[1,2],plurals:function(e){return Number(e>1)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(e){return Number(1==e||e%10==1?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(e){return Number(1==e?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ms:{name:"Malay",numbers:[1],plurals:function(e){return 0}},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(e){return Number(1==e?0:0===e||e%100>1&&11>e%100?1:e%100>10&&20>e%100?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nl:{name:"Dutch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(e){return Number(1!=e)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(e){return Number(1!=e)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(e){return Number(e>1)}},or:{name:"Oriya",numbers:[2,1],plurals:function(e){return Number(1!=e)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pap:{name:"Papiamento",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt_br:{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},rm:{name:"Romansh",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(e){return Number(1==e?0:0===e||e%100>0&&20>e%100?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(e){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(e){return Number(1!=e)}},se:{name:"Northern Sami",numbers:[1,2],plurals:function(e){return Number(1!=e)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},son:{name:"Songhay",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sq:{name:"Albanian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(e){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(e){return Number(1!=e)}},te:{name:"Telugu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tg:{name:"Tajik",numbers:[1,2],plurals:function(e){return Number(e>1)}},th:{name:"Thai",numbers:[1],plurals:function(e){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(e){return Number(e>1)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(e){return Number(e>1)}},tt:{name:"Tatar",numbers:[1],plurals:function(e){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(e){return 0}},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(e){return Number(e>1)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(e){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(e){return Number(e>1)}},wo:{name:"Wolof",numbers:[1],plurals:function(e){return 0}},yo:{name:"Yoruba",numbers:[1,2],plurals:function(e){return Number(1!=e)}},zh:{name:"Chinese",numbers:[1],plurals:function(e){return 0}}},addRule:function(e,t){K.rules[e]=t},setCurrentLng:function(e){if(!K.currentRule||K.currentRule.lng!==e){var t=e.split("-");K.currentRule={lng:e,rule:K.rules[t[0]]}}},get:function(e,t){function r(t,r){var n;if(n=K.currentRule&&K.currentRule.lng===e?K.currentRule.rule:K.rules[t]){var i=n.plurals(r),o=n.numbers[i];return 2===n.numbers.length&&1===n.numbers[0]&&(2===o?o=-1:1===o&&(o=1)),o}return 1===r?"1":"-1"}var n=e.split("-");return r(n[0],t)}},Q={},Z=function(e,t){Q[e]=t},J=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var r=[];t>0;r[--t]=e);return r.join("")}var r=function n(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return r.format=function(r,n){var i,o,s,a,l,c,u,d=1,h=r.length,f="",p=[];for(o=0;h>o;o++)if(f=e(r[o]),"string"===f)p.push(r[o]);else if("array"===f){if(a=r[o],a[2])for(i=n[d],s=0;s<a[2].length;s++){if(!i.hasOwnProperty(a[2][s]))throw J('[sprintf] property "%s" does not exist',a[2][s]);i=i[a[2][s]]}else i=a[1]?n[a[1]]:n[d++];if(/[^s]/.test(a[8])&&"number"!=e(i))throw J("[sprintf] expecting number but found %s",e(i));switch(a[8]){case"b":i=i.toString(2);break;case"c":i=String.fromCharCode(i);break;case"d":i=parseInt(i,10);break;case"e":i=a[7]?i.toExponential(a[7]):i.toExponential();break;case"f":i=a[7]?parseFloat(i).toFixed(a[7]):parseFloat(i);break;case"o":i=i.toString(8);break;case"s":i=(i=String(i))&&a[7]?i.substring(0,a[7]):i;break;case"u":i=Math.abs(i);break;case"x":i=i.toString(16);break;case"X":i=i.toString(16).toUpperCase()}i=/[def]/.test(a[8])&&a[3]&&i>=0?"+"+i:i,c=a[4]?"0"==a[4]?"0":a[4].charAt(1):" ",u=a[6]-String(i).length,l=a[6]?t(c,u):"",p.push(a[5]?i+l:l+i)}return p.join("")},r.cache={},r.parse=function(e){for(var t=e,r=[],n=[],i=0;t;){if(null!==(r=/^[^\x25]+/.exec(t)))n.push(r[0]);else if(null!==(r=/^\x25{2}/.exec(t)))n.push("%");else{if(null===(r=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(r[2]){i|=1;var o=[],s=r[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(s)))throw"[sprintf] huh?";for(o.push(a[1]);""!==(s=s.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(s)))o.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(s)))throw"[sprintf] huh?";o.push(a[1])}r[2]=o}else i|=2;if(3===i)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";n.push(r)}t=t.substring(r[0].length);
}return n},r}(),$=function(e,t){return t.unshift(e),J.apply(null,t)};Z("sprintf",function(e,t,r){return r.sprintf?"[object Array]"===Object.prototype.toString.apply(r.sprintf)?$(e,r.sprintf):"object"===n(r.sprintf)?J(e,r.sprintf):e:e});var ee=function(e){function t(e){return[null,e]}var r=e||R;Array.prototype.forEach.call(r.querySelectorAll("[data-i18n]"),function(e){var r=e.getAttribute("data-i18n"),n=t(r),i=n[0],o=n[1],s=S(o);s?i?e.setAttribute(i,s):e.placeholder?e.placeholder=s:e.textContent=s:i?e.setAttribute(i,o):e.textContent=o})},te={init:u,setLng:v,preload:d,addResourceBundle:h,removeResourceBundle:f,loadNamespace:m,loadNamespaces:g,localize:ee,setDefaultNamespace:p,t:S,translate:S,exists:E,detectLanguage:X.detectLanguage,pluralExtensions:K,sync:Y,functions:X,lng:y,addPostProcessor:Z,options:G,setDebugLocString:i,clearDebugLocString:o}},"./src/globalization/langs.js":function(e,t,r){"use strict";function n(){this.names=[{symbol:"en",label:"English"},{symbol:"zh-HANS",label:"Chinese Simplified"},{symbol:"zh-HANT",label:"Chinese Traditional"},{symbol:"ja",label:"Japanese"},{symbol:"cs",label:"Czech"},{symbol:"ko",label:"Korean"},{symbol:"pl",label:"Polish"},{symbol:"ru",label:"Russian"},{symbol:"fr",label:"French"},{symbol:"fr-CA",label:"Canadian French"},{symbol:"de",label:"German"},{symbol:"it",label:"Italian"},{symbol:"nl",label:"Dutch"},{symbol:"es",label:"Spanish"},{symbol:"pt-BR",label:"Portuguese Brazil"},{symbol:"tr",label:"Turkish"},{symbol:"sv",label:"Swedish"},{symbol:"da",label:"Danish"},{symbol:"no",label:"Norwegian"}],this.isSupported=function(e){for(var t=0;t<this.names.length;++t)if(this.names[t].symbol===e)return!0;return!1},this.getSupported=function(e){var t=e.split("-");return e=t.length>1?t[0].toLowerCase()+"-"+t[1].toUpperCase():t[0].toLowerCase(),this.isSupported(e)||(e=e.indexOf("zh-CN")>-1?"zh-HANS":e.indexOf("zh-TW")>-1?"zh-HANT":t.length>1&&this.isSupported(t[0].toLowerCase())?t[0]:"en"),e},this.getLanguages=function(){return this.names.slice()}}var i=new n;e.exports={Lang:i}},"./src/globals.js":function(e,t,r){"use strict";function n(e){e=e.toLowerCase();var t=p.getElementsByTagName("SCRIPT");if(t&&t.length>0)for(var r=0;r<t.length;++r)if(t[r].src&&-1!==t[r].src.toLowerCase().indexOf(e))return t[r];return null}function i(e,t,r){for(var n=e.indexOf("://")>0?e:a(e),i=p.getElementsByTagName("link"),o=0,s=i.length;s>o;o++)if(i[o].href===n)return void(t&&t());var l=p.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",n),t&&(l.onload=t),r&&(l.onerror=r),p.head.appendChild(l)}function o(e,t){function r(e){t(e,null)}function n(e){var r=e.currentTarget.responseText;t(null,r)}var i=e.indexOf("://")>0?e:a(e),o=new XMLHttpRequest;o.onload=n,o.onerror=r,o.ontimeout=r,o.open("GET",i,!0),o.send()}function s(e,t){return t&&Array.isArray(t.experimental)?-1!==t.experimental.indexOf(e):!1}function a(e){return h.LMV_RESOURCE_ROOT+e}function l(e){return"undefined"==typeof window?"":c(e,f.location.href)}function c(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\?&]"+e+"=([^&#]*)",n=new RegExp(r),i=n.exec(t);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))}function u(e){var t=p.createElement("div");return t.innerHTML=e,t.firstChild}r.r(t),r.d(t,"getScript",function(){return n}),r.d(t,"injectCSS",function(){return i}),r.d(t,"getHtmlTemplate",function(){return o}),r.d(t,"isExperimentalFlagEnabled",function(){return s}),r.d(t,"getResourceUrl",function(){return a}),r.d(t,"getParameterByName",function(){return l}),r.d(t,"getParameterByNameFromPath",function(){return c}),r.d(t,"stringToDOM",function(){return u});var d=r("./src/compat.js"),h=Object(d.getGlobal)(),f=h,p=f&&f.document;h.LOCALIZATION_REL_PATH="",h.LMV_VIEWER_VERSION="7.22.0",h.LMV_BUILD_TYPE="Production",h.LMV_RESOURCE_ROOT="",h.LMV_THIRD_PARTY_COOKIE=Object(d.isNodeJS)()?!1:void 0,"v"===h.LMV_VIEWER_VERSION.charAt(0)&&(h.LMV_VIEWER_VERSION=h.LMV_VIEWER_VERSION.substr(1)),h.LMV_VECTOR_PDF=!1,h.LMV_RASTER_PDF=!0,h.AEC_MODELTOSHEET_TRANSFORM=!1},"./src/gui/AlertBox.css":function(e,t,r){},"./src/gui/AlertBox.js":function(e,t,r){"use strict";function n(){}r.r(t),r.d(t,"AlertBox",function(){return n});var i=r("./src/globalization/i18next.js");n.instances=[],n.displayError=function(e,t,r,o,s){var a=e.ownerDocument,l=a.createElement("div");l.className="alert-box error",e.appendChild(l);var c=o;c||(c="img-item-not-found");var u=a.createElement("div");u.className="alert-box-image "+c,l.appendChild(u);var d=a.createElement("div");d.className="alert-box-msg",l.appendChild(d);var h=r;h||(h=i.i18n.translate("Error Occurred",{defaultValue:"Error Occurred"}));var f=a.createElement("div");f.className="alert-box-title",f.textContent=h,f.setAttribute("data-i18n",h),d.appendChild(f);var p=a.createElement("div");if(p.className="alert-box-text",p.textContent=t,p.setAttribute("data-i18n",t),d.appendChild(p),s){var m=a.createElement("div");m.className="alert-box-content",d.appendChild(m);var g=a.createElement("ul");g.className="alert-box-content";for(var v=0;v<s.length;v++){var y=s[v];if(y){var _=a.createElement("li"),b=this.extractList(y);if(b.list.length){var x=this.generateListElement(list,a);g.appendChild(x)}_.innerHTML=b.msg,_.setAttribute("data-i18n",b.msg),g.appendChild(_)}}m.appendChild(g)}var w=a.createElement("div");w.className="alert-box-ok",w.textContent=i.i18n.translate("OK",{defaultValue:"OK"});var E={alertBox:l,container:e};w.addEventListener("click",function(t){l.style.visibility="hidden",e.removeChild(l),n.instances.splice(n.instances.indexOf(E),1)}),l.appendChild(w),l.style.visibility="visible",n.instances.push(E)},n.displayErrors=function(e,t,r){var o=e.ownerDocument,s=o.createElement("div");s.className="alert-box errors",e.appendChild(s);var a=t;a||(a="img-item-not-found");var l=o.createElement("div");l.className="alert-box-image "+a,s.appendChild(l);var c=o.createElement("div");c.className="alert-box-msg errors",s.appendChild(c);for(var u=0;u<r.length;u++){var d=r[u].header;d||(d=i.i18n.translate("Error",{defaultValue:"Error"}));var h=o.createElement("div");h.className="alert-box-title errors",h.textContent=d,c.appendChild(h);var f=o.createElement("div");f.className="alert-box-text errors";var p=r[u].msg,m=this.extractList(p);if(m.list.length){var g=o.createElement("div"),v=this.generateListElement(m.list,o);g.appendChild(v),f.textContent=m.msg,f.appendChild(g)}else f.textContent=p;if(c.appendChild(f),r[u].hints){var y=o.createElement("ul");y.className="alert-box-content";for(var _=r[u].hints,b=0;b<_.length;b++){var x=_[b];if(x){var w=o.createElement("li");y.appendChild(w);var m=this.extractList(x);if(m.list.length){var v=this.generateListElement(m.list,o);y.appendChild(v)}w.innerHTML=m.msg}}c.appendChild(y)}}var E=o.createElement("div");E.className="alert-box-ok",E.textContent=i.i18n.translate("OK",{defaultValue:"OK"});var S={alertBox:s,container:e};E.addEventListener("click",function(t){s.style.visibility="hidden",e.removeChild(s),n.instances.splice(n.instances.indexOf(S),1)}),s.appendChild(E),s.style.visibility="visible",n.instances.push(S)},n.extractList=function(e){var t={msg:e,list:[]};if(e&&-1!=e.indexOf("<ul>")){var r=e.split("<ul>");t.msg=r[0],r=r[1].split("</ul>"),t.list=r[0].split(", "),1===t.list.length&&(t.list=r[0].split(","))}return t},n.generateListElement=function(e,t){for(var r=t.createElement("ul"),n=0;n<e.length;n++){var i=t.createElement("li");i.textContent=e[n],i.setAttribute("data-i18n",e[n]),r.appendChild(i)}return r},n.dismiss=function(){if(n.instances.length>0){var e=n.instances.pop();return e.alertBox.style.visibility="hidden",e.container.removeChild(e.alertBox),!0}return!1}},"./src/gui/CommonWidgets.css":function(e,t,r){},"./src/gui/CommonWidgets.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e,t,r,n,i){function o(e){e.target!=s.stepperElement&&(s.stepperElement.value=s.sliderElement.value),s.fireChangeEvent()}var s=this;this.tbody=n;var a=i&&i.insertAtIndex?i.insertAtIndex:-1;this.hideStepper=i&&i.hideStepper;var l=i&&i.hideCaption;this.sliderRow=this.tbody.insertRow(a),this.sliderRow.classList.add("switch-slider-row");var c=this.getDocument(),u=this.sliderRow.insertCell(0);this.caption=c.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=p.i18n.translate(e),l&&(this.caption.style.display="none"),u.appendChild(this.caption),u=this.sliderRow.insertCell(1),this.sliderElement=c.createElement("input"),this.sliderElement.type="range",this.sliderElement.id=e+"_slider",this.sliderElement.min=t,this.sliderElement.max=r,this.sliderElement.style.width="85%",u.appendChild(this.sliderElement),u=this.sliderRow.insertCell(2),this.stepperElement=c.createElement("input"),this.stepperElement.type="number",this.stepperElement.id=e+"_stepper",this.stepperElement.min=t,this.stepperElement.max=r,this.stepperElement.step=1,this.stepperElement.style.width="64px",this.hideStepper&&(this.stepperElement.style.display="none"),u.appendChild(this.stepperElement),this.blockEvent=!1,this.stepperElement.addEventListener("change",function(e){e.target!=s.sliderElement&&(s.sliderElement.value=s.stepperElement.value),s.fireChangeEvent()},!1),this.sliderElement.addEventListener("change",o,!1),this.sliderElement.addEventListener("input",o,!1)}function a(e,t,r,n,i,o){var s=this;this.tbody=t;var a=o&&o.insertAtIndex?o.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(a),this.sliderRow.classList.add("switch-slider-row");var l=this.getDocument(),c=this.sliderRow.insertCell(0);this.caption=l.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=p.i18n.translate(e),c.appendChild(this.caption),c=this.sliderRow.insertCell(1),n&&(this.description=l.createElement("div"),this.description.setAttribute("data-i18n",n),this.description.textContent=p.i18n.translate(n),c.appendChild(this.description),c=this.sliderRow.insertCell(2));var u=l.createElement("label");u.classList.add("switch"),this.checkElement=l.createElement("input"),this.checkElement.type="checkbox",this.checkElement.id=e+"_check",this.checkElement.checked=r,u.appendChild(this.checkElement);var d=l.createElement("div");d.classList.add("slider"),u.appendChild(d),c.appendChild(u),this.blockEvent=!1,this.checked=r,this.checkElement.addEventListener("change",function(e){s.fireChangeEvent()},!1),Object(m.isTouchDevice)()&&(this.sliderRowHammer=new v.Manager(this.sliderRow,{recognizers:[[v.Tap]],handlePointerEventMouse:!1,inputClass:m.isIE11?v.PointerEventInput:v.TouchInput}),this.sliderRowHammer.on("tap",function(e){e.preventDefault(),e.target.click()})),this.checkElement.addEventListener("click",function(e){e.stopPropagation()},!1),this.sliderRow.addEventListener("click",function(e){s.checkElement.disabled||(s.checkElement.checked=!s.checkElement.checked,s.fireChangeEvent())},!1)}function l(e,t,r,n){this.tbody=t;var i=n&&n.insertAtIndex?n.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(i);var o=this.getDocument(),s=this.sliderRow.insertCell(0);this.caption=o.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=p.i18n.translate(e),s.appendChild(this.caption),s.colSpan="3",this.blockEvent=!1,this.removeFromParent=function(){this.tbody.removeChild(this.sliderRow),this.tbody=null,this.sliderRow=null,this.caption=null}}function c(e,t,r,n){this.tbody=t;var i=n&&n.insertAtIndex?n.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(i),this.sliderRow.insertCell();var o=this.sliderRow.insertCell();this.sliderRow.insertCell();var s=this.getDocument();this.caption=s.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=p.i18n.translate(e),this.caption.classList.add("adsk-button"),this.caption.classList.add("table-button"),o.appendChild(this.caption),this.removeFromParent=function(){this.tbody.removeChild(this.sliderRow),this._onClick&&(this.caption.removeEventListener("click",this._onClick),this._onClick=null),this.tbody=null,this.sliderRow=null,this.caption=null},this.setOnClick=function(e){this._onClick=e,this.caption.addEventListener("click",e,!1)}}function u(e,t,r,n,i,o,s){var a=this;this.tbody=t;var l=s&&s.insertAtIndex?s.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(l);var c=this.getDocument();this.dropdownElement=c.createElement("select"),this.dropdownElement.id=e+"_dropdown",this.dropdownElement.classList.add("option-drop-down");for(var u=0;u<r.length;u++){var d=c.createElement("option");d.value=u,d.setAttribute("data-i18n",r[u]),d.textContent=p.i18n.translate(r[u]),this.dropdownElement.add(d)}this.selectedIndex=this.dropdownElement.selectedIndex=n;var h=this.sliderRow.insertCell(0);if(this.caption=c.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=p.i18n.translate(e),h.appendChild(this.caption),i){h.colSpan="2",this.sliderRow=this.tbody.insertRow(l);var h=this.sliderRow.insertCell(0);h.appendChild(this.dropdownElement),h.colSpan="2",this.dropdownElement.classList.add("tabcell")}else{var h=this.sliderRow.insertCell(1);h.appendChild(this.dropdownElement)}h.style.paddingLeft=(s&&void 0!==s.paddingLeft?s.paddingLeft:5)+"px",h.style.paddingRight=(s&&void 0!==s.paddingRight?s.paddingRight:5)+"px",this.blockEvent=!1,this.dropdownElement.addEventListener("change",function(e){a.fireChangeEvent()},!1)}function d(e,t,r){this.resizeCallback=t;var n=this.getDocument(),i=n.createElement("div");i.classList.add("docking-panel-footer");var o=n.createElement("div");o.classList.add("docking-panel-footer-resizer"),i.appendChild(o);var s=!1,a=e.getBoundingClientRect(),l={x:0,y:0},c=n.createElement("div");c.classList.add("adsk-viewing-viewer"),c.classList.add("docking-panel-resize-overlay");var u=function(t){s=!0,a=e.getBoundingClientRect();var r=this.getDocument();r.body.appendChild(c),this.addDocumentEventListener("touchmove",h),this.addDocumentEventListener("touchcancel",d),this.addDocumentEventListener("touchend",d),this.addDocumentEventListener("mousemove",h),this.addDocumentEventListener("mouseup",d),t.preventDefault(),t.stopPropagation()};u=u.bind(this);var d=function(e){var t=this.getDocument();t.body.contains(c)&&(t.body.removeChild(c),this.removeDocumentEventListener("touchmove",h),this.removeDocumentEventListener("touchcancel",d),this.removeDocumentEventListener("touchend",d),this.removeDocumentEventListener("mousemove",h),this.removeDocumentEventListener("mouseup",d),e.preventDefault(),e.stopPropagation())};d=d.bind(this);var h=function(t){"touchmove"===t.type&&(t.canvasX=t.touches[0].screenX,t.canvasY=t.touches[0].screenY),s&&(s=!1,l.x=t.canvasX||t.clientX,l.y=t.canvasY||t.clientY);var r=(t.canvasX||t.clientX)-l.x,n=(t.canvasY||t.clientY)-l.y,i=parseInt(a.width+r),o=parseInt(a.height+n);e.style.width=i+"px",e.style.height=o+"px",this.resizeCallback&&this.resizeCallback(i,o),t.preventDefault(),t.stopPropagation()};h=h.bind(this),o.addEventListener("touchstart",u),o.addEventListener("mousedown",u),e.style.resize="none",e.appendChild(i),this.footer=i,this.resizer=o}function h(e,t,r,n,i){this.tbody=t;var o=i&&i.insertAtIndex?i.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(o),this.sliderRow.classList.add("switch-slider-row");var s=this.getDocument(),a=this.sliderRow.insertCell(0);this.caption=s.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=p.i18n.translate(e),a.appendChild(this.caption),a=this.sliderRow.insertCell(1),r&&(this.description=s.createElement("div"),this.description.setAttribute("data-i18n",r),this.description.textContent=p.i18n.translate(r),a.appendChild(this.description),a=this.sliderRow.insertCell(2))}r.r(t),r.d(t,"OptionSlider",function(){return s}),r.d(t,"OptionCheckbox",function(){return a}),r.d(t,"OptionLabel",function(){return l}),r.d(t,"OptionButton",function(){return c}),r.d(t,"OptionDropDown",function(){return u}),r.d(t,"ResizeFooter",function(){return d}),r.d(t,"OptionRow",function(){return h}),r.d(t,"SimpleList",function(){return y});var f=r("./src/application/EventDispatcher.js"),p=r("./src/globalization/i18next.js"),m=r("./src/compat.js"),g=r("./src/application/GlobalManagerMixin.js"),v=r("./thirdparty/hammer/hammer.js");s.prototype.constructor=s,f.EventDispatcher.prototype.apply(s.prototype),s.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value;var e=new CustomEvent("change",{detail:{target:this,value:this.sliderElement.value}});this.dispatchEvent(e)}},s.prototype.setValue=function(e){this.blockEvent=!0,this.value=e,this.sliderElement.value=e,this.stepperElement.value=e,this.blockEvent=!1},s.prototype.setDisabled=function(e){this.sliderElement.disabled=e,this.stepperElement.disabled=e,this.caption.disabled=e},g.GlobalManagerMixin.call(s.prototype),a.prototype.constructor=a,f.EventDispatcher.prototype.apply(a.prototype),g.GlobalManagerMixin.call(a.prototype),a.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked;var e=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}});this.dispatchEvent(e)}},a.prototype.setChecked=function(e){this.checkElement.checked!=e&&(this.checkElement.checked=e,this.fireChangeEvent())},a.prototype.setValue=function(e){this.blockEvent=!0,this.checked=e,this.checkElement.checked=e,this.blockEvent=!1},a.prototype.getValue=function(){var e=this.checkElement.checked;return e},a.prototype.setDisabled=function(e){this.checkElement.disabled=e,this.caption.disabled=e},a.prototype.setVisibility=function(e){e?this.sliderRow.style.display="table-row":this.sliderRow.style.display="none"},g.GlobalManagerMixin.call(l.prototype),g.GlobalManagerMixin.call(c.prototype),u.prototype.constructor=u,f.EventDispatcher.prototype.apply(u.prototype),u.prototype.setSelectedIndex=function(e){this.blockEvent=!0,this.selectedIndex=this.dropdownElement.selectedIndex=e,this.blockEvent=!1},u.prototype.setSelectedValue=function(e){this.blockEvent=!0,this.dropdownElement.selectedValue=e,this.selectedIndex=this.dropdownElement.selectedIndex,this.blockEvent=!1},u.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=this.dropdownElement.selectedIndex;var e=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}});this.dispatchEvent(e)}},u.prototype.setDisabled=function(e){this.dropdownElement.disabled=e,this.caption.disabled=e},g.GlobalManagerMixin.call(u.prototype),g.GlobalManagerMixin.call(d.prototype),g.GlobalManagerMixin.call(h.prototype);var y=function(){function e(t,r,i){n(this,e),this._parentDiv=t,this._renderRowFn=r,this._onClickFn=i,this._onRowClick=this._onRowClick.bind(this);var o=this.getDocument(),s=o.createElement("div");s.classList.add("settings-container"),this._parentDiv.appendChild(s),this._myContainer=s,this._myContainer.addEventListener("click",this._onRowClick,{capture:!0});var a=o.createElement("div");a.classList.add("settings-table"),this._rowsContainer=a,s.appendChild(a)}return o(e,[{key:"setData",value:function(e,t){this._removeAllRows(),this._items=e;for(var r=0;r<e.length;++r)this._addRow(r);this._updateSelection(t)}},{key:"removeFromParent",value:function(){this._myContainer.removeEventListener("click",this._onRowClick,{capture:!0}),this._removeAllRows(),this._parentDiv.removeChild(this._myContainer),this._parentDiv=null,this._myContainer=null,this._rowsContainer=null,this._onClickFn=null,this._items=null}},{key:"_addRow",value:function(e){var t=this._items[e],r=this.getDocument(),n=r.createElement("div");this._renderRowFn(n,t,{domDocument:r}),n.setAttribute("data-index",e),this._rowsContainer.appendChild(n)}},{key:"_removeAllRows",value:function(){for(var e=this._rowsContainer.children;e.length;)this._rowsContainer.removeChild(e[0])}},{key:"_updateSelection",value:function(e){for(var t=(this._myContainer,this._rowsContainer.children),r=0;r<t.length;r++){var n=t[r];r===e?n.classList.add("border-select"):n.classList.remove("border-select")}}},{key:"_onRowClick",value:function(e){for(var t,r=e.target;r!==this._myContainer&&!(t=r.getAttribute("data-index"));)r=r.parentNode;if(t){var n=parseInt(t);this._onClickFn(n)}}}]),e}();g.GlobalManagerMixin.call(y.prototype)},"./src/gui/ContextMenu.css":function(e,t,r){},"./src/gui/ContextMenu.js":function(e,t,r){"use strict";function n(e){this.viewer=e,this.setGlobalManager(e.globalManager),this.menus=[],this.container=null,this.open=!1,this._onDOMevent=this._onDOMevent.bind(this)}r.r(t),r.d(t,"ContextMenu",function(){return n});var i=r("./src/compat.js"),o=r("./src/logger/Logger.js"),s=r("./src/globalization/i18next.js"),a=r("./src/application/GlobalManagerMixin.js"),l=r("./src/application/EventUtils.js");n.prototype.constructor=n,a.GlobalManagerMixin.call(n.prototype),n.prototype.show=function(e,t){var r=this.viewer.container.getBoundingClientRect();Array.isArray(e.changedPointers)&&e.changedPointers.length>0&&(e.clientX=e.changedPointers[0].clientX,e.clientY=e.changedPointers[0].clientY);var n=e.clientX-r.left,i=e.clientY-r.top;this.open||(this.showMenu(t,n,i),this.open=!0),this._startX=e.clientX,this._startY=e.clientY},n.prototype.showMenu=function(e,t,r){var n,s=[],a=this.getDocument(),l=a.createElement("div");l.style.left="0",l.style.top="0",l.style.width="100%",l.style.height="100%",l.style.position="absolute",l.style.zIndex="10";var c=a.createElement("div");c.classList.add("menu"),c.classList.add("docking-panel"),c.classList.add("docking-panel-container-solid-color-a"),l.appendChild(c),this.viewer.container.appendChild(l),this.container=l,this.menus.push(c);for(var u=0;u<e.length;++u){var d=e[u],h=d.title,f=d.target,p=d.icon,m=d.shortcut;n=this.createMenuItem(h,p,m),c.appendChild(n),"function"==typeof f?this.addCallbackToMenuItem(n,f):Array.isArray(f)?s.push({menuItem:n,target:f}):o.logger.warn("Invalid context menu option:",h,f)}var g=c.getBoundingClientRect(),v=g.width,y=g.height,_=this.viewer.container.getBoundingClientRect(),b=_.width,x=_.height,w=Object(i.isTouchDevice)()&&!this.viewer.navigation.getUseLeftHandedInput();for(w&&(t-=v),0>t&&(t=0),t+v>b&&(t=b-v,0>t&&(t=0)),0>r&&(r=0),r+y>x&&(r=x-y,0>r&&(r=0)),c.style.top=Math.round(r)+"px",c.style.left=Math.round(t)+"px",u=0;u<s.length;++u){var E=s[u];n=E.menuItem,g=n.getBoundingClientRect(),t=Math.round((w?g.left:g.right)-_.left),r=Math.round(g.top-_.top),this.addSubmenuCallbackToMenuItem(n,E.target,t,r)}this.container.addEventListener("touchend",this._onDOMevent),this.container.addEventListener("mousedown",this._onDOMevent),this.container.addEventListener("mouseup",this._onDOMevent)},n.prototype._onDOMevent=function(e){var t=e.type;switch(t){case"touchend":this._isContextMenu(e)||this.hide();break;case"mousedown":this._startX=e.clientX,this._startY=e.clientY;break;case"mouseup":this._isContextMenu(e)||(this.hide(),l.EventUtils.isRightClick(e)&&e.clientX===this._startX&&e.clientY===this._startY&&this.viewer.triggerContextMenu(e))}},n.prototype.createMenuItem=function(e,t,r){var n=this.getDocument(),i=n.createElement("div");return i.className="menu-item",r=r||"",this.setMenuItemIcon(i,t),this.setMenuItemText(i,e),this.setMenuItemShortcut(i,r),i},n.prototype.setMenuItemIcon=function(e,t){var r=this.getDocument(),n=r.createElement("div");n.classList.add("menu-item-icon"),t&&n.classList.add(t),e.appendChild(n)},n.prototype.setMenuItemText=function(e,t){var r=this.getDocument(),n=r.createElement("div");n.classList.add("menu-item-text"),n.setAttribute("data-i18n",t),n.textContent=s.i18n.translate(t),e.appendChild(n)},n.prototype.setMenuItemShortcut=function(e,t){var r=this.getDocument(),n=r.createElement("div");n.classList.add("menu-item-shortcut"),n.textContent=t,e.appendChild(n)},n.prototype.addCallbackToMenuItem=function(e,t){var r=this;e.addEventListener("click",function(e){return r.hide(),t(),e.preventDefault(),!1},!1)},n.prototype.addSubmenuCallbackToMenuItem=function(e,t,r,n){var i=this;e.addEventListener("click",function(){i.showMenu(t,r,n)},!1)},n.prototype.hide=function(){return this.open?(this.menus=[],this.open=!1,this.container.removeEventListener("touchend",this._onDOMevent),this.container.removeEventListener("mousedown",this._onDOMevent),this.container.removeEventListener("mouseup",this._onDOMevent),this.container.parentNode.removeChild(this.container),this.container=null,!0):!1},n.prototype._isContextMenu=function(e){for(var t=this.menus[0],r=e.target;r!==this.container;){if(r===t)return!0;r=r.parentNode}return!1}},"./src/gui/DataTable.css":function(e,t,r){},"./src/gui/DataTable.js":function(e,t,r){"use strict";function n(e){if(!(e instanceof s.DockingPanel))throw new Error("Invalid docking panel");this.dockingPanel=e;var t=this.dockingPanel.getDocument();this.datatableDiv=t.createElement("div"),this.datatableDiv.setAttribute("id","datatable"),this.datatableDiv.setAttribute("class","datatable"),e.container.appendChild(this.datatableDiv),e.footerInstance&&(e.footerInstance.resizeCallback=this._fitHeaderColumns.bind(this)),this.groupedByColumn=!1,this.aggregated=!1}r.r(t),r.d(t,"DataTable",function(){return n});var i=r("./src/gui/DataTable.css"),o=(r.n(i),r("./node_modules/clusterize.js/clusterize.js")),s=Autodesk.Viewing.UI,a="MIN",l="MAX",c="SUM",u="AVG",d="COUNT";n.prototype._createColumns=function(e){var t=this.dockingPanel.getDocument(),r=t.createElement("div");r.setAttribute("id","columnArea"),r.setAttribute("class","clusterize-headers");var n='<table id="headersArea"><thead><tr id ="columnRow"></tr></thead></table>';r.innerHTML=n,this.datatableDiv.appendChild(r);var i=r.querySelector("tr");e.forEach(function(e){var r=t.createElement("th");r.appendChild(t.createTextNode(e)),i.appendChild(r)}),n=this.datatableDiv.querySelector("table"),this._makeTableSortable(n)},n.prototype._createRows=function(){var e=this.dockingPanel.getDocument(),t=e.createElement("div"),r='<div id="scrollArea" class="clusterize-scroll"><table id="bodyArea" class="table-striped"><tbody id="contentArea" class="clusterize-content"><tr class="clusterize-no-data"><td>Loading data\u2026</td></tr></tbody></table></div>';t.innerHTML=r,this.datatableDiv.appendChild(t)},n.prototype.setData=function(e,t){if(t.length!==e[0].length)throw new Error("Column length should be same as the row length");this._createColumns(t),this._createRows();var r=this;this.rowData=e,this.clusterize=new o({rows:this.rowData.map(function(e){return"<tr>"+e.map(function(e){return"<td>"+e+"</td>"}).join(" ")+"</tr>"}),scrollId:"scrollArea",contentId:"contentArea",callbacks:{clusterChanged:function(){r._fitHeaderColumns(),r._syncHeaderWidth(),r.groupedByColumn&&r._updateClusterGroup()}}});var n=this.datatableDiv.querySelector(".clusterize-scroll");n.addEventListener("scroll",function(){var e=this.scrollLeft;i(e)});var i=function(e){var t=r.datatableDiv.querySelector("#headersArea");t.style.setProperty("margin-left",-e+"px")}},n.prototype.destroyTable=function(){this.clusterize.destroy(!0),this.clusterize=null,this.rowData=null,this.groupedByColumn=!1},n.prototype._makeTableSortable=function(e){var t,r=this,n=e.tHead;if(n&&n.rows[0]&&(n=n.rows[0].cells),n)for(t=n.length;--t>=0;)!function(e){var t=1;n[e].addEventListener("click",function(){r._sortTable(e,t=1-t)})}(t)},n.prototype._sortTable=function(e,t){var r=this.rowData;this.sortFunction||this.restoreDefaultSortFunction();var n=this.sortFunction&&this.sortFunction.bind(this);r=r.sort(n(e,t));var i=r.map(function(e){return"<tr>"+e.map(function(e){return"<td>"+e+"</td>"}).join(" ")+"</tr>"});this.clusterize.update(i);var o=this.datatableDiv.querySelector("#bodyArea");o.classList.contains("table-striped")||o.classList.add("table-striped")},n.prototype.setSortFunction=function(e){this.sortFunction=e},n.prototype.getSortFunction=function(){return this.sortFunction},n.prototype.restoreDefaultSortFunction=function(){var e=function(e,t){return t=-(+t||-1),function(r,n){return t*r[e].localeCompare(n[e])}};this.sortFunction=e},n.prototype.getGroupByColumn=function(e){for(var t=this.rowData,r={},n=0;n<t.length;n++){var i=t[n],o=i[e];r[o]||(r[o]=[]),r[o].push(n)}return r},n.prototype.groupByColumn=function(e){for(var t=this,r=this.rowData,n={},i=0;i<r.length;i++){var o=r[i],s=o[e];if(n[s]||(n[s]=[]),n[s].length>0)o="<tr class= 'subrow'>"+o.map(function(e){return"<td>"+e+"</td>"}).join(" ")+"</tr>";else{var a;!function(){var e=o.length;a='<span value="click"></span>',o="<tr class= 'parentrow'>"+o.map(function(t,r){return e===r+1?"<td>"+t+a+"</td>":"<td>"+t+"</td>"}).join(" ")+"</tr>"}()}n[s].push(o)}var l=[];for(var c in n)for(var u=n[c],d=0;d<u.length;d++){var o=u[d];l.push(o)}this.clusterize.update(l);var h=this.datatableDiv.querySelector("#bodyArea");h.classList.contains("table-striped")&&h.classList.remove("table-striped"),this.datatableDiv.querySelectorAll(".subrow").forEach(function(e){t._slideDown(e),e.style.fontSize="14px"});var f=this._fitHeaderColumns.bind(this),p=this._expandContent.bind(this);this.datatableDiv.querySelectorAll("span").forEach(function(e){e.addEventListener("click",function(e){p(this,e),f()})}),this._fitHeaderColumns(),this.groupedByColumn||(this.groupedByColumn=!0)},n.prototype._updateClusterGroup=function(){var e=this,t=this._fitHeaderColumns.bind(this),r=this._expandContent.bind(this);this.datatableDiv.querySelectorAll("span").forEach(function(e){e.addEventListener("click",function(e){r(this,e),t()})}),this.datatableDiv.querySelectorAll(".subrow").forEach(function(t){e._slideDown(t),t.style.fontSize="14px"})},n.prototype._expandContent=function(e,t){var r=!1;"collapsed"===e.className&&(r=!0);for(var n=r?14:0,i=e.closest("tr"),o=this._nextUntil(i,":not(.subrow)"),s=0;s<o.length;s++)this._slideToggle(o[s],500),o[s].style.fontSize=n+"px";e.classList.toggle("collapsed")},n.prototype._nextUntil=function(e,t,r){var n=[];for(e=e.nextElementSibling;e&&!e.matches(t);)!r||e.matches(r)?(n.push(e),e=e.nextElementSibling):e=e.nextElementSibling;return n},n.prototype._slideToggle=function(e,t){var r=this.dockingPanel.getWindow();return"none"===r.getComputedStyle(e).display?this._slideDown(e,t):this._slideUp(e,t)},n.prototype._slideUp=function(e,t){e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.boxSizing="border-box",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")},n.prototype._slideDown=function(e,t){var r=this.dockingPanel.getWindow();e.style.removeProperty("display");var n=r.getComputedStyle(e).display;"none"===n&&(n="block"),e.style.display=n;var i="21px";e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.boxSizing="border-box",e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=i+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),r.setTimeout(function(){e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")},t)},n.prototype.getAggregate=function(e,t){function r(){for(var e=h[0][t],r=1;r<h.length;r++)e>h[r][t]&&(e=h[r][t]);return e?e:0}function n(){for(var e=h[0][t],r=1;r<h.length;r++)e<h[r][t]&&(e=h[r][t]);
return e?e:0}function i(){for(var e=0,r=0;r<h.length;r++)e+=parseFloat(h[r][t]);return e?e:0}function o(){var e=i()/h.length;return e=parseFloat(e),e?e:0}function s(){return h.length}var h=this.rowData,f=null;switch(e){case a:f=r();break;case l:f=n();break;case c:f=i();break;case u:f=o();break;case d:f=s()}return f},n.prototype.aggregate=function(e,t){var r=this.datatableDiv.querySelector(".clusterize-content"),n=r.querySelector("tr:not(.clusterize-extra-row):not(.first)");if(n){for(var i=[],o=0;o<n.children.length;o++)i.push(n.children[o].clientWidth);var s=this.getAggregate(e,t);if(!this.aggregated){var a=this.dockingPanel.getDocument(),l=a.createElement("div");l.setAttribute("id","aggregate"),l.setAttribute("class","aggregate-headers");var c='<table id="aggregateArea"><tbody></tbody></table>';l.innerHTML=c,this.datatableDiv.appendChild(l)}for(var u=this.datatableDiv.querySelector("#aggregateArea"),d=0;d<u.rows.length;d++){var h=u.rows[d].cells[t];if(h.innerText.indexOf(e)>-1)return}for(var f=0;f<u.rows.length;f++){var p=u.rows[f].cells[t];if(0===p.innerText.length)return p.appendChild(_document.createTextNode(e+": ")),void p.appendChild(_document.createTextNode(s))}for(var m=u.insertRow(u.rows.length),g=0;g<i.length;g++){var v=_document.createElement("td");m.appendChild(v),v.style.setProperty("min-width",i[g]+"px","important"),g===t&&(v.appendChild(_document.createTextNode(e+": ")),v.appendChild(_document.createTextNode(s)))}this.aggregated=!0}},n.prototype.clearAggregates=function(){for(var e=this.datatableDiv.querySelectorAll(".aggregate-headers"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t])},n.prototype._fitHeaderColumns=function(){var e=this.datatableDiv.querySelector(".clusterize-content"),t=this.datatableDiv.querySelector("#headersArea"),r=e.querySelector("tr:not(.clusterize-extra-row):not(.first)");if(r){for(var n=[],i=[],o=0;o<r.children.length;o++)i.push(r.children[o].clientWidth);if(i.toString()!=n.toString()){for(var s=t.querySelector("tr"),a=0;a<s.children.length;a++)s.children[a].style.setProperty("clientWidth",i[a]+"px","important"),s.children[a].style.setProperty("min-width",i[a]+"px","important");if(this.aggregated)for(var l=this.datatableDiv.querySelector("#aggregateArea"),c=0;c<l.rows.length;c++)for(var u=l.rows[c],d=0;d<u.children.length;d++)u.children[d].style.setProperty("clientWidth",i[d]+"px","important"),u.children[d].style.setProperty("min-width",i[d]+"px","important");n=i}}},n.prototype._syncHeaderWidth=function(){var e=this.datatableDiv.querySelector(".clusterize-content"),t=this.datatableDiv.querySelector("#headersArea");t.style.setProperty("clientWidth",e.width),t.style.setProperty("min-idth",e.width)}},"./src/gui/DockingPanel.css":function(e,t,r){},"./src/gui/DockingPanel.js":function(e,t,r){"use strict";function n(e,t,r,n){this.kMinWdth=100,this.kMinHeight=100,this.visibilityCallbacks=[],this.movedSinceLastClick=!1,this.movedSinceCreate=!1,this.parentContainer=e;var i=this.getDocument();this.container=i.createElement("div"),this.container.id=t,this.container.lastWidth="",this.container.dockRight=!1,this.container.dockBottom=!1,this.titleLabel=r,n=n||{},n.hasOwnProperty("localizeTitle")||(n.localizeTitle=!0),n.hasOwnProperty("addFooter")||(n.addFooter=!0),this.options=n,this.container.classList.add("docking-panel"),e.appendChild(this.container),this.listeners=[],this.initialize(),this.setVisible(!1)}r.r(t),r.d(t,"DockingPanel",function(){return n});var i=r("./src/globalization/i18next.js"),o=r("./src/gui/CommonWidgets.js"),s=r("./src/application/GlobalManagerMixin.js");s.GlobalManagerMixin.call(n.prototype),n.prototype.onSetGlobalManager=function(e){this.footerInstance&&this.footerInstance.setGlobalManager(e)},n.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id),this.container.appendChild(this.title),this.initializeMoveHandlers(this.title),this.setTitle(this.titleLabel||this.container.id,this.options),this.closer=this.createCloseButton(),this.container.appendChild(this.closer),this.options.addFooter&&(this.footer=this.createFooter(),this.container.appendChild(this.footer))},n.prototype.uninitialize=function(){for(var e=0;e<this.listeners.length;++e){var t=this.listeners[e];t.target.removeEventListener(t.eventId,t.callback)}this.listeners=[],this.visibilityCallbacks=[],this.parentContainer.removeChild(this.container),this.parentContainer=null,this.container=null,this.title=null,this.closer=null},n.prototype.addVisibilityListener=function(e){this.visibilityCallbacks.push(e)},n.prototype.setVisible=function(e){if(e){var t=this.getContainerBoundingRect();if(this.container.dockRight){var r=t.width,n=300,i=this.container.lastWidth||this.container.style.width;i||(i=this.container.getBoundingClientRect().width),i&&(n=parseInt(i)),this.container.style.left=r-n+"px"}if(this.container.dockBottom){var o=t.height,s=300,a=this.container.lastHeight||this.container.style.height;a||(a=this.container.getBoundingClientRect().height),a&&(s=parseInt(a));var l=o-s;this.container.style.top=l>0?l+"px":0}this.container.style.maxHeight=t.height+"px",this.container.style.maxWidth=t.width+"px",this.container.style.display="block",this.bringToFront()}else this.container.lastWidth=this.container.style.width,this.container.lastHeight=this.container.style.height,this.container.style.display="none";for(var c=0;c<this.visibilityCallbacks.length;c++)this.visibilityCallbacks[c](e)},n.prototype.isVisible=function(){return"block"===this.container.style.display},n.prototype.visibilityChanged=function(){},n.prototype.initializeMoveHandlers=function(e){function t(e){var t=h.style.minWidth?parseInt(h.style.minWidth):f.kMinWdth,r=h.style.minHeight?parseInt(h.style.minHeight):f.kMinHeight,n=f.getContainerBoundingRect();h.style.maxWidth&&parseInt(h.style.width)>parseInt(h.style.maxWidth)&&(h.style.width=h.style.maxWidth),h.style.maxHeight&&parseInt(h.style.height)>parseInt(h.style.maxHeight)&&(h.style.height=h.style.maxHeight),parseInt(h.style.width)<t&&(h.style.width=t+"px"),parseInt(h.style.height)<r&&(h.style.height=r+"px"),"touchmove"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),u+=e.screenX-s,d+=e.screenY-a,i=l+u,o=c+d;var p=parseInt(h.style.width),m=parseInt(h.style.height);isNaN(p)&&(p=f.container.getBoundingClientRect().width),isNaN(m)&&(m=f.container.getBoundingClientRect().height),5>i&&(i=0),5>o&&(o=0),h.dockRight=!1,h.dockBottom=!1,n.width-5<i+p&&(i=n.width-p,h.dockRight=!0),n.height-5<o+m&&(o=n.height-m,h.dockBottom=!0),h.style.left=i+"px",h.style.top=o+"px",h.style.maxWidth=n.width-i+"px",h.style.maxHeight=n.height-o+"px",s=e.screenX,a=e.screenY,f.onMove(e,i,o)}function r(e){f.removeWindowEventListener("mousemove",t),f.removeWindowEventListener("mouseup",r),f.removeWindowEventListener("touchmove",t),f.removeWindowEventListener("touchend",r),f.onEndMove(e,i,o)}function n(e){"touchstart"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),s=e.screenX,a=e.screenY,u=0,d=0,l=f.container.offsetLeft,c=f.container.offsetTop,f.addWindowEventListener("mousemove",t,!1),f.addWindowEventListener("mouseup",r,!1),f.addWindowEventListener("touchmove",t,!1),f.addWindowEventListener("touchend",r,!1),e.preventDefault(),f.onStartMove(e,l,c)}var i,o,s,a,l,c,u,d,h=this.container,f=this;f.addEventListener(e,"mousedown",n),f.addEventListener(e,"touchstart",n)},n.prototype.initializeCloseHandler=function(e){var t=this;t.addEventListener(e,"click",function(e){t.setVisible(!1)},!1)},n.prototype.createScrollContainer=function(e){var t=this.getDocument(),r=t.createElement("div"),n=r.classList;return n.add("docking-panel-scroll"),n.add("docking-panel-container-solid-color-a"),n.add(e&&e.left?"left":"right"),e&&e.heightAdjustment&&(r.style.height="calc(100% - "+e.heightAdjustment+"px)"),e&&e.marginTop&&(r.style.marginTop=e.marginTop+"px"),r.id=this.container.id+"-scroll-container",this.container.appendChild(r),this.scrollContainer=r,this.scrollEaseCurve=e&&e.scrollEaseCurve||[0,0,.29,1],this.scrollEaseSpeed=e&&e.scrollEaseSpeed||.003,r},n.prototype.createTitleBar=function(e){var t=this.getDocument(),r=t.createElement("div");r.classList.add("docking-panel-title"),r.textContent=e;var n=this;return n.addEventListener(r,"click",function(e){n.movedSinceLastClick||n.onTitleClick(e),n.movedSinceLastClick=!1}),n.addEventListener(r,"mousedown",function(e){n.bringToFront()}),n.addEventListener(r,"dblclick",function(e){n.onTitleDoubleClick(e)}),r},n.prototype.createFooter=function(){var e=new o.ResizeFooter(this.container);return e.setGlobalManager(this.globalManager),this.footerInstance=e,this.container.style.resize="none",e.footer},n.prototype.setTitle=function(e,t){t&&t.localizeTitle?(this.title.setAttribute("data-i18n",e),e=i.i18n.translate(e)):this.title.removeAttribute("data-i18n"),this.title.textContent=e},n.prototype.createCloseButton=function(){var e=this.getDocument(),t=e.createElement("div");return t.className="docking-panel-close",this.initializeCloseHandler(t),t},n.prototype.onStartMove=function(e,t,r){},n.prototype.onEndMove=function(e,t,r){},n.prototype.onMove=function(e,t,r){this.movedSinceLastClick=!0,this.movedSinceCreate=!0},n.prototype.onTitleClick=function(e){},n.prototype.onTitleDoubleClick=function(e){},n.prototype.addEventListener=function(e,t,r){e.addEventListener(t,r),this.listeners.push({target:e,eventId:t,callback:r})},n.prototype.removeEventListener=function(e,t,r){for(var n=0;n<this.listeners.length;++n){var i=this.listeners[n];if(i.target===e&&i.eventId===t&&i.callback===r)return e.removeEventListener(t,r),this.listeners.splice(n,1),!0}return!1},n.prototype.getContentSize=function(){return{height:this.container.clientHeight,width:this.container.clientWidth}},n.prototype.resizeToContent=function(e){if(this.isVisible()){var t=this.getContentSize(),r=t.height,n=this.container.getBoundingClientRect(),i=this.getContainerBoundingRect(),o=this.container.querySelector(".docking-panel-footer");o&&(r+=o.getBoundingClientRect().height);var s=75,a=i.height;a-=n.top-i.top+s,e&&void 0!==e.maxHeight&&(a=Math.min(a,e.maxHeight)),r>a&&(r=a),this.container.style.maxHeight=a.toString()+"px",this.container.style.height=r.toString()+"px"}},n.prototype.getContainerBoundingRect=function(){return this.parentContainer.getBoundingClientRect()},n.prototype.animateScroll=function(e,t,r){function n(e,t){var r=3*e[1],n=3*(e[3]-e[1])-r,i=1-r-n;return((i*t+n)*t+r)*t}function i(c){var u=(c-l)*s;u=Math.min(u,1);var d=n(o,u),h=e+(t-e)*d;a.scrollTop=h,r&&r(h),1>u&&requestAnimationFrame(i)}var o=this.scrollEaseCurve,s=this.scrollEaseSpeed,a=this.scrollContainer,l=performance.now();requestAnimationFrame(i)},n.prototype.onViewerResize=function(e,t,r,n,i,o){var s=this.container,a=s.getBoundingClientRect(),l=a.width,c=a.height;if(!l||!c)return!1;var u=a.top,d=a.bottom,h=a.left,f=a.right;return l>i&&(l=Math.round(i),s.style.width=l+"px"),c>o&&(c=Math.round(o),s.style.height=c+"px"),(f>n||s.dockRight)&&(h=Math.round(n-l-r),s.style.left=h+"px"),(d>t||s.dockBottom)&&(u=Math.round(t-c-e),0>u&&(u=0),s.style.top=u+"px"),s.style.maxWidth=Math.round(i)+"px",s.style.maxHeight=Math.round(o)+"px",!0},n.prototype.bringToFront=function(){var e=this.scrollContainer?this.scrollContainer.scrollTop:0;this.parentContainer.appendChild(this.container),this.scrollContainer&&(this.scrollContainer.scrollTop=e)}},"./src/gui/ErrorHandler.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){}r.r(t),r.d(t,"ErrorHandler",function(){return i});var o=r("./src/gui/AlertBox.js"),s=r("./src/logger/Logger.js"),a=r("./src/globalization/i18next.js"),l=r("./src/envinit.js"),c={1:{img:"img-reload","globalized-msg":"Viewer-UnknownFailure","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint>Try loading the item again. </hint><hint>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},2:{img:"img-unsupported","globalized-msg":"Viewer-BadData","default-msg":"<title> Sorry </title><message>The item you are trying to view was not processed completely. </message><hint>Try loading the item again.</hint><hint>Please upload the file again to see if that fixes the issue.</hint>"},3:{img:"img-reload","globalized-msg":"Viewer-NetworkError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},4:{img:"img-unlock","globalized-msg":"Viewer-AccessDenied","default-msg":"<title> No access </title><message>Sorry. You don\u2019t have the required privileges to access this item.</message><hint> Please contact the author</hint>"},5:{img:"img-item-not-found","globalized-msg":"Viewer-FileNotFound","default-msg":'<title> Sorry </title><message>We can\u2019t display the item you are looking for. It may not have been processed yet. It may have been moved, deleted, or you may be using a corrupt file or unsupported file format.</message><hint> Try loading the item again.</hint><hint> Please upload the file again to see if that fixes the issue.</hint><hint> <a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-488804D0-B0B0-4413-8741-4F5EE0FACC4A" target="_blank">See a list of supported formats.</a></hint>'},6:{img:"img-reload","globalized-msg":"Viewer-ServerError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},7:{img:"img-reload","globalized-msg":"Viewer-UnhandledResponseCode","default-msg":"<title> Network problem </title><message>Sorry. We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},8:{img:"img-unsupported","globalized-msg":"Viewer-WebGlNotSupported","default-msg":'<title>Sorry</title><message>We can\'t show this item because this browser doesn\'t support WebGL.</message><hint>Try Google Chrome, Mozilla Firefox, or another browser that supports WebGL 3D graphics.</hint><hint>For more information, see the <a href="WEBGL_HELP" target="_blank">A360 browser reqirements.</a></hint>'},9:{img:"img-item-not-found","globalized-msg":"Viewer-NoViewable","default-msg":"<title> No viewable content </title><message>There\u2019s nothing to display for this item. It may not have been processed or it may not have content we can display.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},10:{img:"img-unsupported","globalized-msg":"Viewer-WebGlDisabled","default-msg":'<title>Sorry</title><message>We can\'t show this item because WebGL is disabled on this device.</message><hint> For more information see the <a href="WEBGL_HELP" target="_blank">A360 Help.</a></hint>'},11:{img:"img-item-not-found","globalized-msg":"Viewer-ModeIsEmpty","default-msg":"<title>Model is empty</title><message>Model is empty, there is no geometry for the viewer to show.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},12:{img:"img-unsupported","globalized-msg":"Viewer-RTCError","default-msg":"<title> Sorry </title><message>We couldn\u2019t connect to the Collaboration server.</message><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},13:{img:"img-unsupported","globalized-msg":"Viewer-FileExtNotSupported","default-msg":{title:"Sorry",message:"The file extension loaded into the Viewer is not supported",hints:["Try a different file"]}},15:{img:"img-unsupported","globalized-msg":"Viewer-WebGlContextLost","default-msg":{title:"WebGL context lost",message:"Unable to recover from software mode.  Please restart your browser and reload the Viewer",hints:["If you continue to encounter this issue when viewing this model, we recommend switching to a different browser."]}}};i.prototype.constructor=i,i.reportError=function(e,t,r,n,u,d){if(i.currentError=null,i.currentErrors=null,t){var h={category:"error",code:t,message:r,httpStatusCode:n,httpStatusText:u};s.logger.track(h,!0),i.currentError=[e,t,r,d];var f=c[t];if(f){var p={defaultValue:""};p.defaultValue=f["default-msg"];var m=f.img,g=f["globalized-msg"],v=this.parseErrorString(g,p);if(t===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_DISABLED||t===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED)for(var y=Object(l.getWebGLHelpLink)()||"http://www.autodesk.com/a360-browsers",_=0;_<v.hints.length;_++){var b=v.hints[_].indexOf('href="WEBGL_HELP"');-1!==b&&(v.hints[_]=v.hints[_].replace('href="WEBGL_HELP"','href="'+y+'"'))}o.AlertBox.displayError(e,v.msg,v.header,m,v.hints)}else{var m="img-unsupported",p={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"};this.parseArguments(r,p);var v=this.parseErrorString(t,p);v.header||(v.header="warning"===d?a.i18n.translate("header-warning"):""),o.AlertBox.displayError(e,v.msg,v.header,m,v.hints)}}},i.reportErrors=function(e,t){if(i.currentError=null,i.currentErrors=null,t){i.currentErrors=[e,t];for(var r={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"},n=[],l=0;l<t.length;l++)if(t[l].code){this.parseArguments(t[l].message,r);var c=this.parseErrorString(t[l].code,r);c.header||(c.header="warning"===t[0].type?a.i18n.translate("header-warning",{defaultValue:"Warning"}):""),n.push(c);var u={category:"error",code:t[l].code,message:t[l].message};s.logger.track(u,!0)}if(n.length){var d="img-unsupported";o.AlertBox.displayErrors(e,d,n)}}},i.parseArguments=function(e,t){if(e)if("string"==typeof e)t.defaultValue=e;else{t.defaultValue=e[0];for(var r=1;r<e.length;r++){var n=r-1,i=n.toString();t[i]=e[r]}}},i.parseErrorString=function(e,t){var r={msg:null,msgList:null,header:null,hints:null};if(!e)return r;if("object"===n(t.defaultValue)){var i=t.defaultValue;return r.header=i.title,r.msg=i.message,r.hints=i.hints.concat(),r}var o=a.i18n.translate(e,t);if(!o)return r;if(-1!=o.indexOf("<title>")){var s=o.split("<title>")[1].split("</title>");r.header=s[0],o=s[1]}if(o&&-1!=o.indexOf("<message>")){var s=o.split("<message>")[1].split("</message>");r.msg=s[0],o=s[1]}else r.msg=o;if(o&&-1!=o.indexOf("<hint>")){r.hints=[];for(var l=o.split("<hint>"),c=0;c<l.length;c++){var u=l[c].split("</hint")[0];r.hints.push(u)}}return r},i.localize=function(){if(o.AlertBox.instances.length>0)if(o.AlertBox.dismiss(),i.currentError){var e=i.currentError.shift(),t=i.currentError;i.reportError(e,t[0],t[1],t[2])}else{var e=i.currentErrors.shift(),r=i.currentErrors[0];i.reportErrors(e,r)}}},"./src/gui/GuiViewer3D.css":function(e,t,r){},"./src/gui/GuiViewer3D.js":function(e,t,r){"use strict";function n(e,t){t||(t={}),t.startOnInitialize=!1,i.Viewer3D.call(this,e,t),this.toolbar=null,this.dockingPanels=[],this.onFullScreenModeEvent=this.onFullScreenModeEvent.bind(this),this.onProgressBarUpdate=this.onProgressBarUpdate.bind(this)}r.r(t),r.d(t,"GuiViewer3D",function(){return n});var i=r("./src/application/Viewer3D.js"),o=r("./src/tools/HotGestureTool.js"),s=r("./src/application/EventTypes.js"),a=(r.n(s),r("./src/compat.js")),l=r("./src/application/ScreenModeDelegate.js"),c=r("./src/globalization/i18next.js"),u=r("./src/gui/controls/Button.js"),d=r("./src/gui/controls/ControlGroup.js"),h=r("./src/gui/toolbar/ToolBar.js"),f=r("./src/gui/controls/RadioButtonGroup.js"),p=r("./src/gui/ErrorHandler.js"),m=r("./src/gui/ProgressBar.js"),g=r("./src/logger/Logger.js"),v=r("./src/globals.js"),y=r("./src/gui/RenderOptionsPanel.js"),_=r("./src/globalization/langs.js"),b=(r.n(_),r("./src/globalization/i18init.js")),x=r("./src/gui/HudMessage.js"),w=r("./src/gui/AlertBox.js"),E=r("./src/gui/SettingsPanel.js"),S=r("./src/gui/ViewerSettingsPanel.js"),A=r("./src/file-loaders/net/ErrorCodes.js"),M=r("./src/gui/GuiViewerToolbarConst.js"),T=(r("./src/tools/KeyCode.js"),r("./src/application/PreferenceNames.js"));n.prototype=Object.create(i.Viewer3D.prototype),n.prototype.constructor=n,n.prototype.initialize=function(e){var t=i.Viewer3D.prototype.initialize.call(this,e);if(t>0)return p.ErrorHandler.reportError(this.container,t),t;var r=this;if(this.toolController){var n=new o.HotGestureTool(this);this.toolController.registerTool(n),this.toolController.activateTool(n.getName())}return this.addEventListener(s.FULLSCREEN_MODE_EVENT,this.onFullScreenModeEvent),this.contextMenu||this.setDefaultContextMenu(),this.progressbar=new m.ProgressBar(this.container),this.addEventListener(s.PROGRESS_UPDATE_EVENT,this.onProgressBarUpdate),this.addEventListener(s.VIEWER_RESIZE_EVENT,function(e){r.resizePanels(),r.updateToolbarButtons(e.width,e.height)}),this.addEventListener(s.NAVIGATION_MODE_CHANGED_EVENT,function(e){r.updateToolbarButtons(r.container.clientWidth,r.container.clientHeight)}),this.initEscapeHandlers(),this.localize(),this.addEventListener(s.WEBGL_CONTEXT_LOST_EVENT,function(e){this.impl.stop();for(var t=this.container,r=t.childElementCount,n=0;r>n;++n)t.children[n].style.display="none";p.ErrorHandler.reportError(this.container,A.ErrorCodes.WEBGL_LOST_CONTEXT)}.bind(this)),this.run(),0},n.prototype.uninitialize=function(){this.viewerSettingsPanel&&(this.viewerSettingsPanel.uninitialize(),this.viewerSettingsPanel=null),this.renderoptions&&(this.renderoptions.uninitialize(),this.renderoptions=null),this.viewerOptionButton&&(this.viewerOptionButton=null),this.removeEventListener(s.FULLSCREEN_MODE_EVENT,this.onFullScreenModeEvent),this.removeEventListener(s.PROGRESS_UPDATE_EVENT,this.onProgressBarUpdate),this.progressbar=null,this.modelTools=null,this.navTools=null,this.settingsTools=null,this.debugMenu=null,this.modelStats=null,this.toolbar=null,i.Viewer3D.prototype.uninitialize.call(this)},n.prototype.setUp=function(e){e||(e={}),e.startOnInitialize=!1,i.Viewer3D.prototype.setUp.call(this,e)},n.prototype.tearDown=function(){i.Viewer3D.prototype.tearDown.call(this),this.toolbar&&(this.toolbar.container.parentNode.removeChild(this.toolbar.container),this.toolbar=null),this.viewerSettingsPanel&&this.setSettingsPanel(null),this.renderoptions&&(this.removePanel(this.renderoptions),this.renderoptions.uninitialize(),this.renderoptions=null),this.debugMenu=null,this.removeEventListener(s.GEOMETRY_LOADED_EVENT,this.checkGeometry),this.checkGeometry=null},n.prototype.onPostExtensionLoad=function(e){var t=this.getToolbar();t&&e.onToolbarCreated&&e.onToolbarCreated(t),this.updateToolbarButtons(this.container.clientWidth,this.container.clientHeight)},n.prototype.loadModel=function(e,t,r,n,o){function s(e){return c.running?void c.createUI(e):void g.logger.error("createUI expects the viewer to be running.",Object(A.errorCodeString)(A.ErrorCodes.VIEWER_INTERNAL_ERROR))}function a(e){setTimeout(function(){var n=t&&(t.loadAsHidden||t.headlessViewer);n||s(e),r&&r.call(r,e)},1)}function l(e){e!==A.ErrorCodes.LOAD_CANCELED&&p.ErrorHandler.reportError(c.container,e),n&&n.apply(n,arguments)}var c=this,u=i.Viewer3D.prototype.loadModel.call(this,e,t,a,l,o);return u},n.prototype.createUI=function(e){var t=this;if(this.model===e){var r=this,n=this._createToolbar();this.checkGeometry=function(){setTimeout(function(){if(!r.impl.is2d&&r.model&&!r.model.hasGeometry()){var e=A.ErrorCodes.BAD_DATA_MODEL_IS_EMPTY,t="Model is empty";p.ErrorHandler.reportError(r.container,e,t),r._loadingSpinner.hide()}},1)};var i=this.config.disabledExtensions||{},o=function(e){var r=t.profile&&t.profile.extensions.unload?t.profile.extensions.unload:[];return-1===r.indexOf(e)};this.initModelTools(e),Object(a.getGlobal)().ENABLE_DEBUG&&this.initDebugTools();var l=Object(v.getParameterByName)("lmv_viewer_debug");"true"===l&&this.loadExtension("Autodesk.Debug",this.config);var c=function(e){var t=r.getExtension(e);t&&r.unloadExtension(e)};e.is2d()&&(c("Autodesk.BimWalk"),c("Autodesk.Section"),c("Autodesk.Viewing.FusionOrbit"),c("Autodesk.Explode")),i.measure||c("Autodesk.Measure"),n&&(this.dispatchEvent({type:M.TOOLBAR_CREATED_EVENT}),this.forEachExtension(function(e){e.onToolbarCreated&&e.onToolbarCreated(t.toolbar)}));var u="Autodesk.DefaultTools.NavTools",d=this.getExtension(u);d?d.updateUI(e.is3d()):this.loadExtension(u,r.config),this.initModality(),this.resize(),e.is2d()?(this.setDefaultNavigationTool("pan"),this.setClickToSetCOI(!1,!1),setTimeout(function(){var e={viewcube:"Autodesk.ViewCubeUi",measure:"Autodesk.Measure",hyperlink:"Autodesk.Hyperlink",layerManager:"Autodesk.LayerManager",propertiesPanel:"Autodesk.PropertiesManager"};for(var t in e){var n=e[t];!i[t]&&o(n)&&r.loadExtension(n,r.config)}},1)):(-1===this.getDefaultNavigationToolName().indexOf("orbit")&&this.setDefaultNavigationTool("orbit"),setTimeout(function(){var e={viewcube:"Autodesk.ViewCubeUi",explode:"Autodesk.Explode",bimwalk:"Autodesk.BimWalk",fusionOrbit:"Autodesk.Viewing.FusionOrbit",measure:"Autodesk.Measure",section:"Autodesk.Section",layerManager:"Autodesk.LayerManager",modelBrowser:"Autodesk.ModelStructure",propertiesPanel:"Autodesk.PropertiesManager"};for(var t in e){var n=e[t];!i[t]&&o(n)&&r.loadExtension(n,r.config)}!i.scalarisSimulation&&o("Autodesk.Viewing.ScalarisSimulation")&&r.model&&r.model.isScalaris&&r.loadExtension("Autodesk.Viewing.ScalarisSimulation",r.config)},1),e.isLoadDone()?this.checkGeometry():this.addEventListener(s.GEOMETRY_LOADED_EVENT,this.checkGeometry,{once:!0}))}},n.prototype.onFullScreenModeEvent=function(e){this.resizePanels(),this.updateFullscreenButton(e.mode)},n.prototype.onProgressBarUpdate=function(e){e.percent>=0&&this.progressbar.setPercent(e.percent)},n.prototype.addOptionToggle=function(e,t,r,n,i){var o=i?this.prefs[i]:null;r="boolean"==typeof o?o:r;var s=this.getDocument(),l=s.createElement("li");l.className="toolbar-submenu-listitem";var u=s.createElement("input");u.className="toolbar-submenu-checkbox",u.type="checkbox",u.id=t,l.appendChild(u);var d=s.createElement("label");return d.setAttribute("for",t),d.setAttribute("data-i18n",t),d.textContent=c.i18n.translate(t),l.appendChild(d),e.appendChild(l),u.checked=r,u.addEventListener("touchstart",a.touchStartToClick),d.addEventListener("touchstart",a.touchStartToClick),l.addEventListener("touchstart",a.touchStartToClick),u.addEventListener("click",function(e){n(u.checked),e.stopPropagation()}),d.addEventListener("click",function(e){e.stopPropagation()}),l.addEventListener("click",function(e){n(!u.checked),e.stopPropagation()}),i&&this.prefs.addListeners(i,function(e){u.checked=e},function(e){u.checked=e,n(e)}),u},n.prototype.addOptionList=function(e,t,r,n,i,o){var s=this.prefs[o];n="number"==typeof s?s:n;var a=function(e){var t=e.target.selectedIndex;i(t),e.stopPropagation()},l=this.getDocument(),u=l.createElement("select");u.className="option-drop-down",u.id="selectMenu_"+t;for(var d=0;d<r.length;d++){var h=l.createElement("option");h.value=d,h.setAttribute("data-i18n",r[d]),h.textContent=c.i18n.translate(r[d]),u.add(h)}var f=l.createElement("li");f.className="toolbar-submenu-select";var p=l.createElement("div");return p.className="toolbar-submenu-selectlabel",p.setAttribute("for",t),p.setAttribute("data-i18n",t),p.textContent=c.i18n.translate(t),f.appendChild(p),f.appendChild(u),e.appendChild(f),u.selectedIndex=n,u.onchange=a,u.addEventListener("touchstart",function(e){e.stopPropagation()}),u.addEventListener("click",function(e){e.stopPropagation()}),o&&this.prefs.addListeners(o,function(e){u.selectedIndex=e},function(e){u.selectedIndex=e,i(e)}),u},n.prototype.showViewer3dOptions=function(e){var t=this.getSettingsPanel(!0);e&&t.isVisible()&&t.setVisible(!1),t.setVisible(e)},n.prototype.showRenderingOptions=function(e){e&&this._createRenderingOptionsPanel(),this.renderoptions&&this.renderoptions.setVisible(e)},n.prototype._createRenderingOptionsPanel=function(){var e=this;if(!this.renderoptions&&!this.model.is2d()&&(this.renderoptions=new y.RenderOptionsPanel(this),this.addPanel(this.renderoptions),this.settingsTools&&!this.renderOptionsButton)){var t=new u.Button("toolbar-renderOptionsTool");t.setToolTip("Rendering options"),t.setIcon("adsk-icon-settings-render"),t.onClick=function(t){var r=e.renderoptions&&e.renderoptions.isVisible();e.renderoptions.setVisible(!r)},this.settingsTools.addControl(t)}},n.prototype.showLayerManager=function(e){g.logger.warn('viewer.showLayerManager() is now handled the extension "Autodesk.LayerManager" and will be removed in version 8.0.0.')},n.prototype.initHotkeys=function(){g.logger.warn("viewer.initHotkeys() has been deprecated and will be removed in version 8.0.0.")},n.prototype.setModelStructurePanel=function(e){g.logger.warn('viewer.setModelStructurePanel() is deprecated and will be removed in v8.0.0 - Use extension "Autodesk.ModelStructure".');var t=this.getExtension("Autodesk.ModelStructure");return t?t.setModelStructurePanel(e):!1},n.prototype.setLayersPanel=function(e){g.logger.warn('viewer.setLayersPanel() is now handled the extension "Autodesk.LayerManager" and will be removed in version 8.0.0.')},n.prototype.setPropertyPanel=function(e){g.logger.warn('viewer.setPropertyPanel() is now handled by extension "Autodesk.PropertiesManager" and will be removed in version 8.0.0.');var t=this.getExtension("Autodesk.PropertiesManager");return t?t.setPanel(e):!1},n.prototype.getPropertyPanel=function(e){g.logger.warn('viewer.getPropertyPanel() is now handled the extension "Autodesk.PropertiesManager" and will be removed in version 8.0.0.');var t=this.getExtension("Autodesk.PropertiesManager");return!t&&e&&(this.loadExtension("Autodesk.PropertiesManager"),t=this.getExtension("Autodesk.PropertiesManager")),t?t.getPanel():null},n.prototype.setSettingsPanel=function(e){var t=this;return e instanceof E.SettingsPanel||!e?(this.viewerSettingsPanel&&(this.viewerSettingsPanel.setVisible(!1),this.removePanel(this.viewerSettingsPanel),this.viewerSettingsPanel.uninitialize()),this.viewerSettingsPanel=e,e&&(this.addPanel(e),e.addVisibilityListener(function(r){r&&t.onPanelVisible(e,t),t.viewerOptionButton.setState(r?u.Button.State.ACTIVE:u.Button.State.INACTIVE)})),!0):!1},n.prototype.getSettingsPanel=function(e,t){return!this.viewerSettingsPanel&&e&&this.createSettingsPanel(t||this.model),this.viewerSettingsPanel},n.prototype.createSettingsPanel=function(e){var t=new S.ViewerSettingsPanel(this,e);this.setSettingsPanel(t),t.syncUI();var r=new u.Button("toolbar-settingsTool");this.viewerOptionButton=r,r.setIcon("adsk-icon-settings"),r.setToolTip("Settings"),this.settingsTools.addControl(r),this.createViewerOptionsMenu(e),this.dispatchEvent({type:M.SETTINGS_PANEL_CREATED_EVENT})},n.prototype.initModelTools=function(e){var t=this;if(this.createSettingsPanel(e),Object(a.getGlobal)().ENABLE_DEBUG&&this._createRenderingOptionsPanel(),this.canChangeScreenMode()&&!this.settingsTools.fullscreenbutton){var r=new u.Button("toolbar-fullscreenTool",{collapsible:!1});r.setToolTip("Full screen"),r.setIcon("adsk-icon-fullscreen"),r.onClick=function(e){t.nextScreenMode()},this.settingsTools.addControl(r),this.settingsTools.fullscreenbutton=r,this.updateFullscreenButton(this.getScreenMode())}},n.prototype.setPropertiesOnSelect=function(e){g.logger.warn('viewer.setPropertiesOnSelect() is now handled by viewer.prefs.set("openPropertiesOnSelect", <boolean>) and will be removed in version 8.0.0.'),this.prefs.set(T.Prefs.OPEN_PROPERTIES_ON_SELECT,e)},n.prototype.addDivider=function(e){var t=this.getDocument(),r=t.createElement("li");
return r.className="toolbar-submenu-horizontal-divider",e.appendChild(r),r},n.prototype.createViewerOptionsMenu=function(e){function t(){var e=r.getSettingsPanel(!0);e.isVisible()?r.showViewer3dOptions(!1):r.showViewer3dOptions(!0)}var r=this;this.viewerOptionButton.onClick=function(){t()}},n.prototype.initDebugTools=function(){if(this.debugMenu)return!1;var e=new d.ControlGroup("debugTools");this.debugMenu=e;var t=new u.Button("toolbar-debugTool");return t.setIcon("adsk-icon-bug"),e.addControl(t),this.debugMenu.debugSubMenuButton=t,this.createDebugSubmenu(this.debugMenu.debugSubMenuButton),this.toolbar.addControl(e),!0},n.prototype.removeDebugTools=function(){this.debugMenu&&(this.debugMenu.removeFromParent(),this.debugMenu=null)},n.prototype.createDebugSubmenu=function(e){function t(){r.localize()}var r=this,n=this.getDocument(),i=n.createElement("div");i.id="toolbar-debugToolSubmenu",i.classList.add("toolbar-submenu"),i.classList.add("toolbar-settings-sub-menu"),i.classList.add("adsk-hidden"),this.debugMenu.subMenu=i,this.debugMenu.subMenu.style.minWidth="180px",this.container.appendChild(i),this.initModelStats(),this.addDivider(i),this.addDivider(i);var o=_.Lang.getLanguages(),s=o.map(function(e){return e.label}),l=o.map(function(e){return e.symbol}),c=r.selectedLanguage?r.selectedLanguage:0,u=this.addOptionList(i,"Language",s,c,function(e){var n=l[e];r.selectedLanguage=e,Object(b.setLanguage)(n,t)},null);u.parentNode.style.paddingBottom="15px",this.addDivider(this.debugMenu.subMenu);var d=["UNKNOWN FAILURE","BAD DATA","NETWORK ERROR","NETWORK ACCESS DENIED","NETWORK FILE NOT FOUND","NETWORK SERVER ERROR","NETWORK UNHANDLED RESPONSE CODE","BROWSER WEBGL NOT SUPPORTED","BAD DATA NO VIEWABLE CONTENT"],h=this.addOptionList(i,"Error",d,0,function(e){var t=e+1;p.ErrorHandler.reportError(r.container,t,"")},null);h.parentNode.style.paddingBottom="15px";var f=i.getBoundingClientRect();this.debugMenu.subMenu.style.width=f.width+"px",this.container.removeChild(i),e.container.appendChild(i);var m=f.left+f.width,g=this.container.getBoundingClientRect().right;if(m>g){var v=-(m-g+10)+"px";this.debugMenu.subMenu.style.left=v}e.onMouseOver=function(e){i.classList.remove("adsk-hidden")},e.onMouseOut=function(e){i.classList.add("adsk-hidden")},Object(a.isTouchDevice)()&&(e.onClick=function(e){i.classList.toggle("adsk-hidden")})},n.prototype.initModelStats=function(){function e(e){var t=r.impl,n="",i=r.model;i&&(n+="Geom&nbsp;polys:&nbsp;"+t.modelQueue().getGeometryList().geomPolyCount+"<br>",n+="Instance&nbsp;polys:&nbsp;"+t.modelQueue().getGeometryList().instancePolyCount+"<br>",n+="Fragments:&nbsp;"+t.modelQueue().getFragmentList().getCount()+"<br>",n+="Geoms:&nbsp;"+t.modelQueue().getGeometryList().geoms.length+"<br>",n+="Loading&nbsp;time:&nbsp;"+(t.model.loader.loadTime/1e3).toFixed(2)+" s<br>"),n+="# "+(e||""),r.modelStats.innerHTML=n}function t(){var t=r.getDocument();r.modelStats=t.createElement("div"),r.modelStats.className="statspanel",r.container.appendChild(r.modelStats),r.addEventListener(s.PROGRESS_UPDATE_EVENT,function(t){t.message&&e(t.message)}),r.fpsDisplay=t.createElement("div"),r.fpsDisplay.className="fps",r.container.appendChild(r.fpsDisplay)}var r=this;this.addOptionToggle(this.debugMenu.subMenu,"Model statistics",!1,function(n){n&&!r.modelStats&&(t(),e("")),r.modelStats.style.visibility=n?"visible":"hidden",r.fpsDisplay.style.visibility=n?"visible":"hidden",n?r.impl.fpsCallback=function(e){r.fpsDisplay.textContent=""+(0|e)}:r.impl.fpsCallback=null})},n.prototype.initEscapeHandlers=function(){var e=this;this.addEventListener(s.ESCAPE_EVENT,function(t){if(!e.contextMenu||!e.contextMenu.hide()){if(e.renderoptions&&e.renderoptions.isVisible())return void e.renderoptions.setVisible(!1);if(e.impl.selector.hasSelection())return void e.clearSelection();if(e.getActiveNavigationTool()!==e.getDefaultNavigationToolName())return e.toolController&&e.toolController.setIsLocked(!1),e.setActiveNavigationTool(),void x.HudMessage.dismiss();if(!e.areAllVisible())return void e.showAll();if(!w.AlertBox.dismiss()){for(var r=0;r<e.dockingPanels.length;++r){var n=e.dockingPanels[r];if("none"!==n.container.style.display&&""!==n.container.style.display)return void n.setVisible(!1)}e.escapeScreenMode()}}})},n.prototype.getToolbar=function(){return this.toolbar},n.prototype._createToolbar=function(){return this.toolbar?!1:(this.toolbar=new h.ToolBar("guiviewer3d-toolbar"),this.toolbar.setGlobalManager(this.globalManager),this.navTools=new f.RadioButtonGroup(M.TOOLBAR.NAVTOOLSID),this.modelTools=new d.ControlGroup(M.TOOLBAR.MODELTOOLSID),this.settingsTools=new d.ControlGroup(M.TOOLBAR.SETTINGSTOOLSID),this.toolbar.addControl(this.navTools),this.toolbar.addControl(this.modelTools),this.toolbar.addControl(this.settingsTools),this.container.appendChild(this.toolbar.container),this.updateToolbarButtons(this.container.clientWidth,this.container.clientHeight),!0)},n.prototype.showModelStructurePanel=function(e){g.logger.warn('viewer.showModelStructurePanel() is deprecated and will be removed in v8.0.0 - Use extension "Autodesk.ModelStructure".'),e?this.activateExtension("Autodesk.ModelStructure"):this.deactivateExtension("Autodesk.ModelStructure")},n.prototype.onPanelVisible=function(e){this.dockingPanels.splice(this.dockingPanels.indexOf(e),1),this.dockingPanels.splice(0,0,e)},n.prototype.updateFullscreenButton=function(e){var t="adsk-icon-fullscreen";switch(e){case l.ScreenMode.kNormal:this.isScreenModeSupported(l.ScreenMode.kFullBrowser)||(t="adsk-icon-fullscreen");break;case l.ScreenMode.kFullBrowser:t=this.isScreenModeSupported(l.ScreenMode.kFullScreen)?"adsk-icon-fullscreen":"adsk-icon-fullscreen-exit";break;case l.ScreenMode.kFullScreen:t="adsk-icon-fullscreen-exit"}this.settingsTools.fullscreenbutton.setIcon(t)},n.prototype.localize=function(){i.Viewer3D.prototype.localize.call(this),this.debugMenu&&this.debugMenu.debugSubMenuButton&&(this.debugMenu.debugSubMenuButton.container.removeChild(this.debugMenu.subMenu),this.createDebugSubmenu(this.debugMenu.debugSubMenuButton)),p.ErrorHandler.localize()},n.prototype.addPanel=function(e){var t=this.dockingPanels.indexOf(e);return-1===t?(this.dockingPanels.push(e),!0):!1},n.prototype.removePanel=function(e){var t=this.dockingPanels.indexOf(e);return t>-1?(this.dockingPanels.splice(t,1),!0):!1},n.prototype.resizePanels=function(e){e=e||{};var t=this.toolbar?this.toolbar.getDimensions().height:0,r=this.getDimensions(),n=r.height;e.dimensions&&e.dimensions.height?n=e.dimensions.height:e.dimensions={height:r.height,width:r.width},e.dimensions.height=n-t;var i=this,o=e?e.dockingPanels:null;o||(o=i.dockingPanels);var s,a,l=i.container.getBoundingClientRect(),c=l.top,u=l.bottom,d=l.left,h=l.right;e&&e.dimensions?(s=e.dimensions.width,a=e.dimensions.height,u=e.dimensions.height):(s=l.width,a=l.height);for(var f=0;f<o.length;++f)o[f].onViewerResize(c,u,d,h,s,a)},n.prototype.initExplodeSlider=function(){g.logger.warn('viewer.initExplodeSlider() has been replaced by extension "Autodesk.Explode". initExplodeSlier() will be removed in version 7.0.0.')},n.prototype.initInspectTools=function(){var e=new u.Button("toolbar-inspectTools");e.setToolTip("Inspect"),e.setIcon("measure"),e.setVisible(!1),this.modelTools.addControl(e);var t=new f.RadioButtonGroup("toolbar-inspectSubMenu");t.addClass("toolbar-vertical-group"),t.setVisible(!1),this.modelTools.addControl(t),e.container.insertBefore(t.container,e.container.firstChild),e.onMouseOver=function(){t.setVisible(!0)},e.onMouseOut=function(){t.setVisible(!1)},Object(a.isTouchDevice)()&&(e.onClick=function(e){t.setVisible(!t.isVisible())})},n.prototype.initModality=function(){function e(t){for(var r=2,n=0;r>n&&t.parentElement;){var i=t.id;if(0===i.indexOf("toolbar-")){if(i.indexOf("arrow")===i.length-5)return;var o=e(t.parentElement);return o||t}t=t.parentElement,n++}}function t(e){return e.id.substring(8,e.id.length)}function r(e){return e.classList.contains("active")}function n(e){var t=e.ownerDocument,r=t.createEvent("Event");r.initEvent("click",!0,!0),e.dispatchEvent(r)}function i(e,t,r){a[e]=r?t:void 0}function o(o){var l=(o.target.getAttribute("class")||"").split(/\s+/);if(-1===l.indexOf("clickoff")){var c=e(o.target);if(c){var u=t(c);if(s[u]&&("sectionTool"!==u||-1===l.indexOf("adsk-icon-section-analysis")&&!o.target.querySelector(".adsk-icon-section-analysis"))&&("measureTool"!==u||-1===l.indexOf("adsk-icon-measure-menu")&&!o.target.querySelector(".adsk-icon-measure-menu"))){a[u]&&i(u,c,!1);for(var d in a){var h=a[d];if(h){var f=t(h);r(h)?s[u][f]||n(h):i(f,h,!1)}}i(u,c,!0)}}}}var s={orbitTools:{explodeTool:1},panTool:{explodeTool:1},zoomTool:{explodeTool:1},beelineTool:{},sectionTool:{measureTool:0,calibrateTool:0},explodeTool:{measureTool:0,calibrateTool:0,firstPersonTool:1,bimWalkTool:1},measureTool:{sectionTool:0},firstPersonTool:{explodeTool:1},bimWalkTool:{explodeTool:1,sectionTool:1}},a={};this.toolbar.container.addEventListener("click",o,!0)},n.prototype.updateToolbarButtons=function(e,t){var r=this.getToolbar();if(r){var n,i;i=e>310?"block":"none",n=this.modelTools.getControl("toolbar-explodeTool"),n&&n.setDisplay(i),i=e>380?"block":"none",n=this.modelTools.getControl("toolbar-collaborateTool"),n&&n.setDisplay(i),i=e>515?"block":"none";var o=this.navTools.getControl("toolbar-cameraSubmenuTool");o&&(o.setDisplay(i),n=o.subMenu.getControl("toolbar-homeTool"),n&&n.setDisplay(this.navigation.isActionEnabled("gotoview")?"block":"none"),n=o.subMenu.getControl("toolbar-fitToViewTool"),n&&n.setDisplay(this.navigation.isActionEnabled("gotoview")?"block":"none"),n=o.subMenu.getControl("toolbar-focalLengthTool"),n&&n.setDisplay(this.navigation.isActionEnabled("fov")?"block":"none"),n=o.subMenu.getControl("toolbar-rollTool"),n&&n.setDisplay(this.navigation.isActionEnabled("roll")?"block":"none")),i=e>700?"block":"none",n=this.modelTools.getControl("toolbar-measureTool"),n&&n.setDisplay(i),n=this.modelTools.getControl("toolbar-sectionTool"),n&&n.setDisplay(i),i=e>740?"block":"none",n=this.navTools.getControl("toolbar-beelineTool"),n&&n.setDisplay(this.navigation.isActionEnabled("walk")?i:"none"),n=this.navTools.getControl("toolbar-firstPersonTool"),n&&n.setDisplay(this.navigation.isActionEnabled("walk")?i:"none"),n=this.navTools.getControl("toolbar-zoomTool"),n&&n.setDisplay(this.navigation.isActionEnabled("zoom")?i:"none"),n=this.navTools.getControl("toolbar-panTool"),n&&n.setDisplay(this.navigation.isActionEnabled("pan")?i:"none"),n=this.navTools.getControl("toolbar-orbitTools"),n&&n.setDisplay(this.navigation.isActionEnabled("orbit")?i:"none"),this.customizeToolbarCB&&this.customizeToolbarCB(this,e,t)}},n.prototype.registerCustomizeToolbarCB=function(e){this.customizeToolbarCB=e,this.updateToolbarButtons(this.container.clientWidth,this.container.clientHeight)},Autodesk.Viewing.Private.GuiViewer3D=n},"./src/gui/GuiViewerToolbarConst.js":function(e,t,r){"use strict";r.r(t),r.d(t,"TOOLBAR_CREATED_EVENT",function(){return n}),r.d(t,"SETTINGS_PANEL_CREATED_EVENT",function(){return i}),r.d(t,"VIEW_CUBE_CREATED_EVENT",function(){return o}),r.d(t,"TOOLBAR",function(){return s});var n="toolbarCreated",i="settingsPanelCreated",o="viewCubeCreated",s={NAVTOOLSID:"navTools",MODELTOOLSID:"modelTools",SETTINGSTOOLSID:"settingsTools",MEASURETOOLSID:"measureTools"}},"./src/gui/HudMessage.css":function(e,t,r){},"./src/gui/HudMessage.js":function(e,t,r){"use strict";function n(){}r.r(t),r.d(t,"HudMessage",function(){return n});var i=r("./src/globalization/i18next.js");n.instances=[],n.displayMessage=function(e,t,r,o,s){function a(e){var t=d.getComputedStyle(e),r={top:parseInt(t["margin-top"]),bottom:parseInt(t["margin-bottom"])},n=e.getBoundingClientRect();return n.height+r.top+r.bottom}function l(e,t,r){var n=d.getComputedStyle(e,null);if(!Array.isArray(t))return n[t];for(var i=r?r:{},o=0;o<t.length;o++){var s=t[o];i[s]=n[s]}return i}function c(e){var t=e.textContent,r=["font-size","font-weight","text-transform","padding","white-space","font-family"],n=u.createElement("span");l(e,r,n.style),n.textContent=t,n.style.position="absolute",n.style.top="10000px",n.style.left="-10000px",u.body.appendChild(n);var i=n.offsetWidth;return u.body.removeChild(n),i}var u=e.ownerDocument,d=u.defaultView||u.parentWindow;if(!(n.instances.length>0)){var h=t.msgTitleKey,f=t.msgTitleDefaultValue||h,p=t.messageKey,m=t.messageDefaultValue||p,g=t.buttonText,v=t.checkboxChecked||!1,y=u.createElement("div");y.classList.add("docking-panel"),y.classList.add("hud"),e.appendChild(y);var _=u.createElement("div");_.classList.add("docking-panel-title"),_.classList.add("docking-panel-delimiter-shadow"),_.textContent=i.i18n.translate(h,{defaultValue:f}),_.setAttribute("data-i18n",h),y.appendChild(_);var b;r&&(b=u.createElement("div"),b.classList.add("docking-panel-close"),b.addEventListener("click",function(e){n.dismiss(),r&&r(e)}),y.appendChild(b));var x=l(_,["width","font-size"]),w=c(_),E=parseFloat(x["font-size"]),S=b?parseFloat(l(b,"width")):0,A=parseFloat(x.width)-S;_.style["font-size"]=w>A?"".concat(A/w*E,"px"):"".concat(E,"px");var M=u.createElement("div");M.classList.add("hud-client"),M.classList.add("docking-panel-container-solid-color-b"),y.appendChild(M);var T=u.createElement("div");T.className="hud-message",T.textContent=i.i18n.translate(p,{defaultValue:m}),T.setAttribute("data-i18n",m),M.appendChild(T);var C=a(T);if(o){var j=u.createElement("div");j.classList.add("docking-panel-primary-button"),j.classList.add("hud-button"),j.textContent=i.i18n.translate(g,{defaultValue:g}),j.setAttribute("data-i18n",g),j.addEventListener("click",o),M.appendChild(j),C+=a(j)}if(s){var P=u.createElement("div"),L=u.createElement("input");L.className="hud-checkbox",L.type="checkbox",L.checked=v,P.appendChild(L);var D="Do not show this message again",I=u.createElement("label");I.setAttribute("for",D),I.setAttribute("data-i18n",D),I.textContent=i.i18n.translate(D,{defaultValue:D}),P.appendChild(I),L.addEventListener("change",s),M.appendChild(P),C+=a(s)}M.style.height=C+"px",y.style.height=C+a(_)+"px";var R={hudMessage:y,container:e};n.instances.push(R)}},n.dismiss=function(){if(n.instances.length>0){var e=n.instances.pop();return e.hudMessage.style.visibility="hidden",e.container.removeChild(e.hudMessage),!0}return!1}},"./src/gui/LightPresetThumbnails.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e,t,r){return e=parseInt(e),t=parseInt(t),r=parseInt(r),"#"+a(e)+a(t)+a(r)}function a(e){if(0===e)return"00";for(var t="",r=e>255?255:e;0!==r;){var n=r%16;r=r/16|0,t=u[n.toString()]+t}return t.length>1?t:"0"+t}r.r(t),r.d(t,"LightPresetThumbnails",function(){return c});var l=r("./src/application/GlobalManagerMixin.js"),c=function(){function e(t,r){n(this,e),this._width=t||60,this._height=r||60}return o(e,[{key:"createThumbnail",value:function(e,t){var r=this;return new Promise(function(t){var n=r.getDocument(),i=n.createElement("canvas");i.width=r._width,i.height=r._height;var o=i.getContext("2d"),a=o.createLinearGradient(0,0,0,i.height),l=e.bgColorGradient,c=s(l[0],l[1],l[2]),u=s(l[3],l[4],l[5]);a.addColorStop(0,c),a.addColorStop(1,u),o.fillStyle=a,o.fillRect(0,0,i.width,i.height),i.toBlob(function(e){var r=URL.createObjectURL(e);t(r)})})}}]),e}();l.GlobalManagerMixin.call(c.prototype);var u={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"}},"./src/gui/LoadingSpinner.css":function(e,t,r){},"./src/gui/LoadingSpinner.js":function(e,t,r){"use strict";function n(e){this.parentDiv=e;var t=this.getDocument();this.container=t.createElement("div"),this.container.innerHTML=['<div class="path">','<svg width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">','<path d="M2.5,50a47.5,47.5 0 1,0 95,0a47.5,47.5 0 1,0 -95,0" vector-effect="non-scaling-stroke"/>','<path d="M 2.5 50 A 47.5 47.5 0 0 1 47.5 2.5" vector-effect="non-scaling-stroke"/>',"</svg>","</div>",'<div class="message" data-i18n="Spinner Loading">LOADING</div>'].join(""),this.container.className="loading-spinner"}r.r(t),r.d(t,"LoadingSpinner",function(){return n});var i=r("./src/globalization/i18next.js"),o=r("./src/application/GlobalManagerMixin.js");o.GlobalManagerMixin.call(n.prototype),n.prototype.addClass=function(e){this.container.classList.add(e)},n.prototype.attachToDom=function(){return this.container.parentNode?!1:(i.i18n.localize(this.container),this.parentDiv.appendChild(this.container),!0)},n.prototype.removeFromDom=function(){return this.container.parentNode?(this.container.parentNode.removeChild(this.container),!0):!1},n.prototype.setVisible=function(e){e?this.attachToDom():this.removeFromDom()}},"./src/gui/ModelStructurePanel.css":function(e,t,r){},"./src/gui/ModelStructurePanel.js":function(e,t,r){"use strict";function n(e,t,r,n){i.DockingPanel.call(this,e,t,r,n),this.container.classList.add("model-structure-panel"),n=n||{},n.heightAdjustment||(n.heightAdjustment=40),n.marginTop||(n.marginTop=0),n.left=!0,this.createScrollContainer(n),this.onScroll=this.onScroll.bind(this),this.scrollContainer.addEventListener("scroll",this.onScroll),this.scrollContainer.style["overflow-x"]="hidden",this.options=n,this.tree=null,this._pendingModels=[],this.uiCreated=!1;var o=this;this.addVisibilityListener(function(e){e&&(o.uiCreated||o.createUI(),o.resizeToContent())})}r.r(t),r.d(t,"ModelStructurePanel",function(){return n});var i=r("./src/gui/DockingPanel.js"),o=r("./src/gui/TreeOnDemand.js"),s=r("./src/gui/ModelStructureTreeDelegate.js");n.prototype=Object.create(i.DockingPanel.prototype),n.prototype.constructor=n,n.prototype.uninitialize=function(e){this.scrollContainer.addEventListener("scroll",this.onScroll),this.scrollContainer.parentNode.removeChild(this.scrollContainer),i.DockingPanel.prototype.uninitialize.call(this)},n.prototype.addModel=function(e){if(e)if(this.uiCreated)this.createTreeUI(e);else{var t=this._pendingModels.indexOf(e);if(-1!==t)return;this._pendingModels.push(e)}},n.prototype.unloadModel=function(e){if(e)if(this.uiCreated)this.removeTreeUI(e);else{var t=this._pendingModels.indexOf(e);if(-1===t)return;this._pendingModels.splice(t,1)}},n.prototype.createUI=function(){if(!this.uiCreated){var e,t="";if(this.options&&this.options.defaultTitle?(t=this.options.defaultTitle,e=void 0!==this.options.localizeTitle?!!this.options.localizeTitle:!0):(t=this.modelTitle,e=!1),t||(t="Browser",e=!0),this.setTitle(t,{localizeTitle:e}),this.uiCreated=!0,this.tree=new o.TreeOnDemand(this.scrollContainer,this.options),this.tree.setGlobalManager(this.globalManager),0!==this._pendingModels.length){for(var r=0;r<this._pendingModels.length;++r)this.createTreeUI(this._pendingModels[r]);this._pendingModels=[]}}},n.prototype.createTreeUI=function(e){if(this.tree.getDelegate(e.id))return!1;var t=new s.ModelStructureTreeDelegate(this,e);t.setGlobalManager(this.globalManager),this.tree.pushDelegate(t);var r=this;return e.getObjectTree(function(e){r.setInstanceTree(t,e)},function(){r.setInstanceTree(t,null)}),!0},n.prototype.setInstanceTree=function(e,t){this.tree.setInstanceTree(e,t)},n.prototype.removeTreeUI=function(e){this.tree.removeDelegate(e.id)&&(this.scrollContainer.scrollTop=0,this.onScroll())},n.prototype.onScroll=function(e){this.tree.setScroll(this.scrollContainer.scrollTop)},n.prototype.getNodeLabel=function(e){return this.myDelegate.getNodeLabel(e)},n.prototype.onTreeNodeClick=function(e,t,r,n){throw new Error("Method must be overriden.")},n.prototype.onTreeNodeRightClick=function(e,t,r,n){throw new Error("Method must be overriden.")},n.prototype.onTitleClick=function(e){},n.prototype.onTitleDoubleClick=function(e){}},"./src/gui/ModelStructureTreeDelegate.css":function(e,t,r){},"./src/gui/ModelStructureTreeDelegate.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){l.TreeDelegate.call(this),this.panel=e,this.model=t;var r=this.getDocument();this.modelDiv=r.createElement("div"),this.modelDiv.classList.add("model-div"),this.modelDiv.setAttribute("lmv-modelId",t.id),this.instanceTree=null,this.rootId=m,this.state=h}function o(e){var t=e.instanceTree;if(t){var r,n=e.rootId,i=t.getNodeName(n),o=0,s=0;t.enumNodeChildren(n,function(e){s||(r=t.getNodeName(e),o=e),s++}),e.hasDoubleRoot=1===s&&i===r,e.rootId=e.hasDoubleRoot?o:n}}function s(e){var t=a(e);if(t)return t;var r=e.getData();if(!r)return"";var n=e.getDocumentNode();return n?n.getModelName():"Model"}function a(e){var t=e.getData();return t&&t.loadOptions&&t.loadOptions.modelNameOverride?t.loadOptions.modelNameOverride:""}r.r(t),r.d(t,"ModelStructureTreeDelegate",function(){return i});var l=r("./src/gui/TreeDelegate.js"),c=r("./src/logger/Logger.js"),u=r("./src/globals.js"),d=r("./src/globalization/i18next.js"),h=1,f=2,p=3,m=-1,g=-2,v=-1e10;i.prototype=Object.create(l.TreeDelegate.prototype),i.prototype.constructor=i,i.prototype.isLoading=function(){return this.state===h},i.prototype.isAvailable=function(){return this.state===f},i.prototype.isNotAvailable=function(){return this.state===p},i.prototype.isControlId=function(e){return e===m||e===g},i.prototype.getControlIdCss=function(e){return null},i.prototype.getRootId=function(){return this.rootId},i.prototype.getTreeNodeId=function(e){return"object"==n(e)?(c.logger.warn("Object used instead of dbId. Fix it."),e.dbId):e},i.prototype.getTreeNodeIndex=function(e){return this.instanceTree.nodeAccess.dbIdToIndex[e]},i.prototype.getTreeNodeLabel=function(e){if(e===m){var t=s(this.model);return d.i18n.translate("Loading model",{name:t})}if(e===g){var t=s(this.model);return t}if(e===this.getRootId()){var t=s(this.model);return t}if(e==v)return"Object 0";var r=this.instanceTree.getNodeName(e,!0);return r||"Object "+e},i.prototype.getTreeNodeClass=function(e){return e===m||e===g?"message-unexpected":""},i.prototype.getTreeNodeParentId=function(e){if(e===v)return 0;var t=this.instanceTree.nodeAccess.getParentId(e);return 0===t?v:t},i.prototype.getTreeNodeCount=function(){return this.instanceTree.nodeAccess.getNumNodes()},i.prototype.getTreeNodeClientHeight=function(e){return 36},i.prototype.getTreeNodeDepthOffset=function(e,t){return 13+25*t},i.prototype.isTreeNodeGroup=function(e){return this.isControlId(e)?!1:this.instanceTree.getChildCount(e)>0},i.prototype.shouldCreateTreeNode=function(e){return!0},i.prototype.createTreeNode=function(e,t){var r=this,n=r.getDocument();if(t.addEventListener("mousedown",function(){var e=function(){this.classList.remove("highlight"),r.removeDocumentEventListener("mouseup",e)}.bind(t);t.classList.add("highlight"),r.addDocumentEventListener("mouseup",e)}),!this.isControlId(e)){var i=n.createElement("div");i.dbId=e,i.classList.add("visibility"),i.addEventListener("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),i.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=parseInt(e.target.dbId);this.panel.onEyeIcon(t,this.model)}.bind(this)),t.appendChild(i)}if(e===m){var o=n.createElement("img");o.src=Object(u.getResourceUrl)("res/ui/spinner.png"),o.style.animation="loading-spinner-perpetual-motion 1s infinite linear",o.style["float"]="right",o.style.marginRight="5px",o.style.width="20px",t.appendChild(o)}var s={localize:e===m||e===g};l.TreeDelegate.prototype.createTreeNode.call(this,e,t,s)},i.prototype.onTreeNodeRightClick=function(e,t,r){this.isControlId(t)||this.panel.onTreeNodeRightClick(e,t,this.model,r)},i.prototype.onTreeNodeClick=function(e,t,r){this.isControlId(t)||this.panel.onTreeNodeClick(e,t,this.model,r)},i.prototype.onTreeNodeDoubleClick=function(e,t,r){},i.prototype.onTreeNodeIconClick=function(e,t,r){if(this.isTreeNodeGroup(t)){var n=e.isCollapsed(this,t);e.setCollapsed(this,t,!n)}},i.prototype.onTreeNodeReized=function(e){},i.prototype.forEachChild=function(e,t,r){this.isControlId(e)||this.instanceTree.enumNodeChildren(e,t,r)},i.prototype.setInstanceTree=function(e){this.instanceTree=e,this.state=e?f:p,this.rootId=e?e.getRootId():g,o(this)},i.prototype.clean=function(){for(var e,t=this.modelDiv;e=t.lastChild;)t.removeChild(e)}},"./src/gui/ObjectContextMenu.js":function(e,t,r){"use strict";function n(e){this.viewer=e,this.setGlobalManager(e.globalManager),this.contextMenu=new i.ContextMenu(e)}r.r(t),r.d(t,"ObjectContextMenu",function(){return n});var i=r("./src/gui/ContextMenu.js"),o=r("./src/application/GlobalManagerMixin.js");n.prototype.constructor=n,o.GlobalManagerMixin.call(n.prototype),n.prototype.show=function(e){var t=this.viewer.getSelectionCount(),r=this.viewer.getSelectionVisibility(),n=this.viewer.impl.getCanvasBoundingClientRect(),i={event:e,numSelected:t,hasSelected:t>0,hasVisible:r.hasVisible,hasHidden:r.hasHidden,canvasX:e.clientX-n.left,canvasY:e.clientY-n.top},o=this.buildMenu(e,i);this.viewer.runContextMenuCallbacks(o,i),o&&0<o.length&&this.contextMenu.show(e,o)},n.prototype.hide=function(){return this.contextMenu.hide()},n.prototype.buildMenu=function(e,t){return null}},"./src/gui/Panel.css":function(e,t,r){},"./src/gui/ProgressBar.css":function(e,t,r){},"./src/gui/ProgressBar.js":function(e,t,r){"use strict";function n(e){var t=e.ownerDocument;this.bg=t.createElement("div"),this.bg.className="progressbg",this.fg=t.createElement("div"),this.fg.className="progressfg",this.bg.appendChild(this.fg),e.appendChild(this.bg),this.lastValue=-1,this.fg.style.width="0%"}r.r(t),r.d(t,"ProgressBar",function(){return n}),n.prototype.setPercent=function(e){e!=this.lastValue&&(this.lastValue=e,e>=99?this.bg.style.visibility="hidden":(this.bg.style.visibility="visible",this.fg.style.width=e+"%"))},n.prototype.setStyle=function(e){!this.fg.classList.contains(e)&&this.fg.classList.add(e)},n.prototype.removeStyle=function(e){this.fg.classList.contains(e)&&this.fg.classList.remove(e)}},"./src/gui/PropertyPanel.css":function(e,t,r){},"./src/gui/PropertyPanel.js":function(e,t,r){"use strict";function n(e,t,r,n){function i(){function e(e){return"category"===e.type}var t=new s.TreeDelegate;return t.setGlobalManager(l.globalManager),t.getTreeNodeId=function(e){return e.name+(e.hasOwnProperty("value")?e.value:"")+(e.hasOwnProperty("category")?e.category:"")},t.getTreeNodeClass=function(t){return e(t)?l.getCategoryClass(t):l.getPropertyClass(t)},t.isTreeNodeGroup=function(t){return e(t)},t.onTreeNodeClick=function(t,r,n){e(r)?l.onCategoryClick(r,n):l.onPropertyClick(r,n)},t.onTreeNodeRightClick=function(t,r,n){e(r)?l.onCategoryRightClick(r,n):l.onPropertyRightClick(r,n)},t.onTreeNodeDoubleClick=function(t,r,n){e(r)?l.onCategoryDoubleClick(r,n):l.onPropertyDoubleClick(r,n)},t.onTreeNodeIconClick=function(t,r,n){e(r)?l.onCategoryIconClick(r,n):l.onPropertyIconClick(r,n)},t.createTreeNode=function(t,r,n){var i=null;i=e(t)?l.displayCategory(t,r,n):l.displayProperty(t,r,n),i&&(l.highlightableElements[this.getTreeNodeId(t)]=i)},t}o.DockingPanel.call(this,e,t,r,n),this.title.classList.add("docking-panel-delimiter-shadow"),this.container.classList.add("property-panel"),this.container.dockRight=!0,this.createScrollContainer({left:!1,heightAdjustment:70,marginTop:0}),this.highlightableElements={};var l=this,c=i();this.tree=new a.Tree(c,null,this.scrollContainer,{}),this.tree.setGlobalManager(this.globalManager)}function i(e){e=String(e);var t=' target="blank" class="propertyLink" ',r=[{pattern:/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,value:"<a"+t+'href="$&">$&</a>'},{pattern:/(^|[^\/])(www\.[\S]+(\b|$))/gim,value:"$1<a"+t+'href="http://$2">$2</a>'}];return r.reduce(function(e,t){return e.replace(t.pattern,t.value)},e)}r.r(t),r.d(t,"PropertyPanel",function(){return n});var o=r("./src/gui/DockingPanel.js"),s=r("./src/gui/TreeDelegate.js"),a=r("./src/gui/Tree.js"),l=r("./src/measurement/UnitFormatter.js"),c=r("./src/globalization/i18next.js");n.prototype=Object.create(o.DockingPanel.prototype),n.prototype.constructor=n,n.prototype.setProperties=function(e,t){this.removeAllProperties();for(var r=[],n=[],i=0;i<e.length;i++){var o=e[i];if(!o.hidden){var s=e[i].displayCategory;s&&"string"==typeof s&&""!==s?r.push(o):n.push(o)}}if(r.length+n.length===0)return void this.showNoProperties();n[0]&&"Name"===n[0].displayName&&(this.addProperty(n[0].displayName,n[0].displayValue),n.shift());for(var a=Autodesk.Viewing.Private,c=this.viewer.prefs.get(a.Prefs.DISPLAY_UNITS),u=this.viewer.prefs.get(a.Prefs.DISPLAY_UNITS_PRECISION),i=0;i<r.length;i++){var o=r[i],d="number"==typeof u?u:o.precision||Object(l.calculatePrecision)(o.displayValue),h=Object(l.convertToDisplayUnits)(o.displayValue,o.units,c),f=Object(l.formatValueWithUnits)(h.displayValue,h.displayUnits,o.type,d);this.addProperty(o.displayName,f,o.displayCategory)}for(var p=r.length>0,i=0;i<n.length;i++){var o=n[i],d="number"==typeof u?u:o.precision||Object(l.calculatePrecision)(o.displayValue),h=Object(l.convertToDisplayUnits)(o.displayValue,o.units,c),f=Object(l.formatValueWithUnits)(h.displayValue,h.displayUnits,o.type,d);this.addProperty(o.displayName,f,p?"Other":"",p?{localizeCategory:!0}:{})}},n.prototype.showNoProperties=function(){this.removeAllProperties();var e=this.tree.myRootContainer,t=this.getDocument(),r=t.createElement("div");r.className="no-properties";var n="No properties to display";r.setAttribute("data-i18n",n),r.textContent=c.i18n.translate(n),e.appendChild(r)},n.prototype.showDefaultProperties=function(){this.showNoProperties(),this.resizeToContent()},n.prototype.areDefaultPropertiesShown=function(){return!this.hasProperties()},n.prototype.addProperty=function(e,t,r,n){var i=this.tree.getElementForNode({name:e,value:t,category:r});if(i)return!1;var o=null,s={name:e,value:t,type:"property"};return r?(o=this.tree.getElementForNode({name:r}),o||(o=this.tree.createElement_({name:r,type:"category"},this.tree.myRootContainer,n&&n.localizeCategory?{localize:!0}:null)),s.category=r):o=this.tree.myRootContainer,this.tree.createElement_(s,o,n&&n.localizeProperty?{localize:!0}:null),!0},n.prototype.hasProperties=function(){for(var e in this.highlightableElements)return!0;return!1},n.prototype.removeProperty=function(e,t,r,n){var i={name:e,value:t,category:r},o=this.tree.getElementForNode(i);return o?(delete this.highlightableElements[this.tree.delegate().getTreeNodeId(i)],o.parentNode.removeChild(o),!0):!1},n.prototype.removeAllProperties=function(){this.highlightableElements={},this.tree.clear()},n.prototype.setCategoryCollapsed=function(e,t){var r=this.tree.delegate().getTreeNodeId(e);this.tree.setCollapsed(r,t)},n.prototype.isCategoryCollapsed=function(e){var t=this.tree.delegate().getTreeNodeId(e);return this.tree.isCollapsed(t)},n.prototype.getContentSize=function(){var e=this.tree.myRootContainer;return{height:e.clientHeight+55,width:e.clientWidth}},n.prototype.highlight=function(e,t){function r(t){var r=t.innerHTML,n=r.replace(/(<highlight>|<\/highlight>)/gim,"");if(r!==n&&(t.innerHTML=n),e&&""!==e){var i=new RegExp("(\\b"+e+"\\b)","gim"),o=n.replace(i,"<highlight>$1</highlight>");t.innerHTML=o}}for(var n in this.highlightableElements)for(var i=this.highlightableElements[n],o=0;o<i.length;++o)r(i[o])},n.prototype.displayCategory=function(e,t,r){var n=this.getDocument(),i=n.createElement("div"),o=e.name;return r&&r.localize&&(i.setAttribute("data-i18n",o),o=c.i18n.translate(o)),i.textContent=o,i.title=o,i.className="category-name",t.appendChild(i),[i]},n.prototype.displayProperty=function(e,t,r){var n=this.getDocument(),o=n.createElement("div"),s=e.name;r&&r.localize&&(o.setAttribute("data-i18n",s),
s=c.i18n.translate(s)),o.textContent=s,o.title=s,o.className="property-name";var a=n.createElement("div");a.className="separator";var l=n.createElement("div");l.textContent=e.value;var u=e.value;return l.title=u,u=i(u),l.innerHTML=u,l.className="property-value",t.appendChild(o),t.appendChild(a),t.appendChild(l),[o,l]},n.prototype.getCategoryClass=function(e){return"category"},n.prototype.getPropertyClass=function(e){return"property"},n.prototype.onCategoryClick=function(e,t){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},n.prototype.onPropertyClick=function(e,t){},n.prototype.onCategoryIconClick=function(e,t){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},n.prototype.onPropertyIconClick=function(e,t){},n.prototype.onCategoryDoubleClick=function(e,t){},n.prototype.onPropertyDoubleClick=function(e,t){},n.prototype.onCategoryRightClick=function(e,t){},n.prototype.onPropertyRightClick=function(e,t){}},"./src/gui/RenderOptionsPanel.js":function(e,t,r){"use strict";function n(e){var t=this;this.viewer=e,this.setGlobalManager(e.globalManager),i.DockingPanel.call(this,e.container,"RenderOptionsPanel","Rendering Options");var r=this.getDocument();this.table=r.createElement("table"),this.table.className="adsk-lmv-tftable",this.tbody=r.createElement("tbody"),this.table.appendChild(this.tbody),this.createScrollContainer({heightAdjustment:70}),this.scrollContainer.appendChild(this.table),this.container.style.width="320px",this.container.style.top="260px",this.container.style.left="220px",this.container.style.height="460px",this.container.dockRight=!0,this.saoToggle=new a.OptionCheckbox("AO Enabled",this.tbody,!0),this.saoToggle.setGlobalManager(this.globalManager),this.addEventListener(this.saoToggle,"change",function(r){var n=t.saoToggle.checked;e.prefs.set("ambientShadows",n),e.setQualityLevel(n,e.impl.renderer().settings.antialias)}),this.saoRadius=new a.OptionSlider("AO Radius",0,200,this.tbody),this.saoRadius.setGlobalManager(this.globalManager),this.saoRadius.setValue(10),this.saoRadius.sliderElement.step=this.saoRadius.stepperElement.step=.01,this.addEventListener(this.saoRadius,"change",function(r){e.impl.renderer().setAOOptions(parseFloat(t.saoRadius.value),parseFloat(t.saoIntensity.value)),e.impl.renderer().composeFinalFrame()}),this.saoIntensity=new a.OptionSlider("AO Intensity",0,3,this.tbody),this.saoIntensity.setGlobalManager(this.globalManager),this.saoIntensity.setValue(.4),this.saoIntensity.sliderElement.step=this.saoIntensity.stepperElement.step=.01,this.addEventListener(this.saoIntensity,"change",function(r){e.impl.renderer().setAOOptions(parseFloat(t.saoRadius.value),parseFloat(t.saoIntensity.value)),e.impl.renderer().composeFinalFrame()}),this.groundShadowAlpha=new a.OptionSlider("Shadow Alpha",0,2,this.tbody),this.groundShadowAlpha.setGlobalManager(this.globalManager),this.groundShadowAlpha.setValue(1),this.groundShadowAlpha.sliderElement.step=this.groundShadowAlpha.stepperElement.step=.1,this.addEventListener(this.groundShadowAlpha,"change",function(r){e.setGroundShadowAlpha(parseFloat(t.groundShadowAlpha.value))}),this.groundShadowColor=new a.OptionCheckbox("Shadow Color",this.tbody),this.groundShadowColor.setGlobalManager(this.globalManager),s.isIE11||(this.groundShadowColor.checkElement.value="#000000",this.groundShadowColor.checkElement.type="color"),this.addEventListener(this.groundShadowColor,"change",function(r){var n=t.groundShadowColor.checkElement.value;e.setGroundShadowColor(new THREE.Color(parseInt(n.substr(1,7),16)))}),this.groundReflectionAlpha=new a.OptionSlider("Reflection Alpha",0,2,this.tbody),this.groundReflectionAlpha.setGlobalManager(this.globalManager),this.groundReflectionAlpha.setValue(1),this.groundReflectionAlpha.sliderElement.step=this.groundReflectionAlpha.stepperElement.step=.1,this.addEventListener(this.groundReflectionAlpha,"change",function(r){e.setGroundReflectionAlpha(parseFloat(t.groundReflectionAlpha.value))}),this.groundReflectionColor=new a.OptionCheckbox("Reflection Color",this.tbody),this.groundReflectionColor.setGlobalManager(this.globalManager),s.isIE11||(this.groundReflectionColor.checkElement.value="#000000",this.groundReflectionColor.checkElement.type="color"),this.addEventListener(this.groundReflectionColor,"change",function(r){var n=t.groundReflectionColor.checkElement.value;e.setGroundReflectionColor(new THREE.Color(parseInt(n.substr(1,7),16)))});for(var n=[],c=0;c<l.LightPresets.length;c++)n.push(l.LightPresets[c].name);this.envSelect=new a.OptionDropDown("Environment",this.tbody,n,e.impl.currentLightPreset()),this.envSelect.setGlobalManager(this.globalManager),this.addEventListener(this.envSelect,"change",function(r){var n=t.envSelect.selectedIndex;e.setLightPreset(n)});var u=e.impl.renderer().getToneMapMethod();this.toneMapMethod=new a.OptionDropDown("Tonemap Method",this.tbody,["None","Canon-Lum","Canon-RGB"],u),this.toneMapMethod.setGlobalManager(this.globalManager),this.addEventListener(this.toneMapMethod,"change",function(){var r=t.toneMapMethod.selectedIndex;e.impl.setTonemapMethod(r)}),this.exposureBias=new a.OptionSlider("Exposure Bias",-30,30,this.tbody),this.exposureBias.setGlobalManager(this.globalManager),this.exposureBias.setValue(e.impl.renderer().getExposureBias()),this.exposureBias.sliderElement.step=this.exposureBias.stepperElement.step=.1,this.addEventListener(this.exposureBias,"change",function(r){e.impl.setTonemapExposureBias(t.exposureBias.value,t.whiteScale.value)}),this.exposureBias.setDisabled(0==u),this.whiteScale=new a.OptionSlider("Light Intensity",-5,20,this.tbody),this.whiteScale.setGlobalManager(this.globalManager);var d=0;e.impl.dir_light1&&(d=0!=e.impl.dir_light1.intensity?Math.log(e.impl.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(d),this.whiteScale.sliderElement.step=this.whiteScale.stepperElement.step=.1,this.addEventListener(this.whiteScale,"change",function(r){e.impl.dir_light1.intensity=Math.pow(2,t.whiteScale.value),e.impl.setTonemapExposureBias(t.exposureBias.value,t.whiteScale.value)}),this.fovAngle=new a.OptionSlider("FOV-degrees",6.88,100,this.tbody),this.fovAngle.setGlobalManager(this.globalManager),this.fovAngle.setValue(e.getFOV()),this.addEventListener(this.fovAngle,"change",function(r){e.setFOV(parseFloat(t.fovAngle.value))}),this.frameRate=new a.OptionSlider("Frame rate:",1,100,this.tbody),this.frameRate.setGlobalManager(this.globalManager),this.frameRate.setValue(e.impl.getFrameRate()),this.frameRate.sliderElement.step=this.frameRate.stepperElement.step=1,this.addEventListener(this.frameRate,"change",function(r){e.impl.setFrameRate(t.frameRate.value)}),this.addEventListener(this.viewer,o.CAMERA_CHANGE_EVENT,function(r){var n=parseFloat(t.fovAngle.value),i=e.getFOV();n!=i&&t.fovAngle.setValue(i)}),this.addEventListener(this.viewer,o.RENDER_OPTION_CHANGED_EVENT,function(e){t.syncUI()}),this.addEventListener(this.viewer,o.VIEWER_STATE_RESTORED_EVENT,function(e){t.syncUI()}),this.addVisibilityListener(function(e){e&&t.resizeToContent()})}r.r(t),r.d(t,"RenderOptionsPanel",function(){return n});var i=r("./src/gui/DockingPanel.js"),o=r("./src/application/EventTypes.js"),s=(r.n(o),r("./src/compat.js")),a=r("./src/gui/CommonWidgets.js"),l=r("./src/application/LightPresets.js");n.prototype=Object.create(i.DockingPanel.prototype),n.prototype.constructor=n,n.prototype.getContentSize=function(){return{height:this.table.clientHeight+75,width:this.table.clientWidth}},n.prototype.syncUI=function(){var e=this.viewer.impl,t=0;e.dir_light1&&(t=0!=e.dir_light1.intensity?Math.log(e.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(t),this.exposureBias.setValue(e.renderer().getExposureBias());var r=e.renderer().getToneMapMethod();this.toneMapMethod.setSelectedIndex(r),this.envSelect.setSelectedIndex(e.currentLightPreset()),this.exposureBias.setDisabled(0==r),this.saoToggle.setValue(e.renderer().getAOEnabled()),this.saoRadius.setDisabled(!e.renderer().getAOEnabled()),this.saoIntensity.setDisabled(!e.renderer().getAOEnabled()),this.saoRadius.setValue(e.renderer().getAORadius()),this.saoIntensity.setValue(e.renderer().getAOIntensity()),this.groundShadowAlpha.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundShadowColor.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundReflectionAlpha.setDisabled(!this.viewer.prefs.get("groundReflection")),this.groundReflectionColor.setDisabled(!this.viewer.prefs.get("groundReflection")),this.fovAngle.setValue(this.viewer.getFOV())},n.prototype.uninitialize=function(){i.DockingPanel.prototype.uninitialize.call(this),this.table=null,this.tbody=null,this.saoToggle=null,this.saoRadius=null,this.saoIntensity=null,this.groundShadowAlpha=null,this.envSelect=null,this.toneMapMethod=null,this.exposureBias=null,this.whiteScale=null,this.fovAngle=null,this.viewer=null}},"./src/gui/SettingsPanel.css":function(e,t,r){},"./src/gui/SettingsPanel.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,r,n){o.DockingPanel.call(this,e,t,r,n),this.panelTabs=[],this.tabIdToIndex={},this.controls={},this.controlIdCount=0,this.shown=!1;var i=this,s=n&&void 0!==n.width?n.width:340;this.container.style.maxWidth="800px",this.container.style.minWidth=s+"px",this.container.style.top="10px",this.container.style.left=e.offsetWidth/2-170+"px",this.container.style.position="absolute";var a=this.getDocument();this.tabContainer=a.createElement("div"),this.tabContainer.classList.add("docking-panel-container-solid-color-b"),this.tabContainer.classList.add("settings-tabs"),this.tabContainer.classList.add("docking-panel-delimiter-shadow"),this.container.appendChild(this.tabContainer),this.tabs=a.createElement("ul"),this.tabContainer.appendChild(this.tabs),this.heightAdjustment=n&&n.heightAdjustment?n.heightAdjustment:179,n&&n.hideTabBar&&(this.heightAdjustment-=c,this.tabContainer.style.display="none",this.tabContainer.style.height=0),this.createScrollContainer({left:!1,heightAdjustment:this.heightAdjustment,marginTop:0}),this.tablesContainer=a.createElement("div"),this.tablesContainer.classList.add("settings-tabs-tables-container"),n&&n.hideTabBar&&(this.scrollContainer.style.top=90-c+"px"),this.scrollContainer.appendChild(this.tablesContainer),this.mouseOver=!1,this.addEventListener(this.container,"mouseover",function(e){var t=e.toElement||e.relatedTarget;if(i.mouseOver)return!0;for(var r=0,n=i.getWindow();t&&t.parentNode&&t.parentNode!=n;){if(t.parentNode==this||t==this){t.preventDefault&&t.preventDefault(),i.mouseOver=!0;for(var r=0;r<i.panelTabs.length;r++)i.panelTabs[r].classList.remove("selectedmouseout");return!0}t=t.parentNode}}),this.addEventListener(this.container,"mouseout",function(e){var t=e.toElement||e.relatedTarget;if(i.mouseOver){for(var r=i.getWindow();t&&t.parentNode&&t.parentNode!=r;){if(t.parentNode==this||t==this)return t.preventDefault&&t.preventDefault(),!1;t=t.parentNode}i.mouseOver=!1;for(var n=0;n<i.panelTabs.length;n++)i.panelTabs[n].classList.contains("tabselected")&&i.panelTabs[n].classList.add("selectedmouseout")}}),this.expandID=function(e){return t+"-"+e}}r.r(t),r.d(t,"SettingsPanel",function(){return i});var o=r("./src/gui/DockingPanel.js"),s=r("./src/globalization/i18next.js"),a=r("./src/compat.js"),l=r("./src/gui/CommonWidgets.js"),c=(r("./src/gui/controls/Button.js"),40);i.prototype=Object.create(o.DockingPanel.prototype),i.prototype.constructor=i,i.prototype.setVisible=function(e){e&&(this.container.style.display="block",this.shown||(this.resizeToContent(),this.container.style.left=this.parentContainer.offsetWidth/2-this.container.getBoundingClientRect().width/2+"px"),this.shown=!0),o.DockingPanel.prototype.setVisible.call(this,e)},i.prototype.addTab=function(e,t,r){function n(t){i.selectTab(e)}var i=this;if(void 0!==this.tabIdToIndex[e])return!1;var o=r&&void 0!==r.className?r.className:null,l=r&&void 0!==r.width?r.width:200,c=r&&void 0!==r.index?r.index:this.panelTabs.length,u=this.getDocument(),d=u.createElement("li");d._id=e,d.id=this.expandID(d._id),d.classList.add(o);var h=u.createElement("a"),f=u.createElement("span");f.setAttribute("data-i18n",t),f.textContent=s.i18n.translate(t),h.appendChild(f),d.appendChild(h),this.tabs.appendChild(d);var p=u.createElement("table");p._id=e+"-table",p.id=this.expandID(p._id),p.classList.add("settings-table"),p.classList.add("adsk-lmv-tftable"),p.classList.add(o);var m=u.createElement("tbody");m.style.display="table",m.style.width="100%",p.appendChild(m),this.tablesContainer.appendChild(p),this.addEventListener(d,"touchstart",a.touchStartToClick),this.addEventListener(d,"click",n),this.panelTabs.push(d),this.tabIdToIndex[e]=c;var g=this.container.style.minWidth?parseInt(this.container.style.minWidth):0;return l>g&&(this.container.style.minWidth=l+"px"),!0},i.prototype.removeTab=function(e){var t=this.tabIdToIndex[e];if(!t)return!1;this.panelTabs.splice(t,1);var r=this.getDocument(),n=r.getElementById(this.expandID(e));this.tabs.removeChild(n),this.tabIdToIndex={};for(var i=this.panelTabs.length,o=0;i>o;o++){var s=this.panelTabs[o];this.tabIdToIndex[s._id]=o,this.removeEventListener(s,"touchstart",a.touchStartToClick),this.removeEventListener(s,"click",select)}return!0},i.prototype.resizeTabs=function(){for(var e=this.tabs.getElementsByTagName("li"),t=100/e.length,r=0;r<e.length;r++)e[r].style.width=t+"%"},i.prototype.hasTab=function(e){var t=this.tabIdToIndex[e],r=this.panelTabs[t];return void 0!==r},i.prototype.selectTab=function(e){if(this.isTabSelected(e))return!1;for(var t=this.getDocument(),r=this.panelTabs.length,n=0;r>n;n++){var i=this.panelTabs[n],o=t.getElementById(this.expandID(i._id+"-table"));e===i._id?(i.classList.add("tabselected"),o.classList.add("settings-selected-table"),this.mouseOver||i.classList.add("selectedmouseout")):(i.classList.remove("tabselected"),o.classList.remove("settings-selected-table"),this.mouseOver||this.panelTabs[n].classList.remove("selectedmouseout"))}return this.scrollContainer.scrollTop=0,!0},i.prototype.isTabSelected=function(e){var t=this.tabIdToIndex[e],r=this.panelTabs[t];return r&&r.classList.contains("tabselected")},i.prototype.getSelectedTabId=function(){for(var e in this.tabIdToIndex)if(this.isTabSelected(e))return e;return null},i.prototype.addLabel=function(e,t){var r,n=this.tabIdToIndex[e];if(-1===n)return!1;r=this.tablesContainer.childNodes[n];var i=new l.OptionLabel(t,r.tBodies[0]);return i.setGlobalManager(this.globalManager),i.sliderRow.classList.add("logical-group"),i},i.prototype.addButton=function(e,t){var r=this.tabIdToIndex[e];if(void 0===r)return null;var n=this.tablesContainer.childNodes[r],i=new l.OptionButton(t,n.tBodies[0]);return i.setGlobalManager(this.globalManager),this.addControl(e,i)},i.prototype.addCheckbox=function(e,t,r,n,i,o){var s=this.tabIdToIndex[e];if(void 0===s)return null;var a=this.getDocument(),c=a.getElementById(this.expandID(e+"-table")),u=new l.OptionCheckbox(t,c.tBodies[0],r,i,o);return u.setGlobalManager(this.globalManager),u.changeListener=function(e){var t=e.detail.target.checked;n(t)},this.addEventListener(u,"change",u.changeListener),this.addControl(e,u)},i.prototype.addRow=function(e,t,r,n){var i=this.tabIdToIndex[e];if(void 0===i)return null;var o=this.getDocument(),s=o.getElementById(this.expandID(e+"-table")),a=new l.OptionRow(t,s.tBodies[0],r,n);return a.setGlobalManager(this.globalManager),this.addControl(e,a)},i.prototype.addSlider=function(e,t,r,n,i,o,s){var a=this.tabIdToIndex[e];if(void 0===a)return null;var c=this.getDocument(),u=c.getElementById(this.expandID(e+"-table")),d=new l.OptionSlider(t,r,n,u.tBodies[0],s);d.setGlobalManager(this.globalManager),d.setValue(i);var h=1;return s&&s.step&&(h=s.step),d.sliderElement.step=d.stepperElement.step=h,this.addEventListener(d,"change",function(e){o(e)}),this.addControl(e,d)},i.prototype.addSliderV2=function(e,t,r,n,i,o,s,a){a=a?a:{},a.hideStepper=!0,a.hideCaption=!0;var l=[];return l.push(this.addRow(e,t,r,a)),l.push(this.addSlider(e,t,n,i,o,s,a)),l},i.prototype.addDropDownMenu=function(e,t,r,n,i,o){var s=this.tabIdToIndex[e];if(void 0===s)return null;var a=this.getDocument(),c=a.getElementById(this.expandID(e+"-table")),u=new l.OptionDropDown(t,c.tBodies[0],r,n,null,this.globalManager,o);return u.setGlobalManager(this.globalManager),this.addEventListener(u,"change",function(e){i(e)}),this.addControl(e,u)},i.prototype.addControl=function(e,t,r){var n=this.tabIdToIndex[e];if(void 0===n)return null;if(!t.hasOwnProperty("sliderRow")){var i=r&&r.insertAtIndex?r.insertAtIndex:-1,o=r&&r.caption?r.caption:null,a=this.getDocument(),l=a.getElementById(this.expandID(e+"-table"));i>l.length&&(i=-1);var c=l.tBodies[0].insertRow(i),u=c.insertCell(0);if(o){var d=a.createElement("div");d.setAttribute("data-i18n",o),d.textContent=s.i18n.translate(o),u.appendChild(d),u=c.insertCell(1)}else u.colSpan=3;u.appendChild(t),t.sliderRow=c,t.tbody=l.tBodies[0]}var h=this.expandID("adsk_settings_control_id_"+this.controlIdCount.toString());return this.controlIdCount=this.controlIdCount+1,this.controls[h]=t,t.parent=this,h},i.prototype.removeButton=function(e){return this.removeControl(e)},i.prototype.removeCheckbox=function(e){return this.removeControl(e)},i.prototype.removeSlider=function(e){return this.removeControl(e)},i.prototype.removeDropdownMenu=function(e){return this.removeControl(e)},i.prototype.removeControl=function(e){var t;if("object"===n(e)&&e.tbody){t=e;for(var r in this.controls)if(this.controls[r]===t){e=r;break}}else t=this.controls[e];if(void 0===t)return!1;if(t.removeFromParent)t.removeFromParent();else{var i=t.tbody,o=t.sliderRow,s=o.rowIndex;i.deleteRow(s)}return delete this.controls[e],t.parent=void 0,!0},i.prototype.getControl=function(e){return this.controls[e]||null},i.prototype.getContentSize=function(){for(var e=this.heightAdjustment,t=0,r=this.getDocument(),n=0;n<this.panelTabs.length;n++){var i=this.panelTabs[n],o=r.getElementById(this.expandID(i._id+"-table")),s=o?o.clientHeight:0;t=Math.max(t,s)}return{height:e+t,width:this.container.clientWidth}},i.prototype.sizeToContent=function(e){var t=this.getContentSize(),r=t.height+this.heightAdjustment,n=e.clientHeight-this.heightAdjustment,i=Math.min(r,n);this.container.style.height=parseInt(i)+"px"},i.prototype.addSimpleList=function(e,t,r){var n=new l.SimpleList(e,t,r);return n.setGlobalManager(this.globalManager),n},i.prototype.removeSimpleList=function(e){return e?(e.removeFromParent(),!0):!1}},"./src/gui/Tree.css":function(e,t,r){},"./src/gui/Tree.js":function(e,t,r){"use strict";function n(e,t,r,n){this.myDelegate=e,this.mySelectedNodes=[],this.myOptions=n||{},this.parentContainer=r;var i="treeview";this.groupClassName=this.myOptions.groupClassName||"expanded",this.leafClassName=this.myOptions.leafClassName||"expanded",this.selectedClassName=this.myOptions.selectedClassName||"selected",this.myGroupNodes=[],this.nodeToElement={},this.nodeIdToNode={};var o=this.myRootContainer=this.createHtmlElement_(r,"div",i),s=this.rootElem=this.createElement_(t,o,n,0);this.setInputHandlers_(),n&&n.excludeRoot&&s.classList.add("exclude")}r.r(t),r.d(t,"Tree",function(){return n});var i=r("./src/compat.js"),o=r("./src/tools/GestureHandler.js"),s=r("./src/application/GlobalManagerMixin.js"),a=r("./thirdparty/hammer/hammer.js");n.prototype.constructor=n,s.GlobalManagerMixin.call(n.prototype),n.prototype.destroy=function(){this.myDelegate=null,this.parentContainer&&(this.parentContainer.removeChild(this.myRootContainer),this.myRootContainer=null,this.parentContainer=null)},n.prototype.show=function(e){var t=this.myRootContainer;e?t.style.display="block":t.style.display="none"},n.prototype.getRootContainer=function(){return this.myRootContainer},n.prototype.getElementForNode=function(e){return"number"!=typeof e&&"string"!=typeof e&&(e=this.myDelegate.getTreeNodeId(e)),this.nodeToElement[e]},n.prototype.delegate=function(){return this.myDelegate},n.prototype.isCollapsed=function(e){return this.hasClass(e,"collapsed")},n.prototype.setCollapsed=function(e,t,r){t?(this.addClass(e,"collapsed",r),this.removeClass(e,"expanded",r)):(this.addClass(e,"expanded",r),this.removeClass(e,"collapsed",r))},n.prototype.setAllCollapsed=function(e){var t,r;e?(t=function(e){return e.classList.contains("expanded")},r=function(e){e.classList.add("collapsed"),e.classList.remove("expanded")}):(t=function(e){return e.classList.contains("collapsed")},r=function(e){e.classList.add("expanded"),e.classList.remove("collapsed")});for(var n=0;n<this.myGroupNodes.length;++n){var i=this.myGroupNodes[n];t(i)&&r(i)}},n.prototype.addToSelection=function(e){function t(e){var t=r.mySelectedNodes.indexOf(e);return-1===t?(r.mySelectedNodes.push(e),!0):!1}for(var r=this,n=e.length,i=0;n>i;++i){var o=e[i];t(o)&&this.addClass(o,this.selectedClassName)}},n.prototype.removeFromSelection=function(e){function t(e){var t=r.mySelectedNodes.indexOf(e);return-1!==t?(r.mySelectedNodes.splice(t,1),!0):!1}for(var r=this,n=e.length-1;n>=0;--n){var i=e[n];t(i)&&this.removeClass(i,this.selectedClassName)}},n.prototype.setSelection=function(e){return this.removeFromSelection(this.mySelectedNodes),this.addToSelection(e),this.mySelectedNodes},n.prototype.getSelection=function(){return this.mySelectedNodes.concat()},n.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedNodes)},n.prototype.isSelected=function(e){return this.hasClass(e,this.selectedClassName)},n.prototype.scrollTo=function(e){var t=this.getElementForNode(e);if(t){var r=t.offsetTop;for(t=t.parentNode;t&&t!=this.myRootContainer;)r+=t.offsetTop,t=t.parentNode;var n=this.myRootContainer.parentNode;this.myDelegate.getScrollContainer()&&(n=this.myDelegate.getScrollContainer()),n.scrollTop=r}},n.prototype.addClass=function(e,t,r){var n=this.getElementForNode(e);if(n){if(r){n=n.parentNode;for(var i=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;n&&n!==i;)n.classList.add(t),n=n.parentNode}else n.classList.add(t);return!0}return!1},n.prototype.removeClass=function(e,t,r){var n=this.getElementForNode(e);if(n){if(r){n=n.parentNode;for(var i=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;n&&n!==i;)n.classList.remove(t),n=n.parentNode}else n.classList.remove(t);return!0}return!1},n.prototype.hasClass=function(e,t){return this.getElementForNode(e).classList.contains(t)},n.prototype.clear=function(){for(var e=this.myRootContainer;e.hasChildNodes();)e.removeChild(e.lastChild);this.nodeToElement={},this.nodeIdToNode={}},n.prototype.createElement_=function(e,t,r,n){function i(t,i,o,a){var l=s.createHtmlElement_(t,i,o),c=s.myDelegate.getTreeNodeId(a);l.setAttribute("lmv-nodeId",c);var u=s.createHtmlElement_(l,"lmvheader"),d=s.createHtmlElement_(u,"icon");return d.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault()},!1),d.addEventListener("click",function(t){s.myDelegate.onTreeNodeIconClick(s,e,t),t.stopPropagation(),t.preventDefault()},!1),s.myDelegate.createTreeNode(e,u,r,i,n),l}if(void 0===e||null===e)return null;if(!this.myDelegate.shouldCreateTreeNode(e))return null;var o,s=this,a=this.myDelegate.getTreeNodeId(e);if(s.myDelegate.isTreeNodeGroup(e)){o=i(t,"group",s.groupClassName,e),s.nodeToElement[a]=o,s.nodeIdToNode[a]=e;var l=s.myOptions.excludeRoot?1:0;n==l&&(o.style.left="0px"),s.myGroupNodes.push(o),s.myDelegate.forEachChild(e,function(e){s.createElement_(e,o,r,n+1)})}else{o=i(t,"leaf",s.leafClassName,e),s.nodeToElement[a]=o,s.nodeIdToNode[a]=e;var l=s.myOptions.excludeRoot?1:0;n==l&&(o.style.marginLeft="0px")}var c=s.myDelegate.getTreeNodeClass(e);return c&&o.classList.add(c),o},n.prototype.setInputHandlers_=function(){var e=this,t=this.myRootContainer,r=null,n=function(n){var i=null,o=!1;do n&&n!==t?n.hasAttribute("lmv-nodeId")?(i=n,o=!0):n=n.parentElement:(i=null,o=!0);while(!o);if(i){var s=i.getAttribute("lmv-nodeId");return e.nodeIdToNode[s]||r}return r};Object(i.isTouchDevice)()&&(this.hammer=new a.Manager(t,{recognizers:[o.GestureRecognizers.doubletap,o.GestureRecognizers.press],handlePointerEventMouse:!1,inputClass:i.isIE11?a.PointerEventInput:a.TouchInput}),this.hammer.on("doubletap",function(t){var i=n(t.target);i!==r&&e.myDelegate.onTreeNodeDoubleClick(e,i,t)}),this.hammer.on("press",function(t){var i=n(t.target);i!==r&&e.myDelegate.onTreeNodeRightClick(e,i,t)})),t.addEventListener("click",function(t){var i=n(t.target);i!==r&&(e.myDelegate.onTreeNodeClick(e,i,t),t.stopPropagation(),t.target.classList.contains("propertyLink")||t.preventDefault())},!1),t.addEventListener("dblclick",function(t){var i=n(t.target);i!==r&&(e.myDelegate.onTreeNodeDoubleClick(e,i,t),t.stopPropagation(),t.preventDefault())},!1),t.addEventListener("contextmenu",function(t){var i=n(t.target);i!==r&&(e.myDelegate.onTreeNodeRightClick(e,i,t),t.stopPropagation(),t.preventDefault())},!1),t.addEventListener("mouseover",function(t){var i=n(t.target);i!==r&&(e.myDelegate.onTreeNodeHover(e,i,t),t.stopPropagation(),t.preventDefault())},!1),t.addEventListener("mouseout",function(t){var r=t.toElement||t.relatedTarget;if(n(t.target)!=n(r)){var i=-1;e.myDelegate.onTreeNodeHover(e,i,t),t.stopPropagation(),t.preventDefault()}},!1)},n.prototype.createHtmlElement_=function(e,t,r){var n=this.getDocument(),i=n.createElement(t);return e.appendChild(i),r&&(i.className=r),i},n.prototype.iterate=function(e,t){if(void 0!==e&&null!==e&&this.myDelegate.shouldCreateTreeNode(e)){var r=this.getElementForNode(e);if(r){t(e,r);var n=this;this.myDelegate.forEachChild(e,function(e){n.iterate(e,t)})}}}},"./src/gui/TreeDelegate.js":function(e,t,r){"use strict";function n(){}r.r(t),r.d(t,"TreeDelegate",function(){return n});var i=r("./src/globalization/i18next.js"),o=r("./src/application/GlobalManagerMixin.js");o.GlobalManagerMixin.call(n.prototype),n.prototype.constructor=n,n.prototype.isTreeNodeGroup=function(e){throw"isTreeNodeGroup is not implemented."},n.prototype.getTreeNodeId=function(e){throw"getTreeNodeId is not implemented."},n.prototype.getTreeNodeIndex=function(e){throw"getTreeNodeIndex is not implemented."},n.prototype.getTreeNodeParentId=function(e){throw"getTreeNodeParentId is not implemented."},n.prototype.getTreeNodeLabel=function(e){return e.name},n.prototype.getTreeNodeCount=function(){throw"getTreeNodeCount is not implemented."},n.prototype.shouldCreateTreeNode=function(e){return!0},n.prototype.forEachChild=function(e,t){for(var r=e.children?e.children.length:0,n=0;r>n;++n){var i=e.children[n];t(i)}},n.prototype.createTreeNode=function(e,t,r,n,o){var s=this.getDocument(),a=s.createElement("label");t.appendChild(a);var l=this.getTreeNodeLabel(e);return r&&r.localize&&(a.setAttribute("data-i18n",l),l=i.i18n.translate(l)),a.textContent=l,a},n.prototype.onTreeNodeClick=function(e,t,r){},n.prototype.onTreeNodeIconClick=function(e,t,r){e.delegate().isTreeNodeGroup(t)&&e.setCollapsed(t,!e.isCollapsed(t))},n.prototype.onTreeNodeDoubleClick=function(e,t,r){},n.prototype.onTreeNodeRightClick=function(e,t,r){},n.prototype.onTreeNodeReized=function(e){},n.prototype.getTreeNodeClass=function(e){return""},n.prototype.getTreeNodeParentMaxSize=function(e){return{width:0,height:0}},n.prototype.getTreeNodeClientHeight=function(e){return 0},n.prototype.getTreeNodeDepthOffset=function(e,t){return 0},n.prototype.onTreeNodeHover=function(e,t,r){},n.prototype.getScrollContainer=function(){return null}},"./src/gui/TreeOnDemand.css":function(e,t,r){},"./src/gui/TreeOnDemand.js":function(e,t,r){"use strict";function n(e,t){this.dirty=!1,this.nextFrameId=0,this.scrollY=0,this.delegates=[],this.idToDelegate={},this.options=t;var r=this.getDocument();this.rootContainer=r.createElement("div"),this.rootContainer.classList.add("docking-panel-container-gradient"),this.rootContainer.classList.add("treeview"),this.rootContainer.classList.add("on-demand"),e.appendChild(this.rootContainer),this.paddingDiv=r.createElement("div"),this.paddingDiv.style.border=0,this.paddingDiv.style.margin=0,this.paddingDiv.style.padding=0,this.sizedDiv=e.parentNode,this.nodeCssTable=[[],["group"],["leaf"]],this.cssStringToNodeCssTable={"":0,group:1,leaf:2},this.nodeIndexToNodeCssTables={};for(var n=[],i=j,o=0;i>o;++o){var s=m(r);n[o]=s}this.elementsPool=n,this.elementsUsed=0,this.spinner=new A.LoadingSpinner(e),this.spinner.setGlobalManager(this.globalManager),this.spinner.addClass("tree-loading-spinner");var a=Object(E.isTouchDevice)();a&&(this.hammer=new C.Manager(this.rootContainer,{recognizers:[S.GestureRecognizers.doubletap,S.GestureRecognizers.press],handlePointerEventMouse:!1,inputClass:E.isIE11?C.PointerEventInput:C.TouchInput}));for(var o=0;i>o;++o){var s=n[o];a&&(this.hammer.on("doubletap",g.bind(this)),this.hammer.on("press",v.bind(this))),s.addEventListener("click",y.bind(this)),s.addEventListener("dblclick",_.bind(this)),s.addEventListener("contextmenu",b.bind(this)),s.icon.addEventListener("click",x.bind(this)),s.icon.addEventListener("mousedown",w.bind(this))}c(this)}function i(e){return{width:0|e.sizedDiv.clientWidth,height:0|e.sizedDiv.clientHeight}}function o(e){return e.dirty=!1,l(e),e.displayNoProperties(!1),0===e.delegates.length?void e.spinner.setVisible(!1):1===e.delegates.length&&e.delegates[0].isLoading()?void e.spinner.setVisible(!0):1===e.delegates.length&&e.delegates[0].isNotAvailable()?(e.spinner.setVisible(!1),void e.displayNoProperties(!0)):(e.spinner.setVisible(!1),void s(e))}function s(e){var t=e.rootContainer,r=i(e),n=r.height,o=0,s=0,l=!0;t.appendChild(e.paddingDiv);for(var c=e.delegates.slice(0),u=e.isExcludeRoot();c.length;){var d=c.shift(),h=d.modelDiv;t.appendChild(h);for(var p=[d.getRootId()],m={curr:u?-1:0,popIds:[]};p.length&&l;){if(o>e.scrollY+n+P){l=!1;break}if(e.elementsUsed===e.elementsPool.length){l=!1;break}var g=p.shift(),v=-1===m.curr?0:d.getTreeNodeClientHeight(g),y=o,_=y+v;if(v>0&&_+P>=e.scrollY){var b=e.elementsPool[e.elementsUsed++];b.setAttribute("lmv-nodeId",g),d.createTreeNode(g,b.header);var x=d.getTreeNodeClass(g);x&&b.classList.add(x);var w=f(e,d,g);if(w)for(var E=w.length,S=0;E>S;++S)b.classList.add(w[S]);var A=d.getTreeNodeDepthOffset(g,m.curr);b.header.style.paddingLeft=A+"px",h.appendChild(b)}_+P<e.scrollY&&(s=_),o=_;var M=0===v,T=a(e,d,g,M);if(T&&T.length>0){m.curr++;for(var C=T[T.length-1],j=m.popIds.length-1;j>=0&&m.popIds[j]===g;)m.popIds[j--]=C;m.popIds.push(C),p=T.concat(p)}for(;m.popIds.length>0&&g===m.popIds[m.popIds.length-1];)m.popIds.pop(),m.curr--}for(e.paddingDiv.style.height=s+"px";p.length;){var g=p.shift(),v=-1===m.curr?0:d.getTreeNodeClientHeight(g),y=o,_=y+v;o=_;var T=a(e,d,g);T&&T.length&&(p=T.concat(p))}}t.style.height=o+"px"}function a(e,t,r,n){var i=t.isTreeNodeGroup(r);if(!i)return null;if(!n){var o=e.isCollapsed(t,r);if(o)return null}var s=[];return t.forEachChild(r,function(e){s.push(e)}),s}function l(e){for(var t=e.elementsUsed,r=e.elementsPool,n=0;t>n;++n){var i=r[n];i.setAttribute("lmv-nodeId",""),i.className="";for(var o=i.header,s=o.childNodes.length-1,a=0;s>a;++a)o.removeChild(o.lastChild)}e.clear()}function c(e,t){(!e.dirty||t)&&(t?o(e):(e.dirty=!0,e.nextFrameId=requestAnimationFrame(function(){o(e)})))}function u(e,t){return"number"!=typeof t&&"string"!=typeof t?e.threeDelegate.getTreeNodeId(0|t):t}function d(e,t){for(var r=null;t&&t!==e.rootContainer;){if(t.hasAttribute("lmv-nodeId")){r=t;break}t=t.parentElement}if(!r)return null;var n=r.getAttribute("lmv-nodeId");return parseFloat(n)}function h(e,t){for(var r=null;t&&t!==e.rootContainer;){if(t.hasAttribute("lmv-modelId")){r=t;break}t=t.parentElement}if(!r)return null;var n=r.getAttribute("lmv-modelId");return parseInt(n)}function f(e,t,r){if(t.isControlId(r))return t.getControlIdCss(r);var n=t.getTreeNodeIndex(r);return e.nodeCssTable[e.nodeIndexToNodeCssTables[t.model.id][n]]}function p(e,t,r,n){var i=n.join(" "),o=e.cssStringToNodeCssTable[i]||e.nodeCssTable.length;o===e.nodeCssTable.length&&(e.nodeCssTable.push(n),
e.cssStringToNodeCssTable[i]=o);var s=t.getTreeNodeIndex(r);e.nodeIndexToNodeCssTables[t.model.id][s]=o}function m(e,t,r){var n=e.createElement("lmvheader"),i=e.createElement("icon");n.appendChild(i);var o=e.createElement("div");return o.header=n,o.icon=i,o.appendChild(n),o}function g(e){var t=d(this,e.target);if(t){var r=h(this,e.target),n=this.getDelegate(r);n&&n.onTreeNodeDoubleClick(this,t,e)}}function v(e){var t=d(this,e.target);if(t){var r=h(this,e.target),n=this.getDelegate(r);n&&n.onTreeNodeRightClick(this,t,e)}}function y(e){if(!e.target.classList.contains("group")&&!e.target.classList.contains("leaf")){var t=d(this,e.target);if(t){var r=h(this,e.target),n=this.getDelegate(r);n&&(n.onTreeNodeClick(this,t,e),e.stopPropagation(),e.preventDefault())}}}function _(e){if(!e.target.classList.contains("group")&&!e.target.classList.contains("leaf")){var t=d(this,e.target);if(t){var r=h(this,e.target),n=this.getDelegate(r);n&&(n.onTreeNodeDoubleClick(this,t,e),e.stopPropagation(),e.preventDefault())}}}function b(e){if(!e.target.classList.contains("group")&&!e.target.classList.contains("leaf")){var t=d(this,e.target);if(t){var r=h(this,e.target),n=this.getDelegate(r);n&&(n.onTreeNodeRightClick(this,t,e),e.stopPropagation(),e.preventDefault())}}}function x(e){var t=d(this,e.target);if(t){var r=h(this,e.target),n=this.getDelegate(r);n&&(n.onTreeNodeIconClick(this,t,e),e.stopPropagation(),e.preventDefault())}}function w(e){e.stopPropagation(),e.preventDefault()}r.r(t),r.d(t,"TreeOnDemand",function(){return n});var E=r("./src/compat.js"),S=r("./src/tools/GestureHandler.js"),A=r("./src/gui/LoadingSpinner.js"),M=r("./src/globalization/i18next.js"),T=r("./src/application/GlobalManagerMixin.js"),C=r("./thirdparty/hammer/hammer.js"),j=150,P=300,L=n.prototype;L.constructor=n,T.GlobalManagerMixin.call(L),L.pushDelegate=function(e){this.delegates.push(e),this.idToDelegate[e.model.id]=e,c(this)},L.removeDelegate=function(e){for(var t=0;t<this.delegates.length;++t){var r=this.delegates[t];if(r.model.id===e)return this.delegates.splice(t,1),delete this.idToDelegate[e],delete this.nodeIndexToNodeCssTables[e],c(this),!0}return!1},L.setInstanceTree=function(e,t){if(e.setInstanceTree(t),c(this),t){var r=new Uint8Array(e.getTreeNodeCount()),n=function(t){var n=e.getTreeNodeIndex(t);r[n]=e.isTreeNodeGroup(t)?1:2},i=e.instanceTree.getRootId();e.forEachChild(i,n,!0);var o=e.model.id;this.nodeIndexToNodeCssTables[o]=r;var s=0,a=0;t.enumNodeChildren(i,function(e){a||(s=e),a++}),this.setAllCollapsed(e,!0);var l=this.options.excludeRoot,u=this.options.startCollapsed;l?(this.setCollapsed(e,i,!1),u||this.setCollapsed(e,s,!1)):u||this.setCollapsed(e,e.rootId,!1),c(this,!0)}},L.show=function(e){this.rootContainer.style.display=block},L.getRootContainer=function(){return this.rootContainer},L.getDelegate=function(e){return this.idToDelegate[parseInt(e)]},L.isCollapsed=function(e,t){var r=f(this,e,t);return r&&-1!==r.indexOf("collapsed")},L.setCollapsed=function(e,t,r,n){r?(this.addClass(e,t,"collapsed",n),this.removeClass(e,t,"expanded",n)):(this.addClass(e,t,"expanded",n),this.removeClass(e,t,"collapsed",n))},L.setAllCollapsed=function(e,t){var r=t?function(t){this.addClass(e,t,"collapsed",!1),this.removeClass(e,t,"expanded",!1)}.bind(this):function(t){this.addClass(e,t,"collapsed",!1),this.removeClass(e,t,"expanded",!1)}.bind(this),n=e.instanceTree.getRootId();this.iterate(e,n,function(t){return e.isTreeNodeGroup(t)&&r(t),!0})},L.addToSelection=function(e,t){for(var r=t.length,n=0;r>n;++n)this.addClass(e,t[n],"selected",!1);c(this)},L.removeFromSelection=function(e,t){for(var r=t.length,n=0;r>n;++n)this.removeClass(e,t[n],"selected",!1);c(this)},L.setSelection=function(e,t){return this.clearSelection(e),this.addToSelection(e,t),this.selectedNodes},L.clearSelection=function(e){var t=[],r=function(r){var n=f(this,e,r);n&&-1!==n.indexOf("selected")&&(t[0]=r,this.removeFromSelection(e,t))}.bind(this),n=e.instanceTree.getRootId();e.forEachChild(n,r,!0)},L.isSelected=function(e){var t=f(this,delegate,e);return t&&-1!==t.indexOf("selected")},L.scrollTo=function(e,t){var r=this.getDelegate(t.id);if(!r||!r.isNotAvailable()){var n=!1,i=[],o=function(t,r){if(n=n||e===t,!n){i.push(r.getTreeNodeClientHeight(t));var s=i.length,a=r.isTreeNodeGroup(t)&&-1!==f(this,r,t).indexOf("expanded");r.forEachChild(t,function(e){o(e,r)}),a||n||i.length>s&&i.splice(s)}}.bind(this);this.setCollapsed(r,e,!1,!0);var s=r.getRootId();if(o(s,r),!n)return-1;for(var a=0,l=i.length,u=this.isExcludeRoot()?1:0;l>u;++u)a+=i[u];if(1===this.delegates.length)return c(this,!0),a;for(var u=0;u<this.delegates.length;++u){var d=this.delegates[u];if(d===r)break;i=[],e=-1,n=!1,s=d.getRootId(),o(s,d),l=i.length;for(var h=0,p=0;l>p;++p)h+=i[p];a+=h}return c(this,!0),a}},L.addClass=function(e,t,r,n){function i(t,r,n){var i=f(t,e,r);if(i){var o=i.indexOf(n);-1===o&&(i=i.slice(0),i.push(n),i.sort(),p(t,e,r,i))}}if(n)for(var o=e.getTreeNodeParentId(u(this,t));o;)i(this,o,r),o=e.getTreeNodeParentId(o);else i(this,t,r);return c(this),!0},L.removeClass=function(e,t,r,n){function i(t,r,n){var i=f(t,e,r);if(i){var o=i.indexOf(n);-1!==o&&(i=i.slice(0),i.splice(o,1),p(t,e,r,i))}}if(n)for(var o=e.getTreeNodeParentId(u(this,t));o;)i(this,o,r),o=e.getTreeNodeParentId(o);else i(this,t,r);return c(this),!0},L.hasClass=function(e,t){return 1!==f(this,delegate,e).indexOf(t)},L.clear=function(){for(var e,t=this.rootContainer;e=t.lastChild;)t.removeChild(e);for(var r=0;r<this.delegates.length;++r)this.delegates[r].clean();this.elementsUsed=0},L.iterate=function(e,t,r){void 0!==t&&null!==t&&e.shouldCreateTreeNode(t)&&r(t)&&e.forEachChild(t,function(t){this.iterate(e,t,r)}.bind(this))},L.forEachDelegate=function(e){for(var t=0;t<this.delegates.length;++t)e(this.delegates[t])},L.destroy=function(){this.clear(),cancelAnimationFrame(this.nextFrameId);var e=this.rootContainer.parentNode;e.removeChild(this.rootContainer),this.rootContainer=null,this.rootId=-1,this.nodeCssTable=null,this.nodeIndexToNodeCssTables=null,this.cssStringToNodeCssTable=null,this.elementsPool=null,this.elementsUsed=-1,this.scrollY=-1,this.hammer&&(this.hammer.destroy(),this.hammer=null)},L.setScroll=function(e){Math.abs(this.scrollY-e)>P&&(this.scrollY=e,c(this))},L.displayNoProperties=function(e){var t=this.getDocument();if(e){if(!this.divNoProps){this.divNoProps=t.createElement("div");var r="Model Browser is not available";this.divNoProps.innerText=M.i18n.translate(r),this.divNoProps.setAttribute("data-i18n",r),this.divNoProps.classList.add("lmv-no-properties")}if(!this.divNoProps.parentNode){var n=this.rootContainer.parentNode;n.appendChild(this.divNoProps)}}else this.divNoProps&&this.divNoProps.parentNode&&this.divNoProps.parentNode.removeChild(this.divNoProps)},L.isExcludeRoot=function(){return 1===this.delegates.length?this.options.excludeRoot:!1},L.getDelegateCount=function(){return this.delegates.length}},"./src/gui/ViewerModelStructurePanel.css":function(e,t,r){},"./src/gui/ViewerModelStructurePanel.js":function(e,t,r){"use strict";function n(e,t,r){this.viewer=e,this.visible=!1,this._trackNodeClick=!0,r=r||{},r.defaultTitle="Model",r.excludeRoot=void 0!==r.excludeRoot?r.excludeRoot:!0,r.startCollapsed=void 0!==r.startCollapsed?r.startCollapsed:!1,r.scrollEaseCurve=r.scrollEaseCurve||[0,0,.29,1],r.scrollEaseSpeed=void 0!==r.scrollEaseSpeed?r.scrollEaseSpeed:.003,r.addFooter=void 0!==r.addFooter?r.addFooter:!0,this.clickConfig=r&&r.docStructureConfig?r.docStructureConfig:d,this.isMac=-1!==navigator.userAgent.search("Mac OS"),r.hideSearch?(r.heightAdjustment=70,o.ModelStructurePanel.call(this,e.container,e.container.id+"ViewerModelStructurePanel",t,r),this.scrollContainer.classList.add("no-search")):(r.heightAdjustment=104,o.ModelStructurePanel.call(this,e.container,e.container.id+"ViewerModelStructurePanel",t,r),this.searchbox=new l.Searchbox(e.container.id+"ViewerModelStructurePanel-Searchbox",e,{excludeRoot:r.excludeRoot,searchFunction:i.bind(this)}),this.searchbox.setGlobalManager(this.globalManager),this.searchbox.addEventListener(a.ON_SEARCH_SELECTED,function(e){var t=e.id,r=this.viewer.impl.findModel(e.modelId);this.viewer.isolate(t,r)}.bind(this)),this.container.appendChild(this.searchbox.container)),this.setGlobalManager(e.globalManager),this._ignoreScroll=!1,this.selectedNodes={},this.onViewerSelect=this.onViewerSelect.bind(this),this.onViewerIsolate=this.onViewerIsolate.bind(this),this.onViewerHide=this.onViewerHide.bind(this),this.onViewerShow=this.onViewerShow.bind(this)}function i(e){var t=this.tree,r=e.toLowerCase(),n=[];return t.forEachDelegate(function(e){var i=e.getRootId(),o=[];t.iterate(e,i,function(t){var n=e.instanceTree&&e.instanceTree.getNodeName(t);return n&&-1!==n.toLowerCase().indexOf(r)&&o.push(t),!0}),n.push({ids:o,delegate:e})}),n}r.r(t),r.d(t,"ViewerModelStructurePanel",function(){return n});var o=r("./src/gui/ModelStructurePanel.js"),s=r("./src/application/EventTypes.js"),a=(r.n(s),r("./src/gui/controls/SearchEvents.js")),l=r("./src/gui/controls/Searchbox.js"),c=r("./src/logger/Logger.js"),u=r("./src/gui/ViewerPanelMixin.js"),d={click:{onObject:["isolate"]},clickShift:{onObject:["toggleMultipleOverlayedSelection"]},clickCtrl:{onObject:["toggleVisibility"]}};n.prototype=Object.create(o.ModelStructurePanel.prototype),n.prototype.constructor=n,u.ViewerPanelMixin.call(n.prototype),n.prototype.uninitialize=function(){this.viewer&&(this.viewer.removeEventListener(s.AGGREGATE_SELECTION_CHANGED_EVENT,this.onViewerSelect),this.viewer.removeEventListener(s.AGGREGATE_ISOLATION_CHANGED_EVENT,this.onViewerIsolate),this.viewer.removeEventListener(s.HIDE_EVENT,this.onViewerHide),this.viewer.removeEventListener(s.SHOW_EVENT,this.onViewerShow),this.viewer=null),this.searchResults&&(this.searchResults.uninitialize(),this.searchResults=null),o.ModelStructurePanel.prototype.uninitialize.call(this)},n.prototype.resizeToContent=function(){var e=this.scrollContainer,t=this.tree?this.tree.getRootContainer():null;if(e&&t){var r="calc(100% + "+e.scrollLeft+"px)";t.style.width=r}},n.prototype.createUI=function(){if(!this.uiCreated){var e=this.viewer;o.ModelStructurePanel.prototype.createUI.call(this);var t=this.scrollContainer;t.classList.remove("left");var r=function(){this.visible&&this.resizeToContent(),requestAnimationFrame(r)}.bind(this);r();var n=this.options,i=0,a=10,l=e.container.getBoundingClientRect(),c=e.getToolbar();n.maxHeight?n.maxHeight:l.height;if(c){var u=c.container.getBoundingClientRect();i=l.bottom-u.top}else i=0;this.container.style.top=a+"px",this.container.style.left=a+"px",this.container.style.height="calc(100% - "+(i+2*a)+"px)",this.container.style.maxHeight="calc(100% - "+(i+2*a)+"px)",t.addEventListener("contextmenu",function(e){this.viewer.contextMenu.show(e)}.bind(this)),this.viewer.addEventListener(s.AGGREGATE_SELECTION_CHANGED_EVENT,this.onViewerSelect),this.viewer.addEventListener(s.AGGREGATE_ISOLATION_CHANGED_EVENT,this.onViewerIsolate),this.viewer.addEventListener(s.HIDE_EVENT,this.onViewerHide),this.viewer.addEventListener(s.SHOW_EVENT,this.onViewerShow)}},n.prototype.onViewerSelect=function(e){this.setSelection(e.selections),this._ignoreScroll||this.scrollToSelection(e.selections),this._ignoreScroll=!1},n.prototype.onViewerIsolate=function(e){this.setIsolation(e.isolation)},n.prototype.onViewerHide=function(e){this.setHidden(e.nodeIdArray.slice(),e.model,!0)},n.prototype.onViewerShow=function(e){this.setHidden(e.nodeIdArray.slice(),e.model,!1)},n.prototype.setVisible=function(e){o.ModelStructurePanel.prototype.setVisible.call(this,e),this.visible!==e&&(this.visible=e,this.visible&&this.sync())},n.prototype.sync=function(){var e=this.viewer.getAggregateIsolation();if(this.setIsolation(e),0===e.length)for(var t=this.viewer.getAggregateHiddenNodes(),r=0;r<t.length;++r){var n=t[r].model,i=t[r].ids;this.setHidden(i,n,!0)}var o=this.viewer.getAggregateSelection();this.setSelection(o),this.scrollToSelection(o)},n.prototype.removeTreeUI=function(e){delete this.selectedNodes[e.id],o.ModelStructurePanel.prototype.removeTreeUI.call(this,e)},n.prototype.setHidden=function(e,t,r){for(var n=this.tree,i=n.getDelegate(t.id),o=r?function(e){return n.addClass(i,e,"dim",!1),n.removeClass(i,e,"visible",!1),!0}:function(e){return n.removeClass(i,e,"dim",!1),n.addClass(i,e,"visible",!1),!0},s=0;s<e.length;++s)n.iterate(i,e[s],o)},n.prototype.setIsolation=function(e){if(0===e.length){var t=this.tree;return void t.forEachDelegate(function(e){var r=e.model,n=e.instanceTree;if(n){var i=n.getRootId();t.iterate(e,i,function(r){return t.removeClass(e,r,"dim",!1),t.removeClass(e,r,"visible",!1),!0}),this.setHidden([i],r,!1)}}.bind(this))}var r=[];e.length&&this.tree.forEachDelegate(function(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].model===t.model){n=i;break}-1===n&&r.push(t)}.bind(this));for(var n=0;n<e.length;++n){var i=e[n].model,o=i.getData().instanceTree;if(o){var s=o.getRootId(),t=this.tree,a=t.getDelegate(i.id);t.iterate(a,s,function(e){return t.removeClass(a,e,"dim",!1),t.removeClass(a,e,"visible",!1),!0});var l=e[n].ids;if(0!==l.length){if(1===l.length&&l[0]===s)return;this.setHidden([s],i,!0),this.setHidden(l,i,!1)}}}for(var n=0;n<r.length;++n){var t=this.tree,a=r[n],i=a.model,o=a.instanceTree;if(o){var s=o.getRootId();t.iterate(a,s,function(e){return t.removeClass(a,e,"dim",!1),t.removeClass(a,e,"visible",!1),!0}),this.setHidden([s],i,!0)}}},n.prototype.setSelection=function(e){var t,r,n,i,o,s,a,l=this.tree,c=this.viewer.impl.modelQueue();for(var u in this.selectedNodes)if(i=c.findModel(parseInt(u)),o=this.selectedNodes[u],s=l.getDelegate(u),s&&(a=s.instanceTree)){for(r=0;r<o.length;++r)for(n=a.getNodeParentId(o[t]);n;)l.removeClass(s,n,"ancestor-selected"),n=a.getNodeParentId(n);l.clearSelection(s)}for(this.selectedNodes={},t=0;t<e.length;++t)if(i=e[t].model,o=e[t].dbIdArray||e[t].selection,s=l.getDelegate(i.id),s&&(a=s.instanceTree)){for(r=0;r<o.length;++r)for(n=a.getNodeParentId(o[t]);n;)l.addClass(s,n,"ancestor-selected"),n=a.getNodeParentId(n);l.setSelection(s,o),this.selectedNodes[i.id]=o.concat()}},n.prototype.scrollToSelection=function(e){var t=e[0];if(t){var r=t.model,n=t.dbIdArray||t.selection,i=this.tree.scrollTo(n[0],r),o=this.scrollContainer.scrollTop;this.scrollContainer.scrollTop=i;var s=this.scrollContainer.scrollTop;this.scrollContainer.scrollTop=o,this.options.scrollEaseSpeed>0?this.animateScroll(o,s,function(e){this.tree.setScroll(e)}.bind(this)):(this.scrollContainer.scrollTop=s,this.tree.setScroll(s))}},n.prototype.onEyeIcon=function(e,t){this.viewer.toggleVisibility(e,t)},n.prototype.onTreeNodeClick=function(e,t,r,n){if(this._trackNodeClick&&(c.logger.track({category:"node_selected",name:"model_browser_tool"}),this._trackNodeClick=!1),!this.isMac||!n.ctrlKey){var i="click";this.ctrlDown(n)&&(i+="Ctrl"),n.shiftKey&&(i+="Shift"),n.altKey&&(i+="Alt");var o=["toggleOverlayedSelection"],s=this.clickConfig[i];s&&(o=s.onObject),this.handleAction(o,t,r)}},n.prototype.onTreeNodeRightClick=function(e,t,r,n){return this.isMac&&n.ctrlKey&&0===n.button?(this.clickConfig&&this.clickConfig.clickCtrl&&this.handleAction(this.clickConfig.clickCtrl.onObject,t,r),null):this.viewer.contextMenu.show(n)},n.prototype.handleAction=function(e,t,r){for(var n in e)switch(e[n]){case"toggleOverlayedSelection":this.toggleOverlayedSelection(t,r);break;case"toggleMultipleOverlayedSelection":this.toggleMultipleOverlayedSelection(t,r);break;case"selectOnly":this.viewer.select(t,r);break;case"deselectAll":this.viewer.clearSelection();break;case"selectToggle":this.viewer.toggleSelect(t,r);break;case"isolate":this.isolate(t,r);break;case"showAll":this.viewer.showAll();break;case"focus":this.viewer.fitToView();break;case"hide":this.viewer.hide(t,r);break;case"show":this.viewer.show(t,r);break;case"toggleVisibility":this.viewer.toggleVisibility(t,r)}},n.prototype.toggleOverlayedSelection=function(e,t){var r=this.selectedNodes[t.id],n=r?r.indexOf(e):-1;this._ignoreScroll=!0,-1===n?(this.viewer.select(e,t),this.viewer.fitToView([e],t,!1)):this.viewer.select([],void 0,t)},n.prototype.toggleMultipleOverlayedSelection=function(e,t){var r=this.selectedNodes[t.id],n=r?r.indexOf(e):-1;-1===n?(r||(r=this.selectedNodes[t.id]=[]),r.push(e)):r.splice(n,1);var i=[];for(var o in this.selectedNodes)if(this.selectedNodes.hasOwnProperty(o)){var t=this.viewer.impl.findModel(parseInt(o)),s=this.selectedNodes[o];i.push({model:t,ids:s})}this._ignoreScroll=!0,this.viewer.impl.selector.setAggregateSelection(i);var a=this.viewer.getAggregateSelection();this.viewer.fitToView(a)},n.prototype.isolate=function(e,t){if(this.viewer.isolate(e,t),this.viewer.fitToView([e],t,!1),t){var r={type:s.SHOW_PROPERTIES_EVENT,dbId:e,model:t};this.viewer.dispatchEvent(r)}},n.prototype.ctrlDown=function(e){return this.isMac&&e.metaKey||!this.isMac&&e.ctrlKey}},"./src/gui/ViewerObjectContextMenu.js":function(e,t,r){"use strict";function n(e){i.ObjectContextMenu.call(this,e)}r.r(t),r.d(t,"ViewerObjectContextMenu",function(){return n});var i=r("./src/gui/ObjectContextMenu.js"),o=r("./src/logger/Logger.js");n.prototype=Object.create(i.ObjectContextMenu.prototype),n.prototype.constructor=n,n.prototype.buildMenu=function(e,t){var r=this;if(this.viewer.model){var n=this,i=[],s=this.viewer.navigation,a=this.viewer.model.is2d();t.hasSelected&&(i.push({title:"Isolate",target:function(){var e=n.viewer.getAggregateSelection();n.viewer.impl.visibilityManager.aggregateIsolate(e),n.viewer.clearSelection(),o.logger.track({name:"isolate_count",aggregate:"count"})}}),t.hasVisible&&i.push({title:"Hide Selected",target:function(){var e=n.viewer.impl.visibilityManager;n.viewer.getAggregateSelection(function(t,r){e.hide(r,t)}),n.viewer.clearSelection()}}),t.hasHidden&&i.push({title:"Show Selected",target:function(){var e=n.viewer.getSelection();n.viewer.clearSelection(),n.viewer.show(e)}})),a&&i.push({title:"Show All Layers",target:function(){n.viewer.setLayerVisible(null,!0)}}),i.push({title:"Show All Objects",target:function(){n.viewer.showAll(),o.logger.track({name:"showall",aggregate:"count"})}});var l=n.viewer.getAggregateSelection();if(!a&&1===l.length&&s.isActionEnabled("gotoview")&&i.push({title:"Focus",target:function(){if(l=n.viewer.getAggregateSelection(),l.length>0){var e=l[0];n.viewer.fitToView(e.selection,e.model)}else 0===l.length&&n.viewer.fitToView();o.logger.track({name:"fittoview",aggregate:"count"})}}),!a){var c=this.viewer.impl.getCanvasBoundingClientRect(),u=e.clientX-c.left,d=e.clientY-c.top,h=this.viewer.clientToWorld(u,d,!1);h&&i.push({title:"Pivot",target:function(){r.viewer.navigation.setPivotPoint(h.point)}})}return t.hasSelected&&i.push({title:"Clear Selection",target:function(){n.viewer.clearSelection(),o.logger.track({name:"clearselection",aggregate:"count"})}}),i}}},"./src/gui/ViewerPanelMixin.js":function(e,t,r){"use strict";function n(){this.getContainerBoundingRect=function(){var e=this.parentContainer.getBoundingClientRect(),t={height:0,width:0,left:0,bottom:0,right:0,top:0},r=this.getDocument(),n=r.getElementsByClassName("toolbar-menu");return n&&n.length>0&&(t=n[0].getBoundingClientRect()),{height:e.height-t.height,width:e.width,left:e.left,bottom:e.bottom-t.height,right:e.right,top:e.top}}}r.r(t),r.d(t,"ViewerPanelMixin",function(){return n})},"./src/gui/ViewerPropertyPanel.js":function(e,t,r){"use strict";function n(e){this.viewer=e,this.setGlobalManager(e.globalManager),this.currentNodeIds=[],this.currentModel=null,this.isDirty=!0,this.propertyNodeId=null,this.normalTitle="Properties",this.loadingTitle="Object Properties Loading",this._viewDbId=null,this.onProperties=this.onProperties.bind(this),this.onPropError=this.onPropError.bind(this),this.setPropertiesIntoUI=this.setPropertiesIntoUI.bind(this),this._onDisplayUnitPreferenceChanged=this._onDisplayUnitPreferenceChanged.bind(this),a.PropertyPanel.call(this,e.container,"ViewerPropertyPanel",this.loadingTitle)}function i(e){var t=e.getDocumentNode(),r=t&&t.findViewableParent();return r&&-1!==r.name().toLocaleLowerCase().indexOf(".sld")?!0:!1}function o(e,t,r){return new Promise(function(n,i){r=r||e.myData.metadata.title,e.getBulkProperties2(t,{ignoreHidden:!0},function(e){for(var t=0,i=e.length;i>t;++t){var o=e[t];if(o.name&&-1!==r.indexOf(o.name))for(var s=0,a=o.properties.length;a>s;++s){var l=o.properties[s];if("Sheet Number"===l.displayName&&-1!==r.indexOf(l.displayValue))return n(o)}}return n(null)})})}function s(e,t,r){return new Promise(function(n,i){e.getBulkProperties2(t,{ignoreHidden:!0},function(e){for(var t=0,i=e.length;i>t;++t)for(var o=e[t],s=0,a=o.properties.length;a>s;++s){for(var l=o.properties[s],c=!0,u=0,d=r.properties.length;d>u;++u)r.properties[u].displayName===l.displayName&&(c=!1,u=d);c&&r.properties.push(l)}n(r)})})}r.r(t),r.d(t,"ViewerPropertyPanel",function(){return n});var a=r("./src/gui/PropertyPanel.js"),l=r("./src/gui/ViewerPanelMixin.js"),c=r("./src/application/EventTypes.js"),u=(r.n(c),r("./src/gui/DockingPanel.js"));n.prototype=Object.create(a.PropertyPanel.prototype),n.prototype.constructor=n,l.ViewerPanelMixin.call(n.prototype),n.prototype._onDisplayUnitPreferenceChanged=function(){this.isDirty=!0;var e=this.currentModel?this.currentModel.getRootId():null;null!==this.propertyNodeId&&this.propertyNodeId!==e?this.requestNodeProperties(this.propertyNodeId):this.requestProperties()},n.prototype.initialize=function(){a.PropertyPanel.prototype.initialize.call(this);var e=this;this.viewer.prefs.addListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS,this._onDisplayUnitPreferenceChanged),this.viewer.prefs.addListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS_PRECISION,this._onDisplayUnitPreferenceChanged),e.addEventListener(e.viewer,c.AGGREGATE_SELECTION_CHANGED_EVENT,function(t){t.selections&&t.selections.length?(e.currentNodeIds=t.selections[0].dbIdArray,e.currentModel=t.selections[0].model):e.resetCurrentModel(),e.isDirty=!0,e.requestProperties()}),e.addEventListener(e.viewer,c.SHOW_PROPERTIES_EVENT,function(t){t&&t.dbId&&t.model===e.currentModel&&e.requestNodeProperties(t.dbId)}),e.addEventListener(e.viewer,c.HIDE_EVENT,function(t){e.isDirty=!0,e.requestProperties()}),e.addEventListener(e.viewer,c.OBJECT_TREE_CREATED_EVENT,function(t){e.currentModel===t.model&&(e.isDirty=!0,e.requestProperties())}),e.addEventListener(e.viewer,c.SHOW_EVENT,function(t){e.isDirty=!0,e.requestProperties()});var t=this.viewer.getAggregateSelection();t.length?(this.currentModel=t[0].model,this.currentNodeIds=t[0].selection):this.resetCurrentModel()},n.prototype.resetCurrentModel=function(){var e=this.viewer?this.viewer.getVisibleModels():[];1===e.length?(this.currentModel=e[0],this.currentNodeIds=[]):(this.currentModel=null,this.currentNodeIds=[])},n.prototype.setTitle=function(e,t){e||(e="Object Properties",t=t||{},t.localizeTitle=!0),a.PropertyPanel.prototype.setTitle.call(this,e,t)},n.prototype.setVisible=function(e){u.DockingPanel.prototype.setVisible.call(this,e),this.requestProperties()},n.prototype.visibilityChanged=function(){u.DockingPanel.prototype.visibilityChanged.call(this),this.isVisible()&&this.requestProperties()},n.prototype.requestProperties=function(){this.isVisible()&&this.isDirty&&(this.currentModel&&this.currentNodeIds.length>0?this.requestNodeProperties(this.currentNodeIds[this.currentNodeIds.length-1]):this.showDefaultProperties(),this.isDirty=!1)},n.prototype.onProperties=function(e){var t=this;if(this.viewer&&this.currentModel&&e.dbId===this.propertyNodeId){for(var r=[],n=e.properties,o=0,a=n.length;a>o;++o){var l=n[o];"__internalref__"===l.displayCategory&&r.push(l.displayValue)}var c,u=this.currentModel;c=u.is3d()&&i(u)&&r.length>0?s(u,r,e):Promise.resolve(e),c.then(this.setPropertiesIntoUI)["catch"](function(){t.setProperties([]),t.highlight(""),t.resizeToContent(),t.respositionPanel()})}},n.prototype.setPropertiesIntoUI=function(e){var t=e.name||this.normalTitle,r=!e.name;this.setTitle(t,{localizeTitle:r}),"name"in e&&e.properties&&e.properties.splice(0,0,{displayName:"Name",displayValue:e.name,displayCategory:null,attributeName:"Name",type:20,units:null,hidden:!1,precision:0}),this.setProperties(e.properties),this.highlight(this.viewer.searchText),this.resizeToContent(),this.respositionPanel()},n.prototype.onPropError=function(){this.setTitle(this.normalTitle,{localizeTitle:!0}),this.showNoProperties()},n.prototype.requestNodeProperties=function(e){var t=this,r=this.currentModel;this.propertyNodeId=e,r.getProperties2(e,function(e){t.viewer&&r===t.currentModel&&t.onProperties(e)},this.onPropError)},n.prototype.setNodeProperties=n.prototype.requestNodeProperties,n.prototype.requestViewProperties=function(e){var t=this;if(null!==this._viewDbId)return void this.requestNodeProperties(this._viewDbId);var r=this.currentModel,n=r.getRootId();this.propertyNodeId=n,r.getProperties2(n,function(i){if(t.viewer&&r===t.currentModel){t._viewDbId=n;for(var s=e.name(),a=e.isSheet(),l=i.properties,c=[],u=[],d=0;d<l.length;++d){var h=l[d];"View"===h.displayName&&c.push(h.displayValue),"Sheet"===h.displayName&&u.push(h.displayValue)}var f=a?u:c;if(0===f.length)return void t.onProperties(i);var p=t;r.getBulkProperties2(f,{propFilter:["name","dbId"],ignoreHidden:!0},function(e){for(var t=[],l=0;l<e.length;++l)if(-1!==s.indexOf(e[l].name)){var c=e[l].dbId;if(!a)return p._viewDbId=c,void p.requestNodeProperties(c);t.push(c)}return 0===t.length?void p.onProperties(i):void o(r,t,s).then(function(e){e&&e.dbId&&e.dbId!==n?(p._viewDbId=e.dbId,p.requestNodeProperties(e.dbId)):p.onProperties(i)})})}},this.onPropError)},n.prototype.respositionPanel=function(){if(this.isVisible()){var e=this.viewer.toolController,t=e.lastClickX,r=e.lastClickY,n=this.container.getBoundingClientRect(),i=n.left,o=n.top,s=n.width,a=n.height,l=this.viewer.impl.getCanvasBoundingClientRect(),c=l.left,u=l.top,d=l.width,h=l.height;t>=i&&i+s>t&&r>=o&&o+a>r&&(i+s/2>t&&c+d>t+s?(this.container.style.left=Math.round(t-c)+"px",this.container.dockRight=!1):t-s>=c?(this.container.style.left=Math.round(t-c-s)+"px",this.container.dockRight=!1):c+d>t+s?(this.container.style.left=Math.round(t-c)+"px",this.container.dockRight=!1):u+h>r+a?(this.container.style.top=Math.round(r-u)+"px",this.container.dockBottom=!1):r-a>=u&&(this.container.style.top=Math.round(r-u-a)+"px",this.container.dockBottom=!1))}},n.prototype.showDefaultProperties=function(){var e=this.currentModel?this.currentModel.getRootId():null;if(e){var t=this.currentModel.getDocumentNode();t&&!t.isMasterView()?this.requestViewProperties(t):this.requestNodeProperties(e)}else this.propertyNodeId=null,this.setTitle(this.normalTitle,{localizeTitle:!0}),a.PropertyPanel.prototype.showDefaultProperties.call(this)},n.prototype.areDefaultPropertiesShown=function(){if(!this.currentModel)return!1;var e=this.currentModel.getRootId();return this.propertyNodeId===e},n.prototype.uninitialize=function(){a.PropertyPanel.prototype.uninitialize.call(this),this.viewer.prefs.removeListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS,this._onDisplayUnitPreferenceChanged),this.viewer.prefs.removeListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS_PRECISION,this._onDisplayUnitPreferenceChanged),this.viewer=null,this._viewDbId=null,this.currentModel=null,this.propertyNodeId=null,this.currentNodeIds=null},n.prototype.onCategoryClick=function(e,t){a.PropertyPanel.prototype.onCategoryClick.call(this,e,t),this.resizeToContent()},n.prototype.onCategoryIconClick=function(e,t){a.PropertyPanel.prototype.onCategoryIconClick.call(this,e,t),this.resizeToContent()}},"./src/gui/ViewerSettingsPanel.css":function(e,t,r){},"./src/gui/ViewerSettingsPanel.js":function(e,t,r){"use strict";function n(e,t){this.viewer=e,this.is3dMode=!t.is2d(),this.visible=!1,this._externalButtonIds=[],this._externalButtonsLabel=null,s.SettingsPanel.call(this,e.container,"ViewerSettingsPanel"+e.id+"-"+g++,"Settings",{width:400,addFooter:!1,heightAdjustment:110}),this.container.classList.add("viewer-settings-panel"),this.setGlobalManager(e.globalManager),this.addTab(m.Configuration,"Configuration",{className:"performance"}),this.addTab(m.Navigation,"Navigation",{className:"navigation"}),this.addTab(m.Appearance,"Appearance",{className:"appearance"}),this.is3dMode&&this.addTab(m.Environment,"Environment",{className:"environment"}),this.is3dMode||this.container.classList.add("for-2d-model"),this.createRestoreDefaultSettingsButton(),this.modelPreferenceCount=0,this.createNavigationPanel(),this.createConfigurationPanel(),this.createAppearancePanel(),this.modelPreferenceCount&&l.logger.log("Model locked ("+this.modelPreferenceCount+") render settings in UI."),this.selectTab(m.Configuration),this.footer=this.createFooter(),this.createVersionLabel(this.footer),this.syncUI=this.syncUI.bind(this),e.addEventListener(a.RESTORE_DEFAULT_SETTINGS_EVENT,this.syncUI),e.addEventListener(a.VIEWER_STATE_RESTORED_EVENT,this.syncUI)}function i(e,t,r){e.createThumbnail(r).then(function(e){t.src=e,t.onload=function(){URL.revokeObjectURL(e)}})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:LMV_VIEWER_VERSION;return"@"===e.charAt(0)&&(e="0.0.0"),"v"+e}r.r(t),r.d(t,"ViewerSettingTab",function(){return m}),r.d(t,"ViewerSettingsPanel",function(){return n});var s=r("./src/gui/SettingsPanel.js"),a=r("./src/application/EventTypes.js"),l=(r.n(a),r("./src/logger/Logger.js")),c=r("./src/application/LightPresets.js"),u=r("./src/globalization/i18next.js"),d=r("./src/compat.js"),h=r("./src/gui/ViewerPanelMixin.js"),f=r("./src/gui/LightPresetThumbnails.js"),p=(Autodesk.Viewing,Autodesk.Viewing.Private),m={Navigation:"navigationtab",Configuration:"performancetab",Appearance:"appearance",Environment:"environment"},g=0;n.prototype=Object.create(s.SettingsPanel.prototype),n.prototype.constructor=n,h.ViewerPanelMixin.call(n.prototype),n.prototype.uninitialize=function(){this.viewer&&(this._onBgEnvironmentChange&&this._onBgEnvironmentReset&&(this.viewer.prefs.removeListeners(p.Prefs3D.LIGHT_PRESET,this._onBgEnvironmentChange,this._onBgEnvironmentReset),this._onBgEnvironmentChange=null,this._onBgEnvironmentReset=null),this.viewer.removeEventListener(a.RESTORE_DEFAULT_SETTINGS_EVENT,this.syncUI),this.viewer.removeEventListener(a.VIEWER_STATE_RESTORED_EVENT,this.syncUI)),this.viewer=null,s.SettingsPanel.prototype.uninitialize.call(this),this.envSelect=null},n.prototype.setVisible=function(e){this.visible=e,s.SettingsPanel.prototype.setVisible.call(this,e),e&&this.sizeToContent(),e&&this.createEnvironmentPanel()},n.prototype.addCheckbox=function(e,t,r,n,i,o){function a(e){o&&l.prefs.set(o,e),i(e)}var l=this.viewer,c=l.prefs[o];n="boolean"==typeof c?c:n;var u=s.SettingsPanel.prototype.addCheckbox.call(this,e,t,n,a,r),d=this.getControl(u);return d.saveKey=o,o?l.prefs.addListeners(o,function(e){d.setValue(e)},function(e){d.setValue(e),i(e)}):d.sliderRow.classList.add("logical-group"),l.prefs.hasTag(o,"no-storage")&&(d.sliderRow.classList.add("no-storage"),this.modelPreferenceCount++),u},n.prototype.addDropDownMenu=function(e,t,r,n,i,o,a,l){function c(e){a&&u.prefs.set(a,n[e.detail.value]),o&&o(e)}var u=this.viewer;a&&(i=n.indexOf(u.prefs.get(a)));var d=s.SettingsPanel.prototype.addDropDownMenu.call(this,e,t,r,i,c,l),h=this.getControl(d);return a?u.prefs.addListeners(a,function(e){h.setSelectedIndex(n.indexOf(e))},function(e){h.setSelectedIndex(n.indexOf(e)),o&&o(e)}):h.sliderRow.classList.add("logical-group"),u.prefs.hasTag(a,"no-storage")&&(h.sliderRow.classList.add("no-storage"),this.modelPreferenceCount++),d},n.prototype.addSliderV2=function(e,t,r,n,i,o,a,l,c){function u(e){var t="number"==typeof e?e:Number(e.detail.value);c&&d.prefs.set(c,t),a(t)}var d=this.viewer,h=d.prefs[c];o="number"==typeof h?h:o,c&&!d.prefs.hasOwnProperty(c)&&d.prefs.add(c,o,["2d","3d"]);var f=s.SettingsPanel.prototype.addSliderV2.call(this,e,t,r,n,i,o,u,l),p=this.getControl(f[1]);return p.saveKey=c,c?d.prefs.addListeners(c,function(e){p.setValue(e)},function(e){p.setValue(e),a(e)}):p.sliderRow.classList.add("logical-group"),d.prefs.hasTag(c,"no-storage")&&(p.sliderRow.classList.add("no-storage"),
this.modelPreferenceCount++),f},n.prototype.addGrid=function(e,t,r,n,o,s){var a=this,l=t,c=this.getDocument(),d=c.createElement("div");d.classList.add("environments-container"),l.appendChild(d);var h=c.createElement("div");h.classList.add("environments-lighting-table"),d.appendChild(h);var p=new f.LightPresetThumbnails(42,26);p.setGlobalManager(this.viewer.globalManager);for(var m=0;m<r.length;m++){var g=r[m],v=c.createElement("div");v.classList.add("settings-environment-cell"),v.index=m;var y=c.createElement("img");y.classList.add("settings-environment-image"),i(p,y,g),v.appendChild(y);var _=c.createElement("span");_.textContent=u.i18n.translate(g.name),_.classList.add("settings-environment-name"),_.setAttribute("data-i18n",g.name),v.appendChild(_),v.addEventListener("click",function(){o(this.index)}),h.appendChild(v)}return this._onBgEnvironmentChange=function(){a.updateEnvironmentSelection()},this._onBgEnvironmentReset=function(){o(a.viewer.prefs.lightPreset),a.updateEnvironmentSelection()},this.viewer.prefs.addListeners(s,this._onBgEnvironmentChange,this._onBgEnvironmentReset),this.updateEnvironmentSelection(),h},n.prototype.updateEnvironmentSelection=function(){if(this.is3dMode&&this.envTabCreated)for(var e=this.viewer.prefs.lightPreset,t=this.gridTable.querySelectorAll(".settings-environment-cell"),r=0;r<t.length;r++)t[r].index===e?t[r].classList.add("border-select"):t[r].classList.remove("border-select")},n.prototype.removeCheckbox=function(e){return this.viewer.prefs.removeListeners(e.saveKey),this.removeEventListener(e,"change",e.changeListener),s.SettingsPanel.prototype.removeCheckbox.call(this,e)},n.prototype.createNavigationPanel=function(){function e(){return this.addSliderV2(n,"Drag Speed","Changes sensitivity of mouse movement with the zoom tool",5,300,i.getDollyDragScale(),function(e){i.setDollyDragScale(e)},{step:5},"zoomDragSpeed")[1]}function t(){return this.addSliderV2(n,"Scroll Speed","Changes sensitivity of the mouse scroll wheel when zooming",.1,3,i.getDollyScrollScale(),function(e){i.setDollyScrollScale(e)},{step:.1},"zoomScrollSpeed")[1]}var r=this.viewer,n=m.Navigation,i=r.toolController.getTool("dolly");this.is3dMode&&(this.addLabel(n,"ViewCube"),this.addCheckbox(n,"Show ViewCube","Toggles availability of the ViewCube navigation control",!0,function(e){r.getExtension("Autodesk.ViewCubeUi",function(t){t.displayViewCube(e)})},"viewCube"),Object(d.isMobileDevice)()||this.addCheckbox(n,"ViewCube acts on pivot","When enabled, the ViewCube orbits the view around the active pivot point When disabled, it orbits around the center of the view",!1,function(e){r.setUsePivotAlways(e)},"alwaysUsePivot"),this.addLabel(n,"Orbit"),this.addCheckbox(n,"Fusion style orbit","Enables Fusion-style orbit overlay and gives the ability to lock orbit axis",!1,function(e){e?r.loadExtension("Autodesk.Viewing.FusionOrbit",null):r.unloadExtension("Autodesk.Viewing.FusionOrbit",null)},"fusionOrbit"),this.addCheckbox(n,"Orbit past world poles","Allows view rotation to continue past the model\u2019s North Pole",!0,function(e){r.setOrbitPastWorldPoles(e)},"orbitPastWorldPoles"),this.addLabel(n,"Zoom"),Object(d.isMobileDevice)()||(this.addCheckbox(n,"Zoom towards pivot","When disabled, zooming operations are centered at the current cursor location",!1,function(e){r.setZoomTowardsPivot(e)},"zoomTowardsPivot"),this.addCheckbox(n,"Reverse mouse zoom direction","Toggles direction of zooming in and out",!1,function(e){r.setReverseZoomDirection(e)},"reverseMouseZoomDir"),this.scrollSpeed=t.call(this)),this.dragSpeed=e.call(this),this.addLabel(n,"Mouse"),Object(d.isMobileDevice)()||(this.addCheckbox(n,"Left handed mouse setup","Swaps the buttons on the mouse",!1,function(e){r.setUseLeftHandedInput(e)},"leftHandedMouseSetup"),this.addCheckbox(n,"Set pivot with left mouse button","Change left-click behavior to set new pivot point (overrides select object)",!1,function(e){r.setClickToSetCOI(e)},"clickToSetCOI")),this.addCheckbox(n,"Open properties on select","Always show properties upon selecting object",!0,function(e){r.prefs.set("openPropertiesOnSelect",e)},"openPropertiesOnSelect")),this.is3dMode||(this.addLabel(n,"Zoom"),this.addCheckbox(n,"Reverse mouse zoom direction","Toggles direction of zooming in and out",!1,function(e){r.setReverseZoomDirection(e)},"reverseMouseZoomDir"),Object(d.isMobileDevice)()||(this.scrollSpeed=t.call(this)),this.dragSpeed=e.call(this),this.addLabel(n,"Mouse"),this.addCheckbox(n,"Open properties on select","Always show properties upon selecting object",!0,function(e){r.prefs.set("openPropertiesOnSelect",e)},"openPropertiesOnSelect"),Object(d.isMobileDevice)()||this.addCheckbox(n,"Left handed mouse setup","Swaps the buttons on the mouse",!1,function(e){r.setUseLeftHandedInput(e)},"leftHandedMouseSetup"))},n.prototype.addConfigButton=function(e,t){var r=this;if(!t)throw new Error("Must register a function callback.");this._externalButtonsLabel||(this._externalButtonsLabel=this.addLabel(m.Configuration,"More"));var n=this.addButton(m.Configuration,e),i=this.getControl(n);return i.setOnClick(function(){r.setVisible(!1),t()}),this._externalButtonIds.push(n),n},n.prototype.removeConfigButton=function(e){var t=this._externalButtonIds.indexOf(e);if(-1===t)return!1;var r=this.getControl(e);return r?(this.removeControl(r),this._externalButtonIds.splice(t,1),0===this._externalButtonIds.length&&null!==this._externalButtonsLabel&&(this._externalButtonsLabel.removeFromParent(),this._externalButtonsLabel=null),!0):!1},n.prototype.createConfigurationPanel=function(){var e=this.viewer,t=m.Configuration;this.tablesContainer.childNodes[0];this.is3dMode&&(this.addLabel(t,"Performance Optimization"),this.optimizeNavigationhkBoxId=this.addCheckbox(t,"Smooth navigation","Provides faster response(but degrades quality) while navigating",Object(d.isMobileDevice)(),function(t){e.setOptimizeNavigation(t)},"optimizeNavigation"),this.progressiveRenderChkBoxId=this.addCheckbox(t,"Progressive display","Shows incremental updates of the view and allows for more responsive interaction with the model (some elements may flicker) This improves perceived waiting time",!0,function(t){e.setProgressiveRendering(t)},"progressiveRendering"),this.addLabel(t,"Display"),this.ghosthiddenChkBoxId=this.addCheckbox(t,"Ghost hidden objects","Leave hidden objects slightly visible",!0,function(t){e.setGhosting(t)},"ghosting"),this.displayLinesId=this.addCheckbox(t,"Display Lines","Toggles display of line objects",!0,function(t){e.hideLines(!t)},"lineRendering"),this.displayPointsId=this.addCheckbox(t,"Display Points","Toggles display of point objects",!0,function(t){e.hidePoints(!t)},"pointRendering"),this.displayEdgesId=this.addCheckbox(t,"Display edges","Shows outline of model surfaces",!1,function(t){e.setDisplayEdges(t)},"edgeRendering")),this.is3dMode||(this.addLabel(t,"Performance Optimization"),this.progressiveRenderChkBoxId=this.addCheckbox(t,"Progressive display","Shows incremental updates of the view and allows for more responsive interaction with the model (some elements may flicker) This improves perceived waiting time",!0,function(t){e.setProgressiveRendering(t)},"progressiveRendering"),this.addLabel(t,"Display")),this.displayUnitsId=this.addDropDownMenu(t,"Display Units",p.displayUnits,p.displayUnitsEnum,null,null,p.Prefs.DISPLAY_UNITS),this.displayUnitsPrecisionId=this.addDropDownMenu(t,"Precision",p.displayUnitsPrecision,p.displayUnitsPrecisionEnum,null,null,p.Prefs.DISPLAY_UNITS_PRECISION),this.is3dMode&&this._addSelectionModeOption()},n.prototype._addSelectionModeOption=function(){var e=m.Configuration;this.addLabel(e,"Selection");var t=[],r=[],n=0;for(var i in Autodesk.Viewing.SelectionMode)t[n]=i,r[n]=Autodesk.Viewing.SelectionMode[i],n++;var o=t.map(function(e){return e.split("_").map(function(e){return e.charAt(0)+e.slice(1).toLowerCase()}).join(" ")});this.selectionModeId=this.addDropDownMenu(e,"Selection Mode",o,r,null,null,p.Prefs3D.SELECTION_MODE)},n.prototype.createAppearancePanel=function(){var e=this.viewer,t=m.Appearance;this.tablesContainer.childNodes[2];this.is3dMode&&(this.addLabel(t,"Visual Quality Optimization"),this.antialiasingChkBoxId=this.addCheckbox(t,"Anti-aliasing","Remove jagged edges from lines",!0,function(t){e.setQualityLevel(e.prefs.ambientShadows,t)},"antialiasing"),this.ambientshadowsChkBoxId=this.addCheckbox(t,"Ambient shadows","Improve shading of occluded surfaces",!0,function(t){e.setQualityLevel(t,e.prefs.antialiasing)},"ambientShadows"),this.groundShadowChkBoxId=this.addCheckbox(t,"Ground shadow","Add simulated ground surface shadows",!0,function(t){e.setGroundShadow(t)},"groundShadow"),this.groundReflectionChkBoxId=this.addCheckbox(t,"Ground reflection","Add simulated ground surface reflections",!1,function(t){e.setGroundReflection(t)},"groundReflection")),this.is3dMode||(this.addLabel(t,"Existing behavior"),this.swapBlackAndWhiteChkBoxId=this.addCheckbox(t,"2D Sheet Color","Switch sheet color white to black",!0,function(t){e.setSwapBlackAndWhite(t)},"swapBlackAndWhite"),this.loadingAnimationChkBoxId=this.addCheckbox(t,"Loading Animation","Animate lines during loading",!0,function(t){e.prefs.set(p.Prefs2D.LOADING_ANIMATION,t)},"loadingAnimation"))},n.prototype.createEnvironmentPanel=function(){if(this.is3dMode&&!this.envTabCreated){this.envTabCreated=!0;var e=this.viewer,t=m.Environment,r=this.tablesContainer.childNodes[3];this.gridTable=r,this.addLabel(t,"Environment"),this.envMapBackgroundChkBoxId=this.addCheckbox(t,"Environment Image Visible","Shows lighting environment as background",!0,function(t){e.setEnvMapBackground(t)}.bind(this),"envMapBackground");var n=r.tBodies[0].insertRow(-1),i=n.insertCell(0),o=this.getDocument();this.caption=o.createElement("div"),this.caption.setAttribute("data-i18n","Environments and Lighting Selection"),this.caption.textContent=u.i18n.translate("Environments and Lighting Selection"),this.caption.classList.add("settings-row-title"),i.appendChild(this.caption),i.colSpan="3",this.envSelect=this.addGrid("Environments and Lighting Selection",r,c.LightPresets,e.impl.currentLightPreset(),function(t){e.setLightPreset(t)},p.Prefs3D.LIGHT_PRESET),this.envSelect.classList.add("with-environment")}},n.prototype.createVersionLabel=function(e){if(e){var t=this.getDocument();this.versionDiv=t.createElement("div"),this.versionDiv.textContent=o(this.viewer.config.viewerVersion),this.versionDiv.className="docking-panel-version-label",e.appendChild(this.versionDiv)}},n.prototype.createRestoreDefaultSettingsButton=function(){var e=this.viewer,t=this.getDocument();this.restoreDiv=t.createElement("div"),this.restoreDiv.classList.add("docking-panel-container-solid-color-b"),this.restoreDiv.classList.add("restore-defaults-container"),this.restoreButton=t.createElement("div"),this.restoreButton.className="docking-panel-tertiary-button",this.restoreButton.setAttribute("data-i18n","Restore all default settings"),this.restoreButton.textContent=Autodesk.Viewing.i18n.translate("Restore all default settings"),this.restoreDiv.appendChild(this.restoreButton),this.addEventListener(this.restoreDiv,"touchstart",d.touchStartToClick),this.addEventListener(this.restoreDiv,"click",function(){e.restoreDefaultSettings()},!1),this.scrollContainer.appendChild(this.restoreDiv)},n.prototype.selectTab=function(e){s.SettingsPanel.prototype.selectTab.call(this,e),this.sizeToContent()},n.prototype.sizeToContent=function(){s.SettingsPanel.prototype.sizeToContent.call(this,this.viewer.container)},n.prototype.onViewerResize=function(e,t,r,n,i,o){this.sizeToContent()},n.prototype.syncUI=function(){var e=this.viewer,t=this.viewer.prefs;this.setControlValue(this.antialiasingChkBoxId,t.antialiasing),this.setControlValue(this.ambientshadowsChkBoxId,t.ambientShadows),this.setControlValue(this.groundShadowChkBoxId,t.groundShadow),this.setControlValue(this.groundReflectionChkBoxId,t.groundReflection),this.setControlValue(this.envMapBackgroundChkBoxId,e.impl.isEnvMapBackground()),this.setControlValue(this.progressiveRenderChkBoxId,t.progressiveRendering),this.setControlValue(this.swapBlackAndWhiteChkBoxId,t.swapBlackAndWhite),this.setControlValue(this.loadingAnimationChkBoxId,t.loadingAnimation),this.setControlValue(this.ghosthiddenChkBoxId,t.ghosting),this.setControlValue(this.displayLinesId,t.lineRendering),this.setControlValue(this.displayPointsId,t.pointRendering),this.setControlValue(this.displayEdgesId,t.edgeRendering),this.setControlValue(this.scrollSpeed,t.zoomScrollSpeed),this.setControlValue(this.dragSpeed,t.zoomDragSpeed),this.updateEnvironmentSelection()},n.prototype.setControlValue=function(e,t){var r=this.getControl(e);r&&r.setValue(t)}},"./src/gui/browser/browser.css":function(e,t,r){},"./src/gui/browser/browser.js":function(e,t,r){"use strict";function n(){}function i(e,t,r){this.myDelegate=e,this.mySelectedIds=[];var n="browserview";this.myRootContainerId=r+"-"+n,this.idToElement={},this.myRootContainer=u.createElement("div"),this.myRootContainer.id=this.myRootContainerId,this.myRootContainer.classList.add(n);var i=u.getElementById(r);i.appendChild(this.myRootContainer),this.createElements(t,this.myRootContainer)}r.r(t),r.d(t,"BrowserDelegate",function(){return n}),r.d(t,"Browser",function(){return i});var o=r("./src/application/Document.js"),s=r("./src/file-loaders/net/ErrorCodes.js"),a=r("./src/logger/Logger.js"),l=r("./src/compat.js"),c=Object(l.getGlobal)(),u=c.document;n.prototype.constructor=n,n.prototype.getNodeId=function(e){throw"getId is not implemented."},n.prototype.getNodeLabel=function(e){return e.name},n.prototype.getNodeClass=function(e){return""},n.prototype.hasThumbnail=function(e){return!1},n.prototype.getThumbnailOptions=function(e){return null},n.prototype.getThumbnail=function(e){return null},n.prototype.onNodeClick=function(e,t,r){},n.prototype.onNodeHover=function(e,t,r){},n.prototype.selectItem=function(e){},n.prototype.deselectItem=function(e){},n.prototype.hasContent=function(e){return!1},n.prototype.addContent=function(e,t){},i.prototype.constructor=i,i.prototype.show=function(e){e?(this.myRootContainer.classList.remove("browserHidden"),this.myRootContainer.classList.add("browserVisible"),this.myRootContainer.style.display="block"):(this.myRootContainer.classList.remove("browserVisible"),this.myRootContainer.classList.add("browserHidden"),this.myRootContainer.style.display="none")},i.prototype.getRootContainer=function(){return this.myRootContainer},i.prototype.delegate=function(){return this.myDelegate},i.prototype.addToSelection=function(e){function t(e){var t=r.mySelectedIds.indexOf(e);return-1==t?(r.mySelectedIds.push(e),!0):!1}for(var r=this,n=0,i=e.length;i>n;++n){var o=e[n];if(t(o)){var s=r.idToElement[o];void 0===s?r.myDelegate.selectItem(o):s.classList.add("selected")}}},i.prototype.removeFromSelection=function(e){function t(e){var t=r.mySelectedIds.indexOf(e);return-1!=t?(r.mySelectedIds.splice(t,1),!0):!1}for(var r=this,n=e.length-1;n>=0;--n){var i=e[n];if(t(i)){var o=this.idToElement[i];void 0===o?r.myDelegate.deselectItem(i):o.classList.remove("selected")}}},i.prototype.setSelection=function(e){return this.removeFromSelection(this.mySelectedIds),this.addToSelection(e),this.mySelectedIds},i.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)},i.prototype.createElements=function(e,t){if(e)for(var r=this,n=0;n<e.length;n++){var i=e[n];r.createElement(i,t)}},i.prototype.createElement=function(e,t){var r=this,n=r.myDelegate.getNodeId(e),i=u.createElement("item");t.appendChild(i),this.idToElement[n]=i,i.onmouseover=function(){r.myDelegate.onNodeHover(r,e)},i.onclick=function(t){r.myRootContainer.querySelector(".flipped").removeClass("flipped"),r.myDelegate.onNodeClick(r,e,t)};var l=u.createElement("div");l.classList.add("card"),i.appendChild(l);var d=u.createElement("div");d.classList.add("browserElement"),l.appendChild(d);var h=r.myDelegate.getNodeLabel(e),f=u.createElement("label");f.innerHTML=h,d.appendChild(f),f.onclick=function(t){r.myDelegate.onNodeClick(r,e,t)};var p=r.myDelegate.getThumbnail(e);if(p){var m=u.createElement("img");m.classList.add("thumb");var g=r.myDelegate.getThumbnailOptions(e);o.Document.requestThumbnailWithSecurity(g,function(e,t){return e?void a.logger.error("Failed to load thumbnail: "+p,Object(s.errorCodeString)(s.ErrorCodes.NETWORK_FAILURE)):(m.src=c.URL.createObjectURL(t),void(m.onload=function(){c.URL.revokeObjectURL(m.src)}))}),d.appendChild(m),m.onclick=function(t){r.myDelegate.onNodeClick(r,e,t)}}r.myDelegate.hasContent(e)&&r.myDelegate.addContent(e,l),i.classList.add(r.myDelegate.getNodeClass(e))}},"./src/gui/controls/Button.css":function(e,t,r){},"./src/gui/controls/Button.js":function(e,t,r){"use strict";function n(e,t){i.Control.call(this,e,t);var r=this;this._state=n.State.INACTIVE;var s=this.getDocument();this.icon=s.createElement("div"),this.icon.classList.add("adsk-button-icon"),this.container.appendChild(this.icon),this.container.addEventListener("click",function(e){r.getState()!==n.State.DISABLED&&(r.dispatchEvent(n.Event.CLICK),r.onClick&&r.onClick(e)),e.stopPropagation()}),Object(o.isTouchDevice)()?this.container.addEventListener("touchstart",o.touchStartToClick):(this.container.addEventListener("mouseover",function(e){r.onMouseOver(e)}),this.container.addEventListener("mouseout",function(e){r.onMouseOut(e)})),this.addClass("adsk-button"),this.addClass(n.StateToClassMap[this._state])}r.r(t),r.d(t,"Button",function(){return n});var i=r("./src/gui/controls/Control.js"),o=r("./src/compat.js");n.Event={VISIBILITY_CHANGED:i.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:i.Control.Event.COLLAPSED_CHANGED,STATE_CHANGED:"Button.StateChanged",CLICK:"click"},n.State={ACTIVE:0,INACTIVE:1,DISABLED:2},n.StateToClassMap=function(){var e=n.State,t={};return t[e.ACTIVE]="active",t[e.INACTIVE]="inactive",t[e.DISABLED]="disabled",t}(),n.prototype=Object.create(i.Control.prototype),n.prototype.constructor=n,n.prototype.setState=function(e){if(e===this._state)return!1;this.removeClass(n.StateToClassMap[this._state]),this.addClass(n.StateToClassMap[e]),this._state=e;var t={type:n.Event.STATE_CHANGED,state:e};return this.dispatchEvent(t),!0},n.prototype.setIcon=function(e){this.iconClass&&this.icon.classList.remove(this.iconClass),this.iconClass=e,this.icon.classList.add(e)},n.prototype.getState=function(){return this._state},n.prototype.onClick=function(e){},n.prototype.onMouseOver=function(e){},n.prototype.onMouseOut=function(e){}},"./src/gui/controls/ComboButton.css":function(e,t,r){},"./src/gui/controls/ComboButton.js":function(e,t,r){"use strict";function n(e,t){i.Button.call(this,e,t),this.arrowButton=new i.Button(e+"arrow"),this.arrowButton.addClass("adsk-button-arrow"),this.arrowButton.removeClass("adsk-button"),this.subMenu=new o.RadioButtonGroup(e+"SubMenu"),this.subMenu.addClass("toolbar-vertical-group"),this.subMenu.setVisible(!1),this.container.insertBefore(this.subMenu.container,this.container.firstChild),this.container.insertBefore(this.arrowButton.container,this.container.firstChild);var r=this;this.arrowButton.onClick=function(e){r.subMenu.setVisible(!r.subMenu.isVisible())},this.toggleFlyoutVisible=function(){r.subMenu.setVisible(!r.subMenu.isVisible())},this.onClick=function(e){r.subMenu.setVisible(!r.subMenu.isVisible())},this.subMenuActiveButtonChangedHandler=function(e){e.isActiveButton?(r.setIcon(e.target.getActiveButton().iconClass),r.setToolTip(e.target.getActiveButton().getToolTip()),r.setState(i.Button.State.ACTIVE),r.onClick=e.button.onClick):r.setState(i.Button.State.INACTIVE)},this.subMenu.addEventListener(o.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,this.subMenuActiveButtonChangedHandler);var n=Object(s.stringToDOM)('<div class="clickoff" style="position:fixed; top:0; left:0; width:100vw; height:100vh;"></div>');this.subMenu.container.insertBefore(n,this.subMenu.container.firstChild),n.addEventListener("click",function(e){r.subMenu.setVisible(!1),e.stopPropagation()})}r.r(t),r.d(t,"ComboButton",function(){return n});var i=r("./src/gui/controls/Button.js"),o=r("./src/gui/controls/RadioButtonGroup.js"),s=r("./src/globals.js");n.prototype=Object.create(i.Button.prototype),n.prototype.constructor=n,n.prototype.addControl=function(e){this.subMenu.addControl(e),e.addEventListener(i.Button.Event.CLICK,this.toggleFlyoutVisible)},n.prototype.removeControl=function(e){e.removeEventListener(i.Button.Event.CLICK,this.toggleFlyoutVisible)},n.prototype.setState=function(e){if(e===i.Button.State.INACTIVE){var t=this.subMenu.getActiveButton();t&&t.setState(i.Button.State.INACTIVE)}i.Button.prototype.setState.call(this,e)},n.prototype.saveAsDefault=function(){this.defaultState={},this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")&&(this.defaultState.tooltip=this._toolTipElement.getAttribute("tooltipText")),this.defaultState.icon=this.iconClass,this.defaultState.onClick=this.onClick},n.prototype.restoreDefault=function(){this.defaultState&&(this.defaultState.tooltip&&this.setToolTip(this.defaultState.tooltip),this.defaultState.icon&&this.setIcon(this.defaultState.icon),this.onClick=this.defaultState.onClick,this.setState(i.Button.State.INACTIVE))}},"./src/gui/controls/Control.css":function(e,t,r){},"./src/gui/controls/Control.js":function(e,t,r){"use strict";function n(e,t){this._id=e,this._isCollapsible=!t||t.collapsible,this._toolTipElement=null,this._listeners={},this.container=this.getDocument().createElement("div"),this.container.id=e,this.addClass("adsk-control")}r.r(t),r.d(t,"Control",function(){return n});var i=r("./src/application/EventDispatcher.js"),o=r("./src/application/GlobalManagerMixin.js");o.GlobalManagerMixin.call(n.prototype),n.Event={VISIBILITY_CHANGED:"Control.VisibilityChanged",COLLAPSED_CHANGED:"Control.CollapsedChanged"},i.EventDispatcher.prototype.apply(n.prototype),n.prototype.constructor=n,n.prototype.container=null,n.prototype.getId=function(){return this._id},n.prototype.setVisible=function(e){var t=!this.container.classList.contains("adsk-hidden");if(t===e)return!1;e?this.container.classList.remove("adsk-hidden"):this.container.classList.add("adsk-hidden");var r={type:n.Event.VISIBILITY_CHANGED,target:this,controlId:this._id,isVisible:e};return this.dispatchEvent(r),!0},n.prototype.isVisible=function(){return!this.container.classList.contains("adsk-hidden")},n.prototype.setToolTip=function(e){return this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")===e?!1:(this._toolTipElement||(this._toolTipElement=this.getDocument().createElement("div"),this._toolTipElement.id=this._id+"-tooltip",this._toolTipElement.classList.add("adsk-control-tooltip"),this.container.appendChild(this._toolTipElement)),this._toolTipElement.setAttribute("data-i18n",e),this._toolTipElement.setAttribute("tooltipText",e),this._toolTipElement.textContent=Autodesk.Viewing.i18n.translate(e,{defaultValue:e}),!0)},n.prototype.getToolTip=function(){return this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")},n.prototype.setCollapsed=function(e){if(!this._isCollapsible||this.isCollapsed()===e)return!1;e?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed");var t={type:n.Event.COLLAPSED_CHANGED,isCollapsed:e};return this.dispatchEvent(t),!0},n.prototype.isCollapsed=function(){return!!this.container.classList.contains("collapsed")},n.prototype.isCollapsible=function(){return this._isCollapsible},n.prototype.addClass=function(e){this.container.classList.add(e)},n.prototype.removeClass=function(e){this.container.classList.remove(e)},n.prototype.getPosition=function(){var e=this.container.getBoundingClientRect();return{top:e.top,left:e.left}},n.prototype.getDimensions=function(){var e=this.container.getBoundingClientRect();return{width:e.width,height:e.height}},n.prototype.setDisplay=function(e){this.container.style.display=e},n.prototype.removeFromParent=function(){return this.parent?this.parent.removeControl(this):!1}},"./src/gui/controls/ControlGroup.css":function(e,t,r){},"./src/gui/controls/ControlGroup.js":function(e,t,r){"use strict";function n(e,t){i.Control.call(this,e,t);var r=this;this._controls=[],this.addClass("adsk-control-group"),this.handleChildSizeChanged=function(e){var t={type:n.Event.SIZE_CHANGED,childEvent:e};r.dispatchEvent(t)}}r.r(t),r.d(t,"ControlGroup",function(){return n});var i=r("./src/gui/controls/Control.js");n.Event={VISIBILITY_CHANGED:i.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:i.Control.Event.COLLAPSED_CHANGED,SIZE_CHANGED:"ControlGroup.SizeChanged",CONTROL_ADDED:"ControlGroup.ControlAdded",CONTROL_REMOVED:"ControlGroup.ControlRemoved"},n.prototype=Object.create(i.Control.prototype),n.prototype.constructor=n,n.prototype.addControl=function(e,t){e.setGlobalManager(this.globalManager);var r=t&&void 0!==t.index?t.index:this._controls.length;if(null!==this.getControl(e.getId()))return!1;var o={type:n.Event.CONTROL_ADDED,control:e,index:r};return r<this._controls.length?(this.container.insertBefore(e.container,this._controls[r].container),this._controls.splice(r,0,e)):(this.container.appendChild(e.container),this._controls.push(e)),e.addEventListener(i.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),e.addEventListener(i.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),e instanceof n&&e.addEventListener(n.Event.SIZE_CHANGED,this.handleChildSizeChanged),e.parent=this,this.dispatchEvent(o),this.dispatchEvent(n.Event.SIZE_CHANGED),!0},n.prototype.indexOf=function(e){for(var t=0;t<this._controls.length;t++){var r=this._controls[t];if(r===e||"string"==typeof e&&e===r.getId())return t}return-1},n.prototype.removeControl=function(e){var t="string"==typeof e?this.getControl(e):e;if(!t)return!1;var r=this._controls.indexOf(t);if(-1===r)return!1;this._controls.splice(r,1),this.container.removeChild(t.container);var o={type:n.Event.CONTROL_REMOVED,control:t,index:r};return t.removeEventListener(i.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),t.removeEventListener(i.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),t instanceof n&&t.removeEventListener(n.Event.SIZE_CHANGED,this.handleChildSizeChanged),t.parent=void 0,this.dispatchEvent(o),this.dispatchEvent(n.Event.SIZE_CHANGED),!0},n.prototype.getControl=function(e){for(var t=0;t<this._controls.length;t++)if(e===this._controls[t].getId())return this._controls[t];return null},n.prototype.getControlId=function(e){return 0>e||e>=this._controls.length?null:this._controls[e].getId()},n.prototype.getNumberOfControls=function(){return this._controls.length},n.prototype.setCollapsed=function(e){if(!this._isCollapsible)return!1;var t=!1;return this._controls.forEach(function(r){r.isCollapsible()&&r.setCollapsed(e)&&(t=!0)}),t&&(e?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this.dispatchEvent({type:n.Event.COLLAPSED_CHANGED,isCollapsed:e})),t}},"./src/gui/controls/Filterbox.css":function(e,t,r){},"./src/gui/controls/Filterbox.js":function(e,t,r){"use strict";function n(e,t){this._id=e,this._listeners={},this._options=t||{},this._filterFunction=this._options.filterFunction||function(){};var r=this.getDocument();this.container=r.createElement("div"),this.container.id=e,this.addClass("adsk-control"),this.addClass("adsk-filterbox"),this.addClass("empty");var n=r.createElement("input");n.classList.add("filter-box"),n.classList.add("docking-panel-delimiter-shadow"),n.type="search",n.placeholder=o.i18n.translate("Enter filter term"),n.setAttribute("data-i18n","Enter filter term"),n.incremental="incremental",n.autosave=this.container.id+"filter",this.container.appendChild(n),this.filterbox=n;var i=this,s=function(){i.filterbox.value="",i.addClass("empty")},a=function(e){e=e.trim(),0===e.length?i.container.classList.add("empty"):i.container.classList.remove("empty"),i._filterFunction&&i._filterFunction(e)},l=r.createElement("div");l.className="filter-box-icon",this.container.insertBefore(l,n.nextSibling);var c=r.createElement("div");c.className="filter-box-close",c.addEventListener("click",function(){s()}),this.container.appendChild(c),n.addEventListener("keydown",function(e){var t=i.getWindow();e=e||t.event,13===e.keyCode&&i.filterbox.blur()}),n.addEventListener("input",function(e){a(this.value)}),n.addEventListener("change",function(e){a(this.value)}),n.addEventListener("focus",function(){l.classList.add("focused")}),n.addEventListener("blur",function(){l.classList.remove("focused")})}r.r(t),r.d(t,"Filterbox",function(){return n});var i=r("./src/gui/controls/Control.js"),o=r("./src/globalization/i18next.js");n.prototype=Object.create(i.Control.prototype),n.prototype.constructor=n},"./src/gui/controls/RadioButtonGroup.js":function(e,t,r){"use strict";function n(e,t){i.ControlGroup.call(this,e,t);var r=this;this._activeButton=null,this._handleButtonStateChange=function(e){var t=o.Button.State;return e.state!==t.ACTIVE?void(e.target===r._activeButton&&(r._activeButton=null,r.dispatchEvent({type:n.Event.ACTIVE_BUTTON_CHANGED,button:e.target,isActiveButton:!1}))):(r._activeButton=e.target,r.dispatchEvent({type:n.Event.ACTIVE_BUTTON_CHANGED,button:e.target,isActiveButton:!0}),void r._controls.forEach(function(r){r!==e.target&&r.getState()!==t.DISABLED&&r.setState(t.INACTIVE)}))}}r.r(t),r.d(t,"RadioButtonGroup",function(){return n});var i=r("./src/gui/controls/ControlGroup.js"),o=r("./src/gui/controls/Button.js"),s=r("./src/gui/controls/Control.js");n.Event={ACTIVE_BUTTON_CHANGED:"RadioButtonGroup.ActiveButtonChanged",VISIBILITY_CHANGED:s.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:s.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:i.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:i.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:i.ControlGroup.Event.SIZE_CHANGED},n.prototype=Object.create(i.ControlGroup.prototype),n.prototype.constructor=n,n.prototype.addControl=function(e,t){return e instanceof o.Button&&i.ControlGroup.prototype.addControl.call(this,e,t)?(e.addEventListener(o.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0):!1},n.prototype.removeControl=function(e){var t="string"==typeof e?this.getControl(e):e;return null!==t&&i.ControlGroup.prototype.removeControl.call(this,t)?(t.removeEventListener(o.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0):!1},n.prototype.getActiveButton=function(){return this._activeButton}},"./src/gui/controls/SearchEvents.js":function(e,t,r){"use strict";r.r(t),r.d(t,"ON_SEARCH_SELECTED",function(){return n});var n="search-selected"},"./src/gui/controls/SearchResults.css":function(e,t,r){},"./src/gui/controls/SearchResults.js":function(e,t,r){"use strict";function n(e,t,r){this.excludeRoot=t,this.viewer=r,this.results=[],this.resultCount=0,this.selectedIndex=-1;var n=this.getDocument();this.container=n.createElement("div"),this.container.classList.add("docking-panel"),this.container.classList.add("adsk-search-results"),this.container.results=n.createElement("div"),this.container.results.classList.add("docking-panel-scroll"),this.container.results.classList.add("docking-panel-container-solid-color-b"),this.container.results.addEventListener("scroll",o.bind(this)),this.container.appendChild(this.container.results),e.insertBefore(this.container,e.firstChild),this.scrollingContainer=n.createElement("div"),this.scrollingContainer.classList.add("adsk-search-results-scrolling-panel"),this.scrollingContainer.addEventListener("click",i.bind(this)),this.container.results.appendChild(this.scrollingContainer),this.footer=new b.ResizeFooter(this.container,function(){var e=this.container.getBoundingClientRect(),t=this.viewer.container.getBoundingClientRect();t.right<e.right&&(this.container.style.width=t.right-e.left+"px"),t.bottom<e.bottom&&(this.container.style.height=t.bottom-e.top+"px")}.bind(this)),this.footer.setGlobalManager(this.globalManager),this.divNoResults=g(n),this.scrollingContainer.appendChild(this.divNoResults),this.scrollY=0,this.dirty=!1,this.nextFrameId=0,this.it=d(),this.elementsPool=[],
this.elementsUsed=0;for(var s=0;S>s;++s)this.elementsPool[s]=p(n);this.setVisible(!1)}function i(e){var t=e.target,r=this._getNodeAndModelIds(t);r&&(this.fireEvent({type:_.ON_SEARCH_SELECTED,id:r.nodeId,modelId:r.modelId}),e.preventDefault())}function o(e){var t=this.container.results.scrollTop;Math.abs(this.scrollY-t)>=A&&(this.scrollY=t,s(this))}function s(e,t){(!e.dirty||t)&&(t?a(e):(e.dirty=!0,e.nextFrameId=requestAnimationFrame(function(){a(e)})))}function a(e){return e.dirty=!1,l(e),0===e.resultCount?void e.setDisplayNoResults(!0):(e.setDisplayNoResults(!1),void c(e))}function l(e){for(var t=e.elementsUsed,r=e.elementsPool,n=0;t>n;++n){var i=r[n];m(i)}e.elementsUsed=0}function c(e){var t=e.container.results,r=0,n=t.clientHeight,i=e.scrollY,o=e.it.init(e.results),s=Math.max(0,e.scrollY-A),a=0|Math.floor(s/w),l=0;for(r=a*w;a;)a--,l++,o.next();var c=e.elementsPool[e.elementsUsed++];c.style.height=r+"px",e.scrollingContainer.appendChild(c);for(var u=!0;u;){if(o.next(),o.done()){u=!1;break}if(r>i+n+A){u=!1;break}if(e.elementsUsed===e.elementsPool.length){u=!1;break}var d=o.id(),f=o.delegate(),p=w,m=r,g=m+p,v=e.elementsPool[e.elementsUsed++];h(d,f,v,e,l===e.selectedIndex),e.scrollingContainer.appendChild(v),r=g,l++}var y=e.resultCount*w;e.scrollingContainer.style.height=y+"px"}function u(e){for(var t=0,r=0;r<e.length;++r){var n=e[r];t+=n.ids.length}return t}function d(){var e={init:function(e){return this.isDone=!1,this.results=e,this.indexRs=0,this.indexId=-1,this},done:function(){return this.isDone},next:function(){if(this.isDone)return this;for(this.indexId++;this.results.length!==this.indexRs&&this.indexId===this.results[this.indexRs].ids.length;)this.indexId=0,this.indexRs++;return this.isDone=this.indexRs===this.results.length,this},id:function(){return this.results[this.indexRs].ids[this.indexId]},delegate:function(){return this.results[this.indexRs].delegate}};return e}function h(e,t,r,n,i){r.classList.add("search-result"),i?r.classList.add("selected"):r.classList.remove("selected"),r.setAttribute("lmv-nodeId",e),r.setAttribute("lmv-modelId",t.model.id),r.style.height=w+"px";var o=t.instanceTree.getNodeName(e),s=n.searchString,a=o.toLowerCase().indexOf(s.toLowerCase()),l=o.substr(0,a),c=o.substr(a,s.length),u=o.substr(a+s.length);r.domPrefix.innerText=l,r.domMatch.innerText=c,r.domSufix.innerText=u;var d=f(e,t,n);r.domPath.innerText=d.join(" > ")}function f(e,t,r){for(var n=[],i=t.getRootId(),o=r.isRootExcluded(),s=t.instanceTree,a=e,l=!1;a&&!l&&(a!==i||(l=!0,!o));){var c=s.getNodeName(a);n.unshift(c),a=s.getNodeParentId(a)}return n}function p(e){var t=e.createElement("div"),r=e.createElement("div"),n=e.createElement("span"),i=e.createElement("span"),o=e.createElement("span"),s=e.createElement("span");return r.classList.add("search-result-container"),i.classList.add("search-match"),s.classList.add("search-path"),r.appendChild(n),r.appendChild(i),r.appendChild(o),r.appendChild(s),t.appendChild(r),t.domPrefix=n,t.domMatch=i,t.domSufix=o,t.domPath=s,t.domContainer=r,t}function m(e){e.setAttribute("lmv-nodeId",""),e.setAttribute("lmv-modelId",""),e.domPrefix.innerText="",e.domMatch.innerText="",e.domSufix.innerText="",e.domPath.innerText="",e.style.height="0"}function g(e){var t=e.createElement("div"),r=e.createElement("div"),n=e.createElement("div");t.classList.add("no-results-container"),t.style.display="none";var i="No Results";r.setAttribute("data-i18n",i),r.textContent=Autodesk.Viewing.i18n.translate(i),r.classList.add("no-results-title");var o="Try another term";return n.setAttribute("data-i18n",o),n.textContent=Autodesk.Viewing.i18n.translate(o),n.classList.add("no-results-description"),t.appendChild(r),t.appendChild(n),t.domTitle=r,t.domMessage=n,t}function v(e,t){e.scrollTop+e.clientHeight<(t+1)*w&&(e.scrollTop+=(t+1)*w-(e.scrollTop+e.clientHeight)),e.scrollTop/w>t&&(e.scrollTop=t*w)}r.r(t),r.d(t,"SearchResults",function(){return n});var y=r("./src/application/EventDispatcher.js"),_=r("./src/gui/controls/SearchEvents.js"),b=r("./src/gui/CommonWidgets.js"),x=r("./src/application/GlobalManagerMixin.js"),w=50,E=20,S=150,A=100;n.prototype.constructor=n,y.EventDispatcher.prototype.apply(n.prototype),x.GlobalManagerMixin.call(n.prototype),n.prototype.setPosition=function(e,t){this.container.style.left=e+"px",this.container.style.top=t+"px"},n.prototype.setMinWidth=function(e){this.container.style.width=e+"px"},n.prototype.setMaxWidth=function(e){this.container.style.maxHeight=e+"px"},n.prototype.setVisible=function(e){this.container.style.display=e?"":"none"},n.prototype.setResults=function(e,t){this.searchString=e,this.results=t,this.resultCount=u(t),this.selectedIndex=0==this.resultCount?-1:0,this.container.style.height=this.resultCount*w+E+"px",this.container.results.scrollTop=0,this.scrollY=0,0===this.resultCount?this.container.classList.add("no-content"):this.container.classList.remove("no-content"),s(this)},n.prototype.getSelection=function(){var e=this.scrollingContainer.querySelector(".selected");if(!e)return null;var t=this._getNodeAndModelIds(e);return t?t:null},n.prototype.isRootExcluded=function(){return this.results&&this.results.length>1?!1:this.modelCount>1?!1:this.excludeRoot},n.prototype.uninitialize=function(){this.setVisible(!1),this.container=null,this.container.parentNode&&this.container.parentNode.removeChild(this.container),cancelAnimationFrame(this.nextFrameId),this.clearListeners()},n.prototype.setDisplayNoResults=function(e){this.divNoResults.style.display=e?"":"none"},n.prototype.selectNext=function(){0!==this.resultCount&&(this.selectedIndex=Math.min(this.resultCount-1,this.selectedIndex+1),v(this.container.results,this.selectedIndex),s(this))},n.prototype.selectPrevious=function(){0!==this.resultCount&&(this.selectedIndex=Math.max(0,this.selectedIndex-1),v(this.container.results,this.selectedIndex),s(this))},n.prototype._getNodeAndModelIds=function(e){for(;!e.hasAttribute("lmv-nodeId");)if(e=e.parentNode,!e||e===this.scrollingContainer)return;var t=parseInt(e.getAttribute("lmv-nodeId")),r=parseInt(e.getAttribute("lmv-modelId"));return{nodeId:t,modelId:r}}},"./src/gui/controls/Searchbox.css":function(e,t,r){},"./src/gui/controls/Searchbox.js":function(e,t,r){"use strict";function n(e,t,r){function i(){var e=u.value.trim();if(0===e.length)return void h();v&&(s.logger.track({category:"search_node",name:"model_browser_tool"}),v=!1),u.classList.add("searching");var t=g._searchFunction(e);g.searchResults.setResults(e,t),g.searchResults.setVisible(!0)}this._id=e,this._listeners={},this._options=r||{},this._searchFunction=this._options.searchFunction||function(){};var c=this.getDocument();this.container=c.createElement("div"),this.container.id=e,this.addClass("adsk-control"),this.addClass("adsk-searchbox"),this.addClass("empty");var u=c.createElement("input");u.classList.add("search-box"),u.classList.add("docking-panel-delimiter-shadow"),u.type="search",u.results=[],u.placeholder=l.i18n.translate("Search"),u.setAttribute("data-i18n","Search"),u.incremental="incremental",u.autosave=this.container.id+"search_autosave",this.container.insertBefore(u,this.scrollContainer),this.searchbox=u;var d=function(){g.searchbox.value="",g.addClass("empty")},h=function(){g.searchbox.classList.remove("searching"),g.searchResults.setVisible(!1)},f=c.createElement("div");f.className="search-box-icon",this.container.insertBefore(f,u.nextSibling);var p=c.createElement("div");p.className="search-box-close",p.addEventListener("click",function(){d(),h()}),this.container.appendChild(p),this.searchResults=new a.SearchResults(this.container,r.excludeRoot,t),this.searchResults.addEventListener(o.ON_SEARCH_SELECTED,function(e){d(),h(),g.fireEvent(e)});var m,g=this,v=!0,y=800;u.addEventListener("keydown",function(e){var t=g.getWindow();if(e=e||t.event,38===e.keyCode&&(g.searchResults.selectPrevious(),e.preventDefault()),40===e.keyCode&&(g.searchResults.selectNext(),e.preventDefault()),13===e.keyCode){var r=g.searchResults.getSelection();if(!r)return!1;d(),h(),g.fireEvent({type:n.Events.ON_SEARCH_SELECTED,id:r.nodeId,modelId:r.modelId}),e.preventDefault()}}),u.addEventListener("input",function(e){return 0===this.value.length?(g.container.classList.add("empty"),void h()):(g.container.classList.remove("empty"),void(this.value.length<3||(clearTimeout(m),m=setTimeout(i,y))))}),u.addEventListener("change",function(e){var t=g.getDocument();e.target===t.activeElement&&(clearTimeout(m),i())}),u.addEventListener("focus",function(){f.classList.add("focused")}),u.addEventListener("blur",function(){f.classList.remove("focused")})}r.r(t),r.d(t,"Searchbox",function(){return n});var i=r("./src/gui/controls/Control.js"),o=r("./src/gui/controls/SearchEvents.js"),s=r("./src/logger/Logger.js"),a=r("./src/gui/controls/SearchResults.js"),l=r("./src/globalization/i18next.js");n.prototype=Object.create(i.Control.prototype),n.prototype.constructor=n,n.Events={ON_SEARCH_SELECTED:o.ON_SEARCH_SELECTED}},"./src/gui/icon-fonts/codes.css":function(e,t,r){},"./src/gui/icon-fonts/header.css":function(e,t,r){},"./src/gui/splitview-layout/SplitViewHorizontalHandler.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=u(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=d(e),null!==e););return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r.r(t),r.d(t,"default",function(){return m});var p=r("./src/gui/splitview-layout/SplitViewResizeHandler.js"),m=function(e){function t(){return i(this,t),a(this,d(t).apply(this,arguments))}return h(t,e),s(t,[{key:"initResizeHandlerElement",value:function(){c(d(t.prototype),"initResizeHandlerElement",this).call(this),this.resizeHandlerElement.classList.add("horizontal"),this.handlerSplitLine.classList.add("horizontal"),this.resizeHandlerElement.style.height="".concat(this.margin,"px")}},{key:"getTargetWidthPercentage",value:function(e,t){var r=e.pageY-t.top,n=r/t.height*100;return n}},{key:"setPosition",value:function(e){this.resizeHandlerElement.style.top="calc(".concat(e,"% - ").concat(this.margin/2,"px)")}}]),t}(p["default"])},"./src/gui/splitview-layout/SplitViewLayout.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}r.r(t),r.d(t,"SplitViewLayout",function(){return c});var s=r("./src/gui/splitview-layout/SplitViewVerticalHandler.js"),a=r("./src/gui/splitview-layout/SplitViewHorizontalHandler.js"),l=r("./src/gui/splitview-layout/SplitViewLayout.scss"),c=(r.n(l),function(){function e(t){n(this,e),this._splitType=t||e.SplitType.Vertical,this.onResizeHandlerMove=this.onResizeHandlerMove.bind(this)}return o(e,[{key:"createSplitViewLayout",value:function(t,r,n){if(this.targetContainer=t,this.splitViewContainer=document.createElement("div"),this.splitViewContainer.classList.add("split-view-container"),this.targetContainer.parentNode.replaceChild(this.splitViewContainer,this.targetContainer),this.firstViewerContainer=this.wrapViewerContainer(r),this._splitType===e.SplitType.Vertical)this._resizeHandler=new s["default"](this.splitViewContainer,this.onResizeHandlerMove);else{if(this._splitType!==e.SplitType.Horizontal)return;this._resizeHandler=new a["default"](this.splitViewContainer,this.onResizeHandlerMove)}this._resizeHandler&&this.splitViewContainer.appendChild(this._resizeHandler.resizeHandlerElement),this.secondViewerContainer=this.wrapViewerContainer(n),this.onResizeHandlerMove(50)}},{key:"wrapViewerContainer",value:function(e){var t=document.createElement("div");return t.className="split-view-viewer-container",e&&t.appendChild(e),this.splitViewContainer.appendChild(t),t}},{key:"restoreMainViewer",value:function(){this._resizeHandler&&(this._resizeHandler.terminate(),this._resizeHandler=null),this.splitViewContainer&&(this.splitViewContainer.parentNode.replaceChild(this.targetContainer,this.splitViewContainer),this.splitViewContainer=null,this.targetContainer=null,this.firstViewerContainer=null,this.secondViewerContainer=null)}},{key:"onResizeHandlerMove",value:function(t){this._resizeHandler&&this._resizeHandler.setPosition(t),this._splitType===e.SplitType.Vertical?(this.firstViewerContainer.style.width="".concat(t,"%"),this.secondViewerContainer.style.width="".concat(100-t,"%"),this.secondViewerContainer.style.left="".concat(t,"%")):this._splitType===e.SplitType.Horizontal&&(this.firstViewerContainer.style.height="".concat(t,"%"),this.secondViewerContainer.style.height="".concat(100-t,"%"),this.secondViewerContainer.style.top="".concat(t,"%"))}}]),e}());c.SplitType={Vertical:"vertical",Horizontal:"horizontal"}},"./src/gui/splitview-layout/SplitViewLayout.scss":function(e,t,r){},"./src/gui/splitview-layout/SplitViewResizeHandler.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e){if(Autodesk.Viewing.isIE11)return[l[e].pointer];var t=[];return Autodesk.Viewing.isMobileDevice()||t.push(l[e].mouse),Autodesk.Viewing.isTouchDevice()&&t.push(l[e].touch),t}function a(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!1,i=(n?"remove":"add")+"EventListener",o=s(t),a=!0,l=!1,c=void 0;try{for(var u,d=o[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var h=u.value;e[i](h,r)}}catch(f){l=!0,c=f}finally{try{a||null==d["return"]||d["return"]()}finally{if(l)throw c}}}r.r(t),r.d(t,"default",function(){return c});var l={down:{pointer:"pointerdown",mouse:"mousedown",touch:"touchstart"},up:{pointer:"pointerup",mouse:"mouseup",touch:"touchend"},move:{pointer:"pointermove",mouse:"mousemove",touch:"touchmove"}},c=function(){function e(t,r){n(this,e),this.container=t,this.isDragging=!1,this.resizeHandlerElement=null,this.onMoveCB=r,this.panelSizeThreshold=20,this.margin=16,this.initResizeHandlerElement()}return o(e,[{key:"onDown",value:function(e){this.isDragging=!0,e.preventDefault()}},{key:"onUp",value:function(e){this.isDragging=!1}},{key:"onMove",value:function(e){if(this.isDragging){"touchmove"===e.type&&(e.pageX=e.touches[0].pageX,e.pageY=e.touches[0].pageY);var t=this.container.getBoundingClientRect(),r=this.getTargetWidthPercentage(e,t);this.panelSizeThreshold<r&&r<100-this.panelSizeThreshold&&this.onMoveCB(r)}}},{key:"getTargetWidthPercentage",value:function(e,t){}},{key:"initResizeHandlerElement",value:function(){this.resizeHandlerElement=document.createElement("div"),this.handlerSplitLine=document.createElement("div"),this.resizeHandlerElement.appendChild(this.handlerSplitLine),a(this.resizeHandlerElement,"down",this.onDown.bind(this)),this.onUpBinded=this.onUp.bind(this),this.onMoveBinded=this.onMove.bind(this),a(document,"move",this.onMoveBinded),a(document,"up",this.onUpBinded),this.resizeHandlerElement.className="resize-handler",this.handlerSplitLine.className="resize-handler-center-mark"}},{key:"setPosition",value:function(e){}},{key:"terminate",value:function(){this.resizeHandlerElement.parentNode.removeChild(this.resizeHandlerElement),this.resizeHandlerElement=null,a(document,"up",this.onUpBinded,!0),a(document,"move",this.onMoveBinded,!0)}}]),e}()},"./src/gui/splitview-layout/SplitViewVerticalHandler.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=u(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=d(e),null!==e););return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r.r(t),r.d(t,"default",function(){return m});var p=r("./src/gui/splitview-layout/SplitViewResizeHandler.js"),m=function(e){function t(){return i(this,t),a(this,d(t).apply(this,arguments))}return h(t,e),s(t,[{key:"initResizeHandlerElement",value:function(){c(d(t.prototype),"initResizeHandlerElement",this).call(this),this.resizeHandlerElement.classList.add("vertical"),this.handlerSplitLine.classList.add("vertical"),this.resizeHandlerElement.style.width="".concat(this.margin,"px")}},{key:"getTargetWidthPercentage",value:function(e,t){var r=e.pageX-t.left,n=r/t.width*100;return n}},{key:"setPosition",value:function(e){this.resizeHandlerElement.style.left="calc(".concat(e,"% - ").concat(this.margin/2,"px)")}}]),t}(p["default"])},"./src/gui/themes/AcsTheme.css":function(e,t,r){},"./src/gui/themes/BimTheme.css":function(e,t,r){},"./src/gui/themes/DarkTheme.css":function(e,t,r){},"./src/gui/themes/DarkThemeHyperlink.css":function(e,t,r){},"./src/gui/themes/Fonts.css":function(e,t,r){},"./src/gui/themes/LightTheme.css":function(e,t,r){},"./src/gui/themes/LightThemeHyperlink.css":function(e,t,r){},"./src/gui/toolbar/ToolBar.css":function(e,t,r){},"./src/gui/toolbar/ToolBar.js":function(e,t,r){"use strict";function n(e,t){i.ControlGroup.call(this,e,t),this.removeClass("adsk-control-group"),this.addClass("adsk-toolbar"),t&&t.alignVertically&&this.addClass("adsk-toolbar-vertical")}r.r(t),r.d(t,"ToolBar",function(){return n});var i=r("./src/gui/controls/ControlGroup.js"),o=r("./src/gui/controls/Control.js");n.Event={VISIBILITY_CHANGED:o.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:o.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:i.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:i.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:i.ControlGroup.Event.SIZE_CHANGED},n.prototype=Object.create(i.ControlGroup.prototype),n.prototype.constructor=n},"./src/index-css.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/gui/themes/DarkTheme.css"),i=(r.n(n),r("./src/gui/themes/DarkThemeHyperlink.css")),o=(r.n(i),r("./src/gui/themes/Fonts.css")),s=(r.n(o),r("./src/gui/themes/LightTheme.css")),a=(r.n(s),r("./src/gui/themes/LightThemeHyperlink.css")),l=(r.n(a),r("./src/gui/themes/BimTheme.css")),c=(r.n(l),r("./src/gui/themes/AcsTheme.css")),u=(r.n(c),r("./src/gui/icon-fonts/header.css")),d=(r.n(u),r("./src/gui/icon-fonts/codes.css")),h=(r.n(d),r("./src/gui/LoadingSpinner.css")),f=(r.n(h),r("./src/gui/AlertBox.css")),p=(r.n(f),r("./src/gui/HudMessage.css")),m=(r.n(p),r("./src/gui/ContextMenu.css")),g=(r.n(m),r("./src/gui/Panel.css")),v=(r.n(g),r("./src/gui/ProgressBar.css")),y=(r.n(v),r("./src/gui/Tree.css")),_=(r.n(y),r("./src/gui/TreeOnDemand.css")),b=(r.n(_),r("./src/gui/DockingPanel.css")),x=(r.n(b),r("./src/gui/ModelStructurePanel.css")),w=(r.n(x),r("./src/gui/ModelStructureTreeDelegate.css")),E=(r.n(w),r("./src/gui/PropertyPanel.css")),S=(r.n(E),r("./src/gui/SettingsPanel.css")),A=(r.n(S),r("./src/gui/ViewerModelStructurePanel.css")),M=(r.n(A),r("./src/gui/ViewerSettingsPanel.css")),T=(r.n(M),r("./src/gui/toolbar/ToolBar.css")),C=(r.n(T),r("./src/gui/controls/Control.css")),j=(r.n(C),r("./src/gui/controls/ControlGroup.css")),P=(r.n(j),r("./src/gui/controls/Button.css")),L=(r.n(P),r("./src/gui/controls/ComboButton.css")),D=(r.n(L),r("./src/gui/controls/Searchbox.css")),I=(r.n(D),r("./src/gui/controls/Filterbox.css")),R=(r.n(I),r("./src/gui/controls/SearchResults.css")),O=(r.n(R),r("./src/gui/browser/browser.css")),k=(r.n(O),r("./src/application/Viewer3D.css")),N=(r.n(k),r("./src/gui/GuiViewer3D.css")),F=(r.n(N),r("./src/gui/CommonWidgets.css"));r.n(F)},"./src/index.js":function(e,t,r){function n(t,r){for(var n in t)t.hasOwnProperty(n)&&(e.exports[n]=t[n],r&&(e.exports[r][n]=t[n]))}r("./node_modules/core-js/modules/es.symbol.js"),r("./node_modules/core-js/modules/es.symbol.description.js"),r("./node_modules/core-js/modules/es.symbol.async-iterator.js"),r("./node_modules/core-js/modules/es.symbol.has-instance.js"),r("./node_modules/core-js/modules/es.symbol.is-concat-spreadable.js"),r("./node_modules/core-js/modules/es.symbol.iterator.js"),r("./node_modules/core-js/modules/es.symbol.match.js"),r("./node_modules/core-js/modules/es.symbol.replace.js"),r("./node_modules/core-js/modules/es.symbol.search.js"),r("./node_modules/core-js/modules/es.symbol.species.js"),r("./node_modules/core-js/modules/es.symbol.split.js"),r("./node_modules/core-js/modules/es.symbol.to-primitive.js"),r("./node_modules/core-js/modules/es.symbol.to-string-tag.js"),r("./node_modules/core-js/modules/es.symbol.unscopables.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.array.copy-within.js"),r("./node_modules/core-js/modules/es.array.every.js"),r("./node_modules/core-js/modules/es.array.fill.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.array.find.js"),r("./node_modules/core-js/modules/es.array.find-index.js"),r("./node_modules/core-js/modules/es.array.flat.js"),r("./node_modules/core-js/modules/es.array.flat-map.js"),r("./node_modules/core-js/modules/es.array.for-each.js"),r("./node_modules/core-js/modules/es.array.from.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/es.array.index-of.js"),r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/es.array.join.js"),r("./node_modules/core-js/modules/es.array.last-index-of.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.array.of.js"),r("./node_modules/core-js/modules/es.array.reduce.js"),r("./node_modules/core-js/modules/es.array.reduce-right.js"),r("./node_modules/core-js/modules/es.array.reverse.js"),r("./node_modules/core-js/modules/es.array.slice.js"),r("./node_modules/core-js/modules/es.array.some.js"),r("./node_modules/core-js/modules/es.array.sort.js"),r("./node_modules/core-js/modules/es.array.species.js"),r("./node_modules/core-js/modules/es.array.splice.js"),r("./node_modules/core-js/modules/es.array.unscopables.flat.js"),r("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),r("./node_modules/core-js/modules/es.array-buffer.constructor.js"),r("./node_modules/core-js/modules/es.array-buffer.is-view.js"),r("./node_modules/core-js/modules/es.array-buffer.slice.js"),r("./node_modules/core-js/modules/es.data-view.js"),r("./node_modules/core-js/modules/es.date.to-iso-string.js"),r("./node_modules/core-js/modules/es.date.to-json.js"),r("./node_modules/core-js/modules/es.date.to-primitive.js"),r("./node_modules/core-js/modules/es.function.has-instance.js"),r("./node_modules/core-js/modules/es.function.name.js"),r("./node_modules/core-js/modules/es.json.to-string-tag.js"),r("./node_modules/core-js/modules/es.map.js"),r("./node_modules/core-js/modules/es.math.acosh.js"),r("./node_modules/core-js/modules/es.math.asinh.js"),r("./node_modules/core-js/modules/es.math.atanh.js"),r("./node_modules/core-js/modules/es.math.cbrt.js"),r("./node_modules/core-js/modules/es.math.clz32.js"),r("./node_modules/core-js/modules/es.math.cosh.js"),r("./node_modules/core-js/modules/es.math.expm1.js"),r("./node_modules/core-js/modules/es.math.fround.js"),r("./node_modules/core-js/modules/es.math.hypot.js"),r("./node_modules/core-js/modules/es.math.imul.js"),r("./node_modules/core-js/modules/es.math.log10.js"),r("./node_modules/core-js/modules/es.math.log1p.js"),r("./node_modules/core-js/modules/es.math.log2.js"),r("./node_modules/core-js/modules/es.math.sign.js"),r("./node_modules/core-js/modules/es.math.sinh.js"),r("./node_modules/core-js/modules/es.math.tanh.js"),r("./node_modules/core-js/modules/es.math.to-string-tag.js"),r("./node_modules/core-js/modules/es.math.trunc.js"),r("./node_modules/core-js/modules/es.number.constructor.js"),r("./node_modules/core-js/modules/es.number.epsilon.js"),r("./node_modules/core-js/modules/es.number.is-finite.js"),r("./node_modules/core-js/modules/es.number.is-integer.js"),r("./node_modules/core-js/modules/es.number.is-nan.js"),r("./node_modules/core-js/modules/es.number.is-safe-integer.js"),r("./node_modules/core-js/modules/es.number.max-safe-integer.js"),r("./node_modules/core-js/modules/es.number.min-safe-integer.js"),r("./node_modules/core-js/modules/es.number.parse-float.js"),r("./node_modules/core-js/modules/es.number.parse-int.js"),r("./node_modules/core-js/modules/es.number.to-fixed.js"),r("./node_modules/core-js/modules/es.number.to-precision.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/es.object.define-getter.js"),r("./node_modules/core-js/modules/es.object.define-setter.js"),r("./node_modules/core-js/modules/es.object.entries.js"),r("./node_modules/core-js/modules/es.object.freeze.js"),r("./node_modules/core-js/modules/es.object.from-entries.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),r("./node_modules/core-js/modules/es.object.get-own-property-names.js"),r("./node_modules/core-js/modules/es.object.get-prototype-of.js"),r("./node_modules/core-js/modules/es.object.is.js"),r("./node_modules/core-js/modules/es.object.is-extensible.js"),r("./node_modules/core-js/modules/es.object.is-frozen.js"),r("./node_modules/core-js/modules/es.object.is-sealed.js"),r("./node_modules/core-js/modules/es.object.keys.js"),r("./node_modules/core-js/modules/es.object.lookup-getter.js"),r("./node_modules/core-js/modules/es.object.lookup-setter.js"),r("./node_modules/core-js/modules/es.object.prevent-extensions.js"),r("./node_modules/core-js/modules/es.object.seal.js"),r("./node_modules/core-js/modules/es.object.set-prototype-of.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.object.values.js"),r("./node_modules/core-js/modules/es.parse-float.js"),r("./node_modules/core-js/modules/es.parse-int.js"),r("./node_modules/core-js/modules/es.promise.js"),r("./node_modules/core-js/modules/es.promise.finally.js"),r("./node_modules/core-js/modules/es.reflect.apply.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.reflect.define-property.js"),r("./node_modules/core-js/modules/es.reflect.delete-property.js"),r("./node_modules/core-js/modules/es.reflect.get.js"),r("./node_modules/core-js/modules/es.reflect.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/es.reflect.get-prototype-of.js"),r("./node_modules/core-js/modules/es.reflect.has.js"),r("./node_modules/core-js/modules/es.reflect.is-extensible.js"),r("./node_modules/core-js/modules/es.reflect.own-keys.js"),r("./node_modules/core-js/modules/es.reflect.prevent-extensions.js"),r("./node_modules/core-js/modules/es.reflect.set.js"),r("./node_modules/core-js/modules/es.reflect.set-prototype-of.js"),r("./node_modules/core-js/modules/es.regexp.constructor.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.regexp.flags.js"),r("./node_modules/core-js/modules/es.regexp.to-string.js"),r("./node_modules/core-js/modules/es.set.js"),r("./node_modules/core-js/modules/es.string.code-point-at.js"),r("./node_modules/core-js/modules/es.string.ends-with.js"),r("./node_modules/core-js/modules/es.string.from-code-point.js"),r("./node_modules/core-js/modules/es.string.includes.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/es.string.match.js"),r("./node_modules/core-js/modules/es.string.pad-end.js"),r("./node_modules/core-js/modules/es.string.pad-start.js"),r("./node_modules/core-js/modules/es.string.raw.js"),r("./node_modules/core-js/modules/es.string.repeat.js"),r("./node_modules/core-js/modules/es.string.replace.js"),r("./node_modules/core-js/modules/es.string.search.js"),r("./node_modules/core-js/modules/es.string.split.js"),r("./node_modules/core-js/modules/es.string.starts-with.js"),r("./node_modules/core-js/modules/es.string.trim.js"),r("./node_modules/core-js/modules/es.string.trim-end.js"),r("./node_modules/core-js/modules/es.string.trim-start.js"),r("./node_modules/core-js/modules/es.string.anchor.js"),r("./node_modules/core-js/modules/es.string.big.js"),r("./node_modules/core-js/modules/es.string.blink.js"),r("./node_modules/core-js/modules/es.string.bold.js"),r("./node_modules/core-js/modules/es.string.fixed.js"),r("./node_modules/core-js/modules/es.string.fontcolor.js"),r("./node_modules/core-js/modules/es.string.fontsize.js"),r("./node_modules/core-js/modules/es.string.italics.js"),r("./node_modules/core-js/modules/es.string.link.js"),r("./node_modules/core-js/modules/es.string.small.js"),r("./node_modules/core-js/modules/es.string.strike.js"),r("./node_modules/core-js/modules/es.string.sub.js"),r("./node_modules/core-js/modules/es.string.sup.js"),r("./node_modules/core-js/modules/es.typed-array.float32-array.js"),r("./node_modules/core-js/modules/es.typed-array.float64-array.js"),r("./node_modules/core-js/modules/es.typed-array.int8-array.js"),r("./node_modules/core-js/modules/es.typed-array.int16-array.js"),r("./node_modules/core-js/modules/es.typed-array.int32-array.js"),r("./node_modules/core-js/modules/es.typed-array.uint8-array.js"),r("./node_modules/core-js/modules/es.typed-array.uint8-clamped-array.js"),r("./node_modules/core-js/modules/es.typed-array.uint16-array.js"),r("./node_modules/core-js/modules/es.typed-array.uint32-array.js"),r("./node_modules/core-js/modules/es.typed-array.copy-within.js"),r("./node_modules/core-js/modules/es.typed-array.every.js"),
r("./node_modules/core-js/modules/es.typed-array.fill.js"),r("./node_modules/core-js/modules/es.typed-array.filter.js"),r("./node_modules/core-js/modules/es.typed-array.find.js"),r("./node_modules/core-js/modules/es.typed-array.find-index.js"),r("./node_modules/core-js/modules/es.typed-array.for-each.js"),r("./node_modules/core-js/modules/es.typed-array.from.js"),r("./node_modules/core-js/modules/es.typed-array.includes.js"),r("./node_modules/core-js/modules/es.typed-array.index-of.js"),r("./node_modules/core-js/modules/es.typed-array.iterator.js"),r("./node_modules/core-js/modules/es.typed-array.join.js"),r("./node_modules/core-js/modules/es.typed-array.last-index-of.js"),r("./node_modules/core-js/modules/es.typed-array.map.js"),r("./node_modules/core-js/modules/es.typed-array.of.js"),r("./node_modules/core-js/modules/es.typed-array.reduce.js"),r("./node_modules/core-js/modules/es.typed-array.reduce-right.js"),r("./node_modules/core-js/modules/es.typed-array.reverse.js"),r("./node_modules/core-js/modules/es.typed-array.set.js"),r("./node_modules/core-js/modules/es.typed-array.slice.js"),r("./node_modules/core-js/modules/es.typed-array.some.js"),r("./node_modules/core-js/modules/es.typed-array.sort.js"),r("./node_modules/core-js/modules/es.typed-array.subarray.js"),r("./node_modules/core-js/modules/es.typed-array.to-locale-string.js"),r("./node_modules/core-js/modules/es.typed-array.to-string.js"),r("./node_modules/core-js/modules/es.weak-map.js"),r("./node_modules/core-js/modules/es.weak-set.js"),r("./node_modules/core-js/modules/esnext.aggregate-error.js"),r("./node_modules/core-js/modules/esnext.array.last-index.js"),r("./node_modules/core-js/modules/esnext.array.last-item.js"),r("./node_modules/core-js/modules/esnext.composite-key.js"),r("./node_modules/core-js/modules/esnext.composite-symbol.js"),r("./node_modules/core-js/modules/esnext.global-this.js"),r("./node_modules/core-js/modules/esnext.map.delete-all.js"),r("./node_modules/core-js/modules/esnext.map.every.js"),r("./node_modules/core-js/modules/esnext.map.filter.js"),r("./node_modules/core-js/modules/esnext.map.find.js"),r("./node_modules/core-js/modules/esnext.map.find-key.js"),r("./node_modules/core-js/modules/esnext.map.from.js"),r("./node_modules/core-js/modules/esnext.map.group-by.js"),r("./node_modules/core-js/modules/esnext.map.includes.js"),r("./node_modules/core-js/modules/esnext.map.key-by.js"),r("./node_modules/core-js/modules/esnext.map.key-of.js"),r("./node_modules/core-js/modules/esnext.map.map-keys.js"),r("./node_modules/core-js/modules/esnext.map.map-values.js"),r("./node_modules/core-js/modules/esnext.map.merge.js"),r("./node_modules/core-js/modules/esnext.map.of.js"),r("./node_modules/core-js/modules/esnext.map.reduce.js"),r("./node_modules/core-js/modules/esnext.map.some.js"),r("./node_modules/core-js/modules/esnext.map.update.js"),r("./node_modules/core-js/modules/esnext.math.clamp.js"),r("./node_modules/core-js/modules/esnext.math.deg-per-rad.js"),r("./node_modules/core-js/modules/esnext.math.degrees.js"),r("./node_modules/core-js/modules/esnext.math.fscale.js"),r("./node_modules/core-js/modules/esnext.math.iaddh.js"),r("./node_modules/core-js/modules/esnext.math.imulh.js"),r("./node_modules/core-js/modules/esnext.math.isubh.js"),r("./node_modules/core-js/modules/esnext.math.rad-per-deg.js"),r("./node_modules/core-js/modules/esnext.math.radians.js"),r("./node_modules/core-js/modules/esnext.math.scale.js"),r("./node_modules/core-js/modules/esnext.math.seeded-prng.js"),r("./node_modules/core-js/modules/esnext.math.signbit.js"),r("./node_modules/core-js/modules/esnext.math.umulh.js"),r("./node_modules/core-js/modules/esnext.number.from-string.js"),r("./node_modules/core-js/modules/esnext.observable.js"),r("./node_modules/core-js/modules/esnext.promise.all-settled.js"),r("./node_modules/core-js/modules/esnext.promise.any.js"),r("./node_modules/core-js/modules/esnext.promise.try.js"),r("./node_modules/core-js/modules/esnext.reflect.define-metadata.js"),r("./node_modules/core-js/modules/esnext.reflect.delete-metadata.js"),r("./node_modules/core-js/modules/esnext.reflect.get-metadata.js"),r("./node_modules/core-js/modules/esnext.reflect.get-metadata-keys.js"),r("./node_modules/core-js/modules/esnext.reflect.get-own-metadata.js"),r("./node_modules/core-js/modules/esnext.reflect.get-own-metadata-keys.js"),r("./node_modules/core-js/modules/esnext.reflect.has-metadata.js"),r("./node_modules/core-js/modules/esnext.reflect.has-own-metadata.js"),r("./node_modules/core-js/modules/esnext.reflect.metadata.js"),r("./node_modules/core-js/modules/esnext.set.add-all.js"),r("./node_modules/core-js/modules/esnext.set.delete-all.js"),r("./node_modules/core-js/modules/esnext.set.difference.js"),r("./node_modules/core-js/modules/esnext.set.every.js"),r("./node_modules/core-js/modules/esnext.set.filter.js"),r("./node_modules/core-js/modules/esnext.set.find.js"),r("./node_modules/core-js/modules/esnext.set.from.js"),r("./node_modules/core-js/modules/esnext.set.intersection.js"),r("./node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),r("./node_modules/core-js/modules/esnext.set.is-subset-of.js"),r("./node_modules/core-js/modules/esnext.set.is-superset-of.js"),r("./node_modules/core-js/modules/esnext.set.join.js"),r("./node_modules/core-js/modules/esnext.set.map.js"),r("./node_modules/core-js/modules/esnext.set.of.js"),r("./node_modules/core-js/modules/esnext.set.reduce.js"),r("./node_modules/core-js/modules/esnext.set.some.js"),r("./node_modules/core-js/modules/esnext.set.symmetric-difference.js"),r("./node_modules/core-js/modules/esnext.set.union.js"),r("./node_modules/core-js/modules/esnext.string.at.js"),r("./node_modules/core-js/modules/esnext.string.code-points.js"),r("./node_modules/core-js/modules/esnext.string.match-all.js"),r("./node_modules/core-js/modules/esnext.string.replace-all.js"),r("./node_modules/core-js/modules/esnext.symbol.dispose.js"),r("./node_modules/core-js/modules/esnext.symbol.observable.js"),r("./node_modules/core-js/modules/esnext.symbol.pattern-match.js"),r("./node_modules/core-js/modules/esnext.weak-map.delete-all.js"),r("./node_modules/core-js/modules/esnext.weak-map.from.js"),r("./node_modules/core-js/modules/esnext.weak-map.of.js"),r("./node_modules/core-js/modules/esnext.weak-set.add-all.js"),r("./node_modules/core-js/modules/esnext.weak-set.delete-all.js"),r("./node_modules/core-js/modules/esnext.weak-set.from.js"),r("./node_modules/core-js/modules/esnext.weak-set.of.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/web.immediate.js"),r("./node_modules/core-js/modules/web.queue-microtask.js"),r("./node_modules/core-js/modules/web.url.js"),r("./node_modules/core-js/modules/web.url.to-json.js"),r("./node_modules/core-js/modules/web.url-search-params.js"),r("./node_modules/regenerator-runtime/runtime.js"),e.exports.Autodesk=r("./src/module-prefix.js").Autodesk;var i=Object.assign||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};e.exports.THREE=r("./thirdparty/three.js/three.js"),e.exports.av={},e.exports.avp={},e.exports.avu={},e.exports.ave={};var o=r("./thirdparty/hammer/hammer.js");n({Hammer:o},"av"),n(r("./src/compat.js"),"av"),n(r("./src/compat.js"),"avp"),n(r("./src/globals.js"),"avp"),n(r("./src/globals.js"),"av"),n(r("./src/envinit.js"),"avp"),n(r("./src/envinit.js"),"av"),n(r("./src/resource-loader.js"),"avp"),n(r("./src/globalization/i18init.js"),"avp"),n(r("./src/globalization/i18next.js"),"av"),n(r("./src/globalization/langs.js"),"avp"),n(r("./src/logger/Logger.js"),"avp"),n(r("./src/wgs/globals.js"),"avp"),n(r("./src/wgs/render/GroundReflection.js"),"avp"),n(r("./src/wgs/render/GroundShadow.js"),"avp"),n(r("./src/wgs/render/WebGLShader.js"),"avp"),n(r("./src/wgs/render/PhongShader.js"),"avp"),n(r("./src/wgs/render/BasicShader.js"),"avp"),n(r("./src/wgs/render/DecodeEnvMap.js"),"avp"),n(r("./src/wgs/render/ShaderChunks.js"),"avp"),n(r("./src/wgs/render/SAOShader.js"),"avp"),n(r("./src/wgs/render/ShaderPass.js"),"avp"),n(r("./src/wgs/render/CelShader.js"),"avp"),n(r("./src/wgs/render/RenderContextPostProcess.js"),"avp"),n(r("./src/wgs/render/LineStyleDef.js"),"avp"),n(r("./src/wgs/render/HalfFloat.js"),"avp"),n(r("./src/wgs/render/ShaderUtils.js"),"avp"),n(r("./src/wgs/render/WebGLProgram.js"),"avp"),n(r("./src/wgs/render/PrismUtil.js"),"avp"),n(r("./src/wgs/render/ShadowMap.js"),"avp"),n(r("./src/wgs/render/MaterialConverter.js"),"avp"),n(r("./src/wgs/render/MaterialManager.js"),"avp"),n(r("./src/wgs/render/RenderContext.js"),"avp"),n(r("./src/wgs/render/WebGLRenderer.js"),"avp"),n(r("./src/wgs/render/GroundFlags.js"),"avp"),n(r("./src/wgs/scene/MeshFlags.js"),"avp"),n(r("./src/wgs/scene/RenderFlags.js"),"avp"),n(r("./src/wgs/scene/ResetFlags.js"),"avp"),n(r("./src/wgs/scene/LmvVector3.js"),"avp"),n(r("./src/wgs/scene/LmvMatrix4.js"),"avp"),n(r("./src/wgs/scene/LmvBox3.js"),"avp"),n(r("./src/wgs/scene/VertexEnumerator.js"),"avp"),n(r("./src/wgs/scene/VertexBufferReader.js"),"avp"),n(r("./src/wgs/scene/DeriveTopology.js"),"avp"),n(r("./src/wgs/scene/VBIntersector.js"),"avp"),n(r("./src/wgs/scene/GeometryList.js"),"avp"),n(r("./src/wgs/scene/RenderBatch.js"),"avp"),n(r("./src/wgs/scene/ModelIteratorLinear.js"),"avp"),n(r("./src/wgs/scene/ModelIteratorBVH.js"),"avp"),n(r("./src/wgs/scene/BufferGeometry.js"),"avp"),n(r("./src/wgs/scene/RenderScene.js"),"avp"),n(r("./src/wgs/scene/SortedList.js"),"avp"),n(r("./src/wgs/scene/RenderModel.js"),"avp"),n(r("./src/wgs/scene/FrustumIntersector.js"),"avp"),n(r("./src/wgs/scene/FragmentList.js"),"avp"),n(r("./src/wgs/scene/SelectionMode.js"),"av"),n(r("./src/wgs/scene/InstanceTree.js"),"avp"),n(r("./src/wgs/scene/InstanceTreeStorage.js"),"avp"),n(r("./src/wgs/scene/BVHBuilder.js"),"avp"),n(r("./src/wgs/scene/SceneMath.js"),"avp"),n(r("./src/wgs/scene/leaflet/TileCoords.js"),"avp"),n(r("./src/wgs/scene/leaflet/ModelIteratorTexQuad.js"),"avp"),n(r("./src/wgs/scene/leaflet/LeafletDiffIterator.js"),"avp"),n(r("./src/wgs/scene/consolidation/FragmentListConsolidation.js"),"avp"),n(r("./src/wgs/scene/consolidation/ConsolidationIterator.js"),"avp"),n(r("./src/wgs/scene/consolidation/InstanceBufferBuilder.js"),"avp"),n(r("./src/wgs/scene/consolidation/Consolidation.js"),"avp"),n(r("./src/wgs/scene/consolidation/GeomMergeTask.js"),"avp"),n(r("./src/file-loaders/lmvtk/common/VertexBufferBuilder.js"),"avp"),n(r("./src/file-loaders/lmvtk/otg/OtgGeomCodec.js"),"avp"),n(r("./src/file-loaders/net/ErrorCodes.js"),"av"),n(r("./src/file-loaders/net/endpoints.js"),"av"),n(r("./src/file-loaders/net/Xhr.js"),"avp"),n(r("./src/net/MessageClient.js"),"avp"),n(r("./src/net/LiveReviewClient.js"),"avp"),n(r("./thirdparty/three.js/DDSLoader.js"),"avp"),n(r("./src/application/FileLoaderManager.js"),"av"),n(r("./src/application/bubble.js"),"av"),n(r("./src/application/EventDispatcher.js"),"av"),n(r("./src/application/Extension.js"),"av"),n(r("./src/application/ExtensionManager.js"),"av"),n(r("./src/application/FileLoader.js"),"av"),n(r("./src/application/EventTypes.js"),"av"),n(r("./src/application/EventUtils.js"),"av"),n(r("./src/application/ScreenModeDelegate.js"),"av"),n(r("./src/application/LightPresets.js"),"avp"),n(r("./src/application/ModelLayers.js"),"avp"),n(r("./src/application/LocalStorage.js"),"avp"),n(r("./src/application/Model.js"),"av"),n(r("./src/application/Document.js"),"av"),n(r("./src/application/Preferences.js"),"avp"),n(r("./src/application/PreferenceNames.js"),"avp"),n(r("./src/application/Profile.js"),"av"),n(r("./src/application/ProfileSettings.js"),"av"),n(r("./src/application/Viewer3D.js"),"av"),n(r("./src/application/Viewer3DImpl.js"),"avp"),n(r("./src/application/ViewerState.js"),"avp"),n(r("./src/application/ModelMemoryTracker.js"),"av"),n(r("./src/application/ScreenShot.js"),"av"),n(r("./src/application/Thumbnails.js"),"av"),n(r("./src/application/AggregatedView.js"),"av"),n(r("./src/application/OverlayManager.js"),"av"),n(r("./src/application/CameraLS.js"),"av"),n(r("./src/application/ProfileManager.js"),"av"),n(r("./src/measurement/UnitFormatter.js"),"avp"),n(r("./src/measurement/UnitParser.js"),"avp"),n(r("./src/measurement/PDFUtils.js"),"av"),n(r("./src/measurement/DisplayUnits.js"),"avp");var s=e.exports.av.MeasureCommon={};i(s,r("./src/measurement/MeasureCommon.js")),s.MeasurementTypes=r("./src/measurement/MeasurementTypes.js").MeasurementTypes,s.SnapType=r("./src/measurement/SnapTypes.js").SnapType,s.Events=r("./src/measurement/MeasureEvents.js").MeasureEvents,s.Measurement=r("./src/measurement/Measurement.js").Measurement,s.SnapResult=r("./src/measurement/SnapResult.js").SnapResult,n(r("./src/application/GlobalManager.js"),"av"),n(r("./src/application/GlobalManagerMixin.js"),"av"),n(r("./src/animation/Animation.js"),"avp"),n(r("./src/animation/KeyFrameAnimator.js"),"avp"),n(r("./src/animation/type/MeshAnimation.js"),"avp"),n(r("./src/tools/Navigation.js"),"av"),n(r("./src/tools/UnifiedCamera.js"),"av"),n(r("./src/tools/Selector.js"),"avp"),n(r("./src/tools/SelectionType.js"),"av"),n(r("./src/tools/VisibilityManager.js"),"avp"),n(r("./src/tools/KeyCode.js"),"av"),n(r("./src/tools/ToolController.js"),"av"),n(r("./src/tools/HotkeyManager.js"),"av"),n(r("./src/tools/DefaultHandler.js"),"av"),n(r("./src/tools/ViewingUtilities.js"),"av"),n(r("./src/tools/GestureHandler.js"),"av"),n(r("./src/tools/ToolInterface.js"),"av"),n(r("./src/tools/OrbitDollyPanTool.js"),"av"),n(r("./src/tools/HotGestureTool.js"),"av"),n(r("./src/tools/FovTool.js"),"av"),n(r("./src/tools/WorldUpTool.js"),"av"),n(r("./src/tools/autocam/Autocam.js"),"av"),n(r("./src/tools/autocam/ViewCube.js"),"avp"),n(r("./src/tools/viewtransitions/ViewTransition.js"),"avp"),n(r("./src/file-loaders/main/SvfLoader.js"),"avp"),n(r("./src/file-loaders/main/F2DLoader.js"),"avp"),n(r("./src/file-loaders/main/LeafletLoader.js"),"avp"),n(r("./src/file-loaders/main/PropDbLoader.js"),"avp"),n(r("./src/file-loaders/main/TextureLoader.js"),"avp"),n(r("./src/file-loaders/main/OtgLoader.js"),"avp"),n(r("./src/file-loaders/main/OtgResourceCache.js"),"avp"),n(r("./src/file-loaders/main/WorkerCreator.js"),"avp"),n(r("./src/application/ProgressState.js"),"av"),n(r("./src/mobile/MobileCallbacks.js"),"av"),n(r("./src/file-loaders/main/WorkerCreatorWasm.js"),"avp"),n(r("./src/wasm/Wasm.js"),"avp"),r("./src/index-css.js"),n(r("./src/gui/LoadingSpinner.js"),"avu"),n(r("./src/gui/Tree.js"),"avu"),n(r("./src/gui/TreeDelegate.js"),"avu"),n(r("./src/gui/TreeOnDemand.js"),"avu"),n(r("./src/gui/CommonWidgets.js"),"avp"),n(r("./src/gui/DataTable.js"),"avu"),n(r("./src/gui/DockingPanel.js"),"avu"),n(r("./src/gui/ContextMenu.js"),"avp"),n(r("./src/gui/browser/browser.js"),"avp"),n(r("./src/gui/AlertBox.js"),"avp"),n(r("./src/gui/ErrorHandler.js"),"avp"),n(r("./src/gui/ModelStructurePanel.js"),"avu"),n(r("./src/gui/PropertyPanel.js"),"avu"),n(r("./src/gui/ObjectContextMenu.js"),"avu"),n(r("./src/gui/ProgressBar.js"),"avp"),n(r("./src/gui/ViewerPanelMixin.js"),"ave"),n(r("./src/gui/controls/Control.js"),"avu"),n(r("./src/gui/controls/ControlGroup.js"),"avu"),n(r("./src/gui/controls/Button.js"),"avu"),n(r("./src/gui/controls/RadioButtonGroup.js"),"avu"),n(r("./src/gui/controls/ComboButton.js"),"avu"),n(r("./src/gui/toolbar/ToolBar.js"),"avu"),n(r("./src/gui/HudMessage.js"),"avp"),n(r("./src/gui/SettingsPanel.js"),"avu"),n(r("./src/gui/controls/Filterbox.js"),"avu"),n(r("./src/gui/controls/Searchbox.js"),"avu"),n(r("./src/gui/RenderOptionsPanel.js"),"avp"),n(r("./src/gui/ViewerModelStructurePanel.js"),"ave"),n(r("./src/gui/ViewerPropertyPanel.js"),"ave"),n(r("./src/gui/ViewerSettingsPanel.js"),"ave"),n(r("./src/gui/ViewerObjectContextMenu.js"),"ave"),n(r("./src/gui/GuiViewerToolbarConst.js"),"av"),n(r("./src/gui/GuiViewer3D.js"),"av"),n(r("./src/gui/splitview-layout/SplitViewLayout.js"),"avu"),n(r("./extensions/builtinExtensions.js"),"av"),n(r("./src/leech-viewer/MultiViewerFactory.js"),"av"),n(r("./src/leech-viewer/LeechViewer.js"),"av"),n(r("./src/leech-viewer/CrossViewerInteractionCommon.js"),"av"),n(r("./extensions/registerExternalExtensions.js"),"avp"),n(r("./src/analytics/index.js"),"avp"),r("./src/module-suffix.js").initializeLegacyNamespaces(e.exports)},"./src/leech-viewer/CrossViewerInteractionCommon.js":function(e,t,r){"use strict";r.r(t),r.d(t,"CrossViewerInteractionCommon",function(){return o});var n=r("./src/application/EventTypes.js"),i=(r.n(n),{eventName:n.AGGREGATE_SELECTION_CHANGED_EVENT,cb:function(e,t,r){var n=e.getAggregateSelection();if(t.impl.model)if(n.length>0)for(var i=0;i<n.length;i++)for(var o=n[i],s=o.model,a=o.selection,l=0;l<t.impl.modelQueue().getModels().length;l++){var c=t.impl.modelQueue().getModels()[l];c&&c.getDocumentNode()&&s.getDocumentNode()&&c.getDocumentNode().originModel===s.getDocumentNode().originModel?(t.impl.is2d?t.select(a,c):(t.showAll(),t.select(a,c),t.isolate(a,c)),t.fitToView(a)):!t.impl.is2d&&c.visibilityManager&&c.visibilityManager.setAllVisibility(!1)}else t.clearSelection(),t.impl.is2d||t.showAll()}}),o={onSelectionChanged:i}},"./src/leech-viewer/LeechViewer.js":function(e,t,r){"use strict";function n(e){return s(e)||o(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(e){return Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)?Array.from(e):void 0}function s(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function a(e,t,r,i){function o(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.sharedResources=n,this.loadingIntervals={},i.call(this,e,r),this.renderContext=new l["default"](this.canvas),this.originalLoadDocumentNode=this.loadDocumentNode.bind(this),this.sharedResources.mrtFlags?this.renderContext.mrtFlags=this.sharedResources.mrtFlags:this.sharedResources.mrtFlags=this.renderContext.mrtFlags,this.resizeObserver=new d.a(function(e){var r=e[0].contentRect,n=Math.floor(r.width),i=Math.floor(r.height);n&&i&&(t.impl.resize(n,i,!0),t.dispatchEvent({type:Autodesk.Viewing.VIEWER_RESIZE_EVENT,width:n,height:i}),t.impl.tick(performance.now()))}),this.resizeObserver.observe(this.container)}function s(e){var t=e.getDocumentNode();return t?t.getModelKey():e.getData().urn}function a(e){var t=!e,r=e&&!e.isLoadDone(),n=e&&e.getPropertyDb()&&!e.getPropertyDb().isLoadDone(),i=Autodesk.Viewing.Private.TextureLoader.requestsInProgress()>0;return t||r||n||i?!1:!0}function u(e,t){return new Promise(function(r){a(t)&&r();var n=function i(){a(t)&&(e.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,i),e.removeEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,i),e.removeEventListener(Autodesk.Viewing.TEXTURES_LOADED_EVENT,i),r())};e.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,n),e.addEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,n),e.addEventListener(Autodesk.Viewing.TEXTURES_LOADED_EVENT,n)})}if(h.has(i)){var f=h.get(i);return new f(e,t,r)}o.prototype=Object.create(i.prototype),o.prototype.constructor=o,o.prototype.initialize=function(){var e={glrenderer:this.sharedResources.glrenderer,materialManager:this.sharedResources.materialManager,renderer:this.renderContext},t=this.getWindow().NOP_VIEWER,r=i.prototype.initialize.call(this,e);return t&&(this.getWindow().NOP_VIEWER=t),this.overrideAPIs(),this.sharedResources.geomCache&&this.sharedResources.geomCache.initialized&&this.impl.setGeomCache(this.sharedResources.geomCache),r},o.prototype.uninitialize=function(){var e=this;this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),Object.keys(this.loadingIntervals).forEach(function(t){e.clearLoadingInterval(t)}),i.prototype.uninitialize.call(this)},o.prototype.overrideAPIs=function(){var e=this,t=this.impl.tick.bind(this.impl);this.impl.tick=function(){e.impl.renderer().prepareViewport();var r=performance.now();t(r),e.impl.renderer().restoreViewport()},this.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,function(){e.renderContext.renderToCanvas()},{priority:-1e3});var r=this.impl.setLightPreset.bind(this.impl);this.impl.setLightPreset=function(t,i,o){if(e.impl.is2d){var s=Autodesk.Viewing.Private.LightPresets[t].bgColorGradient;e.setBackgroundColor.apply(e,n(s)),e.impl.setCurrentLightPreset(t)}else r(t,i,o)},this.impl.onBeforeRender=function(t){t&&e.restoreViewerState()};var i=this.toolController.__invokeStack.bind(this.toolController);this.toolController.__invokeStack=function(){return e.restoreViewerState(),i.apply(void 0,arguments)};var o=this.impl.unloadModel.bind(this.impl);this.impl.unloadModel=function(t){var r=s(t),n=!1;return e.sharedResources.loadedModels[r]&&(e.sharedResources.loadedModels[r].usedByViewersCounter--,n=e.sharedResources.loadedModels[r].usedByViewersCounter>0,n||delete e.sharedResources.loadedModels[r]),e.clearLoadingInterval(r),o(t,n)},this.loadDocumentNode=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(i,o){var s=r.getModelKey();if(e.sharedResources.loadedModels[s]){var a=e.onModelLoaded(e.sharedResources.loadedModels[s].model,n);i(a)}else e.originalLoadDocumentNode(t,r,n).then(function(t){e.sharedResources.loadedModels[s]={model:t,usedByViewersCounter:1,loadingViewer:e},i(t)})["catch"](o)})};var a=this.impl.geomCache.bind(this.impl);this.impl.geomCache=function(){return e.sharedResources.geomCache&&e.sharedResources.geomCache.initialized||(e.sharedResources.geomCache=a()),e.sharedResources.geomCache}},o.prototype.setViewerProfile=function(e,t){if(!t.loadAsHidden){t.isAEC=e.isAEC();var r=this.chooseProfile(t);delete r.settings.lineRendering,delete r.settings.pointRendering,this.setProfile(r)}},o.prototype.setViewerLight=function(e,t){if(!t.loadAsHidden)if(this.impl.is2d){this.impl.setLightPreset(c.DefaultLightPreset2d);var r=this.impl.clearColorTop.clone().multiplyScalar(255),n=this.impl.clearColorBottom.clone().multiplyScalar(255);t.isAEC?this.impl.setLightPresetForAec():this.impl.setLightPreset(c.DefaultLightPreset),this.impl.toggleEnvMapBackground(!1),this.setBackgroundColor(r.x,r.y,r.z,n.x,n.y,n.z)}else this.impl.toggleEnvMapBackground(this.profile.settings.envMapBackground)},o.prototype.cleanViewerBeforeLoadModel=function(e){if(!e.keepCurrentModels&&this.impl.hasModels()){var t=this.config;this.tearDown(),this.setUp(t)}!this.impl.hasModels()&&this._loadingSpinner&&this._loadingSpinner.show()};var p=new THREE.Vector4(0,0,-1,-1e20);return o.prototype.updateCutPlanes=function(){var e=this.impl.getAllCutPlanes()||[p],t=this.impl.matman(),r=Math.max(e.length,t._cutplanes.length);t._cutplanes.length=0;for(var n=0;n<e.length;n++)t._cutplanes.push(e[n].clone());for(;r>n;n++)t._cutplanes.push(p);t.forEach(function(e){e.cutplanes=t._cutplanes},!1,!0)},o.prototype.restoreViewerState=function(){this.sharedResources.lastRenderedViewer!==this&&(this.updateCutPlanes(),this.impl.is2d&&this.impl.updateCameraMatrices(),this.sharedResources.lastRenderedViewer=this)},o.prototype.onModelLoaded=function(e,t){this.cleanViewerBeforeLoadModel(t);var r=this.cloneModelToViewer(e);return this.addModelToViewer(r,t),r},o.prototype.addModelToViewer=function(e,t){this.impl.modelQueue().addHiddenModel(e),t.loadAsHidden||(this.setViewerProfile(e,t),this.showModel(e),this.setViewerLight(e,t),!t.headlessViewer&&this.createUI&&this.createUI(e)),this._loadingSpinner&&this._loadingSpinner.hide()},o.prototype.clearLoadingInterval=function(e){this.loadingIntervals[e]&&(clearInterval(this.loadingIntervals[e]),delete this.loadingIntervals[e])},o.prototype.cloneModelToViewer=function(e){var t=this,r=e.clone(),n=s(e);this.sharedResources.loadedModels[n].usedByViewersCounter++;var i=this.sharedResources.loadedModels[n].loadingViewer;return this.clearLoadingInterval(n),this.loadingIntervals[n]=setInterval(function(){t.impl.invalidate(!1,!0,!1)},1e3),u(i,r).then(function(){t.clearLoadingInterval(n),setTimeout(function(){r.setInnerAttributes(e.getInnerAttributes()),t.impl.onLoadComplete(r)},1)}),r},h.set(i,o),new o(e,t,r,i)}r.r(t),r.d(t,"createLeechViewer",function(){return a});var l=r("./src/leech-viewer/LeechViewerRenderContext.js"),c=r("./src/application/LightPresets.js"),u=r("./thirdparty/resize-observer-polyfill/ResizeObserver.min.js"),d=r.n(u),h=new Map},"./src/leech-viewer/LeechViewerRenderContext.js":function(e,t,r){"use strict";function n(e){Autodesk.Viewing.Private.RenderContext.call(this),this.originalInit=this.init.bind(this),this.init=function(t,r,n){this.canvas=e,this.ctx2D=this.canvas.getContext("2d"),this.originalInit(t,r,n,{offscreen:!0}),this.glrenderer=t;var i=this.glrenderer.getPixelRatio();this.setSize(r/i,n/i)},this.renderToCanvas=function(){this.getOffscreenTarget()||(this.ctx2D.clearRect(0,0,this.widthWithPixelRatio,this.heightWithPixelRatio),this.ctx2D.drawImage(this.glrenderer.domElement,0,this.glrenderer.domElement.height-this.heightWithPixelRatio,this.widthWithPixelRatio,this.heightWithPixelRatio,0,0,this.widthWithPixelRatio,this.heightWithPixelRatio))},this.originalSetSize=this.setSize.bind(this),this.setSize=function(e,t,r,n){if(!n){var i=this.glrenderer.getPixelRatio();this.width=e,this.height=t,this.widthWithPixelRatio=e*i,this.heightWithPixelRatio=t*i,this.canvas.width=this.widthWithPixelRatio,this.canvas.height=this.heightWithPixelRatio,this.canvas.style.width="".concat(this.width,"px"),this.canvas.style.height="".concat(this.height,"px")}this.prepareViewport(r,n),this.restoreViewport()},this.prepareViewport=function(e,t){this.glrenderer.pushViewport();var r=this.glrenderer.getPixelRatio(),n=this.glrenderer.domElement.width/r,i=this.glrenderer.domElement.height/r;(n<this.width||i<this.height)&&this.glrenderer.setSize(Math.max(this.width,n),Math.max(this.height,i)),this.originalSetSize(this.width,this.height,e,t)},this.restoreViewport=function(){this.glrenderer.popViewport()}}r.r(t),r.d(t,"default",function(){return n});var i=r("./src/wgs/render/RenderContext.js");n.prototype=Object.create(i.RenderContext.prototype),n.prototype.constructor=n},"./src/leech-viewer/MultiViewerFactory.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}r.r(t),r.d(t,"MultiViewerFactory",function(){return l});var s=r("./src/leech-viewer/LeechViewer.js"),a=r("./src/wgs/render/MaterialManager.js"),l=function(){function e(){n(this,e);var t=Autodesk.Viewing.Private.createRenderer(void 0,{alpha:!0}),r=new a.MaterialManager(t),i={};this.sharedResources={glrenderer:t,materialManager:r,loadedModels:i}}return o(e,[{key:"createViewer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Autodesk.Viewing.Viewer3D;return Object(s.createLeechViewer)(e,t,this.sharedResources,r)}}]),e}()},"./src/logger/Logger.js":function(e,t,r){"use strict";function n(){this.runtimeStats={},this.level=-1,this.setLevel(d.ERROR),this._reportError=this._reportError.bind(this)}function i(){return"undefined"!=typeof window?encodeURI(u.location.href):""}function o(){}function s(e){h=e}r.r(t),r.d(t,"LogLevels",function(){return d}),r.d(t,"Logger",function(){return n}),r.d(t,"logger",function(){return h}),r.d(t,"setLogger",function(){return s});var a=r("./src/compat.js"),l=r("./src/file-loaders/net/endpoints.js"),c=Object(a.getGlobal)(),u=c,d={DEBUG:5,LOG:4,INFO:3,WARNING:2,ERROR:1,NONE:0};n.prototype.initialize=function(e){if(e.eventCallback&&(this.callback=e.eventCallback),this.sessionId=e.sessionId,!this.sessionId){var t=Date.now()+"";this.sessionId=parseFloat((1e4*Math.random()|0)+""+t.substring(4))}"number"==typeof e.logLevel&&this.setLevel(e.logLevel),this.environmentInfo={touch:Object(a.isTouchDevice)(),env:Object(l.getEnv)(),referer:i(),version:c.LMV_VIEWER_VERSION,build_type:c.LMV_BUILD_TYPE};var r={category:"viewer_start",touch:this.environmentInfo.touch,env:this.environmentInfo.env,referer:this.environmentInfo.referer,version:this.environmentInfo.version,build_type:this.environmentInfo.build_type};this.track(r);var n=this;this.interval=setInterval(function(){n.reportRuntimeStats()},6e4)},n.prototype.shutdown=function(){clearInterval(this.interval),this.interval=void 0},n.prototype.track=function(e){this.updateRuntimeStats(e),!Object(l.isOffline)()&&this.sessionId&&this.callback&&(e.timestamp=Date.now(),e.sessionId=this.sessionId,this.callback(e))},n.prototype.updateRuntimeStats=function(e){if(e.hasOwnProperty("aggregate"))switch(e.aggregate){case"count":this.runtimeStats[e.name]>0?this.runtimeStats[e.name]++:this.runtimeStats[e.name]=1,this.runtimeStats._nonempty=!0;break;case"last":this.runtimeStats[e.name]=e.value,this.runtimeStats._nonempty=!0;break;default:this.warn("unknown log aggregate type")}},n.prototype.reportRuntimeStats=function(){this.runtimeStats._nonempty&&(delete this.runtimeStats._nonempty,this.runtimeStats.category="misc_stats",this.track(this.runtimeStats),this.runtimeStats={})},n.prototype.setLevel=function(e){this.level!==e&&(this.level=e,this.debug=e>=d.DEBUG?console.log:o,this.log=e>=d.LOG?console.log:o,this.info=e>=d.INFO?console.info:o,this.warn=e>=d.WARNING?console.warn:o,this.error=e>=d.ERROR?this._reportError:o)},n.prototype._reportError=function(){if(this.callback){var e=Array.prototype.slice.call(arguments).join(" ");this.callback({category:"error",message:e})}};var h=new n},"./src/measurement/DisplayUnits.js":function(e,t,r){"use strict";r.r(t),r.d(t,"displayUnits",function(){return o}),r.d(t,"displayUnitsEnum",function(){return s}),r.d(t,"displayUnitsPrecision",function(){return a}),r.d(t,"displayUnitsPrecisionEnum",function(){return l});var n=[{name:"File units",type:""},{name:"Millimeters",type:"mm"},{name:"Centimeters",type:"cm"},{name:"Meters",type:"m"},{name:"Inches",type:"in"},{name:"Feet",type:"ft"},{name:"Feet and fractional inches",type:"ft-and-fractional-in"},{name:"Feet and decimal inches",type:"ft-and-decimal-in"},{name:"Decimal inches",type:"decimal-in"},{name:"Decimal feet",type:"decimal-ft"},{name:"Fractional inches",type:"fractional-in"},{name:"Meters and centimeters",type:"m-and-cm"},{name:"Points",type:"pt"}],i=[{name:"File precision",value:""},{name:"0 (1)",value:0},{name:"0.1 (1/2)",value:1},{name:"0.01 (1/4)",value:2},{name:"0.001 (1/8)",value:3},{name:"0.0001 (1/16)",value:4},{name:"0.00001 (1/32)",value:5},{name:"0.000001 (1/64)",value:6}],o=n.map(function(e){return e.name}),s=n.map(function(e){return e.type}),a=i.map(function(e){return e.name}),l=i.map(function(e){return e.value})},"./src/measurement/MeasureCommon.js":function(e,t,r){"use strict";function n(e,t){if(!e)return null;if(e.isPerpendicular)return e.intersectPoint;switch(e.geomType){case T.SnapType.SNAP_VERTEX:case T.SnapType.RASTER_PIXEL:case T.SnapType.SNAP_MIDPOINT:case T.SnapType.SNAP_CIRCLE_CENTER:return e.getGeometry();case T.SnapType.SNAP_EDGE:var r=y(e.getGeometry()),n=r[0].clone(),i=r[1].clone();return m(e.intersectPoint,n,i);case T.SnapType.SNAP_FACE:return b(e.intersectPoint,e.getGeometry().vertices[0],e.faceNormal);case T.SnapType.SNAP_CIRCULARARC:if(t&&t.model&&t.model.is2d()){var o=e.snapPoint;return e.geomType=T.SnapType.SNAP_VERTEX,e.geomVertex=o,o}return e.circularArcCenter;case T.SnapType.SNAP_CURVEDEDGE:return E(e.intersectPoint,e.getGeometry());case T.SnapType.SNAP_CURVEDFACE:return e.intersectPoint;case T.SnapType.SNAP_INTERSECTION:return e.snapPoint;default:return null}}function i(e,t,r,i){if(!(e&&t&&e.getGeometry()&&t.getGeometry()))return!1;var o=n(e,r);if(i&&r)if(t.geomType===T.SnapType.SNAP_EDGE){var s=new M.Vector3,a=new M.Vector3,l=t.getGeometry();if(s.subVectors(t.intersectPoint,o).normalize(),a.subVectors(l.vertices[0],l.vertices[1]).normalize(),w(s,a,.05)){var c=g(o,l.vertices[0],l.vertices[1],!0);
if(c)return i.onMouseMove(f(c,r))&&i.setPerpendicular(!0),t.geomVertex=c,t.intersectPoint=c,!0}}else if(t.geomType===T.SnapType.SNAP_FACE){var u=new M.Vector3,d=t.getGeometry();if(u.subVectors(t.intersectPoint,o).normalize(),x(t.faceNormal,u,.05)){var c=b(o,d.vertices[0],t.faceNormal);return i.onMouseMove(f(c,r))&&i.setPerpendicular(!0),t.geomVertex=c,t.intersectPoint=c,!0}}}function o(e,t,r,i){if(!(e&&t&&e.getGeometry()&&t.getGeometry()))return null;var o=n(e,i),s=n(t,i);if(!o||!s)return null;if(v(o,s,P))return null;var a,l,c,u;if(i.model.is2d()&&(o=o.clone(),s=s.clone(),i.model.pageToModel(o,s,e.viewportIndex2d)),r){var d=Math.log(2*r)/Math.log(10),h=Math.floor(d);1<2*r/Math.pow(10,h)&&h++,r=Math.pow(10,h);var f=o.distanceTo(s),p=f/r;return a=Math.floor(p+.5)*r,f=Math.abs(o.x-s.x),p=f/r,l=Math.floor(p+.5)*r,f=Math.abs(o.y-s.y),p=f/r,c=Math.floor(p+.5)*r,{distanceXYZ:a,distanceX:l,distanceY:c,distanceZ:0,type:C.MeasurementTypes.MEASUREMENT_DISTANCE}}return a=o.distanceTo(s),l=Math.abs(o.x-s.x),c=Math.abs(o.y-s.y),u=Math.abs(o.z-s.z),{distanceXYZ:a,distanceX:l,distanceY:c,distanceZ:u,type:C.MeasurementTypes.MEASUREMENT_DISTANCE}}function s(e,t){if(e.is3d())return 0;if(e.getData().isPdf)return 0;var r=e.getMetadata("page_dimensions","page_width",null),n=e.getMetadata("page_dimensions","logical_width",null),i=e.getMetadata("page_dimensions","page_height",null),o=e.getMetadata("page_dimensions","logical_height",null);if(!(r&&n&&i&&o))return 0;var s=r/n,a=i/o,l=new M.Vector3(0,0,0),c=new M.Vector3(s,a,0);e.pageToModel(l,c,t);var u=l.distanceTo(c);return u}function a(e){for(var t=0;t<e.length;t++)for(var r=0;r<e.length;r++)if(t!==r&&v(e[t],e[r],P))return!0;return!1}function l(e,t){var r=[];for(var i in e)if(e.hasOwnProperty(i)){var o=n(e[i],t);o&&r.push(o)}if(3!==r.length||a(r))return null;var s=new M.Vector3,l=new M.Vector3;return s.subVectors(r[0],r[1]),l.subVectors(r[2],r[1]),_(s,l)}function c(e,t){var r=[];for(var i in e)if(e.hasOwnProperty(i)){var o=n(e[i],t);o&&r.push(o.clone())}var s=n(e[1],t);s&&r.push(s.clone());for(var a=0;a<r.length;a+=2)t.model.pageToModel(r[a],r[a+1],e[1].viewportIndex2d);for(var l=0,c=0,a=0;a<r.length-1;a++)l+=r[a].x*r[a+1].y,c+=r[a].y*r[a+1].x;var u=Math.abs((l-c)/2);return u}function u(e,t,r,i){switch(t){case C.MeasurementTypes.MEASUREMENT_DISTANCE:var a=e[1],u=e[2],d=s(r.model,a.viewportIndex2d);return o(a,u,d,r);case C.MeasurementTypes.MEASUREMENT_ANGLE:var h=l(e,r);return h?{angle:i&&i.angleOuter?360-h:h,type:t}:null;case C.MeasurementTypes.MEASUREMENT_AREA:return{area:c(e,r),type:t};case C.MeasurementTypes.MEASUREMENT_LOCATION:return{location:n(e[1],r),type:t};default:return null}}function d(e,t,r,n,i,o){for(var s=0,a=r.vertices,l=new M.Vector3,c=new M.Vector3,u=0;u<a.length;u+=3)l.subVectors(a[u+1],a[u]),c.subVectors(a[u+2],a[u]),s+=l.length()*c.length()*Math.sin(l.angleTo(c))/2;return s=Object(j.convertUnits)(e.model.getUnitString(),n,o,s,"square"),n?Object(j.formatValueWithUnits)(s,n+"^2",3,i):Object(j.formatValueWithUnits)(s,null,3,i)}function h(e,t,r,n,i,o){var s=r.radius;if(s){if(e.model.is2d()){var a=r.center.clone(),l=r.vertices[0].clone();e.model.pageToModel(a,l,t.getPick(1).viewportIndex2d),s=a.distanceTo(l)}return s=Object(j.convertUnits)(e.model.getUnitString(),n,o,s),Object(j.formatValueWithUnits)(s,n,3,i)}}function f(e,t,r){var n=t.navigation.getCamera(),i=t.navigation.getScreenViewport(),o=new M.Vector3(e.x,e.y,e.z);return o=o.project(n),r=r||0,new M.Vector2(Math.round((o.x+1)/2*i.width)+r,Math.round((-o.y+1)/2*i.height)+r)}function p(e,t){var r=t.navigation.getCamera(),n=t.navigation.getScreenViewport(),i=new M.Vector3;return i.x=e.x/n.width*2-1,i.y=-(e.y/n.height*2-1),i.z=0,i=i.unproject(r)}function m(e,t,r){var n,i,o=new M.Vector3,s=new M.Vector3;return o.subVectors(t,e),s.subVectors(r,t),i=o.dot(s),o.subVectors(r,t),i=-i/o.dot(o),o.subVectors(r,t),o.multiplyScalar(i),n=o.add(t)}function g(e,t,r,n){var i,o,s=new M.Vector3,a=new M.Vector3;return s.subVectors(t,e),a.subVectors(r,t),o=s.dot(a),s.subVectors(r,t),o=-o/s.dot(s),0>o?i=n?null:t:o>1?i=n?null:r:(s.subVectors(r,t),s.multiplyScalar(o),i=s.add(t)),i}function v(e,t,r){return e&&t&&Math.abs(e.x-t.x)<=r&&Math.abs(e.y-t.y)<=r&&Math.abs(e.z-t.z)<=r?!0:!1}function y(e){for(var t=e.vertices,r=[],n=0;n<t.length;++n){for(var i=!1,o=0;o<t.length;++o)if(o!==n&&t[o].equals(t[n])){i=!0;break}i||r.push(t[n])}return r}function _(e,t){return 180*e.angleTo(t)/Math.PI}function b(e,t,r){var n=new M.Vector3,i=r.clone(),o=new M.Vector3;o.subVectors(e,t);var s=-i.dot(o),a=i.dot(i),l=s/a;return n.addVectors(e,i.multiplyScalar(l)),n}function x(e,t,r){return r=r?r:P,1-Math.abs(e.dot(t))<r}function w(e,t,r){return r=r?r:P,Math.abs(e.dot(t))<r}function E(e,t){for(var r,n=Number.MAX_VALUE,i=0;i<t.vertices.length;i++){var o=e.distanceTo(t.vertices[i]);n>o&&(r=t.vertices[i],n=o)}return r}function S(e,t){e.impl.overlayScenes[t]||e.impl.createOverlayScene(t)}function A(e,t,r){(e.classList.contains(t)&&!r||!e.classList.contains(t)&&r)&&e.classList.toggle(t,r)}r.r(t),r.d(t,"EPSILON",function(){return P}),r.d(t,"getSnapResultPosition",function(){return n}),r.d(t,"correctPerpendicularPicks",function(){return i}),r.d(t,"calculateDistance",function(){return o}),r.d(t,"computeResult",function(){return u}),r.d(t,"getFaceArea",function(){return d}),r.d(t,"getCircularArcRadius",function(){return h}),r.d(t,"project",function(){return f}),r.d(t,"inverseProject",function(){return p}),r.d(t,"nearestPointInPointToLine",function(){return m}),r.d(t,"nearestPointInPointToSegment",function(){return g}),r.d(t,"isEqualVectors",function(){return v}),r.d(t,"getEndPointsInEdge",function(){return y}),r.d(t,"angleVectorToVector",function(){return _}),r.d(t,"isParallel",function(){return x}),r.d(t,"isPerpendicular",function(){return w}),r.d(t,"nearestVertexInVertexToEdge",function(){return E}),r.d(t,"createCommonOverlay",function(){return S}),r.d(t,"safeToggle",function(){return A});var M=r("./thirdparty/three.js/three.js"),T=(r.n(M),r("./src/measurement/SnapTypes.js")),C=r("./src/measurement/MeasurementTypes.js"),j=r("./src/measurement/UnitFormatter.js"),P=1e-4},"./src/measurement/MeasureEvents.js":function(e,t,r){"use strict";r.r(t),r.d(t,"MeasureEvents",function(){return n});var n={MEASUREMENT_CHANGED_EVENT:"measurement-changed",UNITS_CALIBRATION_STARTS_EVENT:"units_calibration_starts_event",FINISHED_CALIBRATION_FOR_DIMENSION_EVENT:"finished_calibration_for_dimension_event",CALIBRATION_REQUIRED_EVENT:"calibration-required",OPEN_CALIBRATION_PANEL_EVENT:"open-calibration-panel",CLOSE_CALIBRATION_PANEL_EVENT:"close-calibration-panel",CLEAR_CALIBRATION_SIZE_EVENT:"clear-calibration-size",FINISHED_CALIBRATION:"finished-calibration",DISPLAY_UNITS_CHANGED:"display-units-changed",MEASUREMENT_MODE_ENTER:"measure-mode-enter",MEASUREMENT_MODE_LEAVE:"measure-mode-leave"}},"./src/measurement/Measurement.js":function(e,t,r){"use strict";function n(e,t,r){this.measurementType=e,this.id=t,this.picks=[],this.closedArea=!1,this.isRestored=!1,this.options=r,this.resetMeasureValues()}r.r(t),r.d(t,"Measurement",function(){return n});var i=r("./src/measurement/SnapResult.js"),o=r("./src/measurement/MeasurementTypes.js"),s=r("./src/measurement/MeasureCommon.js");n.prototype.resetMeasureValues=function(){this.angle=0,this.distanceX=0,this.distanceY=0,this.distanceZ=0,this.distanceXYZ=0,this.location=null,this.result=null},n.prototype.setPick=function(e,t){var r=this.picks[e]=t;return r.id=parseInt(e),r},n.prototype.getPick=function(e){var t=this.picks[e];return t||(t=this.setPick(e,new i.SnapResult)),t},n.prototype.clonePicks=function(e){var t=[];for(var r in this.picks)if(this.picks.hasOwnProperty(r)){var n=this.picks[r];t.push(n.clone())}return t},n.prototype.countPicks=function(){return Object.keys(this.picks).length},n.prototype.getMaxNumberOfPicks=function(){switch(this.measurementType){case o.MeasurementTypes.MEASUREMENT_DISTANCE:case o.MeasurementTypes.MEASUREMENT_LOCATION:case o.MeasurementTypes.MEASUREMENT_CALLOUT:return 2;case o.MeasurementTypes.MEASUREMENT_ANGLE:return 3;case o.MeasurementTypes.MEASUREMENT_AREA:return this.closedArea?this.countPicks():Number.MAX_VALUE-1}},n.prototype.hasPick=function(e){return this.picks[e]&&!this.picks[e].isEmpty()||this.isRestored},n.prototype.isComplete=function(){var e=this.countPicks()===this.getMaxNumberOfPicks();for(var t in this.picks)if(this.picks.hasOwnProperty(t)&&(e=e&&this.hasPick(t),!e))break;return e},n.prototype.isEmpty=function(){var e=!0;for(var t in this.picks)if(this.picks.hasOwnProperty(t)&&(e=e&&!this.hasPick(t),!e))break;return e},n.prototype.clearPick=function(e){this.picks[e]&&this.picks[e].clear(),this.resetMeasureValues()},n.prototype.clearAllPicks=function(){for(var e in this.picks)this.picks.hasOwnProperty(e)&&this.clearPick(e)},n.prototype.hasEqualPicks=function(e,t){if(!e||!t)return!1;if(e.geomType===t.geomType){var r=Object(s.getSnapResultPosition)(e),n=Object(s.getSnapResultPosition)(t);return Object(s.isEqualVectors)(r,n,s.EPSILON)}return!1},n.prototype.computeResult=function(e,t){if(this.resetMeasureValues(),!t.model)return this.result=null,!1;var r=this.result=Object(s.computeResult)(e,this.measurementType,t,this.options);if(null===r)return!this.isComplete();switch(r.type){case o.MeasurementTypes.MEASUREMENT_DISTANCE:return this.distanceXYZ=r.distanceXYZ,this.distanceX=r.distanceX,this.distanceY=r.distanceY,this.distanceZ=r.distanceZ,!0;case o.MeasurementTypes.MEASUREMENT_ANGLE:return this.angle=isNaN(r.angle)?0:r.angle,!0;case o.MeasurementTypes.MEASUREMENT_AREA:return this.area=r.area,!0;case o.MeasurementTypes.MEASUREMENT_LOCATION:return this.location=r.location,!0;case o.MeasurementTypes.MEASUREMENT_CALLOUT:return!0;default:return!1}},n.prototype.getGeometry=function(e){return{type:this.picks[e].geomType,geometry:this.picks[e].getGeometry()}},n.prototype.attachIndicator=function(e,t,r){this.indicator=new r(e,this,t),this.indicator.init()}},"./src/measurement/MeasurementTypes.js":function(e,t,r){"use strict";r.r(t),r.d(t,"MeasurementTypes",function(){return n});var n={MEASUREMENT_DISTANCE:1,MEASUREMENT_ANGLE:2,MEASUREMENT_AREA:3,CALIBRATION:4,MEASUREMENT_CALLOUT:5,MEASUREMENT_LOCATION:6}},"./src/measurement/PDFUtils.js":function(e,t,r){"use strict";function n(e,t){var r=a(e);t.applyMatrix4(r);var n;if(e.model.isLeaflet()){var i=e.model.getMetadata("page_dimensions"),o=new THREE.Box3(new THREE.Vector3,new THREE.Vector3(i.page_width,i.page_height,0));n=l.SceneMath.getNormalizingMatrix(void 0,o)}else n=l.SceneMath.getNormalizingMatrix(e.model);return n=n.getInverse(n),t.applyMatrix4(n),t}function i(e,t){var r=l.SceneMath.getNormalizingMatrix(e.model);t.applyMatrix4(r);var n=a(e);return n=n.getInverse(n),t.applyMatrix4(n),t}function o(e){var t=e.impl.model.getDocumentNode(),r=t.search(Autodesk.Viewing.BubbleNode.LEAFLET_NODE)[0]._raw(),n={},i=new Autodesk.Viewing.Document(t.getRootNode()._raw(),"");return i.getLeafletParams(n,t,r),n}function s(e){var t=new Autodesk.Viewing.Private.TexQuadConfig,r=o(e);t.initFromLoadOptions(null,r);var n=t.getBBox();return n}function a(e){var t=s(e),r=l.SceneMath.getNormalizingMatrix(null,t);return r}r.r(t),r.d(t,"PDFUtils",function(){return c});var l=r("./src/wgs/scene/SceneMath.js"),c={leafletToPdfWorld:n,pdfToLeafletWorld:i,getLeafletLoadOptions:o,getLeafletBoundingBox:s,getLeafletNormalizingMatrix:a}},"./src/measurement/SnapResult.js":function(e,t,r){"use strict";function n(){this.clear()}r.r(t),r.d(t,"SnapResult",function(){return n});var i=r("./src/measurement/SnapTypes.js");n.prototype.clear=function(){this.geomType=null,this.modelId=null,this.snapNode=null,this.geomVertex=null,this.geomEdge=null,this.geomFace=null,this.radius=null,this.intersectPoint=null,this.faceNormal=null,this.viewportIndex2d=null,this.circularArcCenter=null,this.circularArcRadius=null,this.fromTopology=!1,this.isPerpendicular=!1,this.snapPoint=null},n.prototype.copyTo=function(e){e.modelId=this.modelId,e.snapNode=this.snapNode,e.geomVertex=this.geomVertex,e.geomFace=this.geomFace,e.geomEdge=this.geomEdge,e.radius=this.radius,e.geomType=this.geomType,e.intersectPoint=this.intersectPoint,e.faceNormal=this.faceNormal,e.viewportIndex2d=this.viewportIndex2d,e.circularArcCenter=this.circularArcCenter,e.circularArcRadius=this.circularArcRadius,e.fromTopology=this.fromTopology,e.isPerpendicular=this.isPerpendicular,e.snapPoint=this.snapPoint},n.prototype.clone=function(){var e=new n;return this.copyTo(e),e},n.prototype.isEmpty=function(){return!this.getGeometry()};var o=null,s=null,a=null,l=function(e,t){return s=s||new THREE.Vector3,a=a||new THREE.Vector3,s.set(0,0,0),a.set(e,0,0),s.applyMatrix4(t),a.applyMatrix4(t),s.distanceTo(a)};n.prototype.applyMatrix4=function(e){if(this.geomEdge&&this.geomEdge.applyMatrix(e),this.geomFace&&this.geomFace.applyMatrix(e),this.geomVertex&&this.geomVertex.applyMatrix4(e),this.intersectPoint&&this.intersectPoint.applyMatrix4(e),this.circularArcCenter&&this.circularArcCenter.applyMatrix4(e),this.snapPoint&&this.snapPoint.applyMatrix4(e),this.faceNormal){o=o||new THREE.Matrix4;var t=tempMatrix().getNormalMatrix(e);this.faceNormal.applyMatrix4(t)}this.radius=l(this.radius,e),this.circularArcRadius=l(this.circularArcRadius,e)},n.prototype.getFace=function(){return this.geomFace},n.prototype.getEdge=function(){return this.geomEdge},n.prototype.getVertex=function(){return this.geomVertex},n.prototype.getGeometry=function(){switch(this.geomType){case i.SnapType.SNAP_VERTEX:return this.geomVertex;case i.SnapType.SNAP_MIDPOINT:return this.geomVertex;case i.SnapType.SNAP_INTERSECTION:return this.geomVertex;case i.SnapType.SNAP_CIRCLE_CENTER:return this.geomVertex;case i.SnapType.RASTER_PIXEL:return this.geomVertex;case i.SnapType.SNAP_EDGE:return this.geomEdge;case i.SnapType.SNAP_FACE:return this.geomFace;case i.SnapType.SNAP_CIRCULARARC:return this.geomEdge;case i.SnapType.SNAP_CURVEDEDGE:return this.geomEdge;case i.SnapType.SNAP_CURVEDFACE:return this.geomFace}return null},n.prototype.setGeometry=function(e,t){switch(e){case i.SnapType.SNAP_VERTEX:this.geomVertex=t;break;case i.SnapType.SNAP_MIDPOINT:this.geomVertex=t;break;case i.SnapType.SNAP_INTERSECTION:this.geomVertex=t;break;case i.SnapType.SNAP_CIRCLE_CENTER:this.geomVertex=t;break;case i.SnapType.RASTER_PIXEL:this.geomVertex=t;break;case i.SnapType.SNAP_EDGE:this.geomEdge=t;break;case i.SnapType.SNAP_FACE:this.geomFace=t;break;case i.SnapType.SNAP_CIRCULARARC:this.geomEdge=t;break;case i.SnapType.SNAP_CURVEDEDGE:this.geomEdge=t;break;case i.SnapType.SNAP_CURVEDFACE:this.geomFace=t;break;default:return}this.geomType=e}},"./src/measurement/SnapTypes.js":function(e,t,r){"use strict";r.r(t),r.d(t,"SnapType",function(){return n});var n={SNAP_VERTEX:0,SNAP_MIDPOINT:1,SNAP_CIRCLE_CENTER:2,SNAP_EDGE:3,SNAP_FACE:4,SNAP_CIRCULARARC:5,SNAP_CURVEDEDGE:6,SNAP_CURVEDFACE:7,RASTER_PIXEL:8,SNAP_INTERSECTION:9}},"./src/measurement/UnitFormatter.js":function(e,t,r){"use strict";function n(e){var t=e>=0?Math.floor(e):Math.ceil(e),r=e-t;return{intPart:t,fracPart:r}}function i(e,t,r){var n="";return r&&0===e&&(n+="-"),n+=t>0?e.toFixed(t):e.toFixed(0)}function o(e,t,r,o){for(var s="",a=12,l=1,c=0>e,u=0;t>u;++u)l*=2;e>0?e+=.5/l:e-=.5/l;var d,h;r?h=e:(d=n(e/a).intPart,s+=i(d,0,c)+o.feet+" ",h=e-d*a,0>h&&(h=-h));var f=n(h).intPart,p=n((h-f)*l).intPart;if((0===p||0!==f)&&(s+=i(f,0)),0!==p){for(0>f&&0>p&&(p=-p);p%2===0;)p/=2,l/=2;0!==f&&(s+="-"),s+=i(p,0)+"/"+i(l,0)}return s+=o.inches}function s(e,t){var r="";0>e&&(r="-",e=Math.abs(e));var o=n(e),s=o.intPart,a=100*o.fracPart;return r+i(s,0)+" m "+i(a,t)+" cm"}function a(e,t,r){var o="";0>e&&(o="-",e=Math.abs(e));var s=n(e),a=s.intPart,l=12*s.fracPart;return o+i(a,0)+r.feet+" "+i(l,t)+r.inches}function l(e){if(!e||!e.startsWith("autodesk.unit.unit:"))return e;var t=e.split(":")[1],r=t.split("-")[0],n=g.unit[r];if(!n)return e;var i=v[r];if(i)return i;if(!n.symbols)return"";if(n.defaultSymbol&&n.symbols[n.defaultSymbol])return n.symbols[n.defaultSymbol];for(var o in n.symbols)return n.symbols[o]}function c(e,t){var r=t.space?" ":"";return"Prefix"===t.placement?t.text+r+e:e+r+t.text}function u(e,t,r,n,d){var h;(null===n||void 0===n)&&(n=3),d=d||{};var f=d.preferLetters?{feet:" ft",inches:" in"}:{feet:"'",inches:'"'};t=l(t);try{if(1===r)h=p.i18n.translate(e?"Yes":"No");else if(24===r){var m=e.split(" ");h=[];for(var g=0;g<m.length;++g)h.push(u(parseFloat(m[g]),t,3,n));h=h.join(", ")}else if(2!==r&&3!==r||!isNaN(e))if("ft-and-fractional-in"===t)h=o(12*e,n,!1,f);else if("ft-and-fractional-in^2"===t)h=d.noMixedArea?i(e,n)+" ft"+String.fromCharCode(178):o(12*e,n,!1,f)+" "+String.fromCharCode(178);else if("ft-and-fractional-in^3"===t)h=d.noMixedVolume?i(e,n)+" ft"+String.fromCharCode(179):o(12*e,n,!1,f)+" "+String.fromCharCode(179);else if("ft-and-decimal-in"===t)h=a(e,n,f);else if("ft-and-decimal-in^2"===t)h=d.noMixedArea?i(e,n)+" ft"+String.fromCharCode(178):a(e,n,f)+" "+String.fromCharCode(178);else if("ft-and-decimal-in^3"===t)h=d.noMixedVolume?i(e,n)+" ft"+String.fromCharCode(179):a(e,n,f)+" "+String.fromCharCode(179);else if("decimal-in"===t||"in"===t||"inch"===t||"inches"===t)h=i(e,n)+f.inches;else if("decimal-in^2"===t||"in^2"===t||"inch^2"===t)h=i(e,n)+" in"+String.fromCharCode(178);else if("decimal-in^3"===t||"in^3"===t||"inch^3"===t)h=i(e,n)+" in"+String.fromCharCode(179);else if("decimal-in-sq"===t||"fractional-in-sq"===t)h=i(e,n)+" sq. in";else if("decimal-ft"===t||"ft"===t||"feet"===t||"foot"===t)h=i(e,n)+f.feet;else if("decimal-ft^2"===t||"ft^2"===t||"feet^2"===t||"foot^2"===t)h=i(e,n)+" ft"+String.fromCharCode(178);else if("decimal-ft^3"===t||"ft^3"===t||"feet^3"===t||"foot^3"===t)h=i(e,n)+" ft"+String.fromCharCode(179);else if("decimal-ft-sq"===t||"ft-and-fractional-in-sq"===t||"ft-and-decimal-in-sq"===t)h=i(e,n)+" sq. ft";else if("fractional-in"===t)h=o(e,n,!0,f);else if("fractional-in^2"===t)h=o(e,n,!0,f)+String.fromCharCode(178);else if("fractional-in^3"===t)h=o(e,n,!0,f)+String.fromCharCode(179);else if("m-and-cm"===t)h=s(e,n);else if("m-and-cm^2"===t)h=d.noMixedArea?i(e,n)+" m"+String.fromCharCode(178):s(e,n)+" "+String.fromCharCode(178);else if("m-and-cm^3"===t)h=d.noMixedVolume?i(e,n)+" m"+String.fromCharCode(179):s(e,n)+" "+String.fromCharCode(179);else if(t&&t.text){var v=3===r?i(e,n):e;h=c(v,t)}else 3===r&&t?(t=t.replace("^2",String.fromCharCode(178)),t=t.replace("^3",String.fromCharCode(179)),h=i(e,n)+" "+t):h=t?e+" "+t:3===r?i(e,n):e;else h="NaN"}catch(y){h=t?e+" "+t:e}return h}function d(e,t,r,n,i,o){if(r=r?r:1,o=o||72,e===t&&1===r)return n;var s=1;switch(t){case"mm":s=1e3;break;case"cm":s=100;break;case"m":s=1;break;case"in":s=39.37007874;break;case"ft":s=3.280839895;break;case"ft-and-fractional-in":s=3.280839895;break;case"ft-and-decimal-in":s=3.280839895;break;case"decimal-in":s=39.37007874;break;case"decimal-ft":s=3.280839895;break;case"fractional-in":s=39.37007874;break;case"m-and-cm":s=1;break;case"pt":s=39.37007874*o}var a=1;switch(e){case"mm":a=.001;break;case"cm":a=.01;break;case"m":a=1;break;case"in":a=.0254;break;case"ft":a=.3048;break;case"ft-and-fractional-in":a=.3048;break;case"ft-and-decimal-in":a=.3048;break;case"decimal-in":a=.0254;break;case"decimal-ft":a=.3048;break;case"fractional-in":a=.0254;break;case"m-and-cm":a=1;break;case"pt":a=.0254/o}return"square"===i?n?n*Math.pow(s*a*r,2):0:"cube"===i?n?n*Math.pow(s*a*r,3):0:n?n*s*a*r:0}function h(e){if(!e)return 0;var t=e.toString().split(".")[1];if(!t){var r=e.toString().split("/")[1],n=r&&r.match(/\d+/);if(n){var i=parseFloat(n);if(i&&!isNaN(i))return Math.floor(Math.log2(i))}return 0}return t=t.match(/\d+/),t&&t[0]&&t[0].length||0}function f(e,t,r){if(!t||!r)return{displayValue:e,displayUnits:t};var n,i=t,o=r;if(/\^2$/.test(i)?(i=i.replace("^2",""),o+="^2",n="square"):/\^3$/.test(i)&&(i=i.replace("^3",""),o+="^3",n="cube"),-1===m.displayUnitsEnum.indexOf(i))return{displayValue:e,displayUnits:t};var s=d(i,r,1,e,n,null);return{displayValue:s,displayUnits:o}}r.r(t),r.d(t,"formatValueWithUnits",function(){return u}),r.d(t,"convertUnits",function(){return d}),r.d(t,"calculatePrecision",function(){return h}),r.d(t,"convertToDisplayUnits",function(){return f});var p=r("./src/globalization/i18next.js"),m=r("./src/measurement/DisplayUnits.js"),g=r("./src/measurement/units-compact.json"),v={feetFractionalInches:"ft-and-fractional-in",fractionalInches:"fractional-in",feet:"feet",inches:"inches",stationingFeet:"feet"}},"./src/measurement/UnitParser.js":function(e,t,r){"use strict";function n(e,t,r,n){if(!e)return NaN;e=e.toString();var i=e.trim();if(0==i.length)return NaN;var o,s=r.join("| *"),a=n.join("| *");if(o=i.match(new RegExp("^([+-]?\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+a+") *$")))return parseFloat(o[1])/parseFloat(o[2])/t;if(o=i.match(new RegExp("^([+-]?\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+s+")? *$")))return parseFloat(o[1])/parseFloat(o[2]);var l=NaN;if(o=i.match(/^[+-]? *(?:\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?/i),!o)return NaN;if(l=parseFloat(o[0].replace(/ */g,"")),i=i.slice(o[0].length),i=i.replace("-"," "),0==i.length||isNaN(l))return l;var c=Math.sign(l);return 0===c&&(c=1),i.match(new RegExp("^(?: *)(?:"+a+") *$","i"))?l/t:(o=i.match(new RegExp("^ +(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+a+") *$","i")))?(l+c*parseFloat(o[1])/parseFloat(o[2]))/t:(o=i.match(new RegExp("^(?: *)(?:"+s+"|-| +-?) *","i")))?(i=i.slice(o[0].length).trim(),0==i.length?o[0].match(/-/)?NaN:l:(o=i.match(new RegExp("^(\\d+(?:\\.\\d*)?)(?: *)(?:"+a+")? *$")))?l+c*parseFloat(o[1])/t:(o=i.match(new RegExp("^(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+a+")? *$")))?l+c*(parseFloat(o[1])/parseFloat(o[2]))/t:(o=i.match(new RegExp("^(\\d+) +(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+a+")? *$")))?l+c*(parseFloat(o[1])+parseFloat(o[2])/parseFloat(o[3]))/t:NaN):NaN}r.r(t),r.d(t,"UnitParser",function(){return i});var i={};i.parseFeet=function(e){return n(e,12,["ft","feet","'","`","\u2018","\u2019"],["in","inch",'\\"',"''","``","\u2018\u2018","\u2019\u2019"])},i.parseMeter=function(e){return n(e,100,["m","meter"],["cm","centimeter"])},i.parseNumber=function(e,t){switch(t){case"ft":case"decimal-ft":case"ft-and-fractional-in":case"ft-and-decimal-in":case"decimal-in":case"fractional-in":return i.parseFeet(e);case"":case"m":case"cm":case"mm":case"m-and-cm":default:return i.parseMeter(e)}},i.parsePositiveNumber=function(e,t){var r=i.parseNumber(e,t);return r>=0?r:NaN}},"./src/measurement/units-compact.json":function(e){e.exports=JSON.parse('{"globals":{"dimension":{},"factor":{"factor":1},"factor.derived":{"parentFactors":{}},"quantity":{"units":[]},"symbol":{"doc":"http://docs.adskunits.apiary.io/#introduction/definitions/unit-symbols","unit":{"typeid":"unit","description":"Measurement unit this symbol applies to."}},"symbol.placement":{"Prefix":{"value":0},"Suffix":1},"symbol.prefixOrSuffix":{"text":{"typeid":"String","description":"Text to annotate the value."},"placement":{"typeid":"symbol.placement","description":"Placement of the annotation text."},"space":{"typeid":"Bool","description":"Specifies whether the annotation should be separated from the value by a space."}},"system":{"Metric":{"value":0,"description":"Metric system of measurement units."},"Imperial":1},"unit":{"doc":"http://docs.adskunits.apiary.io/#introduction/definitions/measurement-units","unitSystem":{"typeid":"system"}},"unit.absolute":{"parentUnit":{"typeid":"unit.relative","description":"Relative unit from which this absolute unit is derived."},"offset":{"typeid":"Float64","value":0,"description":"An offset used to position an absolute scale of measurement on the number line."}},"unit.derived":{"parentFactors":{},"parentUnits":{}},"unit.primitive":{},"unit.primitive.dimensional":{"dimension":{"typeid":"dimension"}},"unit.relative":{}},"factor":{"nineFifths":{"factor":1.8},"pi":{"factor":3.14159265358979},"atto":{"parentFactors":{"ten":-18}},"centi":{"parentFactors":{"ten":-2}},"deci":{"parentFactors":{"ten":-1}},"deka":{"parentFactors":{"ten":1}},"exa":{"parentFactors":{"ten":18}},"femto":{"parentFactors":{"ten":-15}},"giga":{"parentFactors":{"ten":9}},"hecto":{"parentFactors":{"ten":2}},"kilo":{"parentFactors":{"ten":3}},"mega":{"parentFactors":{"ten":6}},"micro":{"parentFactors":{"ten":-6}},"milli":{"parentFactors":{"ten":-3}},"nano":{"parentFactors":{"ten":-9}},"peta":{"parentFactors":{"ten":15}},"pico":{"parentFactors":{"ten":-12}},"tera":{"parentFactors":{"ten":12}},"yocto":{"parentFactors":{"ten":-24}},"yotta":{"parentFactors":{"ten":24}},"zepto":{"parentFactors":{"ten":-21}},"zetta":{"parentFactors":{"ten":21}},"ten":{"factor":10},"threeHundredSixty":{"factor":360},"threeThousandNineHundredThirtySeven":{"factor":3937},"twelve":{"factor":12}},"dimension":{"currency":{},"electricCurrent":{},"length":{},"luminousIntensity":{},"mass":{},"temperature":{},"time":{}},"unit":{"1ToRatio":{"unitSystem":"Metric","parentUnits":{"ratioTo1":-1},"symbols":{"1Colon":{"text":"1:","placement":"Prefix","space":false}}},"acres":{"unitSystem":"Imperial","factor":4840,"parentUnits":{"squareYards":1},"symbols":{"acres":{"text":"acres","placement":"Suffix","space":true}}},"ampereHours":{"unitSystem":"Metric","parentUnits":{"amperes":1,"hours":1},"symbols":{"aDashH":{"text":"A-h","placement":"Suffix","space":true}}},"ampereSeconds":{"unitSystem":"Metric","parentUnits":{"amperes":1,"seconds":1},"symbols":{"aDashS":{"text":"A-s","placement":"Suffix","space":true}}},"amperes":{"unitSystem":"Metric","dimension":"electricCurrent","symbols":{"ampere":{"text":"A","placement":"Suffix","space":true}}},"atmospheres":{"unitSystem":"Imperial","factor":101325,"parentUnits":{"pascals":1},"symbols":{"atm":{"text":"atm","placement":"Suffix","space":true}}},"bars":{"unitSystem":"Metric","factor":100,"parentUnits":{"kilopascals":1},"symbols":{"bar":{"text":"bar","placement":"Suffix","space":true}}},"britishThermalUnits":{"unitSystem":"Imperial","factor":1055.05585262,"parentUnits":{"joules":1},"symbols":{"btu":{"text":"Btu","placement":"Suffix","space":true}}},"britishThermalUnitsPerDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"fahrenheitInterval":-1},"symbols":{"btuPerDegreeF":{"text":"BTU/\xb0F","placement":"Suffix","space":true}}},"britishThermalUnitsPerHour":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"hours":-1},"symbols":{"btuPerH":{"text":"Btu/h","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourCubicFoot":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHour":1,"cubicFeet":-1},"symbols":{"btuPerHFtSup3":{"text":"Btu/(h\xb7ft\xb3)","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourFootDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHour":1,"feet":-1,"fahrenheitInterval":-1},"symbols":{"btuPerHFtDegreeF":{"text":"BTU/(h\xb7ft\xb7\xb0F)","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourSquareFoot":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHour":1,"squareFeet":-1},"symbols":{"btuPerHFtSup2":{"text":"Btu/(h\xb7ft\xb2)","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourSquareFootDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHourSquareFoot":1,"fahrenheitInterval":-1},"symbols":{"btuPerHFtSup2DegreeF":{"text":"BTU/(h\xb7ft\xb2\xb7\xb0F)","placement":"Suffix","space":true}}},"britishThermalUnitsPerPound":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"poundsMass":-1},"symbols":{"btuPerLb":{"text":"BTU/lb","placement":"Suffix","space":true}}},"britishThermalUnitsPerPoundDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerPound":1,"fahrenheitInterval":-1},"symbols":{"btuPerLbDegreeF":{"text":"BTU/(lb\xb7\xb0F)","placement":"Suffix","space":true}}},"britishThermalUnitsPerSecond":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"seconds":-1},"symbols":{"btuPerS":{"text":"Btu/s","placement":"Suffix","space":true}}},"calories":{"unitSystem":"Metric","factor":4.1868,"parentUnits":{"joules":1},"symbols":{"cal":{"text":"cal","placement":"Suffix","space":true}}},"caloriesPerSecond":{"unitSystem":"Metric","parentUnits":{"calories":1,"seconds":-1},"symbols":{"calPerS":{"text":"cal/s","placement":"Suffix","space":true}}},"candelas":{"unitSystem":"Metric","dimension":"luminousIntensity","symbols":{"cd":{"text":"cd","placement":"Suffix","space":true}}},"candelasPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"candelas":1,"squareFeet":-1},"symbols":{"cdPerFtSup2":{"text":"cd/ft\xb2","placement":"Suffix","space":true}}},"candelasPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"candelas":1,"squareMeters":-1},"symbols":{"cdPerMSup2":{"text":"cd/m\xb2","placement":"Suffix","space":true}}},"celsius":{"unitSystem":"Metric","parentUnit":"celsiusInterval","offset":273.15,"symbols":{"degreeC":{"text":"\xb0C","placement":"Suffix","space":true}}},"celsiusInterval":{"unitSystem":"Metric","parentUnits":{"kelvinInterval":1},"symbols":{"degreeCInterval":{"text":"\xb0C","placement":"Suffix","space":true},"deltaDegreeC":{"text":"delta\xb0C","placement":"Suffix","space":true}}},"centimeters":{"unitSystem":"Metric","parentFactors":{"centi":1},"parentUnits":{"meters":1},"symbols":{"cm":{"text":"cm","placement":"Suffix","space":true}}},"centimetersPerMinute":{"unitSystem":"Metric","parentUnits":{"centimeters":1,"minutes":-1},"symbols":{"cmPerMin":{"text":"cm/min","placement":"Suffix","space":true}}},"centimetersToTheFourthPower":{"unitSystem":"Metric","parentUnits":{"centimeters":4},"symbols":{"cmSup4":{"text":"cm\u2074","placement":"Suffix","space":true}}},"centimetersToTheSixthPower":{"unitSystem":"Metric","parentUnits":{"centimeters":6},"symbols":{"cmSup6":{"text":"cm\u2076","placement":"Suffix","space":true}}},"centipoises":{"unitSystem":"Metric","parentFactors":{"centi":1},"parentUnits":{"poises":1},"symbols":{"cP":{"text":"cP","placement":"Suffix","space":true}}},"circularMils":{"unitSystem":"Imperial","factor":0.25,"parentFactors":{"pi":1},"parentUnits":{"squareMils":1},"symbols":{"cMil":{"text":"cmil","placement":"Suffix","space":true}}},"coulombs":{"unitSystem":"Metric","parentUnits":{"ampereSeconds":1},"symbols":{"coulomb":{"text":"C","placement":"Suffix","space":true}}},"cubicCentimeters":{"defaultSymbol":"cmSup3","unitSystem":"Metric","parentUnits":{"centimeters":3},"symbols":{"cmCaret3":{"text":"cm^3","placement":"Suffix","space":true},"cmSup3":{"text":"cm\xb3","placement":"Suffix","space":true}}},"cubicFeet":{"defaultSymbol":"ftSup3","unitSystem":"Imperial","parentUnits":{"feet":3},"symbols":{"cf":{"text":"CF","placement":"Suffix","space":true},"ftCaret3":{"text":"ft^3","placement":"Suffix","space":true},"ftSup3":{"text":"ft\xb3","placement":"Suffix","space":true}}},"cubicFeetPerHour":{"defaultSymbol":"ftSup3PerHour","unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"hours":-1},"symbols":{"cfh":{"text":"CFH","placement":"Suffix","space":true},"ftSup3PerH":{"text":"ft\xb3/h","placement":"Suffix","space":true}}},"cubicFeetPerKip":{"unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"kips":-1},"symbols":{"ftSup3PerKip":{"text":"ft\xb3/kip","placement":"Suffix","space":true}}},"cubicFeetPerMinute":{"defaultSymbol":"ftSup3PerMin","unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"minutes":-1},"symbols":{"cfm":{"text":"CFM","placement":"Suffix","space":true},"ftSup3PerMin":{"text":"ft\xb3/min","placement":"Suffix","space":true}}},"cubicFeetPerMinuteCubicFoot":{"defaultSymbol":"cfmPerFtSup3","unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"cubicFeet":-1},"symbols":{"cfmPerCf":{"text":"CFM/CF","placement":"Suffix","space":true},"cfmPerFtSup3":{"text":"CFM/ft\xb3","placement":"Suffix","space":true}}},"cubicFeetPerMinutePerBritishThermalUnitPerHour":{"unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"britishThermalUnitsPerHour":-1},"symbols":{"ftSup3HPerMinBtu":{"text":"ft\xb3\xb7h/(min\xb7Btu)","placement":"Suffix","space":true}}},"cubicFeetPerMinuteSquareFoot":{"defaultSymbol":"cfmPerFtSup2","unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"squareFeet":-1},"symbols":{"cfmPerFtSup2":{"text":"CFM/ft\xb2","placement":"Suffix","space":true},"cfmPerSf":{"text":"CFM/SF","placement":"Suffix","space":true}}},"cubicFeetPerMinuteTonOfRefrigeration":{"unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"tonsOfRefrigeration":-1},"symbols":{"cfmPerTon":{"text":"CFM/ton","placement":"Suffix","space":true}}},"cubicFeetPerPoundMass":{"unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"poundsMass":-1},"symbols":{"ftSup3PerLbMass":{"text":"ft\xb3/lb","placement":"Suffix","space":true}}},"cubicInches":{"defaultSymbol":"inSup3","unitSystem":"Imperial","parentUnits":{"inches":3},"symbols":{"inCaret3":{"text":"in^3","placement":"Suffix","space":true},"inSup3":{"text":"in\xb3","placement":"Suffix","space":true}}},"cubicMeters":{"defaultSymbol":"mSup3","unitSystem":"Metric","parentUnits":{"meters":3},"symbols":{"mCaret3":{"text":"m^3","placement":"Suffix","space":true},"mSup3":{"text":"m\xb3","placement":"Suffix","space":true}}},"cubicMetersPerHour":{"defaultSymbol":"mSup3PerH","unitSystem":"Metric","parentUnits":{"cubicMeters":1,"hours":-1},"symbols":{"cmh":{"text":"CMH","placement":"Suffix","space":true},"mSup3PerH":{"text":"m\xb3/h","placement":"Suffix","space":true}}},"cubicMetersPerKilogram":{"unitSystem":"Metric","parentUnits":{"cubicMeters":1,"kilograms":-1},"symbols":{"mSup3PerKg":{"text":"m\xb3/kg","placement":"Suffix","space":true}}},"cubicMetersPerKilonewton":{"unitSystem":"Metric","parentUnits":{"cubicMeters":1,"kilonewtons":-1},"symbols":{"mSup3PerKN":{"text":"m\xb3/kN","placement":"Suffix","space":true}}},"cubicMetersPerSecond":{"defaultSymbol":"mSup3PerS","unitSystem":"Metric","parentUnits":{"cubicMeters":1,"seconds":-1},"symbols":{"cms":{"text":"CMS","placement":"Suffix","space":true},"mSup3PerS":{"text":"m\xb3/s","placement":"Suffix","space":true}}},"cubicMetersPerWattSecond":{"unitSystem":"Metric","parentUnits":{"cubicMeters":1,"watts":-1,"seconds":-1},"symbols":{"mSup3PerWS":{"text":"m\xb3/(W\xb7s)","placement":"Suffix","space":true}}},"cubicMillimeters":{"defaultSymbol":"mmSup3","unitSystem":"Metric","parentUnits":{"millimeters":3},"symbols":{"mmCaret3":{"text":"mm^3","placement":"Suffix","space":true},"mmSup3":{"text":"mm\xb3","placement":"Suffix","space":true}}},"cubicYards":{"unitSystem":"Imperial","parentUnits":{"yards":3},"symbols":{"cy":{"text":"CY","placement":"Suffix","space":true}}},"currency":{"defaultSymbol":"usDollar","unitSystem":"Imperial","dimension":"currency","symbols":{"baht":{"description":"Baht is the official currency of Thailand.","text":"\u0e3f","placement":"Prefix","space":false},"chineseHongKongDollar":{"description":"Hong Kong Dollar is the official currency of Hong Kong..","text":"HK$","placement":"Prefix","space":false},"dong":{"description":"Dong is the official currency of Vietnam.","text":"\u20ab","placement":"Suffix","space":false},"euroPrefix":{"text":"\u20ac","placement":"Prefix","space":false},"euroSuffix":{"text":"\u20ac","placement":"Suffix","space":false},"krone":{"description":"Krone is the official currency of Denmark, Greenland, and the Faroe Islands.","text":"kr","placement":"Suffix","space":true},"shekel":{"description":"Shekel is the official currency of Israel.","text":"\u20aa","placement":"Prefix","space":false},"ukPound":{"text":"\xa3","placement":"Prefix","space":false},"usDollar":{"text":"$","placement":"Prefix","space":false},"won":{"description":"Won is the official currency of South Korea.","text":"\u20a9","placement":"Prefix","space":false},"yen":{"text":"\xa5","placement":"Prefix","space":false}}},"currencyPerBritishThermalUnit":{"unitSystem":"Imperial","parentUnits":{"currency":1,"britishThermalUnits":-1},"symbols":{"dollarPerBtu":{"text":"$/Btu","placement":"Suffix","space":true}}},"currencyPerBritishThermalUnitPerHour":{"unitSystem":"Imperial","parentUnits":{"currency":1,"britishThermalUnitsPerHour":-1},"symbols":{"dollarHPerBtu":{"text":"$\xb7h/Btu","placement":"Suffix","space":true}}},"currencyPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"currency":1,"squareFeet":-1},"symbols":{"dollarPerFtSup2":{"text":"$/ft\xb2","placement":"Prefix","space":false}}},"currencyPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"currency":1,"squareMeters":-1},"symbols":{"dollarPerMSup2":{"text":"$/m\xb2","placement":"Prefix","space":false}}},"currencyPerWatt":{"unitSystem":"Metric","parentUnits":{"currency":1,"watts":-1},"symbols":{"dollarPerW":{"text":"$/W","placement":"Suffix","space":true}}},"currencyPerWattHour":{"unitSystem":"Metric","parentUnits":{"currency":1,"watts":-1,"hours":-1},"symbols":{"dollarPerWH":{"text":"$/(W\xb7h)","placement":"Suffix","space":true}}},"cyclesPerSecond":{"unitSystem":"Metric","parentUnits":{"seconds":-1},"symbols":{"cps":{"text":"cps","placement":"Suffix","space":true}}},"decimeters":{"unitSystem":"Metric","parentFactors":{"deci":1},"parentUnits":{"meters":1},"symbols":{"dm":{"text":"dm","placement":"Suffix","space":true}}},"degrees":{"defaultSymbol":"degree","unitSystem":"Metric","parentFactors":{"threeHundredSixty":-1},"parentUnits":{"turns":1},"symbols":{"degree":{"text":"\xb0","placement":"Suffix","space":false},"degreesMinutesSeconds":{"inherits":"symbol"},"slopeDegree":{"text":"\xb0","placement":"Suffix","space":false}}},"dekanewtonMeters":{"unitSystem":"Metric","parentUnits":{"dekanewtons":1,"meters":1},"symbols":{"daNDashM":{"text":"daN-m","placement":"Suffix","space":true}}},"dekanewtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"dekanewtonMeters":1,"meters":-1},"symbols":{"daNDashMPerM":{"text":"daN-m/m","placement":"Suffix","space":true}}},"dekanewtons":{"unitSystem":"Metric","parentFactors":{"deka":1},"parentUnits":{"newtons":1},"symbols":{"daN":{"text":"daN","placement":"Suffix","space":true}}},"dekanewtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"dekanewtons":1,"meters":-1},"symbols":{"daNPerM":{"text":"daN/m","placement":"Suffix","space":true}}},"dekanewtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"dekanewtons":1,"squareMeters":-1},"symbols":{"daNPerMSup2":{"text":"daN/m\xb2","placement":"Suffix","space":true}}},"dynes":{"unitSystem":"Metric","factor":10,"parentFactors":{"micro":1},"parentUnits":{"newtons":1},"symbols":{"dyn":{"text":"dyn","placement":"Suffix","space":true}}},"ergs":{"unitSystem":"Metric","parentFactors":{"ten":-7},"parentUnits":{"joules":1},"symbols":{"erg":{"text":"erg","placement":"Suffix","space":true}}},"fahrenheit":{"unitSystem":"Imperial","parentUnit":"fahrenheitInterval","offset":459.67,"symbols":{"degreeF":{"text":"\xb0F","placement":"Suffix","space":true}}},"fahrenheitInterval":{"defaultSymbol":"degreeFInterval","unitSystem":"Imperial","parentUnits":{"rankineInterval":1},"symbols":{"degreeFInterval":{"text":"\xb0F","placement":"Suffix","space":true},"deltaDegreeF":{"text":"delta\xb0F","placement":"Suffix","space":true}}},"farads":{"unitSystem":"Metric","parentUnits":{"coulombs":1,"volts":-1},"symbols":{"farad":{"text":"F","placement":"Suffix","space":true}}},"feet":{"defaultSymbol":"feetAndInches","unitSystem":"Imperial","factor":12,"parentUnits":{"inches":1},"symbols":{"feetAndInches":{"inherits":"symbol"},"footSingleQuote":{"text":"\'","placement":"Suffix","space":false},"ft":{"text":"ft","placement":"Suffix","space":true},"lf":{"text":"LF","placement":"Suffix","space":true}}},"feetOfWater39.2DegreesFahrenheit":{"defaultSymbol":"feetOfWater","unitSystem":"Imperial","factor":2988.98,"parentUnits":{"pascals":1},"symbols":{"feetOfWater":{"text":"Feet","placement":"Suffix","space":true},"ftH2O":{"text":"ftH2O","placement":"Suffix","space":true},"ftOfWater":{"text":"FT","placement":"Suffix","space":true}}},"feetOfWater39.2DegreesFahrenheitPer100Feet":{"defaultSymbol":"feetOfWaterPer100ft","unitSystem":"Imperial","factor":0.01,"parentUnits":{"feetOfWater39.2DegreesFahrenheit":1,"feet":-1},"symbols":{"feetOfWaterPer100ft":{"text":"Feet/100ft","placement":"Suffix","space":true},"ftH2OPer100ft":{"text":"ftH2O/100ft","placement":"Suffix","space":true},"ftOfWaterPer100ft":{"text":"FT/100ft","placement":"Suffix","space":true}}},"feetPerKip":{"unitSystem":"Imperial","parentUnits":{"feet":1,"kips":-1},"symbols":{"ftPerKip":{"text":"ft/kip","placement":"Suffix","space":true}}},"feetPerKipFoot":{"unitSystem":"Imperial","parentUnits":{"feet":1,"kipFeet":-1},"symbols":{"ftPerKipDashFt":{"text":"ft/kip-ft","placement":"Suffix","space":true}}},"feetPerMinute":{"defaultSymbol":"fpm","unitSystem":"Imperial","parentUnits":{"feet":1,"minutes":-1},"symbols":{"fpm":{"text":"FPM","placement":"Suffix","space":true},"ftPerMin":{"text":"ft/min","placement":"Suffix","space":true}}},"feetPerSecond":{"defaultSymbol":"fps","unitSystem":"Imperial","parentUnits":{"feet":1,"seconds":-1},"symbols":{"fps":{"text":"FPS","placement":"Suffix","space":true},"ftPerS":{"text":"ft/s","placement":"Suffix","space":true}}},"feetPerSecondSquared":{"unitSystem":"Imperial","parentUnits":{"feetPerSecond":1,"seconds":-1},"symbols":{"ftPerSSup2":{"text":"ft/s\xb2","placement":"Suffix","space":true}}},"feetToTheFourthPower":{"unitSystem":"Imperial","parentUnits":{"feet":4},"symbols":{"ftSup4":{"text":"ft\u2074","placement":"Suffix","space":true}}},"feetToTheSixthPower":{"unitSystem":"Imperial","parentUnits":{"feet":6},"symbols":{"ftSup6":{"text":"ft\u2076","placement":"Suffix","space":true}}},"fixed":{"unitSystem":"Metric","parentUnits":{"ratioTo1":1}},"footcandles":{"defaultSymbol":"fc","unitSystem":"Imperial","parentUnits":{"lumens":1,"squareFeet":-1},"symbols":{"fc":{"text":"fc","placement":"Suffix","space":true},"ftc":{"text":"Ftc","placement":"Suffix","space":true}}},"footlamberts":{"defaultSymbol":"fL","unitSystem":"Imperial","parentFactors":{"pi":-1},"parentUnits":{"candelas":1,"squareFeet":-1},"symbols":{"fL":{"text":"fL","placement":"Suffix","space":true},"flLowercase":{"text":"fl","placement":"Suffix","space":true},"ftL":{"text":"ftL","placement":"Suffix","space":true}}},"gammas":{"unitSystem":"Metric","parentFactors":{"nano":1},"parentUnits":{"teslas":1},"symbols":{"gamma":{"text":"gamma","placement":"Suffix","space":true}}},"gauss":{"unitSystem":"Metric","parentFactors":{"ten":-4},"parentUnits":{"teslas":1},"symbols":{"gs":{"text":"Gs","placement":"Suffix","space":true}}},"general":{"unitSystem":"Metric","parentUnits":{"ratioTo1":1}},"gradians":{"unitSystem":"Metric","factor":0.9,"parentUnits":{"degrees":1},"symbols":{"grad":{"text":"grad","placement":"Suffix","space":true}}},"grains":{"unitSystem":"Imperial","factor":64.79891,"parentUnits":{"milligrams":1},"symbols":{"gr":{"text":"gr","placement":"Suffix","space":true}}},"grainsPerHourSquareFootInchMercury":{"unitSystem":"Imperial","parentUnits":{"grains":1,"hours":-1,"squareFeet":-1,"inchesOfMercury32DegreesFahrenheit":-1},"symbols":{"grPerHFtSup2InHg":{"text":"gr/(h\xb7ft\xb2\xb7inHg)","placement":"Suffix","space":true}}},"grams":{"unitSystem":"Metric","factor":0.001,"parentUnits":{"kilograms":1},"symbols":{"gram":{"text":"g","placement":"Suffix","space":true}}},"hectares":{"unitSystem":"Metric","parentUnits":{"squareHectometers":1},"symbols":{"hectare":{"text":"hectare","placement":"Suffix","space":true}}},"hectometers":{"unitSystem":"Metric","parentFactors":{"hecto":1},"parentUnits":{"meters":1},"symbols":{"hm":{"text":"hm","placement":"Suffix","space":true}}},"henries":{"unitSystem":"Metric","parentUnits":{"ohms":1,"seconds":1},"symbols":{"henry":{"text":"H","placement":"Suffix","space":true}}},"hertz":{"unitSystem":"Metric","parentUnits":{"cyclesPerSecond":1},"symbols":{"hz":{"text":"Hz","placement":"Suffix","space":true}}},"horsepower":{"unitSystem":"Imperial","factor":33000,"parentUnits":{"poundForceFeet":1,"minutes":-1},"symbols":{"hp":{"text":"hp","placement":"Suffix","space":true}}},"hourSquareFootDegreesFahrenheitPerBritishThermalUnit":{"unitSystem":"Imperial","parentUnits":{"hours":1,"squareFeet":1,"fahrenheitInterval":1,"britishThermalUnits":-1},"symbols":{"hFtSup2DegreeFPerBtu":{"text":"(h\xb7ft\xb2\xb7\xb0F)/BTU","placement":"Suffix","space":true}}},"hours":{"unitSystem":"Metric","factor":60,"parentUnits":{"minutes":1},"symbols":{"hour":{"text":"h","placement":"Suffix","space":true}}},"inches":{"defaultSymbol":"in","unitSystem":"Imperial","factor":2.54,"parentUnits":{"centimeters":1},"symbols":{"in":{"text":"in","placement":"Suffix","space":true},"inchDoubleQuote":{"text":"\\"","placement":"Suffix","space":false}}},"inchesOfMercury32DegreesFahrenheit":{"unitSystem":"Imperial","factor":3386.389,"parentUnits":{"pascals":1},"symbols":{"inHg":{"text":"inHg","placement":"Suffix","space":true}}},"inchesOfWater60DegreesFahrenheit":{"unitSystem":"Imperial","factor":248.84,"parentUnits":{"pascals":1},"symbols":{"inDashWg":{"text":"in-wg","placement":"Suffix","space":true}}},"inchesOfWater60DegreesFahrenheitPer100Feet":{"unitSystem":"Imperial","factor":0.01,"parentUnits":{"inchesOfWater60DegreesFahrenheit":1,"feet":-1},"symbols":{"inDashWgPer100ft":{"text":"in-wg/100ft","placement":"Suffix","space":true}}},"inchesPerSecond":{"unitSystem":"Imperial","parentUnits":{"inches":1,"seconds":-1},"symbols":{"inPerS":{"text":"in/s","placement":"Suffix","space":true}}},"inchesPerSecondSquared":{"unitSystem":"Imperial","parentUnits":{"inchesPerSecond":1,"seconds":-1},"symbols":{"inPerSSup2":{"text":"in/s\xb2","placement":"Suffix","space":true}}},"inchesToTheFourthPower":{"unitSystem":"Imperial","parentUnits":{"inches":4},"symbols":{"inSup4":{"text":"in\u2074","placement":"Suffix","space":true}}},"inchesToTheSixthPower":{"unitSystem":"Imperial","parentUnits":{"inches":6},"symbols":{"inSup6":{"text":"in\u2076","placement":"Suffix","space":true}}},"inverseDegreesCelsius":{"unitSystem":"Metric","parentUnits":{"celsiusInterval":-1},"symbols":{"invDegreeC":{"text":"1/\xb0C","placement":"Suffix","space":true}}},"inverseDegreesFahrenheit":{"unitSystem":"Imperial","parentUnits":{"fahrenheitInterval":-1},"symbols":{"invDegreeF":{"text":"1/\xb0F","placement":"Suffix","space":true}}},"inverseKilonewtons":{"unitSystem":"Metric","parentUnits":{"kilonewtons":-1},"symbols":{"invKN":{"text":"1/kN","placement":"Suffix","space":true}}},"inverseKips":{"unitSystem":"Imperial","parentUnits":{"kips":-1},"symbols":{"invKip":{"text":"1/kip","placement":"Suffix","space":true}}},"joules":{"unitSystem":"Metric","parentUnits":{"newtonMeters":1},"symbols":{"joule":{"text":"J","placement":"Suffix","space":true}}},"joulesPerGram":{"unitSystem":"Metric","parentUnits":{"joules":1,"grams":-1},"symbols":{"jPerG":{"text":"J/g","placement":"Suffix","space":true}}},"joulesPerGramDegreeCelsius":{"unitSystem":"Metric","parentUnits":{"joulesPerGram":1,"celsiusInterval":-1},"symbols":{"jPerGDegreeC":{"text":"J/(g\xb7\xb0C)","placement":"Suffix","space":true}}},"joulesPerKelvin":{"unitSystem":"Metric","parentUnits":{"joules":1,"kelvinInterval":-1},"symbols":{"jPerK":{"text":"J/K","placement":"Suffix","space":true}}},"joulesPerKilogram":{"unitSystem":"Metric","parentUnits":{"joules":1,"kilograms":-1},"symbols":{"jPerKg":{"text":"J/kg","placement":"Suffix","space":true}}},"joulesPerKilogramDegreeCelsius":{"unitSystem":"Metric","parentUnits":{"joulesPerKilogram":1,"celsiusInterval":-1},"symbols":{"jPerKgDegreeC":{"text":"J/(kg\xb7\xb0C)","placement":"Suffix","space":true}}},"kelvin":{"unitSystem":"Metric","parentUnit":"kelvinInterval","symbols":{"kelvin":{"text":"K","placement":"Suffix","space":true}}},"kelvinInterval":{"defaultSymbol":"deltaK","unitSystem":"Metric","dimension":"temperature","symbols":{"deltaK":{"text":"deltaK","placement":"Suffix","space":true},"kelvinInterval":{"text":"K","placement":"Suffix","space":true}}},"kiloamperes":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"amperes":1},"symbols":{"kA":{"text":"kA","placement":"Suffix","space":true}}},"kilocalories":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"calories":1},"symbols":{"kcal":{"text":"kcal","placement":"Suffix","space":true}}},"kilocaloriesPerSecond":{"unitSystem":"Metric","parentUnits":{"kilocalories":1,"seconds":-1},"symbols":{"kcalPerS":{"text":"kcal/s","placement":"Suffix","space":true}}},"kilogramForceMeters":{"unitSystem":"Metric","parentUnits":{"kilogramsForce":1,"meters":1},"symbols":{"kgfDashM":{"text":"kgf-m","placement":"Suffix","space":true}}},"kilogramForceMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"kilogramForceMeters":1,"meters":-1},"symbols":{"kgfDashMPerM":{"text":"kgf-m/m","placement":"Suffix","space":true}}},"kilogramKelvins":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"kelvinInterval":1},"symbols":{"kgK":{"text":"kg\xb7K","placement":"Suffix","space":true}}},"kilograms":{"unitSystem":"Metric","dimension":"mass","symbols":{"kg":{"text":"kg","placement":"Suffix","space":true}}},"kilogramsForce":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"standardGravity":1},"symbols":{"kgf":{"text":"kgf","placement":"Suffix","space":true}}},"kilogramsForcePerMeter":{"unitSystem":"Metric","parentUnits":{"kilogramsForce":1,"meters":-1},"symbols":{"kgfPerM":{"text":"kgf/m","placement":"Suffix","space":true}}},"kilogramsForcePerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilogramsForce":1,"squareMeters":-1},"symbols":{"kgfPerMSup2":{"text":"kgf/m\xb2","placement":"Suffix","space":true}}},"kilogramsPerCubicCentimeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"cubicCentimeters":-1}},"kilogramsPerCubicMeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"cubicMeters":-1},"symbols":{"kgPerMSup3":{"text":"kg/m\xb3","placement":"Suffix","space":true}}},"kilogramsPerHour":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"hours":-1},"symbols":{"kgPerH":{"text":"kg/h","placement":"Suffix","space":true}}},"kilogramsPerKilogramKelvin":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"kilogramKelvins":-1},"symbols":{"kgPerKgK":{"text":"kg/(kg\xb7K)","placement":"Suffix","space":true}}},"kilogramsPerMeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"meters":-1},"symbols":{"kgPerM":{"text":"kg/m","placement":"Suffix","space":true}}},"kilogramsPerMeterHour":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"meters":-1,"hours":-1},"symbols":{"kgPerMH":{"text":"kg/(m\xb7h)","placement":"Suffix","space":true}}},"kilogramsPerMeterSecond":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"meters":-1,"seconds":-1},"symbols":{"kgPerMS":{"text":"kg/(m\xb7s)","placement":"Suffix","space":true}}},"kilogramsPerMinute":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"minutes":-1},"symbols":{"kgPerMin":{"text":"kg/min","placement":"Suffix","space":true}}},"kilogramsPerSecond":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"seconds":-1},"symbols":{"kgPerS":{"text":"kg/s","placement":"Suffix","space":true}}},"kilogramsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"squareMeters":-1},"symbols":{"kgPerMSup2":{"text":"kg/m\xb2","placement":"Suffix","space":true}}},"kilojoules":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"joules":1},"symbols":{"kJ":{"text":"kJ","placement":"Suffix","space":true}}},"kilojoulesPerKelvin":{"unitSystem":"Metric","parentUnits":{"kilojoules":1,"kelvinInterval":-1},"symbols":{"kJPerK":{"text":"kJ/K","placement":"Suffix","space":true}}},"kilometers":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"meters":1},"symbols":{"km":{"text":"km","placement":"Suffix","space":true}}},"kilometersPerHour":{"unitSystem":"Metric","parentUnits":{"kilometers":1,"hours":-1},"symbols":{"kmPerH":{"text":"km/h","placement":"Suffix","space":true}}},"kilometersPerSecond":{"unitSystem":"Metric","parentUnits":{"kilometers":1,"seconds":-1},"symbols":{"kmPerS":{"text":"km/s","placement":"Suffix","space":true}}},"kilometersPerSecondSquared":{"unitSystem":"Metric","parentUnits":{"kilometersPerSecond":1,"seconds":-1},"symbols":{"kmPerSSup2":{"text":"km/s\xb2","placement":"Suffix","space":true}}},"kilonewtonMeters":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"meters":1},"symbols":{"kNDashM":{"text":"kN-m","placement":"Suffix","space":true}}},"kilonewtonMetersPerDegree":{"unitSystem":"Metric","parentUnits":{"kilonewtonMeters":1,"degrees":-1},"symbols":{"kNDashMPerDegree":{"text":"kN-m/\xb0","placement":"Suffix","space":true}}},"kilonewtonMetersPerDegreePerMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtonMetersPerDegree":1,"meters":-1},"symbols":{"kNDashMPerDegreePerM":{"text":"kN-m/\xb0/m","placement":"Suffix","space":true}}},"kilonewtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtonMeters":1,"meters":-1},"symbols":{"kNDashMPerM":{"text":"kN-m/m","placement":"Suffix","space":true}}},"kilonewtons":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"newtons":1},"symbols":{"kN":{"text":"kN","placement":"Suffix","space":true}}},"kilonewtonsPerCubicMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"cubicMeters":-1},"symbols":{"kNPerMSup3":{"text":"kN/m\xb3","placement":"Suffix","space":true}}},"kilonewtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"meters":-1},"symbols":{"kNPerM":{"text":"kN/m","placement":"Suffix","space":true}}},"kilonewtonsPerSquareCentimeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"squareCentimeters":-1},"symbols":{"kNPerCmSup2":{"text":"kN/cm\xb2","placement":"Suffix","space":true}}},"kilonewtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"squareMeters":-1},"symbols":{"kNPerMSup2":{"text":"kN/m\xb2","placement":"Suffix","space":true}}},"kilonewtonsPerSquareMillimeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"squareMillimeters":-1},"symbols":{"kNPerMmSup2":{"text":"kN/mm\xb2","placement":"Suffix","space":true}}},"kilopascals":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"pascals":1},"symbols":{"kPa":{"text":"kPa","placement":"Suffix","space":true}}},"kilovoltAmperes":{"unitSystem":"Metric","parentUnits":{"kilovolts":1,"amperes":1},"symbols":{"kVA":{"text":"kVA","placement":"Suffix","space":true}}},"kilovolts":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"volts":1},"symbols":{"kV":{"text":"kV","placement":"Suffix","space":true}}},"kilowattHours":{"unitSystem":"Metric","parentUnits":{"kilowatts":1,"hours":1},"symbols":{"kWh":{"text":"kWh","placement":"Suffix","space":true}}},"kilowatts":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"watts":1},"symbols":{"kW":{"text":"kW","placement":"Suffix","space":true}}},"kipFeet":{"unitSystem":"Imperial","parentUnits":{"kips":1,"feet":1},"symbols":{"kipDashFt":{"text":"kip-ft","placement":"Suffix","space":true}}},"kipFeetPerDegree":{"unitSystem":"Imperial","parentUnits":{"kipFeet":1,"degrees":-1},"symbols":{"kipDashFtPerDegree":{"text":"kip-ft/\xb0","placement":"Suffix","space":true}}},"kipFeetPerDegreePerFoot":{"unitSystem":"Imperial","parentUnits":{"kipFeetPerDegree":1,"feet":-1},"symbols":{"kipDashFtPerDegreePerFt":{"text":"kip-ft/\xb0/ft","placement":"Suffix","space":true}}},"kipFeetPerFoot":{"unitSystem":"Imperial","parentUnits":{"kipFeet":1,"feet":-1},"symbols":{"kipDashFtPerFt":{"text":"kip-ft/ft","placement":"Suffix","space":true}}},"kips":{"unitSystem":"Imperial","parentFactors":{"kilo":1},"parentUnits":{"poundsForce":1},"symbols":{"kip":{"text":"kip","placement":"Suffix","space":true}}},"kipsPerCubicFoot":{"unitSystem":"Imperial","parentUnits":{"kips":1,"cubicFeet":-1},"symbols":{"kipPerFtSup3":{"text":"kip/ft\xb3","placement":"Suffix","space":true}}},"kipsPerCubicInch":{"unitSystem":"Imperial","parentUnits":{"kips":1,"cubicInches":-1},"symbols":{"kipPerInSup3":{"text":"kip/in\xb3","placement":"Suffix","space":true}}},"kipsPerFoot":{"unitSystem":"Imperial","parentUnits":{"kips":1,"feet":-1},"symbols":{"kipPerFt":{"text":"kip/ft","placement":"Suffix","space":true}}},"kipsPerInch":{"unitSystem":"Imperial","parentUnits":{"kips":1,"inches":-1},"symbols":{"kipPerIn":{"text":"kip/in","placement":"Suffix","space":true}}},"kipsPerSquareFoot":{"defaultSymbol":"kipPerFtSup2","unitSystem":"Imperial","parentUnits":{"kips":1,"squareFeet":-1},"symbols":{"kipPerFtSup2":{"text":"kip/ft\xb2","placement":"Suffix","space":true},"ksf":{"text":"ksf","placement":"Suffix","space":true}}},"kipsPerSquareInch":{"defaultSymbol":"kipPerInSup2","unitSystem":"Imperial","parentUnits":{"kips":1,"squareInches":-1},"symbols":{"kipPerInSup2":{"text":"kip/in\xb2","placement":"Suffix","space":true},"ksi":{"text":"ksi","placement":"Suffix","space":true}}},"liters":{"unitSystem":"Metric","parentUnits":{"decimeters":3},"symbols":{"liter":{"text":"L","placement":"Suffix","space":true}}},"litersPerHour":{"unitSystem":"Metric","parentUnits":{"liters":1,"hours":-1},"symbols":{"lPerH":{"text":"L/h","placement":"Suffix","space":true}}},"litersPerMinute":{"defaultSymbol":"lPerMin","unitSystem":"Metric","parentUnits":{"liters":1,"minutes":-1},"symbols":{"lPerMin":{"text":"L/min","placement":"Suffix","space":true},"lpm":{"text":"LPM","placement":"Suffix","space":true}}},"litersPerSecond":{"defaultSymbol":"lPerS","unitSystem":"Metric","parentUnits":{"liters":1,"seconds":-1},"symbols":{"lPerS":{"text":"L/s","placement":"Suffix","space":true},"lps":{"text":"LPS","placement":"Suffix","space":true}}},"litersPerSecondCubicMeter":{"unitSystem":"Metric","parentUnits":{"litersPerSecond":1,"cubicMeters":-1},"symbols":{"lPerSMSup3":{"text":"L/(s\xb7m\xb3)","placement":"Suffix","space":true}}},"litersPerSecondKilowatt":{"unitSystem":"Metric","parentUnits":{"litersPerSecond":1,"kilowatts":-1},"symbols":{"lPerSKw":{"text":"L/(s\xb7kW)","placement":"Suffix","space":true}}},"litersPerSecondSquareMeter":{"defaultSymbol":"lPerSMSup2","unitSystem":"Metric","parentUnits":{"litersPerSecond":1,"squareMeters":-1},"symbols":{"lPerSMSup2":{"text":"L/(s\xb7m\xb2)","placement":"Suffix","space":true},"lpsPerMSup2":{"text":"LPS/m\xb2","placement":"Suffix","space":true}}},"lumens":{"unitSystem":"Metric","parentUnits":{"candelas":1,"steradians":1},"symbols":{"lm":{"text":"lm","placement":"Suffix","space":true}}},"lumensPerWatt":{"unitSystem":"Metric","parentUnits":{"lumens":1,"watts":-1},"symbols":{"lmPerW":{"text":"lm/W","placement":"Suffix","space":true}}},"lux":{"unitSystem":"Metric","parentUnits":{"lumens":1,"squareMeters":-1},"symbols":{"lx":{"text":"lx","placement":"Suffix","space":true}}},"maxwells":{"unitSystem":"Metric","parentFactors":{"ten":-8},"parentUnits":{"webers":1},"symbols":{"mx":{"text":"Mx","placement":"Suffix","space":true}}},"meganewtonMeters":{"unitSystem":"Metric","parentUnits":{"meganewtons":1,"meters":1},"symbols":{"mNDashM":{"text":"MN-m","placement":"Suffix","space":true}}},"meganewtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"meganewtonMeters":1,"meters":-1},"symbols":{"mNDashMPerM":{"text":"MN-m/m","placement":"Suffix","space":true}}},"meganewtons":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"newtons":1},"symbols":{"mN":{"text":"MN","placement":"Suffix","space":true}}},"meganewtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"meganewtons":1,"meters":-1},"symbols":{"mNPerM":{"text":"MN/m","placement":"Suffix","space":true}}},"meganewtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"meganewtons":1,"squareMeters":-1},"symbols":{"mNPerMSup2":{"text":"MN/m\xb2","placement":"Suffix","space":true}}},"megapascals":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"pascals":1},"symbols":{"mPa":{"text":"MPa","placement":"Suffix","space":true}}},"meters":{"defaultSymbol":"meter","unitSystem":"Metric","dimension":"length","symbols":{"meter":{"text":"m","placement":"Suffix","space":true},"metersAndCentimeters":{"inherits":"symbol"}}},"metersPerKilonewton":{"unitSystem":"Metric","parentUnits":{"meters":1,"kilonewtons":-1},"symbols":{"mPerKN":{"text":"m/kN","placement":"Suffix","space":true}}},"metersPerKilonewtonMeter":{"unitSystem":"Metric","parentUnits":{"meters":1,"kilonewtonMeters":-1},"symbols":{"mPerKNDashM":{"text":"m/kN-m","placement":"Suffix","space":true}}},"metersPerSecond":{"unitSystem":"Metric","parentUnits":{"meters":1,"seconds":-1},"symbols":{"mPerS":{"text":"m/s","placement":"Suffix","space":true}}},"metersPerSecondSquared":{"unitSystem":"Metric","parentUnits":{"metersPerSecond":1,"seconds":-1},"symbols":{"mPerSSup2":{"text":"m/s\xb2","placement":"Suffix","space":true}}},"metersToTheFourthPower":{"unitSystem":"Metric","parentUnits":{"meters":4},"symbols":{"mSup4":{"text":"m\u2074","placement":"Suffix","space":true}}},"metersToTheSixthPower":{"unitSystem":"Metric","parentUnits":{"meters":6},"symbols":{"mSup6":{"text":"m\u2076","placement":"Suffix","space":true}}},"mhos":{"unitSystem":"Metric","parentUnits":{"ohms":-1},"symbols":{"mho":{"text":"mho","placement":"Suffix","space":true}}},"microinchesPerInchDegreeFahrenheit":{"unitSystem":"Imperial","parentFactors":{"micro":1},"parentUnits":{"inverseDegreesFahrenheit":1},"symbols":{"uinPerInDegreeF":{"text":"\xb5in/(in\xb7\xb0F)","placement":"Suffix","space":true}}},"micrometersPerMeterDegreeCelsius":{"unitSystem":"Metric","parentFactors":{"micro":1},"parentUnits":{"inverseDegreesCelsius":1},"symbols":{"umPerMDegreeC":{"text":"\xb5m/(m\xb7\xb0C)","placement":"Suffix","space":true}}},"microns":{"unitSystem":"Metric","parentFactors":{"micro":1},"parentUnits":{"meters":1},"symbols":{"micron":{"text":"micron","placement":"Suffix","space":true}}},"miles":{"unitSystem":"Imperial","factor":1760,"parentUnits":{"yards":1},"symbols":{"mi":{"text":"mi","placement":"Suffix","space":true}}},"milesPerHour":{"unitSystem":"Imperial","parentUnits":{"miles":1,"hours":-1},"symbols":{"mph":{"text":"mph","placement":"Suffix","space":true}}},"milesPerSecond":{"unitSystem":"Imperial","parentUnits":{"miles":1,"seconds":-1},"symbols":{"miPerS":{"text":"mi/s","placement":"Suffix","space":true}}},"milesPerSecondSquared":{"unitSystem":"Imperial","parentUnits":{"milesPerSecond":1,"seconds":-1},"symbols":{"miPerSSup2":{"text":"mi/s\xb2","placement":"Suffix","space":true}}},"milliamperes":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"amperes":1},"symbols":{"mA":{"text":"mA","placement":"Suffix","space":true}}},"milligrams":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"grams":1},"symbols":{"mg":{"text":"mg","placement":"Suffix","space":true}}},"millimeters":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"meters":1},"symbols":{"mm":{"text":"mm","placement":"Suffix","space":true}}},"millimetersOfMercury":{"unitSystem":"Metric","factor":133.3224,"parentUnits":{"pascals":1},"symbols":{"mmHg":{"text":"mmHg","placement":"Suffix","space":true}}},"millimetersToTheFourthPower":{"unitSystem":"Metric","parentUnits":{"millimeters":4},"symbols":{"mmSup4":{"text":"mm\u2074","placement":"Suffix","space":true}}},"millimetersToTheSixthPower":{"unitSystem":"Metric","parentUnits":{"millimeters":6},"symbols":{"mmSup6":{"text":"mm\u2076","placement":"Suffix","space":true}}},"milliseconds":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"seconds":1},"symbols":{"ms":{"text":"ms","placement":"Suffix","space":true}}},"millivolts":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"volts":1},"symbols":{"mV":{"text":"mV","placement":"Suffix","space":true}}},"mils":{"unitSystem":"Imperial","parentFactors":{"milli":1},"parentUnits":{"inches":1},"symbols":{"mil":{"text":"mil","placement":"Suffix","space":true}}},"minutes":{"unitSystem":"Metric","factor":60,"parentUnits":{"seconds":1},"symbols":{"min":{"text":"min","placement":"Suffix","space":true}}},"nanograms":{"unitSystem":"Metric","parentFactors":{"nano":1},"parentUnits":{"grams":1},"symbols":{"ng":{"text":"ng","placement":"Suffix","space":true}}},"nanogramsPerPascalSecondSquareMeter":{"unitSystem":"Metric","parentUnits":{"nanograms":1,"seconds":-1,"squareMeters":-1,"pascals":-1},"symbols":{"ngPerPaSMSup2":{"text":"ng/(Pa\xb7s\xb7m\xb2)","placement":"Suffix","space":true}}},"nauticalMiles":{"unitSystem":"Imperial","factor":1852,"parentUnits":{"meters":1},"symbols":{"nauticalMile":{"text":"M","placement":"Suffix","space":true}}},"newtonMeters":{"unitSystem":"Metric","parentUnits":{"newtons":1,"meters":1},"symbols":{"nDashM":{"text":"N-m","placement":"Suffix","space":true}}},"newtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"newtonMeters":1,"meters":-1},"symbols":{"nDashMPerM":{"text":"N-m/m","placement":"Suffix","space":true}}},"newtonSecondsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"seconds":1,"squareMeters":-1},"symbols":{"nSPerMSup2":{"text":"N\xb7s/m\xb2","placement":"Suffix","space":true}}},"newtons":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"metersPerSecondSquared":1},"symbols":{"newton":{"text":"N","placement":"Suffix","space":true}}},"newtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"meters":-1},"symbols":{"nPerM":{"text":"N/m","placement":"Suffix","space":true}}},"newtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"squareMeters":-1},"symbols":{"nPerMSup2":{"text":"N/m\xb2","placement":"Suffix","space":true}}},"newtonsPerSquareMillimeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"squareMillimeters":-1},"symbols":{"nPerMmSup2":{"text":"N/mm\xb2","placement":"Suffix","space":true}}},"oersteds":{"unitSystem":"Metric","factor":250,"parentFactors":{"pi":-1},"parentUnits":{"amperes":1,"meters":-1},"symbols":{"oe":{"text":"Oe","placement":"Suffix","space":true}}},"ohmMeters":{"unitSystem":"Metric","parentUnits":{"ohms":1,"meters":1},"symbols":{"ohmM":{"text":"ohm\xb7m","placement":"Suffix","space":true}}},"ohms":{"defaultSymbol":"omega","unitSystem":"Metric","parentUnits":{"volts":1,"amperes":-1},"symbols":{"ohm":{"text":"ohm","placement":"Suffix","space":true},"omega":{"text":"\u03a9","placement":"Suffix","space":true}}},"ouncesForce":{"unitSystem":"Imperial","factor":0.0625,"parentUnits":{"poundsForce":1},"symbols":{"ozf":{"text":"ozf","placement":"Suffix","space":true}}},"ouncesMass":{"unitSystem":"Imperial","factor":0.0625,"parentUnits":{"poundsMass":1},"symbols":{"oz":{"text":"oz","placement":"Suffix","space":true}}},"pascalSeconds":{"unitSystem":"Metric","parentUnits":{"pascals":1,"seconds":1},"symbols":{"paDashS":{"text":"Pa-s","placement":"Suffix","space":true}}},"pascals":{"unitSystem":"Metric","parentUnits":{"newtonsPerSquareMeter":1},"symbols":{"pa":{"text":"Pa","placement":"Suffix","space":true}}},"pascalsPerMeter":{"unitSystem":"Metric","parentUnits":{"pascals":1,"meters":-1},"symbols":{"paPerM":{"text":"Pa/m","placement":"Suffix","space":true}}},"perMille":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"ratioTo1":1},"symbols":{"perMille":{"text":"\u2030","placement":"Suffix","space":false}}},"percentage":{"unitSystem":"Metric","parentFactors":{"centi":1},"parentUnits":{"ratioTo1":1},"symbols":{"percent":{"text":"%","placement":"Suffix","space":false}}},"poises":{"unitSystem":"Metric","parentUnits":{"grams":1,"centimeters":-1,"seconds":-1},"symbols":{"poise":{"text":"P","placement":"Suffix","space":true}}},"poundForceFeet":{"defaultSymbol":"lbForceDashFt","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"feet":1},"symbols":{"lbForceDashFt":{"text":"lb-ft","placement":"Suffix","space":true},"lbfDashFt":{"text":"lbf-ft","placement":"Suffix","space":true}}},"poundForceFeetPerFoot":{"defaultSymbol":"lbForceDashFtPerFt","unitSystem":"Imperial","parentUnits":{"poundForceFeet":1,"feet":-1},"symbols":{"lbForceDashFtPerFt":{"text":"lb-ft/ft","placement":"Suffix","space":true},"lbfDashFtPerFt":{"text":"lbf-ft/ft","placement":"Suffix","space":true}}},"poundForceSecondsPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"poundsForce":1,"seconds":1,"squareFeet":-1},"symbols":{"lbForceSPerFtSup2":{"text":"lb\xb7s/ft\xb2","placement":"Suffix","space":true}}},"poundMassDegreesFahrenheit":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"fahrenheitInterval":1},"symbols":{"lbMassDegreeF":{"text":"lb\xb7\xb0F","placement":"Suffix","space":true}}},"poundsForce":{"defaultSymbol":"lbForce","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"standardGravity":1},"symbols":{"lbForce":{"text":"lb","placement":"Suffix","space":true},"lbf":{"text":"lbf","placement":"Suffix","space":true}}},"poundsForcePerCubicFoot":{"defaultSymbol":"lbForcePerFtSup3","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"cubicFeet":-1},"symbols":{"lbForcePerFtSup3":{"text":"lb/ft\xb3","placement":"Suffix","space":true},"lbfPerFtSup3":{"text":"lbf/ft\xb3","placement":"Suffix","space":true}}},"poundsForcePerFoot":{"defaultSymbol":"lbForcePerFt","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"feet":-1},"symbols":{"lbForcePerFt":{"text":"lb/ft","placement":"Suffix","space":true},"lbfPerFt":{"text":"lbf/ft","placement":"Suffix","space":true}}},"poundsForcePerSquareFoot":{"defaultSymbol":"lbForcePerFtSup2","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"squareFeet":-1},"symbols":{"lbForcePerFtSup2":{"text":"lb/ft\xb2","placement":"Suffix","space":true},"lbfPerFtSup2":{"text":"lbf/ft\xb2","placement":"Suffix","space":true},"psf":{"text":"psf","placement":"Suffix","space":true}}},"poundsForcePerSquareInch":{"defaultSymbol":"lbForcePerInSup2","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"squareInches":-1},"symbols":{"lbForcePerInSup2":{"text":"lb/in\xb2","placement":"Suffix","space":true},"lbfPerInSup2":{"text":"lbf/in\xb2","placement":"Suffix","space":true},"psi":{"text":"psi","placement":"Suffix","space":true},"psia":{"text":"psia","placement":"Suffix","space":true},"psig":{"text":"psig","placement":"Suffix","space":true}}},"poundsMass":{"defaultSymbol":"lbMass","unitSystem":"Imperial","factor":0.45359237,"parentUnits":{"kilograms":1},"symbols":{"lbMass":{"text":"lb","placement":"Suffix","space":true},"lbm":{"text":"lbm","placement":"Suffix","space":true}}},"poundsMassPerCubicFoot":{"defaultSymbol":"lbMassPerFtSup3","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"cubicFeet":-1},"symbols":{"lbMassPerFtSup3":{"text":"lb/ft\xb3","placement":"Suffix","space":true},"lbmPerFtSup3":{"text":"lbm/ft\xb3","placement":"Suffix","space":true}}},"poundsMassPerCubicInch":{"defaultSymbol":"lbMassPerInSup3","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"cubicInches":-1},"symbols":{"lbMassPerInSup3":{"text":"lb/in\xb3","placement":"Suffix","space":true},"lbmPerInSup3":{"text":"lbm/in\xb3","placement":"Suffix","space":true}}},"poundsMassPerFoot":{"defaultSymbol":"lbMassPerFt","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"feet":-1},"symbols":{"lbMassPerFt":{"text":"lb/ft","placement":"Suffix","space":true},"lbmPerFt":{"text":"lbm/ft","placement":"Suffix","space":true}}},"poundsMassPerFootHour":{"defaultSymbol":"lbMassPerFtDashH","unitSystem":"Imperial","parentUnits":{"poundsMassPerFoot":1,"hours":-1},"symbols":{"lbMassPerFtDashH":{"text":"lb/ft-h","placement":"Suffix","space":true},"lbmPerFtDashH":{"text":"lbm/ft-h","placement":"Suffix","space":true}}},"poundsMassPerFootSecond":{"defaultSymbol":"lbMassPerFtDashS","unitSystem":"Imperial","parentUnits":{"poundsMassPerFoot":1,"seconds":-1},"symbols":{"lbMassPerFtDashS":{"text":"lb/ft-s","placement":"Suffix","space":true},"lbmPerFtDashS":{"text":"lbm/ft-s","placement":"Suffix","space":true}}},"poundsMassPerHour":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"hours":-1},"symbols":{"lbMassPerH":{"text":"lb/h","placement":"Suffix","space":true}}},"poundsMassPerMinute":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"minutes":-1},"symbols":{"lbMassPerMin":{"text":"lb/min","placement":"Suffix","space":true}}},"poundsMassPerPoundDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"poundMassDegreesFahrenheit":-1},"symbols":{"lbMassPerLbDegreeF":{"text":"lb/(lb\xb7\xb0F)","placement":"Suffix","space":true}}},"poundsMassPerSecond":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"seconds":-1},"symbols":{"lbMassPerS":{"text":"lb/s","placement":"Suffix","space":true}}},"poundsMassPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"squareFeet":-1},"symbols":{"lbMassPerFtSup2":{"text":"lb/ft\xb2","placement":"Suffix","space":true}}},"radians":{"unitSystem":"Metric","symbols":{"rad":{"text":"rad","placement":"Suffix","space":true}}},"radiansPerSecond":{"unitSystem":"Metric","parentUnits":{"radians":1,"seconds":-1},"symbols":{"radPerS":{"text":"rad/s","placement":"Suffix","space":true}}},"rankine":{"unitSystem":"Imperial","parentUnit":"rankineInterval","symbols":{"degreeR":{"text":"\xb0R","placement":"Suffix","space":true}}},"rankineInterval":{"defaultSymbol":"degreeRInterval","unitSystem":"Imperial","parentFactors":{"nineFifths":-1},"parentUnits":{"kelvinInterval":1},"symbols":{"degreeRInterval":{"text":"\xb0R","placement":"Suffix","space":true},"deltaDegreeR":{"text":"delta\xb0R","placement":"Suffix","space":true}}},"ratioTo1":{"unitSystem":"Metric","symbols":{"colon1":{"text":":1","placement":"Suffix","space":false}}},"ratioTo10":{"unitSystem":"Metric","parentFactors":{"ten":-1},"parentUnits":{"ratioTo1":1},"symbols":{"colon10":{"text":":10","placement":"Suffix","space":false}}},"ratioTo12":{"unitSystem":"Imperial","parentFactors":{"twelve":-1},"parentUnits":{"ratioTo1":1},"symbols":{"colon12":{"text":":12","placement":"Suffix","space":false}}},"revolutionsPerMinute":{"unitSystem":"Imperial","parentUnits":{"turns":1,"minutes":-1},"symbols":{"rpm":{"text":"RPM","placement":"Suffix","space":true}}},"riseDividedBy1000Millimeters":{"unitSystem":"Metric","parentUnits":{"perMille":1}},"riseDividedBy10Feet":{"unitSystem":"Imperial","parentUnits":{"ratioTo10":1}},"riseDividedBy120Inches":{"unitSystem":"Imperial","parentFactors":{"ten":-1},"parentUnits":{"riseDividedBy12Inches":1}},"riseDividedBy12Inches":{"unitSystem":"Imperial","parentUnits":{"ratioTo12":1}},"riseDividedBy1Foot":{"unitSystem":"Imperial","parentUnits":{"ratioTo1":1}},"seconds":{"unitSystem":"Metric","dimension":"time","symbols":{"second":{"text":"s","placement":"Suffix","space":true}}},"siemens":{"unitSystem":"Metric","parentUnits":{"mhos":1},"symbols":{"siemens":{"text":"S","placement":"Suffix","space":true}}},"slugs":{"unitSystem":"Imperial","parentUnits":{"poundsForce":1,"seconds":2,"feet":-1},"symbols":{"slug":{"text":"slug","placement":"Suffix","space":true}}},"squareCentimeters":{"defaultSymbol":"cmSup2","unitSystem":"Metric","parentUnits":{"centimeters":2},"symbols":{"cmCaret2":{"text":"cm^2","placement":"Suffix","space":true},"cmSup2":{"text":"cm\xb2","placement":"Suffix","space":true}}},"squareCentimetersPerMeter":{"unitSystem":"Metric","parentUnits":{"squareCentimeters":1,"meters":-1},"symbols":{"cmSup2PerM":{"text":"cm\xb2/m","placement":"Suffix","space":true}}},"squareFeet":{"defaultSymbol":"ftSup2","unitSystem":"Imperial","parentUnits":{"feet":2},"symbols":{"ftCaret2":{"text":"ft^2","placement":"Suffix","space":true},"ftSup2":{"text":"ft\xb2","placement":"Suffix","space":true},"sf":{"text":"SF","placement":"Suffix","space":true}}},"squareFeetPer1000BritishThermalUnitsPerHour":{"defaultSymbol":"ftSup2HPerKbtu","unitSystem":"Imperial","factor":0.001,"parentUnits":{"squareFeet":1,"britishThermalUnitsPerHour":-1},"symbols":{"ftSup2HPerKbtu":{"text":"ft\xb2\xb7h/kBtu","placement":"Suffix","space":true},"ftSup2PerMbh":{"text":"ft\xb2/MBh","placement":"Suffix","space":true},"sfHPerKbtu":{"text":"SF\xb7h/kBtu","placement":"Suffix","space":true},"sfPerMbh":{"text":"SF/MBh","placement":"Suffix","space":true}}},"squareFeetPerFoot":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"feet":-1},"symbols":{"ftSup2PerFt":{"text":"ft\xb2/ft","placement":"Suffix","space":true}}},"squareFeetPerKip":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"kips":-1},"symbols":{"ftSup2PerKip":{"text":"ft\xb2/kip","placement":"Suffix","space":true}}},"squareFeetPerKipFoot":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"kipFeet":-1},"symbols":{"ftSup2PerKipDashFt":{"text":"ft\xb2/kip-ft","placement":"Suffix","space":true}}},"squareFeetPerSecond":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"seconds":-1},"symbols":{"ftSup2PerS":{"text":"ft\xb2/s","placement":"Suffix","space":true}}},"squareFeetPerTonOfRefrigeration":{"defaultSymbol":"ftSup2PerTon","unitSystem":"Imperial","parentUnits":{"squareFeet":1,"tonsOfRefrigeration":-1},"symbols":{"ftSup2PerTon":{"text":"ft\xb2/ton","placement":"Suffix","space":true},"sfPerTon":{"text":"SF/ton","placement":"Suffix","space":true}}},"squareHectometers":{"unitSystem":"Metric","parentUnits":{"hectometers":2},"symbols":{"hmSup2":{"text":"hm\xb2","placement":"Suffix","space":true}}},"squareInches":{"defaultSymbol":"inSup2","unitSystem":"Imperial","parentUnits":{"inches":2},"symbols":{"inCaret2":{"text":"in^2","placement":"Suffix","space":true},"inSup2":{"text":"in\xb2","placement":"Suffix","space":true}}},"squareInchesPerFoot":{"unitSystem":"Imperial","parentUnits":{"squareInches":1,"feet":-1},"symbols":{"inSup2PerFt":{"text":"in\xb2/ft","placement":"Suffix","space":true}}},"squareMeterKelvinsPerWatt":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kelvinInterval":1,"watts":-1},"symbols":{"mSup2KPerW":{"text":"(m\xb2\xb7K)/W","placement":"Suffix","space":true}}},"squareMeters":{"defaultSymbol":"mSup2","unitSystem":"Metric","parentUnits":{"meters":2},"symbols":{"mCaret2":{"text":"m^2","placement":"Suffix","space":true},"mSup2":{"text":"m\xb2","placement":"Suffix","space":true}}},"squareMetersPerKilonewton":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kilonewtons":-1},"symbols":{"mSup2PerKN":{"text":"m\xb2/kN","placement":"Suffix","space":true}}},"squareMetersPerKilonewtonMeter":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kilonewtonMeters":-1},"symbols":{"mSup2PerKNDashM":{"text":"m\xb2/kN-m","placement":"Suffix","space":true}}},"squareMetersPerKilowatt":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kilowatts":-1},"symbols":{"mSup2PerKw":{"text":"m\xb2/kW","placement":"Suffix","space":true}}},"squareMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"meters":-1},"symbols":{"mSup2PerM":{"text":"m\xb2/m","placement":"Suffix","space":true}}},"squareMetersPerSecond":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"seconds":-1},"symbols":{"mSup2PerS":{"text":"m\xb2/s","placement":"Suffix","space":true}}},"squareMillimeters":{"defaultSymbol":"mmSup2","unitSystem":"Metric","parentUnits":{"millimeters":2},"symbols":{"mmCaret2":{"text":"mm^2","placement":"Suffix","space":true},"mmSup2":{"text":"mm\xb2","placement":"Suffix","space":true}}},"squareMillimetersPerMeter":{"unitSystem":"Metric","parentUnits":{"squareMillimeters":1,"meters":-1},"symbols":{"mmSup2PerM":{"text":"mm\xb2/m","placement":"Suffix","space":true}}},"squareMils":{"defaultSymbol":"milSup2","unitSystem":"Imperial","parentUnits":{"mils":2},"symbols":{"milCaret2":{"text":"mil^2","placement":"Suffix","space":true},"milSup2":{"text":"mil\xb2","placement":"Suffix","space":true}}},"squareYards":{"unitSystem":"Imperial","parentUnits":{"yards":2},"symbols":{"ydSup2":{"text":"yd\xb2","placement":"Suffix","space":true}}},"standardGravity":{"unitSystem":"Metric","factor":9.80665,"parentUnits":{"metersPerSecondSquared":1},"symbols":{"gravity":{"text":"\ud835\ude28","placement":"Suffix","space":true}}},"steradians":{"unitSystem":"Metric","symbols":{"sr":{"text":"sr","placement":"Suffix","space":true}}},"teslas":{"unitSystem":"Metric","parentUnits":{"webers":1,"meters":-2},"symbols":{"tesla":{"text":"T","placement":"Suffix","space":true}}},"therms":{"unitSystem":"Imperial","factor":100000,"parentUnits":{"britishThermalUnits":1},"symbols":{"therm":{"text":"therm","placement":"Suffix","space":true}}},"thousandBritishThermalUnitsPerHour":{"unitSystem":"Imperial","factor":1000,"parentUnits":{"britishThermalUnitsPerHour":1},"symbols":{"mbh":{"text":"MBH","placement":"Suffix","space":true}}},"tonneForceMeters":{"unitSystem":"Metric","parentUnits":{"tonnesForce":1,"meters":1},"symbols":{"tfDashM":{"text":"Tf-m","placement":"Suffix","space":true}}},"tonneForceMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"tonneForceMeters":1,"meters":-1},"symbols":{"tfDashMPerM":{"text":"Tf-m/m","placement":"Suffix","space":true}}},"tonnes":{"unitSystem":"Metric","factor":1000,"parentUnits":{"kilograms":1},"symbols":{"tonne":{"text":"t","placement":"Suffix","space":true}}},"tonnesForce":{"unitSystem":"Metric","parentUnits":{"tonnes":1,"standardGravity":1},"symbols":{"tf":{"text":"Tf","placement":"Suffix","space":true}}},"tonnesForcePerMeter":{"unitSystem":"Metric","parentUnits":{"tonnesForce":1,"meters":-1},"symbols":{"tfPerM":{"text":"Tf/m","placement":"Suffix","space":true}}},"tonnesForcePerSquareMeter":{"unitSystem":"Metric","parentUnits":{"tonnesForce":1,"squareMeters":-1},"symbols":{"tfPerMSup2":{"text":"Tf/m\xb2","placement":"Suffix","space":true}}},"tonsOfRefrigeration":{"defaultSymbol":"ton","unitSystem":"Imperial","factor":12000,"parentUnits":{"britishThermalUnitsPerHour":1},"symbols":{"ton":{"text":"ton","placement":"Suffix","space":true},"tonOfRefrigeration":{"text":"ton of refrigeration","placement":"Suffix","space":true}}},"turns":{"unitSystem":"Metric","factor":2,"parentFactors":{"pi":1},"parentUnits":{"radians":1},"symbols":{"tr":{"text":"tr","placement":"Suffix","space":true}}},"usGallons":{"unitSystem":"Imperial","factor":231,"parentUnits":{"cubicInches":1},"symbols":{"gal":{"text":"gal","placement":"Suffix","space":true}}},"usGallonsPerHour":{"defaultSymbol":"galPerH","unitSystem":"Imperial","parentUnits":{"usGallons":1,"hours":-1},"symbols":{"galPerH":{"text":"gal/h","placement":"Suffix","space":true},"gph":{"text":"GPH","placement":"Suffix","space":true},"usgph":{"text":"usgph","placement":"Suffix","space":true}}},"usGallonsPerMinute":{"defaultSymbol":"galPerMin","unitSystem":"Imperial","parentUnits":{"usGallons":1,"minutes":-1},"symbols":{"galPerMin":{"text":"gal/min","placement":"Suffix","space":true},"gpm":{"text":"GPM","placement":"Suffix","space":true},"usgpm":{"text":"usgpm","placement":"Suffix","space":true}}},"usSurveyFeet":{"unitSystem":"Imperial","factor":1200,"parentFactors":{"threeThousandNineHundredThirtySeven":-1},"parentUnits":{"meters":1},"symbols":{"usft":{"text":"USft","placement":"Suffix","space":true}}},"usTonnesForce":{"defaultSymbol":"stf","unitSystem":"Imperial","parentUnits":{"usTonnesMass":1,"standardGravity":1},"symbols":{"stf":{"text":"STf","placement":"Suffix","space":true},"tonsf":{"text":"Tonsf","placement":"Suffix","space":true},"usTonnesForceSt":{"text":"ST","placement":"Suffix","space":true},"usTonnesForceT":{"text":"T","placement":"Suffix","space":true},"usTonnesForceTons":{"text":"Tons","placement":"Suffix","space":true}}},"usTonnesMass":{"defaultSymbol":"usTonnesMassSt","unitSystem":"Imperial","factor":2000,"parentUnits":{"poundsMass":1},"symbols":{"usTonnesMassSt":{"text":"ST","placement":"Suffix","space":true},"usTonnesMassT":{"text":"T","placement":"Suffix","space":true},"usTonnesMassTons":{"text":"Tons","placement":"Suffix","space":true}}},"voltAmperes":{"unitSystem":"Metric","parentUnits":{"volts":1,"amperes":1},"symbols":{"vA":{"text":"VA","placement":"Suffix","space":true}}},"volts":{"unitSystem":"Metric","parentUnits":{"watts":1,"amperes":-1},"symbols":{"volt":{"text":"V","placement":"Suffix","space":true}}},"watts":{"unitSystem":"Metric","parentUnits":{"joules":1,"seconds":-1},"symbols":{"watt":{"text":"W","placement":"Suffix","space":true}}},"wattsPerCubicFoot":{"unitSystem":"Imperial","parentUnits":{"watts":1,"cubicFeet":-1},"symbols":{"wPerFtSup3":{"text":"W/ft\xb3","placement":"Suffix","space":true}}},"wattsPerCubicFootPerMinute":{"unitSystem":"Imperial","parentUnits":{"watts":1,"cubicFeetPerMinute":-1},"symbols":{"wMinPerFtSup3":{"text":"W\xb7min/ft\xb3","placement":"Suffix","space":true}}},"wattsPerCubicMeter":{"unitSystem":"Metric","parentUnits":{"watts":1,"cubicMeters":-1},"symbols":{"wPerMSup3":{"text":"W/m\xb3","placement":"Suffix","space":true}}},"wattsPerCubicMeterPerSecond":{"unitSystem":"Metric","parentUnits":{"watts":1,"cubicMetersPerSecond":-1},"symbols":{"wSPerMSup3":{"text":"W\xb7s/m\xb3","placement":"Suffix","space":true}}},"wattsPerFoot":{"unitSystem":"Imperial","parentUnits":{"watts":1,"feet":-1},"symbols":{"wPerFt":{"text":"W/ft","placement":"Suffix","space":true}}},"wattsPerMeter":{"unitSystem":"Metric","parentUnits":{"watts":1,"meters":-1},"symbols":{"wPerM":{"text":"W/m","placement":"Suffix","space":true}}},"wattsPerMeterKelvin":{"unitSystem":"Metric","parentUnits":{"watts":1,"meters":-1,"kelvinInterval":-1},"symbols":{"wPerMK":{"text":"W/(m\xb7K)","placement":"Suffix","space":true}}},"wattsPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"watts":1,"squareFeet":-1},"symbols":{"wPerFtSup2":{"text":"W/ft\xb2","placement":"Suffix","space":true}}},"wattsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"watts":1,"squareMeters":-1},"symbols":{"wPerMSup2":{"text":"W/m\xb2","placement":"Suffix","space":true}}},"wattsPerSquareMeterKelvin":{"unitSystem":"Metric","parentUnits":{"wattsPerSquareMeter":1,"kelvinInterval":-1},"symbols":{"wPerMSup2K":{"text":"W/(m\xb2\xb7K)","placement":"Suffix","space":true}}},"webers":{"unitSystem":"Metric","parentUnits":{"volts":1,"seconds":1},"symbols":{"wb":{"text":"Wb","placement":"Suffix","space":true}}},"yards":{"unitSystem":"Imperial","factor":3,"parentUnits":{"feet":1},"symbols":{"yd":{"text":"yd","placement":"Suffix","space":true}}},"feetFractionalInches":{"defaultSymbol":"feetAndInches","unitSystem":"Imperial","factor":12,"parentUnits":{"inches":1},"symbols":{"feetAndInches":{"inherits":"symbol"},"footSingleQuote":{"text":"\'","placement":"Suffix","space":false},"ft":{"text":"ft","placement":"Suffix","space":true},"lf":{"text":"LF","placement":"Suffix","space":true}}},"fractionalInches":{"defaultSymbol":"in","unitSystem":"Imperial","factor":2.54,"parentUnits":{"centimeters":1},"symbols":{"in":{"text":"in","placement":"Suffix","space":true},"inchDoubleQuote":{"text":"\\"","placement":"Suffix","space":false}}},"metersCentimeters":{"defaultSymbol":"meter","unitSystem":"Metric","dimension":"length","symbols":{"meter":{"text":"m","placement":"Suffix","space":true},"metersAndCentimeters":{"inherits":"symbol"}}},"degreesMinutes":{"defaultSymbol":"degree","unitSystem":"Metric","parentFactors":{"threeHundredSixty":-1},"parentUnits":{"turns":1},"symbols":{"degree":{"text":"\xb0","placement":"Suffix","space":false},"degreesMinutesSeconds":{"inherits":"symbol"},"slopeDegree":{"text":"\xb0","placement":"Suffix","space":false}}},"slopeDegrees":{"defaultSymbol":"degree","unitSystem":"Metric","parentFactors":{"threeHundredSixty":-1},"parentUnits":{"turns":1},"symbols":{"degree":{"text":"\xb0","placement":"Suffix","space":false},"degreesMinutesSeconds":{"inherits":"symbol"},"slopeDegree":{"text":"\xb0","placement":"Suffix","space":false}}},"stationingFeet":{"defaultSymbol":"feetAndInches","unitSystem":"Imperial","factor":12,"parentUnits":{"inches":1},"symbols":{"feetAndInches":{"inherits":"symbol"},"footSingleQuote":{"text":"\'","placement":"Suffix","space":false},"ft":{"text":"ft","placement":"Suffix","space":true},"lf":{"text":"LF","placement":"Suffix","space":true}}},"stationingMeters":{"defaultSymbol":"meter","unitSystem":"Metric","dimension":"length","symbols":{"meter":{"text":"m","placement":"Suffix","space":true},"metersAndCentimeters":{"inherits":"symbol"}}},"stationingSurveyFeet":{"unitSystem":"Imperial","factor":1200,"parentFactors":{"threeThousandNineHundredThirtySeven":-1},"parentUnits":{"meters":1},"symbols":{"usft":{"text":"USft","placement":"Suffix","space":true}}}},"quantity":{"acceleration":{"units":["metersPerSecondSquared","kilometersPerSecondSquared","inchesPerSecondSquared","feetPerSecondSquared","milesPerSecondSquared","standardGravity"]},"angle":{"units":["degrees","radians","gradians","turns"]},"angularLineSpringCoefficient":{"units":["kipFeetPerDegreePerFoot","kilonewtonMetersPerDegreePerMeter"]},"angularPointSpringCoefficient":{"units":["kipFeetPerDegree","kilonewtonMetersPerDegree"]},"angularSpeed":{"units":["radiansPerSecond","revolutionsPerMinute"]},"area":{"units":["squareFeet","squareInches","squareMeters","squareCentimeters","squareHectometers","squareMillimeters","acres","hectares","squareYards","circularMils","squareMils"]},"areaPerLength":{"units":["squareFeetPerFoot","squareCentimetersPerMeter","squareMillimetersPerMeter","squareInchesPerFoot","squareMetersPerMeter"]},"areaPerPower":{"units":["squareFeetPerTonOfRefrigeration","squareMetersPerKilowatt","squareFeetPer1000BritishThermalUnitsPerHour"]},"areaPerTorque":{"units":["squareFeetPerKipFoot","squareMetersPerKilonewtonMeter"]},"colorTemperature":{"units":["kelvin"]},"costPerArea":{"units":["currencyPerSquareFoot","currencyPerSquareMeter"]},"currency":{"units":["currency"]},"density":{"units":["kilogramsPerCubicMeter","poundsMassPerCubicInch","poundsMassPerCubicFoot"]},"diffusivity":{"units":["squareFeetPerSecond","squareMetersPerSecond"]},"dynamicViscosity":{"units":["centipoises","kilogramsPerMeterHour","kilogramsPerMeterSecond","newtonSecondsPerSquareMeter","pascalSeconds","poises","poundForceSecondsPerSquareFoot","poundsMassPerFootHour","poundsMassPerFootSecond"]},"electricCapacitance":{"units":["farads"]},"electricCharge":{"units":["coulombs","ampereHours","ampereSeconds"]},"electricConductance":{"units":["mhos","siemens"]},"electricCurrent":{"units":["amperes","kiloamperes","milliamperes"]},"electricInductance":{"units":["henries"]},"electricPotential":{"units":["volts","kilovolts","millivolts"]},"electricResistance":{"units":["ohms"]},"electricResistivity":{"units":["ohmMeters"]},"energy":{"units":["joules","newtonMeters","kilogramForceMeters","poundForceFeet","kilojoules","britishThermalUnits","calories","kilocalories","kilowattHours","therms","ergs"]},"flow":{"units":["cubicFeetPerMinute","cubicFeetPerHour","cubicMetersPerSecond","cubicMetersPerHour","litersPerHour","litersPerMinute","litersPerSecond","usGallonsPerMinute","usGallonsPerHour"]},"flowPerArea":{"units":["cubicFeetPerMinuteSquareFoot","litersPerSecondSquareMeter"]},"flowPerPower":{"units":["cubicFeetPerMinutePerBritishThermalUnitPerHour","cubicFeetPerMinuteTonOfRefrigeration","cubicMetersPerWattSecond","litersPerSecondKilowatt","squareFeetPerKip","squareMetersPerKilonewton"]},"flowPerVolume":{"units":["cubicFeetPerMinuteCubicFoot","litersPerSecondCubicMeter"]},"force":{"units":["newtons","dekanewtons","kilonewtons","meganewtons","kips","kilogramsForce","tonnesForce","usTonnesForce","poundsForce","dynes","ouncesForce"]},"forceDensity":{"units":["kilonewtonsPerCubicMeter","poundsForcePerCubicFoot","kipsPerCubicInch","kipsPerCubicFoot"]},"forcePerLength":{"units":["newtonsPerMeter","dekanewtonsPerMeter","kilonewtonsPerMeter","meganewtonsPerMeter","kipsPerFoot","kilogramsForcePerMeter","tonnesForcePerMeter","poundsForcePerFoot","kipsPerInch"]},"frequency":{"units":["hertz","cyclesPerSecond"]},"friction":{"units":["pascalsPerMeter","feetOfWater39.2DegreesFahrenheitPer100Feet","inchesOfWater60DegreesFahrenheitPer100Feet"]},"heatCapacity":{"units":["britishThermalUnitsPerDegreeFahrenheit","joulesPerKelvin","kilojoulesPerKelvin"]},"heatTransferCoefficient":{"units":["wattsPerSquareMeterKelvin","britishThermalUnitsPerHourSquareFootDegreeFahrenheit"]},"illuminance":{"units":["lux","footcandles"]},"length":{"units":["meters","decimeters","centimeters","millimeters","kilometers","hectometers","feet","inches","miles","yards","microns","nauticalMiles","mils","usSurveyFeet"]},"lengthPerTorque":{"units":["metersPerKilonewtonMeter","feetPerKipFoot"]},"lightingEfficacy":{"units":["lumensPerWatt"]},"luminance":{"units":["footlamberts","candelasPerSquareFoot","candelasPerSquareMeter"]},"luminousFlux":{"units":["lumens"]},"luminousIntensity":{"units":["candelas"]},"magneticFieldStrength":{"units":["oersteds"]},"magneticFlux":{"units":["webers","maxwells"]},"magneticFluxDensity":{"units":["teslas","gauss","gammas"]},"mass":{"units":["kilograms","tonnes","poundsMass","grams","milligrams","nanograms","grains","usTonnesMass","slugs","ouncesMass"]},"massPerArea":{"units":["kilogramsPerSquareMeter","poundsMassPerSquareFoot"]},"massPerLength":{"units":["kilogramsPerMeter","poundsMassPerFoot"]},"massPerTime":{"units":["poundsMassPerHour","poundsMassPerMinute","poundsMassPerSecond","kilogramsPerHour","kilogramsPerMinute","kilogramsPerSecond"]},"number":{"units":["general","fixed","percentage"]},"permeability":{"units":["nanogramsPerPascalSecondSquareMeter","grainsPerHourSquareFootInchMercury"]},"power":{"units":["watts","kilowatts","britishThermalUnitsPerSecond","britishThermalUnitsPerHour","caloriesPerSecond","kilocaloriesPerSecond","voltAmperes","kilovoltAmperes","horsepower","thousandBritishThermalUnitsPerHour","tonsOfRefrigeration"]},"powerDensity":{"units":["wattsPerCubicFoot","wattsPerCubicMeter","britishThermalUnitsPerHourCubicFoot"]},"powerPerArea":{"units":["wattsPerSquareFoot","wattsPerSquareMeter","britishThermalUnitsPerHourSquareFoot"]},"powerPerFlow":{"units":["wattsPerCubicFootPerMinute","wattsPerCubicMeterPerSecond"]},"powerPerLength":{"units":["wattsPerFoot","wattsPerMeter"]},"pressure":{"units":["pascals","kilopascals","megapascals","poundsForcePerSquareInch","inchesOfMercury32DegreesFahrenheit","millimetersOfMercury","atmospheres","bars","feetOfWater39.2DegreesFahrenheit","inchesOfWater60DegreesFahrenheit"]},"ratio":{"units":["fixed","percentage","perMille","ratioTo1","ratioTo10","ratioTo12","1ToRatio"]},"secondMomentOfArea":{"units":["feetToTheFourthPower","inchesToTheFourthPower","millimetersToTheFourthPower","centimetersToTheFourthPower","metersToTheFourthPower"]},"slope":{"units":["percentage","ratioTo1","ratioTo10","ratioTo12","riseDividedBy12Inches","riseDividedBy1Foot","riseDividedBy1000Millimeters","riseDividedBy120Inches","1ToRatio","riseDividedBy10Feet","perMille"]},"solidAngle":{"units":["steradians"]},"specificEnergy":{"units":["joulesPerGram","joulesPerKilogram","britishThermalUnitsPerPound"]},"specificHeatCapacity":{"units":["joulesPerGramDegreeCelsius","britishThermalUnitsPerPoundDegreeFahrenheit","joulesPerKilogramDegreeCelsius"]},"stress":{"units":["pascals","kilopascals","megapascals","poundsForcePerSquareInch","bars","newtonsPerSquareMeter","dekanewtonsPerSquareMeter","kilonewtonsPerSquareMeter","meganewtonsPerSquareMeter","kipsPerSquareFoot","kilogramsForcePerSquareMeter","tonnesForcePerSquareMeter","poundsForcePerSquareFoot","kipsPerSquareInch","kilonewtonsPerSquareCentimeter","newtonsPerSquareMillimeter","kilonewtonsPerSquareMillimeter"]},"temperature":{"units":["fahrenheit","celsius","kelvin","rankine"]},"temperatureInterval":{"units":["fahrenheitInterval","celsiusInterval","kelvinInterval","rankineInterval"]},"thermalConductivity":{"units":["wattsPerMeterKelvin","britishThermalUnitsPerHourFootDegreeFahrenheit"]},"thermalExpansionCoefficient":{"units":["inverseDegreesFahrenheit","inverseDegreesCelsius","micrometersPerMeterDegreeCelsius","microinchesPerInchDegreeFahrenheit"]},"thermalInsulance":{"units":["hourSquareFootDegreesFahrenheitPerBritishThermalUnit","squareMeterKelvinsPerWatt"]},"time":{"units":["milliseconds","seconds","minutes","hours"]},"torque":{"units":["newtonMeters","dekanewtonMeters","kilonewtonMeters","meganewtonMeters","kipFeet","kilogramForceMeters","tonneForceMeters","poundForceFeet"]},"torquePerLength":{"units":["newtonMetersPerMeter","dekanewtonMetersPerMeter","kilonewtonMetersPerMeter","meganewtonMetersPerMeter","kipFeetPerFoot","kilogramForceMetersPerMeter","tonneForceMetersPerMeter","poundForceFeetPerFoot"]},"velocity":{"units":["feetPerMinute","centimetersPerMinute","inchesPerSecond","metersPerSecond","feetPerSecond","kilometersPerSecond","milesPerSecond","kilometersPerHour","milesPerHour"]},"volume":{"units":["cubicYards","cubicFeet","cubicInches","cubicMeters","cubicCentimeters","cubicMillimeters","liters","usGallons"]},"volumePerForce":{"units":["cubicFeetPerKip","cubicMetersPerKilonewton"]},"warpingCoefficient":{"units":["feetToTheSixthPower","inchesToTheSixthPower","millimetersToTheSixthPower","centimetersToTheSixthPower","metersToTheSixthPower"]}}}');
},"./src/mobile/MobileCallbacks.js":function(e,t,r){"use strict";function n(){this.ios=o.webkit,this.android=o.JSINTERFACE,this.iosSend=function(e,t){return o.webkit.messageHandlers.callbackHandler.postMessage({command:e,data:t})},this.androidSend=o.JSINTERFACE}r.r(t),r.d(t,"MobileCallbacks",function(){return n});var i=r("./src/compat.js"),o=Object(i.getGlobal)(),s=n.prototype;s.animationReady=function(){this.ios?this.iosSend("animationReady"):this.android&&this.androidSend.animationReady()},s.onSelectionChanged=function(e){this.ios?this.iosSend("selectionChanged",e):this.android&&this.androidSend.onSelectionChanged(e)},s.onLongTap=function(e,t){this.ios?this.iosSend("onLongTap",[e,t]):this.android&&this.androidSend.onLongTap(e,t)},s.onSingleTap=function(e,t){this.ios?this.iosSend("onSingleTap",[e,t]):this.android&&this.androidSend.onSingleTap(e,t)},s.onDoubleTap=function(e,t){this.ios?this.iosSend("onDoubleTap",[e,t]):this.android&&this.androidSend.onDoubleTap(e,t)},s.setRTCSession=function(e){this.ios?this.iosSend("setRTCSession",{id:e}):this.android&&this.androidSend.setRTCSessionID(e)},s.putProperties=function(e,t){this.ios?this.iosSend("putProperties",{name:e,value:t}):this.android&&this.androidSend.putProperties(e,t)},s.onPropertyRetrievedSuccess=function(){this.ios?this.iosSend("onPropertyRetrievedSuccess"):this.android&&this.androidSend.onPropertyRetrievedSuccess()},s.onPropertyRetrievedFailOrEmptyProperties=function(){this.ios?this.iosSend("onPropertyRetrievedFailOrEmptyProperties"):this.android&&this.androidSend.onPropertyRetrievedFailOrEmptyProperties()},s.resetAnimationStatus=function(){this.ios?this.iosSend("resetAnimationStatus"):this.android&&this.androidSend.resetAnimationStatus()},s.setPauseUI=function(){this.ios?this.iosSend("setPauseUI"):this.android&&this.androidSend.setToPaused()},s.getDeviceAvailableMemory=function(){return this.ios?this.iosSend("getDeviceAvailableMemory"):this.android?this.androidSend.getDeviceAvailableMemory():void 0},s.onDeviceMemoryInsufficient=function(){return this.ios?this.iosSend("onDeviceMemoryInsufficient"):this.android?this.androidSend.onDeviceMemoryInsufficient():void 0},s.updateAnimationTime=function(e){this.ios?this.iosSend("updateAnimationTime",e):this.android&&this.androidSend.updateAnimationTime(e)},s.setLoadingProgress=function(e,t){this.ios?this.iosSend("setLoadingProgress",{state:e,progress:t}):this.android&&this.androidSend.setLoadingProgress(e,t)},s.objectTreeCreated=function(){this.ios?this.iosSend("objectTreeCreated"):this.android&&this.androidSend.objectTreeCreated()},s.geometryLoaded=function(){this.ios?this.iosSend("geometryLoaded"):this.android&&this.androidSend.geometryLoaded()},s.putSheets=function(e,t){this.ios?this.iosSend("putSheets",[e,t]):this.android&&this.androidSend.putSheets(e,t)},s.putAllSheets=function(e){this.ios?this.iosSend("putAllSheets",e):this.android&&this.androidSend.putAllSheets(e)},s.hideLoadingView=function(){this.android&&this.androidSend.hideLoadingView()},s.instanceTree=function(e){this.ios?this.iosSend("instanceTree",e):this.android&&this.androidSend.instanceTree(e)},s.loadSheetFailed=function(){this.ios?this.iosSend("loadSheetFailed"):this.android&&this.androidSend.loadSheetFailed()},s.sheetSelected=function(e){this.ios?this.iosSend("sheetSelected",e):this.android&&this.androidSend.sheetSelected(e)},"undefined"!=typeof window&&(o.MobileCallbacks=n)},"./src/module-prefix.js":function(e,t,r){(function(t){function r(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:t}function n(e){for(var t=r(),n=e.split("."),i=0;i<n.length;++i)t[n[i]]=t[n[i]]||{},t=t[n[i]];return t}n("Autodesk.Viewing.Private"),n("Autodesk.Viewing.Extensions"),n("Autodesk.Extensions"),n("Autodesk.Viewing.Shaders"),n("Autodesk.Viewing.UI"),n("Autodesk.LMVTK"),Autodesk.Viewing.getGlobal=r,Autodesk.Viewing.AutodeskNamespace=n,r().AutodeskNamespace=n;var i=r().Autodesk.Viewing.Private;i.LMV_WORKER_URL="lmvworker.js",i.ENABLE_DEBUG=i.ENABLE_DEBUG||!1,r().ENABLE_DEBUG=i.ENABLE_DEBUG,i.ENABLE_INLINE_WORKER=!0,e.exports.Autodesk=r().Autodesk}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./src/module-suffix.js":function(e,t,r){"use strict";function n(e){var t=Autodesk.Viewing,r=t.Private,n=t.UI,i=t.Extensions;for(var o in e.av)t[o]=e.av[o];for(var s in e.avp)r[s]=e.avp[s];for(var a in e.avu)n[a]=e.avu[a];for(var l in e.ave)i[l]=e.ave[l];t.getGlobal().THREE=e.THREE,t.getGlobal().LMV=e,r.isRightClick=t.isRightClick,r.isMiddleClick=t.isMiddleClick}r.r(t),r.d(t,"initializeLegacyNamespaces",function(){return n})},"./src/net/LiveReviewClient.js":function(e,t,r){"use strict";function n(e){this.viewer=e,this.setGlobalManager(e.globalManager),this.messageClient=null,this.presenceChannelId=null,this.viewtx=null,this.interceptor=null}function i(e){this.getNames=function(){return["intercept"]},this.getName=function(){return"intercept"},this.activate=function(e){},this.deactivate=function(e){},this.update=function(e){return!1},this.handleSingleClick=function(e,t){return!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return!1},this.handleDoubleTap=function(e,t){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(t){return e.takeControl(),!1},this.handleButtonDown=function(t,r){return e.takeControl(),!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(t){return e.updatePointer(t),!1},this.handleGesture=function(t){return e.takeControl(),!1},this.handleBlur=function(e){return!1},this.handleResize=function(){}}function o(e){function t(e){m=!0;var t=JSON.parse(e.data.msg);w.restoreState(t),p.impl.invalidate(!0,!1,!0),m=!1}function r(e){return Math.round(1e3*e)/1e3}function n(e){for(var t=0;t<e.length;t++)e[t]=r(e[t])}function i(e){var t=e.data.msg;t[1]===!0||v||(t[0]!=h&&(h=t[0],e.data.lastInControl=t[0],f.dispatchEvent({type:"controlChange",channelId:f.channelId,data:e.data})),g=!1,p.navigation.setView((new THREE.Vector3).set(t[2],t[3],t[4]),(new THREE.Vector3).set(t[5],t[6],t[7])),p.navigation.setCameraUpVector((new THREE.Vector3).set(t[8],t[9],t[10])))}function o(t){if(g||v){var r=t.camera,i=[r.position.x,r.position.y,r.position.z,r.target.x,r.target.y,r.target.z,r.up.x,r.up.y,r.up.z];n(i),i.unshift(v),i.unshift(e.getLocalId()),y.sendMessage("camera",i,f.channelId),h!=i[0]&&(h=i[0],f.dispatchEvent({type:"controlChange",channelId:f.channelId,data:{lastInControl:h}}))}}function s(e,t,r){var n=f.getDocument();e&&!b&&(b=n.createElement("div"),b.classList.add("collabPointer")),e&&!x?(p.container.appendChild(b),x=!0):!e&&x&&(p.container.removeChild(b),x=!1),e&&(b.style.left=t-6+"px",b.style.top=r-6+"px")}function a(e){if(!g&&!v){var t=e.data.msg;_.origin.set(t[1],t[2],t[3]),_.direction.set(t[4],t[5],t[6]);var r=_.at(p.getCamera().near);r.project(p.getCamera()),r=p.impl.viewportToClient(r.x,r.y),s(!0,r.x,r.y)}}function u(t){if(g){var r=p.impl.clientToViewport(t.canvasX,t.canvasY);p.impl.viewportToRay(r,_);var i=[_.origin.x,_.origin.y,_.origin.z,_.direction.x,_.direction.y,_.direction.z];n(i),i.unshift(e.getLocalId()),y.sendMessage("pointer",i,f.channelId)}}function d(t){if(!m){var r=w.getState(E);e.sendMessage("state",JSON.stringify(r),f.channelId)}}var h,f=this,p=this.viewer=null,m=!1,g=!1,v=!1,y=this.client=e,_=new THREE.Ray,b=null,x=!1;this.channelId=null;var w,E={seedURN:!1,objectSet:!0,viewport:!1,cutplanes:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}};this.takeControl=function(){g=!0,s(!1)},this.updatePointer=function(e){u(e)},this.connectCamera=function(e){v=!e},this.attach=function(e,r){p&&this.detach(),this.viewer=p=e,w=new l.ViewerState(p),y.addEventListener("cameraChange",i),y.addEventListener("pointerMove",a),p.hasEventListener(c.CAMERA_CHANGE_EVENT,o)||p.addEventListener(c.CAMERA_CHANGE_EVENT,o),r||(y.addEventListener("viewerState",t),p.hasEventListener(c.SELECTION_CHANGED_EVENT,d)||(p.addEventListener(c.SELECTION_CHANGED_EVENT,d),p.addEventListener(c.ISOLATE_EVENT,d),p.addEventListener(c.HIDE_EVENT,d),p.addEventListener(c.SHOW_EVENT,d),p.addEventListener(c.EXPLODE_CHANGE_EVENT,d),p.addEventListener(c.LAYER_VISIBILITY_CHANGED_EVENT,d),p.addEventListener(c.CUTPLANES_CHANGE_EVENT,d)))},this.detach=function(){s(!1),y&&(y.removeEventListener("cameraChange",i),y.removeEventListener("viewerState",t)),p&&(p.removeEventListener(c.CAMERA_CHANGE_EVENT,o),p.removeEventListener(c.SELECTION_CHANGED_EVENT,d),p.removeEventListener(c.ISOLATE_EVENT,d),p.removeEventListener(c.HIDE_EVENT,d),p.removeEventListener(c.SHOW_EVENT,d),p.removeEventListener(c.EXPLODE_CHANGE_EVENT,d),p.removeEventListener(c.LAYER_VISIBILITY_CHANGED_EVENT,d),p.removeEventListener(c.CUTPLANES_CHANGE_EVENT,d),this.viewer=p=null,w=null)}}r.r(t),r.d(t,"LiveReviewClient",function(){return n}),r.d(t,"InteractionInterceptor",function(){return i}),r.d(t,"ViewTransceiver",function(){return o});var s=r("./src/application/EventDispatcher.js"),a=r("./src/net/MessageClient.js"),l=r("./src/application/ViewerState.js"),c=r("./src/application/EventTypes.js"),u=(r.n(c),r("./src/application/GlobalManagerMixin.js"));u.GlobalManagerMixin.call(n.prototype),n.prototype.destroy=function(){this.leaveLiveReviewSession()},n.prototype.joinLiveReviewSession=function(e){this.messageClient||(this.messageClient=a.MessageClient.GetInstance()),this.presenceChannelId||(this.presenceChannelId=this.getWindow().location.host),this.messageClient.isConnected()||this.messageClient.connect(e),this.viewtx||(this.viewtx=new o(this.messageClient),this.viewtx.setGlobalManager(this.globalManager)),this.viewtx.channelId=e,this.viewtx.attach(this.viewer),this.messageClient.join(this.viewtx.channelId),this.interceptor||(this.interceptor=new i(this.viewtx)),this.viewer.toolController.registerTool(this.interceptor),this.viewer.toolController.activateTool(this.interceptor.getName())},n.prototype.leaveLiveReviewSession=function(){this.viewtx&&this.viewtx.detach(this.viewer),this.messageClient&&this.messageClient.disconnect(),this.interceptor&&this.viewer.toolController.deactivateTool(this.interceptor.getName()),this.viewtx=null,this.messageClient=null,this.interceptor=null},o.prototype.constructor=o,s.EventDispatcher.prototype.apply(o.prototype),u.GlobalManagerMixin.call(o.prototype)},"./src/net/MessageClient.js":function(e,t,r){"use strict";function n(e){u.userName=e}function i(e,t){function r(){return u.userName&&u.userName.length?u.userName:g?g.slice(0,5):"Unknown"}function n(e){switch(e.type){case"txt":c(e);break;case"joinok":l(e);break;case"join_error":break;case"sessionId":s.logger.info("Connect successful, your id is: "+e.id),g=e.id;break;case"joined":e.userStatus="joined",i(e);break;case"left":e.userStatus="left",a(e);break;case"camera":case"pointer":break;default:s.logger.log(e)}var t=e.roomId,r={type:m[e.type],data:e,channelId:t};x.dispatchEvent(r)}function i(e){if(e.user.name&&e.user.name.length||(e.user.name=e.user.id.slice(0,5)),e.roomId){var t=b[e.roomId];t?(t.users.push(e.user),s.logger.info(e.user+" joined room "+e.roomId)):s.logger.warn("Channel "+e.roomId+" does not exist for socket "+g)}}function a(e){s.logger.info(e.user+" left room "+e.room);for(var t in b){for(var r=b[t].users,n=-1,i=0;i<r.length;i++)if(r[i].id==e.user){n=i;break}-1!=n&&r.splice(n,1),delete b[t].userSet[e.user]}}function l(e){var t=b[e.roomId];s.logger.info("joined channel "+e.roomId),e.users&&e.users.length?t.users=e.users:t.users=[];for(var n=0;n<t.users.length;n++)t.users[n].name&&t.users[n].name.length||(t.users[n].name=t.users[n].id.slice(0,5));var i=r(),o=Autodesk.Viewing.i18n.translate("you"),a={id:g,name:i+" ("+o+")",isSelf:!0,status:0};t.userSet[g]||(t.users.push(a),t.userSet[g]=a),0!=a.id.indexOf(i)&&x.sendChatMessage("/nick "+i,e.roomId)}function c(e){if(0==e.msg.indexOf("/nick ")){var t=x.getUserById(e.from,e.roomId),r=e.msg.slice(6);if(r.length&&(t.name=r,t.id==g)){var n=Autodesk.Viewing.i18n.translate("you");t.name+=" ("+n+")"}x.dispatchEvent({type:"userListChange",data:e,channelId:e.roomId})}}function d(e){y<v.length?(s.logger.info("Connect failed, trying another server..."),p.disconnect(),p=null,y++,x.connect(x.sessionID)):x.dispatchEvent({type:"socketError",data:e})}function h(e){x.dispatchEvent({type:"socketError",data:e})}function f(e){y=0;for(var t in _)x.join(t)}var p,m={camera:"cameraChange",pointer:"pointerMove",joystick:"joystick",state:"viewerState",txt:"chatReceived",joinok:"userListChange",sessionId:"connectSucceeded",joined:"userListChange",left:"userListChange","private":"privateMessage",join_error:"socketError"},g=null,v=Array.isArray(e)?e:[e],y=0,_={},b={},x=this;this.connect=function(e){return p?void 0:"undefined"!=typeof window.WebSocket?(o||(o="undefined"!=typeof lmv_io?lmv_io:io),this.sessionID=e,p=o.connect(v[y]+"?sessionID="+e,{path:t,forceNew:!0}),p.on("connect",f),p.on("message",n),p.on("connect_error",d),p.on("error",h),!0):!1},this.join=function(e){return p&&p.connected?(delete _[e],b[e]={id:e,users:[],userSet:{}},void p.emit("join",{roomId:e,name:r()})):void(_[e]=1)},this.disconnect=function(){p&&(p.disconnect(),p=null,b={},g=null)},this.sendMessage=function(e,t,r){var n={type:e,from:g,msg:t,roomId:r};p.emit("message",n)},this.sendPrivateMessage=function(e,t){var r={type:"private",target:e,from:g,msg:t};p.emit("message",r)},this.sendChatMessage=function(e,t){var r={type:"txt",from:g,msg:e,roomId:t};p.emit("message",r),n(r)},this.getUserById=function(e,t){for(var r=b[t].users,n=0;n<r.length;n++)if(r[n].id==e)return r[n];return null},this.getLocalId=function(){return g},this.getChannelInfo=function(e){return b[e]},this.isConnected=function(){return p}}r.r(t),r.d(t,"setUserName",function(){return n}),r.d(t,"MessageClient",function(){return i});var o,s=r("./src/logger/Logger.js"),a=r("./src/application/EventDispatcher.js"),l=r("./src/file-loaders/net/endpoints.js"),c=r("./src/envinit.js"),u=(r("./src/compat.js"),{userName:""});i.prototype.constructor=i,a.EventDispatcher.prototype.apply(i.prototype);var d={};i.GetInstance=function(e,t){e||(e=c.EnvironmentConfigurations[Object(l.getEnv)()].LMV.RTC),Array.isArray(e)||(e=[e]);var r=d[e[0]];return r?r:(r=new i(e,t),d[e[0]]=r,r)}},"./src/resource-loader.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e,t,r,n){h.loadScript(t,e).then(function(){r&&r()})["catch"](function(e){n&&n(e)})}r.r(t),r.d(t,"theResourceLoader",function(){return h}),r.d(t,"loadDependency",function(){return s});var a=r("./src/globals.js"),l=r("./src/compat.js"),c=Object(l.getGlobal)(),u=c.document,d=function(){function e(){n(this,e),this.loadPromises={}}return o(e,[{key:"getResourceUrl",value:function(e){return e.indexOf("://")>0?e:Object(a.getResourceUrl)(e)}},{key:"loadPromiseLibrary",value:function(e,t){if(void 0!==c.Promise)return void e();var r=this.getResourceUrl("es6-promise.min.js");this.loadScriptIntoDom(r,e,t)}},{key:"loadScriptIntoDom",value:function(e,t,r){var n=u.createElement("SCRIPT");n.src=e;var i=function(){n.onerror=null,n.onload=null},o=function(t){i(),r&&r(new Error("Error loading script ".concat(e,", with error ").concat(t)))},s=function(){i(),t()};n.onload=s,n.onerror=o,u.head.appendChild(n)}},{key:"loadScript",value:function(e,t){var r=this;if(t&&void 0!==c[t])return Promise.resolve();e=this.getResourceUrl(e);var n=e.toLowerCase();if(n in this.loadPromises)return this.loadPromises[n];var i=Object(a.getScript)(e);return i?this.loadPromises[n]=Promise.resolve():this.loadPromises[n]=new Promise(function(t,n){r.loadScriptIntoDom(e,t,n)}),this.loadPromises[n]}},{key:"loadCSS",value:function(e){e=this.getResourceUrl(e);var t=e.toLowerCase();if(e in this.loadPromises)return this.loadPromises[t];var r=this._getLink(e);return r?this.loadPromises[t]=Promise.resolve():this.loadPromises[t]=new Promise(function(e,t){var r=u.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href",href),r.onload=e,r.onerror=t,u.head.appendChild(r)}),this.loadPromises[t]}},{key:"_getLink",value:function(e){for(var t=u.getElementsByTagName("link"),r=0,n=t.length;n>r;r++)if(t[r].href===e)return t[r];return null}}]),e}(),h=new d;Object.freeze(h)},"./src/tools/DefaultHandler.js":function(e,t,r){"use strict";function n(e,t,r){this.clickConfig=null,this.getNames=function(){return["default"]},this.getName=function(){return this.getNames()[0]},this.setClickBehavior=function(e){this.clickConfig=e},this.getClickBehavior=function(){return this.clickConfig},this.activate=function(e){},this.deactivate=function(e){},this.handleAction=function(t,n){for(var i=0;i<t.length;++i)switch(t[i]){case"selectOnly":e.selector&&n&&e.selector.setSelection([n.dbId],n.model);break;case"deselectAll":e.selector&&e.selector.setSelection([]);break;case"selectToggle":e.selector&&n&&e.selector.toggleSelection(n.dbId,n.model);break;case"isolate":n&&e.isolate(n.dbId);break;case"showAll":e.showAll();break;case"setCOI":n&&n.intersectPoint&&(r.setPivotPoint(n.intersectPoint,!0,!0),r.pivotActive(!0,!0));break;case"hide":n&&e.hide(n.dbId);break;case"show":n&&e.show(n.dbId);break;case"toggleVisibility":n&&e.toggleVisibility(n.dbId);break;case"focus":e.selector&&(n?e.selector.setSelection([n.dbId],n.model):e.selector.setSelection([]),r.fitToView())}},this.handleSingleClick=function(t,n){var i=t.ctrlKey||t.metaKey,o=t.shiftKey,s=t.altKey;if(0===n){var a=e.clientToViewport(t.canvasX,t.canvasY),l=e.hitTestViewport(a,!1),c="click";i&&(c+="Ctrl"),o&&(c+="Shift"),s&&(c+="Alt");var u=l?"onObject":"offObject";if(this.clickConfig&&this.clickConfig[c]&&this.clickConfig[c][u])return this.handleAction(this.clickConfig[c][u],l),!0}else if(1===n&&o&&!s&&!i){var a=e.clientToViewport(t.canvasX,t.canvasY),l=e.hitTestViewport(a,!1);if(l&&l.intersectPoint)return r.setPivotPoint(l.intersectPoint,!0,!0),r.pivotActive(!0,!0),!0}return!1},this.handleDoubleClick=function(n,i){if(e.selector&&0===i){var o=e.clientToViewport(n.canvasX,n.canvasY),s=e.hitTestViewport(o,!1);return s?e.selector.setSelection([s.dbId],s.model):e.selector.clearSelection(),r.fitToView(),!0}return 1===i?(t.fitBounds(!1,r.getBoundingBox(!0)),t.setPivotSetFlag(!1),!0):!1},this.handleSingleTap=function(r){if(r.clientX=r.pointers[0].clientX,r.clientY=r.pointers[0].clientY,e.api.triggerSingleTapCallback(r),r.hasOwnProperty("pointers")&&2===r.pointers.length)return t.setRequestHomeView(!0),!0;if(e.selector){var n=e.clientToViewport(r.canvasX,r.canvasY),i=e.hitTestViewport(n,!1);return i?(e.selector.setSelection([i.dbId],i.model),e.api.triggerSelectionChanged([i.dbId])):(e.selector.clearSelection(),e.api.triggerSelectionChanged(null)),!0}return!1},this.handleDoubleTap=function(t){t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerDoubleTapCallback(t);var n=this.handleSingleTap(t,0);return r.fitToView(),n},this.handlePressHold=function(t){return"press"===t.type?(t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerContextMenu(t)):!1},this.handleGesture=function(t){return t.type.includes("swipe")?(t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerSwipeCallback(t)):!1}}r.r(t),r.d(t,"DefaultHandler",function(){return n});var i=r("./thirdparty/three.js/three.js");r.n(i)},"./src/tools/FovTool.js":function(e,t,r){"use strict";function n(e){function t(e){return 0>e&&e>-3?-3:e>0&&3>e?3:e}var r=.001,n=1e-5,o=-1,s=.6,a=100,l=e.navigation,c=l.getCamera(),u=["fov"],d=!1,h=0,f=null,p=null,m=!1,g=0,v=-5,y=-1,_=0,b=2,x=v,w=new i.Vector3,E=new i.Vector3,S=new i.Vector3,A=null;this.getNames=function(){return u},this.getName=function(){return u[0]},this.activate=function(e){g=0},this.deactivate=function(e){x=v},this.getCursor=function(){return 0!==g&&x===v?null:"url(data:image/x-icon;base64,AAACAAEAGBgAAAAAAACICQAAFgAAACgAAAAYAAAAMAAAAAEAIAAAAAAAYAkAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAACEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAwMD/yEhIf8AAABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAGknJyf/goKC/8/Pz/8aGhr/AAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAABTFBQU/2lpaf/MzMz///////////+Wlpb/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAOAAAAKFTU1P/t7e3////////////8PDw////////////AQEB/wAAAAEAAAAAAAAAFAAAAH0KCgr/AAAAYwAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAjCwsL/6Ghof/t7e3///////Dw8P9MTEz/LS0t//Pz8///////Ghoa/wAAABoAAAANDQ0N/319ff+rq6v/Y2Nj/wAAAK8AAABGAAAA////////////AAAA/wAAAF0hISH/jIyM////////////sLCw/xEREf8AAACHAAAArKysrP//////V1dX/wAAAFcAAABSUlJS//f39///////8PDw/6+vr/86Ojr/LS0t////////////FRUV/1xcXP/Gxsb/+Pj4//Hx8f9MTEz/AAAAsAAAAEcAAAAAAAAAZ2dnZ///////pKSk/wAAAKQAAACtra2t///////////////////////m5ub/kZGR/wAAAP8AAAD/q6ur//Hx8f//////vb29/x0dHf8AAACIAAAAAAAAAAAAAAAAAAAAOjo6Ov//////5+fn/wAAAOcAAADd3d3d////////////////////////////+/v7/9bW1v/i4uL//v7+//Pz8/9hYWH/AAAAvQAAAFQAAAAAAAAAAAAAAAAAAAAAAAAAJycnJ//6+vr//////wMDA/8AAADv7+/v/////////////////////////////////////////////////7y8vP8ODg7/AAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJiYmJv/6+vr//////wkJCf8AAADv7+/v//////////////////////////////////f39//9/f3//////+np6f+UlJT/GBgY/wAAAH0AAAACAAAAAAAAAAAAAAAAAAAAKSkpKf///////v7+/w0NDf8AAADd3d3d////////////////////////////29vb/39/f/+Xl5f/5+fn////////////5ubm/1RUVP8CAgL/AAAAPwAAAAAAAAAAAAAAOTk5Of//////8PDw/wgICP8AAAChoaGh/////////////////+np6f+YmJj/QkJC/wAAAP8AAAD/UFBQ/7e3t//39/f///////////+oqKj/EBAQ/wAAAIgAAAAAAAAAZ2dnZ///////29vb/wEBAf8AAAA4NTU1/9zc3P/t7e3/tbW1/01NTf8AAACYAAAA////////////AwMD/wsLC/9oaGj/y8vL////////////8fHx/zg4OP8AAACWAAAApaWlpf//////n5+f/wAAAJ8AAAAAAAAAczg4OP9LS0v/EhIS/wAAAE0AAAAAAAAA////////////FRUV/wAAABUAAABoJSUl/4GBgf/i4uL///////////9+fn7/Pz8///b29v//////SkpK/wAAAEoAAAAAAAAAAAAAADgAAABLAAAAEgAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAJQAAAIE8PDz/np6e//z8/P/////////////////8/Pz/CQkJ/wAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAA8DAwM/09PT/+7u7v///////////+QkJD/AAAAkwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////Dw8P/wAAAA8AAAAAAAAAAAAAAAAAAAAAAAAADAAAAFIYGBj/aGho/729vf8WFhb/AAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////FRUV/wAAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAQEB/w8PD/8AAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////DAwM/wAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8x/h/nO/4fw1D+HwFy/h4BRu4YAHOGEABkAAAAXAAAIFwAAOBnAAHgIAAD4GUAAOB4AABgXAAAIGMAAABtggAAVMYYAHT+HgE7/g8BcP4Pw2/+D+dc/h//XP///2c=), auto"},this.getMotionDelta=function(e){var t=E.x-w.x,n=E.y-w.y,i=E.z-w.z;Math.abs(t)<r&&(t=0),Math.abs(n)<r&&(n=0),Math.abs(i)<r&&(i=0),e.set(t,n,i)},this.stepMotionDelta=function(e,t){t?(w.x+=e.x*s,w.y+=e.y*s,w.z+=e.z*s):w.copy(E)},this.getAccumulatedWheelDelta=function(){var e=Date.now(),r=0;return p&&e-p>a?(r=t(h),h=0,f=null,p=null,m=!1):f&&e-f>a&&(m?Math.abs(h)>=3&&(r=h,h=0):(r=t(h),m=!0,h=0)),r},this.update=function(){var e=!1,t=x>v;if(x>v){this.controller.setIsLocked(!0),this.getMotionDelta(S);var r=S.x,i=S.y,s=S.z;if(0!==r||0!==i||0!==s)if(t=!0,x>=_)i=-i,s=Math.abs(r)>Math.abs(i)?r:i,0!==s&&(s*=o,l.setVerticalFov(l.getVerticalFov()*(1+s),!0));else{var a=this.getAccumulatedWheelDelta()/3;0!==a&&l.setFocalLength(l.getFocalLength()+a,!0)}this.stepMotionDelta(S,!0),x===y&&Math.abs(s)<n&&(this.interactionEnd(y),e=!0)}return t?this.utilities.pivotActive(l.getPivotSetFlag(),!0):this.utilities.pivotUpdate(),!d&&(e||x>v)&&(x>y&&w.copy(E),x=v,this.controller.setIsLocked(!1)),c.dirty},this.interactionStart=function(e,t){(t||e>x)&&(x=e,d=!0),l.toPerspective()},this.interactionEnd=function(e){e===x&&(e!==y&&this.utilities.pivotActive(!1),d=!1)},this.handleWheelInput=function(e){if(x>y)return!1;l.getReverseZoomDirection()&&(e*=-1),E.z+=e,h+=e;var t=Date.now();return f||(f=t),p=t,0!=e&&this.interactionStart(y),!0},this.handleGesture=function(e){switch(e.type){case"dragstart":return this.handleButtonDown(e,0);case"dragmove":return this.handleMouseMove(e);case"dragend":return this.handleButtonUp(e,0);case"drag3start":return A="drag",this.handleButtonDown(e,0);case"drag3move":return"drag"===A?this.handleMouseMove(e):!1;case"drag3end":return"drag"===A&&this.handleButtonUp(e,0),A=null,!1}return!1},this.handleButtonDown=function(e,t){return g+=1<<t,t!==b?(w.x=.5*(e.normalizedX+1),w.y=1-.5*(e.normalizedY+1),E.copy(w),this.interactionStart(t),!0):!1},this.handleButtonUp=function(e,t){return g-=1<<t,t!==b?(E.x=.5*(e.normalizedX+1),E.y=1-.5*(e.normalizedY+1),this.interactionEnd(t),!0):!1},this.handleMouseMove=function(e){return E.x=.5*(e.normalizedX+1),E.y=1-.5*(e.normalizedY+1),x>y},this.handleBlur=function(e){return this.interactionEnd(x),!1}}r.r(t),r.d(t,"FovTool",function(){return n});var i=r("./thirdparty/three.js/three.js");r.n(i)},"./src/tools/GestureHandler.js":function(e,t,r){"use strict";function n(){if(!a.singletap){var e=a;e.singletap=[o.Tap,{event:"singletap",threshold:7,time:400}],e.singletap2=[o.Tap,{event:"singletap2",pointers:2,threshold:7,time:400}],e.press=[o.Press,{event:"press",time:500,threshold:50}],e.doubletap=[o.Tap,{event:"doubletap",taps:2,interval:300,threshold:6,posThreshold:30}],e.doubletap2=[o.Tap,{event:"doubletap2",pointers:2,taps:2,interval:300,threshold:6,posThreshold:40}],e.swipe=[o.Swipe,{event:"swipe",pointers:1,threshold:200,velocity:1.7}],e.drag=[o.Pan,{event:"drag",pointers:1}],e.drag3=[o.Pan,{event:"drag3",pointers:3,threshold:15}],e.pan=[o.Pan,{event:"pan",pointers:2,threshold:20}],e.pinch=[o.Pinch,{event:"pinch",pointers:2,enable:!0,threshold:.05}],e.rotate=[o.Rotate,{event:"rotate",pointers:2,enable:!0,threshold:7}]}}function i(e){var t=e.navigation,r=["gestures"],n=this,i=!0,l=!1,c=!0,u=null,d=!1,h=Object(s.isTouchDevice)();t.setIsTouchDevice(h),h&&(u=new o.Manager(e.canvasWrap,{recognizers:[a.drag,a.doubletap,a.doubletap2,a.singletap,a.singletap2,a.press,a.drag3,a.swipe,a.pan,a.pinch,a.rotate],handlePointerEventMouse:!1,inputClass:s.isIE11?o.PointerEventInput:o.TouchInput}),u.get("pinch").recognizeWith([u.get("drag")]),e.canvasWrap.addEventListener("touchstart",this.onTouchStart,!1)),this.onTouchStart=function(e){e.preventDefault()},this.getNames=function(){return r},this.getName=function(){return r[0]},this.isActive=function(){return d},this.__clientToCanvasCoords=function(t){var r,n,i=e.impl.getCanvasBoundingClientRect(),o=i.width,s=i.height;t.hasOwnProperty("center")?(r=t.center.x-i.left,n=t.center.y-i.top):(r=t.pointers[0].clientX-i.left,n=t.pointers[0].clientY-i.top),t.canvasX=r,t.canvasY=n,t.normalizedX=r/o*2-1,t.normalizedY=(s-n)/s*2-1},this.distributeGesture=function(e){n.__clientToCanvasCoords(e),n.controller.distributeEvent("handleGesture",e)&&e.preventDefault()},this.onSingleTap=function(e){n.__clientToCanvasCoords(e),n.controller.distributeEvent("handleSingleTap",e)&&e.preventDefault()},this.onDoubleTap=function(e){n.__clientToCanvasCoords(e),n.controller.distributeEvent("handleDoubleTap",e)&&e.preventDefault()},this.onPressHold=function(e){n.__clientToCanvasCoords(e),n.controller.distributeEvent("handlePressHold",e)&&e.preventDefault()},this.onHammerInput=function(e){n.setMouseDisabledWhenTouching(e)},this.setMouseDisabledWhenTouching=function(e){e.isFirst&&!l?(i=n.controller.enableMouseButtons(!1),l=!0):e.isFinal&&setTimeout(function(){n.controller.enableMouseButtons(i),l=!1},10)},this.activate=function(e){u&&!d&&(u.on("dragstart dragmove dragend",this.distributeGesture),u.on("singletap",this.onSingleTap),u.on("singletap2",this.onSingleTap),u.on("doubletap",this.onDoubleTap),u.on("doubletap2",this.onDoubleTap),u.on("press pressup",this.onPressHold),u.on("drag3start drag3move drag3end",this.distributeGesture),u.on("swipeleft swiperight swipeup swipedown",this.distributeGesture),c&&(u.on("panstart panmove panend",this.distributeGesture),u.on("pinchstart pinchmove pinchend",this.distributeGesture),u.on("rotatestart rotatemove rotateend",this.distributeGesture)),u.on("hammer.input",this.onHammerInput),u.get("doubletap2").recognizeWith("doubletap"),u.get("singletap2").recognizeWith("singletap"),u.get("singletap").requireFailure("doubletap"),u.get("swipe").recognizeWith("drag")),d=!0},this.deactivate=function(e){u&&d&&(u.off("dragstart dragmove dragend",this.distributeGesture),u.off("singletap",this.onSingleTap),u.off("singletap2",this.onSingleTap),u.off("doubletap",this.onDoubleTap),u.off("doubletap2",this.onDoubleTap),u.off("press pressup",this.onPressHold),u.off("drag3start drag3move drag3end",this.distributeGesture),u.off("swipeleft swiperight swipeup swipedown",this.distributeGesture),c&&(u.off("panstart panmove panend",this.distributeGesture),u.off("pinchstart pinchmove pinchend",this.distributeGesture),u.off("rotatestart rotatemove rotateend",this.distributeGesture)),u.off("hammer.input",this.onHammerInput)),d=!1},this.update=function(){return!1},this.handleBlur=function(e){return!1},this.disableTwoFingerSwipe=function(){c=!1,u&&(u.remove(o.Pan),u.remove(o.Pinch),u.remove(o.Rotate),u.off("panstart panmove panend",this.distributeGesture),u.off("pinchstart pinchmove pinchend",this.distributeGesture),u.off("rotatestart rotatemove rotateend",this.distributeGesture))},this.setGestureParameter=function(e,t,r){var n=u&&u.get(e);return n?(n.options[t]=r,!0):!1},this.restoreGestureParameterDefault=function(e,t){var r=u&&u.get(e);if(!r)return!1;var n=a[e][1];return r.options[t]=n.hasOwnProperty(t)?n[t]:r.defaults[t],!0}}r.r(t),r.d(t,"GestureRecognizers",function(){return a}),r.d(t,"GestureHandler",function(){return i});var o,s=r("./src/compat.js");Object(s.isNodeJS)()||(o=r("./thirdparty/hammer/hammer.js"));var a={};o&&n()},"./src/tools/HotGestureTool.js":function(e,t,r){"use strict";function n(e){var t=["hottouch"],r={SHIFT:0,ALT:0,CONTROL:0},n=null,i=null,o=!1,s=!1,a=null,l={SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,LCOMMAND:91,RCOMMAND:93,COMMANDMOZ:224},c="worldup",u="fov";this.active=!1,this.getNames=function(){return t},this.getName=function(){return t[0]},this.activate=function(e){this.active=!0},this.deactivate=function(e){this.active=!1},this.isActive=function(){return this.active},this.__checkStart=function(){a&&(this.controller.distributeEvent("handleGesture",a),a=null)},this.update=function(){if(this.controller.getIsLocked())return!1;var t=e.getActiveNavigationTool(),r=o===!1&&s===!0,a=o===!0&&s===!1;if(r||a){var l=r?c:u;if(t===l)return!1;if(t===n)return e.setActiveNavigationTool(l),n=l,this.__checkStart(),!1;i=t,e.setActiveNavigationTool(l),n=l,this.__checkStart()}else n&&(e.setActiveNavigationTool(i),n=null,i=null);return!1},this.resetKeys=function(){r.SHIFT=0,r.CONTROL=0,r.ALT=0},this.updateModifierState=function(e){r.CONTROL=e.ctrlKey?1:0,r.SHIFT=e.shiftKey?1:0,r.ALT=e.altKey?1:0},this.handleGesture=function(t){if(t===a)return!1;switch(t.type){case"drag3start":e.navigation.isActionEnabled("fov")&&(a=t,o=!0);break;case"drag3move":break;case"drag3end":o=!1;break;case"rotatestart":e.navigation.isActionEnabled("roll")&&(a=t,s=!0);break;case"rotatemove":break;case"rotateend":s=!1}return!1},this.handleKeyDown=function(e,t){switch(this.updateModifierState(e),t){case l.SHIFT:r.SHIFT=1;break;case l.CONTROL:
r.CONTROL=1;break;case l.ALT:r.ALT=1}return!1},this.handleKeyUp=function(e,t){switch(this.updateModifierState(e),t){case l.SHIFT:r.SHIFT=0;break;case l.CONTROL:r.CONTROL=0;break;case l.ALT:r.ALT=0}return!1},this.handleButtonDown=function(e,t){return this.updateModifierState(e),!1},this.handleButtonUp=function(e,t){return this.updateModifierState(e),!1},this.handleMouseMove=function(e){return this.updateModifierState(e),!1},this.handleBlur=function(e){return this.resetKeys(),!1}}r.r(t),r.d(t,"HotGestureTool",function(){return n})},"./src/tools/HotkeyManager.js":function(e,t,r){"use strict";function n(){function e(){return p}function t(){return p[0]}function r(e,t){return e-t}function n(e,t,n){var i=u.some(function(t){return t.id===e});if(i)return!1;for(var o=0;o<t.length;o++)u.push({id:e,keys:t[o].keycodes.sort(r).join(),onPress:t[o].onPress,onRelease:t[o].onRelease,options:n||{}});return!0}function i(e){for(var t=!1,r=u.length-1;r>=0;r--)u[r].id===e&&(u.splice(r,1),t=!0);return t}function o(){var e,t,r=d.join();for(t=0;t<f.length;)e=f[t],e.keys===r?f.splice(t,1):t++;for(t=0;t<h.length;)e=h[t],e.keys!==r?h.splice(t,1):t++}function s(e,t){if(-1===d.indexOf(t)){for(var r=d.join(),n=d.slice(0),i=0;i<d.length&&d[i]<t;)i++;d.splice(i,0,t);var s=d.join(),a=d.slice(0);o();var l,c=[],p=[];for(i=u.length-1;i>=0;i--)l=u[i],l.keys===r&&l.onRelease?c.unshift(l):l.keys===s&&l.onPress&&p.unshift(l);for(i=c.length-1;i>=0&&(l=c[i],!l.onRelease(n));i--)l.options.tryUntilSuccess&&f.unshift(l);for(i=p.length-1;i>=0&&(l=p[i],!l.onPress(a));i--)l.options.tryUntilSuccess&&h.unshift(l)}}function a(e,t){var r=d.join(),n=d.slice(0),i=d.indexOf(t);i>-1&&d.splice(i,1);var s=d.join(),a=d.slice(0);o();var l,c=[],p=[];for(i=u.length-1;i>=0;i--)l=u[i],l.keys===r&&l.onRelease?c.unshift(l):l.keys===s&&l.onPress&&p.unshift(l);for(i=c.length-1;i>=0&&(l=c[i],!l.onRelease(n));i--)l.options.tryUntilSuccess&&f.unshift(l);for(i=p.length-1;i>=0&&(l=p[i],!l.onPress(a));i--)l.options.tryUntilSuccess&&h.unshift(l)}function l(){var e,t;for(t=0;t<f.length;)e=f[t],e.onRelease(e.keys.split())===!0?f.splice(t,1):t++;for(t=0;t<h.length;)e=h[t],e.onPress(e.keys.split())===!0?h.splice(t,1):t++;return!1}function c(){for(var e=d.length-1;e>=0;e--)a(null,d[e])}var u=[],d=[],h=[],f=[],p=["hotkeys"];return{pushHotkeys:n,popHotkeys:i,handleKeyDown:s,handleKeyUp:a,handleBlur:c,getName:t,getNames:e,activate:function(){},deactivate:function(){},update:l}}r.r(t),r.d(t,"HotkeyManager",function(){return n});r("./src/tools/KeyCode.js")},"./src/tools/KeyCode.js":function(e,t,r){"use strict";r.r(t),r.d(t,"KeyCode",function(){return n});var n={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,SEMICOLONMOZ:59,EQUALSMOZ:61,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,LCOMMAND:91,RCOMMAND:93,PLUS:107,PLUSMOZ:171,DASHMOZ:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,DASHMOZNEW:173,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222,COMMANDMOZ:224}},"./src/tools/Navigation.js":function(e,t,r){"use strict";function n(e){var t=6.88,r=100,n=1e-6,o=1e-5;this.__options={dollyToPivot:!1,orbitPastPoles:!0,reverseDolly:!1,reverseHorizontalLook:!1,reverseVerticalLook:!1,useLeftHandedInput:!1,usePivotAlways:!1,lockNavigation:!1},this.__lockSettings={orbit:!1,pan:!1,zoom:!1,roll:!1,fov:!1,gotoview:!1,walk:!1},this.FIT_TO_VIEW_VERTICAL_MARGIN=.05,this.FIT_TO_VIEW_VERTICAL_OFFSET=0,this.FIT_TO_VIEW_HORIZONTAL_MARGIN=.05,this.FIT_TO_VIEW_HORIZONTAL_OFFSET=0,this.__pivotIsSetFlag=!1,this.__fitToViewRequested=!1,this.__homeViewRequested=!1,this.__transitionActive=!1,this.__destinationView=null,this.__is2D=!1,this.__isTouchDevice=!1,this.__kEpsilon=n,this.__minDistance=o;var s=void 0,a=void 0,l=2,c=200,u=null,d={left:0,top:0,width:1,height:1},h=Number.MAX_VALUE;this.uninitialize=function(){this.setCamera(null)},this.setMinimumLineWidth=function(e){h=e||Number.MAX_VALUE},this.setCamera=function(e){e!==u&&(u=e,e&&(e.hasOwnProperty("target")||(e.target=new i.Vector3(0,0,0)),e.hasOwnProperty("pivot")||(e.pivot=new i.Vector3(0,0,0)),e.worldup=e.up.clone(),e.dirty=!0))},this.getCamera=function(){return u},this.setScreenViewport=function(e){d=e},this.getScreenViewport=function(){return d},this.__setUp=function(e){if(e&&u){var t=e.clone().normalize(),r=t.sub(u.worldup);if(0!==r.lengthSq())return u.worldup.copy(e).normalize(),u.dirty=!0,!0}return!1},this.__getUp=function(){return u?u.worldup:new i.Vector3(0,1,0)},this.setView=function(e,t){u&&e&&t&&(u.position.copy(e),u.target.copy(t),u.dirty=!0)},this.orientCameraUp=function(){u&&this.isActionEnabled("roll")&&(u.up.copy(this.getAlignedUpVector()),u.dirty=!0)},this.getPivotPoint=function(){return u?u.pivot.clone():new i.Vector3(0,0,0)},this.setPivotPoint=function(e){u&&e&&u.pivot.copy(e)},this.getPosition=function(){return u?u.position.clone():new i.Vector3(0,0,1)},this.setPosition=function(e){u&&e&&(u.position.copy(e),u.dirty=!0)},this.setTarget=function(e){u&&e&&(u.target.copy(e),u.dirty=!0)},this.getTarget=function(){return u?u.target.clone():new i.Vector3(0,0,0)},this.getEyeVector=function(){return u?u.target.clone().sub(u.position):new i.Vector3(0,0,-1)},this.getEyeToCenterOfBoundsVec=function(e){return u?e.center().sub(u.position):new i.Vector3(0,0,-1)},this.getFovMin=function(){return t},this.getFovMax=function(){return r},this.setZoomInLimitFactor=function(e){c=e},this.getZoomInLimitFactor=function(){return c},this.setZoomOutLimitFactor=function(e){l=e},this.getZoomOutLimitFactor=function(){return l},this.isPointVisible=function(e){var t=(new i.Frustum).setFromMatrix(u.projectionMatrix.clone().multiply(u.matrixWorldInverse));return t.containsPoint(e)},this.setVerticalFov=function(e,o){if((!u||u.isPerspective)&&(t>e?e=t:e>r&&(e=r),u&&this.isActionEnabled("fov"))){if(Math.abs(u.fov-e)<=n)return;if(o){var s=this.__pivotIsSetFlag&&this.isPointVisible(this.getPivotPoint()),a=this.getPosition(),l=this.getEyeVector(),c=i.Math.degToRad(u.fov),d=i.Math.degToRad(e),h=s?this.getPivotPlaneDistance():l.length(),f=h*Math.tan(.5*c)/Math.tan(.5*d),p=l.normalize().multiplyScalar(h-f);this.setPosition(a.add(p)),s&&this.setTarget(this.getTarget().add(p))}u.setFov(e),u.dirty=!0}},this.applyRotation=function(e,t,r,n){e.sub(r),e.applyAxisAngle(n,t),e.add(r)},this.getSignedAngle=function(e,t,r){var n=e.angleTo(t),i=e.clone().cross(t).normalize(),o=r.dot(i)>0?1:-1;return n*o},this.computeFit=function(t,r,n,o,s){if(!o||o.empty())return{position:t,target:r};s=void 0===s?1:s;for(var a=o.center(),l=o.size(),c=t.clone().sub(r).normalize(),u=Math.tan(i.Math.degToRad(.5*n)),d=0,h=this.computeOrthogonalUp(t,r),f=c.clone().cross(h).normalize(),p=new i.Vector3,m=0===l.z?4:8,g=0;m>g;g++){p.set(0==(1&g)?-.5*l.x:.5*l.x,0==(2&g)?-.5*l.y:.5*l.y,0==(4&g)?-.5*l.z:.5*l.z);var v=0;e.isPerspective&&(v=p.dot(c));var y=Math.abs(p.dot(h)),_=Math.abs(p.dot(f)),b=v+(1+2*this.FIT_TO_VIEW_VERTICAL_MARGIN/(1-2*this.FIT_TO_VIEW_VERTICAL_MARGIN))*y/u;b>d&&(d=b),b=v+(1+2*this.FIT_TO_VIEW_HORIZONTAL_MARGIN/(1-2*this.FIT_TO_VIEW_HORIZONTAL_MARGIN))*_/(s*u),b>d&&(d=b)}a.add(h.multiplyScalar(-d*this.FIT_TO_VIEW_VERTICAL_OFFSET)),a.add(f.multiplyScalar(d*this.FIT_TO_VIEW_HORIZONTAL_OFFSET)),c.multiplyScalar(d);var x=a.clone().add(c);return{position:x,target:a}},this.computeOrthogonalUp=function(e,t){var r=this.__getUp(),n=t.clone().sub(e);if(0===n.lengthSq())return n.copy(r);var i=n.clone().cross(r);return 0===i.lengthSq()&&(r.z>r.y?n.y-=1e-4:n.z-=1e-4,i.crossVectors(n,r)),i.cross(n).normalize()},this.fitBounds=function(e,t,r){var n=this.getTarget(),i=this.getPosition();if(!this.isActionEnabled("gotoview")||!t||t.empty())return{position:i,target:n};var o=this.getVerticalFov();if(!r){t=t.clone();var s=t.center(),a=i.clone().sub(n).normalize(),l=this.getSignedAngle(this.getCameraUpVector(),this.getAlignedUpVector(),a);this.applyRotation(t.min,l,s,a),this.applyRotation(t.max,l,s,a),t.setFromPoints([t.min.clone(),t.max.clone()])}var c=this.computeFit(i,n,o,t,u.aspect),d=r?this.computeOrthogonalUp(i,n):u.up;return e?(u.up.copy(d),this.setView(c.position,c.target)):this.setRequestTransitionWithUp(!0,c.position,c.target,o,d),this.setPivotPoint(c.target),this.setPivotSetFlag(!0),c},this.computeOverviewDistance=function(e){if(this.__is2D){var t=e.size(),r=u.aspect,n=t.x/r,o=t.y;return Math.max(n,o)}var s=this.getVerticalFov(),t=e.size(),a=t.length();return 0===a&&(a=2),u.isPerspective?.5*a/Math.tan(i.Math.degToRad(.5*s)):a},this.applyDollyConstraint=function(e,t){if(!(s||a||l)||!this.__is2D)return e;var r=e;if(s&&l&&t&&e>1){var n,i=u.isPerspective?this.getEyeToCenterOfBoundsVec(t):this.getEyeVector();n=s?l*this.computeOverviewDistance(s):l*this.computeOverviewDistance(t);var o=Math.abs(n/i.length());o=Math.max(o,1),r=Math.min(r,o)}if(a||c&&t){var d;d=a?u.clientHeight/a:Math.min(h,this.computeOverviewDistance(t)/c);var i=this.getEyeVector(),f=d/-i.z;f=Math.min(f,1),r=Math.max(r,f)}return r},this.applyPanningConstraint2D=function(e){if(this.__is2D&&s){var t=u.position.x+e.x,r=u.position.y+e.y;t=i.Math.clamp(t,s.min.x,s.max.x),r=i.Math.clamp(r,s.min.y,s.max.y);var n=t-u.position.x,o=r-u.position.y,a=Math.min(e.x,0),l=Math.min(e.y,0),c=Math.max(e.x,0),d=Math.max(e.y,0);n=i.Math.clamp(n,a,c),o=i.Math.clamp(o,l,d),e.x=n,e.y=o}},this.updateCamera=function(){u&&(u.updateProjectionMatrix(),this.orient(u,u.target,u.position,u.up),u.dirty=!1)},this.setCamera(e),this.setConstraints2D=function(e,t){s=e,a=t}}r.r(t),r.d(t,"Navigation",function(){return n});var i=r("./thirdparty/three.js/three.js"),o=(r.n(i),r("./src/logger/Logger.js"));n.prototype.constructor=n,n.prototype.setIs2D=function(e){this.__is2D=!!e},n.prototype.getIs2D=function(){return this.__is2D},n.prototype.setIsTouchDevice=function(e){this.__isTouchDevice=!!e},n.prototype.getIsTouchDevice=function(){return this.__isTouchDevice},n.prototype.orient=function(){function e(){t||(t=new i.Matrix4,r=new i.Vector3,n=new i.Vector3,o=new i.Vector3)}var t,r,n,o;return function(i,s,a,l){e();var c=t.elements;o.subVectors(a,s).normalize(),0===o.lengthSq()&&(o.z=1),r.crossVectors(l,o).normalize(),0===r.lengthSq()&&(l.z>l.y?o.y-=1e-4:o.z+=1e-4,r.crossVectors(l,o).normalize()),n.crossVectors(o,r),c[0]=r.x,c[4]=n.x,c[8]=o.x,c[1]=r.y,c[5]=n.y,c[9]=o.y,c[2]=r.z,c[6]=n.z,c[10]=o.z,i.setRotationFromMatrix(t)}}(),n.prototype.fov2fl=function(e){var t=12,r=i.Math.degToRad(e);return 0>=r&&(r=1e-4),Math.round(t/Math.tan(.5*r))},n.prototype.fl2fov=function(e){var t=12;0>=e&&(e=1e-4);var r=2*Math.atan(t/e);return i.Math.radToDeg(r)},n.prototype.setCameraUpVector=function(e){if(this.isActionEnabled("roll")){var t=this.getCamera();t.up.copy(e),t.dirty=!0}},n.prototype.getCameraUpVector=function(){var e=this.getCameraRightVector(!1),t=this.getEyeVector();return e.cross(t).normalize()},n.prototype.getAlignedUpVector=function(){var e=this.getCameraRightVector(!0),t=this.getEyeVector();return e.cross(t).normalize()},n.prototype.getCameraRightVector=function(e){var t=new i.Vector3,r=e?this.getWorldUpVector():this.getCamera().up,n=this.getEyeVector();return t.crossVectors(n,r),0===t.lengthSq()&&(Math.abs(n.z)>=Math.abs(n.y)?r.set(0,1,0):r.set(0,0,1),t.crossVectors(n,r)),t.normalize()},n.prototype.setWorldUpVector=function(e,t){this.isActionEnabled("roll")&&(this.__setUp(e),t&&this.orientCameraUp())},n.prototype.getWorldUpVector=function(){return this.__getUp().clone()},n.prototype.getWorldRightVector=function(){var e=new i.Vector3;return e.copy(this.__getUp()),Math.abs(e.z)<=Math.abs(e.y)?e.set(e.y,-e.x,0):e.z>=0?e.set(e.z,0,-e.x):e.set(-e.z,0,e.x),e.normalize()},n.prototype.getVerticalFov=function(){return this.getCamera().fov},n.prototype.getHorizontalFov=function(){var e=this.getScreenViewport();return this.getCamera().fov*(e.width/e.height)},n.prototype.getFocalLength=function(){return this.fov2fl(this.getVerticalFov())},n.prototype.setFocalLength=function(e,t){this.setVerticalFov(this.fl2fov(e),t)},n.prototype.setReverseZoomDirection=function(e){this.__options.reverseDolly=!!e},n.prototype.setReverseHorizontalLookDirection=function(e){return this.getIs2D()?void o.logger.warn("Autodesk.Viewing.Navigation.setReverseHorizontalLookDirection is not applicable to 2D"):void(this.__options.reverseHorizontalLookDirection=!!e)},n.prototype.setReverseVerticalLookDirection=function(e){return this.getIs2D()?void o.logger.warn("Autodesk.Viewing.Navigation.setReverseVerticalLookDirection is not applicable to 2D"):void(this.__options.reverseVerticalLookDirection=!!e)},n.prototype.getReverseZoomDirection=function(){return this.__options.reverseDolly},n.prototype.getReverseHorizontalLookDirection=function(){return this.getIs2D()?(o.logger.warn("Autodesk.Viewing.Navigation.getReverseHorizontalLookDirection is not applicable to 2D"),!1):this.__options.reverseHorizontalLookDirection},n.prototype.getReverseVerticalLookDirection=function(){return this.getIs2D()?(o.logger.warn("Autodesk.Viewing.Navigation.getReverseVerticalLookDirection is not applicable to 2D"),!1):this.__options.reverseVerticalLookDirection},n.prototype.setZoomTowardsPivot=function(e){this.__options.dollyToPivot=!!e},n.prototype.getZoomTowardsPivot=function(){return this.__options.dollyToPivot},n.prototype.setOrbitPastWorldPoles=function(e){return this.getIs2D()?void o.logger.warn("Autodesk.Viewing.Navigation.setOrbitPastWorldPoles is not applicable to 2D"):void(this.__options.orbitPastPoles=!!e)},n.prototype.getOrbitPastWorldPoles=function(){return this.getIs2D()?(o.logger.warn("Autodesk.Viewing.Navigation.orbitPastWorldPoles is not applicable to 2D"),!1):this.__options.orbitPastPoles},n.prototype.setUsePivotAlways=function(e){this.__options.usePivotAlways=!!e},n.prototype.getUsePivotAlways=function(){return this.__options.usePivotAlways},n.prototype.setUseLeftHandedInput=function(e){this.__options.useLeftHandedInput=!!e},n.prototype.getUseLeftHandedInput=function(){return this.__options.useLeftHandedInput},n.prototype.setWheelSetsPivot=function(e){this.__options.wheelSetsPivot=!!e},n.prototype.getWheelSetsPivot=function(){return this.__options.wheelSetsPivot},n.prototype.setSelectionSetsPivot=function(e){this.__options.SelectionSetsPivot=!!e},n.prototype.getSelectionSetsPivot=function(){return this.__options.SelectionSetsPivot},n.prototype.setIsLocked=function(e){this.__options.lockNavigation=!!e},n.prototype.getIsLocked=function(){return this.__options.lockNavigation},n.prototype.setLockSettings=function(e){for(var t in this.__lockSettings)e.hasOwnProperty(t)&&(this.__lockSettings[t]=e[t])},n.prototype.getLockSettings=function(){var e={};for(var t in this.__lockSettings)e[t]=this.__lockSettings[t];return e},n.prototype.isActionEnabled=function(e){return!this.__options.lockNavigation||this.__lockSettings[e]===!0},n.prototype.setPivotSetFlag=function(e){this.__pivotIsSetFlag=!!e},n.prototype.getPivotSetFlag=function(){return this.__pivotIsSetFlag},n.prototype.setRequestFitToView=function(e){this.isActionEnabled("gotoview")&&(this.__fitToViewRequested=!!e)},n.prototype.getRequestFitToView=function(){return this.__fitToViewRequested},n.prototype.setRequestHomeView=function(e){this.isActionEnabled("gotoview")&&(this.__homeViewRequested=!!e)},n.prototype.getRequestHomeView=function(){return this.__homeViewRequested},n.prototype.setRequestTransition=function(e,t,r,n,i,o){e?this.__destinationView={position:t.clone(),coi:r.clone(),fov:n,up:this.getCamera().up.clone(),worldUp:this.getWorldUpVector(),reorient:i,pivot:o?o.clone():r.clone()}:this.__destinationView=null},n.prototype.setRequestTransitionWithUp=function(e,t,r,n,i,o,s){e?this.__destinationView={position:t.clone(),coi:r.clone(),fov:n,up:i.clone(),worldUp:o?o:this.getWorldUpVector(),reorient:!1,pivot:s?s.clone():r.clone()}:this.__destinationView=null},n.prototype.getRequestTransition=function(){return this.__destinationView},n.prototype.setTransitionActive=function(e){this.__transitionActive=!!e},n.prototype.getTransitionActive=function(){return this.__transitionActive},n.prototype.getWorldSize=function(e){var t=this.getCamera(),r=t.aspect,n=2*e*Math.tan(i.Math.degToRad(.5*t.fov)),o=n*r;return new i.Vector2(o,n)},n.prototype.screenToViewport=function(e,t){return t=1-t,e=2*e-1,t=2*t-1,new i.Vector3(e,t,1)},n.prototype.viewportToScreen=function(e,t){return e=(e+1)/2,t=(t+1)/2,t=1-t,new i.Vector2(e,t)},n.prototype.getWorldPoint=function(e,t){var r=this.screenToViewport(e,t);e=r.x,t=r.y;var n,o=this.getCamera();o.isPerspective&&(n=new i.Vector3(e,t,1),n=n.unproject(o));var s,a,l=this.getEyeVector(),c=this.getPosition();if(!o.isPerspective||isNaN(n.x)){var u=this.getWorldSize(l.length()),d=this.getCameraRightVector(!1).multiplyScalar(.5*e*u.x),h=this.getCameraUpVector().multiplyScalar(.5*t*u.y);s=l.clone().add(d).add(h).normalize()}else s=n.sub(c).normalize();var f=this.getPivotPoint(),p=s.dot(l),m=this.__pivotIsSetFlag&&(this.getIs2D()||o.isPerspective&&p>0);return a=m?0!==p?Math.abs(f.sub(c).dot(l))/p:f.sub(c).length():o.isPerspective?.5*(o.near+o.far):o.orthoScale,s.multiplyScalar(a).add(c)},n.prototype.getPivotPlaneDistance=function(){var e=this.getPivotPoint(),t=this.getEyeVector(),r=this.getPosition();return e.sub(r).dot(t.normalize())},n.prototype.panRelative=function(e,t,r){if(this.isActionEnabled("pan")){var n=this.getScreenViewport(),i=this.getCamera(),o=this.getWorldSize(r),s=e*o.x*n.width/i.clientWidth,a=t*o.y*n.height/i.clientHeight,l=this.getCameraRightVector(!1).multiplyScalar(s),c=this.getCameraUpVector().multiplyScalar(a),u=l.add(c);this.applyPanningConstraint2D(u),this.setView(this.getPosition().add(u),this.getTarget().add(u))}},n.prototype.dollyFromPoint=function(e,t,r){if(this.isActionEnabled("zoom")&&!(Math.abs(e)<=this.__kEpsilon)){var n=this.getPosition(),i=this.getEyeVector();if(!this.getCamera().isPerspective){var o=i.lengthSq(),s=i.dot(this.getTarget().sub(t));t=i.clone().multiplyScalar(s/o).add(t)}var a=t.clone().sub(n),l=a.length(),c=l+e;c<this.__minDistance&&(c=this.__minDistance);var u=c/l;if(u=this.applyDollyConstraint(u,r),Math.abs(u-1)>this.__kEpsilon){a.multiplyScalar(u),a.set(-a.x,-a.y,-a.z);var d=a.add(t),i=this.getEyeVector();this.getCamera().isPerspective||i.multiplyScalar(u),this.setView(d,i.add(d))}}},n.prototype.toPerspective=function(){if(this.getIs2D())return void o.logger.warn("Autodesk.Viewing.Navigation.toPerspective is not applicable to 2D");var e=this.getCamera();e.isPerspective||(e.toPerspective(),e.dirty=!0)},n.prototype.toOrthographic=function(){var e=this.getCamera();e.isPerspective&&(e.toOrthographic(),e.dirty=!0)},n.snapToAxis=function(e){var t=new i.Vector3(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z));return t.x>t.y&&t.x>t.z?e.set(e.x>0?1:-1,0,0):t.y>t.x&&t.y>t.z?e.set(0,e.y>0?1:-1,0):e.set(0,0,e.z>0?1:-1),e}},"./src/tools/OrbitDollyPanTool.js":function(e,t,r){"use strict";function n(e,t,r){function n(){var e=_e;return Z===K&&!e.SHIFT&&!(e.ALT^e.CONTROL)||Z===K&&e.SHIFT&&e.CONTROL||Z===Y&&!e.SHIFT&&!e.CONTROL||Z===Y&&e.ALT||Z===Y&&e.CONTROL&&!e.ALT||Z===X&&e.SHIFT&&!e.CONTROL&&!e.ALT||"pan"===L&&Z!==Y&&!e.ALT&&!("pinch"===D)||e.SPACE}function o(){var e=_e;return Z===K&&e.SHIFT&&!e.ALT&&!e.CONTROL||Z===K&&e.ALT&&!e.SHIFT&&!e.CONTROL||"dolly"===L&&!e.ALT&&!("pinch"===D)}function a(){var e=_e;return!(e.CONTROL||e.ALT||e.SHIFT||Z!==K&&Z!==Y)}function l(){if(!T.isPerspective)return!1;var e=M.getPivotPoint().sub(M.getPosition());return e.dot(M.getEyeVector())<=0}function c(e,t){var r=g.getWindow(),n={left:0,top:0,width:r.innerWidth,height:r.innerHeight};de.set((e-.5*n.width-n.left)/(.5*n.width),(.5*n.height+n.top-t)/(.5*n.height),0);var i=de.length();return me?i<Math.SQRT1_2?de.z=Math.sqrt(1-i*i):de.z=.5/i:i>1?de.normalize():de.z=Math.sqrt(1-i*i),ae.copy(T.position).sub(T.pivot),ce.copy(T.up).setLength(de.y),ce.add(ue.copy(T.up).cross(ae).setLength(de.x)),ce.add(ae.setLength(de.z)),ce}function u(){if(M.isActionEnabled("orbit")){ae.subVectors(T.position,T.pivot),le.subVectors(T.position,T.target);var e=le.length();le.normalize();var t=Math.acos(oe.dot(se)/oe.length()/se.length());t&&(t*=E,he.crossVectors(oe,se).normalize(),fe.setFromAxisAngle(he,-t),ae.applyQuaternion(fe),T.up.applyQuaternion(fe),se.applyQuaternion(fe),le.applyQuaternion(fe),ge?oe.copy(se):(fe.setFromAxisAngle(he,t*(ve-1)),oe.applyQuaternion(fe))),T.position.addVectors(T.pivot,ae),T.target.subVectors(T.position,le.multiplyScalar(e)),T.dirty=!0}}function d(e,t){return-1!==e.indexOf(t,e.length-t.length)}function h(e){var t=e.pointers[1].clientX-e.pointers[0].clientX,r=e.pointers[1].clientY-e.pointers[0].clientY;return Math.sqrt(t*t+r*r)}var f=this;this.setGlobalManager(t.globalManager);var p,m,g=this,v=.001,y=.01,_=1.5,b=.01,x=20,w=r&&r.hasOwnProperty("dollyDragScale")?r.dollyDragScale:100,E=2,S=-1!=navigator.userAgent.search("Mac OS"),A=r&&r.disablePinchRotation,M=t.navigation,T=M.getCamera(),C=["orbit","freeorbit","dolly","pan"],j=C[0],P=[j],L=j,D=null,I=1,R=1,O=0,k=0,N=0,F=0,V=!0,U=!1,B=null,z=!1,G={SHIFT:16,CONTROL:17,ALT:18,SPACE:32,PAGEUP:33,PAGEDOWN:34,LEFT:37,UP:38,RIGHT:39,DOWN:40,ZERO:48,EQUALS:187,DASH:189},H=-5,W=-4,q=-1,X=0,Y=1,K=2,Q=3,Z=H,J=new THREE.Vector3,$=new THREE.Vector3,ee=new THREE.Vector2,te=new THREE.Vector2,re=new THREE.Vector2,ne=new THREE.Vector2,ie=new THREE.Vector3,oe=new THREE.Vector3,se=new THREE.Vector3,ae=new THREE.Vector3,le=new THREE.Vector3,ce=new THREE.Vector3,ue=new THREE.Vector3,de=new THREE.Vector3,he=new THREE.Vector3,fe=new THREE.Quaternion,pe=new THREE.Plane,me=!1,ge=!0,ve=.2,ye=[!1,!1,!1,!1,!1,!1],_e={SHIFT:0,ALT:0,CONTROL:0,SPACE:0};this.active=!1;var be,xe=function(t){e.renderer().rolloverObjectId(0,null,0)},we=.6,Ee=5,Se=.025,Ae=.01,Me=5e-4,Te=r&&r.hasOwnProperty("dollyScrollScale")?r.dollyScrollScale:.6,Ce=1,je=Ee,Pe=Se;this.getNames=function(){return C},this.getName=function(){return C[0]},this.activate=function(r){this.active=!0,P.push(r),L=r,V=t.prefs.get(s.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR),t.prefs.addListeners(s.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR,this._onPrefCursor),e.canvas.addEventListener("mouseout",xe),t.addEventListener(i.ESCAPE_EVENT,this.handleBlur)},this.deactivate=function(r){this.active=!1,t.prefs.removeListeners(s.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR,this._onPrefCursor);var n=P.length-1;n>0&&P[n]===r&&(P.pop(),L=P[n-1]),e.canvas.removeEventListener("mouseout",xe),t.removeEventListener(i.ESCAPE_EVENT,this.handleBlur)},this.isActive=function(){return this.active},this.adjustDollyLookSpeed=function(e){0===e?(Pe=Se,je=Ee):(Pe*=e>0?1.1:.9,je*=e>0?1.1:.9,1e-6>Pe&&(Pe=1e-6),1e-6>je&&(je=1e-6))},this.getDollySpeed=function(e,t){var r;if(!M.getZoomTowardsPivot()&&!M.getWheelSetsPivot()||T.isPerspective||M.getIs2D()){var n=M.getEyeVector(),i=M.getPosition(),o=e.clone().sub(i).dot(n.normalize()),s=o*Pe;r=Math.abs(s)<Ae?0>s?-Ae:Ae:s}else{var s=T.orthoScale*Pe;r=Math.abs(s)<Me&&t?0:s}return r},this.getDollyScrollScale=function(){return Te},this.setDollyScrollScale=function(e){Te=e},this.getDollyDragScale=function(){return w},this.setDollyDragScale=function(e){w=e},this.getLookSpeed=function(){return je},this.coiIsActive=function(){return M.getPivotSetFlag()&&M.isPointVisible(M.getPivotPoint())},this.adjustSpeed=function(e){this.adjustDollyLookSpeed(e),this.utilities.autocam&&(this.utilities.autocam.orbitMultiplier=this.getLookSpeed())},this.getTriggeredMode=function(){return Z===Y&&_e.SHIFT?P[1]:o()||0!==ie.z?a()?"pan":"dolly":n()?"pan":"pan"===D||"pinch"===D?"dollypan":L},this.initTracking=function(e,t){var r;if(T.isPerspective){r=.5*(T.near+T.far);var n=this.utilities.getHitPoint(e,t),i=M.getPosition();if(n&&n.sub){var o=n.sub(i),s=M.getEyeVector().normalize();r=Math.abs(s.dot(o))}else{var a=M.getPivotSetFlag()&&M.isPointVisible(M.getPivotPoint());if(a){var l=M.getPivotPlaneDistance();l>y&&(r=l)}}}else r=M.getEyeVector().length();Ce=r},this.initOrbit=function(){this.utilities.setTemporaryPivot(l()?M.getTarget():null)},this.getActiveMode=function(){return j},this.getCursor=function(){if(!V)return null;switch(j){case"freeorbit":case"orbit":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto";case"dolly":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), auto";case"pan":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC), auto"}return null},this.getMotionDelta=function(e,t){var r=M&&M.getReverseZoomDirection()?-_:_;S&&(r*=-1),ye[0]&&($.x+=b,re.x+=x),ye[1]&&($.x-=b,re.x-=x),ye[2]&&($.y+=b,re.y+=x),ye[3]&&($.y-=b,re.y-=x),ye[4]&&($.z+=r),ye[5]&&($.z-=r);var n=$.x-J.x,i=$.y-J.y,o=$.z-J.z;Math.abs(n)<v&&(n=0),Math.abs(i)<v&&(i=0),Math.abs(o)<v&&(o=0),e.set(n,i,o),t&&t.set(re.x-te.x,re.y-te.y)},this.stepMotionDelta=function(e,t){t?(J.x+=e.x*we,J.y+=e.y*we,J.z+=e.z*we):J.copy($),te.copy(re)},this.getFitBounds=function(){return this.utilities.viewerImpl.zoomBoundsChanged&&(be=this.utilities.viewerImpl.getVisibleBounds(!0),this.utilities.viewerImpl.zoomBoundsChanged=!1),be},this.update=function(){var e,r=!1,n=!1;this.getMotionDelta(ie,ne);var i=ie.x,o=ie.y,s=ie.z;if(U||this.checkInteractionMode(),U=Z>q,U&&this.controller.setIsLocked(!0),0!==i||0!==o||0!==s){switch(j){case"orbit":this.utilities.autocam&&this.utilities.autocam.startState&&(ne.x=-ne.x,B&&this.utilities.autocam.orbit(re,B,ne.multiplyScalar(E),this.utilities.autocam.startState));break;case"freeorbit":u();break;case"dolly":var a,l=new THREE.Vector2;s*=Te,Z>=X?(o=-o,s=Math.abs(i)>Math.abs(o)?i:o,M.getReverseZoomDirection()&&(s*=-1),s*=w,i=0,o=0,l=M.viewportToScreen(0,0)):(e=M.getScreenViewport(),p&&m?(l.x=p/e.width,l.y=m/e.height):l=M.viewportToScreen(0,0)),!M.getIs2D()&&M.getZoomTowardsPivot()?this.coiIsActive()?a=M.getPivotPoint():(l=M.viewportToScreen(0,0),a=M.getWorldPoint(l.x,l.y)):a=M.getWorldPoint(l.x,l.y),M.dollyFromPoint(s*this.getDollySpeed(a,0>s),a,this.getFitBounds());break;case"pan":M.panRelative(-i,o,Ce);break;case"dollypan":(0!==i||0!==o)&&M.panRelative(-i,o,Ce),e=M.getScreenViewport(),a=M.getWorldPoint(p/e.width,m/e.height);var c=M.getPosition(),d=M.getIs2D()?c.sub(a).length():Ce,h=O/k-1,f=h*d;M.dollyFromPoint(f,a,this.getFitBounds());var g=new THREE.Vector3,v=new THREE.Quaternion,_=M.getCameraUpVector(),b=g.copy(T.position).sub(T.target).normalize();v.setFromAxisAngle(b,1.2*N),_.applyQuaternion(v),M.getIs2D()||A&&("pinch"===D||"pan"===D)||M.setCameraUpVector(_),O=k,R=I,Ce=d+f}n=!0}return this.stepMotionDelta(ie,"pan"!==j&&"dollypan"!==j),Z===q&&Math.abs(s)<y&&(this.interactionEnd(q),$.z=0,J.z=0,r=!0,n=!0),(_e.SHIFT||_e.ALT)&&-1!==C.indexOf(t.getActiveNavigationTool())&&(n=!0),!z&&(r||Z>H)&&(Z>q&&(J.copy($),this.utilities.removeTemporaryPivot()),this.utilities.autocam.endInteraction(),Z=H,U&&this.controller.setIsLocked(!1),U=!1,B=null,D=null),n?this.utilities.pivotActive(M.getPivotSetFlag(),q>=Z):this.utilities.pivotUpdate(),T.dirty},this.checkInteractionMode=function(){var e=this.getTriggeredMode();e!==j&&(j=e,("pan"===j&&Z>q||"dollypan"===j)&&this.initTracking(J.x,J.y))},this.interactionStart=function(e,t){(t||e>Z)&&(Z=e,z=!0,e>q&&("pan"===j&&this.initTracking(J.x,J.y),"orbit"===j&&this.initOrbit()),!M.getSelectionSetsPivot()&&this.utilities.pivotActive(M.getPivotSetFlag(),e===q),this.utilities.autocam&&(this.utilities.autocam.sync(T),this.utilities.autocam.startInteraction(te.x,te.y),B=te.clone()))},this.interactionCheck=function(){(ye[0]||ye[1]||ye[2]||ye[3]||ye[4]||ye[5]||_e.SHIFT||_e.CONTROL||_e.ALT||_e.SPACE)&&this.interactionStart(W,!0)},this.interactionEnd=function(e){e===Z&&(e!==q&&this.utilities.pivotActive(!1),z=!1)},this.isInteractionActive=function(){return z},this.handleWheelInput=function(t,r){if(p=r.canvasX,m=r.canvasY,this.isDragging)return!1;if(M.getIs2D()){var n=M.getScreenViewport(),i=e.intersectGround(p+n.width,m+n.height);this.utilities.setPivotPoint(i,!0,!0)}else if(M.getWheelSetsPivot()){var o=e.hitTest(p,m,!0);if(o&&o.intersectPoint)this.utilities.setPivotPoint(o.intersectPoint,!0,!0);else{var s=M.getPivotPoint(),a=M.getEyeVector().normalize(),l=-s.dot(a),c=e.viewportToRay(e.clientToViewport(p,m));pe.set(a,l);var u=c.intersectPlane(pe);this.utilities.setPivotPoint(u,!0,!0)}}return M.getReverseZoomDirection()&&(t*=-1),$.z+=t,0!=t&&this.interactionStart(q),!0},this.resetKeys=function(){this.autoMove(-1,!1),_e.SHIFT=0,_e.CONTROL=0,_e.ALT=0,_e.SPACE=0},this.autoMove=function(e,t){t&&this.isDragging||(0>e?ye[0]=ye[1]=ye[2]=ye[3]=ye[4]=ye[5]=t:ye[e]=t,t||this.interactionEnd(W),this.interactionCheck())},this.updateModifierState=function(e){_e.CONTROL=S&&e.metaKey||e.ctrlKey?1:0,_e.SHIFT=e.shiftKey?1:0,_e.ALT=e.altKey?1:0},this.handleKeyDown=function(e,t){this.updateModifierState(e);var r=!1;switch(t){case G.EQUALS:this.adjustSpeed(1),r=!0;break;case G.DASH:this.adjustSpeed(-1),r=!0;break;case G.ZERO:this.adjustSpeed(0),r=!0;break;case G.LEFT:this.autoMove(0,!0),r=!0;break;case G.RIGHT:this.autoMove(1,!0),r=!0;break;case G.PAGEUP:this.autoMove(2,!0),r=!0;break;case G.PAGEDOWN:this.autoMove(3,!0),r=!0;break;case G.UP:this.autoMove(4,!0),r=!0;break;case G.DOWN:this.autoMove(5,!0),r=!0;break;default:return!1}return this.isDragging||this.interactionStart(W),r},this.handleKeyUp=function(e,t){this.updateModifierState(e);var r=!1;switch(t){case G.LEFT:this.autoMove(0,!1),r=!0;break;case G.RIGHT:this.autoMove(1,!1),r=!0;break;case G.PAGEUP:this.autoMove(2,!1),r=!0;break;case G.PAGEDOWN:this.autoMove(3,!1),r=!0;break;case G.UP:this.autoMove(4,!1),r=!0;break;case G.DOWN:this.autoMove(5,!1),r=!0;break;default:return!1}return r&&(this.interactionEnd(W),z||this.interactionCheck()),r},this.handleDollyPan=function(e){p=e.canvasX,m=e.canvasY;var t=M.getScreenViewport();re.x=p,re.y=m,$.x=re.x/t.width,$.y=re.y/t.height,k=h(e);var r=THREE.Math.degToRad(e.rotation);N=r-F,Math.abs(N)>1&&(N=0),F=r,d(e.type,"start")&&(O=k,R=1,N=0,F=r),I=e.scale},this.handleGesture=function(e){
switch(e.type){case"dragstart":return D="drag",this.handleButtonDown(e,0);case"dragmove":return"drag"!==D&&(this.handleButtonDown(e,0),D="drag"),this.handleMouseMove(e);case"dragend":return"drag"===D?(this.handleButtonUp(e,0),D=null,!0):!1;case"panstart":return D="pan",this.handlePanStart(e),this.handleDollyPan(e),!0;case"panmove":return"pan"!==D&&(D="pan",this.handlePanStart(e)),this.handleDollyPan(e);case"panend":return"pan"===D?(this.isDragging=!1,this.handleDollyPan(e),this.interactionEnd(Q),!0):!1;case"pinchstart":return this.isDragging=!0,D="pinch",J.x=.5*(e.normalizedX+1),J.y=1-.5*(e.normalizedY+1),ee.set(e.canvasX,e.canvasY),te.set(e.canvasX,e.canvasY),U=!1,this.interactionStart(Q),this.handleDollyPan(e),!0;case"pinchmove":return"pinch"===D?this.handleDollyPan(e):!1;case"pinchend":return"pinch"===D?(this.isDragging=!1,this.handleDollyPan(e),this.interactionEnd(Q),!0):!1}return!1},this.handleButtonDown=function(e,t){return this.updateModifierState(e),J.x=.5*(e.normalizedX+1),J.y=1-.5*(e.normalizedY+1),te.set(e.canvasX,e.canvasY),$.copy(J),re.copy(te),oe.copy(c(e.canvasX,e.canvasY)),se.copy(oe),p=e.canvasX,m=e.canvasY,this.isDragging=!0,this.interactionStart(t),!0},this.handlePanStart=function(e){return this.isDragging=!0,J.x=.5*(e.normalizedX+1),J.y=1-.5*(e.normalizedY+1),ee.set(e.canvasX,e.canvasY),te.set(e.canvasX,e.canvasY),this.interactionStart(Q),!0},this.handleButtonUp=function(e,t){return this.updateModifierState(e),$.x=.5*(e.normalizedX+1),$.y=1-.5*(e.normalizedY+1),re.set(e.canvasX,e.canvasY),se.copy(c(e.canvasX,e.canvasY)),oe.copy(se),p=e.canvasX,m=e.canvasY,this.interactionEnd(t),this.isDragging=!1,!0},this.handleMouseMove=function(t){return this.updateModifierState(t),this.isDragging?($.x=.5*(t.normalizedX+1),$.y=1-.5*(t.normalizedY+1),re.set(t.canvasX,t.canvasY),se.copy(c(t.canvasX,t.canvasY)),p=t.canvasX,m=t.canvasY,!0):(J.x=.5*(t.normalizedX+1),J.y=1-.5*(t.normalizedY+1),te.set(t.canvasX,t.canvasY),$.x=J.x,$.y=J.y,re.copy(te),p=t.canvasX,m=t.canvasY,t.target===e.canvas&&e.rolloverObject(p,m),!1)},this.handleBlur=function(e){f.resetKeys(),f.interactionEnd(Z)},this._onPrefCursor=function(e){V=e}.bind(this)}r.r(t),r.d(t,"OrbitDollyPanTool",function(){return n});var i=r("./src/application/EventTypes.js"),o=(r.n(i),r("./src/application/GlobalManagerMixin.js")),s=r("./src/application/PreferenceNames.js");o.GlobalManagerMixin.call(n.prototype)},"./src/tools/SelectionType.js":function(e,t,r){"use strict";r.r(t),r.d(t,"SelectionType",function(){return n});var n={MIXED:1,REGULAR:2,OVERLAYED:3}},"./src/tools/Selector.js":function(e,t,r){"use strict";function n(e,t){function r(){return t.getData().instanceTree}function n(i){var o=r();if(m[i]>0)m[i]--,0==m[i]&&e.highlightObjectNode(t,i,!1);else if(m[i]<0)throw"Selection State machine broken. Negatively selected object!";o&&o.enumNodeChildren(i,function(e){n(e)},!1)}function i(n,o,a){var l=r();if(m[n])m[n]++;else{switch(a){default:case s.SelectionType.MIXED:e.highlightObjectNode(t,n,!0,o);break;case s.SelectionType.REGULAR:e.highlightObjectNode(t,n,!0,!0);break;case s.SelectionType.OVERLAYED:e.highlightObjectNode(t,n,!0,!1)}m[n]=1}l&&l.enumNodeChildren(n,function(e){i(e,!0,a)},!1)}function c(e){return void 0!==e&&p.selectedObjectIds[e]?!0:void 0}function d(e,t){var n=p.isNodeSelectionLocked(e);if(!n){var o=r();if(t=t||s.SelectionType.MIXED,!o||(e=o.findNodeForSelection(e,p.selectionMode),o.isNodeSelectable(e))){var a=c(e);a||(p.selectedObjectIds[e]=t,p.selectionCount++,i(e,!1,t))}}}function h(e){var t=c(e);t&&(n(e),p.selectedObjectIds[e]=0,p.selectionCount--)}function f(e){if(p.selectionCount!==e.length)return!1;for(var t=0;t<e.length;t++)if(!c(e[t]))return!1;return!0}var p=this;this.selectedObjectIds={},this.selectionCount=0,this.selectionMode=o.SelectionMode.LEAF_OBJECT,this.lockedNodes=[];var m={};this.getInstanceTree=r,this.hasSelection=function(){return p.selectionCount>0},this.getSelectionLength=function(){return p.selectionCount},this.getSelection=function(){var e=[],t=p.selectedObjectIds;for(var r in t)if(t[r]){var n=parseInt(r);e.push(n)}return e},this.isSelected=function(e){return c(e)},this.clearNodeSelection=function(e){return void 0===e||0===this.selectionCount?!1:(n(e),delete p.selectedObjectIds[e],!0)},this.clearSelection=function(e){if(this.selectionCount>0){var t=p.selectedObjectIds;for(var r in t){var i=parseInt(r);void 0!==i&&n(i)}return p.selectedObjectIds={},p.selectionCount=0,!0}},this.deselectInvisible=function(){var r=!1,n=p.selectedObjectIds,i=e.visibilityManager;for(var o in n){var s=parseInt(o);s&&!i.isNodeVisible(t,s)&&(h(s),r=!0)}return r},this.toggleSelection=function(e,t){return e?void(c(e)?h(e):d(e,t)):void l.logger.error("Attempting to select node 0.",Object(a.errorCodeString)(a.ErrorCodes.VIEWER_INTERNAL_ERROR))},this.setSelectionMode=function(e){this.clearSelection(!0),this.selectionMode=e},this.isNodeSelectionLocked=function(e){if(-1===e)return!1;var t=r();return t?t.isNodeSelectionLocked(e):-1!==p.lockedNodes.indexOf(e)},this.lockSelection=function(e,t){function n(e,t){if(e&&-1!==e)if(t)-1===p.lockedNodes.indexOf(e)&&(p.lockedNodes.push(e),p.clearNodeSelection(e));else{var r=p.lockedNodes.indexOf(e);p.lockedNodes.splice(r,1)}}var i=r();e=Array.isArray(e)?e:[e],i?e.forEach(function(e){i.enumNodeChildren(e,function(e){i.lockNodeSelection(e,!1),n(e,t),t&&i.lockNodeSelection(e,t)},!0)}):e.forEach(function(e){n(e,t)})},this.setSelection=function(e,t){if(!f(e)&&(this.clearSelection(!0),null!=e&&0!==e.length))for(var r=0;r<e.length;r++)d(e[r],t)},this.getSelectionBounds=function(){var e=new u.Box3,n=new u.Box3,i=r();if(i){var o=t.getFragmentList(),s=p.selectedObjectIds;for(var a in s){var l=parseInt(a);i.enumNodeFragments(l,function(t){o.getWorldBounds(t,n),e.union(n)},!0)}}return e},this.getSelectionVisibility=function(){var e=!1,n=!1,i=p.selectedObjectIds;for(var o in i){var s=parseInt(o);if(s){var a=r();if(a&&a.isNodeHidden(s)?n=!0:e=!0,e&&n)break}}return{hasVisible:e,hasHidden:n,model:t}},this.update2DSelectionHighlighting=function(){if(t.isLoadDone()){var e=t.getPropertyDb();if(!e||e.isLoadDone()){m={};for(var r=p.getSelection(),n=0;n<r.length;n++){var o=r[n],s=p.selectedObjectIds[o];i(o,!1,s)}}}},this.dtor=function(){this.selectedObjectIds=null}}function i(e){function t(){s.length>1&&l.logger.warn("This selection call does not yet support multiple models.")}function r(){for(var t=[],r=0;r<s.length;r++){var n=[],i=[],o=s[r].selector.selectedObjectIds,a=s[r].selector.getInstanceTree();for(var l in o)if(o[l]){var u=parseInt(l);u&&(n.push(u),a&&a.enumNodeFragments(u,function(e){i.push(e)},!1))}n.length&&t.push({fragIdsArray:i,dbIdArray:n,nodeArray:n,model:s[r]})}var d;1===s.length&&(d={type:c.SELECTION_CHANGED_EVENT,fragIdsArray:t[0]?t[0].fragIdsArray:[],dbIdArray:t[0]?t[0].dbIdArray:[],nodeArray:t[0]?t[0].dbIdArray:[],model:s[0]},e.api.dispatchEvent(d)),d={type:c.AGGREGATE_SELECTION_CHANGED_EVENT,selections:t},e.api.dispatchEvent(d)}function i(){for(var e=!1,t=0;t<s.length;t++)e=s[t].selector.deselectInvisible()||e;e&&r()}function o(e){e.model.is2d()&&e.model.selector&&e.model.selector.update2DSelectionHighlighting()}var s=[];this.highlightDisabled=!1,this.highlightPaused=!1,this.selectionDisabled=!1,this.addModel=function(t){-1==s.indexOf(t)&&(t.selector=new n(e,t),s.push(t))},this.removeModel=function(e){var t=s.indexOf(e);e.selector.getSelection();e.selector.clearSelection(),e.selector=null,s.splice(t,1)},this.hasSelection=function(){for(var e=0;e<s.length;e++)if(s[e].selector.hasSelection())return!0;return!1},this.getSelectionLength=function(){for(var e=0,t=0;t<s.length;t++)e+=s[t].selector.getSelectionLength();return e},this.getSelection=function(){return t(),s.length>1&&l.logger.warn("Use getAggregateSelection instead of getSelection when there are multiple models in the scene."),s[0]?s[0].selector.getSelection():[]},this.getAggregateSelection=function(){for(var e=[],t=0;t<s.length;t++){var r=s[t].selector.getSelection();r&&r.length&&e.push({model:s[t],selection:r})}return e},this.clearSelection=function(e){for(var t,n=0;n<s.length;n++)s[n].selector.clearSelection(e)&&(t=!0);!e&&t&&r()},this.toggleSelection=function(e,n,i){this.selectionDisabled||(n||(t(),n=s[0]),n.selector.toggleSelection(e,i),r())},this.setSelectionMode=function(e){for(var t=0;t<s.length;t++)s[t].selector.setSelectionMode(e)},this.isNodeSelectionLocked=function(e,r){return r||(t(),r=s[0]),r&&r.selector.isNodeSelectionLocked(e)},this.lockSelection=function(e,r,n){n||(t(),n=s[0]),n&&n.selector.lockSelection(e,r)},this.unlockSelection=function(e,r){var n=this;return e||r?(r||(t(),r=s[0]),e=e||r.selector.lockedNodes.slice(),void this.lockSelection(e,!1,r)):void s.forEach(function(e){var t=e.selector.lockedNodes.slice();n.lockSelection(t,!1,e)})},this.setSelection=function(e,n,i){if(!this.selectionDisabled){if(e&&0!==e.length){if(n)for(var o=0;o<s.length;o++)s[o]!==n&&s[o].selector.clearSelection();else t(),n=s[0];n.selector.setSelection(e,i)}else this.clearSelection(!0);r()}},this.setAggregateSelection=function(e){if(!this.selectionDisabled){if(e&&0!==e.length)for(var t=0;t<e.length;++t){var n=e[t].model,i=e[t].ids,o=e[t].selectionType;n.selector.setSelection(i,o)}else this.clearSelection(!0);r()}},this.getSelectionBounds=function(){if(1==s.length)return s[0].selector.getSelectionBounds();for(var e=new u.Box3,t=0;t<s.length;t++){var r=s[t].selector.getSelectionBounds();e.union(r)}return e},this.getSelectionVisibility=function(){for(var e={hasVisible:!1,hasHidden:!1,details:[]},t=0;t<s.length;t++){var r=s[t].selector.getSelectionVisibility();e.hasVisible=e.hasVisible||r.hasVisible,e.hasHidden=e.hasHidden||r.hasHidden,e.details.push(r)}return e},this.dtor=function(){for(var e=0;e<s.length;e++)s[e].selector.dtor()},e.api.addEventListener(c.ISOLATE_EVENT,function(e){i()}),e.api.addEventListener(c.HIDE_EVENT,function(e){i()}),e.api.addEventListener(c.GEOMETRY_LOADED_EVENT,o),e.api.addEventListener(c.OBJECT_TREE_CREATED_EVENT,o),e.api.addEventListener(c.OBJECT_TREE_UNAVAILABLE_EVENT,o)}r.r(t),r.d(t,"Selector",function(){return n}),r.d(t,"MultiModelSelector",function(){return i});var o=r("./src/wgs/scene/SelectionMode.js"),s=r("./src/tools/SelectionType.js"),a=r("./src/file-loaders/net/ErrorCodes.js"),l=r("./src/logger/Logger.js"),c=r("./src/application/EventTypes.js"),u=(r.n(c),r("./thirdparty/three.js/three.js"));r.n(u)},"./src/tools/ToolController.js":function(e,t,r){"use strict";function n(e,t,r,l,c){function u(e){return e.getPriority instanceof Function&&e.getPriority()||0}function d(e,r){return t.navigation.getUseLeftHandedInput()&&0===e||f&&1===e||h&&!m&&0===e&&r.ctrlKey}this.setGlobalManager(t.globalManager),this.domElement=t.canvasWrap,this.selector=e.selector,this.autocam=r,this.lastClickX=-1,this.lastClickY=-1,this.scrollInputEnabled=!0;var h=-1!==navigator.userAgent.search("Mac OS"),f=-1!==navigator.userAgent.search("Firefox"),p=-1!==navigator.userAgent.search("Chrome"),m=-1!==navigator.userAgent.search("Safari")&&!p,g=0,v=2,y=2,_=500,b={},x=[],w=!1,E=-1,S=-1,A=!1,M=null,T=!1,C={},j=this;this.__registerToolByName=function(e,t){b[t]=e},this.registerTool=function(e){var t=e.getNames();if(!t||0===t.length)return o.logger.warn("Cannot register tool with no name."),!1;for(var r=!1,n=0;n<t.length;++n)"default"!==t[n]&&(this.__registerToolByName(e,t[n]),r=!0);return e.utilities=l,e.controller=this,e.register&&e.register(),r},this.deregisterTool=function(e){this.deactivateTool(e.getName());var t=e.getNames();if(!t||0===t.length)return!1;for(var r=t.length;--r>=0;)this.__deregisterToolName(t[r]);return e.deregister&&e.deregister(),e.utilities=null,e.controller=null,!0},this.__deregisterToolName=function(e){function t(e){for(var t=x.length;--t>=0;)x[t].activeName===e&&(b[e].deactivate(e),x.splice(t,1))}e in b&&(t(e),delete b[e])},this.getTool=function(e){return b[e]},this.getActiveToolName=function(){var e=x.length;return e>0?x[e-1].activeName:"default"},this.getActiveTool=function(){var e=x.length;return e>0?x[e-1]:b["default"]},this.isToolActivated=function(e){for(var t=0;t<x.length;t++)if(x[t].activeName===e)return!0;return!1},this.setToolActiveName=function(e){var t=b[e];t&&(t.activeName=e)},this.rearrangeByPriorities=function(){x.sort(function(e,t){return u(e)-u(t)})},this.activateTool=function(e){if(w)return!1;var r=b[e];if(r){void 0===r.count&&(r.count=0);var n=null;x.length&&"intercept"===x[x.length-1].activeName&&(n=x.pop());for(var i=0,a=0;a<x.length;a++)x[a]===r&&r.count++,u(x[a])<=u(r)&&(i=a+1);return r.activeName=e,0===r.count&&(r.count++,x.splice(i,0,r)),r.activate(e,t),n&&x.push(n),t.dispatchEvent({type:s.TOOL_CHANGE_EVENT,toolName:e,tool:r,active:!0}),!0}return o.logger.warn("activateTool not found: "+e),!1},this.deactivateTool=function(e){if(w)return!1;for(var r=x.length;--r>=0;)if(x[r].activeName===e){var n=b[e];return 1===n.count&&x.splice(r,1),n.count--,n.deactivate(e),t.dispatchEvent({type:s.TOOL_CHANGE_EVENT,toolName:e,tool:n,active:!1}),!0}return o.logger.warn("deactivateTool not found: "+e),!1},this.getToolNames=function(){return Object.keys(b)},this.setDefaultTool=function(e){var t=this.getDefaultTool();return e&&e!==t?(this.__registerToolByName(e,"default"),t&&t.deactivate("default"),e.activate("default"),!0):!1},this.getDefaultTool=function(){return b["default"]},this.setDefaultTool(c),this.setIsLocked=function(e){var t=w;return w=!!e,t},this.getIsLocked=function(){return w},this.__checkCursor=function(){for(var e=null,r=x.length;--r>=0;){var n=x[r];if(n.getCursor&&(e=n.getCursor()))break}e||(e="auto"),M!=e&&(t.canvas.style.cursor=e,M=e)},this.update=function(e){this.__checkCursor();var r=!1;l&&l.update()&&(r=!0);for(var n=x.length;--n>=0;){var i=x[n];i.update&&i.update(e)&&(r=!0)}if(t.navigation.getCamera().dirty?(t.navigation.updateCamera(),r=!0,this.cameraUpdated=!0):this.cameraUpdated=!1,r)t.navigation.updateCamera(),this.moveDelay=Date.now()+150;else if(0!==this.moveDelay){var o=this.moveDelay-Date.now();o>0?r=!0:this.moveDelay=0}return r},this.__clientToCanvasCoords=function(t,r,n){var i=e.getCanvasBoundingClientRect(),o=i.width,s=i.height,a=t.clientX-i.left,l=t.clientY-i.top;t.canvasX=a,t.canvasY=l,t.normalizedX=a/o*2-1,t.normalizedY=(s-l)/s*2-1,r&&r.set(a/o,l/s,0),n&&n.set(a,l)},this.__invokeStack=function(e,t,r){for(var n=x.length;--n>=0;){var i=x[n];if(i&&i[e]&&i[e](t,r))return!0}var o=this.getDefaultTool();return o[e]&&o[e](t,r)?!0:!1},this.distributeEvent=function(e,t,r){return this.__invokeStack(e,t,r)},this.handleResize=function(){t.navigation.setScreenViewport(t.container.getBoundingClientRect());for(var e=x.length;--e>=0;){var r=x[e];r.handleResize&&r.handleResize()}},this.handleSingleClick=function(e){var t=this.applyButtonMappings(e);this.lastClickX=e.clientX,this.lastClickY=e.clientY,this.__invokeStack("handleSingleClick",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleDoubleClick=function(e){var t=this.applyButtonMappings(e);this.__invokeStack("handleDoubleClick",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleSingleTap=function(e){this.lastClickX=e.canvasX,this.lastClickY=e.canvasY,this.__invokeStack("handleSingleTap",e)&&(e.preventDefault(),e.stopPropagation())},this.handleDoubleTap=function(e){this.lastClickX=e.canvasX,this.lastClickY=e.canvasY,this.__invokeStack("handleDoubleTap",e)&&(e.preventDefault(),e.stopPropagation())},this.handleWheelInput=function(e,t){this.__invokeStack("handleWheelInput",e,t)&&(t.preventDefault(),t.stopPropagation())},this.applyButtonMappings=function(e){var r=e.button;return"buttons"in e&&(e.firefoxSpoof?r=g:!A||1&e.buttons?r===v&&1&e.buttons&&(r=g,e.firefoxSpoof=A=!0):(e.firefoxSpoof=!0,A=!1,r=g)),t.navigation.getUseLeftHandedInput()&&(r=r===g?v:r===v?g:r),r},this.applyKeyMappings=function(e){switch(e.keyCode){case a.KeyCode.LCOMMAND:case a.KeyCode.RCOMMAND:case a.KeyCode.COMMANDMOZ:return a.KeyCode.CONTROL;case a.KeyCode.EQUALSMOZ:return a.KeyCode.EQUALS;case a.KeyCode.DASHMOZNEW:case a.KeyCode.DASHMOZ:return a.KeyCode.DASH}return e.keyCode},this.handleKeyDown=function(e){var t=this.applyKeyMappings(e);t&&this.__invokeStack("handleKeyDown",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleKeyUp=function(e){var t=this.applyKeyMappings(e);t&&this.__invokeStack("handleKeyUp",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleButtonDown=function(e,t){this.__invokeStack("handleButtonDown",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleButtonUp=function(e,t){this.__invokeStack("handleButtonUp",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleMouseMove=function(e){this.__invokeStack("handleMouseMove",e)&&(e.preventDefault(),e.stopPropagation())},this.handleBlur=function(e){this.__invokeStack("handleBlur",e)&&(e.preventDefault(),e.stopPropagation())},this.keydown=function(e){if(!n._lastTouchedElement||j.domElement.contains(n._lastTouchedElement)){var t=j.getDocument();if(!(t.activeElement instanceof HTMLInputElement||t.activeElement instanceof HTMLTextAreaElement||t.activeElement instanceof HTMLSelectElement)){if(t.activeElement){var r=t.activeElement.getAttribute("contenteditable");if("true"===r||""===r)return}j.handleKeyDown(e)}}},this.keyup=function(e){j.handleKeyUp(e)},this.mousedown=function(e){function t(e){var r=j.applyButtonMappings(e);r===n&&(j.removeDocumentEventListener("mouseup",t),j.mouseup(e))}var r=j.getDocument();i.isIE11&&Object(i.inFullscreen)(r)||r.activeElement&&r.activeElement.blur&&r.activeElement.blur(),j.__clientToCanvasCoords(e);var n=j.applyButtonMappings(e);if(j.handleButtonDown(e,n),E=e.canvasX,S=e.canvasY,d(n,e)){var o=C,s=void 0!==o.time&&e.timeStamp-o.time<_,a=void 0!==o.x&&void 0!==o.y&&Math.abs(o.x-e.canvasX)<=y&&Math.abs(o.y-e.canvasY)<=y;(!s||!a||o.clickCount&&2<=o.clickCount)&&(o.clickCount=0),o.clickCount?1===o.clickCount&&(o.clickCount=2):(o.clickCount=1,o.x=e.canvasX,o.y=e.canvasY,o.time=e.timeStamp)}j.addDocumentEventListener("mouseup",t,!1),j.registerWindowMouseMove()},this.mousemove=function(e){j.__clientToCanvasCoords(e);var t=E-e.canvasX,r=S-e.canvasY;(Math.abs(t)>y||Math.abs(r)>y)&&(E=-1,S=-1),j.handleMouseMove(e)},this.mouseup=function(e){j.__clientToCanvasCoords(e);var t=j.applyButtonMappings(e);j.handleButtonUp(e,t);var r=E-e.canvasX,n=S-e.canvasY;if(E=-1,S=-1,Math.abs(r)<=y&&Math.abs(n)<=y&&j.handleSingleClick(e),d(t,e)){var i=C;2===i.clickCount&&(j.handleDoubleClick(e),i.clickCount=0,i.x=void 0,i.y=void 0,i.time=void 0)}j.unregisterWindowMouseMove()},this.doubleclick=function(e){j.__clientToCanvasCoords(e),E=e.canvasX,S=e.canvasY,j.handleDoubleClick(e)},this.mousewheel=function(e){if(j.scrollInputEnabled){j.__clientToCanvasCoords(e);var t=0;if(e.wheelDelta)t=e.wheelDelta/40;else if(e.detail)t=-e.detail;else if(e.deltaY){var r=f?1:40;t=-e.deltaY/r}j.handleWheelInput(t,e)}},this.blur=function(e){j.handleBlur(e)},this.mouseover=function(e){n._lastTouchedElement=e.target},this.registerWindowMouseMove=function(){j.addWindowEventListener("mousemove",j.mousemove),j.addWindowEventListener("mouseover",j.mouseover),j.domElement.removeEventListener("mousemove",j.mousemove),j.domElement.removeEventListener("mouseover",j.mouseover)},this.unregisterWindowMouseMove=function(){j.removeWindowEventListener("mousemove",j.mousemove),j.removeWindowEventListener("mouseover",j.mouseover),j.domElement.addEventListener("mousemove",j.mousemove),j.domElement.addEventListener("mouseover",j.mouseover)},this.enableMouseButtons=function(e){e&&!T?(this.domElement.addEventListener("mousedown",this.mousedown),this.domElement.addEventListener("dblclick",this.doubleclick),this.domElement.addEventListener("mousemove",this.mousemove),this.domElement.addEventListener("mouseover",this.mouseover)):!e&&T&&(this.domElement.removeEventListener("mousedown",this.mousedown),this.domElement.removeEventListener("dblclick",this.doubleclick),this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover));var t=T;return T=e,t},this.domElement.addEventListener("mousewheel",this.mousewheel,!1),this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,!1),j.addWindowEventListener("keydown",this.keydown,!1),j.addWindowEventListener("keyup",this.keyup,!1),j.addWindowEventListener("blur",this.blur,!1),this.uninitialize=function(){for(T&&(this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover),this.removeWindowEventListener("mousemove",j.mousemove),this.removeWindowEventListener("mouseover",j.mouseover)),j.removeWindowEventListener("keydown",this.keydown),j.removeWindowEventListener("keyup",this.keyup),j.removeWindowEventListener("blur",this.blur),this.domElement=null,this.selector=null,this.autocam=null;x.length>0;)this.deactivateTool(x[x.length-1].activeName);b=null,x=null,j=null,l=null,t=null,e=null,n._lastTouchedElement=null},this.set2DMode=function(e){},this.setAutocam=function(e){},this.syncCamera=function(){},this.recordHomeView=function(){var e=t.navigation.getCamera();r.sync(e),r.setHomeViewFrom(e)},this.setMouseWheelInputEnabled=function(e){this.scrollInputEnabled=e}}r.r(t),r.d(t,"ToolController",function(){return n});var i=r("./src/compat.js"),o=r("./src/logger/Logger.js"),s=r("./src/application/EventTypes.js"),a=(r.n(s),r("./src/tools/KeyCode.js")),l=r("./src/application/GlobalManagerMixin.js");Object.defineProperty(n,"_lastTouchedElement",{value:null,writable:!0}),l.GlobalManagerMixin.call(n.prototype)},"./src/tools/ToolInterface.js":function(e,t,r){"use strict";function n(){this.names=["unnamed"],this.getNames=function(){return this.names},this.getName=function(){return this.names[0]},this.getPriority=function(){return 0},this.register=function(){},this.deregister=function(){},this.activate=function(e,t){},this.deactivate=function(e){},this.update=function(e){return!1},this.handleSingleClick=function(e,t){return!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return!1},this.handleDoubleTap=function(e){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(e){return!1},this.handleButtonDown=function(e,t){return!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(e){return!1},this.handleGesture=function(e){return!1},this.handleBlur=function(e){return!1},this.handleResize=function(){}}r.r(t),r.d(t,"ToolInterface",function(){return n})},"./src/tools/UnifiedCamera.js":function(e,t,r){"use strict";function n(e,t){i.Camera.call(this),this.fov=45,this.near=.1,this.far=1e5,this.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2,this.clientWidth=e,this.clientHeight=t,this.target=new i.Vector3(0,0,-1),this.worldup=new i.Vector3(0,1,0),this.orthographicCamera=new i.OrthographicCamera(this.left,this.right,this.top,this.bottom,this.near,this.far),this.perspectiveCamera=new i.PerspectiveCamera(this.fov,this.aspect,this.near,this.far),this.zoom=1,this.toPerspective()}r.r(t),r.d(t,"UnifiedCamera",function(){return n});var i=r("./thirdparty/three.js/three.js");r.n(i);n.ORTHO_FOV=2*Math.atan(.5)*180/Math.PI,n.prototype=Object.create(i.Camera.prototype),n.prototype.clone=function(){var e=new n(2*this.right,2*this.top);return i.Camera.prototype.clone.call(this,e),e.position.copy(this.position),e.up.copy(this.up),this.target&&(e.target=this.target.clone()),this.worldup&&(e.worldup=this.worldup.clone()),this.worldUpTransform&&(e.worldUpTransform=this.worldUpTransform.clone()),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e.fov=this.fov,e.aspect=this.aspect,e.zoom=this.zoom,e.clientWidth=this.clientWidth,e.clientHeight=this.clientHeight,e.isPerspective=this.isPerspective,this.updateProjectionMatrix(),e},n.prototype.__computeFovPosition=function(e){if(Math.abs(this.fov-e)<=1e-4)return this.position.clone();var t,r,n=this.target.clone().sub(this.position),o=n.clone().normalize(),s=i.Math.degToRad(this.fov),a=i.Math.degToRad(e),l=Math.tan(.5*s)/Math.tan(.5*a);if(this.pivot){var c=(new i.Plane).setFromNormalAndCoplanarPoint(o.clone().negate(),this.pivot);t=c.distanceToPoint(this.position),r=o.clone().multiplyScalar(t).add(this.position)}else t=n.length(),r=this.target;t*=l;var u=o.multiplyScalar(-t);return r.clone().add(u)},n.prototype.toPerspective=function(){!this.isPerspective&&this.saveFov&&(this.position.copy(this.__computeFovPosition(this.saveFov)),this.fov=this.saveFov),this.perspectiveCamera.aspect=this.aspect,this.perspectiveCamera.near=this.near,this.perspectiveCamera.far=this.far,this.perspectiveCamera.fov=this.fov/this.zoom,this.perspectiveCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspectiveCamera.projectionMatrix,this.isPerspective=!0},n.prototype.toOrthographic=function(){if(this.isPerspective){this.saveFov=this.fov;var e=n.ORTHO_FOV;this.position.copy(this.__computeFovPosition(e)),this.fov=e}this.orthoScale=this.target.clone().sub(this.position).length();var t=.5*this.orthoScale,r=t*this.aspect;this.left=this.orthographicCamera.left=-r,this.right=this.orthographicCamera.right=r,this.top=this.orthographicCamera.top=t,this.bottom=this.orthographicCamera.bottom=-t,this.orthographicCamera.near=this.near,this.orthographicCamera.far=this.far,this.orthographicCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthographicCamera.projectionMatrix,this.isPerspective=!1},n.prototype.updateProjectionMatrix=function(){this.isPerspective?this.toPerspective():this.toOrthographic()},n.prototype.setSize=function(e,t){this.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2},n.prototype.setFov=function(e){this.fov=e,this.updateProjectionMatrix()},n.prototype.setLens=function(e,t){void 0===t&&(t=24);var r=2*i.Math.radToDeg(Math.atan(t/(2*e)));return this.setFov(r),r},n.getViewParamsFromBox=function(e,t,r,n,o,s){var a=s||{},l=e.size();if(a.target=e.center(),a.position||(a.position=new i.Vector3),a.up||(a.up=new i.Vector3),t){a.isPerspective=!1;var c=l.x/l.y,u=r;u>c?a.orthoScale=l.y:a.orthoScale=l.x/u,a.up.set(0,1,0),a.position.copy(a.target),a.position.z+=a.orthoScale,a.target.y+=1e-6*l.y}else a.isPerspective=!0,a.fov=o,a.up.copy(n),a.position.copy(a.target),a.position.z+=1.5*Math.max(l.x,l.y,l.z);return a},n.prototype.setViewFromBox=function(e,t){n.getViewParamsFromBox(e,t,this.aspect,this.up,this.fov,this),this.updateCameraMatrices()},n.prototype.updateCameraMatrices=function(){this.lookAt(this.target),this.updateProjectionMatrix(),this.updateMatrixWorld(),this.matrixWorldInverse.getInverse(this.matrixWorld)},n.prototype.setView=function(e){e.position&&this.position.copy(e.position),e.target&&this.target.copy(e.target),e.up&&this.up.copy(e.up),void 0!==e.isPerspective&&(this.isPerspective=e.isPerspective),void 0!==e.orthoScale&&(this.orthoScale=e.orthoScale),this.updateCameraMatrices()}},"./src/tools/ViewingUtilities.js":function(e,t,r){"use strict";function n(e,t,r){function n(e){var t=500,r=32512,n=.6,o=0,s=new i.SphereGeometry(1),a=new i.MeshPhongMaterial({color:r,ambient:r,opacity:n,transparent:!0}),l=new i.Mesh(s,a),c=e,u=1;c.createOverlayScene("pivot"),l.visible=!1,this.shown=function(){return l.visible},this.show=function(e,r,i){l.scale.x=r*u,l.scale.y=r*u,l.scale.z=r*u,l.position.set(e.x,e.y,e.z),a.opacity=n,l.visible=!0,c.addOverlay("pivot",l),c.invalidate(!1,!1,!0),o=i?Date.now()+t:0},this.hide=function(){l.visible&&(l.visible=!1,c.removeOverlay("pivot",l),c.invalidate(!1,!1,!0),o=0)},this.fade=function(){if(o>0){var e=o-Date.now();if(0>=e)return this.hide(),!0;var r=e/t*n;return a.opacity=r,!0}return!1},this.fading=function(){return o>0},this.setSize=function(e){u=e},this.setColor=function(e,t){a.color=new i.Color(e),void 0!==t&&(n=t,a.opacity=n)}}function o(e,t,r){var n=t.clone().sub(e);if(0===n.lengthSq())return n.copy(r);var i=n.clone().cross(r);return 0===i.lengthSq()&&(r.z>r.y?n.y-=1e-4:n.z-=1e-4,i.crossVectors(n,r)),i.cross(n).normalize()}this.autocam=t,this.viewerImpl=e,this.setGlobalManager(this.viewerImpl.globalManager);var s=5,a=r.getCamera(),l={},c={},u=new n(this.viewerImpl);this.transitionView=function(e,n,i,s,l,c,u){l=l||r.getWorldUpVector();var d=c?o(e,n,l):s;d||(d=a.up),u=u||n;var h={position:e,center:n,pivot:u,fov:i,up:d,worldUp:l,isOrtho:a.isPerspective===!1};t.goToView(h)},this.goHome=function(){this.viewerImpl.track({name:"navigation/home",aggregate:"count"}),t.goHome()},this.getHitPoint=function(e,t){var n=this.viewerImpl.hitTestViewport(r.screenToViewport(e,t),!1);return n?n.intersectPoint:null},this.activatePivot=function(e){if(this.viewerImpl.model&&!this.viewerImpl.model.is2d()){var t=a.isPerspective?r.getPivotPlaneDistance():r.getEyeVector().length(),n=r.getVerticalFov(),o=2*t*Math.tan(i.Math.degToRad(.5*n)),l=r.getScreenViewport(),c=this.getWindow(),d=c.devicePixelRatio||1,h=s*o/(l.height*d);u.show(r.getPivotPoint(),h,e)}},this.pivotActive=function(e,t){return e=e&&!r.getIs2D(),t=t||!1,!e&&u.shown()?void u.hide():void(e&&this.activatePivot(t))},this.pivotUpdate=function(){u.shown()&&u.fade()&&this.viewerImpl.invalidate(!1,!1,!0)},this.setPivotPoint=function(e,t,n){r.setPivotPoint(e),t||r.setTarget(e),n&&r.setPivotSetFlag(!0),this.setTemporaryPivot(null),r.getIs2D()||u.shown()&&this.activatePivot(u.fading())},this.savePivot=function(e){e||(e="default"),l[e]=r.getPivotPoint(),c[e]=r.getPivotSetFlag()},this.restorePivot=function(e){if(e||(e="default"),l[e]){var t=c[e];this.setPivotPoint(l[e],!0,t),t||r.setPivotSetFlag(!1),delete l[e],delete c[e]}},this.setTemporaryPivot=function(e){if(e){var t=r.getPivotPoint(),n=r.getPivotSetFlag();this.setPivotPoint(e,!0,n),l.TEMP=t,c.TEMP=n}else delete l.TEMP,delete c.TEMP},this.removeTemporaryPivot=function(){this.restorePivot("TEMP")},this.setPivotSize=function(e){u.setSize(e)},this.setPivotColor=function(e,t){u.setColor(e,t)},this.getBoundingBox=function(e){return this.viewerImpl.getFitBounds(e)},this.fitToView=function(e){this.viewerImpl.track({name:"navigation/fit",aggregate:"count"}),this.viewerImpl.fitToView(this.viewerImpl.selector.getAggregateSelection(),e),this.activatePivot(!0)},this.update=function(){r.getRequestFitToView()&&!r.getTransitionActive()&&(r.setRequestFitToView(!1),this.fitToView()),r.getRequestHomeView()&&!r.getTransitionActive()&&(r.setRequestHomeView(!1),this.goHome());var e=r.getRequestTransition();return e&&!r.getTransitionActive()&&(r.setRequestTransition(!1),this.transitionView(e.position,e.coi,e.fov,e.up,e.worldUp,e.reorient,e.pivot)),!1}}r.r(t),r.d(t,"ViewingUtilities",function(){return n});var i=r("./thirdparty/three.js/three.js"),o=(r.n(i),r("./src/application/GlobalManagerMixin.js"));o.GlobalManagerMixin.call(n.prototype)},"./src/tools/VisibilityManager.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){this.viewerImpl=e,this.model=t,this.isolatedNodes=[],this.hiddenNodes=[]}function o(e){this.viewerImpl=e,this.models=[]}function s(e){var t=e.getAggregateIsolatedNodes();if(1===e.models.length){var r={type:l.ISOLATE_EVENT,nodeIdArray:t.length?t[0].ids:[],model:e.models[0]};e.viewerImpl.api.dispatchEvent(r)}var r={type:l.AGGREGATE_ISOLATION_CHANGED_EVENT,isolation:t};e.viewerImpl.api.dispatchEvent(r)}r.r(t),r.d(t,"VisibilityManager",function(){return i}),r.d(t,"MultiModelVisibilityManager",function(){return o});var a=r("./src/logger/Logger.js"),l=r("./src/application/EventTypes.js");r.n(l);i.prototype.getInstanceTree=function(){return this.model?this.model.getData().instanceTree:null},i.prototype.getIsolatedNodes=function(){return this.isolatedNodes.slice(0)},i.prototype.getHiddenNodes=function(){return this.hiddenNodes.slice(0)},i.prototype.setAllVisibility=function(e){var t=this.model?this.model.getRootId():null;t&&this.setVisibilityOnNode(t,e);var r=this.model.getData().is2d;
r&&this.model.setAllVisibility(e)},i.prototype.isNodeVisible=function(e){var t=this.getInstanceTree();return t?!t.isNodeHidden(e):-1==this.hiddenNodes.indexOf(e)&&(0==this.isolatedNodes.length||-1!=this.isolatedNodes.indexOf(e))},i.prototype.isolate=function(e){var t=this.getInstanceTree(),r=t?t.getRootId():null,i="number"==typeof e&&e===r||"object"==n(e)&&e.dbId===r;e&&!i?this.isolateMultiple(Array.isArray(e)?e:[e]):this.isolateNone()},i.prototype.isolateNone=function(){this.model.setAllVisibility(!0),this.viewerImpl.sceneUpdated(!0),this.setAllVisibility(!0),this.hiddenNodes=[],this.isolatedNodes=[],this.viewerImpl.invalidate(!0)},i.prototype.isolateMultiple=function(e){if(e&&0!=e.length){this.model.getData().is2d||(this.model.setAllVisibility(!1),this.viewerImpl.sceneUpdated(!0)),this.setAllVisibility(!1),this.isolatedNodes=e.slice(0),this.hiddenNodes=[];for(var t=0;t<e.length;t++)this.setVisibilityOnNode(e[t],!0)}else this.isolateNone();this.viewerImpl.invalidate(!0)},i.prototype.hide=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0;if(Array.isArray(e)){for(var n=0;n<e.length;++n)this.setVisibilityOnNode(e[n],!1);e.length>0&&(t={type:l.HIDE_EVENT,nodeIdArray:e,model:this.model})}else this.setVisibilityOnNode(e,!1),t={type:l.HIDE_EVENT,nodeIdArray:[e],model:this.model};t&&r&&this.viewerImpl.api.dispatchEvent(t)},i.prototype.show=function(e){var t;if(Array.isArray(e)){for(var r=0;r<e.length;++r)this.setVisibilityOnNode(e[r],!0);e.length>0&&(t={type:l.SHOW_EVENT,nodeIdArray:e,model:this.model})}else this.setVisibilityOnNode(e,!0),t={type:l.SHOW_EVENT,nodeIdArray:[e],model:this.model};t&&this.viewerImpl.api.dispatchEvent(t)},i.prototype.toggleVisibility=function(e){var t=this.getInstanceTree().isNodeHidden(e);this.setVisibilityOnNode(e,t);var r={type:t?l.SHOW_EVENT:l.HIDE_EVENT,nodeIdArray:[e],model:this.model};this.viewerImpl.api.dispatchEvent(r)},i.prototype.setVisibilityOnNode=function(e,t){var r=this.viewerImpl,n=this.model,i=this.getInstanceTree(),o=!t,s=n.getData().is2d;this.viewerImpl.matman();i?i.enumNodeChildren(e,function(e){var r=i.isNodeVisibleLocked(e);if(i.setNodeHidden(e,o&&!r),s){var a=n.reverseMapDbId(e);n.getFragmentList().setObject2DGhosted(a,!t&&!r)}else i.enumNodeFragments(e,function(e){n.setVisibility(e,t||r)},!1)},!0):s?n.getFragmentList().setObject2DGhosted(e,!t):n.setVisibility(e,t),r.sceneUpdated(!0),this.updateNodeVisibilityTracking(e,t)},i.prototype.updateNodeVisibilityTracking=function(e,t){var r=t;if(this.isolatedNodes.length>0){var n=this.isolatedNodes.indexOf(e);r&&-1===n?this.isolatedNodes.push(e):r||-1===n||(this.isolatedNodes.splice(n,1),0===this.isolatedNodes.length&&(this.hiddenNodes=[this.model.getRootId()]))}else{var i=this.hiddenNodes.indexOf(e);r||-1!==i?r&&-1!==i&&this.hiddenNodes.splice(i,1):this.hiddenNodes.push(e)}var o=this.getInstanceTree();o&&o.root&&o.root.dbId===e&&(t?(this.isolatedNodes=[],this.hiddenNodes=[]):(this.isolatedNodes=[],this.hiddenNodes=[e]))},i.prototype.toggleNodeVisibleLocked=function(e){var t=this.getInstanceTree().isNodeVisbileLocked(e);this.lockNodeVisible(e,!t)},i.prototype.lockNodeVisible=function(e,t){var r=this,n=this.viewerImpl,i=this.model,o=this.getInstanceTree(),s=i.getData().is2d;if(o){var a=function(e){o.enumNodeChildren(e,function(e){if(o.lockNodeVisible(e,t),t)if(o.setNodeHidden(e,!1),s){var r=i.reverseMapDbId(e);i.getFragmentList().setObject2DGhosted(r,!1)}else o.enumNodeFragments(e,function(e){i.setVisibility(e,!0)},!1)},!0),t&&(n.sceneUpdated(!0),r.updateNodeVisibilityTracking(e,t))};Array.isArray(e)?e.forEach(a):a(e)}},i.prototype.isNodeVisibleLocked=function(e){var t=this.getInstanceTree();return t&&t.isNodeVisibleLocked(e)},i.prototype.setNodeOff=function(e,t,r,n){var i=this.viewerImpl,o=this.model,s=this.getInstanceTree(),a=o.getData().is2d;if(!s)return a?o.getFragmentList().setObject2DVisible(e,!t):o.getFragmentList().setFragOff(e,t),void i.sceneUpdated(!0);if(r&&n){var l,c;if(a)for(var u=0;u<r.length;++u){l=r[u],s.setNodeOff(l,t);var d=o.reverseMapDbId(l);o.getFragmentList().setObject2DVisible(d,!t)}else{for(var h=0;h<r.length;++h)l=r[h],s.setNodeOff(l,t);for(var f=0;f<n.length;++f)c=n[f],o.getFragmentList().setFragOff(c,t)}}else s.enumNodeChildren(e,function(e){if(s.setNodeOff(e,t),a){var r=o.reverseMapDbId(e);o.getFragmentList().setObject2DVisible(r,!t)}else s.enumNodeFragments(e,function(e){o.getFragmentList().setFragOff(e,t)},!1)},!0);i.sceneUpdated(!0)},o.prototype.addModel=function(e){-1==this.models.indexOf(e)&&(e.visibilityManager=new i(this.viewerImpl,e),this.models.push(e))},o.prototype.removeModel=function(e){var t=this.models.indexOf(e);e.visibilityManager.isolateNone(),e.visibilityManager=null,this.models.splice(t,1)},o.prototype.warn=function(){this.models.length>1&&a.logger.warn("This selection call does not yet support multiple models.")},o.prototype.getAggregateIsolatedNodes=function(){for(var e=[],t=this.models,r=0;r<t.length;r++){var n=t[r].visibilityManager.getIsolatedNodes();n&&n.length&&e.push({model:t[r],ids:n})}return e},o.prototype.getIsolatedNodes=function(e){return e||(this.warn(),e=this.models[0]),e.visibilityManager.getIsolatedNodes()},o.prototype.getAggregateHiddenNodes=function(){for(var e=[],t=this.models,r=0;r<t.length;r++){var n=t[r].visibilityManager.getHiddenNodes();n&&n.length&&e.push({model:t[r],ids:n})}return e},o.prototype.getHiddenNodes=function(e){return e||(this.warn(),e=this.models[0]),e.visibilityManager.getHiddenNodes()},o.prototype.isNodeVisible=function(e,t){return e||(this.warn(),e=this.models[0]),e.visibilityManager.isNodeVisible(t)},o.prototype.isolate=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.isolate(e),s(this)},o.prototype.aggregateIsolate=function(e,t){if(e&&0!==e.length){for(var r=this.models.concat(),n=0;n<e.length;++n){var i=e[n].model,o=e[n].ids||e[n].selection,a=r.indexOf(i);r.splice(a,1),i.visibilityManager.isolate(o)}for(var l=t?void 0!==t.hideLoadedModels&&t.hideLoadedModels:!0;r.length&&l;)r.pop().visibilityManager.setAllVisibility(!1)}else for(var n=0;n<this.models.length;++n)this.models[n].visibilityManager.isolateNone();s(this)},o.prototype.hide=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.hide(e)},o.prototype.aggregateHide=function(e){if(e&&0!==e.length){for(var t=0;t<e.length;++t){var r=e[t].model,n=e[t].ids||e[t].selection;r.visibilityManager.hide(n,1===this.models.length)}var i=this.getAggregateHiddenNodes(),o={type:l.AGGREGATE_HIDDEN_CHANGED_EVENT,hidden:i};this.viewerImpl.api.dispatchEvent(o)}},o.prototype.show=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.show(e)},o.prototype.toggleVisibility=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.toggleVisibility(e)},o.prototype.setVisibilityOnNode=function(e,t,r){r||(this.warn(),r=this.models[0]),r.visibilityManager.setVisibilityOnNode(e,t)},o.prototype.toggleVisibleLocked=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.toggleVisibleLocked(e)},o.prototype.lockNodeVisible=function(e,t,r){r||(this.warn(),r=this.models[0]),r.visibilityManager.lockNodeVisible(e,t)},o.prototype.isNodeVisibleLocked=function(e,t){return t||(this.warn(),t=this.models[0]),t.visibilityManager.isNodeVisibleLocked(e,t)},o.prototype.setNodeOff=function(e,t,r,n,i){r||(this.warn(),r=this.models[0]),r.visibilityManager.setNodeOff(e,t,n,i)}},"./src/tools/WorldUpTool.js":function(e,t,r){"use strict";function n(e,t){function r(e,t){function r(e,t){var r=Math.abs(e-t);return r>p?r:Math.min(p-r,r)}function n(e,t){var r=m(e);return r.distanceToSquared(t)<g?!0:(P.set(-t.x,-t.y,-t.z),r.distanceToSquared(P)<g)}function o(e,t){for(var i=Z+J+2*Math.PI/180,o=0;6>o;++o)if(W[o]!==ee)for(var s=o+1;6>s;++s)if(W[s]!==ee){var a=r(W[o],W[s]);if(i>a){if(e[o]<e[s]&&!n(o,t)||n(s,t)){W[o]=ee;break}W[s]=ee}}}function l(e){return e>p?e:0>=e?e+Math.PI:e-Math.PI}function u(e,t,r){var n=e.clone().normalize(),i=new Array(3),s=new Array(6);i[0]=f(1,0,0,n),i[1]=f(0,1,0,n),i[2]=f(0,0,1,n);var a,c=t.clone().cross(n).normalize();for(a=0;3>a;++a){var u=i[a];s[a]=u.length(),s[a]<te?W[a]=ee:(u.multiplyScalar(1/s[a]),W[a]=Math.atan2(c.dot(u),t.dot(u)))}for(W[3]=l(W[0]),W[4]=l(W[1]),W[5]=l(W[2]),s[3]=s[0],s[4]=s[1],s[5]=s[2],o(s,r),a=0;6>a;++a)if(W[a]!==ee){var d=P.set(0,0,1);L.setFromAxisAngle(d,W[a]);var h=P.set(0,.54,0);h.applyQuaternion(L),G[a].position.copy(h),G[a].visible=!0}else G[a].visible=!1}function d(){B=new i.Object3D;var e=new i.RingGeometry(.5-.01*R,.5,60),t=new i.Mesh(e,C);N=t;var r=.007*R,n=new i.BoxGeometry(.93,r,r),o=new i.BoxGeometry(r,.93,r),s=new i.BoxGeometry(r,r,.93);F=new i.Mesh(n,C),V=new i.Mesh(o,C),U=new i.Mesh(s,C),B.add(F),B.add(V),B.add(U),z=new i.Mesh(new i.CircleGeometry(.005),C),B.add(z),G=new Array(6),H=new Array(6);for(var a=0;6>a;++a){var l=.005*R,c=.0025*R;G[a]=new i.Mesh(new i.CircleGeometry(l,16),C),H[a]=new i.Mesh(new i.CircleGeometry(c,16),C),H[a].visible=!1,G[a].add(H[a]),t.add(G[a])}return B.add(t),B}function h(e,t,r,n,i){return B||(B=d()),c.orient(N,t,D.position,n),u(r,i,n),B.scale.x=e,B.scale.y=e,B.scale.z=e,B.position.copy(t),B}function m(e){if(j.set(0,0,0),e>=0){var t=e>=3?-1:1;e%=3,0===e&&(j.x=t),1===e&&(j.y=t),2===e&&(j.z=t)}return Y&&j.multiplyScalar(-1),j}function v(e,t){for(var n=r(W[0],e),i=0,o=1;6>o;++o){var s=r(W[o],e);n>s&&(n=s,i=o)}return q=n,t>n?i:-1}function y(e){c.setWorldUpVector(e,!0)}function _(e){if(0!==e){var t=30*Math.PI/180,r=P.copy(D.position).sub(k).normalize();L.setFromAxisAngle(r,e);var n=c.getWorldUpVector(),i=Math.abs(r.angleTo(n));(t>i||Math.PI-i<t)&&n.copy(c.getCameraUpVector()),n.applyQuaternion(L),y(n)}}function b(){if(!K){var e=v(X,Z);if(e>=0)return q=0,K=!0,X=W[e],m(e)}return!1}function x(){if(K){var e=v(X,J);if(0>e)return K=!1,!0;q=0}return!1}function w(e,t,r,n){var i=t>e;if(i){var o=m(r);return o.distanceToSquared(n)<g}return!1}function E(e,t){var n=e.dot(t),i=0>n;i&&(t=t.clone().multiplyScalar(-1)),c.orient(z,k,D.position,t),z.position.copy(t.multiplyScalar(.495));for(var o=!1,s=K?J:Z,a=0;6>a;++a){var l=r(W[a],X),u=w(l,s,a,e);u&&(o=!0);var d=u?4:3*(1-3*l/Math.PI);1>d&&(d=1),d*=R,H[a].visible=u;var h=G[a];h.scale.x=d,h.scale.y=d,h.scale.z=d}return F.visible=o,V.visible=o,U.visible=o,o}function S(e){X+=e,X>Math.PI?X-=p:X<=-Math.PI&&(X=p+X);var t=b();if(t)Q=X,y(t);else if(x()){var r=X-Q;_(r),Q=0}else{if(K)return!1;_(e)}return!0}var A=12303291,M=30,T=2*Math.tan(i.Math.degToRad(.5*M)),C=new i.MeshPhongMaterial({color:A,ambient:A,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1}),j=new i.Vector3,P=new i.Vector3,L=new i.Quaternion,D=new i.PerspectiveCamera(M,t.aspect,t.near,t.far),I=t,R=1,O=1,k=null,N=null,F=null,V=null,U=null,B=null,z=null,G=null,H=null,W=new Array(6),q=0,X=0,Y=!1,K=!0,Q=0,Z=5*Math.PI/180,J=7*Math.PI/180,$=1,ee=1e3,te=.1;e.createOverlayScene("roll",null,null,D),this.updateRollCamera=function(e,t){D.position.copy(I.position),D.quaternion.copy(I.quaternion),D.up.copy(I.up),D.aspect=I.aspect,e&&t&&(D.near=t-e,D.far=t+e),D.updateProjectionMatrix()},this.isSnapped=function(){return K},this.resize=function(){var e=$*T,t=e*I.aspect,r=(I.aspect<1?t:e)*O;B.scale.x=r,B.scale.y=r,B.scale.z=r},this.start=function(t,r){this.updateHUD(t,r),e.addOverlay("roll",B)},this.updateHUD=function(e,t){k=e,s>t?t=s:t>a&&(t=a),O=t,R=a/t;var r=j.copy(e).sub(I.position);$=r.length();var n=$*T,i=n*I.aspect,o=(I.aspect<1?i:n)*t;this.updateRollCamera(o,$);var l=c.getWorldUpVector(),u=c.getCameraUpVector();h(o,e,r,l,u),X=0,Q=0;var d=l.dot(u);Y=0>d,K=E(l,u)},this.handleRoll=function(e,t,r){if(this.updateRollCamera(),E(c.getWorldUpVector(),c.getCameraUpVector()),0!==e||0!==t){var n=r.x-e-.5,i=r.y-t-.5,o=r.x-.5,s=r.y-.5;return S(Math.atan2(s,o)-Math.atan2(i,n))}return!1},this.handleRollTouch=function(e){this.updateRollCamera(),E(c.getWorldUpVector(),c.getCameraUpVector());var t=e-X;return Math.abs(t)>.001?S(t):!1},this.end=function(){e.removeOverlay("roll",B)}}function n(e){var t=e.pointers[1].clientX-e.pointers[0].clientX,r=e.pointers[1].clientY-e.pointers[0].clientY,n=Math.sqrt(t*t+r*r),i=c.getScreenViewport();return n/Math.min(i.width,i.height)}var s=.35,a=.8,l=.65,c=t.navigation,u=c.getCamera(),d=["worldup"],h=this,f=function(){var e=new i.Vector3;return function(t,r,n,o){var s=new i.Vector3(t,r,n),a=o.dot(s);return e.copy(o),e.multiplyScalar(a),s.sub(e)}}(),p=2*Math.PI,m=.001,g=1e-5,v=!1,y=!1,_=!1,b=new r(e,u),x=new i.Vector3,w=new i.Vector3,E=new i.Vector3,S=null,A=0,M={x:.5,y:.5},T=1;this.getNames=function(){return d},this.getName=function(){return d[0]},this.activate=function(e){t.addEventListener(o.CAMERA_CHANGE_EVENT,this.handleCameraChange),_=!1},this.deactivate=function(e){b.end(),t.removeEventListener(o.CAMERA_CHANGE_EVENT,this.handleCameraChange),this.utilities.restorePivot(),S=null,v=!1,_=!1},this.getCursor=function(){return"auto"},this.getMotionDelta=function(e){var t=w.x-x.x,r=w.y-x.y,n=w.z-x.z;Math.abs(t)<m&&(t=0),Math.abs(r)<m&&(r=0),Math.abs(n)<m&&(n=0),e.set(t,r,n)},this.stepMotionDelta=function(){x.copy(w)},this.update=function(){if(!_){var e=c.getEyeVector(),t=.5*(u.near+u.far);e.normalize().multiplyScalar(t);var r=e.add(u.position);this.utilities.savePivot(),this.utilities.setPivotPoint(r,!0,!0),this.utilities.pivotActive(!0);var n=l;b.start(r,n),_=!0}var i=y;this.getMotionDelta(E);var o=E.x,s=E.y,a=E.z;return(y||"roll"===S||v&&(0!==o||0!==s||0!==a))&&(y="roll"===S?b.handleRollTouch(A):b.handleRoll(o,s,w)),this.stepMotionDelta(),u.dirty&&(i=!0),i},this.handleResize=function(){b.resize(),y=!0},this.handleGesture=function(e){switch(e.type){case"dragstart":return S="drag",this.handleButtonDown(e,0);case"dragmove":return this.handleMouseMove(e);case"dragend":return S=null,this.handleButtonUp(e,0);case"rotatestart":return t.removeEventListener(o.CAMERA_CHANGE_EVENT,this.handleCameraChange),S="roll",A=i.Math.degToRad(e.rotation),M={x:.5*(e.normalizedX+1),y:1-.5*(e.normalizedY+1)},T=n(e),!0;case"rotatemove":return A=i.Math.degToRad(e.rotation),"roll"===S;case"rotateend":return t.addEventListener(o.CAMERA_CHANGE_EVENT,this.handleCameraChange),A=i.Math.degToRad(e.rotation),S=null,!1}return!1},this.handleWheelInput=function(e){return!0},this.handleCameraChange=function(){var e=c.getEyeVector(),t=.5*(u.near+u.far);e.normalize().multiplyScalar(t);var r=e.add(u.position);b.updateHUD(r,l)},this.handleButtonDown=function(e,r){return x.x=.5*(e.normalizedX+1),x.y=1-.5*(e.normalizedY+1),w.copy(x),v=!0,S=null,this.controller.setIsLocked(!0),t.removeEventListener(o.CAMERA_CHANGE_EVENT,h.handleCameraChange),!0},this.handleButtonUp=function(e,r){return w.x=.5*(e.normalizedX+1),w.y=1-.5*(e.normalizedY+1),v=!1,y=!0,this.controller.setIsLocked(!1),t.addEventListener(o.CAMERA_CHANGE_EVENT,h.handleCameraChange),!0},this.handleMouseMove=function(e){return w.x=.5*(e.normalizedX+1),w.y=1-.5*(e.normalizedY+1),!0},this.handleBlur=function(e){return v=!1,S=null,!1}}r.r(t),r.d(t,"WorldUpTool",function(){return n});var i=r("./thirdparty/three.js/three.js"),o=(r.n(i),r("./src/application/EventTypes.js"));r.n(o)},"./src/tools/autocam/Autocam.js":function(e,t,r){"use strict";function n(e){var t=1e-12;Math.abs(e.x)<t&&Math.abs(e.y)<t?e.set(0,0,e.z>0?1:-1):Math.abs(e.y)<t&&Math.abs(e.z)<t?e.set(e.x>0?1:-1,0,0):Math.abs(e.z)<t&&Math.abs(e.x)<t&&e.set(0,e.y>0?1:-1,0)}function i(e,t,r){function i(t){S=!0,e.target.copy(w.center),e.pivot.copy(w.pivot),e.worldup?e.worldup.copy(w.sceneUpDirection):e.up.copy(w.sceneUpDirection),w.cameraChangedCallback(t),S=!1}function a(e,t,r){if(t>=e)return 0;if(e>=r)return 1;var n=(e-t)/(r-t);return.5*(Math.sin((n-.5)*Math.PI)+1)}function c(e,t,r){return t*(1-e)+r*e}function u(e){return Math.round(10*e)/10}function d(e,t){var r=new o.Vector2(0,0),n=w.getWindow();return r.x=e/n.innerWidth,r.y=t/n.innerHeight,r}function h(e,t,r){var n,i,o,s;n=i=o=s=0;var a=0,l=null,c=null,u=w.snapOrbitDeadZone,d=w.orbitMultiplier;return"h"==e?(n=w.snapOrbitThresholdH,i=w.snapOrbitAccelerationAX,o=w.snapOrbitAccelerationBX,s=1-w.snapOrbitAccelerationPointX,c=w.lockDeltaX,l=w.lockedX):(n=w.snapOrbitThresholdV,i=w.snapOrbitAccelerationAY,o=w.snapOrbitAccelerationBY,s=1-w.snapOrbitAccelerationPointY,c=w.lockDeltaY,l=w.lockedY),l?(c+=r,-u>c?(a=(c+u)*d*1/o,l=!1):c>u&&(a=(c-u)*d*1/o,l=!1)):(a=Math.abs(t)>n?r*d:Math.abs(t)>s*n?r*t>0?r*d*i:r*d*1/i:r*t>0?r*d*o:r*d*1/o,a*t>0&&Math.abs(a)>Math.abs(t)&&(this.lockDeltaX=this.lockDeltaY=0,l=!0,a=t)),a}function f(){return w.combined}function p(e,t){var r=30,n=!1,i=w.getWindow(),o=i.innerWidth,s=e.x%o,a=i.innerHeight,l=e.y%a,c=s>0?s-t.x:o+s-t.x,u=l>0?l-t.y:a+l-t.y;return Math.abs(c)<r&&Math.abs(u)<r&&(n=!0),n}function m(e,t,r){var n=w.getWindow();r.x=(e.x-t.x)/n.innerWidth,e.x=t.x+(e.x-t.x)%n.innerWidth,r.y=(e.y-t.y)/n.innerHeight,e.y=t.y+(e.y-t.y)%n.innerHeight}function g(e,t,r){var n=w.getWindow();if(!H||!e){if(e){var i=30,s=new o.Vector2,a=t.x,l=t.y;m(t,r,s),z=n.innerWidth*s.x,G=n.innerHeight*s.y,a<r.x?a-=2*i:a+=2*i,l<r.y?l-=2*i:l+=2*i}H=e}}function v(e,t,r){if(0===t)return 0;var n=e,i=w.saveEye.clone().sub(worldUp.clone().multiplyScalar(r+n)),o=w.saveEye.clone().sub(worldUp.clone().multiplyScalar(r)),s=0,a=(w.maxSceneBound-w.minSceneBound)/1e3;w.topLimit&&t>0?(s=w.maxSceneBound-a,w.topLimit=!1):w.bottomLimit&&0>t?(s=w.minSceneBound+a,w.bottomLimit=!1):s=i.dot(worldUp);var l=o.dot(worldUp);return s<w.minSceneBound?l<w.minSceneBound&&(w.bottomLimit=!0,n=0):s>w.maxSceneBound&&l>w.maxSceneBound&&(w.topLimit=!0,n=0),n}function _(e){var t=Math.pow(e,2);0>e&&(t=-t);var r=d(0,t),n=w.maxSceneBound-w.minSceneBound,i=.01*n;r.y*=i;var o=w.userHeightSpeed*r.y;return o=v(o,e,w.m_amount)}function b(e){var t=w.sceneFrontDirection.clone().cross(w.sceneUpDirection),r=Math.abs(Math.abs(e.dot(w.sceneUpDirection))-1),n=Math.abs(Math.abs(e.dot(w.sceneFrontDirection))-1),i=Math.abs(Math.abs(e.dot(t))-1);return 1e-5>r||1e-5>n||1e-5>i}var w=this,E=null,S=!1;this.cube=null,this.camera=e,this.renderer="WEBGL",this.startState={},this.navApi=t,this.orthographicFaces=!1,this.canvas=r,this.cameraChangedCallback=function(){},this.pivotDisplayCallback=function(){},this.transitionCompletedCallback=function(){};var A,M=Date.now(),T=!1;this.recordTime=!0,this.dtor=function(){this.cube=null,this.cameraChangedCallback=null,this.pivotDisplayCallback=null,this.transitionCompletedCallback=null,this.canvas=null,this.recordTime=!1},this.registerCallbackCameraChanged=function(e){this.cameraChangedCallback=e},this.registerCallbackPivotDisplay=function(e){this.pivotDisplayCallback=e},this.registerCallbackTransitionCompleted=function(e){this.transitionCompletedCallback=e},this.showPivot=function(e){this.pivotDisplayCallback(e)},this.setWorldUpVector=function(e){S||e&&e.lengthSq()>0&&!e.normalize().equals(this.sceneUpDirection)&&(this.sceneUpDirection.copy(e),this.sceneFrontDirection.copy(this.getWorldFrontVector()),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.cube&&requestAnimationFrame(this.cube.render))},this.getWorldUpVector=function(){return this.sceneUpDirection.clone()},this.getWorldRightVector=function(){var e=this.sceneUpDirection.clone();return Math.abs(e.z)<=Math.abs(e.y)?e.set(e.y,-e.x,0):e.z>=0?e.set(e.z,0,-e.x):e.set(-e.z,0,e.x),e.normalize()},this.getWorldFrontVector=function(){var e=this.getWorldUpVector();return e.cross(this.getWorldRightVector()).normalize()},this.goToView=function(e){if(this.navApi.isActionEnabled("gotoview")){var t={position:e.position.clone(),up:e.up.clone(),center:e.center.clone(),pivot:e.pivot.clone(),fov:e.fov,worldUp:e.worldUp.clone(),isOrtho:e.isOrtho};w.elapsedTime=0,this.animateTransition(t)}},this.getCurrentView=function(){return{position:e.position.clone(),up:e.up.clone(),center:this.center.clone(),pivot:this.pivot.clone(),fov:e.fov,worldUp:this.sceneUpDirection.clone(),isOrtho:e.isPerspective===!1}},this.setCurrentViewAsHome=function(e){e?(this.navApi.setRequestFitToView(!0),T=!0):this.homeVector=this.getCurrentView()},this.setHomeViewFrom=function(e){var t=e.pivot?e.pivot:this.center,r=e.target?e.target:this.pivot,n=e.worldup?e.worldup:this.sceneUpDirection;this.homeVector={position:e.position.clone(),up:e.up.clone(),center:r.clone(),pivot:t.clone(),fov:e.fov,worldUp:n.clone(),isOrtho:e.isPerspective===!1},this.originalHomeVector={position:e.position.clone(),up:e.up.clone(),center:r.clone(),pivot:t.clone(),fov:e.fov,worldUp:n.clone(),worldFront:this.sceneFrontDirection.clone(),isOrtho:e.isPerspective===!1}},this.toPerspective=function(){e.isPerspective||(e.toPerspective(),i(!1))},this.toOrthographic=function(){e.isPerspective&&(e.toOrthographic(),i(!1))},this.setOrthographicFaces=function(e){this.orthographicFaces=e},this.setViewType=function(e,t){switch(e){case 1:return this.setOrthographicFaces(!1),this.toOrthographic(),!0;case 2:return this.setOrthographicFaces(!1),this.toPerspective(),!0;case 3:return this.setOrthographicFaces(!0),void 0===t&&(t=this.isFaceView()),t?this.toOrthographic():this.toPerspective(),!0;default:return!1}},this.goHome=function(){this.navApi.isActionEnabled("gotoview")&&(this.navApi.setPivotSetFlag(!1),this.goToView(this.homeVector))},this.resetHome=function(){this.homeVector.position.copy(this.originalHomeVector.position),this.homeVector.up.copy(this.originalHomeVector.up),this.homeVector.center.copy(this.originalHomeVector.center),this.homeVector.pivot.copy(this.originalHomeVector.pivot),this.homeVector.fov=this.originalHomeVector.fov,this.homeVector.worldUp.copy(this.originalHomeVector.worldUp),this.homeVector.isOrtho=this.originalHomeVector.isOrtho,this.goHome()},this.getView=function(){return this.center.clone().sub(e.position)},this.setCameraUp=function(t){var r=this.dir.clone(),n=r.cross(t).normalize();0===n.lengthSq()&&(r.copy(this.dir),t.z>t.y?r.y+=1e-4:r.z+=1e-4,n=r.cross(t).normalize()),e.up.copy(n).cross(this.dir).normalize()};var C=this;!function q(){C.recordTime&&requestAnimationFrame(q);var e=Date.now();A=e-M,M=e}(),this.ortho=!1,this.center=e.target?e.target.clone():new o.Vector3(0,0,0),this.pivot=e.pivot?e.pivot.clone():this.center.clone(),this.sceneUpDirection=e.worldup?e.worldup.clone():e.up.clone(),this.sceneFrontDirection=this.getWorldFrontVector(),this.dir=this.getView(),this.setCameraUp(e.up),this.saveCenter=this.center.clone(),this.savePivot=this.pivot.clone(),this.saveEye=e.position.clone(),this.saveUp=e.up.clone();var j,P,L,D;this.cubeFront=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),this.setHomeViewFrom(e);var I,R,O=new o.Quaternion,k=new o.Quaternion,N=new o.Quaternion,F=new o.Quaternion;this.userPanSpeed=.5,this.userLookSpeed=2,this.userHeightSpeed=5,this.walkMultiplier=1,this.userZoomSpeed=1.015,this.orbitMultiplier=5,this.currentlyAnimating=!1,e.keepSceneUpright=!0,this.preserveOrbitUpDirection=!0,this.alignOrbitUpDirection=!0,this.constrainOrbitHorizontal=!1,this.constrainOrbitVertical=!1,this.doCustomOrbit=!1,this.snapOrbitDeadZone=.045,this.snapOrbitThresholdH=this.snapOrbitThresholdV=o.Math.degToRad(15),this.snapOrbitAccelerationAX=this.snapOrbitAccelerationAY=1.5,this.snapOrbitAccelerationBX=this.snapOrbitAccelerationBY=2,this.snapOrbitAccelerationPointX=this.snapOrbitAccelerationPointY=.5,this.combined=!1,this.useSnap=!1,this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new o.Vector3(0,0,0),this.topLimit=!1,this.bottomLimit=!1,this.minSceneBound=0,this.maxSceneBound=0;var V={destinationPercent:1,duration:1,zoomToFitScene:!0,useOffAxis:!1};this.shotParams=V;var U,B;this.zoomDelta=new o.Vector2;var z,G,H,W=0;this.viewCubeMenuOpen=!1,this.menuSize=new o.Vector2(0,0),this.menuOrigin=new o.Vector2(0,0),e.lookAt(this.center),this.setCube=function(e){this.cube=e},this.sync=function(t){t.isPerspective!==e.isPerspective&&(t.isPerspective?e.toPerspective():(e.toOrthographic(),t.saveFov&&(e.saveFov=t.saveFov))),e.fov=t.fov,e.position.copy(t.position),t.target&&(this.center.copy(t.target),e.target.copy(t.target)),t.pivot&&(this.pivot.copy(t.pivot),e.pivot.copy(t.pivot)),this.dir.copy(this.center).sub(e.position),this.setCameraUp(t.up);var r=t.worldup?t.worldup:t.up;r.distanceToSquared(this.sceneUpDirection)>1e-4&&this.setWorldUpVector(r),T&&!this.navApi.getTransitionActive()&&(T=!1,this.setCurrentViewAsHome(!1)),this.cube&&requestAnimationFrame(this.cube.render)},this.refresh=function(){this.cube&&this.cube.refreshCube()},o.Matrix3.prototype.makeRotationFromQuaternion=function(e){var t=this.elements,r=e.x,n=e.y,i=e.z,o=e.w,s=r+r,a=n+n,l=i+i,c=r*s,u=r*a,d=r*l,h=n*a,f=n*l,p=i*l,m=o*s,g=o*a,v=o*l;return t[0]=1-(h+p),t[3]=u-v,t[6]=d+g,t[1]=u+v,t[4]=1-(c+p),t[7]=f-m,t[2]=d-g,t[5]=f+m,t[8]=1-(c+h),this},o.Quaternion.prototype.setFromRotationMatrix3=function(e){var t,r=e.elements,n=r[0],i=r[3],o=r[6],s=r[1],a=r[4],l=r[7],c=r[2],u=r[5],d=r[8],h=n+a+d;return h>0?(t=.5/Math.sqrt(h+1),this.w=.25/t,this.x=(u-l)*t,this.y=(o-c)*t,this.z=(s-i)*t):n>a&&n>d?(t=2*Math.sqrt(1+n-a-d),this.w=(u-l)/t,this.x=.25*t,this.y=(i+s)/t,this.z=(o+c)/t):a>d?(t=2*Math.sqrt(1+a-n-d),this.w=(o-c)/t,this.x=(i+s)/t,this.y=.25*t,this.z=(l+u)/t):(t=2*Math.sqrt(1+d-n-a),this.w=(s-i)/t,this.x=(o+c)/t,this.y=(l+u)/t,this.z=.25*t),this},o.Quaternion.prototype.rotate=function(e){var t=(new o.Matrix4).makeRotationFromQuaternion(this),r=t.elements,n=(new o.Matrix3).set(r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10]);return e.applyMatrix3(n)},this.animateTransition=function(t){if(t){var r=!1,n=0;if(this.setCameraOrtho(t.isOrtho),w.elapsedTime>=V.duration)return n=1,w.center.copy(t.center),w.pivot.copy(t.pivot),e.position.copy(t.position),e.up.copy(t.up),e.target.copy(t.center),t.isOrtho||(e.fov=t.fov),e.dirty=!0,r=!t.worldUp.equals(this.sceneUpDirection),r&&this.setWorldUpVector(t.worldUp),this.currentlyAnimating=!1,i(r),this.showPivot(!1),this.cube&&requestAnimationFrame(this.cube.render),this.navApi.setTransitionActive(!1),void this.transitionCompletedCallback();this.currentlyAnimating=!0,this.showPivot(!0),this.navApi.setTransitionActive(!0);var o=V.destinationPercent;n=a(w.elapsedTime/V.duration,0,o);var s=1-n;w.elapsedTime+=A/500;var l=w.center.clone().multiplyScalar(s).add(t.center.clone().multiplyScalar(n)),c=e.position.clone().multiplyScalar(s).add(t.position.clone().multiplyScalar(n)),u=e.up.clone().multiplyScalar(s).add(t.up.clone().multiplyScalar(n)),d=e.pivot.clone().multiplyScalar(s).add(t.pivot.clone().multiplyScalar(n)),h=this.sceneUpDirection.clone().multiplyScalar(s).add(t.worldUp.clone().multiplyScalar(n)),f=e.fov*s+t.fov*n;w.center.copy(l),w.pivot.copy(d),e.position.copy(c),e.up.copy(u),e.target.copy(l),t.isOrtho||(e.fov=f),e.dirty=!0,r=h.distanceToSquared(this.sceneUpDirection)>1e-4,r&&this.setWorldUpVector(h),e.lookAt(w.center),i(r),this.cube&&requestAnimationFrame(this.cube.render),requestAnimationFrame(function(){w.animateTransition(t)})}},this.sphericallyInterpolateTransition=function(t){var r,n,s,l=0;if(this.currentlyAnimating=!0,this.navApi.setTransitionActive(!0),w.elapsedTime>=V.duration)l=1,this.currentlyAnimating=!1;else{var u=V.destinationPercent;l=a(w.elapsedTime/V.duration,0,u),w.elapsedTime+=A/500}if(1===l)n=B.position,r=B.center,s=B.up;else{var d=new o.Matrix3,h=O.clone();h.slerp(k,l),d.makeRotationFromQuaternion(h);var f=c(l,I,R),p=d.elements;r=U.center.clone().multiplyScalar(1-l).add(B.center.clone().multiplyScalar(l)),n=r.clone().sub(new o.Vector3(p[0],p[1],p[2]).multiplyScalar(f)),s=new o.Vector3(p[3],p[4],p[5])}w.center.copy(r),e.position.copy(n),e.up.copy(s),w.navApi.getUsePivotAlways()||w.pivot.copy(r),e.lookAt(w.center),this.currentlyAnimating===!0?(this.showPivot(!0),requestAnimationFrame(function(){w.sphericallyInterpolateTransition(t)})):(this.navApi.setTransitionActive(!1),this.showPivot(!1),this.orthographicFaces&&this.isFaceView()&&this.setCameraOrtho(!0),t&&t()),i(!1),this.cube&&requestAnimationFrame(this.cube.render)},this.getOrientation=function(){if(this.cube){var t=u(e.up.x),r=u(e.up.y),n=u(e.up.z),i=this.sceneFrontDirection.clone(),o=this.sceneUpDirection.clone(),s=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();i.x=u(i.x),i.y=u(i.y),i.z=u(i.z),o.x=u(o.x),o.y=u(o.y),o.z=u(o.z),s.x=u(s.x),s.y=u(s.y),s.z=u(s.z);var a=s.clone().multiplyScalar(-1),l=o.clone().multiplyScalar(-1),c=i.clone().multiplyScalar(-1);switch(this.cube.currentFace){case"front":if(o.x==t&&o.y==r&&o.z==n)return"up";if(l.x==t&&l.y==r&&l.z==n)return"down";if(s.x==t&&s.y==r&&s.z==n)return"right";if(a.x==t&&a.y==r&&a.z==n)return"left";break;case"right":if(o.x==t&&o.y==r&&o.z==n)return"up";if(l.x==t&&l.y==r&&l.z==n)return"down";if(c.x==t&&c.y==r&&c.z==n)return"left";if(i.x==t&&i.y==r&&i.z==n)return"right";break;case"left":if(o.x==t&&o.y==r&&o.z==n)return"up";if(l.x==t&&l.y==r&&l.z==n)return"down";if(i.x==t&&i.y==r&&i.z==n)return"left";if(c.x==t&&c.y==r&&c.z==n)return"right";break;case"back":if(o.x==t&&o.y==r&&o.z==n)return"up";if(l.x==t&&l.y==r&&l.z==n)return"down";if(a.x==t&&a.y==r&&a.z==n)return"right";if(s.x==t&&s.y==r&&s.z==n)return"left";break;case"top":if(c.x==t&&c.y==r&&c.z==n)return"down";if(i.x==t&&i.y==r&&i.z==n)return"up";if(s.x==t&&s.y==r&&s.z==n)return"right";if(a.x==t&&a.y==r&&a.z==n)return"left";break;case"bottom":if(i.x==t&&i.y==r&&i.z==n)return"down";if(c.x==t&&c.y==r&&c.z==n)return"up";if(s.x==t&&s.y==r&&s.z==n)return"right";if(a.x==t&&a.y==r&&a.z==n)return"left"}}},this.setCameraOrtho=function(t){t&&e.isPerspective&&e.toOrthographic(),t||e.isPerspective||e.toPerspective()},this.resetOrientation=function(){this.cube&&this.cube.showCompass(this.cube.prevRenderCompass),this.setCameraOrtho(this.originalHomeVector.isOrtho),this.sceneUpDirection.copy(this.originalHomeVector.worldUp),this.sceneFrontDirection.copy(this.originalHomeVector.worldFront),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.setCameraUp(this.sceneUpDirection),i(!0)},this.setCurrentViewAsFront=function(){this.cube&&(this.cube.currentFace="front",this.cube.showCompass(!1)),this.sceneUpDirection.copy(e.up.clone()),n(this.sceneUpDirection),this.sceneFrontDirection.copy(this.getView()).normalize(),n(this.sceneFrontDirection),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),n(this.cubeFront),this.orthographicFaces&&this.setCameraOrtho(!0),i(!0)},this.setCurrentViewAsTop=function(){this.cube&&(this.cube.currentFace="top",this.cube.showCompass(!1)),this.sceneUpDirection.copy(this.getView()).multiplyScalar(-1).normalize(),n(this.sceneUpDirection),this.sceneFrontDirection.copy(e.up),n(this.sceneFrontDirection),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),n(this.cubeFront),i(!0)},this.calculateCubeTransform=function(t){var r=this.sceneUpDirection.clone(),n=this.sceneFrontDirection.clone(),i=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();U=e.clone(),U.center=w.center.clone(),U.pivot=w.pivot.clone(),B=e.clone(),B.center=w.center.clone(),B.pivot=w.pivot.clone();var s=new o.Vector3(0,0,0);t.indexOf("back")>=0&&(s=s.add(n)),t.indexOf("front")>=0&&(s=s.sub(n)),t.indexOf("top")>=0&&(s=s.add(r)),t.indexOf("bottom")>=0&&(s=s.sub(r)),t.indexOf("right")>=0&&(s=s.add(i)),t.indexOf("left")>=0&&(s=s.sub(i));var a=r,c=s.clone().normalize();if(1-Math.abs(c.dot(r))<l)for(var u=this.getView().normalize(),d=[n.clone(),n.clone().negate(),i.clone(),i.clone().negate()],h=c.dot(r)>0?1:-1,f=u.clone().add(e.up.clone().multiplyScalar(h)).normalize(),p=-2,m=0;4>m;m++){var g=f.dot(d[m]);g>p&&(p=g,a=d[m].multiplyScalar(h))}R=I=this.getView().length(),B.position.copy(B.center.clone().add(s.multiplyScalar(R/s.length()))),B.up.copy(a);var v=U.center.clone().sub(U.position).normalize(),y=v.clone().cross(U.up).normalize(),_=y.clone().cross(v).normalize(),b=new o.Matrix3;b.set(v.x,_.x,y.x,v.y,_.y,y.y,v.z,_.z,y.z),O.setFromRotationMatrix3(b),v=B.center.clone().sub(B.position).normalize(),y=v.clone().cross(B.up).normalize(),_=y.clone().cross(v).normalize(),b.set(v.x,_.x,y.x,v.y,_.y,y.y,v.z,_.z,y.z),N.setFromAxisAngle(v,0),F.setFromAxisAngle(_,0),
k.setFromRotationMatrix3(b),k.multiply(N).multiply(F).normalize()},this.drawDropdownMenu=function(e,t,r,n,i,o,a){var l=0,c=this.getDocument();if(E)o.appendChild(E);else{E=c.createElement("div"),E.className="dropDownMenu",E.style.top="100px",E.style.left="-400px";for(var u=0,d=0,h=0;h<e.length;h++){var f;if(null===e[h])f=c.createElement("li"),f.style.height="1px",u+=1,f.style.backgroundColor="#E0E0E0";else{var p=s.i18n.translate(e[h]);if(d=p.length>d?p.length:d,r[h]){f=c.createElement("div");var m=c.createElement("input"),g=c.createElement("label");m.type="radio",m.className="dropDownMenuCheck",g.innerHTML=p,g.className="dropDownMenuCheckText",f.appendChild(m),f.appendChild(g),f.className="dropDownMenuCheckbox"}else f=c.createElement("li"),f.textContent=p,f.className=t[h]?"dropDownMenuItem":"dropDownMenuItemDisabled";f.id="menuItem"+l,l++,u+=25,f.setAttribute("data-i18n",e[h])}E.appendChild(f)}o.appendChild(E),E.style.minWidth=Math.max(256,7.4*d)+"px";var v=E.getBoundingClientRect().width;this.menuSize.x=v,this.menuSize.y=u}l=0;for(var h=0;h<e.length;h++)if(null!==e[h]){if(r[h]){var y="menuItem"+l,_=c.getElementById(y);_&&(_.children[0].checked=r[h]())}l++}var b=i-15,x=n+1,w=this.canvas.getBoundingClientRect();x+this.menuSize.x>w.right&&(x=n-this.menuSize.x-1),b+this.menuSize.y>w.bottom&&(b=w.bottom-this.menuSize.y),b-=a.y,x-=a.x,E.style.top=b+"px",E.style.left=x+"px",this.menuOrigin.x=x,this.menuOrigin.y=b},this.removeDropdownMenu=function(e){e.removeChild(E)},this.isFaceView=function(){var t=this.center.clone().sub(e.position).normalize();return b(t)&&b(e.up)},this.startInteraction=function(e,t){this.startCursor=new o.Vector2(e,t),this.startState={saveCenter:this.center.clone(),saveEye:this.camera.position.clone(),savePivot:this.pivot.clone(),saveUp:this.camera.up.clone()},this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new o.Vector3(0,0,0),this.navApi.setTransitionActive(!0)},this.orbit=function(t,r,n,s){if(this.navApi.isActionEnabled("orbit")&&this.currentlyAnimating!==!0){var a="wheel";if(w.orthographicFaces&&!e.isPerspective&&(e.toPerspective(),s&&s.saveEye.copy(this.camera.position)),s&&(a="cube"),"cube"==a?(this.saveCenter.copy(s.saveCenter),this.saveEye.copy(s.saveEye),this.savePivot.copy(s.savePivot),this.saveUp.copy(s.saveUp),this.useSnap=!0,this.doCustomOrbit=!0):(this.saveCenter.copy(this.center),this.savePivot.copy(this.pivot),this.saveEye.copy(e.position),this.saveUp.copy(e.up),this.useSnap=!1,this.doCustomOrbit=!1),f()&&void 0==P&&(P=this.saveCenter.clone(),j=this.saveEye.clone(),D=this.savePivot.clone(),L=this.saveUp.clone()),this.preserveOrbitUpDirection){var l=d(t.x-r.x,t.y-r.y),c=d(n.x,n.y),u=this.sceneUpDirection.clone(),p=this.sceneFrontDirection.clone(),m=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),g=f()?D:this.savePivot,v=f()?j:this.saveEye,y=f()?P:this.saveCenter,_=f()?L:this.saveUp,b=g.clone().sub(v).normalize(),x=y.clone().sub(v).normalize(),E=x.clone().cross(_),S=v.clone().sub(g).length(),A=v.clone().sub(y).length(),M=b.clone().multiplyScalar(-1),T=x.clone().multiplyScalar(-1),C=E,I=_.clone(),R=0,O=0;if(!this.constrainOrbitHorizontal){var k=u.dot(this.saveUp),N=.009;-N>k&&(l.x=-l.x,c.x=-c.x);var F=0;F=f()?c.x*this.orbitMultiplier:this.useSnap?this.lastSnapRotateX+h("h",R,-c.x):l.x*this.orbitMultiplier,this.lastSnapRotateX=F;var V=(new o.Quaternion).setFromAxisAngle(u,-F);M.applyQuaternion(V),T.applyQuaternion(V),C.applyQuaternion(V),I.applyQuaternion(V)}if(!this.constrainOrbitVertical){var U=p.clone().multiplyScalar(p.dot(C)),B=m.clone().multiplyScalar(m.dot(C)),z=U.clone().add(B);z.clone().normalize();var G=0;if(f())G=c.y*this.orbitMultiplier;else{var H=h("v",O,c.y);G=this.useSnap?this.lastSnapRotateY+H:l.y*this.orbitMultiplier}var W=(new o.Quaternion).setFromAxisAngle(z,-G);if(this.navApi.getOrbitPastWorldPoles())M.applyQuaternion(W).normalize(),T.applyQuaternion(W).normalize(),I.applyQuaternion(W).normalize();else{var q=I.clone();q.applyQuaternion(W).normalize();var X=u.dot(q);if(0>X){var Y=T.clone();Y.applyQuaternion(W).normalize();var K=Y.angleTo(u);Math.abs(K)>.5*Math.PI&&(K-=K>0?Math.PI:-Math.PI),G-=K,W.setFromAxisAngle(z,-G),M.applyQuaternion(W).normalize(),T.applyQuaternion(W).normalize(),I.applyQuaternion(W).normalize()}else M.applyQuaternion(W).normalize(),T.applyQuaternion(W).normalize(),I.applyQuaternion(W).normalize()}this.lastSnapRotateY=G}var Q=M.multiplyScalar(S).add(g);e.position.copy(Q),e.up.copy(I),this.center.copy(Q),this.center.sub(T.multiplyScalar(A)),f()&&(P.copy(this.center),j.copy(e.position),D.copy(this.pivot),L.copy(e.up))}e.lookAt(this.center),i(!1)}},this.endInteraction=function(){this.navApi.setTransitionActive(!1)},this.look=function(t){if(this.navApi.isActionEnabled("walk")){var r=d(t.x,t.y),n=this.userLookSpeed,s=this.getView(),a=e.up,l=s.clone().cross(a).normalize(),c=this.sceneUpDirection.clone(),u=r.clone();u.x*=Math.PI,u.y*=Math.PI/e.aspect,u.multiplyScalar(n);var h=(new o.Quaternion).setFromAxisAngle(l,-u.y);if(e.keepSceneUpright&&!this.navApi.getOrbitPastWorldPoles()){var f=a.clone();if(f.applyQuaternion(h).normalize(),f.dot(c)<0){var p=s.clone();p.applyQuaternion(h);var m=p.angleTo(c);Math.abs(m)>.5*Math.PI&&(m-=m>0?Math.PI:-Math.PI),u.y-=m,h.setFromAxisAngle(l,-u.y)}}s=h.clone().rotate(s),a=h.clone().rotate(a),a.normalize();var g=e.keepSceneUpright?c:a,v=(new o.Quaternion).setFromAxisAngle(g,-u.x);s=v.clone().rotate(s),a=v.clone().rotate(a),this.center.copy(s.add(e.position)),e.up.copy(a),e.lookAt(this.center),i(!1)}},this.pan=function(t){if(this.navApi.isActionEnabled("pan")){t=d(t.x,t.y);var r=this.getView(),n=e.up.clone().cross(r),s=r.clone().cross(n);n.normalize(),s.normalize(),r.normalize();var a=this.pivot.clone().sub(e.position),l=r.clone().dot(a),c=l*(Math.tan(o.Math.degToRad(e.leftFov))+Math.tan(o.Math.degToRad(e.rightFov))),u=l*(Math.tan(o.Math.degToRad(e.topFov))+Math.tan(o.Math.degToRad(e.bottomFov))),h=t.x*Math.abs(c),f=t.y*Math.abs(u),p=new o.Vector3,m=n.clone().multiplyScalar(h),g=s.clone().multiplyScalar(f);p=m.clone().add(g).clone().multiplyScalar(this.userPanSpeed),e.position.add(p),this.center.add(p),e.lookAt(this.center),i(!1)}},this.zoom=function(t){if(this.navApi.isActionEnabled("zoom")){var r=this.userZoomSpeed,n=Number.MAX_VALUE,o=t.x+t.y,s=Math.pow(r,o),a=this.pivot.clone().sub(this.pivot.clone().sub(this.saveEye).clone().multiplyScalar(s)),l=a.clone().add(w.D.clone().multiplyScalar(w.D.clone().dot(this.pivot.clone().sub(a).clone())));if(!(s>=n)){if(o>0){var c=0;Math.pow(r,o-c);if(c>o)return void(W=0);e.position.copy(a),this.center.copy(l);var u=a.clone().sub(this.saveEye).dot(w.D);u>n?(e.position.copy(this.saveEye.sub(w.D).clone().multiplyScalar(n)),W=n>0?-1:0):W=-(u/n)}else e.position.copy(a),this.center.copy(l);e.lookAt(this.center),i(!1)}}},this.walk=function(t,r,n,s,c){if(this.navApi.isActionEnabled("walk")){var u=this.sceneUpDirection.clone(),h=this.sceneFrontDirection.clone(),f=this.sceneFrontDirection.clone().cross(this.sceneUpDirection),m=!0,v=.01;p(t,r)?(wheel.cursorImage("SWWalk"),g(!0,t,r),x=r.x,y=r.y):g(!1,t,r),x=t.x,y=t.y;var _=d(x-r.x,y-r.y),b=-_.x,w=-_.y,E=0>b?-1:1,S=0>w?-1:1,A=Math.abs(b),M=Math.abs(w),T=new o.Vector2(30,30);T=d(T.x,T.y),A=p(t,r)?0:Math.abs(b)-T.x,M=p(t,r)?0:Math.abs(w)-T.y;var C=.25;A/=C,M/=C,A=1>A?a(A,0,1):Math.pow(A,1),M=1>M?a(M,0,1):Math.pow(M,1);var j=A>0?A*E:0,P=M>0?M*S:0,L=this.getView(),D=L.length();L.normalize();var I=L.clone().cross(e.up);I.normalize();var R=f.clone().multiplyScalar(f.clone().dot(L)),O=h.clone().multiplyScalar(h.clone().dot(L)),k=O.clone().add(R);k=k.clone().length()>l?k.normalize():e.up;var N=1,F=P*(this.walkMultiplier*N),V=m?k:L;if(m){var U=Math.cos(.65);1!=U&&(u.clone().dot(e.up)<-l&&u.clone().dot(L)<-U||u.clone().dot(e.up)>l&&u.clone().dot(L)>U)&&(V=-V)}var B=-j*this.walkMultiplier*.05,z=e.up;m&&((u.clone().dot(e.up)<-l||Math.abs(u.clone().dot(e.up))<l&&u.clone().dot(L)>l)&&(B=-B),z=u);var G=(new o.Quaternion).setFromAxisAngle(z,B);G.normalize(),L=G.clone().rotate(L),L.normalize(),e.up.copy(G.clone().rotate(e.up)),e.up.normalize(),e.position.add(V.clone().multiplyScalar(F)),this.center.copy(e.position.clone().add(L.clone().multiplyScalar(D))),V=m?u:e.up,V.normalize(),0===F&&(F=v),e.lookAt(this.center),i(!1)}},this.updown=function(t){if(!this.navApi.getIsLocked()){var r=t,n=_(r);w.m_amount+=n;var s=new o.Vector3(0,1,0),a=w.saveEye.clone().sub(s.clone().multiplyScalar(w.m_amount)),l=a.clone().dot(s);e.position.copy(a),l<w.minSceneBound&&e.position.add(s.clone().multiplyScalar(w.minSceneBound-l)),l>w.maxSceneBound&&e.position.add(s.clone().multiplyScalar(w.maxSceneBound-l)),this.center.copy(e.position.clone().add(w.saveCenter.clone().sub(w.saveEye))),e.lookAt(this.center),i(!1)}}}r.r(t),r.d(t,"Autocam",function(){return i});var o=r("./thirdparty/three.js/three.js"),s=(r.n(o),r("./src/globalization/i18next.js")),a=r("./src/application/GlobalManagerMixin.js"),l=Number.MIN_VALUE||3e-308;a.GlobalManagerMixin.call(i.prototype)},"./src/tools/autocam/ViewCube.js":function(e,t,r){"use strict";function n(e){var t=e/2,r=10,n=50,i={x:16711680,y:65280,z:255},s=new o.Matrix4,a=[],l=new o.PlaneBufferGeometry(n,n),c=function(e,t){var r=p.getGlobal().document,n=r.createElement("canvas");n.width=n.height=128;var i=n.getContext("2d");i.font="128px Arial",i.fillStyle="rgba(255,255,255,1)",i.textAlign="center",i.textBaseline="middle",i.fillText(e,n.width/2,n.height/2);var s=new o.Texture(n);return s.needsUpdate=!0,new o.Mesh(l,new o.MeshBasicMaterial({map:s,side:o.DoubleSide,transparent:!0,color:t,depthWrite:!1,depthTest:!0}))};this.triadScene=new o.Scene,this.triadLabelScene=new o.Scene;var u=new o.BoxGeometry(e,r,r),d=new o.Mesh(u,new o.MeshBasicMaterial({color:i.x,shading:o.SmoothShading})),h=new o.Mesh(u,new o.MeshBasicMaterial({color:i.y,shading:o.SmoothShading})),f=new o.Mesh(u,new o.MeshBasicMaterial({color:i.z,shading:o.SmoothShading}));d.applyMatrix(s.makeTranslation(r/2,-t,-t)),h.applyMatrix(s.makeRotationZ(Math.PI/2)),h.applyMatrix(s.makeTranslation(-t,r/2,-t)),f.applyMatrix(s.makeRotationY(Math.PI/2)),f.applyMatrix(s.makeTranslation(-t,-t,r/2)),this.triadScene.add(d),this.triadScene.add(h),this.triadScene.add(f);var v=c("X",i.x),y=c("Y",i.y),_=c("Z",i.z),b=function(e){var r=-(n+t)/2-20,i=t+n;v.position.set(i,r,r),y.position.set(r,i,r),_.position.set(r,r,i),e&&(v.position.applyQuaternion(e),y.position.applyQuaternion(e),_.position.applyQuaternion(e))};b(),a.push(v),a.push(y),a.push(_),this.triadLabelScene.add(v),this.triadLabelScene.add(y),this.triadLabelScene.add(_),this.orient=function(e,t){if(g(e)&&g(t)&&!(this.up&&this.front&&e.equals(this.up)&&t.equals(this.front))){this.up=e.clone(),this.front=t.clone();var r,n,i,s=0,a=0,l=0;e.x?(r="x",n="y",i="z",s=2*Math.PI/3):e.y?(r="y",n="z",i="x"):e.z&&(r="z",n="x",i="y",s=-2*Math.PI/3),m(-t[n])?a=Math.PI:t[i]&&(a=-t[i]*e[r]*Math.PI/2),l=m(-e[r])?Math.PI:0;var c=new o.Quaternion,u=new o.Quaternion,d=new o.Vector3(1,1,1);d.normalize(),u.setFromAxisAngle(d,s),c.setFromAxisAngle(e,a),u.multiply(c),c.setFromAxisAngle(t,l),u.multiply(c),b(u),this.triadScene.setRotationFromQuaternion(u)}},this.getSprites=function(){return a}}function i(e,t,r,i,p){function m(e,t){var r={};return 0===e.type.indexOf("touch")?e.touches.length>0?(r.clientX=e.touches[0].clientX,r.clientY=e.touches[0].clientY,r.pageX=e.touches[0].pageX,r.pageY=e.touches[0].pageY,r.screenX=e.touches[0].screenX,r.screenY=e.touches[0].screenY,r.movementX=r.screenX-t.prevX,r.movementY=r.screenY-t.prevY,r.which=_.navApi.getUseLeftHandedInput()?3:1):r=t.prevCoords:(r.clientX=e.clientX,r.clientY=e.clientY,r.pageX=e.pageX,r.pageY=e.pageY,r.screenX=e.screenX,r.screenY=e.screenY,r.which=e.which,ie?(r.movementX=e.movementX||e.mozMovementX||e.webkitMovementX||0,r.movementY=e.movementY||e.mozMovementY||e.webkitMovementY||0):(r.movementX=r.screenX-t.prevX,r.movementY=r.screenY-t.prevY)),t.prevX=r.screenX,t.prevY=r.screenY,t.prevCoords=r,r}var y=this;f.GlobalManagerMixin.call(this);var _=t,b=t.camera;t.setCube(this),y.currentFace="front",y.showTriad=p&&p.showTriad,y.localizeResourcePath=i;var x,w,E,S,A,M,T,C,j=["top,front","top right","top,left","top,back","bottom,front","bottom,right","bottom,left","bottom,back","left,front","front,right","right,back","back,left"],P=["front,top,right","back,top,right","front,top,left","back,top,left","front,bottom,right","back,bottom,right","front,bottom,left","back,bottom,left"],L=["Go Home",null,"Orthographic","Perspective","Perspective with Ortho Faces",null,"Set current view as Home","Focus and set as Home","Reset Home",null,"Set current view as Front","Set current view as Top","Reset orientation"],D=[!0,null,!0,!0,!0,null,!0,!0,!0,null,!0,!0,!0],I=[null,null,function(){return!_.orthographicFaces&&!b.isPerspective},function(){return!_.orthographicFaces&&b.isPerspective},function(){return _.orthographicFaces},null,null,null,null,null,null,null,null],R=[];y.pcam=new o.PerspectiveCamera(45,1,1,2e3),y.ocam=new o.OrthographicCamera(-265,265,265,-265,-1e3,1e3),y.ocam.fov=y.pcam.fov,y.ocam.aspect=y.pcam.aspect,y.camera=b.isPerspective?y.pcam:y.ocam,y.camera.position.copy(b.position),y.center=new o.Vector3(0,0,0),y.camera.lookAt(y.center);var O,k,N,F,V,U,B,z,G,H,W,q,X=[],Y=[],K=[],Q=[],Z=[],J=null,$=null,ee=null,te=0,re=0,ne=!0,ie=!1,oe=!1,se=!1,ae=-1!=navigator.userAgent.search("Chrome"),le=-1!=navigator.platform.search("Win32"),ce=!1,ue=!1,de=null,he=[];this.width=0,this.height=0,this.animSpeed=500,this.animate=!0,this.compass=!1,this.viewScaleFactorCompass=1.5,this.viewScale=1,this.draggable=!0,this.wantHomeButton=!1,this.wantRollArrows=!0,this.wantContextMenu=!0,this.inactiveOpacity=.5;var fe=function(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top,w:t.width,h:t.height}},pe=function(e){e.preventDefault(),e.stopPropagation();var t=y.getDocument();oe=t.pointerLockElement===r||t.mozPointerLockElement===r||t.webkitPointerLockElement===r},me=function(){var e=30;y.renderCompass?(y.rollMesh.position.set(te+e,te+e,0),y.rollLeftMesh.position.set(te+e,1.5*te,.1),y.rollRightMesh.position.set(1.5*te,te+e,.1),y.contextMesh.position.set(1.6*te,-1.6*te,0)):(y.rollMesh.position.set(.5*te+20,.5*te+20,0),y.rollLeftMesh.position.set(.5*te+20,te+20,.1),y.rollRightMesh.position.set(te+20,.5*te+20,.1),y.contextMesh.position.set(te,-te,0))},ge=function(){var e=r.getBoundingClientRect();y.width=e.width,y.height=e.height,q=fe(r),C=new o.PerspectiveCamera(70,y.height/y.width,1,1e4),C.position.set(0,0,500),x=new o.Scene,w=new o.Scene,E=new o.Scene,S=new o.Scene,M=new o.Scene,ne=!0,te=160,y.viewScale=4*te;var t=y.refreshTexture(),i=o.LinearFilter,s=Autodesk.Viewing.Private.getResourceUrl,a="res/textures/",u=new o.BoxGeometry(te,te,te,4,4,4),d=new o.BoxGeometry(te+1,te+1,te+1,4,4,4);O=new o.Mesh(u,t),O.position.set(0,0,0),w.add(O);var h=be(s(a+"VCedge1.png"));h.minFilter=h.maxFilter=i,k=new o.Mesh(d,new o.MeshBasicMaterial({map:h,overdraw:!1,transparent:!0,shading:o.SmoothShading})),k.position.set(0,0,0),S.add(k),A=new n(te+20),Array.prototype.push.apply(R,A.getSprites());var f=te+5,p=new o.Geometry,m=new o.Vector3(-30,0,0),g=new o.Vector3(30,0,0),b=new o.Vector3(0,-30,0);p.vertices.push(m),p.vertices.push(g),p.vertices.push(b),p.faces.push(new o.Face3(1,0,2)),p.computeFaceNormals();var T=new o.MeshBasicMaterial({overdraw:!0,color:v,depthTest:!1,depthWrite:!1,transparent:!1,opacity:1,shading:o.FlatShading}),j=new o.MeshBasicMaterial({overdraw:!0,color:v,depthTest:!1,depthWrite:!1,transparent:!1,opacity:1,shading:o.FlatShading}),P=new o.MeshBasicMaterial({overdraw:!0,color:v,depthTest:!1,depthWrite:!1,transparent:!1,opacity:1,shading:o.FlatShading}),L=new o.MeshBasicMaterial({overdraw:!0,color:v,depthTest:!1,depthWrite:!1,transparent:!1,opacity:1,shading:o.FlatShading}),D=new o.PlaneBufferGeometry(.5*te,.3*te,2,2),I=new o.MeshBasicMaterial({transparent:!0,opacity:0}),X=new o.Mesh(p,T),K=new o.Mesh(D,I);X.position.set(0,f,0),K.position.set(0,.9*f,.1);var Z=new o.Mesh(p,j),J=new o.Mesh(D,I);Z.position.set(0,-f,0),J.position.set(0,.9*-f,.1),Z.rotation.z+=Math.PI,J.rotation.z+=Math.PI;var $=new o.Mesh(p,P),ee=new o.Mesh(D,I);$.position.set(f,0,0),ee.position.set(.9*f,0,.1),$.rotation.z-=Math.PI/2,ee.rotation.z-=Math.PI/2;var re=new o.Mesh(p,L),oe=new o.Mesh(D,I);re.position.set(-f,0,0),oe.position.set(.9*-f,0,.1),re.rotation.z+=Math.PI/2,oe.rotation.z+=Math.PI/2,U=new o.Object3D,U.position.set(0,0,0),U.add(X),U.add(Z),U.add($),U.add(re),M.add(K),M.add(J),M.add(ee),M.add(oe),M.add(U),Y.push(K),Y.push(J),Y.push(ee),Y.push(oe);var se=new o.PlaneBufferGeometry(te/3,te/3,2,2),ae=new o.MeshBasicMaterial({map:be(s(a+"VChome.png")),transparent:!0,shading:o.FlatShading});N=new o.Mesh(se,ae),N.position.set(-te,te,0),H=Q.length,M.add(N),Q.push(N);var le=new o.PlaneBufferGeometry(1.5*te,1.5*te,2,2),ce=new o.MeshBasicMaterial({map:be(s(a+"VCarrows.png")),shading:o.FlatShading,depthTest:!1,depthWrite:!1,transparent:!0}),ue=new o.Mesh(le,ce);y.rollMesh=ue;var de=new o.PlaneBufferGeometry(.6*te,.45*te,2,2),ge=new o.MeshBasicMaterial({transparent:!0,opacity:0}),ve=new o.Mesh(de,ge);y.rollLeftMesh=ve;var ye=new o.PlaneBufferGeometry(.45*te,.6*te,2,2),_e=new o.MeshBasicMaterial({transparent:!0,opacity:0}),we=new o.Mesh(ye,_e);y.rollRightMesh=we,M.add(ue),M.add(ve),M.add(we),B=Q.length,Q.push(ve),z=Q.length,Q.push(we),G=Q.length,Q.push(ue);var Ee=new o.PlaneBufferGeometry(te/2.3,te/2.3,2,2),Ae=new o.MeshBasicMaterial({map:be(s(a+"VCcontext.png")),transparent:!0,depthTest:!1,depthWrite:!1,shading:o.FlatShading});V=new o.Mesh(Ee,Ae),y.contextMesh=V,W=Q.length,M.add(V),Q.push(V),me();var Me=new o.Geometry;Me.vertices.push(new o.Vector3(0,0,0));var Te=Math.floor(.2*te/2)||20;Me.vertices.push(new o.Vector3(-te/2,-te/2-Te,-te/2)),Me.vertices.push(new o.Vector3(te/2,-te/2-Te,-te/2)),Me.vertices.push(new o.Vector3(te/2,-te/2-Te,te/2)),Me.vertices.push(new o.Vector3(-te/2,-te/2-Te,te/2)),Me.faces.push(new o.Face3(4,3,2)),Me.faces.push(new o.Face3(4,2,1));var je;if(je=new o.MeshBasicMaterial({color:0,transparent:!0,opacity:.5}),F=new o.Mesh(Me,je),x.add(F),xe(),"CANVAS"===_.renderer.toUpperCase()?y.renderer=new o.CanvasRenderer:"WEBGL"===_.renderer.toUpperCase()?y.renderer=new l.WebGLRenderer({alpha:!0,antialias:!1}):(c.logger.warn("Incorrect use of Autocam.renderer property"),y.renderer=new o.CanvasRenderer),y.useTransparency(!0),y.setSize(y.width,y.height),y.camera.topFov=y.camera.bottomFov=y.camera.fov/2,y.camera.leftFov=y.camera.rightFov=y.camera.aspect*y.camera.fov/2,y.pcam.topFov=y.ocam.topFov=y.camera.topFov,y.pcam.bottomFov=y.ocam.bottomFov=y.camera.bottomFov,y.pcam.leftFov=y.ocam.leftFov=y.camera.leftFov,y.pcam.rightFov=y.ocam.rightFov=y.camera.rightFov,y.renderer.autoClear=!1,y.renderer.setSize(y.width,y.height),y.renderer.sortObjects=!1,r.appendChild(y.renderer.domElement),r.addEventListener("touchstart",Se,!1),r.addEventListener("mousedown",Se,!1),r.addEventListener("mousemove",Ce,!1),ie=!1){var Pe=y.getDocument();Pe.exitPointerLock=Pe.exitPointerLock||Pe.mozExitPointerLock||Pe.webkitExitPointerLock,r.requestPointerLock=r.requestPointerLock||r.mozRequestPointerLock||r.webkitRequestPointerLock,y.addDocumentEventListener("pointerlockchange",pe,!1),y.addDocumentEventListener("mozpointerlockchange",pe,!1),y.addDocumentEventListener("webkitpointerlockchange",pe,!1)}he.push(be(s(a+"VChomeS.png"))),he.push(be(s(a+"VCarrowsS0.png"))),he.push(be(s(a+"VCarrowsS1.png"))),he.push(be(s(a+"VChome.png"))),he.push(be(s(a+"VCarrows.png"))),he.push(be(s(a+"VCcontext.png"))),he.push(be(s(a+"VCcontextS.png")))},ve=function(){_.navApi.isActionEnabled("orbit")&&(r.style.opacity="1.0",ue=!1),requestAnimationFrame(y.render)},ye=function(e){if(ue||_.viewCubeMenuOpen||!_.navApi.isActionEnabled("orbit"))_.navApi.isActionEnabled("orbit")&&(r.style.opacity=1);else{var t=Math.max(4*Math.abs((e.clientX-q.x)/q.w-.5)-1,0),n=Math.max(4*Math.abs((e.clientY-q.y)/q.h-.5)-1,0),i=Math.max(0,Math.min(Math.sqrt(t*t+n*n),1));r.style.opacity=1-i*(1-y.inactiveOpacity)}},_e=function(){_.viewCubeMenuOpen||(r.style.opacity=y.inactiveOpacity,ue=!0,requestAnimationFrame(y.render))},be=function(e){var t=new Image,r=y.getWindow(),n=h.endpoint.getUseCredentials()&&(-1===e.indexOf("://")||-1!==e.indexOf(r.location.host));n?t.crossOrigin="use-credentials":t.crossOrigin="anonymous";var i=new o.Texture(t);return t.onload=function(){i.needsUpdate=!0,re++,re>=11&&requestAnimationFrame(y.render)},t.src=e,i},xe=function(){var e,t=[],r=[];t[0]=De(0,0),t[1]=De(0,Math.PI/2),t[2]=De(0,-Math.PI/2),t[3]=De(0,Math.PI),t[4]=De(Math.PI/2,0),t[5]=De(Math.PI/2,Math.PI/2),t[6]=De(Math.PI/2,-Math.PI/2),t[7]=De(Math.PI/2,Math.PI),r[0]=Le(0,0,0),r[1]=Le(0,Math.PI/2,0),r[2]=Le(0,-Math.PI/2,0),r[3]=Le(0,Math.PI,0),r[4]=Le(Math.PI/2,0,0),r[5]=Le(Math.PI/2,Math.PI/2,0),r[6]=Le(Math.PI/2,-Math.PI/2,0),r[7]=Le(Math.PI/2,Math.PI,0),r[8]=Le(0,0,Math.PI/2),r[9]=Le(0,0,-Math.PI/2),r[10]=Le(-Math.PI/2,0,-Math.PI/2),r[11]=Le(-Math.PI,0,-Math.PI/2),X.push(Pe(0,0)),X[0].name="front",K.push(X[0]),Z.push(X[0]),E.add(X[0]),X.push(Pe(0,Math.PI/2)),X[1].name="right",K.push(X[1]),Z.push(X[1]),E.add(X[1]),X.push(Pe(0,Math.PI)),X[2].name="back",K.push(X[2]),Z.push(X[2]),E.add(X[2]),X.push(Pe(0,-Math.PI/2)),X[3].name="left",K.push(X[3]),Z.push(X[3]),E.add(X[3]),X.push(Pe(Math.PI/2,0)),X[4].name="bottom",K.push(X[4]),Z.push(X[4]),E.add(X[4]),X.push(Pe(-Math.PI/2,0)),X[5].name="top",K.push(X[5]),Z.push(X[5]),E.add(X[5]),e=X.length;var n;for(n=0;n<t.length;n++)X.push(t[n]),X[e+n].name=P[n],E.add(X[e+n]),K.push(X[e+n]),Z.push(X[e+n]);for(e=X.length,n=0;n<r.length;n++)X.push(r[n]),X[e+n].name=j[n],E.add(X[e+n]),K.push(X[e+n]),Z.push(X[e+n])},we=function(e,t,r){var n,i=new o.Vector3;if("PerspectiveCamera"===t.type)i.copy(e),i.unproject(t),n=new o.Raycaster(t.position,i.sub(t.position).normalize());else{var s=new o.Vector3;s.copy(e),s.unproject(t),i.copy(t.position).negate().normalize(),n=new o.Raycaster(s,i)}return n.intersectObjects(r)},Ee=function(e,t){var r=e.clientX-t.x,n=e.clientY-t.y;return r=r/t.w*2-1,n=(t.h-n)/t.h*2-1,new o.Vector3(r,n,.5)},Se=function(e){if(e.preventDefault(),e.stopPropagation(),_.navApi.isActionEnabled("orbit")&&!_.currentlyAnimating){var t=m(e,y);q=fe(r),r.removeEventListener("mousemove",Ce,!1),y.addDocumentEventListener("mouseup",Te,!1),y.addDocumentEventListener("touchend",Te,!1),_.navApi.getUsePivotAlways()||(_.pivot.copy(_.center),_.navApi.setPivotPoint(_.center),_.navApi.setPivotSetFlag(!1)),_.startInteraction(t.pageX,t.pageY);var n,i,o=_.navApi.getUseLeftHandedInput()?1:3;if(t.which!==o){if(y.animSpeed<=0)return void c.logger.error("animSpeed cannot be 0 or less, use ViewCube.animate flag to turn on and off animation",Object(d.errorCodeString)(d.ErrorCodes.VIEWER_INTERNAL_ERROR));i=Ee(t,q),n=we(i,y.camera,Z),n.length>0&&(Oe(),y.draggable&&(y.addDocumentEventListener("mousemove",Ae,!1),y.addDocumentEventListener("touchmove",Ae,!1),ie&&(r.requestPointerLock(),se=ae&&le)))}}},Ae=function Be(e){if(e.preventDefault(),e.stopPropagation(),y.animSpeed<=0)return y.removeDocumentEventListener("mousemove",Be,!1),y.removeDocumentEventListener("touchmove",Be,!1),void c.logger.error("animSpeed cannot be 0 or less",Object(d.errorCodeString)(d.ErrorCodes.VIEWER_INTERNAL_ERROR));if(!_.currentlyAnimating){var t=m(e,y);if(ie&&se&&(se=!1,t.movementX=t.movementY=0),oe&&(t.movementX>300||t.movementY>300)&&(t.movementX=0,t.movementY=0),t.movementX===t.movementY&&0===t.movementX)return void(_.currentlyAnimating=!1);ne=!1,ce=!0,_.showPivot(!0),_.currentCursor=new o.Vector2(t.pageX,t.pageY),_.orbit(_.currentCursor,_.startCursor,new o.Vector3(-t.movementX,t.movementY,0),_.startState),y.camera.lookAt(y.center),requestAnimationFrame(y.render)}},Me=function(e){if(e||(y.removeDocumentEventListener("mouseup",Te,!1),y.removeDocumentEventListener("touchend",Te,!1)),y.removeDocumentEventListener("mousemove",Ae,!1),y.removeDocumentEventListener("touchmove",Ae,!1),r.addEventListener("mousemove",Ce,!1),oe){var t=y.getDocument();t.exitPointerLock()}};this.registerOnViewTypeChangedCb=function(e){e instanceof Function&&(de=e)},this.setViewType=function(e){switch(e){case 1:y.camera=y.ocam;break;case 2:y.camera=y.pcam;break;case 3:y.camera=ne?y.ocam:y.pcam;break;default:return}de&&de(e)};var Te=function(e){e.preventDefault(),e.stopPropagation();var t,n,i;if(_.currentlyAnimating||ce)return _.endInteraction(),_.showPivot(!1),ce=!1,void Me(!1);var o=m(e,y);if(_.viewCubeMenuOpen){var s=o.clientX-q.x,a=o.clientY-q.y;if(_.menuOrigin.x<=s&&s<=_.menuOrigin.x+_.menuSize.x&&_.menuOrigin.y<=a&&a<=_.menuOrigin.y+_.menuSize.y){var l=Math.floor((a-5-_.menuOrigin.y)/25),u=function(e){c.logger.track({name:"navigation/"+e,aggregate:"count"})};switch(l){case 0:u("home"),_.goHome();break;case 1:u("setortho");case 2:u("setpersp");case 3:y.setViewType(l);break;case 4:u("sethome"),_.setCurrentViewAsHome(!1);break;case 5:u("focushome"),_.setCurrentViewAsHome(!0);break;case 6:u("resethome"),_.resetHome();break;case 7:u("setfront"),_.setCurrentViewAsFront();break;case 8:u("settop"),_.setCurrentViewAsTop();break;case 9:_.resetOrientation()}}return _.viewCubeMenuOpen=!1,_.removeDropdownMenu(r),(o.clientX<q.x||o.clientX>q.w+q.x||o.clientY<q.y||o.clientY>q.h+q.y)&&_e(),y.mouseMoveSave&&y.processMouseMove(y.mouseMoveSave),_.endInteraction(),void Me(!1)}var d=_.navApi.getUseLeftHandedInput()?1:3;if(o.which===d)return _.viewCubeMenuOpen=!0,_.drawDropdownMenu(L,D,I,o.clientX,o.clientY,r,q),void Me(!0);var h=Ee(o,q);if(t=we(h,y.camera,Z),n=we(h,C,Y),i=we(h,C,Q),n.length>0&&ne){for(var f,p=["top","bottom","right","left","front","back"],g={front:{up:[0,1,2,3],right:[2,3,1,0],down:[1,0,3,2],left:[3,2,0,1]},right:{up:[0,1,5,4],right:[5,4,1,0],down:[1,0,4,5],left:[4,5,0,1]},left:{up:[0,1,4,5],right:[4,5,1,0],down:[1,0,5,4],left:[5,4,0,1]},back:{up:[0,1,3,2],right:[3,2,1,0],down:[1,0,2,3],left:[2,3,0,1]},top:{up:[5,4,2,3],right:[2,3,4,5],down:[4,5,3,2],left:[3,2,5,4]},bottom:{up:[4,5,2,3],right:[2,3,5,4],down:[5,4,3,2],left:[3,2,4,5]}},v=_.getOrientation(),x=g[y.currentFace][v],w=0;4>w;w++)if(n[0].object===Y[w]){f=p[x[w]];break}_.calculateCubeTransform(f),y.currentFace=f,_.elapsedTime=0,_.sphericallyInterpolateTransition()}if(i.length>0){if(_.elapsedTime=0,y.wantHomeButton&&i[0].object===Q[H])return _.goHome(),void Me(!1);if(y.wantContextMenu&&i[0].object===Q[W])return _.viewCubeMenuOpen=!0,_.drawDropdownMenu(L,D,I,o.clientX,o.clientY,r,q),void Me(!0);if(y.wantRollArrows&&ne&&(i[0].object===Q[B]||i[0].object===Q[z])){var E=i[0].object===Q[z],S={center:_.center.clone(),position:b.position.clone(),pivot:b.pivot.clone(),fov:b.fov,worldUp:_.sceneUpDirection.clone(),isOrtho:b.isPerspective===!1},A=_.center.clone().sub(b.position).normalize();E?S.up=b.up.clone().cross(A):(S.up=b.up.clone().multiplyScalar(-1),S.up.cross(A)),S.up.normalize(),_.elapsedTime=0,_.animateTransition(S)}}if(t.length>0){var f=t[0].object.name;y.mouseMoveSave=e,y.cubeRotateTo(f)}Me(!1)};this.cubeRotateTo=function(e){y.currentFace=e,_.orthographicFaces&&-1!==y.currentFace.indexOf(",")&&_.setCameraOrtho(!1),_.calculateCubeTransform(y.currentFace),_.elapsedTime=0,_.sphericallyInterpolateTransition(function(){y.mouseMoveSave&&y.processMouseMove(y.mouseMoveSave)})},this.processMouseMove=function(e){var t,r,n;if(_.viewCubeMenuOpen||_.currentlyAnimating)return void(y.mouseMoveSave=e);y.mouseMoveSave=null;var i=m(e,y),o=Ee(i,q);if(t=we(o,y.camera,K),r=we(o,C,Y),n=we(o,C,Q),J&&!ce&&(J.material.color.setHex(v),J=null,requestAnimationFrame(y.render)),r.length>0&&!ce){J=r[0].object;for(var s=U.children.length;--s>=0;)if(J===Y[s]){J=U.children[s],J.material.color.setHex(45055);break}requestAnimationFrame(y.render)}$&&!ce&&($.material.opacity=0,$=null,requestAnimationFrame(y.render)),t.length>0&&!ce&&($=t[0].object,$.material.opacity=.3,requestAnimationFrame(y.render)),n.length>0&&!ce?ee!==n[0].object&&(y.wantHomeButton&&n[0].object===Q[H]?(ee=n[0].object,Q[H].material.map=he[0]):y.wantRollArrows&&n[0].object===Q[B]?(ee=n[0].object,Q[G].material.map=he[1]):y.wantRollArrows&&n[0].object===Q[z]?(ee=n[0].object,Q[G].material.map=he[2]):y.wantContextMenu&&n[0].object===Q[W]?(ee=n[0].object,Q[W].material.map=he[6]):y.wantHomeButton&&ee===Q[H]?(ee=null,Q[H].material.map=he[3]):!y.wantRollArrows||ee!==Q[B]&&ee!==Q[z]&&ee!==Q[G]?y.wantContextMenu&&ee===Q[W]&&(ee=null,Q[W].material.map=he[5]):(ee=null,Q[G].material.map=he[4]),requestAnimationFrame(y.render)):null===ee||ce||(y.wantHomeButton&&ee===Q[H]?(ee=null,Q[H].material.map=he[3]):!y.wantRollArrows||ee!==Q[B]&&ee!==Q[z]&&ee!==Q[G]?y.wantContextMenu&&ee===Q[W]&&(ee=null,Q[W].material.map=he[5]):(ee=null,Q[G].material.map=he[4]),requestAnimationFrame(y.render))};var Ce=function(e){_.navApi.isActionEnabled("orbit")&&y.processMouseMove(e)},je=function(){q=fe(r),y.width=r.offsetWidth,y.height=r.offsetHeight,y.pcam.aspect=y.ocam.aspect=y.width/y.height,y.pcam.updateProjectionMatrix(),y.ocam.updateProjectionMatrix(),y.camera.topFov=y.camera.bottomFov=y.camera.fov/2,y.camera.leftFov=y.camera.rightFov=y.camera.aspect*y.camera.fov/2,y.pcam.aspect=y.ocam.aspect=y.camera.aspect,y.pcam.topFov=y.ocam.topFov=y.camera.topFov,y.pcam.bottomFov=y.ocam.bottomFov=y.camera.bottomFov,y.pcam.leftFov=y.ocam.leftFov=y.camera.leftFov,y.pcam.rightFov=y.ocam.rightFov=y.camera.rightFov,y.renderer.setSize(y.width,y.height),requestAnimationFrame(y.render)},Pe=function(e,t){var r,n=Math.floor(.45*te/2)||45,i=Math.floor(.6*te/2)||60,s=n+i,a=new o.Geometry,l=new o.Vector3(0,0,0),c=new o.Vector3(i,-i,s),u=new o.Vector3(i,i,s),d=new o.Vector3(-i,i,s),h=new o.Vector3(-i,-i,s);return a.vertices.push(l),a.vertices.push(c),a.vertices.push(u),a.vertices.push(d),a.vertices.push(h),a.faces.push(new o.Face3(1,2,3)),a.faces.push(new o.Face3(1,3,4)),a.applyMatrix((new o.Matrix4).makeRotationX(e)),a.applyMatrix((new o.Matrix4).makeRotationY(t)),a.computeFaceNormals(),a.computeVertexNormals(),r=new o.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),new o.Mesh(a,r)},Le=function(e,t,r){var n,i,s=Math.floor(.45*te/2)||45,a=Math.floor(.6*te/2)||60,l=s+a,c=new o.Geometry,u=new o.Vector3(a,l,l),d=new o.Vector3(-a,l,l),h=new o.Vector3(-a,a,l),f=new o.Vector3(a,a,l),p=new o.Vector3(a,l,a),m=new o.Vector3(-a,l,a),g=new o.Vector3(-a,l,l),v=new o.Vector3(a,l,l);return c.vertices.push(u),c.vertices.push(d),c.vertices.push(h),c.vertices.push(f),c.vertices.push(p),c.vertices.push(m),c.vertices.push(g),c.vertices.push(v),c.faces.push(new o.Face3(0,1,2)),c.faces.push(new o.Face3(0,2,3)),c.faces.push(new o.Face3(4,5,6)),c.faces.push(new o.Face3(4,6,7)),c.applyMatrix((new o.Matrix4).makeRotationX(e)),c.applyMatrix((new o.Matrix4).makeRotationY(t)),c.applyMatrix((new o.Matrix4).makeRotationZ(r)),c.computeFaceNormals(),c.computeVertexNormals(),n=new o.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),i=new o.Mesh(c,n)},De=function(e,t){var r,n,i=Math.floor(.45*te/2)||45,s=Math.floor(.6*te/2)||60,a=i+s,l=new o.Geometry,c=new o.Vector3(a,a,a),u=new o.Vector3(s,a,a),d=new o.Vector3(s,s,a),h=new o.Vector3(a,s,a),f=new o.Vector3(a,a,s),p=new o.Vector3(a,a,a),m=new o.Vector3(a,s,a),g=new o.Vector3(a,s,s),v=new o.Vector3(a,a,a),y=new o.Vector3(a,a,s),_=new o.Vector3(s,a,s),b=new o.Vector3(s,a,a);return l.vertices.push(c),l.vertices.push(u),l.vertices.push(d),l.vertices.push(h),l.vertices.push(f),l.vertices.push(p),l.vertices.push(m),l.vertices.push(g),l.vertices.push(v),l.vertices.push(y),l.vertices.push(_),l.vertices.push(b),l.faces.push(new o.Face3(0,1,2)),l.faces.push(new o.Face3(0,2,3)),l.faces.push(new o.Face3(4,5,6)),l.faces.push(new o.Face3(4,6,7)),l.faces.push(new o.Face3(8,9,10)),l.faces.push(new o.Face3(8,10,11)),l.applyMatrix((new o.Matrix4).makeRotationX(e)),l.applyMatrix((new o.Matrix4).makeRotationY(t)),l.computeFaceNormals(),l.computeVertexNormals(),r=new o.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),n=new o.Mesh(l,r)},Ie=function(e){var t=_.cubeFront.clone(),r=_.sceneUpDirection.clone(),n=t.clone().cross(r);
r.copy(n).cross(t),t.normalize(),r.normalize(),n.normalize();var i=new o.Vector3(t.x,r.x,n.x).multiplyScalar(e.x);return i.add(new o.Vector3(t.y,r.y,n.y).multiplyScalar(e.y)),i.add(new o.Vector3(t.z,r.z,n.z).multiplyScalar(e.z)),i};this.render=function(){y.camera=b.isPerspective?y.pcam:y.ocam;var e=y.compass?y.viewScaleFactorCompass*y.viewScale:y.viewScale,t=_.center.clone().sub(b.position).normalize(),r=b.up.normalize(),n=new o.Matrix4;t=Ie(t),r=Ie(r),y.camera.position.copy(t),y.camera.position.multiplyScalar(-e/y.camera.position.length()),y.camera.up=r.normalize(),y.camera.lookAt(y.center),Re();var i=y.renderTriad&&g(_.sceneUpDirection)&&g(_.sceneFrontDirection),s=y.renderer;if(s){for(var a=0;a<R.length;a++)n.lookAt(y.camera.position,R[a].position,y.camera.up),R[a].setRotationFromMatrix(n);s.clear(),s.render(x,y.camera),s.render(w,y.camera),s.render(S,y.camera),i&&(A.orient(_.sceneUpDirection,_.sceneFrontDirection.clone().multiplyScalar(-1)),s.render(A.triadScene,y.camera),s.render(A.triadLabelScene,y.camera)),s.render(E,y.camera),y.renderCompass&&s.render(T,y.camera),s.render(M,C)}},this.getScreenShot=function(e){return new Promise(function(e,t){function r(t){var r=new Image,n=y.getWindow();r.src=n.URL.createObjectURL(t),r.onload=function(){s.drawImage(r,0,0,y.width,y.height),n.URL.revokeObjectURL(r.src),o.toBlob(function(t){e(t)},"image/png")}}var n=y.renderer;if(!n)return t("No renderer");var i=y.getDocument(),o=i.createElement("canvas");o.width=y.width,o.height=y.height;var s=o.getContext("2d");s.fillStyle="#FFFFFF",s.fillRect(0,0,y.width,y.height),n.domElement.toBlob(r,"image/png")})};var Re=function(){ne=_.isFaceView(),!ne||ue||_.currentlyAnimating?Oe():ke(),ue?Ne():Fe(),ue?Ve():Ue()},Oe=function(){M.remove(U),Q[G].material.opacity=0,Q[W].material.opacity=0},ke=function(){M.add(U);var e=y.wantRollArrows?1:0;Q[G].material.opacity=e,Q[W].material.opacity=e},Ne=function(){V.material.opacity=Object(u.isMobileDevice)()?1:0},Fe=function(){V.material.opacity=y.wantContextMenu?1:0},Ve=function(){N.material.opacity=0},Ue=function(){N.material.opacity=y.wantHomeButton?1:0};this.refreshCube=function(){je()},this.setSize=function(e,t){if(y.width=e,y.height=t,r.children.length>1)for(var n=1;n<r.children.length;n++)r.children[n].style.bottom=(y.height/5).toString()+"px";je()},this.useTransparency=function(e){ue=e,e?(r.onmouseover=ve,r.onmousemove=ye,r.onmouseout=_e,_e()):(r.onmouseover=null,r.onmouseout=null,r.onmousemove=null,r.style.opacity="1.0")},this.showTriad=function(e){e!==y.renderTriad&&(y.renderTriad=e,requestAnimationFrame(y.render))},this.showCompass=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0;this.initCompass(),y.renderCompass!==e&&(y.prevRenderCompass=y.renderCompass,y.renderCompass=e,me(),requestAnimationFrame(y.render))},this.setCompassRotation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.initCompass();var t=e-y.northAngle;0!==t&&(y.northAngle=e,y.compassPointerMeshUp.rotateZ(t),y.compassPointerMeshDown.rotateZ(t),requestAnimationFrame(y.render))},this.initCompass=function(){if(!y.hasCompass){y.hasCompass=!0,y.northAngle=0;var e="res/textures/",t=Autodesk.Viewing.Private.getResourceUrl;T=new o.Scene;var r=2.9*te,n=new o.PlaneBufferGeometry(r,r,2,2),i=new o.MeshBasicMaterial({color:0,side:o.DoubleSide,map:be(t(e+"VCcompass-pointer-b.png")),shading:o.FlatShading,transparent:!0}),s=new o.MeshBasicMaterial({color:0,side:o.DoubleSide,map:be(t(e+"VCcompass-base.png")),shading:o.FlatShading,transparent:!0}),a=new o.Mesh(n,i),l=new o.Mesh(n,i),c=new o.Mesh(n,s);y.compassPointerMeshUp=a,y.compassPointerMeshDown=l;var u=-Math.PI/2;c.rotateX(u),a.rotateX(u),l.rotateX(u);var d=.5*-te-(Math.floor(.25*te/2)||25);c.translateZ(d),a.translateZ(d+.1),l.translateZ(d-.1),T.add(c),T.add(a),T.add(l),requestAnimationFrame(y.render)}},this.showControls=function(e){e||void 0===e?ve():_e()},this.dtor=function(){this.renderer=null,de=null},this.refreshTexture=function(e){var t=Autodesk.Viewing.Private.getResourceUrl,r=this.localizeResourcePath||"res/textures/",n=(new s.DDSLoader).load(t(r+"VCcrossRGBA8small.dds"),e);n.minFilter=n.maxFilter=o.LinearFilter,this.texture&&this.texture.dispose(),this.texture=n;var i=this.material;if(!i){var l=o.ShaderLib.cube;i=Object(a.createShaderMaterial)(l),i.depthWrite=!1,this.material=i}return i.uniforms.tCube.value=n,i},this.localize=function(){var e=this,t=Object(u.getGlobal)();this.localizeResourcePath=t.LOCALIZATION_REL_PATH,this.refreshTexture(function(){requestAnimationFrame(e.render)})},ge()}r.r(t),r.d(t,"ViewCube",function(){return i});var o=r("./thirdparty/three.js/three.js"),s=(r.n(o),r("./thirdparty/three.js/DDSLoader.js")),a=r("./src/wgs/render/ShaderUtils.js"),l=r("./src/wgs/render/WebGLRenderer.js"),c=r("./src/logger/Logger.js"),u=r("./src/compat.js"),d=r("./src/file-loaders/net/ErrorCodes.js"),h=r("./src/file-loaders/net/endpoints.js"),f=r("./src/application/GlobalManagerMixin.js"),p=Autodesk.Viewing,m=function(e){return Math.abs(e-1)<1e-12},g=function(e){return!(!m(e.length())||!m(Math.abs(e.x))&&!m(Math.abs(e.y))&&!m(Math.abs(e.z)))},v=12040636},"./src/tools/viewtransitions/ViewTransition.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(){this.stop=null,this.isRunning=!0}function a(e,t,r,n,i){var o=performance.now(),a=1e3*r,l=0,c=new s;c.stop=function(){l&&g.cancelAnimationFrame(l),c.isRunning=!1},c.skip=function(){c.isRunning&&(n(t),c.stop(),i&&i())};var u=function d(r){var s=(r-o)/a;s=Math.max(s,0),s=Math.min(s,1);var u=e+s*(t-e);n(u),1>s?l=g.requestAnimationFrame(d):(c.isRunning=!1,i&&i())};return u(o),c}function l(e,t,r){return(1-r)*e+r*t}function c(e){return THREE.Math.smootherstep(e,0,1)}function u(e){function t(e,t,r){v.set(0,0,-r).applyQuaternion(t),e.target.addVectors(e.position,v),v.set(0,1,0).applyQuaternion(t),e.up.copy(v)}function r(e,t,r,n){Autodesk.Viewing.Navigation.prototype.orient(_,r,t,n),e.copy(_.quaternion)}function n(){r(m,i,o,p),r(g,a,u,p)}var i=new THREE.Vector3,o=new THREE.Vector3,s=new THREE.Vector3,a=new THREE.Vector3,u=new THREE.Vector3,d=new THREE.Vector3,h=0,f=0,p=new THREE.Vector3,m=new THREE.Quaternion,g=new THREE.Quaternion,v=new THREE.Vector3,y=new THREE.Quaternion,_=new THREE.Object3D;new THREE.Matrix4;this.init=function(e,t,r,l){i.copy(e.position),o.copy(e.target),s.copy(e.up),a.copy(t),u.copy(r),d.copy(l),p.copy(e.worldup),h=i.distanceTo(o),f=a.distanceTo(u),n()},this.updateCamera=function(e,r){var n=c(e);r.position.lerpVectors(i,a,n),THREE.Quaternion.slerp(m,g,y,n),y.normalize();var o=l(h,f,n);t(r,y,o),r.dirty=!0},this.updateViewerCamera=function(e,t){this.updateCamera(e,t.impl.camera),t.impl.syncCamera(),t.impl.invalidate(!0,!0)}}function d(e,t,r,n){f||(f=new u),r=r||2;var i=e.impl.camera;f.init(i,t.position,t.target,t.up);var o=function(t){f.updateViewerCamera(t,e)};return a(0,1,r,o,n)}function h(e,t,r){function n(t){o=t,e.impl.setGroundShadowAlpha(t)}function i(){s=null,u&&u(c)}var o=1,s=null,l=t,c=void 0,u=r;this.shadowOn=function(){if(!(s&&c||(s&&!c&&(s.stop(),s=null),o>=1))){var e=1-o,t=l*e;s=a(o,1,t,n,i),c=!0}},this.shadowOff=function(){if((!s||c)&&(s&&c&&(s.stop(),s=null),!(0>=o))){var e=l*o;s=a(o,0,e,n,i),c=!1}},this.isFading=function(){return s&&s.isRunning}}var f,p=r("./src/compat.js"),m=p.getGlobal,g=m(),v=function(){function e(t,r,i){n(this,e),this.setValueCb=r,this.animTime=i,this.fadeAnim=null,this.targetValue=t,this.curValue=t,r(t)}return o(e,[{key:"_stopAnim",value:function(){this.fadeAnim&&(this.fadeAnim.stop(),this.fadeAnim=null)}},{key:"fadeTo",value:function(e,t){var r=this;if(e!==this.targetValue){this._stopAnim();var n=function(e){e=c(e),r.curValue=e,r.setValueCb(e)};this.targetValue=e,this.fadeAnim=a(this.curValue,this.targetValue,this.animTime,n,t)}}},{key:"setValue",value:function(e){this._stopAnim(),this.curValue=e,this.setValueCb(e)}}]),e}();e.exports={flyToView:d,ShadowFader:h,lerp:l,smootherStep:c,fadeValue:a,AnimatedParam:v}},"./src/wasm/Wasm.js":function(e,t,r){"use strict";function n(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){function s(e){n(l,i,o,s,a,"next",e)}function a(e){n(l,i,o,s,a,"throw",e)}var l=e.apply(t,r);s(void 0)})}}function o(e,t){try{WebAssembly.instantiateStreaming||(WebAssembly.instantiateStreaming=function(){var e=i(regeneratorRuntime.mark(function t(e,r){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:return t.next=4,t.sent.arrayBuffer();case 4:return n=t.sent,t.next=7,WebAssembly.instantiate(n,r);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t)}));return function(t,r){return e.apply(this,arguments)}}())}catch(r){throw new Error("WebAssembly is not supported for the current browser.")}if(!e)throw new Error("Expecting a wasm file path.");var n=256,o=256;t&&t.memory&&(n=t.memory.initial,o=t.memory.maximum),this._wasmPath=e,this._memory=new WebAssembly.Memory({initial:n,maximum:o})}r.r(t),r.d(t,"Wasm",function(){return o}),o.prototype.constructor=o,o.prototype.instantiate=function(){var e=this,t={abortStackOverflow:function(e){throw new Error("overflow")},table:new WebAssembly.Table({initial:0,maximum:0,element:"anyfunc"}),__table_base:0,memory:this._memory,__memory_base:1024,STACKTOP:0,STACK_MAX:this.getBuffer().byteLength},r={env:t};return new Promise(function(t,n){try{WebAssembly.instantiateStreaming(fetch(e._wasmPath),r).then(function(r){var n=r.instance.exports;e.proxy=n,t(n)})}catch(i){n(i)}})},o.prototype.getBuffer=function(){return this._memory.buffer}},"./src/wgs/globals.js":function(e,t,r){"use strict";r.r(t),r.d(t,"memoryOptimizedLoading",function(){return i}),r.d(t,"GPU_MEMORY_LIMIT",function(){return o}),r.d(t,"GPU_OBJECT_LIMIT",function(){return s}),r.d(t,"USE_VAO",function(){return a}),r.d(t,"GEOMETRY_OVERHEAD",function(){return l}),r.d(t,"PIXEL_CULLING_THRESHOLD",function(){return c});var n=r("./src/compat.js"),i=!0,o=1024*(Object(n.isMobileDevice)()?64:256)*1024,s=Object(n.isMobileDevice)()?2500:1e4,a=!Object(n.isMobileDevice)(),l=336,c=1},"./src/wgs/render/BackgroundShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"BackgroundShader",function(){return l});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/shaders/background_vert.glsl")),o=r.n(i),s=r("./src/wgs/render/shaders/background_frag.glsl"),a=r.n(s),l={uniforms:{color1:{type:"v3",value:new n.Vector3(41/255,76/255,120/255)},color2:{type:"v3",value:new n.Vector3(1/255,2/255,3/255)},opacity:{type:"f",value:1},envMap:{type:"t",value:null},envRotationSin:{type:"f",value:0},envRotationCos:{type:"f",value:1},exposureBias:{type:"f",value:1},envMapExposure:{type:"f",value:1},uCamDir:{type:"v3",value:new n.Vector3},uCamUp:{type:"v3",value:new n.Vector3},uResolution:{type:"v2",value:new n.Vector2(600,400)},uHalfFovTan:{type:"f",value:.5},envMapBackground:{type:"i",value:0}},vertexShader:o.a,fragmentShader:a.a}},"./src/wgs/render/BasicShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"BasicShader",function(){return c});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/ShaderChunks.js")),o=r("./src/wgs/render/shaders/basic_vert.glsl"),s=r.n(o),a=r("./src/wgs/render/shaders/basic_frag.glsl"),l=r.n(a),c={uniforms:n.UniformsUtils.merge([n.UniformsLib.common,n.UniformsLib.fog,n.UniformsLib.shadowmap,i.ShaderChunks.CutPlanesUniforms,i.ShaderChunks.IdUniforms,i.ShaderChunks.ThemingUniform,i.ShaderChunks.PointSizeUniforms,i.ShaderChunks.WideLinesUniforms]),vertexShader:s.a,fragmentShader:l.a};n.ShaderLib.firefly_basic=c},"./src/wgs/render/BlendShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"BlendShader",function(){return c});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/ShaderChunks.js")),o=r("./src/wgs/render/shaders/screen_quad_uv_vert.glsl"),s=r.n(o),a=r("./src/wgs/render/shaders/blend_frag.glsl"),l=r.n(a),c={uniforms:n.UniformsUtils.merge([i.ShaderChunks.DepthTextureUniforms,{tDiffuse:{type:"t",value:null},tAO:{type:"t",value:null},useAO:{type:"i",value:0},aoOpacity:{type:"f",value:.625},tOverlay:{type:"t",value:null},useOverlay:{type:"i",value:0},tID:{type:"t",value:null},tID2:{type:"t",value:null},objIDv4:{type:"v4",value:new n.Vector4(0,0,0,0)},modelIDv2:{type:"v2",value:new n.Vector2(0,0)},edgeObjIDv4:{type:"v4",value:new n.Vector4(0,0,0,0)},edgeModelIDv2:{type:"v2",value:new n.Vector2(0,0)},highlightIntensity:{type:"f",value:1},highlightColor:{type:"c",value:new n.Color(1,1,1)},resolution:{type:"v2",value:new n.Vector2(1/1024,1/512)},selectionColor:{type:"c",value:new n.Color(0,0,0)},expand2dSelection:{type:"f",value:.5},tCrossFadeTex0:{type:"t",value:null},tCrossFadeTex1:{type:"t",value:null},crossFadeOpacity0:{type:"f",value:0},crossFadeOpacity1:{type:"f",value:0},highlightFullModel:{type:"f",value:0}}]),vertexShader:s.a,fragmentShader:l.a}},"./src/wgs/render/CelShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"CelShader",function(){return c});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/ShaderChunks.js")),o=r("./src/wgs/render/shaders/screen_quad_uv_vert.glsl"),s=r.n(o),a=r("./src/wgs/render/shaders/cel_frag.glsl"),l=r.n(a),c={uniforms:n.UniformsUtils.merge([i.ShaderChunks.DepthTextureUniforms,{tDiffuse:{type:"t",value:null},tID:{type:"t",value:null},resolution:{type:"v2",value:new n.Vector2(1/1024,1/512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},tFill:{type:"t",value:null},tPaper:{type:"t",value:null},style:{type:"i",value:0},idEdges:{type:"i",value:1},normalEdges:{type:"i",value:1},depthEdges:{type:"i",value:1},brightness:{type:"f",value:0},contrast:{type:"f",value:0},grayscale:{type:"i",value:0},preserveColor:{type:"i",value:0},levels:{type:"f",value:6},repeats:{type:"f",value:3},rotation:{type:"f",value:0},outlineRadius:{type:"f",value:1},outlineNoise:{type:"i",value:0},tGraphite1:{type:"t",value:null},tGraphite2:{type:"t",value:null},tGraphite3:{type:"t",value:null},tGraphite4:{type:"t",value:null},tGraphite5:{type:"t",value:null},tGraphite6:{type:"t",value:null},tGraphite7:{type:"t",value:null},tGraphite8:{type:"t",value:null}}]),vertexShader:s.a,fragmentShader:l.a}},"./src/wgs/render/CopyShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"CopyShader",function(){return a});var n=r("./src/wgs/render/shaders/screen_quad_uv_vert.glsl"),i=r.n(n),o=r("./src/wgs/render/shaders/copy_frag.glsl"),s=r.n(o),a={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:i.a,fragmentShader:s.a}},"./src/wgs/render/DecodeEnvMap.js":function(e,t,r){"use strict";function n(e,t){for(var r=255*e.x,n=255*e.y,i=255*e.z,o=255*t.x,s=255*t.y,a=255*t.z,c=new Uint8Array(16),u=new Uint8Array(16),d=new Uint8Array(16),h=0;4>h;h++)c[4*h]=r,c[4*h+1]=n,c[4*h+2]=i,c[4*h+3]=255,u[4*h]=o,u[4*h+1]=s,u[4*h+2]=a,u[4*h+3]=255,h>1?(d[4*h]=r,d[4*h+1]=n,d[4*h+2]=i,d[4*h+3]=255):(d[4*h]=o,d[4*h+1]=s,d[4*h+2]=a,d[4*h+3]=255);var f=new l.DataTexture(d,2,2,l.RGBAFormat),p=new l.DataTexture(d,2,2,l.RGBAFormat),m=new l.DataTexture(u,2,2,l.RGBAFormat),g=new l.DataTexture(c,2,2,l.RGBAFormat),v=new l.DataTexture(d,2,2,l.RGBAFormat),y=new l.DataTexture(d,2,2,l.RGBAFormat),_=new l.Texture(null,l.CubeReflectionMapping,l.RepeatWrapping,l.RepeatWrapping,l.LinearFilter,l.LinearFilter,l.RGBAFormat);return _.image=[p,f,g,m,y,v],_.needsUpdate=!0,_}function i(e,t){var r=255*t[2]+t[3],n=Math.pow(2,(r-127)/2),i=n/t[1],o=t[0]*i,s=d[0]*o+d[3]*n+d[6]*i,a=d[1]*o+d[4]*n+d[7]*i,l=d[2]*o+d[5]*n+d[8]*i;0>s&&(s=0),0>a&&(a=0),0>l&&(l=0),e[0]=s,e[1]=a,e[2]=l}function o(e,t,r){var n=.0625*Math.sqrt(t[0]*r),i=.0625*Math.sqrt(t[1]*r),o=.0625*Math.sqrt(t[2]*r),s=Math.max(Math.max(n,i),Math.max(o,1e-6));s>1&&(s=1);var a=Math.ceil(255*s)/255;n>1&&(n=1),i>1&&(i=1),o>1&&(o=1),e[3]=a;var l=1/a;e[0]=n*l,e[1]=i*l,e[2]=o*l}function s(e,t,r){var n=Math.sqrt(t[0]*r),i=Math.sqrt(t[1]*r),o=Math.sqrt(t[2]*r),s=65504;n>s&&(n=s),i>s&&(i=s),o>s&&(o=s),e[0]=n,e[1]=i,e[2]=o}function a(e,t,r,n){if(!e.LogLuv)return void u.logger.warn("Environment map expected to be in LogLuv format.");for(var a=Math.pow(2,t),d=Array.isArray(e.image)?e.image:[e.image],p=0;p<d.length;p++)for(var m=d[p],g=0;g<m.mipmaps.length;g++){var v,y=m.mipmaps[g],_=y.data;r?(v=new Uint16Array(_.length/4*3),y.data=v):v=_.buffer;for(var b=0,x=0;x<_.length;x+=4)h[0]=_[x]/255,h[1]=_[x+1]/255,h[2]=_[x+2]/255,h[3]=_[x+3]/255,i(f,h),r?(s(h,f,a),v[b++]=Object(c.FloatToHalf)(h[0]),v[b++]=Object(c.FloatToHalf)(h[1]),v[b++]=Object(c.FloatToHalf)(h[2])):(o(h,f,a),_[x]=Math.round(255*h[0]),_[x+1]=Math.round(255*h[1]),_[x+2]=Math.round(255*h[2]),_[x+3]=Math.round(255*h[3]))}e.LogLuv=!1,r?(e.type=l.HalfFloatType,e.format=l.RGBFormat,e.RGBM=!1,e.GammaEncoded=!0):e.RGBM=!0,n&&n(e)}r.r(t),r.d(t,"CreateCubeMapFromColors",function(){return n}),r.d(t,"DecodeEnvMap",function(){return a});var l=r("./thirdparty/three.js/three.js"),c=(r.n(l),r("./src/wgs/render/HalfFloat.js")),u=r("./src/logger/Logger.js"),d=[6.0014,-2.7008,-1.7996,-1.332,3.1029,-5.7721,.3008,-1.0882,5.6268],h=new Float32Array(4),f=new Float32Array(4)},"./src/wgs/render/EdgeShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"EdgeShader",function(){return l});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/shaders/edge_vert.glsl")),o=r.n(i),s=r("./src/wgs/render/shaders/edge_frag.glsl"),a=r.n(s),l={uniforms:{color:{type:"v4",value:new n.Vector4(0,0,0,.3)},cutplanes:{type:"v4v",value:[]}},vertexShader:o.a,fragmentShader:a.a}},"./src/wgs/render/FXAAShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"FXAAShader",function(){return l});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/shaders/fxaa_vert.glsl")),o=r.n(i),s=r("./src/wgs/render/shaders/fxaa_frag.glsl"),a=r.n(s),l={uniforms:{tDiffuse:{type:"t",value:null},uResolution:{type:"v2",value:new n.Vector2(1/1024,1/512)}},vertexShader:o.a,fragmentShader:a.a}},"./src/wgs/render/GaussianPass.js":function(e,t,r){"use strict";r.r(t),r.d(t,"GaussianPass",function(){return u});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/shaders/gaussian_vert.glsl")),o=r.n(i),s=r("./src/wgs/render/shaders/gaussian_frag.glsl"),a=r.n(s),l=r("./src/wgs/render/ShaderPass.js"),c={uniforms:{tDiffuse:{type:"t",value:null},uColor:{type:"v4",value:new n.Vector4(1,1,1,1)}},vertexShader:o.a,fragmentShader:a.a},u=function(e,t,r,i,o){var s,a,u,d=e,h=t,f=r||3,p=i||1,m={hasAlpha:o.hasAlpha||!1,blending:o.blending||!1,flipUV:o.flipUV||!1};this.render=function(e,t,r){s.render(e,u,r),a.render(e,t,u)},this.setSize=function(e,t){this.cleanup(),d=e,h=t,u=new n.WebGLRenderTarget(e,t,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:void 0!==o.format?o.format:n.RGBAFormat,type:void 0!==o.type?o.type:n.UnsignedByteType,stencilBuffer:!1}),u.generateMipmaps=!1,s.material.defines.KERNEL_SCALE_H=a.material.defines.KERNEL_SCALE_H=(p/d).toFixed(4),s.material.defines.KERNEL_SCALE_V=a.material.defines.KERNEL_SCALE_V=(p/h).toFixed(4),s.material.needsUpdate=a.material.needsUpdate=!0},this.cleanup=function(){u&&u.dispose()},this.setColor=function(e){a.material.uniforms.uColor.value.x=e.r,a.material.uniforms.uColor.value.y=e.g,a.material.uniforms.uColor.value.z=e.b},this.setAlpha=function(e){a.material.uniforms.uColor.value.w=e},s=new l.ShaderPass(c),a=new l.ShaderPass(c),this.setSize(e,t),s.material.blending=a.material.blending=n.NoBlending,s.material.depthWrite=a.material.depthWrite=!1,s.material.depthTest=a.material.depthTest=!1,s.material.defines.HORIZONTAL=1,s.material.defines.KERNEL_RADIUS=a.material.defines.KERNEL_RADIUS=f.toFixed(1),m.blending&&(a.material.transparent=!0,a.material.blending=n.NormalBlending),m.hasAlpha&&(s.material.defines.HAS_ALPHA=a.material.defines.HAS_ALPHA=""),m.flipUV&&(s.material.defines.FLIP_UV="")}},"./src/wgs/render/GroundFlags.js":function(e,t,r){"use strict";r.r(t),r.d(t,"GroundFlags",function(){return n});var n={GROUND_UNFINISHED:0,GROUND_FINISHED:1,GROUND_RENDERED:2}},"./src/wgs/render/GroundReflection.js":function(e,t,r){"use strict";r.r(t),r.d(t,"GroundReflection",function(){return f});var n=r("./src/wgs/render/ShaderPass.js"),i=r("./src/wgs/render/GaussianPass.js"),o=r("./src/wgs/render/BackgroundShader.js"),s=r("./src/wgs/render/shaders/screen_quad_uv_vert.glsl"),a=r.n(s),l=r("./src/wgs/render/shaders/groundreflection_draw_frag.glsl"),c=r.n(l),u=r("./src/wgs/render/GroundFlags.js"),d=r("./thirdparty/three.js/three.js"),h=(r.n(d),{uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:a.a,fragmentShader:c.a}),f=function(e,t,r,s){var a,l,c,f,p,m,g=e,v=g.getContext(),y=t||512,_=r||512,b=!1,x=new d.Color(0,0,0),w=!1,E=!1;this.inTarget=void 0,this.outTarget=void 0;var S=!0,A=u.GroundFlags.GROUND_UNFINISHED,M={color:new d.Color(1,1,1),alpha:.3,texScale:.5,blurRadius:2,blurTexScale:.5,fadeAngle:Math.PI/18},T=function(e){var t=e.normal,r=e.constant;return(new d.Matrix4).set(1-2*t.x*t.x,-2*t.y*t.x,-2*t.x*t.z,-2*r*t.x,-2*t.x*t.y,1-2*t.y*t.y,-2*t.y*t.z,-2*r*t.y,-2*t.x*t.z,-2*t.y*t.z,1-2*t.z*t.z,-2*r*t.z,0,0,0,1)};if(this.setTransform=function(e,t,r){f=e,c.normal=t,c.constant=-e.dot(t)},this.cleanup=function(){a&&a.cleanup(),this.inTarget&&this.inTarget.dispose(),this.outTarget&&this.outTarget.dispose()},this.setSize=function(e,t){y=e,_=t,this.cleanup(),this.inTarget=new d.WebGLRenderTarget(y*M.texScale,_*M.texScale,{magFilter:d.LinearFilter,minFilter:d.LinearFilter,format:d.RGBAFormat,stencilBuffer:!1}),this.inTarget.generateMipmaps=!1,this.outTarget=new d.WebGLRenderTarget(y*M.texScale,_*M.texScale,{magFilter:d.LinearFilter,minFilter:d.LinearFilter,format:d.RGBAFormat,stencilBuffer:!1}),this.outTarget.generateMipmaps=!1,a?a.setSize(y*M.texScale*M.blurTexScale,_*M.texScale*M.blurTexScale):a=new i.GaussianPass(y*M.texScale*M.blurTexScale,_*M.texScale*M.blurTexScale,M.blurRadius,1,{hasAlpha:!0,blending:!0,flipUV:!0})},this.updateCamera=function(e){var t;t=e.isPerspective?f.clone():e.target.clone();var r=e.position.clone().sub(t).normalize(),n=Math.PI/2-r.angleTo(c.normal);if(b=0>n,!b){if(M.fadeAngle>0){var i=Math.min(M.fadeAngle,n)/M.fadeAngle;a.setAlpha(i*M.alpha)}var o=T(c);p=e.clone(),p.applyMatrix(o),p.projectionMatrix.elements[5]*=-1,p.matrixWorldNeedsUpdate=!0,e.worldUpTransform?p.worldUpTransform=e.worldUpTransform.clone():p.worldUpTransform=new d.Matrix4}},this.renderIntoReflection=function(e){b||g.render(e,p,this.inTarget)},this.prepareGroundReflection=function(){var e,t=0,r=0,n=100,i=0;return function(o,s,a,l,c,d){var h=s.modelQueue();if(A!==u.GroundFlags.GROUND_UNFINISHED||h.isEmpty())return A=u.GroundFlags.GROUND_FINISHED,c;if(e!=h.getGeomScenes()&&(S=!0),S){if(S=!1,this.updateCamera(s.camera),this.isGroundCulled())return A=u.GroundFlags.GROUND_FINISHED,c;this.clear(),e=h.getGeomScenes(),t=e.length,r=0,i=l?Math.max(Math.ceil(t/n),l):t,A=u.GroundFlags.GROUND_UNFINISHED}else{if(A!==u.GroundFlags.GROUND_UNFINISHED)return A=u.GroundFlags.GROUND_FINISHED,c;0===l&&(i=t)}var f,p;c&&(f=performance.now(),d=void 0===d?1:d,p=d*c);for(var m,g=0;i>g&&t>r;){var v=e[r++];if(v&&(g++,v.forceVisible=!0,this.renderIntoReflection(v),v.forceVisible=!1,c)){var y=performance.now()-f;if(y>p&&t>r){A=u.GroundFlags.GROUND_UNFINISHED,m=c-y;break}}}return t>r&&(A=u.GroundFlags.GROUND_UNFINISHED,m=c?c-performance.now()+f:1),void 0===m||a?(this.postprocess(s.camera,s.matman()),o&&o.enabled&&s.renderGroundShadow(this.outTarget),this.renderReflection(s.camera,s.renderer().getColorTarget()),void 0===m&&(A=u.GroundFlags.GROUND_RENDERED),c?c-performance.now()+f:1):m}}(),this.renderReflection=function(e,t){b||(v.depthRange(.999999,1),l.render(g,t,this.outTarget),v.depthRange(0,1))},this.toggleEnvMapBackground=function(e){E=e,m.uniforms.envMapBackground.value=e},this.postprocess=function(e){b||(w||E?(m.uniforms.uCamDir.value=e.worldUpTransform?e.getWorldDirection().clone().applyMatrix4(e.worldUpTransform):e.getWorldDirection(),m.uniforms.uCamUp.value=e.worldUpTransform?e.up.clone().applyMatrix4(e.worldUpTransform):e.up,m.uniforms.uResolution.value.set(y,_),m.uniforms.uHalfFovTan.value=Math.tan(d.Math.degToRad(.5*e.fov)),m.render(g,this.outTarget),g.clearTarget(this.outTarget,!1,!0,!1)):(g.setClearColor(x,1),g.clearTarget(this.outTarget,!0,!0,!1)),a.render(g,this.outTarget,this.inTarget))},this.clear=function(){g.setClearColor(x,0),g.clearTarget(this.inTarget,!0,!0,!1),g.clearBlend()},this.setClearColors=function(e,t,r){t?(x.setRGB(.5*(e.x+t.x),.5*(e.y+t.y),.5*(e.z+t.z)),w=!e.equals(t)&&!r):(x.copy(e),w=!1),w&&(m.uniforms.color1.value.copy(e),m.uniforms.color2.value.copy(t))},this.setEnvRotation=function(e){m.material.envRotationSin=Math.sin(e),m.material.envRotationCos=Math.cos(e)},this.isGroundCulled=function(){return b},this.getStatus=function(){return A},this.setDirty=function(){S=!0,A=u.GroundFlags.GROUND_UNFINISHED},this.setColor=function(e){a.setColor(M.color),M.color.set(e)},this.setAlpha=function(e){a.setAlpha(M.alpha),M.alpha=e},s)for(var C in M)M[C]=void 0!==s[C]?s[C]:M[C];l=new n.ShaderPass(h),l.material.blending=d.NoBlending,l.material.depthTest=!0,l.material.depthWrite=!1,l.scene.position.z=-.999999,s.clearPass?m=s.clearPass:(m=new n.ShaderPass(o.BackgroundShader),m.material.blending=d.NoBlending,m.material.depthWrite=!1,m.material.depthTest=!1),this.setSize(y,_),a.setAlpha(M.color),a.setAlpha(M.alpha),c=new d.Plane(new d.Vector3(0,1,0),0),f=new d.Vector3(0,0,0)}},"./src/wgs/render/GroundShadow.js":function(e,t,r){"use strict";function n(e){var t=new S.PlaneBufferGeometry(1,1);if(t.attributes.index.array.reverse)t.attributes.index.array.reverse();else for(var r,n=t.attributes.index.array,i=Math.floor(n.length/2),o=0,s=n.length;i>o;++o)r=n[o],n[o]=n[s-1-o],n[s-1-o]=r;var a=new S.Mesh(t,e);return a}function i(e,t,r,n,i){s||(s=new S.Matrix4),a||(a=new S.Vector3),l||(l=new S.Vector3),a.subVectors(t,n),s.lookAt(a,t,i),l.copy(n).multiplyScalar(-.5*r.y).add(t),e.position.copy(l),e.rotation.setFromRotationMatrix(s),e.scale.set(r.z,r.x,r.y)}function o(e,t){var r,o,s,a,l,d,h,f,p,m,g,v=e,y=!1,_=!1,b=!0,x=E.GroundFlags.GROUND_FINISHED,w={texSize:_?128:64,pixScale:1,blurRadius:_?5:7,debug:!1};if(this.setTransform=function(){var e=new S.Vector3(0,0,0),t=new S.Vector3(0,0,0),n=new S.Vector3(0,0,0),o=new S.Vector3(0,0,0);return function(a,l,c,u){a.equals(e)&&l.equals(t)&&c.equals(n)&&u.equals(o)||(e.copy(a),t.copy(l),n.copy(c),o.copy(u),this.setDirty(),r.left=-l.z/2,r.right=l.z/2,r.top=l.x/2,r.bottom=-l.x/2,r.near=1,r.far=l.y+r.near,r.updateProjectionMatrix(),i(s,a,l,c,u),r.position.addVectors(a,c.clone().multiplyScalar(-l.y/2-r.near)),u&&r.up.set(u.x,u.y,u.z),r.lookAt(a),w.debug&&(g.position.set(a.x,a.y,a.z),g.rotation.set(r.rotation.x,r.rotation.y,r.rotation.z),g.scale.set(l.z,l.x,l.y)),m.uniforms.worldSize.value.copy(l))}}(),this.renderIntoShadow=function(e){if(!e.overrideMaterial||!e.overrideMaterial.transparent){var t=e.overrideMaterial;e.overrideMaterial=d,v.render(e,r,a,!1),e.overrideMaterial=t}},this.prepareGroundShadow=function(){var e,t=0,r=0,n=100,i=0;return function(o,s,a,l){if(!this.enabled||o.isEmpty())return x=E.GroundFlags.GROUND_FINISHED,a;if(e!=o.getGeomScenes()&&(b=!0),b)this.clear(),b=!1,e=o.getGeomScenes(),t=e.length,r=0,i=s?Math.max(Math.ceil(t/n),s):t;else{if(x===E.GroundFlags.GROUND_RENDERED||x===E.GroundFlags.GROUND_FINISHED)return x=E.GroundFlags.GROUND_FINISHED,a;0===s&&(i=t)}var c,u;a&&(c=performance.now(),l=void 0===l?1:l,u=l*a);for(var d,h=0;i>h&&t>r;){var f=e[r++];if(f&&(h++,f.forceVisible=!0,this.renderIntoShadow(f),f.forceVisible=!1,a)){var p=performance.now()-c;if(p>u){x=E.GroundFlags.GROUND_UNFINISHED,d=a-p;break}}}return t>r&&(x=E.GroundFlags.GROUND_UNFINISHED,d=a?a-performance.now()+c:1),void 0!==d?d:(this.postprocess(),x=E.GroundFlags.GROUND_RENDERED,a?a-performance.now()+c:1)}}(),this.renderShadow=function(e,t){y&&(t?v.render(o,e,t,!1):v.render(o,e))},this.postprocess=function(){_?(m.render(v,l,a),p.render(v,a,l),f.render(v,l,a)):(p.render(v,l,a),f.render(v,a,l)),y=!0},this.clear=function(){var e=v.getClearColor().getHex(),t=v.getClearAlpha();v.setClearColor(0,0),v.clearTarget(a,!0,!0,!1),v.setClearColor(e,t),v.clearBlend(),y=!1},this.setColor=function(e){h.uniforms.uShadowColor.value.x=e.r,h.uniforms.uShadowColor.value.y=e.g,h.uniforms.uShadowColor.value.z=e.b},this.getColor=function(){return new S.Color(h.uniforms.uShadowColor.value.x,h.uniforms.uShadowColor.value.y,h.uniforms.uShadowColor.value.z)},this.setAlpha=function(e){h.uniforms.uShadowColor.value.w=e},this.getAlpha=function(){return h.uniforms.uShadowColor.value.w},this.isValid=function(){return y},this.getStatus=function(){return x},this.setDirty=function(){b=!0,x=E.GroundFlags.GROUND_UNFINISHED},this.getDepthMaterial=function(){return d},t)for(var j in w)w[j]=t[j]||w[j];o=new S.Scene,r=new S.OrthographicCamera,a=new S.WebGLRenderTarget(w.texSize,w.texSize,{minFilter:S.LinearFilter,magFilter:S.LinearFilter,format:S.RGBAFormat,stencilBuffer:!1}),a.generateMipmaps=!1,l=new S.WebGLRenderTarget(w.texSize,w.texSize,{minFilter:S.LinearFilter,magFilter:S.LinearFilter,format:S.RGBAFormat,stencilBuffer:!1}),l.generateMipmaps=!1,d=Object(c.createShaderMaterial)(A),d.side=S.DoubleSide,d.blending=S.NoBlending,f=new u.ShaderPass(T,"tDepth"),p=new u.ShaderPass(T,"tDepth"),m=new u.ShaderPass(M,"tDepth"),f.material.defines.KERNEL_SCALE=p.material.defines.KERNEL_SCALE=(w.pixScale/w.texSize).toFixed(4),f.material.defines.KERNEL_RADIUS=p.material.defines.KERNEL_RADIUS=w.blurRadius.toFixed(2),m.material.blending=f.material.blending=p.material.blending=S.NoBlending,m.material.depthWrite=f.material.depthWrite=p.material.depthWrite=!1,m.material.depthTest=f.material.depthTest=p.material.depthTest=!1,f.material.defines.HORIZONTAL=1,h=Object(c.createShaderMaterial)(C),h.uniforms.tDepth.value=_?l:a,h.depthWrite=!1,h.transparent=!0,s=n(h),o.add(s),w.debug&&(g=new S.Mesh(new S.BoxGeometry(1,1,1),new S.MeshBasicMaterial({color:65280,wireframe:!0})),o.add(g)),this.setTransform(new S.Vector3(0,0,0),new S.Vector3(1,1,1),new S.Vector3(0,1,0),S.Object3D.DefaultUp)}r.r(t),r.d(t,"createGroundShape",function(){return n}),r.d(t,"setGroundShapeTransform",function(){return i}),r.d(t,"GroundShadow",function(){return o});var s,a,l,c=r("./src/wgs/render/ShaderUtils.js"),u=r("./src/wgs/render/ShaderPass.js"),d=r("./src/wgs/render/shaders/groundshadow_depth_vert.glsl"),h=r.n(d),f=r("./src/wgs/render/shaders/groundshadow_depth_frag.glsl"),p=r.n(f),m=r("./src/wgs/render/shaders/screen_quad_uv_vert.glsl"),g=r.n(m),v=r("./src/wgs/render/shaders/groundshadow_ao_frag.glsl"),y=r.n(v),_=r("./src/wgs/render/shaders/groundshadow_blur_frag.glsl"),b=r.n(_),x=r("./src/wgs/render/shaders/groundshadow_color_frag.glsl"),w=r.n(x),E=r("./src/wgs/render/GroundFlags.js"),S=r("./thirdparty/three.js/three.js"),A=(r.n(S),{uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:h.a,fragmentShader:p.a}),M={uniforms:{tDepth:{type:"t",value:null},worldSize:{type:"v3",value:new S.Vector3(1,1,1)}},defines:{},vertexShader:g.a,fragmentShader:y.a},T={uniforms:{tDepth:{type:"t",value:null}},defines:{},vertexShader:g.a,fragmentShader:b.a},C={uniforms:{tDepth:{type:"t",value:null},uShadowColor:{type:"v4",value:new S.Vector4(0,0,0,1)}},vertexShader:g.a,fragmentShader:w.a};o.prototype.constructor=o},"./src/wgs/render/HalfFloat.js":function(e,t,r){"use strict";r.r(t),r.d(t,"FloatToHalf",function(){return a}),r.d(t,"HalfToFloat",function(){return l}),r.d(t,"HALF_INT_MAX",function(){return c}),r.d(t,"IntToHalf",function(){return u}),r.d(t,"HalfToInt",function(){return d}),r.d(t,"HalfTest",function(){return h});var n=new Float32Array(1),i=new Uint32Array(n.buffer),o=new Uint16Array(1),s=new Uint16Array(1),a=function(e){n[0]=e;var t=i[0],r=0;if(0===(2147483647&t))s[r++]=t>>16;else{
var a=2147483648&t,l=2139095040&t,c=8388607&t;if(0===l)s[r++]=a>>16;else if(2139095040==l)0===c?s[r++]=a>>16|31744:s[r++]=65024;else{var u,d,h=a>>16,f=(0|l>>23)-127+15;f>=31?s[r++]=a>>16|31744:0>=f?(14-f>24?u=0:(c|=8388608,u=c>>14-f,o[0]=u,u=o[0],c>>13-f&1&&(u+=1)),s[r++]=h|u):(d=f<<10,o[0]=d,d=o[0],u=c>>13,o[0]=u,u=o[0],4096&c?s[r++]=(h|d|u)+1:s[r++]=h|d|u)}}return s[0]},l=function(e){var t,r=65535&e;if(0===(32767&r))t=r<<16;else{var o=32768&r,s=31744&r,a=1023&r;if(0===s){var l=-1;do l++,a<<=1;while(0===(1024&a));var c=o<<16,u=(s<<16>>26)-15+127-l,d=u<<23,h=(1023&a)<<13;t=c|d|h}else 31744==s?t=0===a?o<<16|2139095040:4290772992:(c=o<<16,u=(s<<16>>26)-15+127,d=u<<23,h=a<<13,t=c|d|h)}return i[0]=t,n[0]},c=59390,u=function(e){if(e>c-1||0>e)return a(NaN);if(0===e)return 0;var t=!1;e>c/2-1&&(t=!0,e-=c/2-1);var r=0|Math.abs(e/1024),n=Math.pow(2,r-13),i=n+(e-1024*r)*n/1024;return t&&(i=-i),a(i)},d=function(e){if(0===e)return 0;var t=l(e),r=!1;0>t&&(r=!0,t=-t);var n=0|Math.floor(Math.log(t)/Math.log(2)),i=Math.pow(2,n),o=(t-i)/i*1024+1024*(n+13);return r&&(o+=c/2-1),o},h=function(){for(var e=[-1/255,-.17,-75,-1789,-.005],t=0;t<e.length;t++);for(var t=0;c>t;t++){d(u(t))}}},"./src/wgs/render/LineShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"LineShader",function(){return c});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/shaders/line_vert.glsl")),o=r.n(i),s=r("./src/wgs/render/shaders/line_frag.glsl"),a=r.n(s),l=r("./src/wgs/render/ShaderChunks.js"),c={uniforms:n.UniformsUtils.merge([l.ShaderChunks.CutPlanesUniforms,{pixelsPerUnit:{type:"f",value:1},aaRange:{type:"f",value:.5},tLayerMask:{type:"t",value:null},tLineStyle:{type:"t",value:null},vLineStyleTexSize:{type:"v2",value:new n.Vector2(13,70)},tRaster:{type:"t",value:null},tSelectionTexture:{type:"t",value:null},vSelTexSize:{type:"v2",value:new n.Vector2(4096,1)},displayPixelRatio:{type:"f",value:1},opacity:{type:"f",value:1},selectionColor:{type:"v4",value:new n.Vector4(0,0,1,1)},modelId:{type:"v3",value:new n.Vector3(0,0,0)},viewportId:{type:"f",value:0},swap:{type:"f",value:0},grayscale:{type:"f",value:0},viewportBounds:{type:"v4",value:new n.Vector4(0,0,1,1)},unpackXform:{type:"v4",value:new n.Vector4(1,1,0,0),perObject:!0},tIdColor:{type:"t",value:null,perObject:!0},vIdColorTexSize:{type:"v2",value:new n.Vector2(256,1),perObject:!0},meshAnimTime:{type:"f",value:0,perObject:!0}}]),attributes:{fields1:0,fields2:0,color4b:0,dbId4b:0,flags4b:0,layerVp4b:0,extraParams:0,instFlags4b:0,uvIdColor:0},defines:{},vertexShader:o.a,fragmentShader:a.a}},"./src/wgs/render/LineShaderSS.js":function(e,t,r){"use strict";r.r(t),r.d(t,"LineShaderSS",function(){return c});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/shaders/liness_vert.glsl")),o=r.n(i),s=r("./src/wgs/render/shaders/liness_frag.glsl"),a=r.n(s),l=r("./src/wgs/render/ShaderChunks.js"),c={uniforms:n.UniformsUtils.merge([l.ShaderChunks.CutPlanesUniforms,{pixelsPerUnit:{type:"f",value:1},aaRange:{type:"f",value:1},tLayerMask:{type:"t",value:null},tLineStyle:{type:"t",value:null},vLineStyleTexSize:{type:"v2",value:new n.Vector2(13,70)},tRaster:{type:"t",value:null},tSelectionTexture:{type:"t",value:null},vSelTexSize:{type:"v2",value:new n.Vector2(4096,1)},displayPixelRatio:{type:"f",value:1},size:{type:"v2",value:new n.Vector2(1024,768)},opacity:{type:"f",value:1},selectionColor:{type:"v4",value:new n.Vector4(0,0,1,1)},modelId:{type:"v3",value:new n.Vector3(0,0,0)},viewportId:{type:"f",value:0},swap:{type:"f",value:0},grayscale:{type:"f",value:0},viewportBounds:{type:"v4",value:new n.Vector4(0,0,1,1)},unpackXform:{type:"v4",value:new n.Vector4(1,1,0,0),perObject:!0},tIdColor:{type:"t",value:null,perObject:!0},vIdColorTexSize:{type:"v2",value:new n.Vector2(256,1),perObject:!0},meshAnimTime:{type:"f",value:0,perObject:!0}}]),attributes:{fields1:0,fields2:0,color4b:0,dbId4b:0,flags4b:0,layerVp4b:0,extraParams:0,instFlags4b:0,uvIdColor:0},defines:{},vertexShader:o.a,fragmentShader:a.a}},"./src/wgs/render/LineStyleDef.js":function(e,t,r){"use strict";r.r(t),r.d(t,"LineStyleDefs",function(){return i}),r.d(t,"createLinePatternTextureData",function(){return o}),r.d(t,"createLinePatternTextureFromDefs",function(){return s}),r.d(t,"createLinePatternTexture",function(){return a}),r.d(t,"createLinePatternForDef",function(){return l});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),[{id:"SOLID",name:"Solid",ascii_art:"_______________________________________",def:[1]},{id:"BORDER",name:"Border",ascii_art:"__ __ . __ __ . __ __ . __ __ . __ __ .",def:[.5,-.25,.5,-.25,0,-.25]},{id:"BORDER2",name:"Border (.5x)",ascii_art:"__ __ . __ __ . __ __ . __ __ . __ __ .",def:[.25,-.125,.25,-.125,0,-.125]},{id:"BORDERX2",name:"Border (2x)",ascii_art:"____  ____  .  ____  ____  .  ___",def:[1,-.5,1,-.5,0,-.5]},{id:"CENTER",name:"Center",ascii_art:"____ _ ____ _ ____ _ ____ _ ____ _ ____",def:[1.25,-.25,.25,-.25]},{id:"CENTER2",name:"Center (.5x)",ascii_art:"___ _ ___ _ ___ _ ___ _ ___ _ ___",def:[.75,-.125,.125,-.125]},{id:"CENTERX2",name:"Center (2x)",ascii_art:"________  __  ________  __  _____",def:[2.5,-.5,.5,-.5]},{id:"DASHDOT",name:"Dash dot",ascii_art:"__ . __ . __ . __ . __ . __ . __ . __",def:[.5,-.25,0,-.25]},{id:"DASHDOT2",name:"Dash dot (.5x)",ascii_art:"_._._._._._._._._._._._._._._.",def:[.25,-.125,0,-.125]},{id:"DASHDOTX2",name:"Dash dot (2x)",ascii_art:"____  .  ____  .  ____  .  ___",def:[1,-.5,0,-.5]},{id:"DASHED",name:"Dashed",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __ _",def:[.5,-.25]},{id:"DASHED2",name:"Dashed (.5x)",ascii_art:"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",def:[.25,-.125]},{id:"DASHEDX2",name:"Dashed (2x)",ascii_art:"____  ____  ____  ____  ____  ___",def:[1,-.5]},{id:"DIVIDE",name:"Divide",ascii_art:"____ . . ____ . . ____ . . ____ . . ____",def:[.5,-.25,0,-.25,0,-.25]},{id:"DIVIDE2",name:"Divide (.5x)",ascii_art:"__..__..__..__..__..__..__..__.._",def:[.25,-.125,0,-.125,0,-.125]},{id:"DIVIDEX2",name:"Divide (2x)",ascii_art:"________  .  .  ________  .  .  _",def:[1,-.5,0,-.5,0,-.5]},{id:"DOT",name:"Dot",ascii_art:". . . . . . . . . . . . . . . . . . . . . . . .",def:[0,-.25]},{id:"DOT2",name:"Dot (.5x)",ascii_art:"........................................",def:[0,-.125]},{id:"DOTX2",name:"Dot (2x)",ascii_art:".  .  .  .  .  .  .  .  .  .  .  .  .  .",def:[0,-.5]},{id:"HIDDEN",name:"Hidden",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __ __",def:[.25,-.125]},{id:"HIDDEN2",name:"Hidden (.5x)",ascii_art:"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",def:[.125,-.0625]},{id:"HIDDENX2",name:"Hidden (2x)",ascii_art:"____ ____ ____ ____ ____ ____ ____",def:[.5,-.25]},{id:"PHANTOM",name:"Phantom",ascii_art:"______  __  __  ______  __  __  ______",def:[1.25,-.25,.25,-.25,.25,-.25]},{id:"PHANTOM2",name:"Phantom (.5x)",ascii_art:"___ _ _ ___ _ _ ___ _ _ ___ _ _",def:[.625,-.125,.125,-.125,.125,-.125]},{id:"PHANTOMX2",name:"Phantom (2x)",ascii_art:"____________    ____    ____   _",def:[2.5,-.5,.5,-.5,.5,-.5]},{id:"ACAD_ISO02W100",name:"ISO dash",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __",def:[12,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO03W100",name:"ISO dash space",ascii_art:"__    __    __    __    __    __",def:[12,-18],pen_width:1,unit:"mm"},{id:"ACAD_ISO04W100",name:"ISO long-dash dot",ascii_art:"____ . ____ . ____ . ____ . _",def:[24,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO05W100",name:"ISO long-dash double-dot",ascii_art:"____ .. ____ .. ____ .",def:[24,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO06W100",name:"ISO long-dash triple-dot",ascii_art:"____ ... ____ ... ____",def:[24,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO07W100",name:"ISO dot",ascii_art:". . . . . . . . . . . . . . . . . . . .",def:[.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO08W100",name:"ISO long-dash short-dash",ascii_art:"____ __ ____ __ ____ _",def:[24,-3,6,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO09W100",name:"ISO long-dash double-short-dash",ascii_art:"____ __ __ ____",def:[24,-3,6,-3,6,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO10W100",name:"ISO dash dot",ascii_art:"__ . __ . __ . __ . __ . __ . __ . ",def:[12,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO11W100",name:"ISO double-dash dot",ascii_art:"__ __ . __ __ . __ __ . __ _",def:[12,-3,12,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO12W100",name:"ISO dash double-dot",ascii_art:"__ . . __ . . __ . . __ . .",def:[12,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO13W100",name:"ISO double-dash double-dot",ascii_art:"__ __ . . __ __ . . _",def:[12,-3,12,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO14W100",name:"ISO dash triple-dot",ascii_art:"__ . . . __ . . . __ . . . _",def:[12,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO15W100",name:"ISO double-dash triple-dot",ascii_art:"__ __ . . . __ __ . .",def:[12,-3,12,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"FENCELINE1",name:"Fenceline circle",ascii_art:"----0-----0----0-----0----0-----0--",def:[.25,-.1,["CIRC1","ltypeshp.shx","x=-.1","s=.1"],-.1,1]},{id:"FENCELINE2",name:"Fenceline square",ascii_art:"----[]-----[]----[]-----[]----[]---",def:[.25,-.1,["BOX","ltypeshp.shx","x=-.1","s=.1"],-.1,1]},{id:"TRACKS",name:"Tracks",ascii_art:"-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-",def:[.15,["TRACK1","ltypeshp.shx","s=.25"],.15]},{id:"BATTING",name:"Batting",ascii_art:"SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS",def:[1e-4,-.1,["BAT","ltypeshp.shx","x=-.1","s=.1"],-.2,["BAT","ltypeshp.shx","r=180","x=.1","s=.1"],-.1]},{id:"HOT_WATER_SUPPLY",name:"Hot water supply",ascii_art:"---- HW ---- HW ---- HW ----",def:[.5,-.2,["HW","STANDARD","S=.1","R=0.0","X=-0.1","Y=-.05"],-.2]},{id:"GAS_LINE",name:"Gas line",ascii_art:"----GAS----GAS----GAS----GAS----GAS----GAS--",def:[.5,-.2,["GAS","STANDARD","S=.1","R=0.0","X=-0.1","Y=-.05"],-.25]},{id:"ZIGZAG",name:"Zig zag",ascii_art:"/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/",def:[1e-4,-.2,["ZIG","ltypeshp.shx","x=-.2","s=.2"],-.4,["ZIG","ltypeshp.shx","r=180","x=.2","s=.2"],-.2]}]),o=function(e,t){for(var r=e+3,i=t,o=1;r>o;)o*=2;for(r=o,o=1;i>o;)o*=2;i=o;var s=new Uint8Array(r*i),a=new n.DataTexture(s,r,i,n.LuminanceFormat,n.UnsignedByteType,n.UVMapping,n.ClampToEdgeWrapping,n.ClampToEdgeWrapping,n.NearestFilter,n.NearestFilter,0);return a.generateMipmaps=!1,a.flipY=!1,a.needsUpdate=!0,{tex:s,pw:r,ph:i,lineStyleTex:a}},s=function(e){for(var t=e.length,r=0,n=0;t>n;n++){var i=e[n];i.def.length>r&&(r=i.def.length)}for(var s=o(r,t),a=s.tex,c=s.pw,u=s.lineStyleTex,d=0;t>d;d++){var h=e[d];l(h,a,d,c)}return u},a=function(){return s(i)},l=function(e,t,r,n){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:96,o=r*n,s=e.unit&&"mm"==e.unit?1/25.4:1,a=e.pen_width||0,l=e.def,c=0,u=0;u<l.length;u++){var d=Math.abs(l[u]),h=.5*a>=d;h&&(d=0);var f=0|d*i*s;c+=f,t[o+u+2]=f?f:1}t[o]=c%256,t[o+1]=c/256,t[o+l.length+2]=0}},"./src/wgs/render/MaterialConverter.js":function(e,t,r){"use strict";function n(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){function s(e){n(l,i,o,s,a,"next",e)}function a(e){n(l,i,o,s,a,"throw",e)}var l=e.apply(t,r);s(void 0)})}}function o(e){var t=e.materials,r=t[e.userassets[0]];if(r){var n=r.definition;if("TilingPattern"===n)return!0}return!1}function s(){return a.apply(this,arguments)}function a(){return a=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.MaterialConverterPrism&&b.MaterialConverterPrism.convertPrismMaterial){e.next=3;break}return e.next=3,b.theExtensionManager.downloadExtension("Autodesk.Viewing.MaterialConverterPrism");case 3:if(!x.convertPrismMaterial)for(t in b.MaterialConverterPrism)x[t]=b.MaterialConverterPrism[t];case 4:case"end":return e.stop()}},e)})),a.apply(this,arguments)}function l(e,t,r,n){return c.apply(this,arguments)}function c(){return c=i(regeneratorRuntime.mark(function e(t,r,n,i){var o,a,l,c,u,h,p,m,g,v,b,w,E,S,A,M,T;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=f(t),!o){e.next=7;break}return e.next=4,s();case 4:return n=x.convertPrismMaterial(t,r,n,i),t.transparent=n.transparent,e.abrupt("return",n);case 7:if(i=i||t.userassets,a=t.materials,l=a[i],c=l.properties,n){e.next=15;break}n=new y.MeshPhongMaterial,e.next=20;break;case 15:if(n instanceof y.MeshPhongMaterial){e.next=19;break}return e.abrupt("return",null);case 19:n.needsUpdate=!0;case 20:if(n.proteinMat=t,n.proteinCategories=l.categories,n.packedNormals=!0,!l||"SimplePhong"!==l.definition){e.next=86;break}n.tag=l.tag,n.proteinType=l.proteinType,void 0===n.proteinType&&(n.proteinType=null),p=Object(_.parseMaterialBoolean)(c,"generic_baked_lighting",!1),n.disableEnvMap=p,m=n.ambient=Object(_.parseMaterialColor)(c,"generic_ambient"),g=n.color=Object(_.parseMaterialColor)(c,"generic_diffuse"),v=n.specular=Object(_.parseMaterialColor)(c,"generic_specular"),b=n.emissive=Object(_.parseMaterialColor)(c,"generic_emissive"),n.shininess=Object(_.parseMaterialScalar)(c,"generic_glossiness",30),n.opacity=1-Object(_.parseMaterialScalar)(c,"generic_transparency",0),n.reflectivity=Object(_.parseMaterialScalar)(c,"generic_reflectivity_at_0deg",0),w=Object(_.parseMaterialBoolean)(c,"generic_bump_is_normal"),E=Object(_.parseMaterialScalar)(c,"generic_bump_amount",0),null==E&&(E=1),w?(E>1&&(E=1),n.normalScale=new y.Vector2(E,E)):(E>=1&&(E=.03),n.bumpScale=E),S=Object(_.parseMaterialBoolean)(c,"generic_is_metal"),void 0!==S&&(n.metal=S),A=Object(_.parseMaterialBoolean)(c,"generic_backface_cull"),void 0===A||A||(n.side=y.DoubleSide),n.transparent=l.transparent,n.textureMaps={},M=l.textures,e.t0=regeneratorRuntime.keys(M);case 48:if((e.t1=e.t0()).done){e.next=81;break}if(T=e.t1.value,u={},u.textureObj=a[M[T].connections[0]],h=u.textureObj.properties,u.textureObj.matrix=d(u.textureObj,!1,r),u.uriPointer=h.uris.unifiedbitmap_Bitmap.values,u.uri=u.uriPointer[0],u.uri){e.next=58;break}return e.abrupt("continue",48);case 58:if("generic_diffuse"!=T){e.next=63;break}u.mapName="map",(!n.color||0===n.color.r&&0===n.color.g&&0===n.color.b)&&n.color.setRGB(1,1,1),e.next=78;break;case 63:if("generic_bump"!=T){e.next=67;break}w?u.mapName="normalMap":u.mapName="bumpMap",e.next=78;break;case 67:if("generic_specular"!=T){e.next=71;break}u.mapName="specularMap",e.next=78;break;case 71:if("generic_alpha"!=T){e.next=77;break}u.mapName="alphaMap",n.side=y.DoubleSide,n.transparent=!0,e.next=78;break;case 77:return e.abrupt("continue",48);case 78:n.textureMaps[u.mapName]=u,e.next=48;break;case 81:0===g.r&&0===g.g&&0===g.b&&0===v.r&&0===v.g&&0===v.b&&0===m.r&&0===m.g&&0===m.b&&0===b.r&&0===b.g&&0===b.b&&(g.r=g.g=g.b=.4),n.extraDepthOffset=Object(_.parseMaterialScalar)(c,"generic_depth_offset"),n.extraDepthOffset&&(n.polygonOffset=!0,n.polygonOffsetFactor=n.extraDepthOffset,n.polygonOffsetUnits=0),e.next=91;break;case 86:n.ambient=new y.Color(197379),n.color=new y.Color(7829367),n.specular=new y.Color(3355443),n.shininess=30,n.shading=y.SmoothShading;case 91:return t.transparent=n.transparent,e.abrupt("return",n);case 93:case"end":return e.stop()}},e)})),c.apply(this,arguments)}function u(e,t){if(e){var r=e.properties;t.invert=Object(_.parseMaterialBoolean)(r,"unifiedbitmap_Invert"),t.clampS=!Object(_.parseMaterialBoolean)(r,"texture_URepeat",!0),t.clampT=!Object(_.parseMaterialBoolean)(r,"texture_VRepeat",!0),t.wrapS=t.clampS?y.ClampToEdgeWrapping:y.RepeatWrapping,t.wrapT=t.clampT?y.ClampToEdgeWrapping:y.RepeatWrapping,t.matrix=e.matrix||(e.matrix=Object(_.Get2DSimpleMapTransform)(r))}}function d(e){return e.matrix||(e.matrix=Object(_.Get2DSimpleMapTransform)(e.properties)),e.matrix}function h(e,t,r,n){"bumpMap"==e.mapName||"normalMap"==e.mapName?t.anisotropy=0:t.anisotropy=n||0,t.flipY=void 0!==e.flipY?e.flipY:!0,t.invert=!1,t.wrapS=y.RepeatWrapping,t.wrapT=y.RepeatWrapping,e.isPrism?x.convertPrismTexture(e.textureObj,t,r):u(e.textureObj,t)}function f(e){var t=e.materials,r=t[e.userassets[0]];if(r){var n=r.definition;if("TilingPattern"===n){var i=r.properties.references.grout_material.connections[0];r=t[i],r&&(n=r.definition)}return"PrismLayered"===n||"PrismMetal"===n||"PrismOpaque"===n||"PrismTransparent"===n||"PrismGlazing"===n||"PrismWood"===n}return!1}function p(e,t){var r=new y.MeshPhongMaterial;r.packedNormals=!0,r.textureMaps={};var n=e.values,i=n.diffuse;if(i)if(Array.isArray(i))r.color=new y.Color(i[0],i[1],i[2]);else if("string"==typeof i){r.color=new y.Color(1,1,1);var o={};o.mapName="map";var s=t.gltf.textures[i];o.uri=s.source,o.flipY=!1,r.textureMaps[o.mapName]=o}var a=n.specular;return a&&(r.specular=new y.Color(a[0],a[1],a[2])),n.shininess&&(r.shininess=n.shininess),r.reflectivity=0,r.transparent=!1,r}function m(e){return.299*e.r+.587*e.g+.114*e.b}function g(e,t,r){var n=e.proteinMat?e.proteinMat:null,i=e.prismType&&-1!==e.prismType.indexOf("Prism");i&&e.transparent&&(e.side===y.FrontSide&&"PrismGlazing"!==e.prismType&&(e.side=y.DoubleSide),e.side===y.DoubleSide&&e.depthTest&&(e.twoPassTransparency=!0));var o=e.textureMaps||{};if(!t){var s=e.proteinType&&-1!==e.proteinType.indexOf("Prism");if(e.metal)e.reflectivity||(e.reflectivity=m(e.specular)),n&&(1===e.reflectivity&&(e.reflectivity=m(e.specular)),0===e.color.r&&0===e.color.g&&0===e.color.b||(e.color.r*=.1,e.color.g*=.1,e.color.b*=.1));else if(s){var a=!1;if("PrismLayered"===e.proteinType){e.clearcoat=!0,e.reflectivity=.06;var l=e.proteinCategories;l&&l.length&&-1!=l[0].indexOf("Metal")&&(a=!0)}e.reflectivity=Math.sqrt(e.reflectivity),a?e.specular.copy(e.color):(e.specular.r=e.reflectivity,e.specular.g=e.reflectivity,e.specular.b=e.reflectivity)}else e.reflectivity?e.reflectivity>.3?(e.metal=!0,e.specular.r=e.color.r,e.specular.g=e.color.g,e.specular.b=e.color.b,e.color.r*=.1,e.color.g*=.1,e.color.b*=.1):(e.specular.r*=e.reflectivity,e.specular.g*=e.reflectivity,e.specular.b*=e.reflectivity):1!==e.color.r||1!==e.color.g||1!==e.color.b||1!==e.specular.r||1!==e.specular.g||1!==e.specular.b||o.map||o.specularMap?(e.reflectivity=.01+.06*m(e.specular),e.specular.r*=e.reflectivity,e.specular.g*=e.reflectivity,e.specular.b*=e.reflectivity):(e.metal=!0,e.reflectivity=.7,e.color.r*=.1,e.color.g*=.1,e.color.b*=.1),e.opacity<1&&(e.reflectivity=1);(e.transparent||o.map&&-1!==o.map.uri.toLowerCase().indexOf(".png")||o.alphaMap)&&(e.alphaTest=.01)}if(o.normalMap){var c=e.bumpScale;(void 0===c||c>=1)&&(c=1),e.normalScale=new y.Vector2(c,c)}else void 0===e.bumpScale&&(o.map||o.bumpMap)?e.bumpScale=.03:e.bumpScale>=1&&(e.bumpScale=.03);if((!t||i)&&e.transparent)if(i)e.lmv_depthWriteTransparent=!0,e.depthWrite=!!r;else if(e.opacity>=1){var u=o.alphaMap;u||(e.transparency=!1)}else e.lmv_depthWriteTransparent=!0,e.depthWrite=!!r;void 0!==e.shininess&&(e.shininess*=.25)}function v(e,t){if(t.attributes.color&&(e.vertexColors=y.VertexColors,e.needsUpdate=!0),!e.proteinType&&t.attributes.uv&&t.attributes.uv.isPattern){var r=!1;e.map&&!e.bumpMap&&(e.bumpMap=e.map,e.needsUpdate=!0,r=!0),e.textureMaps&&e.textureMaps.map&&!e.textureMaps.bumpMap&&(e.textureMaps.bumpMap=e.textureMaps.map,e.needsUpdate=!0,r=!0),r&&void 0===e.bumpScale&&(e.bumpScale=.03)}}r.r(t),r.d(t,"MaterialConverter",function(){return x});var y=r("./thirdparty/three.js/three.js"),_=(r.n(y),r("./src/wgs/render/MaterialConverterCommon.js")),b=Autodesk.Viewing,x={convertMaterial:l,convertTexture:h,isPrismMaterial:f,convertMaterialGltf:p,applyAppearanceHeuristics:g,applyGeometryFlagsToMaterial:v,hasTiling:o,loadMaterialConverterPrismLibrary:s}},"./src/wgs/render/MaterialConverterCommon.js":function(e,t,r){"use strict";function n(e,t,r){if(!e||!e.colors)return new u.Color(1,0,0);var n=e.colors[t];if(!n)return new u.Color(0,0,0);var i=n.values;if(!i||!i.length)return new u.Color(1,0,0);var o=i[0];return new u.Color(o.r,o.g,o.b)}function i(e,t,r){if(!e||!e.scalars)return r;var n=e.scalars[t];return n?n.values[0]:r}function o(e,t,r){if(!e||!e.booleans)return r;var n=e.booleans[t];return void 0===n?r:n}function s(e,t,r,n){if(!e||!e[t])return n;var i=e[t][r];return i?i.values[0]:n}function a(e){var t=e;return.04045>=t?t/=12.92:t=Math.pow((t+.055)/1.055,2.4),t}function l(e){var t,r,n;return t=a(e.r),r=a(e.g),n=a(e.b),new u.Color(t,r,n)}function c(e){var t=i(e,"texture_UScale",1),r=i(e,"texture_VScale",1),n=i(e,"texture_UOffset",0),o=i(e,"texture_VOffset",0),s=i(e,"texture_WAngle",0);return{elements:[Math.cos(s)*t,Math.sin(s)*r,0,-Math.sin(s)*t,Math.cos(s)*r,0,n,o,1]}}r.r(t),r.d(t,"parseMaterialColor",function(){return n}),r.d(t,"parseMaterialScalar",function(){return i}),r.d(t,"parseMaterialBoolean",function(){return o}),r.d(t,"parseMaterialGeneric",function(){return s}),r.d(t,"SRGBToLinearFloat",function(){return a}),r.d(t,"SRGBToLinear",function(){return l}),r.d(t,"Get2DSimpleMapTransform",function(){return c});var u=r("./thirdparty/three.js/three.js");r.n(u)},"./src/wgs/render/MaterialManager.js":function(e,t,r){"use strict";function n(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){function s(e){n(l,i,o,s,a,"next",e)}function a(e){n(l,i,o,s,a,"throw",e)}var l=e.apply(t,r);s(void 0)})}}function o(e,t,r){e.x=t.r,e.y=t.g,e.z=t.b,e.w=r}function s(e){this._renderer=e,this._textures={},this._texturesToUpdate=[],this._materials={},this._materialsNonHDR={},this._exposureBias=0,this._tonemapMethod=0,this._envMapExposure=1,this._envRotationSin=0,this._envRotationCos=1,this._reflectionMap=null,this._irradianceMap=null,this._cutplanes=[],this._mrtNormals=!1,this._mrtIdBuffer=void 0,this._polygonOffsetOn=!1,this._pixelsPerUnit=1,this._lineStyleTex=null,this._swapBlackAndWhite=0,this._grayscaleLines=0,this._depthWriteTransparent=!0,this._needsTwoSided=!1,this._hasTransparentMaterial=!1,this.hasPrism=!1,this._layerMaskTextures=[],this._layerMaps=[],this._selectionTextures={},this._prismWoodTextures=void 0,this.defaultMaterial=new h.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:h.SmoothShading,reflectivity:0}),this.addMaterial("__defaultMaterial__",this.defaultMaterial),this.initLineStyleTexture(),this.refCount=0}function a(e,t,r){var n=e.slots[r];n?-1==n.indexOf(t)&&n.push(t):e.slots[r]=[t]}r.r(t),r.d(t,"MATERIAL_VARIANT",function(){return y}),r.d(t,"MaterialManager",function(){return s});var l=r("./src/wgs/render/LineStyleDef.js"),c=r("./src/logger/Logger.js"),u=r("./src/wgs/render/MaterialConverter.js"),d=(r("./src/wgs/scene/RenderModel.js"),r("./src/file-loaders/main/TextureLoader.js")),h=r("./thirdparty/three.js/three.js"),f=(r.n(h),r("./src/wgs/render/ShaderUtils.js")),p=r("./src/wgs/render/LineShader.js"),m=r("./src/wgs/render/LineShaderSS.js"),g=new h.Color("#0000FF"),v=.6,y={INSTANCED:0,VERTEX_IDS:1};s.prototype.dtor=function(){this.cleanup(),h.Cache.clear()},s.prototype._getModelHash=function(e){return"model:"+(e?e.id:"")+"|"},s.prototype._getMaterialHash=function(e,t){return e&&e.isOTG()?t:this._getModelHash(e)+"mat:"+t},s.prototype._getTextureHash=function(e,t,r){return this._getModelHash(e)+"tex:"+t+"|map:"+r},s.prototype.addNonHDRMaterial=function(e,t){t.doNotCut||(t.cutplanes=this._cutplanes),this._applyMRTFlags(t),this._materialsNonHDR[e]=t},s.prototype.removeNonHDRMaterial=function(e){delete this._materialsNonHDR[e]},s.prototype.addMaterialNonHDR=function(e,t){this.addNonHDRMaterial(e,t)},s.prototype.addHDRMaterial=function(e,t){this._reflectionMap&&!t.disableEnvMap&&(t.envMap=this._reflectionMap),this._irradianceMap&&(t.irradianceMap=this._irradianceMap),t.exposureBias=Math.pow(2,this._exposureBias),t.tonemapOutput=this._tonemapMethod,t.envMapExposure=this._envMapExposure,t.envRotationSin=this._envRotationSin,t.envRotationCos=this._envRotationCos,this._applyCutPlanes(t),this._applyMRTFlags(t),this._applyPolygonOffset(t,this._polygonOffsetOn),this._materials[e]=t},s.prototype._applyCutPlanes=function(e){if(!e.doNotCut){e.cutplanes=this._cutplanes,e.needsUpdate=!0;var t=this._cutplanes&&this._cutplanes.length>0;t?e.side=h.DoubleSide:this._needsTwoSided||e.is2d||(e.side=h.FrontSide)}},s.prototype.addMaterial=function(e,t,r){var n=t.prismType&&-1!==t.prismType.indexOf("Prism");this.hasPrism=n||this.hasPrism,u.MaterialConverter.applyAppearanceHeuristics(t,n||r,this.isDepthWriteTransparentEnabled()),t.side===h.DoubleSide&&(this._needsTwoSided=!0),this.addHDRMaterial(e,t)},s.prototype.addLineMaterial=function(e,t,r){var n=r&&this._layerMaskTextures[r];n&&(t.defines.HAS_LAYERS=1,t.uniforms.tLayerMask.value=n),t.hasLineStyles&&(t.defines.HAS_LINESTYLES=1,t.defines.MAX_LINESTYLE_LENGTH=this._lineStyleTex.image.width,t.uniforms.tLineStyle.value=this._lineStyleTex,t.uniforms.vLineStyleTexSize.value.set(this._lineStyleTex.image.width,this._lineStyleTex.image.height)),t.uniforms.swap.value=this._swapBlackAndWhite,t.uniforms.grayscale.value=this._grayscaleLines,t.doNotCut||(t.cutplanes=this._cutplanes),this._updatePixelScaleForMaterial(t),this._materials[e]=t},s.prototype.addOverrideMaterial=function(e,t){if(this.addNonHDRMaterial(e,t),t.variants)for(var r=0;r<t.variants.length;r++){var n=t.variants[r];if(n){var i=e+"_variant_"+r;this.addNonHDRMaterial(i,n)}}},s.prototype.getMaterialVariant=function(e,t,r){var n=!!e.hash,i=n?e.hash:this._getModelHash(r)+e.id,o=i+"|"+t,s=this._materials[o];return s||(s=this.cloneMaterial(e,r),t===y.INSTANCED?(s.useInstancing=!0,s.vertexIds=!0):t===y.VERTEX_IDS&&(s.vertexIds=!0),this.addHDRMaterial(o,s)),n&&this._addMaterialRef(s,r.id),s},s.prototype.addInstancingSupport=function(e){var t=e.clone();t.useInstancing=!0,t.packedNormals=e.packedNormals;var r=e.clone();r.wideLines=!0,r.packedNormals=e.packedNormals,e.variants=[t,r],e.getCustomOverrideMaterial=function(e){return e.useInstancing?this.variants[0]:e.wideLines?(this.variants[1].linewidth=e.linewidth,this.variants[1]):null}},s.prototype.addCompactLayoutSupport=function(e){var t=function(t){var r=t.clone();return e.uniforms.tSelectionTexture.value&&(r.uniforms.tSelectionTexture.value=e.uniforms.tSelectionTexture.value),e.uniforms.tLayerMask.value&&(r.uniforms.tLayerMask.value=e.uniforms.tLayerMask.value),r.is2d=e.is2d,r.modelScale=e.modelScale,r.defines=Object.assign({},e.defines),r.attributes=Object.assign({},e.attributes),r},r=t(e);r.defines.UNPACK_POSITIONS=1;var n=t(e);n.defines.USE_INSTANCING=1;var i=t(e);i.defines.UNPACK_POSITIONS=1,i.defines.USE_INSTANCING=1,e.variants=[r,n,i],e.getCustomOverrideMaterial=function(e){if(e.defines){var t=(e.defines.UNPACK_POSITIONS?1:0)+(e.defines.USE_INSTANCING?2:0);if(t>0)return this.variants[t-1]}return null}},s.prototype.removeMaterial=function(e){delete this._materials[e]},s.prototype.findMaterial=function(e,t){var r=this._getMaterialHash(e,t),n=this._materials[r];return n},s.prototype.convertSharedMaterial=function(){var e=i(regeneratorRuntime.mark(function t(e,r,n){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.findMaterial(e,n)){t.next=6;break}return t.next=4,this.convertOneMaterial(e,r,n);case 4:i=t.sent,i.hash=n;case 6:return this._addMaterialRef(i,e.id),t.abrupt("return",i);case 8:case"end":return t.stop()}},t,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),s.prototype.convertOneMaterial=function(){var e=i(regeneratorRuntime.mark(function t(e,r,n){var i,o,s,a,l,d,f,p,m,g,v,y,_,b,x,w;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=u.MaterialConverter.isPrismMaterial(r),!i){t.next=4;break}return t.next=4,u.MaterialConverter.loadMaterialConverterPrismLibrary();case 4:return o=e.getData(),s=o&&o.materials?o.materials.scene.SceneUnit:"inch",a=i&&u.MaterialConverter.swapPrismWoodTextures(this._prismWoodTextures),a&&c.logger.warn("Unexpected wood textures converting a material"),t.next=10,u.MaterialConverter.convertMaterial(r,s);case 10:if(l=t.sent,o.doubleSided&&(l.side=h.DoubleSide),this.addMaterial(n,l),this._hasTransparentMaterial=this._hasTransparentMaterial||l.transparent,!u.MaterialConverter.hasTiling(r)){t.next=36;break}l.decals=[],d=r.materials,f=d[r.userassets[0]],p=f.properties.references.base_materials.connections,m=f.properties.references.tiles.connections,g=[],v=0;case 22:if(!(v<m.length)){t.next=35;break}return y=d[m[v]],g.push(y),t.next=27,u.MaterialConverter.convertMaterial(r,s,null,p[v]);case 27:_=t.sent,_.useTiling=!0,_.transparent=!0,l.decals.push({uv:0,material:_}),this.addMaterial(n+"|tile|"+v,_);case 32:v++,t.next=22;break;case 35:u.MaterialConverter.materialTilingPattern(r,f,g,l.decals,s);case 36:if(!r.decals){t.next=49;break}l.decals||(l.decals=[]),b=0,x=r.decals.length;case 39:if(!(x>b)){t.next=49;break}return w=r.decals[b],t.next=43,u.MaterialConverter.convertMaterial(w.material,s);case 43:_=t.sent,l.decals.push({uv:w.uv||0,material:_}),this.addMaterial(n+"|decal|"+b,_);case 46:b++,t.next=39;break;case 49:return this._prismWoodTextures=i&&u.MaterialConverter.swapPrismWoodTextures(a),t.abrupt("return",l);case 51:case"end":return t.stop()}},t,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),s.prototype.forEach=function(e,t,r,n){n=n||this._materials;for(var i in n){var o=n[i];t&&o.is2d||(e(o),r&&o.variants&&o.variants.forEach(function(t){t&&e(t)}))}};var _={needsClear:!1,needsRender:!1,overlayDirty:!1};s.prototype.updateMaterials=function(){for(_.needsRender=!1;this._texturesToUpdate.length;){var e=this._texturesToUpdate.pop();for(var t in e.slots)for(var r=e.slots[t],n=0;n<r.length;n++)r[n][t]=e.tex,r[n].needsUpdate=!0,_.needsRender=!0}return _},s.prototype.setTextureInCache=function(e,t,r){var n=this._getTextureHash(e,t.uri,t.mapName),i=this._textures[n];if(i){i.tex||(i.tex=r);for(var o in i.slots)for(var s=i.slots[o],a=0;a<s.length;a++)s[a][o]=r;this._texturesToUpdate.push(i)}},s.prototype.loadTextureFromCache=function(e,t,r,n){var i=this._getTextureHash(e,r.uri,r.mapName),o=this._textures[i];if(o)o.tex?(t[n]=o.tex,t.needsUpdate=!0):(o.slots[n]||(o.slots[n]=[]),o.slots[n].push(t));else{var s={};s[n]=[t],this._textures[i]={slots:s,tex:null}}return!!o},s.prototype.getModelMaterials=function(e){var t=this._getModelHash(e),r={};for(var n in this._materials)if(-1!==n.indexOf(t)){var i=this._materials[n],o=i.defines&&i.defines.hasOwnProperty("SELECTION_RENDERER");o||(r[n]=i)}var s={};for(var n in this._materialsNonHDR)-1!==n.indexOf(t)&&(s[n]=this._materialsNonHDR[n]);var a={};for(var l in this._textures)-1!==l.indexOf(t)&&(a[l]=this._textures[l]);return{mats:r,matsNonHDR:s,textures:a}},s.prototype.exportModelMaterials=function(e,t){var r=this.getModelMaterials(e);return this.cleanup(e),r},s.prototype.importModelMaterials=function(e,t){for(var r in e.mats){var n=e.mats[r];n.is2d?this.addLineMaterial(r,n,t):this.addHDRMaterial(r,n)}for(var r in e.matsNonHDR)this.addMaterialNonHDR(r,e.matsNonHDR[r]);for(var i in e.textures)this._textures[i]=e.textures[i]},s.prototype.cloneMaterial=function(e,t){var r=e.isPrismMaterial&&Autodesk.Viewing.Private.clonePrismMaterial?Autodesk.Viewing.Private.clonePrismMaterial(e):e.clone();if(e.defines&&(r.defines=Object.assign({},e.defines)),(r instanceof h.MeshPhongMaterial||r.isPrismMaterial)&&(r.packedNormals=e.packedNormals,r.exposureBias=e.exposureBias,r.irradianceMap=e.irradianceMap,r.envMapExposure=e.envMapExposure,r.envRotationSin=e.envRotationSin,r.envRotationCos=e.envRotationCos,r.proteinType=e.proteinType,r.proteinMat=e.proteinMat,r.proteinCategories=e.proteinCategories,r.tonemapOutput=e.tonemapOutput,r.cutplanes=e.cutplanes,r.textureMaps=e.textureMaps,r.texturesLoaded=e.texturesLoaded),e.doNotCut&&(r.doNotCut=!0),e.is2d&&(r.is2d=!0),e.disableEnvMap&&(r.disableEnvMap=!0),e.textureMaps)for(var n in e.textureMaps)if(e[n])r[n]=e[n];else if(t){var i=r.textureMaps[n],o=i.uri,s=i.mapName,l=this._getTextureHash(t,o,s),u=this._textures[l];u?a(u,r,n):c.logger.error("Missing texture receiver",l)}else c.logger.error("Cannot connect pending texture maps because cloneMaterial was called without a model");
return this._applyMRTFlags(r),r},s.prototype.setupMaterial=function(e,t,r){var n=e.getData(),i=this.findMaterial(e,r);if(!i){i=this.cloneMaterial(this.defaultMaterial,e);var o=this._getMaterialHash(e,r);this._materials[o]=i,c.logger.warn("Material ("+r+") missing, using default material instead.")}if(t.isLines||t.isWideLines||t.isPoints){var s=!!t.attributes.color,a=i;if(a||(a=this.defaultMaterial.clone()),t.isPoints)i=new h.PointCloudMaterial({vertexColors:s,size:t.pointSize});else{var l=s?"cachedLineMaterialVC":"cachedLineMaterial";i=a[l],t.isWideLines?(i||(i=a[l]=new h.MeshBasicMaterial({vertexColors:s}),i.wideLines=!0,t.isLines=!1),i.polygonOffset=a.polygonOffset,i.polygonOffsetFactor=a.polygonOffsetFactor,i.polygonOffsetUnits=a.polygonOffsetUnits,i.linewidth=a.linewidth):i||(i=a[l]=new h.LineBasicMaterial({vertexColors:s}))}s||(i.color=a.color),i.svfMatId=r;var d=this._getMaterialHash(e,r+"_line_"+i.id);this.addMaterialNonHDR(d,i),n.hasLines=!0}else i.svfMatId=r,u.MaterialConverter.applyGeometryFlagsToMaterial(i,t);return i},s.prototype._addMaterialRef=function(e,t){e._sharedBy||(e._sharedBy=[]);var r=e._sharedBy,n=r.indexOf(t);-1===n&&r.push(t)},s.prototype._removeMaterialRef=function(e,t){var r=e._sharedBy,n=r?r.indexOf(t):-1;-1!==n&&r.splice(n,1)},s.prototype.cleanup=function(e){var t=this,r=this._getModelHash(e),n={};for(var i in this._textures){var o=this._textures[i];-1===i.indexOf(r)?n[i]=o:o.tex&&(o.tex.dispose(),o.tex.needsUpdate=!0)}this._textures=n;var s={},a={type:"dispose"};for(var l in this._materials){var c=this._materials[l],d=!e||-1!==l.indexOf(r);if(c._sharedBy&&(d?c._sharedBy.length=0:(this._removeMaterialRef(c,e.id),0===c._sharedBy.length&&(d=!0))),d){var c=this._materials[l];if(c.dispatchEvent(a),c.needsUpdate=!0,c.envMap=null,c.is2d){c.uniforms.tLayerMask.value=null,c.uniforms.tLineStyle.value=null;var f=c.uniforms.tRaster;f&&f.value instanceof h.Texture&&(f.value.dispose(),f.value.needsUpdate=!0)}}else s[l]=this._materials[l]}this._materials=s;var p={};for(var l in this._materialsNonHDR)if(e&&-1===l.indexOf(r))p[l]=this._materialsNonHDR[l];else{var c=this._materialsNonHDR[l];c.dispatchEvent(a),c.needsUpdate=!0}this._materialsNonHDR=p;var m=function(e,r){var n=t._selectionTextures[e];n&&(n.dispose(),n.needsUpdate=!0,r&&delete t._selectionTextures[e])};if(this._prismWoodTextures&&u.MaterialConverter.disposePrismWoodTextures(this._prismWoodTextures),this._prismWoodTextures=void 0,e)m(e.id,!0),delete this._layerMaskTextures[e.id],delete this._layerMaps[e.id];else{for(var g in this._selectionTextures)this._selectionTextures.hasOwnProperty(g)&&m(g,!1);this._selectionTextures={},this._layerMaskTextures={},this._layerMaps={}}},s.prototype.toggleDepthWriteTransparent=function(e){this._depthWriteTransparent!=e&&(this._depthWriteTransparent=e,this.forEach(function(t){t.lmv_depthWriteTransparent&&(t.depthWrite=e)},!1,!0))},s.prototype.isDepthWriteTransparentEnabled=function(){return this._depthWriteTransparent},s.prototype.hasTwoSidedMaterials=function(){return this._needsTwoSided},s.prototype.hasTransparentMaterial=function(){return this._hasTransparentMaterial},s.prototype.texturesLoaded=function(){return 0===this._texturesToUpdate.length},s.prototype.renderer=function(){return this._renderer},s.prototype.setTonemapExposureBias=function(e){this._exposureBias=e;var t=Math.pow(2,e);this.forEach(function(e){e.exposureBias=t,e.needsUpdate=!0},!0,!0)},s.prototype.setTonemapMethod=function(e){this._tonemapMethod=e,this.forEach(function(t){t.tonemapOutput=e,t.needsUpdate=!0},!0,!0)},s.prototype.setEnvExposure=function(e){var t=Math.pow(2,e);this._envMapExposure=t,this.forEach(function(e){e.envMapExposure=t,e.needsUpdate=!0},!0,!0)},s.prototype.setEnvRotation=function(e){var t=this._envRotationSin=Math.sin(e),r=this._envRotationCos=Math.cos(e);this.forEach(function(e){e.envRotationSin=t,e.envRotationCos=r,e.needsUpdate=!0},!0,!0)},s.prototype.setReflectionMap=function(e){this._reflectionMap=e,this.forEach(function(t){t.disableEnvMap||(t.envMap=e,t.needsUpdate=!0)},!0,!0)},s.prototype.setIrradianceMap=function(e){this._irradianceMap=e,this.forEach(function(t){t.irradianceMap=e,t.needsUpdate=!0},!0,!0)},s.prototype.setDoubleSided=function(e,t){var r=function(e,t){var r=t.indexOf(e);if(-1!==r)return{hash:e,idx:r};var n=e+"|"+y.INSTANCED,i=t.indexOf(n);if(-1!==i)return{hash:n,idx:i};var o=e+"|"+y.VERTEX_IDS,s=t.indexOf(o);return-1!==s?{hash:o,idx:s}:void 0},n={};if(t&&t.isOTG())for(var i=t.getData(),o=i.fragments.materials,s=Object.keys(this._materials),a=0;a<o.length;a++){var l=o[a],c=i.getMaterialHash(l),u=r(c,s);u&&(n[u.hash]=this._materials[u.hash],s.splice(u.idx,1))}else n=t?this.getModelMaterials(t).mats:this._materials;this.forEach(function(t){t.side=e?h.DoubleSide:h.FrontSide,t.needsUpdate=!0},!0,!0,n)},s.prototype.setCutPlanes=function(e){for(var t=this,r=!1,n=this._cutplanes.length!==(e?e.length||0:0);this._cutplanes.length>0;)this._cutplanes.pop();if(e)for(var i=0;i<e.length;i++)this._cutplanes.push(e[i].clone());if(n){this.forEach(function(e){t._applyCutPlanes(e),r=r||e.side==h.DoubleSide},!1,!0);for(var o in this._materialsNonHDR)this._materialsNonHDR[o].doNotCut||(this._materialsNonHDR[o].needsUpdate=!0)}return r||this._needsTwoSided},s.prototype.getCutPlanes=function(){return this._cutplanes.slice()},s.prototype.getCutPlanesRaw=function(){return this._cutplanes},s.prototype._applyPolygonOffset=function(e){(e instanceof h.MeshPhongMaterial||e.isPrismMaterial)&&(e.polygonOffset=this._polygonOffsetOn,e.polygonOffsetFactor=this._polygonOffsetFactor,e.polygonOffsetUnits=this._polygonOffsetUnits,e.extraDepthOffset&&(e.polygonOffsetFactor+=e.extraDepthOffset),e.needsUpdate=!0)},s.prototype.getPolygonOffsetOn=function(){return this._polygonOffsetOn},s.prototype.getPolygonOffsetFactor=function(){return this._polygonOffsetFactor},s.prototype.getPolygonOffsetUnits=function(){return this._polygonOffsetUnits},s.prototype.togglePolygonOffset=function(e,t,r){this._polygonOffsetOn=e,this._polygonOffsetFactor=e?t||1:0,this._polygonOffsetUnits=e?r||.1:0;var n=this;this.forEach(function(e){n._applyPolygonOffset(e)},!1,!0)},s.prototype._applyMRTFlags=function(e){var t=e.supportsMrtNormals||e instanceof h.MeshPhongMaterial||e.isPrismMaterial||e instanceof h.MeshBasicMaterial||e instanceof h.LineBasicMaterial,r=e.mrtNormals,n=e.mrtIdBuffer,i=this._renderer&&this._renderer.supportsMRT();e.mrtNormals=t&&i&&this._mrtNormals,e.mrtIdBuffer=i?this._mrtIdBuffer:void 0,(e.mrtNormals!==r||e.mrtIdBuffer!==n)&&(e.needsUpdate=!0)},s.prototype.toggleMRTSetting=function(e){function t(e){r._applyMRTFlags(e)}this._mrtNormals=e.mrtNormals,this._mrtIdBuffer=e.mrtIdBuffer;var r=this;this.forEach(t),this.forEach(t,!1,!0,this._materialsNonHDR)},s.prototype.initLineStyleTexture=function(){this._lineStyleTex=Object(l.createLinePatternTexture)()},s.prototype.setLineStyleTexture=function(e){this._lineStyleTex=e},s.prototype.initLayersTexture=function(e,t,r){for(var n=256,i=256,o=this._layerMaskTextures[r],s=o?o.image.data:new Uint8Array(n*i),a=0,l=e;l>a;a++)s[a]=255;o=o||new h.DataTexture(s,n,i,h.LuminanceFormat,h.UnsignedByteType,h.UVMapping,h.ClampToEdgeWrapping,h.ClampToEdgeWrapping,h.NearestFilter,h.NearestFilter,0),o.generateMipmaps=!1,o.flipY=!1,o.needsUpdate=!0,this._layerMaskTextures[r]=o,this._layerMaps[r]=t},s.prototype.setLayerVisible=function(e,t,r){for(var n=this._layerMaskTextures[r],i=n.image.data,o=this._layerMaps[r],s=t?255:0,a=0;a<e.length;++a){var l=e[a];i[o[l]]=s}n.needsUpdate=!0,this.forEach(function(e){e.is2d&&(e.needsUpdate=!0)})},s.prototype.initSelectionTexture=function(e,t){for(var r=e||1,n=4096,i=0|Math.ceil(r/n),o=1;i>o;)o*=2;i=o;for(var s=new Uint8Array(n*i),a=0;r>a;a++)s[a]=0;var l=new h.DataTexture(s,n,i,h.LuminanceFormat,h.UnsignedByteType,h.UVMapping,h.ClampToEdgeWrapping,h.ClampToEdgeWrapping,h.NearestFilter,h.NearestFilter,0);return l.generateMipmaps=!1,l.flipY=!1,l.needsUpdate=!0,this._selectionTextures[t]=l,l},s.prototype.highlightObject2D=function(e,t,r){var n=this._selectionTextures[r];if(n){var i=n.image.data;i[e]=t?255:0,n.needsUpdate=!0}},s.prototype._updatePixelScaleForMaterial=function(e){e.is2d&&(e.isScreenSpace?(e.uniforms.size.value.set(this._deviceWidth,this._deviceHeight),e.uniforms.aaRange.value=.5):e.uniforms.aaRange.value=.5/(this._pixelsPerUnit*e.modelScale),e.uniforms.pixelsPerUnit.value=this._pixelsPerUnit*e.modelScale)},s.prototype.updatePixelScale=function(e,t,r){var n=this;this._pixelsPerUnit=e,this._deviceWidth=t,this._deviceHeight=r,this.forEach(function(e){return n._updatePixelScaleForMaterial(e)})},s.prototype.updateSwapBlackAndWhite=function(e){var t=this._swapBlackAndWhite=e?1:0;this.forEach(function(e){e.is2d&&(e.uniforms.swap.value=t)})},s.prototype.setGrayscale=function(e){var t=this._grayscaleLines=e?1:0;this.forEach(function(e){e.is2d&&(e.uniforms.grayscale.value=t)})},s.prototype.updateViewportId=function(e){this.forEach(function(t){t.is2d&&(t.uniforms.viewportId.value=e,t.needsUpdate=!0)})},s.prototype.create2DMaterial=function(e,t,r,n,i){var o=e?e.getData():null,s="__lineMaterial__";t.image&&(s+="|image:"+t.image.name),t.clip&&(s+="|clip:"+JSON.stringify(t.clip)),r&&(s+="|id"),n&&(s+="|selection"),t.skipEllipticals&&(s+="|skipEllipticals"),t.skipCircles&&(s+="|skipCircles"),t.skipTriangleGeoms&&(s+="|skipTriangleGeoms"),t.useInstancing&&(s+="|useInstancing"),t.isScreenSpace&&(s+="|isScreenSpace"),t.unpackPositions&&(s+="|unpackPositions"),t.hasLineStyles&&(s+="|hasLineStyles"),t.compositeOperation&&(s+="|"+t.compositeOperation);var a=this._getMaterialHash(e,s);if(!this._materials.hasOwnProperty(a)){var l;if(t.isScreenSpace?(l=Object(f.createShaderMaterial)(m.LineShaderSS),l.isScreenSpace=!0):l=Object(f.createShaderMaterial)(p.LineShader),t.hasLineStyles&&(l.hasLineStyles=!0),l.is2d=!0,l.transparent=!0,l.depthWrite=!1,l.depthTest=!1,l.side=h.DoubleSide,l.blending=h.NormalBlending,"multiply"==t.compositeOperation?l.blending=h.MultiplyBlending:"min"==t.compositeOperation&&(l.blending=h.CustomBlending,l.blendEquation=h.MinEquation),r?(l.defines.ID_COLOR=1,l.blending=h.NoBlending):n?(l.uniforms.tSelectionTexture.value=n,l.uniforms.vSelTexSize.value.set(n.image.width,n.image.height),l.defines.SELECTION_RENDERER=1,this.get2dSelectionColor(l.uniforms.selectionColor)):(this.get2dSelectionColor(l.uniforms.selectionColor),this.renderer()&&this.renderer().supportsMRT()&&(l.mrtIdBuffer=this._mrtIdBuffer)),t.skipEllipticals||(l.defines.HAS_ELLIPTICALS=1),t.skipCircles||(l.defines.HAS_CIRCLES=1),t.skipTriangleGeoms||(l.defines.HAS_TRIANGLE_GEOMS=1),t.useInstancing&&(l.defines.USE_INSTANCING=1),t.unpackPositions&&!r&&(l.defines.UNPACK_POSITIONS=1),t.msdfFontTexture&&(l.defines.MSDF_TEXTURE_FONT=1),t.imageUVTexture&&(l.defines.IMAGE_UV_TEXTURE=1),t.viewportBounds&&(l.uniforms.viewportBounds.value=t.viewportBounds,l.defines.VIEWPORT_CLIPPING=1),"number"==typeof t.opacity&&(l.uniforms.opacity.value=t.opacity),t.image){var c=function(r,n){return r?(r.wrapS=h.ClampToEdgeWrapping,r.wrapT=h.ClampToEdgeWrapping,r.minFilter=n?h.LinearFilter:h.LinearMipMapLinearFilter,r.magFilter=h.LinearFilter,r.anisotropy=1,r.flipY=!0,r.generateMipmaps=!0,r.needsUpdate=!0,t.msdfFontTexture||t.imageUVTexture||(l.defines.HAS_RASTER_QUADS=1),l.uniforms.tRaster.value=r,l.needsUpdate=!0,void(i&&i(r,e))):void(i&&i(r,e,t))};if("undefined"!=typeof HTMLCanvasElement&&t.image instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&t.image instanceof HTMLImageElement){var u=new h.Texture(d.TextureLoader.imageToCanvas(t.image,"multiply"==t.compositeOperation,t.compositeCanvasColor),h.UVMapping);c(u,!0)}else d.TextureLoader.loadTextureWithSecurity(t.image.dataURI,h.UVMapping,c,null,o.acmSessionId)}l.modelScale=t.modelScale||1,t.doNotCut&&(l.doNotCut=!0),l.textureMaps={},this.addLineMaterial(a,l,e&&e.id),(r||n)&&this.addCompactLayoutSupport(l)}return s},s.prototype.set2dSelectionColor=function(e,t){g=new h.Color(e),v=void 0===t||null===t?v:t,this.forEach(function(e){if(e.is2d&&e.uniforms){var t=e.uniforms.selectionColor;t&&(o(t.value,g,v),e.needsUpdate=!0)}})},s.prototype.get2dSelectionColor=function(e){return e&&o(e.value,g,v),g},s.prototype.get2dSelectionOpacity=function(){return v}},"./src/wgs/render/NormalsShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"NormalsShader",function(){return a});var n=r("./src/wgs/render/shaders/normals_vert.glsl"),i=r.n(n),o=r("./src/wgs/render/shaders/normals_frag.glsl"),s=r.n(o),a={uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:i.a,fragmentShader:s.a}},"./src/wgs/render/PhongShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"PhongShader",function(){return c});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/ShaderChunks.js")),o=r("./src/wgs/render/shaders/phong_vert.glsl"),s=r.n(o),a=r("./src/wgs/render/shaders/phong_frag.glsl"),l=r.n(a),c={uniforms:n.UniformsUtils.merge([n.UniformsLib.common,n.UniformsLib.bump,n.UniformsLib.normalmap,n.UniformsLib.lights,n.UniformsLib.fog,i.ShaderChunks.CutPlanesUniforms,i.ShaderChunks.IdUniforms,i.ShaderChunks.ThemingUniform,i.ShaderChunks.ShadowMapUniforms,i.ShaderChunks.WideLinesUniforms,{emissive:{type:"c",value:new n.Color(0)},specular:{type:"c",value:new n.Color(1118481)},shininess:{type:"f",value:30},reflMipIndex:{type:"f",value:0},texMatrix:{type:"m3",value:new n.Matrix3},texMatrixBump:{type:"m3",value:new n.Matrix3},texMatrixAlpha:{type:"m3",value:new n.Matrix3},irradianceMap:{type:"t",value:null},exposureBias:{type:"f",value:1},envMapExposure:{type:"f",value:1},envRotationSin:{type:"f",value:0},envRotationCos:{type:"f",value:1}}]),vertexShader:s.a,fragmentShader:l.a};n.ShaderLib.firefly_phong=c},"./src/wgs/render/PrismUtil.js":function(e,t,r){"use strict";function n(e){var t=e+"_texMatrix",r=e+"_invert",n={};return n[e]={type:"t",value:null},n[t]={type:"m3",value:new o.Matrix3},n[r]={type:"i",value:0},n}function i(e){var t=e+"_texMatrix",r=e+"_bumpScale",n=e+"_bumpmapType",i={};return i[e]={type:"t",value:null},i[t]={type:"m3",value:new o.Matrix3},i[r]={type:"v2",value:new o.Vector2(1,1)},i[n]={type:"i",value:0},i}r.r(t),r.d(t,"GetPrismMapUniforms",function(){return n}),r.d(t,"GetPrismBumpMapUniforms",function(){return i});var o=r("./thirdparty/three.js/three.js");r.n(o)},"./src/wgs/render/RenderContext.js":function(e,t,r){"use strict";function n(){function e(e,t,r,n,i){var o=new a.WebGLRenderTarget(e,t,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:r,type:n,stencilBuffer:!1});return i&&(o.shareDepthFrom=i),o.name="depthTarget",o}function t(t){try{var r=e(2,2,t.format,t.type);r.generateMipmaps=!1,k.setRenderTarget(r);var n=k.context,i=n.checkFramebufferStatus(n.FRAMEBUFFER);return k.setRenderTarget(null),r.dispose(),i===n.FRAMEBUFFER_COMPLETE}catch(o){return!1}}function r(){var e=Le?[{format:a.RGBAFormat,type:a.HalfFloatType},{format:a.RGBAFormat,type:a.FloatType}]:[{format:a.RGBAFormat,type:a.FloatType},{format:a.RGBAFormat,type:a.HalfFloatType}],r=e.find(t);r?(Fe=!0,ke=r.format,Ne=r.type):(Fe=!1,i.logger.warn("Depth target is unsupported for this device."))}function n(e){We.useIdBufferSelection=e,e?K.material.defines.USE_IDBUFFER_SELECTION="1":delete K.material.defines.USE_IDBUFFER_SELECTION}function w(e,t){e.depthWrite=t;for(var r=0;r<e.variants.length;r++){var n=e.variants[r];n&&(n.depthWrite=t)}}function E(){var e=c.NormalsShader;N=Object(l.createShaderMaterial)(e),N.blending=a.NoBlending,N.packedNormals=!0,N.depthWrite=!1;var t={NoCutPlanes:1,Instancing:2,UnpackedNormals:4,Count:8},r=[];r[0]=null;for(var n=1;n<t.Count;n++){var i=N.clone();i.packedNormals=N.packedNormals,n&t.NoCutPlanes&&(i.cutPlanes=null,i.doNotCut=!0),n&t.Instancing&&(i.useInstancing=!0),n&t.UnpackedNormals&&(i.packedNormals=!1),r[n]=i}N.variants=r,N.getCustomOverrideMaterial=function(e){var r=!e||!e.cutplanes||0==e.cutplanes.length,n=e.useInstancing,i=!e.packedNormals,o=(r?t.NoCutPlanes:0)|(n?t.Instancing:0)|(i?t.UnpackedNormals:0);return this.variants[o]}}function S(){var e=d.EdgeShader;F=Object(l.createShaderMaterial)(e),F.depthWrite=!0,F.depthTest=!0,F.isEdgeMaterial=!0,F.transparent=!0,F.blending=a.NormalBlending,F.supportsMrtNormals=!0;var t={Instancing:1,DoNotCut:2,Count:4},r=[];r[0]=null;for(var n=1;n<t.Count;n++){var i=F.clone();i.defines=Object(s.ObjectAssign)({},F.defines),i.isEdgeMaterial=!0,i.supportsMrtNormals=!0,n&t.Instancing&&(i.useInstancing=!0),n&t.DoNotCut&&(i.doNotCut=!0,i.cutplanes=[]),r[n]=i}F.variants=r,F.getCustomOverrideMaterial=function(e){var r=e.useInstancing,n=r?t.Instancing:0;e.doNotCut&&(n|=t.DoNotCut);var i=this.variants[n]||F;return Ie?De?i.uniforms.color.value.copy(Ce):i.uniforms.color.value.copy(Te):i.uniforms.color.value.copy(Me),void 0!==e.edgeOpacity&&(i.uniforms.color.value.w=e.edgeOpacity),i.uniforms.color.needsUpdate=!0,i}}function A(e){e(N);for(var t=1;t<N.variants.length;t++)e(N.variants[t])}function M(e){e.material.blending=a.NoBlending,e.material.depthWrite=!1,e.material.depthTest=!1}function T(){E(),S(),W=new u.ShaderPass(h.SAOShader),M(W),H=new u.ShaderPass(f.SAOBlurShader),M(H),X=new u.ShaderPass(p.SAOMinifyFirstShader),M(X),q=new u.ShaderPass(p.SAOMinifyShader),M(q),Y=new u.ShaderPass(m.FXAAShader),M(Y),K=new u.ShaderPass(g.BlendShader),M(K),G=new u.ShaderPass(v.BackgroundShader),M(G),Q=new u.ShaderPass(y.CopyShader),M(Q)}function C(e){switch(e){case x.Color:return!0;case x.Depth:return Fe&&(We.sao||We.postProcShaded);case x.ModelId:return We.idbuffer;case x.Overlay:return!0;case x.SSAO:return We.sao;case x.Post1:return We.antialias||We.sao||We.customPresentPass||We.postProcShaded;case x.Post2:return We.postProcShaded||We.customPresentPass;case x.PostDisplay:return We.antialias&&We.postProcShaded}}function j(e,t){var r=new a.WebGLRenderTarget(e,t,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,type:a.UnsignedByteType,stencilBuffer:!1});return r.generateMipmaps=!1,r.shareDepthFrom=le,r.canReadPixels=!0,r}function P(e,t){var r=3*e[1],n=3*(e[3]-e[1])-r,i=1-r-n;return((i*t+n)*t+r)*t}function L(){var e=[K.uniforms.useOverlay.value,K.uniforms.objIDv4.value];return K.uniforms.useOverlay.value=0,K.uniforms.objIDv4.value=new a.Vector4,e}function D(e){K.uniforms.useOverlay.value=e[0],K.uniforms.objIDv4.value=e[1]}function I(){var e=K.uniforms.useAO.value;return K.uniforms.useAO.value=0,e}function R(e){K.uniforms.useAO.value=e}function O(){var e=ue,t=le;if(K.uniforms.useAO.value){var r=L();K.render(k,e,t),t=e,e=fe,D(r)}if(J.render(k,e,t),t=e,e=e===ue?fe:ue,K.uniforms.useOverlay.value||K.uniforms.objIDv4.value){var r=I();K.render(k,e,t),t=e,R(r)}return t}var k,N,F,V,U,B,z,G,H,W,q,X,Y,K,Q,Z=!1,J=new _.RenderContextPostProcessManager;this.postShadingManager=function(){return J};var $,ee,te,re,ne,ie,oe,se=!1,ae=null,le=null,ce=null,ue=null,de=null,he=null,fe=null,pe=[],me=0,ge=0,ve=0,ye=0,_e=1,be=!1,xe=!1,we=new Uint8Array(4),Ee=[0,0],Se=(new a.Color).setRGB(1,1,1),Ae=(new a.Color).setRGB(0,0,0),Me=new a.Vector4(0,0,0,.3),Te=new a.Vector4(1,1,1,1),Ce=new a.Vector4(1,1,1,.5),je=null,Pe=1,Le=!1,De=!1,Ie=!1,Re=!1,Oe=!1,ke=a.RGBAFormat,Ne=a.FloatType,Fe=!1,Ve=0,Ue=0,Be=0,ze=[.42,0,1,1],Ge=.004,He=!0,We={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,idbuffer:!0,customPresentPass:!1,postProcShaded:!1,envMapBg:!1,numIdTargets:1,renderEdges:!1,useIdBufferSelection:!1},qe={},Xe=null,Ye=null;this.settings=We,this.depthTargetSupported=function(){return Fe},this.isRolloverHighlightEnabled=function(){return _enableRolloverHighlight},this.isWeakDevice=function(){return Le},this.init=function(e,t,a,l){var c=l&&l.offscreen,u=l&&void 0!==l.useIdBufferSelection?l.useIdBufferSelection:!1;return T(),e?(Le=Object(s.isMobileDevice)(),We.idbuffer=!Le,u&&(We.idbuffer=!0,We.numIdTargets=2,K.material.defines.USE_MODEL_ID="1",n(!0)),ie=t,oe=a,k=e,xe=!!c,void r()):void(Object(s.isNodeJS)()||i.logger.error("You need a gl context to make a renderer. Things will go downhill from here.",Object(o.errorCodeString)(o.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED)))},this.setDepthMaterialOffset=function(e,t,r){var n=function(n){n.polygonOffset=e,n.polygonOffsetFactor=t,n.polygonOffsetUnits=r,n.extraDepthOffset&&(n.polygonOffsetFactor+=n.extraDepthOffset),n.needsUpdate=!0};A(n)},this.setNoDepthNoBlend=M,this.overlayUpdate=function(){if(0===Ue||-1===Ue)return!1;var e=K.uniforms.highlightIntensity.value,t=1;if(He){var r=(performance.now()-Ve)*Ge;r=Math.min(r,1),t=P(ze,r)}return e!=t?(K.uniforms.highlightIntensity.value=t,!0):!1},this.setRollOverFadeEnabled=function(e){He=e},this.beginScene=function(e,t,r,n){if(U=t,z=e.fog,B=r,Z=!1,se=!1,!le&&ie)this.initPostPipeline(We.sao,We.antialias);else if(!le&&!ie)return void(be||Object(s.isNodeJS)()||(i.logger.error("Rendering to a canvas that was resized to zero. If you see this message you may be accidentally leaking a viewer instance.",Object(o.errorCodeString)(o.ErrorCodes.VIEWER_INTERNAL_ERROR)),be=!0));if(n){var l=We.envMapBg&&!!G.material.envMap;je&&!l?(k.setClearColor(je,Pe),k.clearTarget(le,!0,!0,!1)):(G.uniforms.uCamDir.value=U.worldUpTransform?U.getWorldDirection().clone().applyMatrix4(U.worldUpTransform):U.getWorldDirection(),G.uniforms.uCamUp.value=U.worldUpTransform?U.up.clone().applyMatrix4(U.worldUpTransform):U.up,G.uniforms.uResolution.value.set(ie,oe),G.uniforms.uHalfFovTan.value=Math.tan(a.Math.degToRad(.5*U.fov)),G.uniforms.opacity.value=Pe,k.clearTarget(le,!1,!0,!1),G.render(k,le,null)),Xe&&Xe.clearTarget(k);for(var c=0;c<pe.length;c++)k.setClearColor(Se,1),k.clearTarget(pe[c],!0,!1,!1)}if(C(x.Depth)){n&&(k.setClearColor(Ae,0),k.clearTarget(ne,!0,!1,!1));var u=t.near,d=t.far;W.uniforms.cameraNear.value=u,W.uniforms.cameraFar.value=d,J.updateUniformValue("cameraNear",u),J.updateUniformValue("cameraFar",d),X.uniforms.cameraNear.value=u,X.uniforms.cameraInvNearFar.value=1/(u-d);var h=t.projectionMatrix.elements;t.isPerspective?W.uniforms.projInfo.value.set(-2/(le.width*h[0]),-2/(le.height*h[5]),(1-h[8])/h[0],(1+h[9])/h[5]):W.uniforms.projInfo.value.set(-2/(le.width*h[0]),-2/(le.height*h[5]),(1-h[12])/h[0],(1-h[13])/h[5]),J.updateUniformValue("projInfo",W.uniforms.projInfo.value,!0),K.uniforms.projInfo.value.copy(W.uniforms.projInfo.value);var f=t.isPerspective?0:1;W.uniforms.isOrtho.value=f,J.updateUniformValue("isOrtho",f),K.uniforms.isOrtho.value=f;var p=.25;W.uniforms.projScale.value=.5*p*(le.height*h[5]),K.uniforms.worldMatrix_mainPass.value=t.matrixWorld}We.sao||(K.uniforms.useAO.value=0),this.renderScenePart(e,!0,!0,!0,!0)},this.renderScenePart=function(e,t,r,n,i){"undefined"!=typeof e.skipColorTarget&&(t=!e.skipColorTarget),"undefined"!=typeof e.skipDepthTarget&&(r=!e.skipDepthTarget),"undefined"!=typeof e.skipIdTarget&&(n=!e.skipIdTarget),t&&We.renderEdges&&(e.edgeMaterial=F);var o=r&&C(x.Depth),s=le,a=ne,l=!1;Xe&&(s=Xe.chooseColorTarget(e,s),a=Xe.getRenderSao(e)?ne:null,l=a&&ne.shareDepthFrom!==s),Z=!1,se=!1;var c=i?B:void 0;e.fog=z;var u,d;Re&&Oe?(u=C(x.ModelId)&&n&&o?[s,a].concat(pe):o?[s,a]:C(x.ModelId)&&n?[s].concat(pe):s,k.render(e,U,u,!1,c)):Oe?(u=C(x.ModelId)&&n?[s].concat(pe):s,k.render(e,U,u,!1,c),o&&!e.sortObjects&&a&&(d=e.overrideMaterial,e.overrideMaterial=N,N.depthWrite!==l&&w(N,l),k.render(e,U,a,!1),e.overrideMaterial=d)):(t?(u=s,k.render(e,U,s,!1,c)):l=!0,C(x.ModelId)&&n&&(V?(d=e.overrideMaterial,e.overrideMaterial=V,k.render(e,U,pe[0],!1),e.overrideMaterial=d):(k.setProgramPrefix(1,"#define ID_COLOR","#define ID_COLOR"),k.render(e,U,pe[0],!1),k.setProgramPrefix(0,"","")),l=!1),o&&!e.sortObjects&&a&&(d=e.overrideMaterial,N.depthWrite!==l&&w(N,l),e.overrideMaterial=N,k.render(e,U,a,!1),e.overrideMaterial=d)),e.edgeMaterial=void 0},this.clearAllOverlays=function(){k.clearTarget(ce,!0,!1,!1)},this.renderOverlays=function(e,t,r){var n=0;Ie=!0;for(var i in e){var o=e[i],s=o.scene,a=o.camera?o.camera:U;s.children.length&&(n||(n=1,r||(k.setClearColor(Ae,0),k.clearTarget(ce,!0,!1,!1))),o.materialPre&&(s.overrideMaterial=o.materialPre),k.render(s,a,ce,!1,t),o.materialPost&&(De=!0,k.context.depthFunc(k.context.GREATER),We.renderEdges&&(F.depthWrite=!1,F.depthTest=!1,s.overrideMaterial=F,k.render(s,a,ce,!1)),s.overrideMaterial=o.materialPost,k.render(s,a,ce,!1,t),k.context.depthFunc(k.context.LEQUAL),De=!1),We.renderEdges&&o.materialPre&&(F.depthWrite=!1,F.depthTest=!0,s.overrideMaterial=F,k.render(s,a,ce,!1)),s.overrideMaterial=null)}Ie=!1,F.depthWrite=!0,F.depthTest=!0,K.uniforms.useOverlay.value=n},this.computeSSAO=function(e){if(!e&&We.sao){if(!Z){if(ae&&ae.length){var t=ae[0];X.uniforms.resolution.value.set(1/t.width,1/t.height),X.render(k,t,ne);for(var r=1;r<ae.length;r++){var n=ae[r];q.uniforms.resolution.value.set(1/n.width,1/n.height),q.render(k,n,t),t=n}}W.render(k,he,le),H.uniforms.axis.value.set(1,0),H.render(k,ue,he),H.uniforms.axis.value.set(0,1),H.render(k,he,ue),Z=!0}K.uniforms.useAO.value=1}else K.uniforms.useAO.value=0},this.getFinalTarget=function(){return Ye||null},this.presentBuffer=function(e){if(k){var t=this.getFinalTarget(),r=!(K.uniforms.useAO.value||K.uniforms.useOverlay.value||Xe||0!==Ue&&-1!==Ue||0!==Be&&-1!==Be);if(r)We.antialias?e?(Y.render(k,ue,le),e.render(k,t,ue)):We.postProcShaded?(J.render(k,ue,le),Q.render(k,de,ue),Y.render(k,t,de)):Y.render(k,t,le):e?e.render(k,t,le):We.postProcShaded?(J.render(k,ue,le),Q.render(k,t,ue)):Q.render(k,t,le);else if(We.antialias)if(e)K.render(k,ue,le),Y.render(k,fe,ue),e.render(k,t,fe);else if(We.postProcShaded){var n=O();Q.render(k,de,n),Y.render(k,t,de)}else K.render(k,ue,le),Y.render(k,t,ue);else if(e)K.render(k,ue,le),e.render(k,t,ue);else if(We.postProcShaded){var n=O();Q.render(k,t,n)}else K.render(k,t,le)}},this.composeFinalFrame=function(e,t){this.computeSSAO(e),t||this.presentBuffer()},this.cleanup=function(){if(k&&k.setRenderTarget(null),le&&(le.dispose(),le=null),ne&&(ne.dispose(),ne=null),ce&&(ce.dispose(),ce=null),Xe&&Xe.disposeTargets(),ue&&(ue.dispose(),ue=null),he&&(he.dispose(),he=null),fe&&(fe.dispose(),fe=null),ae){for(var e=0;e<ae.length;e++)ae[e].dispose();ae=[]}},this.setSize=function(t,r,n,o){if(ie=t,oe=r,We.logicalWidth=t,We.logicalHeight=r,0===t&&0===r||!k)return void this.cleanup();var s=0|t*k.getPixelRatio(),l=0|r*k.getPixelRatio();We.deviceWidth=s,We.deviceHeight=l,o||(xe?k.setViewport(0,0,t,r):k.setSize(t,r));var c,u=s,d=l;(We.useSSAA||We.postProcShaded&&!Le&&k.getPixelRatio()<=1&&J.postProcessEdgesOn())&&(s*=2,l*=2);var h=1/s,f=1/l;if((n||!le||le.width!=s||le.height!=l)&&(i.logger.log("Reallocating render targets."),this.cleanup(),le=new a.WebGLRenderTarget(s,l,{minFilter:a.LinearFilter,magFilter:a.LinearFilter,format:a.RGBAFormat,type:We.useHdrTarget?a.FloatType:a.UnsignedByteType,stencilBuffer:!1}),le.generateMipmaps=!1,le.name="colorTarget",ce=new a.WebGLRenderTarget(s,l,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,stencilBuffer:!1}),ce.generateMipmaps=!1,ce.name="overlayTarget",ce.shareDepthFrom=le,ne=null,ue=null,de=null,he=null,fe=null,ae=[]),Xe&&Xe.updateTargets(s,l,n,We.useHdrTarget),C(x.Post1)&&(n||!ue||ue.width!=s||ue.height!=l)&&(ue=new a.WebGLRenderTarget(s,l,{minFilter:a.LinearFilter,magFilter:a.LinearFilter,format:a.RGBAFormat,stencilBuffer:!1,depthBuffer:!1}),ue.generateMipmaps=!1,ue.name="postTarget1"),!he&&C(x.SSAO)&&(he=ue.clone(),he.name="SSAO target"),!fe&&C(x.Post2)&&(fe=ue.clone(),fe.name="post target 2"),!de&&C(x.PostDisplay)&&(de=new a.WebGLRenderTarget(u,d,{minFilter:a.LinearFilter,magFilter:a.LinearFilter,format:a.RGBAFormat,stencilBuffer:!1,depthBuffer:!1}),de.generateMipmaps=!1,de.name="postTargetNormal"),C(x.Depth)){if(n||!ne||ne.width!=s||ne.height!=l){ne=e(s,l,ke,Ne,le),ae=[];for(var p=0;5>p;p++){var m=0|s/(2<<p),g=0|l/(2<<p),v=m>=1&&g>=1,y=null;v&&(y=new a.WebGLRenderTarget(m,g,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,depthBuffer:!1,stencilBuffer:!1}),y.generateMipmaps=!1,ae.push(y)),W.uniforms["tDepth_mip"+(p+1)].value=y}Re=k.verifyMRTWorks([le,ne])}W.uniforms.size.value.set(s,l),W.uniforms.resolution.value.set(h,f),W.uniforms.tDepth.value=ne,H.uniforms.size.value.set(s,l),H.uniforms.resolution.value.set(h,f),J.updateUniformValue("tDepth",ne),K.uniforms.tDepth.value=ne}if(C(x.ModelId)){if(n||!pe[0]||pe[0].width!=s||pe[0].height!=l){for(c=0;c<pe.length;c++)pe[c]&&pe[c].dispose();for(pe=[],c=0;c<We.numIdTargets;c++){var _=j(s,l);_.name="id "+c,pe.push(_)}Oe=k.verifyMRTWorks([le].concat(pe)),Oe||i.logger.warn("ID buffer requested, but MRT is not supported. Some features will not work.")}J.updateUniformValue("tID",pe[0])}else if(pe[0]){for(c=0;c<pe.length;c++)pe[c].dispose(),pe[c]=null;pe.length=0}Y.uniforms.uResolution.value.set(h,f),J.changeResolution(h,f),K.uniforms.tOverlay.value=ce,K.uniforms.tAO.value=he,K.uniforms.useAO.value=We.sao?1:0,K.uniforms.resolution.value.set(h,f),K.uniforms.tID.value=pe[0]||null,K.uniforms.tID2.value=pe[1]||null,Xe&&Xe.updateBlendPass()},this.getMaxAnisotropy=function(){return k?k.getMaxAnisotropy():0},this.mrtFlags=function(){return{mrtNormals:Re&&C(x.Depth),mrtIdBuffer:Oe&&C(x.ModelId)?We.numIdTargets:void 0}},this.setIdTargetCount=function(e){if(!(e>2||1>e)&&e!==We.numIdTargets&&(We.numIdTargets=e,0!==pe.length&&2===e&&1===pe.length)){var t=pe[0].width,r=pe[0].height,n=j(t,r);return n.name="id "+pe.length,pe.push(n),K.uniforms.tID2.value=n,K.material.defines.USE_MODEL_ID="1",K.material.needsUpdate=!0,!0}},this.getAntialiasing=function(){return We.antialias},this.initPostPipeline=function(e,t){We.sao=e&&!s.isIE11&&Fe,We.antialias=t&&!s.isIE11,We.haveTwoSided&&A(function(e){e.side=a.DoubleSide}),A(function(e){e.needsUpdate=!0}),W.material.needsUpdate=!0,H.material.needsUpdate=!0,X.material.needsUpdate=!0,q.material.needsUpdate=!0,Y.material.needsUpdate=!0,J.setMaterialNeedsUpdate(),K.material.needsUpdate=!0,G.material.needsUpdate=!0,Q.material.needsUpdate=!0,this.setSize(ie,oe)},this.setClearColors=function(e,t){je=t?e.equals(t)||Le?new a.Color(.5*(e.x+t.x),.5*(e.y+t.y),.5*(e.z+t.z)):void 0:e.clone(),je||(G.uniforms.color1.value.copy(e),G.uniforms.color2.value.copy(t))},this.setClearAlpha=function(e){Pe=e},this.setAOEnabled=function(e){We.sao=e&&Fe,qe.sao=We.sao,this.setSize(ie,oe,!1,!0)},this.setAOOptions=function(e,t,r){void 0!==e&&(W.uniforms.radius.value=e,W.uniforms.bias.value=Object(s.isMobileDevice)()?.1:.01,H.uniforms.radius.value=e),void 0!==t&&(W.uniforms.intensity.value=t),void 0!==r?K.uniforms.aoOpacity.value=r:K.uniforms.aoOpacity.value=1,Z=!1},this.getAOEnabled=function(){return We.sao},this.getAORadius=function(){return W.uniforms.radius.value},this.getAOIntensity=function(){return W.uniforms.intensity.value},this.setCubeMap=function(e){G.material.envMap=e,e||this.toggleEnvMapBackground(!1),e&&We.envMapBg&&(G.uniforms.envMapBackground.value=!0)},this.getCubeMap=function(){return G.material.envMap},this.setEnvRotation=function(e){ve=e,G.material.envRotationSin=Math.sin(e),G.material.envRotationCos=Math.cos(e)},this.getEnvRotation=function(){return ve},this.setEnvExposure=function(e){G.uniforms.envMapExposure.value=Math.pow(2,e),G.material.envMapExposure=Math.pow(2,e),G.material.needsUpdate=!0,me=e},this.setTonemapExposureBias=function(e){ge=e,G.uniforms.exposureBias.value=Math.pow(2,e)},this.getExposureBias=function(){return ge},this.setCamera=function(e){U=e},this.setTonemapMethod=function(e){ye=e,0===e?k.gammaInput=!1:k.gammaInput=!0,G.material.tonemapOutput=ye,G.material.needsUpdate=!0},this.getToneMapMethod=function(){return ye},this.toggleTwoSided=function(e){We.haveTwoSided!=e&&N&&A(function(t){t.side=e?a.DoubleSide:a.FrontSide,t.needsUpdate=!0}),We.haveTwoSided=e},this.toggleEdges=function(e){We.renderEdges=e,qe.renderEdges=e},this.getRenderEdges=function(){return We.renderEdges},this.getRenderEdges=function(){return We.renderEdges},this.toggleEnvMapBackground=function(e){We.envMapBg=e,G.uniforms.envMapBackground.value=e&&!!G.material.envMap},this.enter2DMode=function(e,t){V=e,qe.sao=We.sao,qe.postProcShaded=We.postProcShaded,qe.antialias=We.antialias,qe.idbuffer=We.idbuffer,qe.renderEdges=We.renderEdges,qe.useIdBufferSelection=We.useIdBufferSelection,
t&&(qe.selectionColor=We.selectionColor,this.setSelectionColor(t)),We.idbuffer=!0,We.postProcShaded=!1,We.renderEdges=!1,K.material.defines.IS_2D="",n(We.idbuffer),this.initPostPipeline(!1,!1)},this.exit2DMode=function(){V=null,We.idbuffer=qe.idbuffer,We.postProcShaded=qe.postProcShaded,We.renderEdges=qe.renderEdges,qe.selectionColor&&this.setSelectionColor(qe.selectionColor),delete K.material.defines.IS_2D,n(qe.idbuffer),this.initPostPipeline(qe.sao,qe.antialias)},this.idAtPixel=function(e,t,r){if(!pe[0])return 0;var n=0|.5*(e+1)*pe[0].width,i=0|.5*(t+1)*pe[0].height;if(se&&n===$&&i===ee)return r&&(r[0]=te,r[1]=re),te;k.readRenderTargetPixels(pe[0],n,i,1,1,we);var o=we[2]<<16|we[1]<<8|we[0],s=0;return pe[1]?(k.readRenderTargetPixels(pe[1],n,i,1,1,we),s=we[1]<<8|we[0],s=s<<16>>16,o=o<<8>>8):o=o<<8>>8,$=n,ee=i,te=o,re=s,se=!0,r&&(r[0]=o,r[1]=s),o},this.idAtPixels=function(e,t,r,n){function i(){for(var e,t=0,i=0,o=0,s=-1,c=0;r*r>c;c++){var u=t+(r-1)/2,d=i+(r-1)/2;if(u>=0&&r>=u&&d>=0&&r>=d){var h=u+d*r;if(e=a[4*h+2]<<16|a[4*h+1]<<8|a[4*h],e=e<<8>>8,e>=0){if(l){var f=l[4*h+1]<<8|l[4*h];f=f<<16>>16,n[0]=e,n[1]=f}break}}if(t==i||0>t&&t==-i||t>0&&t==1-i){var p=o;o=-s,s=p}t+=o,i+=s}return e}if(!pe[0])return 0;var o=.5*(e+1)*pe[0].width-.5*(r-1),s=.5*(t+1)*pe[0].height-.5*(r-1),a=new Uint8Array(4*r*r);k.readRenderTargetPixels(pe[0],o,s,r,r,a);var l=void 0;return n&&pe[1]&&(l=new Uint8Array(4*r*r),k.readRenderTargetPixels(pe[1],o,s,r,r,l)),i()},this.readbackTargetId=function(){if(!pe[0])return null;var e=new Uint8Array(4*pe[0].width*pe[0].height);return k.readRenderTargetPixels(pe[0],0,0,pe[0].width,pe[0].height,e),{buffer:e,width:pe[0].width,height:pe[0].height}},this.rolloverObjectViewport=function(e,t){Ee[1]=0;var r=this.idAtPixel(e,t,Ee);return this.rolloverObjectId(r,null,Ee[1])},this.rolloverObjectId=function(e,t,r){return r=r||0,e===Ue&&r===Be?!1:(K.uniforms.highlightIntensity.value=0,Ve=performance.now(),Ue=e,Be=r,-1===e&&(e=0),void 0===r&&(r=1),K.uniforms.objIDv4.value.set((255&e)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255),K.uniforms.modelIDv2.value.set((255&r)/255,(r>>8&255)/255),K.uniforms.highlightFullModel.value=0,!0)},this.getRollOverDbId=function(){return Ue},this.getRollOverModelId=function(){return Be},this.rollOverModelId=function(e){this.rolloverObjectId(1,0,e),K.uniforms.highlightFullModel.value=1},this.setRollOverHighlightColor=function(e){e?K.uniforms.highlightColor.value.copy(e):K.uniforms.highlightColor.value.set(1,1,1),K.material.needsUpdate=!0},this.setDbIdForEdgeDetection=function(e,t){K.uniforms.edgeObjIDv4.value.set((255&e)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255),K.uniforms.edgeModelIDv2.value.set((255&t)/255,(t>>8&255)/255)},this.setSpatialFilterForRollOver=function(e){if(e&&!this.spatialFilterForRollOverSupported())return void i.logger.warn("Spatial filter for mouse-over can only be used with depth target");var t="SPATIAL_FILTER";K.material.defines[t]!==e&&(e&&""!==e?K.material.defines[t]=e:delete K.material.defines[t],K.material.needsUpdate=!0,K.uniforms.highlightIntensity.value=0,Ve=performance.now())},this.spatialFilterForRollOverSupported=function(){return C(x.Depth)},this.setEdgeColor=function(e){Me.copy(e)},this.setSelectionColor=function(e){var t=new a.Color(e);t.r=Math.pow(t.r,2),t.g=Math.pow(t.g,2),t.b=Math.pow(t.b,2),K.uniforms.selectionColor.value.set(t),K.material.needsUpdate=!0,We.selectionColor=e},this.setUnitScale=function(e){_e=e},this.getUnitScale=function(){return _e},this.getBlendPass=function(){return K},this.getClearPass=function(){return G},this.getColorTarget=function(){return le},this.getIDTargets=function(){return pe},this.getDepthTarget=function(){return ne},this.getIdTarget=function(){return pe[0]},this.getDepthMaterial=function(){return N},this.getPostTarget=function(){return ue},this.getEdgeMaterial=function(){return F},this.setCrossFade=function(e){Xe=e},this.getCrossFade=function(){return Xe},this.setOffscreenTarget=function(e){Ye=e},this.getOffscreenTarget=function(){return Ye},this.getNamedTarget=function(e){switch(e){case"color":return le;case"overlay":return ce;case"id":return pe[0];case"post1":return ue;case"post2":return fe;case"postdisplay":return de;case"ssao":return he;case"depth":return ne}return null},this.getCurrentFramebuffer=function(){return k.getCurrentFramebuffer()},this.getConfig=function(){return{renderEdges:We.renderEdges,envMapBackground:We.envMapBg,envMap:G.material.envMap,envExposure:me,toneMapExposureBias:ge,envRotation:this.getEnvRotation(),tonemapMethod:ye,clearColor:je&&je.clone(),clearColorTop:!je&&G.uniforms.color1.value.clone(),clearColorBottom:!je&&G.uniforms.color2.value.clone(),clearAlpha:Pe,aoEnabled:this.getAOEnabled(),aoRadius:this.getAORadius(),aoIntensity:this.getAOIntensity(),twoSided:We.haveTwoSided,edgeColor:Me.clone(),unitScale:this.getUnitScale(),is2D:!!K.material.defines.IS_2D,antialias:this.getAntialiasing(),idMaterial:V,selectionColor:We.selectionColor}},this.applyConfig=function(e){this.toggleEdges(e.renderEdges),this.toggleEnvMapBackground(e.envMapBackground),this.setCubeMap(e.envMap),this.setEnvExposure(e.envExposure),this.setTonemapExposureBias(e.toneMapExposureBias),this.setEnvRotation(e.envRotation),this.setTonemapMethod(e.tonemapMethod),this.toggleTwoSided(e.twoSided),this.setEdgeColor(e.edgeColor),this.setUnitScale(e.unitScale),e.clearColor?this.setClearColors(e.clearColor):this.setClearColors(e.clearColorTop,e.clearColorBottom),this.setClearAlpha(e.clearAlpha);var t=!!K.material.defines.IS_2D;e.is2D&&!t?this.enter2DMode(e.idMaterial,e.selectionColor):!e.is2D&&t&&(this.setSelectionColor(e.selectionColor),this.exit2DMode());var r=e.aoEnabled!=this.getAOEnabled(),n=e.antialias!=this.getAntialiasing();(r||n)&&this.initPostPipeline(e.aoEnabled,e.antialias)},this.targetToCanvas=function(e){var t=e.width,r=e.height,n=new Uint8Array(t*r*4);k.readRenderTargetPixels(e,0,0,t,r,n);var i=b.createElement("canvas");i.width=t,i.height=r;var o,a=i.getContext("2d"),l=new Uint8ClampedArray(n);return s.isIE11?(o=a.createImageData(t,r),o.data.set(l)):o=new ImageData(l,t,r),a.putImageData(o,0,0),a.globalCompositeOperation="copy",a.translate(0,r),a.scale(1,-1),a.drawImage(i,0,0,t,r),a.globalCompositeOperation="source-over",{canvas:i,ctx:a}}}r.r(t),r.d(t,"RenderContext",function(){return n});var i=r("./src/logger/Logger.js"),o=r("./src/file-loaders/net/ErrorCodes.js"),s=r("./src/compat.js"),a=r("./thirdparty/three.js/three.js"),l=(r.n(a),r("./src/wgs/render/ShaderUtils.js")),c=r("./src/wgs/render/NormalsShader.js"),u=r("./src/wgs/render/ShaderPass.js"),d=r("./src/wgs/render/EdgeShader.js"),h=r("./src/wgs/render/SAOShader.js"),f=r("./src/wgs/render/SAOBlurShader.js"),p=r("./src/wgs/render/SAOMinifyShader.js"),m=r("./src/wgs/render/FXAAShader.js"),g=r("./src/wgs/render/BlendShader.js"),v=r("./src/wgs/render/BackgroundShader.js"),y=r("./src/wgs/render/CopyShader.js"),_=r("./src/wgs/render/RenderContextPostProcess.js"),b=Object(s.getGlobal)().document,x={Color:1,Depth:2,ModelId:3,Overlay:4,Post1:5,Post2:6,SSAO:7,PostDisplay:8}},"./src/wgs/render/RenderContextPostProcess.js":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?o(e):t}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e}r.r(t),r.d(t,"RenderContextPostProcessExtension",function(){return h}),r.d(t,"RenderContextPostProcessManager",function(){return f});var h=function(){function e(t){c(this,e),this.renderContext=t}return d(e,[{key:"load",value:function(){}},{key:"unload",value:function(){this.renderContext=void 0}},{key:"render",value:function(e,t,r){}},{key:"updateUniformValue",value:function(e,t,r){}},{key:"changeResolution",value:function(e,t){}},{key:"setMaterialNeedsUpdate",value:function(){}},{key:"postProcessEdgesOn",value:function(){}},{key:"getRenderOptionClass",value:function(){}}]),e}(),f=function(e){function t(){return c(this,t),i(this,s(t).apply(this,arguments))}return a(t,e),d(t,[{key:"registerPostProcessingExtension",value:function(e){this.extension=e}},{key:"removePostProcessingExtension",value:function(){this.extension&&(this.extension.unload(),this.extension=void 0)}},{key:"getRenderOptionClass",value:function(){return this.extension?this.extension.getRenderOptionClass():void 0}},{key:"preloadPostProcessStyle",value:function(e){this.extension&&this.extension.preloadPostProcessStyle(e)}},{key:"setPostProcessParameter",value:function(e,t){this.extension&&this.extension.setPostProcessParameter(e,t)}},{key:"render",value:function(e,t,r){this.extension&&this.extension.render(e,t,r)}},{key:"updateUniformValue",value:function(e,t,r){this.extension&&this.extension.updateUniformValue(e,t,r)}},{key:"changeResolution",value:function(e,t){this.extension&&this.extension.changeResolution(e,t)}},{key:"setMaterialNeedsUpdate",value:function(){this.extension&&this.extension.setMaterialNeedsUpdate()}},{key:"postProcessEdgesOn",value:function(){return this.extension?this.extension.postProcessEdgesOn():void 0}}]),t}(h)},"./src/wgs/render/SAOBlurShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"SAOBlurShader",function(){return l});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/shaders/screen_quad_uv_vert.glsl")),o=r.n(i),s=r("./src/wgs/render/shaders/sao_blur_frag.glsl"),a=r.n(s),l={uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new n.Vector2(512,512)},resolution:{type:"v2",value:new n.Vector2(1/512,1/512)},axis:{type:"v2",value:new n.Vector2(1,0)},radius:{type:"f",value:50}},vertexShader:o.a,fragmentShader:a.a}},"./src/wgs/render/SAOMinifyShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"SAOMinifyFirstShader",function(){return u}),r.d(t,"SAOMinifyShader",function(){return d});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/shaders/screen_quad_vert.glsl")),o=r.n(i),s=r("./src/wgs/render/shaders/sao_minfirst_frag.glsl"),a=r.n(s),l=r("./src/wgs/render/shaders/sao_min_frag.glsl"),c=r.n(l),u={uniforms:{tDiffuse:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraInvNearFar:{type:"f",value:100},resolution:{type:"v2",value:new n.Vector2(1/512,1/512)}},vertexShader:o.a,fragmentShader:a.a},d={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new n.Vector2(1/512,1/512)}},vertexShader:o.a,fragmentShader:c.a}},"./src/wgs/render/SAOShader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"SAOShader",function(){return c});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),r("./src/wgs/render/ShaderChunks.js")),o=r("./src/wgs/render/shaders/screen_quad_uv_vert.glsl"),s=r.n(o),a=r("./src/wgs/render/shaders/sao_frag.glsl"),l=r.n(a),c={uniforms:n.UniformsUtils.merge([i.ShaderChunks.DepthTextureUniforms,{size:{type:"v2",value:new n.Vector2(512,512)},resolution:{type:"v2",value:new n.Vector2(1/512,1/512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},radius:{type:"f",value:12},bias:{type:"f",value:.1},projScale:{type:"f",value:500},intensity:{type:"f",value:1},tDepth_mip1:{type:"t",value:null},tDepth_mip2:{type:"t",value:null},tDepth_mip3:{type:"t",value:null},tDepth_mip4:{type:"t",value:null},tDepth_mip5:{type:"t",value:null}}]),vertexShader:s.a,fragmentShader:l.a}},"./src/wgs/render/ShaderChunks.js":function(e,t,r){"use strict";function n(e){var t=["#if defined( USE_SURFACE_ALBEDO_MAP ) || defined( USE_SURFACE_ROUGHNESS_MAP ) || defined( USE_SURFACE_CUTOUT_MAP ) || defined( USE_SURFACE_ANISOTROPY_MAP ) || defined( USE_SURFACE_ROTATION_MAP ) || defined( USE_OPAQUE_ALBEDO_MAP ) || defined( USE_OPAQUE_F0_MAP ) || defined( USE_OPAQUE_LUMINANCE_MODIFIER_MAP ) || defined( USE_LAYERED_BOTTOM_F0_MAP ) || defined( USE_LAYERED_F0_MAP ) || defined( USE_LAYERED_DIFFUSE_MAP ) || defined( USE_LAYERED_FRACTION_MAP ) || defined( USE_LAYERED_ROUGHNESS_MAP ) || defined( USE_LAYERED_ANISOTROPY_MAP ) || defined( USE_LAYERED_ROTATION_MAP ) || defined( USE_METAL_F0_MAP ) || defined( USE_SURFACE_NORMAL_MAP ) || defined( USE_LAYERED_NORMAL_MAP )","#define "+e,"#endif"].join("\n");return t}function i(e,t,r,n){var i=r?"_v3":"",o=r?"vec3 ":"",s=r?t+" = average("+t+i+");":"",a=n?t+i+" = SRGBToLinear("+t+i+");":"",l=["#if defined( USE_"+e.toUpperCase()+"_MAP )","vec2 uv_"+e+"_map = ("+e+"_map_texMatrix * vec3(uv, 1.0)).xy;",e.toUpperCase()+"_CLAMP_TEST;",o+t+i+" = texture2D("+e+"_map, uv_"+e+"_map).xyz;",a,"if("+e+"_map_invert) "+t+i+" = vec3(1.0) - "+t+i+";",s,"#else",t+" = "+e+";","#endif"].join("\n");return l}function o(e){var t=e+"_texMatrix",r=e+"_invert",n="USE_"+e,i=["#if defined( "+n.toUpperCase()+" )","uniform sampler2D "+e+";","uniform mat3 "+t+";","uniform bool "+r+";","#endif"].join("\n");return i}function s(e){var t=e+"_texMatrix",r=e+"_bumpScale",n=e+"_bumpmapType",i="USE_"+e,o=["#if defined( "+i.toUpperCase()+" )","uniform sampler2D "+e+";","uniform mat3 "+t+";","uniform vec2 "+r+";","uniform int "+n+";","#endif"].join("\n");return o}r.r(t),r.d(t,"CutPlanesUniforms",function(){return ge}),r.d(t,"IdUniforms",function(){return ve}),r.d(t,"ThemingUniform",function(){return ye}),r.d(t,"ShadowMapCommonUniforms",function(){return _e}),r.d(t,"ShadowMapUniforms",function(){return be}),r.d(t,"PointSizeUniforms",function(){return xe}),r.d(t,"WideLinesUniforms",function(){return we}),r.d(t,"DepthTextureUniforms",function(){return Ee}),r.d(t,"GetPrismMapSampleChunk",function(){return i}),r.d(t,"GetPrismMapUniformChunk",function(){return o}),r.d(t,"resolve",function(){return Ce}),r.d(t,"PackDepthShaderChunk",function(){return je}),r.d(t,"TonemapShaderChunk",function(){return Pe}),r.d(t,"OrderedDitheringShaderChunk",function(){return Le}),r.d(t,"CutPlanesShaderChunk",function(){return De}),r.d(t,"PackNormalsShaderChunk",function(){return Ie}),r.d(t,"HatchPatternShaderChunk",function(){return Re}),r.d(t,"EnvSamplingShaderChunk",function(){return Oe}),r.d(t,"IdVertexDeclaration",function(){return ke}),r.d(t,"IdVertexShaderChunk",function(){return Ne}),r.d(t,"IdFragmentDeclaration",function(){return Fe}),r.d(t,"IdOutputShaderChunk",function(){return Ve}),r.d(t,"FinalOutputShaderChunk",function(){return Ue}),r.d(t,"ThemingFragmentDeclaration",function(){return Be}),r.d(t,"ThemingFragmentShaderChunk",function(){return ze}),r.d(t,"InstancingVertexDeclaration",function(){return Ge}),r.d(t,"ShadowMapDeclareCommonUniforms",function(){return He}),r.d(t,"ShadowMapVertexDeclaration",function(){return We}),r.d(t,"ShadowMapVertexShaderChunk",function(){return qe}),r.d(t,"ShadowMapFragmentDeclaration",function(){return Xe}),r.d(t,"PointSizeDeclaration",function(){return Ye}),r.d(t,"PointSizeShaderChunk",function(){return Ke}),r.d(t,"ShaderChunks",function(){return Qe});var a=r("./thirdparty/three.js/three.js"),l=(r.n(a),r("./src/wgs/render/chunks/pack_depth.glsl")),c=r.n(l),u=r("./src/wgs/render/chunks/depth_texture.glsl"),d=r.n(u),h=r("./src/wgs/render/chunks/tonemap.glsl"),f=r.n(h),p=r("./src/wgs/render/chunks/ordered_dither.glsl"),m=r.n(p),g=r("./src/wgs/render/chunks/cutplanes.glsl"),v=r.n(g),y=r("./src/wgs/render/chunks/pack_normals.glsl"),_=r.n(y),b=r("./src/wgs/render/chunks/hatch_pattern.glsl"),x=r.n(b),w=r("./src/wgs/render/chunks/env_sample.glsl"),E=r.n(w),S=r("./src/wgs/render/chunks/id_decl_vert.glsl"),A=r.n(S),M=r("./src/wgs/render/chunks/id_vert.glsl"),T=r.n(M),C=r("./src/wgs/render/chunks/id_decl_frag.glsl"),j=r.n(C),P=r("./src/wgs/render/chunks/id_frag.glsl"),L=r.n(P),D=r("./src/wgs/render/chunks/final_frag.glsl"),I=r.n(D),R=r("./src/wgs/render/chunks/theming_decl_frag.glsl"),O=r.n(R),k=r("./src/wgs/render/chunks/theming_frag.glsl"),N=r.n(k),F=r("./src/wgs/render/chunks/instancing_decl_vert.glsl"),V=r.n(F),U=r("./src/wgs/render/chunks/shadowmap_decl_common.glsl"),B=r.n(U),z=r("./src/wgs/render/chunks/shadowmap_decl_vert.glsl"),G=r.n(z),H=r("./src/wgs/render/chunks/shadowmap_vert.glsl"),W=r.n(H),q=r("./src/wgs/render/chunks/shadowmap_decl_frag.glsl"),X=r.n(q),Y=r("./src/wgs/render/chunks/float3_average.glsl"),K=r.n(Y),Q=r("./src/wgs/render/chunks/line_decl_common.glsl"),Z=r.n(Q),J=r("./src/wgs/render/chunks/prism_wood.glsl"),$=r.n(J),ee=r("./src/wgs/render/chunks/prism_glazing.glsl"),te=r.n(ee),re=r("./src/wgs/render/chunks/prism_transparency.glsl"),ne=r.n(re),ie=r("./src/wgs/render/chunks/normal_map.glsl"),oe=r.n(ie),se=r("./src/wgs/render/chunks/decl_point_size.glsl"),ae=r.n(se),le=r("./src/wgs/render/chunks/point_size.glsl"),ce=r.n(le),ue=r("./src/wgs/render/chunks/wide_lines_decl.glsl"),de=r.n(ue),he=r("./src/wgs/render/chunks/wide_lines_vert.glsl"),fe=r.n(he),pe=r("./src/wgs/render/chunks/hsv.glsl"),me=r.n(pe),ge={cutplanes:{type:"v4v",value:[]},hatchParams:{type:"v2",value:new a.Vector2(1,10)},hatchTintColor:{type:"c",value:new a.Color(16777215)},hatchTintIntensity:{type:"f",value:1}},ve={dbId:{type:"v3",value:new a.Vector3(0,0,0)},modelId:{type:"v3",value:new a.Vector3(0,0,0)}},ye={themingColor:{type:"v4",value:new a.Vector4(0,0,0,0)}},_e={shadowESMConstant:{type:"f",value:0}},be=a.UniformsUtils.merge([{shadowMap:{type:"t",value:null},shadowMapSize:{type:"v2",value:new a.Vector2(0,0)},shadowBias:{type:"f",value:0},shadowDarkness:{type:"f",value:0},shadowMatrix:{type:"m4",value:new a.Matrix4},shadowLightDir:{type:"v3",value:new a.Vector3}},_e]),xe={point_size:{type:"f",value:1}},we={view_size:{type:"v2",value:new a.Vector2(640,480)}},Ee={tDepth:{type:"t",value:null},projInfo:{type:"v4",value:new a.Vector4},isOrtho:{type:"f",value:0},worldMatrix_mainPass:{type:"m4",value:new a.Matrix4}},Se={};for(var Ae in a.ShaderChunk)Se[Ae]=a.ShaderChunk[Ae];Se.pack_depth=c.a,Se.depth_texture=d.a,Se.tonemap=f.a,Se.ordered_dither=m.a,Se.cutplanes=v.a,Se.pack_normals=_.a,Se.hatch_pattern=x.a,Se.env_sample=E.a,Se.id_decl_vert=A.a,Se.id_vert=T.a,Se.id_decl_frag=j.a,Se.id_frag=L.a,Se.final_frag=I.a,Se.theming_decl_frag=O.a,Se.theming_frag=N.a,Se.instancing_decl_vert=V.a,Se.shadowmap_decl_common=B.a,Se.shadowmap_decl_vert=G.a,Se.shadowmap_vert=W.a,Se.shadowmap_decl_frag=X.a,Se.float3_average=K.a,Se.line_decl_common=Z.a,Se.prism_wood=$.a,Se.prism_glazing=te.a,Se.prism_transparency=ne.a,Se.normal_map=oe.a,Se.decl_point_size=ae.a,Se.point_size=ce.a,Se.wide_lines_decl=de.a,Se.wide_lines_vert=fe.a,Se.hsv=me.a;var Me={};Me.prism_check=n,Me.prism_sample_texture=function(e,t,r,n){return i(e,t,"true"===r,"true"===n)},Me.prism_uniforms=o,Me.prism_bump_uniforms=s;var Te={};for(Ae in Me)Te[Ae]=new RegExp("#"+Ae+" *<([\\w\\d., ]*)>","g");var Ce=function Ze(e){for(var t in Me){var r=Te[t];e=e.replace(r,function(e,r){var n=r.split(",").map(function(e){return e.trim()});return Me[t].apply(null,n)})}var n=/#include *<([\w\d.]+)>/g,i=function(e,t){if(!Se[t])throw new Error("Cannot resolve #include<"+t+">");return Ze(Se[t])};return e.replace(n,i)},je=Se.pack_depth,Pe=Se.tonemap,Le=Se.ordered_dither,De=Se.cutplanes,Ie=Se.pack_normals,Re=Se.hatch_pattern,Oe=Se.env_sample,ke=Se.id_decl_vert,Ne=Se.id_vert,Fe=Se.id_decl_frag,Ve=Se.id_frag,Ue=Se.final_frag,Be=Se.theming_decl_frag,ze=Se.theming_frag,Ge=Se.instancing_decl_vert,He=Se.shadowmap_decl_common,We=Se.shadowmap_decl_vert,qe=Se.shadowmap_vert,Xe=Se.shadowmap_decl_frag,Ye=Se.decl_point_size,Ke=Se.point_size,Qe={IdUniforms:ve,ThemingUniform:ye,CutPlanesUniforms:ge,ShadowMapCommonUniforms:_e,ShadowMapUniforms:be,PointSizeUniforms:xe,WideLinesUniforms:we,DepthTextureUniforms:Ee,PackDepthShaderChunk:je,TonemapShaderChunk:Pe,OrderedDitheringShaderChunk:Le,CutPlanesShaderChunk:De,PackNormalsShaderChunk:Ie,HatchPatternShaderChunk:Re,EnvSamplingShaderChunk:Oe,IdVertexDeclaration:ke,IdVertexShaderChunk:Ne,IdFragmentDeclaration:Fe,IdOutputShaderChunk:Ve,FinalOutputShaderChunk:Ue,ThemingFragmentDeclaration:Be,ThemingFragmentShaderChunk:ze,InstancingVertexDeclaration:Ge,ShadowMapDeclareCommonUniforms:He,ShadowMapVertexDeclaration:We,ShadowMapVertexShaderChunk:qe,ShadowMapFragmentDeclaration:Xe,PointSizeDeclaration:Ye,PointSizeShaderChunk:Ke,GetPrismMapSampleChunk:i,GetPrismMapUniformChunk:o,resolve:Ce}},"./src/wgs/render/ShaderPass.js":function(e,t,r){"use strict";r.r(t),r.d(t,"ShaderPass",function(){return o});var n=r("./src/wgs/render/ShaderUtils.js"),i=r("./thirdparty/three.js/three.js"),o=(r.n(i),function(e,t){this.textureID=void 0!==t?t:"tDiffuse",this.material=Object(n.createShaderMaterial)(e),this.uniforms=this.material.uniforms,this.renderToScreen=!1,this.enabled=!0,this.clear=!1,this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1);var r=new i.BufferGeometry,o=new Float32Array(9);o[0]=-1,o[1]=-1,o[2]=0,o[3]=3,o[4]=-1,o[5]=0,o[6]=-1,o[7]=3,o[8]=0;var s=new Float32Array(6);s[0]=0,s[1]=0,s[2]=2,s[3]=0,s[4]=0,s[5]=2;var a=new Float32Array(9);a[0]=0,a[1]=0,a[2]=1,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=1,r.addAttribute("position",new i.BufferAttribute(o,3)),r.addAttribute("normal",new i.BufferAttribute(a,3)),r.addAttribute("uv",new i.BufferAttribute(s,2)),this.quad=new i.Mesh(r,this.material),this.scene=new i.Scene,this.scene.add(this.quad)});o.prototype={render:function(e,t,r,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture||r),this.renderToScreen||!t?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}},"./src/wgs/render/ShaderUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"createShaderMaterial",function(){return i}),r.d(t,"setMacro",function(){return o}),r.d(t,"removeMacro",function(){return s});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),function(e){var t={vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return e.uniforms&&(t.uniforms=n.UniformsUtils.clone(e.uniforms)),e.defines&&(t.defines=Object.assign({},e.defines)),e.extensions&&(t.extensions=Object.assign({},e.extensions)),e.attributes&&(t.attributes=e.attributes),new n.ShaderMaterial(t)}),o=function(e,t,r){r=r||"",e.defines||(e.defines={}),e.defines[t]!=r&&(e.defines[t]=r,e.needsUpdate=!0)},s=function(e,t){(e.defines||e.defines[t])&&(delete e.defines[t],e.needsUpdate=!0)}},"./src/wgs/render/ShadowMap.js":function(e,t,r){"use strict";function n(){function e(){this.init=function(){this.isPrism=!1,this.alphaMap=!1,this.alphaClampS=!1,this.alphaClampT=!1,this.alphaInvert=!1,this.rgbaMap=!1,this.rgbaClampS=!1,this.rgbaClampT=!1,this.rgbaInvert=!1,this.instanced=!1,this.decalIndex=-1},this.init(),this.getMaterialIndex=function(){var e=(this.isPrism?1:0)|(this.alphaMap?2:0)|(this.alphaClampS?4:0)|(this.alphaClampT?8:0)|(this.alphaInvert?16:0)|(this.rgbaMap?32:0)|(this.rgbaClampS?64:0)|(this.rgbaClampT?128:0)|(this.rgbaInvert?256:0)|(this.instanced?512:0)|1024*(this.decalIndex+1);return e}}function t(e,t){var r=e.getMaterialIndex();if(!i[r]){var n=o.clone();e.isPrism&&e.alphaMap&&(Object(a.setMacro)(n,"USE_SURFACE_CUTOUT_MAP"),n.fragmentShader=Object(c.GetPrismMapChunk)("surface_cutout",e.alphaClampS,e.alphaClampT)+"\n"+n.fragmentShader),e.instanced&&(n.useInstancing=!0),i[r]=n}return i[r]}function r(e){return e instanceof f.MeshPhongMaterial?e.opacity<S.ShadowMinOpacity:e.isPrismMaterial?"PrismTransparent"===e.prismType||"PrismGlazing"===e.prismType:e.visible?!1:!0}function n(e,n){if(r(e))return s;var i=e instanceof f.MeshPhongMaterial,o=e.isPrismMaterial;if(!i&&!o)return null;var a=i?e.alphaMap:e.surface_cutout_map,l=i&&e.alphaTest?e.map:null;if(!a&&!l&&!e.useInstancing)return null;var c=u;c.init(),c.isPrism=o,c.alphaMap=!!a,c.rgbaMap=!!l,c.instanced=e.useInstancing,c.decalIndex=void 0===n?-1:n,a&&(c.alphaClampS=a.clampS,c.alphaClampT=a.clampT,c.alphaInvert=a.invert),l&&(c.rgbaClampS=l.clampS,c.rgbaClampT=l.clampT,c.rgbaInvert=l.invert);var d=t(c,n);return a&&(i?(d.uniforms.alphaMap.value=a,d.uniforms.texMatrixAlpha.value=a.matrix,d.alphaMap=a,d.side=e.side):(d.uniforms.surface_cutout_map.value=a,d.uniforms.surface_cutout_map_texMatrix.value.copy(a.matrix),d.uniforms.surface_cutout_map_invert.value=a.invert,d.side=f.DoubleSide)),l&&(d.uniforms.map.value=l,d.uniforms.texMatrix.value=l.matrix,d.map=l),d}var i=[],o=Object(a.createShaderMaterial)(w),s=new f.Material;s.visible=!1;var l=[],u=new e;this.forEachMaterial=function(e){for(var t=0;t<i.length;t++){var r=i[t];r&&e(r)}e(o)},this.getCustomOverrideMaterial=function(e){var t=n(e);if(!t)return null;if(!e.decals)return t.decals=null,t;if(e.decals){l.length=0;for(var r=0;r<e.decals.length;r++){var i=e.decals[r],o=n(i.material,r);if(!o)return null;l.push({uv:i.uv,material:o})}}return t.decals=l,t},this.dispose=function(){this.forEachMaterial(function(e){e.dispose()})}}function i(){this.shadowMap=void 0,this.shadowMapSize=void 0,this.shadowMatrix=void 0,this.shadowLightDir=void 0,this.init=function(e){this.shadowMap=e,this.shadowMapSize=new f.Vector2(e.width,e.height),this.shadowMatrix=new f.Matrix4,this.shadowLightDir=new f.Vector3},this.apply=function(e){e.shadowMap=this.shadowMap,e.shadowMatrix=this.shadowMatrix,e.shadowLightDir=this.shadowLightDir,this.shadowMap?(Object(a.setMacro)(e,"USE_SHADOWMAP"),S.UseHardShadows&&Object(a.setMacro)(e,"USE_HARD_SHADOWS")):(Object(a.removeMacro)(e,"USE_SHADOWMAP"),Object(a.removeMacro)(e,"USE_HARD_SHADOWS"))}}function o(e){function t(e,t){e.forEach(function(e){t.apply(e)})}function r(e){var t=new f.WebGLRenderTarget(e,e,{minFilter:f.LinearFilter,magFilter:f.LinearFilter,format:f.RGBAFormat,type:f.FloatType,stencilBuffer:!1,generateMipmaps:!1});return t.generateMipmaps=!1,t}function o(e){_.setRenderTarget(e),_.setClearColor(y,1),_.clear()}function s(e){var r=p.shadowMap;p.shadowMap=D,t(e,p),p.apply(b),p.shadowMap=r}function l(e){e.uniforms.shadowMapRangeMin.value=g.near,e.uniforms.shadowMapRangeSize.value=g.far-g.near,e.uniforms.shadowESMConstant.value=S.ShadowESMConstant,e.uniforms.shadowMinOpacity.value=S.ShadowMinOpacity}function c(e,t,r){var n=r||new f.Vector3;return n.x=1&t?e.max.x:e.min.x,n.y=2&t?e.max.y:e.min.y,n.z=4&t?e.max.z:e.min.z,n}var p=null,m=null,g=new f.OrthographicCamera,v=Math.exp(S.ShadowESMConstant),y=S.UseHardShadows?new f.Color(1,1,1):new f.Color(v,1,1),_=e,b=null,x=null,j=null,P=Object(a.createShaderMaterial)(w),L=new n;P.getCustomOverrideMaterial=L.getCustomOverrideMaterial;var D=null,I=function(){var e=new f.Matrix4,t=new f.Matrix4,r=new f.Vector3(0,0,0),n=new f.Box3,i=new f.Vector3,o=new f.Vector3;return function(s,a,l){s.position.copy(l),s.lookAt(r),e.makeRotationFromQuaternion(s.quaternion),t.getInverse(e),n.copy(a).applyMatrix4(t),o=n.center(o),i.set(o.x,o.y,n.max.z),i.applyMatrix4(e),s.position.copy(i),o=n.size(o),s.left=-.5*o.x,s.right=.5*o.x,s.bottom=-.5*o.y,s.top=.5*o.y,s.near=0,s.far=o.z,s.updateMatrixWorld(),s.matrixWorldInverse.getInverse(s.matrixWorld),s.updateProjectionMatrix()}}();this.init=function(){p=new i,p.init(r(S.ShadowMapSize)),m=S.BlurShadowMap?new d.GaussianPass(S.ShadowMapSize,S.ShadowMapSize,S.ShadowMapBlurRadius,1,{type:p.shadowMap.type,format:p.shadowMap.format}):void 0,b=Object(a.createShaderMaterial)(E),b.depthWrite=!1,b.transparent=!0,x=Object(u.createGroundShape)(b),j=new f.Scene,j.add(x),this.groundShapeBox=new f.Box3,D=r(1),o(D)},this.init(),this.state=A,this.startUpdate=function(e,t,r,n,i){var o=e.getVisibleBounds(!0);return this.beginShadowMapUpdate(r,o,n),e.reset(g,h.RenderFlags.RENDER_SHADOWMAP,!0),this.state=M,t=this.continueUpdate(e,t,i)},this.continueUpdate=function(e,t,r){return t=e.renderSome(this.renderSceneIntoShadowMap,t),e.isDone()?(this.state=T,this.finishShadowMapUpdate(r)):s(r),t},this.beginShadowMapUpdate=function(e,t,r){I(g,t,r),l(P),L.forEachMaterial(l),S.UseHardShadows&&(Object(a.setMacro)(P,"USE_HARD_SHADOWS"),L.forEachMaterial(function(e){Object(a.setMacro)(e,"USE_HARD_SHADOWS")})),o(p.shadowMap),this.renderSceneIntoShadowMap(j)},this.renderSceneIntoShadowMap=function(e){e.overrideMaterial=P,_.render(e,g,p.shadowMap),e.overrideMaterial=null},this.finishShadowMapUpdate=function(e){m&&!S.UseHardShadows&&m.render(_,p.shadowMap,p.shadowMap),p.shadowMatrix.multiplyMatrices(g.projectionMatrix,g.matrixWorldInverse),p.shadowMapRangeMin=g.near,p.shadowMapRangeSize=g.far-g.near,p.shadowLightDir.copy(g.position).normalize(),t(e,p),p.apply(b),this.isValid=!0},this.cleanup=function(e){m&&m.cleanup(),p.shadowMap&&p.shadowMap.dispose(),t(e,C),P.dispose(),L.dispose(),b.dispose(),x.geometry.dispose()},this.setGroundShadowTransform=function(){return function(e,t,r,n){Object(u.setGroundShapeTransform)(x,e,t,r,n),this.groundShapeBox.setFromObject(x)}}(),this.renderGroundShadow=function(e,t){_.render(j,e,t,!1)},this.expandByGroundShadow=function(){var e=new f.Plane,t=new f.Ray,r=new f.Vector3,n=new f.Vector3,i=new f.Box3;return function(o,s){e.normal.set(0,1,0),e.constant=-o.min.y,t.direction.copy(s).negate().normalize();var a=100,l=o.center(r),u=l.distanceToSquared(o.min)*a*a;i.makeEmpty();for(var d=0;8>d;d++){t.origin=c(o,d);var h=t.intersectPlane(e,n);h&&(h.distanceToSquared(l)>=u||i.expandByPoint(h))}o.union(i)}}(),this.getShadowParams=function(){return p},this.getShadowCamera=function(){return g}}r.r(t),r.d(t,"ShadowMapShader",function(){return w}),r.d(t,"GroundShadowShader",function(){return E}),r.d(t,"ShadowMapOverrideMaterials",function(){return n}),r.d(t,"ShadowConfig",function(){return S}),r.d(t,"SHADOWMAP_NEEDS_UPDATE",function(){return A}),r.d(t,"SHADOWMAP_INCOMPLETE",function(){return M}),r.d(t,"SHADOWMAP_VALID",function(){return T}),r.d(t,"ShadowMaps",function(){return o}),r.d(t,"ShadowRender",function(){return j});var s=r("./src/wgs/render/ShaderChunks.js"),a=r("./src/wgs/render/ShaderUtils.js"),l=r("./src/wgs/render/PrismUtil.js"),c=r("./src/wgs/render/WebGLProgram.js"),u=r("./src/wgs/render/GroundShadow.js"),d=r("./src/wgs/render/GaussianPass.js"),h=r("./src/wgs/scene/RenderFlags.js"),f=r("./thirdparty/three.js/three.js"),p=(r.n(f),r("./src/wgs/render/shaders/shadowmap_vert.glsl")),m=r.n(p),g=r("./src/wgs/render/shaders/shadowmap_frag.glsl"),v=r.n(g),y=r("./src/wgs/render/shaders/shadowmap_ground_vert.glsl"),_=r.n(y),b=r("./src/wgs/render/shaders/shadowmap_ground_frag.glsl"),x=r.n(b),w={uniforms:f.UniformsUtils.merge([s.ShaderChunks.ShadowMapCommonUniforms,{shadowMapRangeMin:{type:"f",value:0},shadowMapRangeSize:{type:"f",value:0},shadowMinOpacity:{type:"f",value:0},map:{type:"t",value:null},alphaMap:{type:"t",value:null},texMatrix:{type:"m3",value:new f.Matrix3},texMatrixAlpha:{type:"m3",value:new f.Matrix3}},Object(l.GetPrismMapUniforms)("surface_cutout_map")]),vertexShader:m.a,fragmentShader:v.a},E={uniforms:s.ShaderChunks.ShadowMapUniforms,vertexShader:_.a,fragmentShader:x.a},S={ShadowMapSize:1024,ShadowESMConstant:80,ShadowBias:.001,ShadowDarkness:.7,ShadowMapBlurRadius:4,ShadowMinOpacity:.9,UseHardShadows:!1,BlurShadowMap:!0},A=0,M=1,T=2,C=new i,j=function(){};j.RefreshUniformsShadow=function(e,t){e.shadowMap&&(e.shadowMap.value=t.shadowMap),e.shadowMatrix&&(e.shadowMatrix.value=t.shadowMatrix),e.shadowLightDir&&(e.shadowLightDir.value=t.shadowLightDir),e.shadowESMConstant&&(e.shadowESMConstant.value=S.ShadowESMConstant),e.shadowBias&&(e.shadowBias.value=S.ShadowBias),e.shadowMapSize&&(e.shadowMapSize.value=S.ShadowMapSize),e.shadowDarkness&&(e.shadowDarkness.value=S.ShadowDarkness)}},"./src/wgs/render/WebGLProgram.js":function(e,t,r){"use strict";
r.r(t),r.d(t,"PrismMaps",function(){return d}),r.d(t,"GetPrismMapChunk",function(){return h}),r.d(t,"WebGLProgram",function(){return f});var n=r("./src/wgs/render/WebGLShader.js"),i=r("./src/wgs/render/ShaderChunks.js"),o=r("./thirdparty/three.js/three.js"),s=(r.n(o),r("./src/compat.js")),a="#version 300 es\n    #define _LMVWEBGL2_\n    #define texture2D texture\n    #define textureCube texture\n    #define attribute in\n    #define varying out\n",l="",c="#version 300 es\n    #define _LMVWEBGL2_\n    #define texture2D texture\n    #define textureCube texture\n    #define textureCubeLodEXT textureLod\n    #define gl_FragColor outFragColor\n    #define varying in\n",u="\n    #define gl_FragDepth gl_FragDepthEXT\n    #extension GL_OES_standard_derivatives : enable\n",d=["opaque_luminance_modifier","surface_albedo","surface_roughness","surface_anisotropy","surface_rotation","opaque_f0","opaque_albedo","metal_f0","layered_f0","layered_diffuse","layered_roughness","layered_anisotropy","layered_rotation","layered_bottom_f0","layered_fraction","surface_cutout","glazing_transmission_color","glazing_f0","glazing_transmission_roughness","wood_curly_distortion"],h=function(e,t,r){var n="uv_"+e+"_map",i="";return t&&r?i="if ("+n+".x < 0.0 || "+n+".x > 1.0 || "+n+".y < 0.0 || "+n+".y > 1.0) { discard; }":t?i="if ("+n+".x < 0.0 || "+n+".x > 1.0) { discard; }":r&&(i="if ("+n+".y < 0.0 || "+n+".y > 1.0) { discard; }"),"#define "+e.toUpperCase()+"_CLAMP_TEST "+i},f=function(){var e=0,t=function(e){return""!==e},r=function(e){var t,r,n=[];for(var i in e)t=e[i],t!==!1&&(r="#define "+i+" "+t,n.push(r));return n.join("\n")},f=function(e,t,r){for(var n={},i=0,o=r.length;o>i;i++){var s=r[i];n[s]=e.getUniformLocation(t,s)}return n},p=function(e,t,r){for(var n={},i=0,o=r.length;o>i;i++){var s=r[i];n[s]=e.getAttribLocation(t,s)}return n},m=function(e,t,r,n,i){var o=n?"1.0-":"",s="texture2D("+e+", (UV))",a="";return i=i||"vec4(0.0)",t&&r?a="((UV).x < 0.0 || (UV).x > 1.0 || (UV).y < 0.0 || (UV).y > 1.0) ? "+i+" : ":t?a="((UV).x < 0.0 || (UV).x > 1.0) ? "+i+" : ":r&&(a="((UV).y < 0.0 || (UV).y > 1.0) ? "+i+" : "),"#define GET_"+e.toUpperCase()+"(UV) ("+a+o+s+")"},g=function(e){for(var t="\n",r=0;r<d.length;r++){var n=e[d[r]];n&&(t+=h(d[r],n.S,n.T)+"\n")}return t};return function(d,h,v,y){var _=d,b=_.context,x=_.isWebGL2(),w=v.defines,E=v.__webglShader.uniforms,S=v.attributes,A=Object(i.resolve)(v.__webglShader.vertexShader),M=Object(i.resolve)(v.__webglShader.fragmentShader),T=v.index0AttributeName;void 0===T&&y.morphTargets===!0&&(T="position");var C="ENVMAP_TYPE_CUBE",j="ENVMAP_MODE_REFLECTION",P="ENVMAP_BLENDING_MULTIPLY";y.envMap;var L,D,I=d.gammaFactor>0?d.gammaFactor:1,R=r(w),O=b.createProgram();v instanceof o.RawShaderMaterial?(L=[x?a:l,R].filter(t).join("\n"),L.length>0&&(L+="\n"),D=[x?c:u,"precision "+y.precisionFragment+" float;",R,x?"out vec4 outFragColor;":""].filter(t).join("\n"),D.length>0&&(D+="\n")):(L=[x?a:l,"precision "+y.precision+" float;","precision "+y.precision+" int;",R,y.vertexPrefix,y.supportsVertexTextures?"#define VERTEX_TEXTURES":"",_.gammaInput?"#define GAMMA_INPUT":"",_.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+I,y.mrtNormals?"#define MRT_NORMALS":"",y.mrtIdBuffer?"#define MRT_ID_BUFFER":"","#define MAX_DIR_LIGHTS "+y.maxDirLights,"#define MAX_POINT_LIGHTS "+y.maxPointLights,"#define MAX_SPOT_LIGHTS "+y.maxSpotLights,"#define MAX_HEMI_LIGHTS "+y.maxHemiLights,"#define MAX_BONES "+y.maxBones,"#define NUM_CUTPLANES "+y.numCutplanes,y.loadingAnimationDuration>0?"#define LOADING_ANIMATION":"",y.map?"#define USE_MAP":"",y.envMap?"#define USE_ENVMAP":"",y.envMap?"#define "+j:"",y.irradianceMap?"#define USE_IRRADIANCEMAP":"",y.lightMap?"#define USE_LIGHTMAP":"",y.bumpMap?"#define USE_BUMPMAP":"",y.normalMap?"#define USE_NORMALMAP":"",y.specularMap?"#define USE_SPECULARMAP":"",y.alphaMap?"#define USE_ALPHAMAP":"",y.vertexColors?"#define USE_COLOR":"",y.vertexIds?"#define USE_VERTEX_ID":"",y.useTiling?"#define USE_TILING":"",y.useInstancing?"#define USE_INSTANCING":"",y.wideLines?"#define WIDE_LINES":"",y.skinning?"#define USE_SKINNING":"",y.useVertexTexture?"#define BONE_TEXTURE":"",y.morphTargets?"#define USE_MORPHTARGETS":"",y.morphNormals?"#define USE_MORPHNORMALS":"",y.wrapAround?"#define WRAP_AROUND":"",y.doubleSided?"#define DOUBLE_SIDED":"",y.flipSided?"#define FLIP_SIDED":"",y.sizeAttenuation?"#define USE_SIZEATTENUATION":"",y.packedNormals?"#define UNPACK_NORMALS":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","#ifdef UNPACK_NORMALS","attribute vec2 normal;","#else","attribute vec3 normal;","#endif","attribute vec2 uv;","attribute vec2 uv2;","#ifdef PRISMWOOD","attribute vec3 uvw;","#endif","#ifdef USE_COLOR","   attribute vec3 color;","#endif",""].join("\n"),D=[x?c:u,x||!y.bumpMap&&!y.normalMap?"":"#extension GL_OES_standard_derivatives : enable",x||!y.mrtIdBuffer&&!y.mrtNormals||s.isIE11?"":"#extension GL_EXT_draw_buffers : enable",!x&&y.mrtIdBuffer?"#define gl_FragColor gl_FragData[0]":"",y.haveTextureLod?"#define HAVE_TEXTURE_LOD":"",R,y.fragmentPrefix,"#define MAX_DIR_LIGHTS "+y.maxDirLights,"#define MAX_POINT_LIGHTS "+y.maxPointLights,"#define MAX_SPOT_LIGHTS "+y.maxSpotLights,"#define MAX_HEMI_LIGHTS "+y.maxHemiLights,"#define NUM_CUTPLANES "+y.numCutplanes,y.loadingAnimationDuration>0?"#define LOADING_ANIMATION":"",y.alphaTest?"#define ALPHATEST "+y.alphaTest:"",_.gammaInput?"#define GAMMA_INPUT":"",_.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+I,y.mrtNormals?"#define MRT_NORMALS":"",y.mrtIdBuffer?"#define MRT_ID_BUFFER":"",y.mrtIdBuffer>1?"#define MODEL_COLOR":"","#define TONEMAP_OUTPUT "+(y.tonemapOutput||0),y.useFog&&y.fog?"#define USE_FOG":"",y.useFog&&y.fogExp?"#define FOG_EXP2":"",y.map?"#define USE_MAP":"",y.envMap?"#define USE_ENVMAP":"",y.envMap?"#define "+C:"",y.envMap?"#define "+j:"",y.envMap?"#define "+P:"",y.irradianceMap?"#define USE_IRRADIANCEMAP":"",y.envGammaEncoded?"#define ENV_GAMMA":"",y.irrGammaEncoded?"#define IRR_GAMMA":"",y.envRGBM?"#define ENV_RGBM":"",y.irrRGBM?"#define IRR_RGBM":"",y.lightMap?"#define USE_LIGHTMAP":"",y.bumpMap?"#define USE_BUMPMAP":"",y.normalMap?"#define USE_NORMALMAP":"",y.specularMap?"#define USE_SPECULARMAP":"",y.alphaMap?"#define USE_ALPHAMAP":"",y.vertexColors?"#define USE_COLOR":"",y.vertexIds?"#define USE_VERTEX_ID":"",y.metal?"#define METAL":"",y.clearcoat?"#define CLEARCOAT":"",y.wrapAround?"#define WRAP_AROUND":"",y.doubleSided?"#define DOUBLE_SIDED":"",y.flipSided?"#define FLIP_SIDED":"",y.hatchPattern?"#define HATCH_PATTERN":"",y.mapInvert?"#define MAP_INVERT":"",y.useTiling?"#define USE_TILING":"",y.useTiling?"#define TILE_RANGE_X_MIN "+y.tilingRepeatRange[0]:"",y.useTiling?"#define TILE_RANGE_Y_MIN "+y.tilingRepeatRange[1]:"",y.useTiling?"#define TILE_RANGE_X_MAX "+y.tilingRepeatRange[2]:"",y.useTiling?"#define TILE_RANGE_Y_MAX "+y.tilingRepeatRange[3]:"",y.hasRoundCorner?"#define USE_TILING_NORMAL":"",y.useRandomOffset?"#define USE_TILING_RANDOM":"",m("map",y.mapClampS,y.mapClampT),m("bumpMap",y.bumpMapClampS,y.bumpMapClampT),m("normalMap",y.normalMapClampS,y.normalMapClampT),m("specularMap",y.specularMapClampS,y.specularMapClampT),m("alphaMap",y.alphaMapClampS,y.alphaMapClampT,y.alphaMapInvert),"#ifdef USE_ENVMAP","#ifdef HAVE_TEXTURE_LOD",x?"":"#extension GL_EXT_shader_texture_lod : enable","#endif","#endif","precision "+y.precisionFragment+" float;","precision "+y.precisionFragment+" int;",x?"layout(location = 0) out vec4 outFragColor;":"","uniform highp mat4 viewMatrix;","uniform highp mat4 projectionMatrix;","uniform highp vec3 cameraPosition;","#if defined(USE_ENVMAP) || defined(USE_IRRADIANCEMAP)","uniform mat4 viewMatrixInverse;","#endif",""].join("\n"),y.isPrism&&(D+=g(y)));var k=new n.WebGLShader(b,b.VERTEX_SHADER,L+A),N=new n.WebGLShader(b,b.FRAGMENT_SHADER,D+M);b.attachShader(O,k),b.attachShader(O,N),void 0!==T&&b.bindAttribLocation(O,0,T),b.linkProgram(O),"undefined"!=typeof DEBUG_SHADERS&&DEBUG_SHADERS&&(b.getProgramParameter(O,b.LINK_STATUS)===!1&&(o.error("THREE.WebGLProgram: Could not initialise shader."),o.error("gl.VALIDATE_STATUS",b.getProgramParameter(O,b.VALIDATE_STATUS)),o.error("gl.getError()",b.getError())),""!==b.getProgramInfoLog(O)&&o.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",b.getProgramInfoLog(O))),b.deleteShader(k),b.deleteShader(N);var F=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","viewMatrixInverse","mvpMatrix","dbId"];for(var V in E)F.push(V);this.uniforms=f(b,O,F),F=["position","normal","uv","uv2","tangent","color","lineDistance","uvw","id","instOffset","instScaling","instRotation","prev","next","side"];for(var U in S)F.push(U);return this.attributes=p(b,O,F),this.attributesKeys=Object.keys(this.attributes),this.id=e++,this.code=h,this.usedTimes=1,this.program=O,this.vertexShader=k,this.fragmentShader=N,this}}()},"./src/wgs/render/WebGLRenderer.js":function(e,t,r){"use strict";r.r(t),r.d(t,"DEBUG_TEXTURE_LOAD",function(){return c}),r.d(t,"WebGLRenderer",function(){return h});var n=r("./src/wgs/render/WebGLProgram.js"),i=r("./src/wgs/render/ShadowMap.js"),o=r("./src/wgs/scene/RenderBatch.js"),s=r("./src/compat.js"),a=r("./thirdparty/three.js/three.js"),l=(r.n(a),r("./src/wgs/globals.js")),c=!1,u=Object(s.getGlobal)(),d=u.document,h=function(e){function t(e){e.__webglVertexBuffer=et.createBuffer(),e.__webglColorBuffer=et.createBuffer(),e.__webglLineDistanceBuffer=et.createBuffer(),ot.info.memory.geometries++}function r(e){e.__webglVertexBuffer=et.createBuffer(),e.__webglColorBuffer=et.createBuffer(),ot.info.memory.geometries++}function h(e){e.__webglVertexBuffer=et.createBuffer(),e.__webglNormalBuffer=et.createBuffer(),e.__webglTangentBuffer=et.createBuffer(),e.__webglColorBuffer=et.createBuffer(),e.__webglUVBuffer=et.createBuffer(),e.__webglUV2Buffer=et.createBuffer(),e.__webglSkinIndicesBuffer=et.createBuffer(),e.__webglSkinWeightsBuffer=et.createBuffer(),e.__webglFaceBuffer=et.createBuffer(),e.__webglLineBuffer=et.createBuffer(),ot.info.memory.geometries++}function f(e,t){var r=e.vertices.length,n=t.material;if(n.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var i in n.attributes){var o=n.attributes[i];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var s=1;"v2"===o.type?s=2:"v3"===o.type?s=3:"v4"===o.type?s=4:"c"===o.type&&(s=3),o.size=s,o.array=new Float32Array(r*s),o.buffer=et.createBuffer(),o.buffer.belongsToAttribute=i,o.needsUpdate=!0}e.__webglCustomAttributesList.push(o)}}}function p(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__lineDistanceArray=new Float32Array(1*r),e.__webglLineCount=r,f(e,t)}function m(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__webglPointCount=r,f(e,t)}function g(e,t){var r=t.geometry,n=e.faces3,i=3*n.length,o=1*n.length,s=3*n.length,a=v(t,e),l=x(a),c=_(a),u=b(a);e.__vertexArray=new Float32Array(3*i),c&&(e.__normalArray=new Float32Array(3*i)),r.hasTangents&&(e.__tangentArray=new Float32Array(4*i)),u&&(e.__colorArray=new Float32Array(3*i)),l&&(r.faceVertexUvs.length>0&&(e.__uvArray=new Float32Array(2*i)),r.faceVertexUvs.length>1&&(e.__uv2Array=new Float32Array(2*i))),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*i),e.__skinWeightArray=new Float32Array(4*i));var d=(tt||Dt.get("OES_element_index_uint"))&&o>21845?Uint32Array:Uint16Array;if(e.__typeArray=d,e.__faceArray=new d(3*o),e.__lineArray=new d(2*s),e.__webglFaceCount=3*o,e.__webglLineCount=2*s,a.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var h in a.attributes){var f=a.attributes[h],p={};for(var m in f)p[m]=f[m];if(!p.__webglInitialized||p.createUniqueBuffers){p.__webglInitialized=!0;var g=1;"v2"===p.type?g=2:"v3"===p.type?g=3:"v4"===p.type?g=4:"c"===p.type&&(g=3),p.size=g,p.array=new Float32Array(i*g),p.buffer=et.createBuffer(),p.buffer.belongsToAttribute=h,f.needsUpdate=!0,p.__original=f}e.__webglCustomAttributesList.push(p)}}e.__inittedArrays=!0}function v(e,t){return e.material instanceof a.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function y(e){return e&&void 0!==e.shading&&e.shading===a.SmoothShading}function _(e){return e instanceof a.MeshBasicMaterial&&!e.envMap||e instanceof a.MeshDepthMaterial?!1:y(e)?a.SmoothShading:a.FlatShading}function b(e){return e.vertexColors?e.vertexColors:!1}function x(e){return e.map||e.lightMap||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e instanceof a.ShaderMaterial?!0:!1}function w(e,t){var r,n,i,o,s,a,l,c,u,d,h,f,p=e.vertices,m=e.colors,g=e.lineDistances,v=p.length,y=m.length,_=g.length,b=e.__vertexArray,x=e.__colorArray,w=e.__lineDistanceArray,E=e.verticesNeedUpdate,S=e.colorsNeedUpdate,A=e.lineDistancesNeedUpdate,M=e.__webglCustomAttributesList;if(E){for(r=0;v>r;r++)o=p[r],s=3*r,b[s]=o.x,b[s+1]=o.y,b[s+2]=o.z;et.bindBuffer(et.ARRAY_BUFFER,e.__webglVertexBuffer),et.bufferData(et.ARRAY_BUFFER,b,t)}if(S){for(n=0;y>n;n++)a=m[n],s=3*n,x[s]=a.r,x[s+1]=a.g,x[s+2]=a.b;et.bindBuffer(et.ARRAY_BUFFER,e.__webglColorBuffer),et.bufferData(et.ARRAY_BUFFER,x,t)}if(A){for(i=0;_>i;i++)w[i]=g[i];et.bindBuffer(et.ARRAY_BUFFER,e.__webglLineDistanceBuffer),et.bufferData(et.ARRAY_BUFFER,w,t)}if(M)for(l=0,c=M.length;c>l;l++)if(f=M[l],f.needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo)){if(s=0,d=f.value.length,1===f.size)for(u=0;d>u;u++)f.array[u]=f.value[u];else if(2===f.size)for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.x,f.array[s+1]=h.y,s+=2;else if(3===f.size)if("c"===f.type)for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.r,f.array[s+1]=h.g,f.array[s+2]=h.b,s+=3;else for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.x,f.array[s+1]=h.y,f.array[s+2]=h.z,s+=3;else if(4===f.size)for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.x,f.array[s+1]=h.y,f.array[s+2]=h.z,f.array[s+3]=h.w,s+=4;et.bindBuffer(et.ARRAY_BUFFER,f.buffer),et.bufferData(et.ARRAY_BUFFER,f.array,t)}}function E(e,t){var r,n,i,o,s,a,l,c,u,d,h,f=e.vertices,p=e.colors,m=f.length,g=p.length,v=e.__vertexArray,y=e.__colorArray,_=e.verticesNeedUpdate,b=e.colorsNeedUpdate,x=e.__webglCustomAttributesList;if(_){for(r=0;m>r;r++)i=f[r],o=3*r,v[o]=i.x,v[o+1]=i.y,v[o+2]=i.z;et.bindBuffer(et.ARRAY_BUFFER,e.__webglVertexBuffer),et.bufferData(et.ARRAY_BUFFER,v,t)}if(b){for(n=0;g>n;n++)s=p[n],o=3*n,y[o]=s.r,y[o+1]=s.g,y[o+2]=s.b;et.bindBuffer(et.ARRAY_BUFFER,e.__webglColorBuffer),et.bufferData(et.ARRAY_BUFFER,y,t)}if(x)for(a=0,l=x.length;l>a;a++)if(h=x[a],h.needsUpdate&&(void 0===h.boundTo||"vertices"===h.boundTo)){if(o=0,u=h.value.length,1===h.size)for(c=0;u>c;c++)h.array[c]=h.value[c];else if(2===h.size)for(c=0;u>c;c++)d=h.value[c],h.array[o]=d.x,h.array[o+1]=d.y,o+=2;else if(3===h.size)if("c"===h.type)for(c=0;u>c;c++)d=h.value[c],h.array[o]=d.r,h.array[o+1]=d.g,h.array[o+2]=d.b,o+=3;else for(c=0;u>c;c++)d=h.value[c],h.array[o]=d.x,h.array[o+1]=d.y,h.array[o+2]=d.z,o+=3;else if(4===h.size)for(c=0;u>c;c++)d=h.value[c],h.array[o]=d.x,h.array[o+1]=d.y,h.array[o+2]=d.z,h.array[o+3]=d.w,o+=4;et.bindBuffer(et.ARRAY_BUFFER,h.buffer),et.bufferData(et.ARRAY_BUFFER,h.array,t)}}function S(e,t,r,n,i){if(e.__inittedArrays){var o,s,l,c,u,d,h,f,p,m,g,v,y,w,E,S,A,M,T,C,j,P,L,D,I,R,O,k=_(i),N=b(i),F=x(i),V=k===a.SmoothShading,U=0,B=0,z=0,G=0,H=0,W=0,q=0,X=0,Y=0,K=0,Q=e.__vertexArray,Z=e.__uvArray,J=e.__uv2Array,$=e.__normalArray,ee=e.__tangentArray,te=e.__colorArray,re=e.__webglCustomAttributesList,ne=e.__faceArray,ie=e.__lineArray,oe=t.geometry,se=oe.verticesNeedUpdate,ae=oe.elementsNeedUpdate,le=oe.uvsNeedUpdate,ce=oe.normalsNeedUpdate,ue=oe.tangentsNeedUpdate,de=oe.colorsNeedUpdate,he=oe.vertices,fe=e.faces3,pe=oe.faces,me=oe.faceVertexUvs[0],ge=oe.faceVertexUvs[1];if(se){for(o=0,s=fe.length;s>o;o++)c=pe[fe[o]],v=he[c.a],y=he[c.b],w=he[c.c],Q[B]=v.x,Q[B+1]=v.y,Q[B+2]=v.z,Q[B+3]=y.x,Q[B+4]=y.y,Q[B+5]=y.z,Q[B+6]=w.x,Q[B+7]=w.y,Q[B+8]=w.z,B+=9;et.bindBuffer(et.ARRAY_BUFFER,e.__webglVertexBuffer),et.bufferData(et.ARRAY_BUFFER,Q,r)}if(de&&N){for(o=0,s=fe.length;s>o;o++)c=pe[fe[o]],h=c.vertexColors,f=c.color,3===h.length&&N===a.VertexColors?(M=h[0],T=h[1],C=h[2]):(M=f,T=f,C=f),te[Y]=M.r,te[Y+1]=M.g,te[Y+2]=M.b,te[Y+3]=T.r,te[Y+4]=T.g,te[Y+5]=T.b,te[Y+6]=C.r,te[Y+7]=C.g,te[Y+8]=C.b,Y+=9;Y>0&&(et.bindBuffer(et.ARRAY_BUFFER,e.__webglColorBuffer),et.bufferData(et.ARRAY_BUFFER,te,r))}if(ue&&oe.hasTangents){for(o=0,s=fe.length;s>o;o++)c=pe[fe[o]],p=c.vertexTangents,E=p[0],S=p[1],A=p[2],ee[q]=E.x,ee[q+1]=E.y,ee[q+2]=E.z,ee[q+3]=E.w,ee[q+4]=S.x,ee[q+5]=S.y,ee[q+6]=S.z,ee[q+7]=S.w,ee[q+8]=A.x,ee[q+9]=A.y,ee[q+10]=A.z,ee[q+11]=A.w,q+=12;et.bindBuffer(et.ARRAY_BUFFER,e.__webglTangentBuffer),et.bufferData(et.ARRAY_BUFFER,ee,r)}if(ce&&k){for(o=0,s=fe.length;s>o;o++)if(c=pe[fe[o]],u=c.vertexNormals,d=c.normal,3===u.length&&V)for(j=0;3>j;j++)L=u[j],$[W]=L.x,$[W+1]=L.y,$[W+2]=L.z,W+=3;else for(j=0;3>j;j++)$[W]=d.x,$[W+1]=d.y,$[W+2]=d.z,W+=3;et.bindBuffer(et.ARRAY_BUFFER,e.__webglNormalBuffer),et.bufferData(et.ARRAY_BUFFER,$,r)}if(le&&me&&F){for(o=0,s=fe.length;s>o;o++)if(l=fe[o],m=me[l],void 0!==m)for(j=0;3>j;j++)D=m[j],Z[z]=D.x,Z[z+1]=D.y,z+=2;z>0&&(et.bindBuffer(et.ARRAY_BUFFER,e.__webglUVBuffer),et.bufferData(et.ARRAY_BUFFER,Z,r))}if(le&&ge&&F){for(o=0,s=fe.length;s>o;o++)if(l=fe[o],g=ge[l],void 0!==g)for(j=0;3>j;j++)I=g[j],J[G]=I.x,J[G+1]=I.y,G+=2;G>0&&(et.bindBuffer(et.ARRAY_BUFFER,e.__webglUV2Buffer),et.bufferData(et.ARRAY_BUFFER,J,r))}if(ae){for(o=0,s=fe.length;s>o;o++)ne[H]=U,ne[H+1]=U+1,ne[H+2]=U+2,H+=3,ie[X]=U,ie[X+1]=U+1,ie[X+2]=U,ie[X+3]=U+2,ie[X+4]=U+1,ie[X+5]=U+2,X+=6,U+=3;et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),et.bufferData(et.ELEMENT_ARRAY_BUFFER,ne,r),et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),et.bufferData(et.ELEMENT_ARRAY_BUFFER,ie,r)}if(re)for(j=0,P=re.length;P>j;j++)if(O=re[j],O.__original.needsUpdate){if(K=0,1===O.size){if(void 0===O.boundTo||"vertices"===O.boundTo)for(o=0,s=fe.length;s>o;o++)c=pe[fe[o]],O.array[K]=O.value[c.a],O.array[K+1]=O.value[c.b],O.array[K+2]=O.value[c.c],K+=3;else if("faces"===O.boundTo)for(o=0,s=fe.length;s>o;o++)R=O.value[fe[o]],O.array[K]=R,O.array[K+1]=R,O.array[K+2]=R,K+=3}else if(2===O.size){if(void 0===O.boundTo||"vertices"===O.boundTo)for(o=0,s=fe.length;s>o;o++)c=pe[fe[o]],v=O.value[c.a],y=O.value[c.b],w=O.value[c.c],O.array[K]=v.x,O.array[K+1]=v.y,O.array[K+2]=y.x,O.array[K+3]=y.y,O.array[K+4]=w.x,O.array[K+5]=w.y,K+=6;else if("faces"===O.boundTo)for(o=0,s=fe.length;s>o;o++)R=O.value[fe[o]],v=R,y=R,w=R,O.array[K]=v.x,O.array[K+1]=v.y,O.array[K+2]=y.x,O.array[K+3]=y.y,O.array[K+4]=w.x,O.array[K+5]=w.y,K+=6}else if(3===O.size){var ve;if(ve="c"===O.type?["r","g","b"]:["x","y","z"],void 0===O.boundTo||"vertices"===O.boundTo)for(o=0,s=fe.length;s>o;o++)c=pe[fe[o]],v=O.value[c.a],y=O.value[c.b],w=O.value[c.c],O.array[K]=v[ve[0]],O.array[K+1]=v[ve[1]],O.array[K+2]=v[ve[2]],O.array[K+3]=y[ve[0]],O.array[K+4]=y[ve[1]],O.array[K+5]=y[ve[2]],O.array[K+6]=w[ve[0]],O.array[K+7]=w[ve[1]],O.array[K+8]=w[ve[2]],K+=9;else if("faces"===O.boundTo)for(o=0,s=fe.length;s>o;o++)R=O.value[fe[o]],v=R,y=R,w=R,O.array[K]=v[ve[0]],O.array[K+1]=v[ve[1]],O.array[K+2]=v[ve[2]],O.array[K+3]=y[ve[0]],O.array[K+4]=y[ve[1]],O.array[K+5]=y[ve[2]],O.array[K+6]=w[ve[0]],O.array[K+7]=w[ve[1]],O.array[K+8]=w[ve[2]],K+=9;else if("faceVertices"===O.boundTo)for(o=0,s=fe.length;s>o;o++)R=O.value[fe[o]],v=R[0],y=R[1],w=R[2],O.array[K]=v[ve[0]],O.array[K+1]=v[ve[1]],O.array[K+2]=v[ve[2]],O.array[K+3]=y[ve[0]],O.array[K+4]=y[ve[1]],O.array[K+5]=y[ve[2]],O.array[K+6]=w[ve[0]],O.array[K+7]=w[ve[1]],O.array[K+8]=w[ve[2]],K+=9}else if(4===O.size)if(void 0===O.boundTo||"vertices"===O.boundTo)for(o=0,s=fe.length;s>o;o++)c=pe[fe[o]],v=O.value[c.a],y=O.value[c.b],w=O.value[c.c],O.array[K]=v.x,O.array[K+1]=v.y,O.array[K+2]=v.z,O.array[K+3]=v.w,O.array[K+4]=y.x,O.array[K+5]=y.y,O.array[K+6]=y.z,O.array[K+7]=y.w,O.array[K+8]=w.x,O.array[K+9]=w.y,O.array[K+10]=w.z,O.array[K+11]=w.w,K+=12;else if("faces"===O.boundTo)for(o=0,s=fe.length;s>o;o++)R=O.value[fe[o]],v=R,y=R,w=R,O.array[K]=v.x,O.array[K+1]=v.y,O.array[K+2]=v.z,O.array[K+3]=v.w,O.array[K+4]=y.x,O.array[K+5]=y.y,O.array[K+6]=y.z,O.array[K+7]=y.w,O.array[K+8]=w.x,O.array[K+9]=w.y,O.array[K+10]=w.z,O.array[K+11]=w.w,K+=12;else if("faceVertices"===O.boundTo)for(o=0,s=fe.length;s>o;o++)R=O.value[fe[o]],v=R[0],y=R[1],w=R[2],O.array[K]=v.x,O.array[K+1]=v.y,O.array[K+2]=v.z,O.array[K+3]=v.w,O.array[K+4]=y.x,O.array[K+5]=y.y,O.array[K+6]=y.z,O.array[K+7]=y.w,O.array[K+8]=w.x,O.array[K+9]=w.y,O.array[K+10]=w.z,O.array[K+11]=w.w,K+=12;et.bindBuffer(et.ARRAY_BUFFER,O.buffer),et.bufferData(et.ARRAY_BUFFER,O.array,r)}n&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function A(e){if(e.streamingDraw){if(!e.streamingIndex){var t=e.attributes.index;t&&(t.buffer=et.createBuffer(),et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,t.buffer),et.bufferData(et.ELEMENT_ARRAY_BUFFER,t.array||e.ib,et.STATIC_DRAW))}}else{e.vb&&void 0===e.vbbuffer&&(e.vbbuffer=et.createBuffer(),e.vbNeedsUpdate=!0),e.ib&&void 0===e.ibbuffer&&(e.ibbuffer=et.createBuffer(),et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,e.ibbuffer),et.bufferData(et.ELEMENT_ARRAY_BUFFER,e.ib,et.STATIC_DRAW)),e.iblines&&void 0===e.iblinesbuffer&&(e.iblinesbuffer=et.createBuffer(),et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,e.iblinesbuffer),et.bufferData(et.ELEMENT_ARRAY_BUFFER,e.iblines,et.STATIC_DRAW));for(var r=e.attributes,n=e.attributesKeys,i=0,o=n.length;o>i;i++){var s=n[i],a=r[s],l="index"===s;if(a.array&&void 0===a.buffer&&(a.buffer=et.createBuffer(),a.needsUpdate=!0),a.needsUpdate===!0){var c=l?et.ELEMENT_ARRAY_BUFFER:et.ARRAY_BUFFER;et.bindBuffer(c,a.buffer),et.bufferData(c,a.array,et.STATIC_DRAW),a.needsUpdate=!1}}e.vbNeedsUpdate&&(et.bindBuffer(et.ARRAY_BUFFER,e.vbbuffer),et.bufferData(et.ARRAY_BUFFER,e.vb,et.STATIC_DRAW),e.vbNeedsUpdate=!1,e.discardAfterUpload&&(e.vb=null))}}function M(){return tt?et.createVertexArray():it.createVertexArrayOES()}function T(e){tt?et.bindVertexArray(e):it.bindVertexArrayOES(e)}function C(e){tt?et.deleteVertexArray(e):it.deleteVertexArrayOES(e)}function j(e,t,r){tt?et.vertexAttribDivisor(e,t?r||0:0):nt&&nt.vertexAttribDivisorANGLE(e,t?r||0:0)}function P(e,t,r,n,i){tt?et.drawElementsInstanced(e,t,r,n,i):nt.drawElementsInstancedANGLE(e,t,r,n,i)}function L(e,t,r,n){tt?et.drawArraysInstanced(e,t,r,n):nt.drawArraysInstancedANGLE(e,t,r,n)}function D(e,t,r,n){var i;if(!l.USE_VAO||r.streamingDraw)return r.vaos=null,!1;if(!tt&&!it)return r.vaos=null,!1;if(void 0===r.vaos&&(r.vaos=[]),i=M(),r.vaos.push({geomhash:t.id,uv:n,vao:i}),T(i),e.isEdgeMaterial)et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,r.iblinesbuffer);else{var o=r.attributes.index;o&&et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,r.ibbuffer||o.buffer)}for(var s=null,a=t.attributes,c=t.attributesKeys,u=r.vbstride,d=r.offsets&&r.offsets.length?r.offsets[0].index:0,h=r.offsets&&r.offsets.length?r.offsets[0].instanceStart||0:0,f=0,p=c.length;p>f;f++){var m=c[f],g=a[m];if(g>=0){var v=r.attributes[m];if("uv"===m&&n&&(v=r.attributes["uv"+(n+1)]),!v){T(null);for(var y=0;y<r.vaos.length;y++)C(r.vaos[y].vao);return r.vaos=null,!1}var _=et.FLOAT,b=v.bytesPerItem||4;1===b?_=et.UNSIGNED_BYTE:2===b&&(_=et.UNSIGNED_SHORT),et.enableVertexAttribArray(g);var x=d;v.divisor&&(x+=h),void 0!==v.itemOffset?(s!=r.vbbuffer&&(et.bindBuffer(et.ARRAY_BUFFER,r.vbbuffer),s=r.vbbuffer),et.vertexAttribPointer(g,v.itemSize,_,!!v.normalize,4*u,4*(v.itemOffset+x*u))):(et.bindBuffer(et.ARRAY_BUFFER,v.buffer),s=v.buffer,et.vertexAttribPointer(g,v.itemSize,_,!!v.normalize,0,x*v.itemSize*b)),j(g,r.numInstances,v.divisor)}}return!0}function I(e,t,r,n){var i=r.vaos;if(i)for(var o=0,s=i.length;s>o;o++){var a=i[o];if(a.geomhash===t.id&&a.uv===n)return T(a.vao),!0}else if(null===i)return!1;return D(e,t,r,n)}function R(e,t){var r=bt[e];return r||(r=et.createBuffer(),bt[e]=r),et.bindBuffer(et.ARRAY_BUFFER,r),et.bufferData(et.ARRAY_BUFFER,t,et.DYNAMIC_DRAW),r}function O(e,t,r,n,i,o,s){var a,l=t.attributes,c=t.attributesKeys,u=0;if(i)if(!i.buffer&&r.streamingDraw){var d=bt.index;d||(d=et.createBuffer(),bt.index=d),et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,d),e.isEdgeMaterial?et.bufferData(et.ELEMENT_ARRAY_BUFFER,r.iblines,et.DYNAMIC_DRAW):et.bufferData(et.ELEMENT_ARRAY_BUFFER,i.array||r.ib,et.DYNAMIC_DRAW)}else e.isEdgeMaterial?et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,r.iblinesbuffer):et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,r.ibbuffer||i.buffer);for(var h=0,f=c.length;f>h;h++){var p=c[h],m=l[p];if(m>=0){var g=r.attributes[p];if("uv"===p&&o&&(g=r.attributes["uv"+(o+1)]),g){var v,y,_=void 0!==g.itemOffset;_?(v=r.vbstride,y=g.itemOffset,u!==a&&(r.streamingDraw?u=R("interleavedVB",r.vb):(u=r.vbbuffer,et.bindBuffer(et.ARRAY_BUFFER,u)),a=u)):(v=g.itemSize,y=0,r.streamingDraw?u=R(p,g.array):(u=g.buffer,et.bindBuffer(et.ARRAY_BUFFER,u)));var b=et.FLOAT,x=g.bytesPerItem||4;1===x?b=et.UNSIGNED_BYTE:2===x&&(b=et.UNSIGNED_SHORT),_&&(x=4),Lt.enableAttribute(m);var w=n;g.divisor&&(w+=s),et.vertexAttribPointer(m,g.itemSize,b,g.normalize,v*x,(y+w*v)*x),j(m,r.numInstances,g.divisor)}else if(e.defaultAttributeValues){var E=e.defaultAttributeValues[p];E&&2===E.length?et.vertexAttrib2fv(m,e.defaultAttributeValues[p]):E&&3===E.length?et.vertexAttrib3fv(m,e.defaultAttributeValues[p]):E&&4===E.length&&et.vertexAttrib4fv(m,e.defaultAttributeValues[p])}}}Lt.disableUnusedAttributes()}function k(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?e.z-t.z:e.id-t.id}function N(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?t.z-e.z:e.id-t.id}function F(e){U(e,!0)}function V(e){U(e,!1)}function U(e,t,r){var n,i;if(r||e.visible!==!1){if(e instanceof a.Scene||e instanceof a.Group);else if(e instanceof o.RenderBatch)e.forEach(t?F:V);else if(Y(e),e instanceof a.Light)qe.push(e);else{var s=Xe[e.id];if(s&&(e.frustumCulled===!1||xt.intersectsObject(e)===!0))for(n=0,i=s.length;i>n;n++){var l=s[n];X(l),l.render=!0,t===!0&&(St.setFromMatrixPosition(e.matrixWorld),St.applyProjection(wt),l.z=St.z)}}if(e.children)for(n=0,i=e.children.length;i>n;n++)U(e.children[n],t,r)}}function B(e,t){if(!t.getCustomOverrideMaterial)return t;var r=t.getCustomOverrideMaterial(e);return r?r:t}function z(e,t,r,n,i){for(var o,s=0,l=e.length;l>s;s++){var c=e[s],u=c.object,d=c.buffer;if(i)o=B(c.material,i);else{if(o=c.material,!o)continue;ie(o)}if(o.twoPassTransparency){var h=o.side;o.side=a.BackSide,G(o,t,r,n,d,i,u),o.side=a.FrontSide,G(o,t,r,n,d,i,u),o.side=h}else G(o,t,r,n,d,i,u)}}function G(e,t,r,n,i,o,s){if(ot.setMaterialFaces(e),i instanceof a.BufferGeometry?ot.renderBufferDirect(t,r,n,e,i,s):ot.renderBuffer(t,r,n,e,i,s),e.decals)for(var l=e.decals,c=0,u=l.length;u>c;c++){var d=l[c];e=d.material,ie(e),ot.setMaterialFaces(e),i instanceof a.BufferGeometry&&ot.renderBufferDirect(t,r,n,e,i,s,d.uv)}}function H(e,t){if(e.visible&&!e.hide){var r;if(hr)r=B(e.material,hr);else{if(r=e.material,!r)return;ie(r)}if(r.twoPassTransparency){var n=r.side;r.side=a.BackSide,W(e,r),r.side=a.FrontSide,W(e,r),r.side=n}else W(e,r)}}function W(e,t){if(ot.setMaterialFaces(t),ot.renderBufferDirect(cr,ur,dr,t,e.geometry,e),t.decals)for(var r=t.decals,n=0,i=r.length;i>n;n++){var o=r[n];t=o.material,ie(t),ot.setMaterialFaces(t),ot.renderBufferDirect(cr,ur,dr,t,e.geometry,e,o.uv)}}function q(e,t,r,n,i,o){cr=r,ur=n,dr=i,hr=o||null,e.forEach(H,e.forceVisible?1:32,!1)}function X(e){var t=e.object,r=e.buffer,n=t.geometry,i=t.material;if(i instanceof a.MeshFaceMaterial){var o=n instanceof a.BufferGeometry?0:r.materialIndex;i=i.materials[o],e.material=i,i.transparent?Je.push(e):Ze.push(e)}else i&&(e.material=i,i.transparent?Je.push(e):Ze.push(e))}function Y(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("removed",$t));var n=e.geometry;if(void 0===n||void 0===n.__webglInit&&(n.__webglInit=!0,n.addEventListener("dispose",er),n instanceof a.BufferGeometry||(e instanceof a.Mesh?Q(e,n):e instanceof a.Line?void 0===n.__webglVertexBuffer&&(t(n),p(n,e),n.verticesNeedUpdate=!0,n.colorsNeedUpdate=!0,n.lineDistancesNeedUpdate=!0):e instanceof a.PointCloud&&void 0===n.__webglVertexBuffer&&(r(n),m(n,e),n.verticesNeedUpdate=!0,n.colorsNeedUpdate=!0))),void 0===e.__webglActive)if(e.__webglActive=!0,e instanceof a.Mesh){if(n instanceof a.BufferGeometry)Z(Xe,n,e);else if(n instanceof a.Geometry)for(var i=fr[n.id],o=0,s=i.length;s>o;o++)Z(Xe,i[o],e)}else(e instanceof a.Line||e instanceof a.PointCloud)&&Z(Xe,n,e)}function K(e,t){for(var r,n,i=tt||Dt.get("OES_element_index_uint")?4294967296:65535,o={},s=e.morphTargets?e.morphTargets.length:0,a=e.morphNormals?e.morphNormals.length:0,l={},c=[],u=0,d=e.faces.length;d>u;u++){var h=e.faces[u],f=t?h.materialIndex:0;f in o||(o[f]={hash:f,counter:0}),r=o[f].hash+"_"+o[f].counter,r in l||(n={id:pr++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:s,numMorphNormals:a},l[r]=n,c.push(n)),l[r].vertices+3>i&&(o[f].counter+=1,r=o[f].hash+"_"+o[f].counter,r in l||(n={id:pr++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:s,numMorphNormals:a},l[r]=n,c.push(n))),l[r].faces3.push(u),l[r].vertices+=3}return c}function Q(e,t){var r=e.material,n=!1;(void 0===fr[t.id]||t.groupsNeedUpdate===!0)&&(delete Xe[e.id],fr[t.id]=K(t,r instanceof a.MeshFaceMaterial),t.groupsNeedUpdate=!1);for(var i=fr[t.id],o=0,s=i.length;s>o;o++){var l=i[o];void 0===l.__webglVertexBuffer?(h(l),g(l,e),t.verticesNeedUpdate=!0,t.morphTargetsNeedUpdate=!0,t.elementsNeedUpdate=!0,t.uvsNeedUpdate=!0,t.normalsNeedUpdate=!0,t.tangentsNeedUpdate=!0,t.colorsNeedUpdate=!0,n=!0):n=!1,(n||void 0===e.__webglActive)&&Z(Xe,l,e)}e.__webglActive=!0}function Z(e,t,r){var n=r.id;e[n]=e[n]||[],e[n].push({id:n,buffer:t,object:r,material:null,z:0})}function J(e){var t,r,n=e.geometry;if(n instanceof a.BufferGeometry)A(n);else if(e instanceof a.Mesh){n.groupsNeedUpdate===!0&&Q(e,n);for(var i=fr[n.id],o=0,s=i.length;s>o;o++){var l=i[o];r=v(e,l),t=r.attributes&&$(r),(n.verticesNeedUpdate||n.morphTargetsNeedUpdate||n.elementsNeedUpdate||n.uvsNeedUpdate||n.normalsNeedUpdate||n.colorsNeedUpdate||n.tangentsNeedUpdate||t)&&S(l,e,et.DYNAMIC_DRAW,!n.dynamic,r)}n.verticesNeedUpdate=!1,n.morphTargetsNeedUpdate=!1,n.elementsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.tangentsNeedUpdate=!1,r.attributes&&ee(r)}else e instanceof a.Line?(r=v(e,n),t=r.attributes&&$(r),(n.verticesNeedUpdate||n.colorsNeedUpdate||n.lineDistancesNeedUpdate||t)&&w(n,et.DYNAMIC_DRAW),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,n.lineDistancesNeedUpdate=!1,r.attributes&&ee(r)):e instanceof a.PointCloud&&(r=v(e,n),t=r.attributes&&$(r),(n.verticesNeedUpdate||n.colorsNeedUpdate||t)&&E(n,et.DYNAMIC_DRAW),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,r.attributes&&ee(r))}function $(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function ee(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function te(e){(e instanceof a.Mesh||e instanceof a.PointCloud||e instanceof a.Line)&&delete Xe[e.id],delete e.__webglInit,delete e.__webglActive}function re(e,t){if(t.textureMaps)for(var r=0;r<n.PrismMaps.length;r++){var i=n.PrismMaps[r],o=t.textureMaps[i+"_map"];if(o){var s=o.textureObj.properties.booleans;e[i]={S:!s.texture_URepeat.values[0],T:!s.texture_VRepeat.values[0]}}}}function ne(e,t,r,i){e.addEventListener("dispose",nr);var o=mr[e.type];if(o){var s=a.ShaderLib[o];e.__webglShader={uniforms:a.UniformsUtils.clone(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}}else e.__webglShader={
uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};var l=Ie(t),c={precision:ke,precisionFragment:Ne,supportsVertexTextures:Ut,haveTextureLod:tt||!!Dt.get("EXT_shader_texture_lod"),loadingAnimationDuration:$e,map:!!e.map,envMap:!!e.envMap,irradianceMap:!!e.irradianceMap,envIsSpherical:e.envMap&&e.envMap.mapping==a.SphericalReflectionMapping,envGammaEncoded:e.envMap&&e.envMap.GammaEncoded,irrGammaEncoded:e.irradianceMap&&e.irradianceMap.GammaEncoded,envRGBM:e.envMap&&e.envMap.RGBM,irrRGBM:e.irradianceMap&&e.irradianceMap.RGBM,lightMap:!!e.lightMap,bumpMap:(tt||Dt.get("OES_standard_derivatives"))&&!!e.bumpMap,normalMap:(tt||Dt.get("OES_standard_derivatives"))&&!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,vertexColors:e.vertexColors,vertexIds:e.vertexIds,useInstancing:e.useInstancing,wideLines:e.wideLines,fog:r,useFog:e.fog,sizeAttenuation:e.sizeAttenuation,maxDirLights:l.directional,maxPointLights:l.point,maxSpotLights:l.spot,maxHemiLights:l.hemi,alphaTest:e.alphaTest,metal:e.metal,clearcoat:e.clearcoat,wrapAround:e.wrapAround,doubleSided:e.side===a.DoubleSide,flipSided:e.side===a.BackSide,mrtNormals:e.mrtNormals,mrtIdBuffer:e.mrtIdBuffer,vertexPrefix:ft,fragmentPrefix:pt,tonemapOutput:e.tonemapOutput,packedNormals:e.packedNormals,hatchPattern:!!e.hatchParams,numCutplanes:e.cutplanes?e.cutplanes.length:0,useTiling:e.useTiling,tilingRepeatRange:e.useTiling&&e.tilingRepeatRange,hasRoundCorner:e.hasRoundCorner,useRandomOffset:e.useRandomOffset,mapInvert:e.map&&e.map.invert,mapClampS:e.map&&e.map.clampS,mapClampT:e.map&&e.map.clampT,bumpMapClampS:e.bumpMap&&e.bumpMap.clampS,bumpMapClampT:e.bumpMap&&e.bumpMap.clampT,normalMapClampS:e.normalMap&&e.normalMap.clampS,normalMapClampT:e.normalMap&&e.normalMap.clampT,specularMapClampS:e.specularMap&&e.specularMap.clampS,specularMapClampT:e.specularMap&&e.specularMap.clampT,alphaMapInvert:e.alphaMap&&e.alphaMap.invert,alphaMapClampS:e.alphaMap&&e.alphaMap.clampS,alphaMapClampT:e.alphaMap&&e.alphaMap.clampT};e.isPrismMaterial&&(re(c,e),c.isPrism=!0);var u=[];o?u.push(o):(u.push(e.fragmentShader),u.push(e.vertexShader));for(var d in e.defines)u.push(d),u.push(e.defines[d]);var h,f;for(h in c)u.push(h),u.push(c[h]);var p,m=u.join();for(h=0,f=st.length;f>h;h++){var g=st[h];if(g.code===m){p=g,p.usedTimes++;break}}void 0===p&&(p=new n.WebGLProgram(ot,m,e,c),st.push(p),ot.info.memory.programs=st.length),e.programs||(e.programs=[]),e.programs[ht]=p,e.uniformsLists||(e.uniformsLists=[]),e.uniformsList=e.uniformsLists[ht]=[];for(var v in e.__webglShader.uniforms){var y=p.uniforms[v];y&&e.uniformsList.push([e.__webglShader.uniforms[v],y])}}function ie(e){e.transparent===!0?Lt.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha):Lt.setBlending(a.NoBlending),Lt.setDepthTest(e.depthTest),Lt.setDepthWrite(e.depthWrite),Lt.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function oe(e,t,r,n,o){mt=0,n.needsUpdate?(n.program&&lr(n),ne(n,t,r,o),n.needsUpdate=!1):n.programs[ht]||ne(n,t,r,o);var s=!1,l=!1,c=!1;n.uniformsList=n.uniformsLists[ht];var d=n.program=n.programs[ht],h=d.uniforms,f=n.__webglShader.uniforms;if(d.id!==at&&(et.useProgram(d.program),at=d.id,s=!0,l=!0,c=!0),n.id!==ct&&(-1===ct&&(c=!0),ct=n.id,l=!0),h.meshAnimTime){var p=1;o.geometry.creationTime&&$e>0&&(p=Math.min((Qe-o.geometry.creationTime)/$e,1)),et.uniform1f(h.meshAnimTime,p)}if((s||e!==ut)&&(et.uniformMatrix4fv(h.projectionMatrix,!1,e.projectionMatrix.elements),e!==ut&&(ut=e),(n instanceof a.ShaderMaterial||n instanceof a.MeshPhongMaterial||n.isPrismMaterial||n.envMap)&&null!==h.cameraPosition&&(St.setFromMatrixPosition(e.matrixWorld),et.uniform3f(h.cameraPosition,St.x,St.y,St.z)),(n instanceof a.MeshPhongMaterial||n instanceof a.MeshLambertMaterial||n instanceof a.ShaderMaterial||n.isPrismMaterial||n.skinning)&&(null!==h.viewMatrix&&et.uniformMatrix4fv(h.viewMatrix,!1,e.matrixWorldInverse.elements),null!==h.viewMatrixInverse&&et.uniformMatrix4fv(h.viewMatrixInverse,!1,Et.elements),h.mvpMatrix&&et.uniformMatrix4fv(h.mvpMatrix,!1,wt.elements),c?(ue(f,n),de(f,!0)):de(f,!1))),h.unpackXform){var m=o.geometry,g=m.unpackXform;if(g?et.uniform4f(h.unpackXform,g.x,g.y,g.z,g.w):et.uniform4f(h.unpackXform,1,1,0,0),h.tIdColor){et.uniform2f(h.vIdColorTexSize,m.vIdColorTexSize.x,m.vIdColorTexSize.y);var v=ye();et.uniform1i(h.tIdColor,v),ot.setTexture(m.tIdColor,v)}}if(l){if((n instanceof a.MeshPhongMaterial||n instanceof a.MeshLambertMaterial||n.isPrismMaterial||n.lights)&&(Mt&&(c=!0,xe(t),Mt=!1),c?(me(f,Tt),ge(f,!0)):ge(f,!1)),(n instanceof a.MeshBasicMaterial||n instanceof a.MeshLambertMaterial||n instanceof a.MeshPhongMaterial)&&(se(f,n),ue(f,n)),n instanceof a.PointCloudMaterial?ae(f,n):n instanceof a.LineBasicMaterial?le(f,n):n instanceof a.LineDashedMaterial?(le(f,n),ce(f,n)):n instanceof a.MeshPhongMaterial?he(f,n):n instanceof a.MeshLambertMaterial?pe(f,n):n instanceof a.MeshDepthMaterial?(f.mNear.value=e.near,f.mFar.value=e.far,f.opacity.value=n.opacity):n instanceof a.MeshNormalMaterial?f.opacity.value=n.opacity:n.isPrismMaterial?(fe(f,n),ue(f,n)):"function"==typeof n.refreshUniforms&&n.refreshUniforms(f),n.wideLines){var y=o.geometry.lineWidth;void 0!==n.linewidth&&(y=n.linewidth),f.view_size.value=new a.Vector2(u.innerWidth/y,u.innerHeight/y)}i.ShadowRender&&n.shadowMap&&i.ShadowRender.RefreshUniformsShadow(f,n);var _=f.cutplanes;n.cutplanes&&n.cutplanes.length>0&&_&&(_.value=n.cutplanes,_._array&&_._array.length!=4*n.cutplanes&&(_._array=void 0)),n.hatchParams&&f.hatchParams&&(f.hatchParams.value.copy(n.hatchParams),f.hatchTintColor.value.copy(n.hatchTintColor),f.hatchTintIntensity.value=n.hatchTintIntensity),_e(n.uniformsList)}ve(h,o,e);var b;if(h.modelId){h.dbId&&(b=o.dbId||o.fragId||0,et.uniform3f(h.dbId,(255&b)/255,(b>>8&255)/255,(b>>16&255)/255));var x=o.modelId;et.uniform3f(h.modelId,(255&x)/255,(x>>8&255)/255,(b>>24&255)/255)}else null!==h.dbId&&(b=o.dbId||o.fragId||0,et.uniform3f(h.dbId,(255&b)/255,(b>>8&255)/255,(b>>16&255)/255));if(h.themingColor){var w=o.themingColor;w instanceof a.Vector4?et.uniform4f(h.themingColor,w.x,w.y,w.z,w.w):et.uniform4f(h.themingColor,0,0,0,0)}return d}function se(e,t){function r(e,t,r){var n=r.offset,i=r.repeat;if(t){var o=t.value;r.matrix?o.copy(r.matrix):o.identity(),o.elements[6]+=n.x,o.elements[7]+=n.y,o.elements[0]*=i.x,o.elements[3]*=i.x,o.elements[1]*=i.y,o.elements[4]*=i.y}else e.offsetRepeat.value.set(n.x,n.y,i.x,i.y)}e.opacity.value=t.opacity,e.diffuse.value.copy(t.color),e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.alphaMap&&r(e,e.texMatrixAlpha,t.alphaMap);var n;t.normalMap?n=t.normalMap:t.bumpMap&&(n=t.bumpMap),void 0!==n&&r(e,e.texMatrixBump,n);var i;t.map?i=t.map:t.specularMap&&(i=t.specularMap),void 0!==i&&r(e,e.texMatrix,i),e.envMap.value=t.envMap,e.irradianceMap&&(e.irradianceMap.value=t.irradianceMap),e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}function ae(e,t){le(e,t),e.point_size.value=t.size}function le(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function ce(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function ue(e,t){e.envMap&&(e.envMap.value=t.envMap),e.irradianceMap&&(e.irradianceMap.value=t.irradianceMap),e.envMapExposure&&(e.envMapExposure.value=t.envMapExposure),e.envRotationSin&&e.envRotationCos&&(e.envRotationSin.value=t.envRotationSin,e.envRotationCos.value=t.envRotationCos)}function de(e,t){e.envMap&&(e.envMap.needsUpdate=t),e.irradianceMap&&(e.irradianceMap.needsUpdate=t),e.envMapExposure&&(e.envMapExposure.needsUpdate=t)}function he(e,t){if(e.shininess.value=t.shininess,e.reflMipIndex){var r=Math.log(Math.max(1+1e-10,t.shininess));e.reflMipIndex.value=Math.max(0,-.72134752*r+5.5)}e.emissive&&e.emissive.value.copy(t.emissive),e.specular.value.copy(t.specular),e.exposureBias&&(e.exposureBias.value=t.exposureBias)}function fe(e,t){function r(e,t,r){e[r].value=t[r],null!=t[r]&&(e[r+"_texMatrix"].value=t[r].matrix,e[r+"_invert"].value=t[r].invert)}function n(e,t,r){e[r].value=t[r],null!=t[r]&&(e[r+"_texMatrix"].value=t[r].matrix,e[r+"_bumpScale"].value=t[r].bumpScale,e[r+"_bumpmapType"].value=t[r].bumpmapType)}switch(e.exposureBias.value=t.exposureBias,e.opacity.value=t.opacity,e.surface_albedo.value=t.surface_albedo,e.surface_roughness.value=t.surface_roughness,e.surface_anisotropy.value=t.surface_anisotropy,e.surface_rotation.value=t.surface_rotation,r(e,t,"surface_albedo_map"),r(e,t,"surface_roughness_map"),r(e,t,"surface_cutout_map"),r(e,t,"surface_anisotropy_map"),r(e,t,"surface_rotation_map"),n(e,t,"surface_normal_map"),t.prismType){case"PrismOpaque":e.opaque_albedo.value=t.opaque_albedo,e.opaque_luminance_modifier.value=t.opaque_luminance_modifier,e.opaque_f0.value=t.opaque_f0,e.opaque_luminance.value=t.opaque_luminance,r(e,t,"opaque_albedo_map"),r(e,t,"opaque_luminance_modifier_map"),r(e,t,"opaque_f0_map");break;case"PrismMetal":e.metal_f0.value=t.metal_f0,r(e,t,"metal_f0_map");break;case"PrismLayered":e.layered_f0.value=t.layered_f0,e.layered_diffuse.value=t.layered_diffuse,e.layered_fraction.value=t.layered_fraction,e.layered_bottom_f0.value=t.layered_bottom_f0,e.layered_roughness.value=t.layered_roughness,e.layered_anisotropy.value=t.layered_anisotropy,e.layered_rotation.value=t.layered_rotation,r(e,t,"layered_bottom_f0_map"),r(e,t,"layered_f0_map"),r(e,t,"layered_diffuse_map"),r(e,t,"layered_fraction_map"),r(e,t,"layered_roughness_map"),r(e,t,"layered_anisotropy_map"),r(e,t,"layered_rotation_map"),n(e,t,"layered_normal_map");break;case"PrismTransparent":e.transparent_color.value=t.transparent_color,e.transparent_distance.value=t.transparent_distance,e.transparent_ior.value=t.transparent_ior;break;case"PrismGlazing":e.glazing_f0.value=t.glazing_f0,e.glazing_transmission_color.value=t.glazing_transmission_color,e.glazing_transmission_roughness.value=t.glazing_transmission_roughness,r(e,t,"glazing_f0_map"),r(e,t,"glazing_transmission_color_map"),r(e,t,"glazing_transmission_roughness_map");break;case"PrismWood":e.wood_fiber_cosine_enable.value=t.wood_fiber_cosine_enable,e.wood_fiber_cosine_bands.value=t.wood_fiber_cosine_bands,e.wood_fiber_cosine_weights.value=t.wood_fiber_cosine_weights,e.wood_fiber_cosine_frequencies.value=t.wood_fiber_cosine_frequencies,e.wood_fiber_perlin_enable.value=t.wood_fiber_perlin_enable,e.wood_fiber_perlin_bands.value=t.wood_fiber_perlin_bands,e.wood_fiber_perlin_weights.value=t.wood_fiber_perlin_weights,e.wood_fiber_perlin_frequencies.value=t.wood_fiber_perlin_frequencies,e.wood_fiber_perlin_scale_z.value=t.wood_fiber_perlin_scale_z,e.wood_growth_perlin_enable.value=t.wood_growth_perlin_enable,e.wood_growth_perlin_bands.value=t.wood_growth_perlin_bands,e.wood_growth_perlin_weights.value=t.wood_growth_perlin_weights,e.wood_growth_perlin_frequencies.value=t.wood_growth_perlin_frequencies,e.wood_latewood_ratio.value=t.wood_latewood_ratio,e.wood_earlywood_sharpness.value=t.wood_earlywood_sharpness,e.wood_latewood_sharpness.value=t.wood_latewood_sharpness,e.wood_ring_thickness.value=t.wood_ring_thickness,e.wood_earlycolor_perlin_enable.value=t.wood_earlycolor_perlin_enable,e.wood_earlycolor_perlin_bands.value=t.wood_earlycolor_perlin_bands,e.wood_earlycolor_perlin_weights.value=t.wood_earlycolor_perlin_weights,e.wood_earlycolor_perlin_frequencies.value=t.wood_earlycolor_perlin_frequencies,e.wood_early_color.value=t.wood_early_color,e.wood_use_manual_late_color.value=t.wood_use_manual_late_color,e.wood_manual_late_color.value=t.wood_manual_late_color,e.wood_latecolor_perlin_enable.value=t.wood_latecolor_perlin_enable,e.wood_latecolor_perlin_bands.value=t.wood_latecolor_perlin_bands,e.wood_latecolor_perlin_weights.value=t.wood_latecolor_perlin_weights,e.wood_latecolor_perlin_frequencies.value=t.wood_latecolor_perlin_frequencies,e.wood_late_color_power.value=t.wood_late_color_power,e.wood_diffuse_perlin_enable.value=t.wood_diffuse_perlin_enable,e.wood_diffuse_perlin_bands.value=t.wood_diffuse_perlin_bands,e.wood_diffuse_perlin_weights.value=t.wood_diffuse_perlin_weights,e.wood_diffuse_perlin_frequencies.value=t.wood_diffuse_perlin_frequencies,e.wood_diffuse_perlin_scale_z.value=t.wood_diffuse_perlin_scale_z,e.wood_use_pores.value=t.wood_use_pores,e.wood_pore_type.value=t.wood_pore_type,e.wood_pore_radius.value=t.wood_pore_radius,e.wood_pore_cell_dim.value=t.wood_pore_cell_dim,e.wood_pore_color_power.value=t.wood_pore_color_power,e.wood_pore_depth.value=t.wood_pore_depth,e.wood_use_rays.value=t.wood_use_rays,e.wood_ray_color_power.value=t.wood_ray_color_power,e.wood_ray_seg_length_z.value=t.wood_ray_seg_length_z,e.wood_ray_num_slices.value=t.wood_ray_num_slices,e.wood_ray_ellipse_z2x.value=t.wood_ray_ellipse_z2x,e.wood_ray_ellipse_radius_x.value=t.wood_ray_ellipse_radius_x,e.wood_use_latewood_bump.value=t.wood_use_latewood_bump,e.wood_latewood_bump_depth.value=t.wood_latewood_bump_depth,e.wood_use_groove_roughness.value=t.wood_use_groove_roughness,e.wood_groove_roughness.value=t.wood_groove_roughness,e.wood_diffuse_lobe_weight.value=t.wood_diffuse_lobe_weight,r(e,t,"wood_curly_distortion_map"),null!=e.wood_curly_distortion_map.value&&(e.wood_curly_distortion_map.value.minFilter=a.NearestFilter,e.wood_curly_distortion_map.value.magFilter=a.NearestFilter,e.wood_curly_distortion_enable.value=t.wood_curly_distortion_enable,e.wood_curly_distortion_scale.value=t.wood_curly_distortion_scale);var i=1-t.wood_latewood_ratio,o=t.wood_earlywood_sharpness*i,s=t.wood_latewood_sharpness*t.wood_latewood_ratio,l=i+s;e.wood_ring_fraction.value=new a.Vector4(i,o,s,l),e.wood_fall_rise.value=new a.Vector2(i-o,t.wood_latewood_ratio-s);break;default:a.warn("Unknown prism type: "+t.prismType)}t.useTiling&&(e.tilingOverallTransform.value=t.tilingOverallTransform,e.TilingMap.value=t.TilingMap,e.TilingMap_texMatrix.value=t.TilingMap_texMatrix,t.hasRoundCorner&&(e.TilingNormalMap.value=t.TilingNormalMap,e.TilingNormalMap_texMatrix.value=t.TilingNormalMap_texMatrix),t.useRandomOffset&&(e.TilingRandomMap.value=t.TilingRandomMap,e.TilingRandomMap_texMatrix.value=t.TilingRandomMap_texMatrix,e.tilingRandomAxisS.value=t.tilingRandomAxisS,e.tilingRandomAxisT.value=t.tilingRandomAxisT,e.tilingRandomAlignmentOffset.value=t.tilingRandomAlignmentOffset),e.uv2tile.value=t.uv2tile,e.tile2uv.value=t.tile2uv,e.tileAlignOffset.value=t.tileAlignOffset,e.tilingUVTransform.value=t.tilingUVTransform),e.envExponentMin.value=t.envExponentMin,e.envExponentMax.value=t.envExponentMax,e.envExponentCount.value=t.envExponentCount}function pe(e,t){e.emissive.value.copy(t.emissive),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function me(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}function ge(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function ve(e,t,r){Ye.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),et.uniformMatrix4fv(e.modelViewMatrix,!1,Ye.elements),e.normalMatrix&&(Ke.getNormalMatrix(Ye),et.uniformMatrix3fv(e.normalMatrix,!1,Ke.elements)),null!==e.modelMatrix&&et.uniformMatrix4fv(e.modelMatrix,!1,t.matrixWorld.elements)}function ye(){var e=mt;return e>=kt&&a.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+kt),mt+=1,e}function _e(e){for(var t,r,n,i=0,o=e.length;o>i;i++){var s=e[i][0];if(s.needsUpdate!==!1&&!s.perObject){var l,c,u=s.type,d=s.value,h=e[i][1];switch(u){case"1i":et.uniform1i(h,d);break;case"1f":et.uniform1f(h,d);break;case"2f":et.uniform2f(h,d[0],d[1]);break;case"3f":et.uniform3f(h,d[0],d[1],d[2]);break;case"4f":et.uniform4f(h,d[0],d[1],d[2],d[3]);break;case"1iv":et.uniform1iv(h,d);break;case"3iv":et.uniform3iv(h,d);break;case"1fv":et.uniform1fv(h,d);break;case"2fv":et.uniform2fv(h,d);break;case"3fv":et.uniform3fv(h,d);break;case"4fv":et.uniform4fv(h,d);break;case"Matrix3fv":et.uniformMatrix3fv(h,!1,d);break;case"Matrix4fv":et.uniformMatrix4fv(h,!1,d);break;case"i":et.uniform1i(h,d);break;case"f":et.uniform1f(h,d);break;case"v2":et.uniform2f(h,d.x,d.y);break;case"v3":et.uniform3f(h,d.x,d.y,d.z);break;case"v4":et.uniform4f(h,d.x,d.y,d.z,d.w);break;case"c":et.uniform3f(h,d.r,d.g,d.b);break;case"iv1":et.uniform1iv(h,d);break;case"iv":et.uniform3iv(h,d);break;case"fv1":et.uniform1fv(h,d);break;case"fv":et.uniform3fv(h,d);break;case"v2v":for(void 0===s._array&&(s._array=new Float32Array(2*d.length)),l=0,c=d.length;c>l;l++)n=2*l,s._array[n]=d[l].x,s._array[n+1]=d[l].y;et.uniform2fv(h,s._array);break;case"v3v":for(void 0===s._array&&(s._array=new Float32Array(3*d.length)),l=0,c=d.length;c>l;l++)n=3*l,s._array[n]=d[l].x,s._array[n+1]=d[l].y,s._array[n+2]=d[l].z;et.uniform3fv(h,s._array);break;case"v4v":for(void 0===s._array&&(s._array=new Float32Array(4*d.length)),l=0,c=d.length;c>l;l++)n=4*l,s._array[n]=d[l].x,s._array[n+1]=d[l].y,s._array[n+2]=d[l].z,s._array[n+3]=d[l].w;et.uniform4fv(h,s._array);break;case"m3":et.uniformMatrix3fv(h,!1,d.elements);break;case"m3v":for(void 0===s._array&&(s._array=new Float32Array(9*d.length)),l=0,c=d.length;c>l;l++)d[l].flattenToArrayOffset(s._array,9*l);et.uniformMatrix3fv(h,!1,s._array);break;case"m4":et.uniformMatrix4fv(h,!1,d.elements);break;case"m4v":for(void 0===s._array&&(s._array=new Float32Array(16*d.length)),l=0,c=d.length;c>l;l++)d[l].flattenToArrayOffset(s._array,16*l);et.uniformMatrix4fv(h,!1,s._array);break;case"t":if(t=d,r=ye(),et.uniform1i(h,r),!t){et.activeTexture(et.TEXTURE0+r),et.bindTexture(et.TEXTURE_2D,Xt.__webglTexture);continue}Array.isArray(t.image)&&6===t.image.length||t instanceof a.CubeTexture?t.needsUpdate?Se(t,r):(et.activeTexture(et.TEXTURE0+r),et.bindTexture(et.TEXTURE_CUBE_MAP,t.__webglTextureCube)):t instanceof a.WebGLRenderTargetCube?Ae(t,r):ot.setTexture(t,r);break;case"tv":for(void 0===s._array&&(s._array=[]),l=0,c=s.value.length;c>l;l++)s._array[l]=ye();for(et.uniform1iv(h,s._array),l=0,c=s.value.length;c>l;l++)t=s.value[l],r=s._array[l],t&&ot.setTexture(t,r);break;default:a.warn("THREE.WebGLRenderer: Unknown uniform type: "+u)}}}}function be(e,t,r,n){e[t]=r.r*n,e[t+1]=r.g*n,e[t+2]=r.b*n}function xe(e){var t,r,n,i,o,s,l,c,u=0,d=0,h=0,f=Tt,p=f.directional.colors,m=f.directional.positions,g=f.point.colors,v=f.point.positions,y=f.point.distances,_=f.spot.colors,b=f.spot.positions,x=f.spot.distances,w=f.spot.directions,E=f.spot.anglesCos,S=f.spot.exponents,A=f.hemi.skyColors,M=f.hemi.groundColors,T=f.hemi.positions,C=0,j=0,P=0,L=0,D=0,I=0,R=0,O=0,k=0,N=0,F=0,V=0;for(t=0,r=e.length;r>t;t++)if(n=e[t],!n.onlyShadow)if(i=n.color,l=n.intensity,c=n.distance,n instanceof a.AmbientLight){if(!n.visible)continue;u+=i.r,d+=i.g,h+=i.b}else if(n instanceof a.DirectionalLight){if(D+=1,!n.visible)continue;At.setFromMatrixPosition(n.matrixWorld),St.setFromMatrixPosition(n.target.matrixWorld),At.sub(St),At.normalize(),k=3*C,m[k]=At.x,m[k+1]=At.y,m[k+2]=At.z,be(p,k,i,l),C+=1}else if(n instanceof a.PointLight){if(I+=1,!n.visible)continue;N=3*j,be(g,N,i,l),St.setFromMatrixPosition(n.matrixWorld),v[N]=St.x,v[N+1]=St.y,v[N+2]=St.z,y[j]=c,j+=1}else if(n instanceof a.SpotLight){if(R+=1,!n.visible)continue;F=3*P,be(_,F,i,l),St.setFromMatrixPosition(n.matrixWorld),b[F]=St.x,b[F+1]=St.y,b[F+2]=St.z,x[P]=c,At.copy(St),St.setFromMatrixPosition(n.target.matrixWorld),At.sub(St),At.normalize(),w[F]=At.x,w[F+1]=At.y,w[F+2]=At.z,E[P]=Math.cos(n.angle),S[P]=n.exponent,P+=1}else if(n instanceof a.HemisphereLight){if(O+=1,!n.visible)continue;At.setFromMatrixPosition(n.matrixWorld),At.normalize(),V=3*L,T[V]=At.x,T[V+1]=At.y,T[V+2]=At.z,o=n.color,s=n.groundColor,be(A,V,o,l),be(M,V,s,l),L+=1}for(t=3*C,r=Math.max(p.length,3*D);r>t;t++)p[t]=0;for(t=3*j,r=Math.max(g.length,3*I);r>t;t++)g[t]=0;for(t=3*P,r=Math.max(_.length,3*R);r>t;t++)_[t]=0;for(t=3*L,r=Math.max(A.length,3*O);r>t;t++)A[t]=0;for(t=3*L,r=Math.max(M.length,3*O);r>t;t++)M[t]=0;f.directional.length=C,f.point.length=j,f.spot.length=P,f.hemi.length=L,f.ambient[0]=u,f.ambient[1]=d,f.ambient[2]=h}function we(e,t,r){var n;r?(et.texParameteri(e,et.TEXTURE_WRAP_S,De(t.wrapS)),et.texParameteri(e,et.TEXTURE_WRAP_T,De(t.wrapT)),et.texParameteri(e,et.TEXTURE_MAG_FILTER,De(t.magFilter)),et.texParameteri(e,et.TEXTURE_MIN_FILTER,De(t.minFilter))):(et.texParameteri(e,et.TEXTURE_WRAP_S,et.CLAMP_TO_EDGE),et.texParameteri(e,et.TEXTURE_WRAP_T,et.CLAMP_TO_EDGE),(t.wrapS!==a.ClampToEdgeWrapping||t.wrapT!==a.ClampToEdgeWrapping)&&a.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+t.sourceFile+" )"),et.texParameteri(e,et.TEXTURE_MAG_FILTER,Pe(t.magFilter)),et.texParameteri(e,et.TEXTURE_MIN_FILTER,Pe(t.minFilter)),t.minFilter!==a.NearestFilter&&t.minFilter!==a.LinearFilter&&a.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+t.sourceFile+" )")),n=Dt.get("EXT_texture_filter_anisotropic"),n&&t.type!==a.FloatType&&t.type!==a.HalfFloatType&&(t.anisotropy>1||t.__oldAnisotropy)&&(et.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,ot.getMaxAnisotropy())),t.__oldAnisotropy=t.anisotropy)}function Ee(e,t){if(e.width<=t&&e.height<=t)return e;var r=Math.max(e.width,e.height),n=Math.floor(e.width*t/r),i=Math.floor(e.height*t/r),o=d.createElement("canvas");o.width=n,o.height=i;var s=o.getContext("2d");return s.drawImage(e,0,0,e.width,e.height,0,0,n,i),o}function Se(e,t){if(6===e.image.length)if(e.needsUpdate){e.__webglTextureCube||(e.addEventListener("dispose",tr),e.__webglTextureCube=et.createTexture(),ot.info.memory.textures++),et.activeTexture(et.TEXTURE0+t),et.bindTexture(et.TEXTURE_CUBE_MAP,e.__webglTextureCube),et.pixelStorei(et.UNPACK_FLIP_Y_WEBGL,e.flipY);var r,n=e instanceof a.CompressedTexture,i=e.image[0]instanceof a.DataTexture,o=[];for(r=0;6>r;r++)!ot.autoScaleCubemaps||n||i?o[r]=i?e.image[r].image:e.image[r]:o[r]=Ee(e.image[r],Vt);var s=o[0],l=a.Math.isPowerOfTwo(s.width)&&a.Math.isPowerOfTwo(s.height),c=De(e.format),u=De(e.type);for(we(et.TEXTURE_CUBE_MAP,e,l),r=0;6>r;r++)if(n)for(var d,h=o[r].mipmaps,f=0,p=h.length;p>f;f++)d=h[f],e.format!==a.RGBAFormat&&e.format!==a.RGBFormat?Yt().indexOf(c)>-1?et.compressedTexImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+r,f,c,d.width,d.height,0,d.data):a.warn("Attempt to load unsupported compressed texture format"):et.texImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+r,f,c,d.width,d.height,0,c,u,d.data);else i?et.texImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,c,o[r].width,o[r].height,0,c,u,o[r].data):et.texImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,c,c,u,o[r]);e.generateMipmaps&&l&&et.generateMipmap(et.TEXTURE_CUBE_MAP),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else et.activeTexture(et.TEXTURE0+t),et.bindTexture(et.TEXTURE_CUBE_MAP,e.__webglTextureCube)}function Ae(e,t){et.activeTexture(et.TEXTURE0+t),et.bindTexture(et.TEXTURE_CUBE_MAP,e.__webglTexture)}function Me(e){var t=tt?et.COLOR_ATTACHMENT0:rt.COLOR_ATTACHMENT0_WEBGL,r=[t];for(qt=1;qt<e.length;qt++)r.push(t+qt);tt?et.drawBuffers(r):rt.drawBuffersWEBGL(r)}function Te(e){var t=a.Math.isPowerOfTwo(e.width)&&a.Math.isPowerOfTwo(e.height),r=De(e.format),n=De(e.type),i=Le(e.format,e.type);e.addEventListener("dispose",rr),e.__webglTexture=et.createTexture(),ot.info.memory.textures++,et.bindTexture(et.TEXTURE_2D,e.__webglTexture),we(et.TEXTURE_2D,e,t),et.texImage2D(et.TEXTURE_2D,0,i,e.width,e.height,0,r,n,null),t&&e.generateMipmaps&&et.generateMipmap(et.TEXTURE_2D)}function Ce(e,t){var r=e.__webglBoundBuffers;if(!r)return!0;if(r.length!==t.length)return!0;for(var n=0;n<t.length;n++)if(t[n]!==r[n])return!0;return!1}function je(e){et.bindTexture(et.TEXTURE_2D,e.__webglTexture),et.generateMipmap(et.TEXTURE_2D),et.bindTexture(et.TEXTURE_2D,null)}function Pe(e){return e===a.NearestFilter||e===a.NearestMipMapNearestFilter||e===a.NearestMipMapLinearFilter?et.NEAREST:et.LINEAR}function Le(e,t){if(tt)if(e===a.RGBFormat)switch(t){case a.UnsignedByteType:return et.RGB8;case a.FloatType:return et.RGB32F;case a.HalfFloatType:return et.RGB16F}else if(e===a.RGBAFormat)switch(t){case a.UnsignedByteType:return et.RGBA8;case a.FloatType:return et.RGBA32F;case a.HalfFloatType:return et.RGBA16F}else if(e===a.LuminanceFormat)switch(t){case a.UnsignedByteType:return et.LUMINANCE}return De(e)}function De(e){var t;if(e===a.RepeatWrapping)return et.REPEAT;if(e===a.ClampToEdgeWrapping)return et.CLAMP_TO_EDGE;if(e===a.MirroredRepeatWrapping)return et.MIRRORED_REPEAT;if(e===a.NearestFilter)return et.NEAREST;if(e===a.NearestMipMapNearestFilter)return et.NEAREST_MIPMAP_NEAREST;if(e===a.NearestMipMapLinearFilter)return et.NEAREST_MIPMAP_LINEAR;if(e===a.LinearFilter)return et.LINEAR;if(e===a.LinearMipMapNearestFilter)return et.LINEAR_MIPMAP_NEAREST;if(e===a.LinearMipMapLinearFilter)return et.LINEAR_MIPMAP_LINEAR;if(e===a.UnsignedByteType)return et.UNSIGNED_BYTE;if(e===a.UnsignedShort4444Type)return et.UNSIGNED_SHORT_4_4_4_4;if(e===a.UnsignedShort5551Type)return et.UNSIGNED_SHORT_5_5_5_1;if(e===a.UnsignedShort565Type)return et.UNSIGNED_SHORT_5_6_5;if(e===a.ByteType)return et.BYTE;if(e===a.ShortType)return et.SHORT;if(e===a.UnsignedShortType)return et.UNSIGNED_SHORT;if(e===a.IntType)return et.INT;if(e===a.UnsignedIntType)return et.UNSIGNED_INT;if(e===a.FloatType)return et.FLOAT;if(e===a.HalfFloatType)return tt?et.HALF_FLOAT:36193;if(e===a.AlphaFormat)return et.ALPHA;if(e===a.RGBFormat)return et.RGB;if(e===a.RGBAFormat)return et.RGBA;if(e===a.LuminanceFormat)return et.LUMINANCE;if(e===a.LuminanceAlphaFormat)return et.LUMINANCE_ALPHA;if(e===a.AddEquation)return et.FUNC_ADD;if(e===a.MinEquation)return et.MIN;if(e===a.MaxEquation)return et.MAX;if(e===a.SubtractEquation)return et.FUNC_SUBTRACT;if(e===a.ReverseSubtractEquation)return et.FUNC_REVERSE_SUBTRACT;if(e===a.ZeroFactor)return et.ZERO;if(e===a.OneFactor)return et.ONE;if(e===a.SrcColorFactor)return et.SRC_COLOR;if(e===a.OneMinusSrcColorFactor)return et.ONE_MINUS_SRC_COLOR;if(e===a.SrcAlphaFactor)return et.SRC_ALPHA;if(e===a.OneMinusSrcAlphaFactor)return et.ONE_MINUS_SRC_ALPHA;if(e===a.DstAlphaFactor)return et.DST_ALPHA;if(e===a.OneMinusDstAlphaFactor)return et.ONE_MINUS_DST_ALPHA;if(e===a.DstColorFactor)return et.DST_COLOR;if(e===a.OneMinusDstColorFactor)return et.ONE_MINUS_DST_COLOR;if(e===a.SrcAlphaSaturateFactor)return et.SRC_ALPHA_SATURATE;if(t=Dt.get("WEBGL_compressed_texture_s3tc"),null!==t){if(e===a.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===a.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===a.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===a.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t=Dt.get("WEBGL_compressed_texture_pvrtc"),null!==t){if(e===a.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===a.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===a.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===a.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t=Dt.get("EXT_blend_minmax"),null!==t){if(e===a.MinEquation)return t.MIN_EXT;if(e===a.MaxEquation)return t.MAX_EXT}return 0}function Ie(e){for(var t=0,r=0,n=0,i=0,o=0,s=e.length;s>o;o++){var l=e[o];l.onlyShadow||(l instanceof a.DirectionalLight&&t++,l instanceof a.PointLight&&r++,l instanceof a.SpotLight&&n++,l instanceof a.HemisphereLight&&i++)}return{directional:t,point:r,spot:n,hemi:i}}a.log("THREE.WebGLRenderer",a.REVISION),e=e||{};var Re=void 0!==e.canvas?e.canvas:d.createElement("canvas"),Oe=u.devicePixelRatio||1,ke=void 0!==e.precision?e.precision:"highp",Ne=ke,Fe=void 0!==e.alpha?e.alpha:!1,Ve=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,Ue=void 0!==e.antialias?e.antialias:!1,Be=void 0!==e.stencil?e.stencil:!0,ze=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!0,Ge=new a.Color(0),He=0,We=-1!=u.navigator.userAgent.indexOf("Firefox")&&-1!=u.navigator.userAgent.indexOf("Mac OS");We=We||s.isIE11;var qe=[],Xe={},Ye=new a.Matrix4,Ke=new a.Matrix3,Qe=0,Ze=[],Je=[],$e=-1;this.domElement=Re,this.context=null,this.refCount=0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var et,tt,rt,nt,it,ot=this,st=[],at=null,lt=null,ct=-1,ut=null,dt="",ht=0,ft="",pt="",mt=0,gt=0,vt=0,yt=Re.width,_t=Re.height,bt={},xt=new a.Frustum,wt=new a.Matrix4,Et=new a.Matrix4,St=new a.Vector3,At=new a.Vector3,Mt=!0,Tt={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};try{var Ct={alpha:Fe,premultipliedAlpha:Ve,antialias:Ue,stencil:Be,preserveDrawingBuffer:ze};if(et=e.useWebGL2!==!1?Re.getContext("webgl2",Ct):null,et?tt=!0:et=Re.getContext("webgl",Ct)||Re.getContext("experimental-webgl",Ct),null===et)throw null!==Re.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";var jt=et.getShaderPrecisionFormat(et.FRAGMENT_SHADER,et.HIGH_FLOAT);0==jt.precision&&(Ne="mediump"),Re.addEventListener("webglcontextlost",function(e){e.preventDefault(),Ot(),Rt(),Xe={},ot.webglcontextlost&&ot.webglcontextlost(e)},!1)}catch(Pt){return void a.error(Pt)}var Lt=new a.WebGLState(et,De);void 0===et.getShaderPrecisionFormat&&(et.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});var Dt=new a.WebGLExtensions(et);Dt.get("EXT_texture_filter_anisotropic"),Dt.get("WEBGL_compressed_texture_s3tc"),tt?Dt.get("EXT_color_buffer_float"):(Dt.get("OES_texture_float"),Dt.get("OES_texture_float_linear"),Dt.get("OES_texture_half_float"),Dt.get("OES_texture_half_float_linear"),Dt.get("OES_standard_derivatives"),Dt.get("EXT_shader_texture_lod"),rt=Dt.get("WEBGL_draw_buffers"),nt=Dt.get("ANGLE_instanced_arrays"),it=Dt.get("OES_vertex_array_object"));var It=function(e,t,r,n){Ve===!0&&(e*=n,t*=n,r*=n),et.clearColor(e,t,r,n)},Rt=function(){et.clearColor(0,0,0,1),et.clearDepth(1),et.clearStencil(0),et.enable(et.DEPTH_TEST),et.depthFunc(et.LEQUAL),et.frontFace(et.CCW),et.cullFace(et.BACK),et.enable(et.CULL_FACE),et.enable(et.BLEND),et.blendEquation(et.FUNC_ADD),et.blendFunc(et.SRC_ALPHA,et.ONE_MINUS_SRC_ALPHA),et.viewport(gt,vt,yt,_t),It(Ge.r,Ge.g,Ge.b,He)},Ot=function(){at=null,ut=null,dt="",ct=-1,Mt=!0,Lt.reset(),Lt.disableUnusedAttributes()};Rt(),this.context=et,this.state=Lt;for(var kt=et.getParameter(et.MAX_TEXTURE_IMAGE_UNITS),Nt=et.getParameter(et.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Ft=et.getParameter(et.MAX_TEXTURE_SIZE),Vt=et.getParameter(et.MAX_CUBE_MAP_TEXTURE_SIZE),Ut=Nt>0,Bt=et.getShaderPrecisionFormat(et.VERTEX_SHADER,et.HIGH_FLOAT),zt=et.getShaderPrecisionFormat(et.VERTEX_SHADER,et.MEDIUM_FLOAT),Gt=et.getShaderPrecisionFormat(et.FRAGMENT_SHADER,et.HIGH_FLOAT),Ht=et.getShaderPrecisionFormat(et.FRAGMENT_SHADER,et.MEDIUM_FLOAT),Wt=new Uint8Array(16),qt=0;4>qt;qt++)c?1===qt||2===qt?(Wt[4*qt]=246,
Wt[4*qt+1]=140,Wt[4*qt+2]=220):(Wt[4*qt]=48,Wt[4*qt+1]=195,Wt[4*qt+2]=3):Wt[4*qt]=Wt[4*qt+1]=Wt[4*qt+2]=0,Wt[4*qt+3]=255;var Xt=new a.DataTexture(Wt,2,2,a.RGBAFormat,a.UnsignedByteType,a.UVMapping,a.RepeatWrapping,a.RepeatWrapping,a.NearestFilter,a.NearestFilter);Xt.needsUpdate=!0;var Yt=function(){var e;return function(){if(void 0!==e)return e;if(e=[],Dt.get("WEBGL_compressed_texture_pvrtc")||Dt.get("WEBGL_compressed_texture_s3tc"))for(var t=et.getParameter(et.COMPRESSED_TEXTURE_FORMATS),r=0;r<t.length;r++)e.push(t[r]);return e}}(),Kt=Bt.precision>0,Qt=zt.precision>0;"highp"!==ke||Kt||(Qt?(ke="mediump",a.warn("WebGLRenderer: highp not supported, using mediump")):(ke="lowp",a.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==ke||Qt||(ke="lowp",a.warn("WebGLRenderer: mediump not supported, using lowp")),Kt=Gt.precision>0,Qt=Ht.precision>0,"highp"!==Ne||Kt||(Qt?(Ne="mediump",a.warn("WebGLRenderer: highp not supported, using mediump")):(Ne="lowp",a.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==Ne||Qt||(Ne="lowp",a.warn("WebGLRenderer: mediump not supported, using lowp")),this.getContext=function(){return et},this.isWebGL2=function(){return tt},this.forceContextLoss=function(){Dt.get("WEBGL_lose_context").loseContext()},this.supportsVertexTextures=function(){return Ut},this.supportsFloatTextures=function(){return tt||Dt.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return tt||Dt.get("OES_texture_half_float_linear")},this.supportsStandardDerivatives=function(){return tt||Dt.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return tt||Dt.get("WEBGL_compressed_texture_s3tc")},this.supportsElementIndexUint=function(){return tt||Dt.get("OES_element_index_uint")},this.supportsMRT=function(){return tt||!We&&rt},this.supportsInstancedArrays=function(){return tt||!!nt},this.supportsBlendMinMax=function(){return tt||Dt.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){var e;return function(){if(void 0!==e)return e;var t=Dt.get("EXT_texture_filter_anisotropic");return e=null!==t?et.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPixelRatio=function(){return Oe},this.setPixelRatio=function(e){Oe=e},this.getCurrentFramebuffer=function(){return lt},this.setSize=function(e,t,r){Re.width=e*Oe,Re.height=t*Oe,r!==!1&&(Re.style.width=e+"px",Re.style.height=t+"px"),this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,n){gt=e*Oe,vt=t*Oe,yt=r*Oe,_t=n*Oe,et.viewport(gt,vt,yt,_t)};var Zt=!1;this.enableViewportOnOffscreenTargets=function(e){Zt=e};var Jt=[];this.pushViewport=function(){Jt.push(gt),Jt.push(vt),Jt.push(yt),Jt.push(_t)},this.popViewport=function(){var e=Jt.length-4;gt=Jt[e],vt=Jt[e+1],yt=Jt[e+2],_t=Jt[e+3],et.viewport(gt,vt,yt,_t),Jt.length=e},this.setScissor=function(e,t,r,n){et.scissor(e*Oe,t*Oe,r*Oe,n*Oe)},this.enableScissorTest=function(e){e?et.enable(et.SCISSOR_TEST):et.disable(et.SCISSOR_TEST)},this.setLoadingAnimationDuration=function(e){$e=e},this.getLoadingAnimationDuration=function(){return $e},this.getClearColor=function(){return Ge},this.setClearColor=function(e,t){Ge.set(e),He=void 0!==t?t:1,It(Ge.r,Ge.g,Ge.b,He)},this.getClearAlpha=function(){return He},this.setClearAlpha=function(e){He=e,It(Ge.r,Ge.g,Ge.b,He)},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=et.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=et.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=et.STENCIL_BUFFER_BIT),et.clear(n)},this.clearColor=function(){et.clear(et.COLOR_BUFFER_BIT)},this.clearDepth=function(){et.clear(et.DEPTH_BUFFER_BIT)},this.clearStencil=function(){et.clear(et.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,r,n){this.setRenderTarget(e),this.clear(t,r,n)},this.resetGLState=Ot;var $t=function gr(e){var t=e.target;t.traverse(function(e){e.removeEventListener("remove",gr),te(e)})},er=function vr(e){var t=e.target;t.removeEventListener("dispose",vr),or(t)},tr=function yr(e){var t=e.target;t.removeEventListener("dispose",yr),sr(t),ot.info.memory.textures--},rr=function _r(e){var t=e.target;t.removeEventListener("dispose",_r),ar(t),ot.info.memory.textures--},nr=function br(e){var t=e.target;t.removeEventListener("dispose",br),lr(t)},ir=function(e){if(void 0!==e.__webglVertexBuffer&&(et.deleteBuffer(e.__webglVertexBuffer),e.__webglVertexBuffer=void 0),void 0!==e.__webglNormalBuffer&&(et.deleteBuffer(e.__webglNormalBuffer),e.__webglNormalBuffer=void 0),void 0!==e.__webglTangentBuffer&&(et.deleteBuffer(e.__webglTangentBuffer),e.__webglTangentBuffer=void 0),void 0!==e.__webglColorBuffer&&(et.deleteBuffer(e.__webglColorBuffer),e.__webglColorBuffer=void 0),void 0!==e.__webglUVBuffer&&(et.deleteBuffer(e.__webglUVBuffer),e.__webglUVBuffer=void 0),void 0!==e.__webglUV2Buffer&&(et.deleteBuffer(e.__webglUV2Buffer),e.__webglUV2Buffer=void 0),void 0!==e.__webglSkinIndicesBuffer&&(et.deleteBuffer(e.__webglSkinIndicesBuffer),e.__webglSkinIndicesBuffer=void 0),void 0!==e.__webglSkinWeightsBuffer&&(et.deleteBuffer(e.__webglSkinWeightsBuffer),e.__webglSkinWeightsBuffer=void 0),void 0!==e.__webglFaceBuffer&&(et.deleteBuffer(e.__webglFaceBuffer),e.__webglFaceBuffer=void 0),void 0!==e.__webglLineBuffer&&(et.deleteBuffer(e.__webglLineBuffer),e.__webglLineBuffer=void 0),void 0!==e.__webglLineDistanceBuffer&&(et.deleteBuffer(e.__webglLineDistanceBuffer),e.__webglLineDistanceBuffer=void 0),void 0!==e.__webglCustomAttributesList){for(var t in e.__webglCustomAttributesList)et.deleteBuffer(e.__webglCustomAttributesList[t].buffer);e.__webglCustomAttributesList=void 0}ot.info.memory.geometries--},or=function(e){e.__webglInit=void 0;var t,r,n,i;if(e instanceof a.BufferGeometry){if(void 0!==e.vbbuffer&&(et.deleteBuffer(e.vbbuffer),e.vbbuffer=void 0),void 0!==e.ibbuffer&&(et.deleteBuffer(e.ibbuffer),e.ibbuffer=void 0),void 0!==e.iblinesbuffer&&(et.deleteBuffer(e.iblinesbuffer),e.iblinesbuffer=void 0),e.vaos){for(t=0;t<e.vaos.length;t++)C(e.vaos[t].vao);e.vaos=void 0}var o=e.attributes;for(var s in o)void 0!==o[s].buffer&&(et.deleteBuffer(o[s].buffer),o[s].buffer=void 0);ot.info.memory.geometries--}else{var l=fr[e.id];if(void 0!==l){for(t=0,r=l.length;r>t;t++){var c=l[t];if(void 0!==c.numMorphTargets){for(n=0,i=c.numMorphTargets;i>n;n++)et.deleteBuffer(c.__webglMorphTargetsBuffers[n]);delete c.__webglMorphTargetsBuffers}if(void 0!==c.numMorphNormals){for(n=0,i=c.numMorphNormals;i>n;n++)et.deleteBuffer(c.__webglMorphNormalsBuffers[n]);delete c.__webglMorphNormalsBuffers}ir(c)}delete fr[e.id]}else ir(e)}};this.deallocateGeometry=or;var sr=function(e){if(e.__webglTextureCube)et.deleteTexture(e.__webglTextureCube),e.__webglTextureCube=void 0;else{if(!e.__webglInit)return;et.deleteTexture(e.__webglTexture),e.__webglInit=void 0,e.__webglTexture=void 0}},ar=function(e){e&&e.__webglTexture&&(et.deleteTexture(e.__webglTexture),et.deleteFramebuffer(e.__webglFramebuffer),void 0!==e.__webglRenderbuffer&&et.deleteRenderbuffer(e.__webglRenderbuffer))},lr=function(e){var t=!1;e.program=void 0,e.programs.forEach(function(e){var r;if(void 0!==e&&void 0!=(r=e.program)){var n,i,o;for(n=0,i=st.length;i>n;n++)if(o=st[n],o&&o.program===r){o.usedTimes--,0===o.usedTimes&&(st[n]=void 0,et.deleteProgram(r),ot.info.memory.programs--,t=!0);break}}},!1),e.programs.length=0,t&&(st=st.filter(function(e){return void 0!==e}))};this.renderBufferDirect=function(e,t,r,n,i,o,s){if(n.visible!==!1&&(!n.isEdgeMaterial||i.iblines)){A(o.geometry);var l=oe(e,t,r,n,o),c=i.attributes,u=!1,d=n.wireframe?1:0,h="direct_"+i.id+(s?"/"+s:"")+"_"+l.id+"_"+d;h!==dt&&(dt=h,u=!0);var f,p=i.offsets&&i.offsets.length,m=p&&i.offsets.some(function(e){return e.index>=0||e.instanceStart>=0});m?u=!0:(f=I(n,l,i,s||0),u=u&&!f),u&&Lt.initAttributes();var g,v=c.index;if(v){var y,_,b=v.array?v.array:i.ib;n.isEdgeMaterial&&(v=c.indexlines,b=i.iblines),v.bytesPerItem?(_=v.bytesPerItem,4===_&&!tt&&Dt.get("OES_element_index_uint")):_=b instanceof Uint32Array&&(tt||Dt.get("OES_element_index_uint"))?4:2,y=4===_?et.UNSIGNED_INT:et.UNSIGNED_SHORT;var x=i.offsets;p&&n.isEdgeMaterial&&!x[0].hasOwnProperty("edgeStart")&&(x=null);var w=0;do{var E,S,M,C,j;if(p){var D=x[w];E=D.index,S=n.isEdgeMaterial?D.edgeStart||0:D.start,M=n.isEdgeMaterial?D.edgeCount||b.length:D.count,C=D.instanceStart||0,j=D.numInstances||i.numInstances;var R=n.program.uniforms;if(R.themingColor&&"themingColor"in D){var k=D.themingColor;k instanceof a.Vector4?et.uniform4f(R.themingColor,k.x,k.y,k.z,k.w):et.uniform4f(R.themingColor,0,0,0,0)}}else E=0,S=0,M=b.length,C=0,j=i.numInstances;u&&(O(n,l,i,E,v,s,C),m||(u=!1)),g=et.TRIANGLES,i.isPoints?g=et.POINTS:(i.isLines||n.isEdgeMaterial)&&(g=et.LINES),j?P(g,M,y,S*_,j):et.drawElements(g,M,y,S*_)}while(x&&++w<x.length)}else{i.offsets&&i.offsets.length>1,u&&O(n,l,i,0,void 0,s,0);var N=i.attributes.position;g=et.TRIANGLES,i.isPoints?g=et.POINTS:(i.isLines||n.isEdgeMaterial)&&(g=et.LINES),i.numInstances?L(g,0,N.array.length/3,i.numInstances):et.drawArrays(g,0,N.array.length/N.itemSize)}f&&T(null)}},this.renderBuffer=function(e,t,r,n,i,o){function s(e,t,r,n,i,o){et.vertexAttribPointer(e,t,r,n,i,o),nt&&nt.vertexAttribDivisorANGLE(e,0)}if(n.visible!==!1&&!n.isEdgeMaterial){J(o);var l=oe(e,t,r,n,o),c=l.attributes,u=!1,d=n.wireframe?1:0,h=i.id+"_"+l.id+"_"+d;if(h!==dt&&(dt=h,u=!0),u&&Lt.initAttributes(),!n.morphTargets&&c.position>=0&&u&&(et.bindBuffer(et.ARRAY_BUFFER,i.__webglVertexBuffer),Lt.enableAttribute(c.position),s(c.position,3,et.FLOAT,!1,0,0)),u){if(i.__webglCustomAttributesList)for(var f=0,p=i.__webglCustomAttributesList.length;p>f;f++){var m=i.__webglCustomAttributesList[f];c[m.buffer.belongsToAttribute]>=0&&(et.bindBuffer(et.ARRAY_BUFFER,m.buffer),Lt.enableAttribute(c[m.buffer.belongsToAttribute]),s(c[m.buffer.belongsToAttribute],m.size,et.FLOAT,!1,0,0))}c.color>=0&&(o.geometry.colors.length>0||o.geometry.faces.length>0?(et.bindBuffer(et.ARRAY_BUFFER,i.__webglColorBuffer),Lt.enableAttribute(c.color),s(c.color,3,et.FLOAT,!1,0,0)):n.defaultAttributeValues&&et.vertexAttrib3fv(c.color,n.defaultAttributeValues.color)),c.normal>=0&&(et.bindBuffer(et.ARRAY_BUFFER,i.__webglNormalBuffer),Lt.enableAttribute(c.normal),s(c.normal,3,et.FLOAT,!1,0,0)),c.tangent>=0&&(et.bindBuffer(et.ARRAY_BUFFER,i.__webglTangentBuffer),Lt.enableAttribute(c.tangent),s(c.tangent,4,et.FLOAT,!1,0,0)),c.uv>=0&&(o.geometry.faceVertexUvs[0]?(et.bindBuffer(et.ARRAY_BUFFER,i.__webglUVBuffer),Lt.enableAttribute(c.uv),s(c.uv,2,et.FLOAT,!1,0,0)):n.defaultAttributeValues&&et.vertexAttrib2fv(c.uv,n.defaultAttributeValues.uv)),c.uv2>=0&&(o.geometry.faceVertexUvs[1]?(et.bindBuffer(et.ARRAY_BUFFER,i.__webglUV2Buffer),Lt.enableAttribute(c.uv2),s(c.uv2,2,et.FLOAT,!1,0,0)):n.defaultAttributeValues&&et.vertexAttrib2fv(c.uv2,n.defaultAttributeValues.uv2)),c.lineDistance>=0&&(et.bindBuffer(et.ARRAY_BUFFER,i.__webglLineDistanceBuffer),Lt.enableAttribute(c.lineDistance),s(c.lineDistance,1,et.FLOAT,!1,0,0))}if(Lt.disableUnusedAttributes(),o instanceof a.Mesh){var g=i.__typeArray===Uint32Array?et.UNSIGNED_INT:et.UNSIGNED_SHORT;n.wireframe?(Lt.setLineWidth(n.wireframeLinewidth*Oe),u&&et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,i.__webglLineBuffer),et.drawElements(et.LINES,i.__webglLineCount,g,0)):(u&&et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,i.__webglFaceBuffer),et.drawElements(et.TRIANGLES,i.__webglFaceCount,g,0))}else if(o instanceof a.Line){var v=o.mode===a.LineStrip?et.LINE_STRIP:et.LINES;Lt.setLineWidth(n.linewidth*Oe),et.drawArrays(v,0,i.__webglLineCount)}else o instanceof a.PointCloud&&et.drawArrays(et.POINTS,0,i.__webglPointCount)}},this.render=function(e,t,r,n,i){if(t instanceof a.Camera==!1)return void a.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");dt="",ct=-1,ut=null,void 0!==i&&(qe.length=0,Mt=!0);var s=e.fog;e.autoUpdate===!0&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),t.worldUpTransform?Et.multiplyMatrices(t.worldUpTransform,t.matrixWorld):Et.copy(t.matrixWorld),wt.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),xt.setFromMatrix(wt);var l=e instanceof o.RenderBatch&&e.renderImmediate;if(l||(Ze.length=0,Je.length=0,U(e,ot.sortObjects===!0,e.forceVisible===!0),ot.sortObjects===!0&&(Ze.sort(N),Je.sort(k))),Mt&&(i&&i.length&&(qe=i.slice()),xe(qe)),this.setRenderTarget(r),this.resetGLState(),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),e.overrideMaterial){var c=e.overrideMaterial;ie(c),l?q(e,"",t,qe,s,c):(z(Ze,t,qe,s,c),z(Je,t,qe,s,c))}else l?q(e,"",t,qe,s,null):(Lt.setBlending(a.NoBlending),z(Ze,t,qe,s,null),z(Je,t,qe,s,null));if(e.edgeMaterial){et.depthFunc(et.LESS);var u=e.edgeMaterial;ie(u),l?q(e,"",t,qe,s,u):(z(Ze,t,qe,s,u),z(Je,t,qe,s,u)),et.depthFunc(et.LEQUAL)}r&&r.generateMipmaps&&r.minFilter!==a.NearestFilter&&r.minFilter!==a.LinearFilter&&je(r),this.resetGLState(),Lt.setDepthTest(!0),Lt.setDepthWrite(!0)},this.clearBlend=function(){Lt.setBlending(a.NoBlending)},this.setProgramPrefix=function(e,t,r){ht=e,ft=t,pt=r},this.getProgramPrefix=function(){return{programPrefix:ht,vertexPrefix:ft,fragmentPrefix:pt}},this.updateTimestamp=function(e){Qe=e};var cr,ur,dr,hr,fr={},pr=0,mr={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"firefly_basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"firefly_phong",LineBasicMaterial:"firefly_basic",LineDashedMaterial:"dashed",PointCloudMaterial:"firefly_basic"};this.setFaceCulling=function(e,t){e===a.CullFaceNone?et.disable(et.CULL_FACE):(t===a.FrontFaceDirectionCW?et.frontFace(et.CW):et.frontFace(et.CCW),e===a.CullFaceBack?et.cullFace(et.BACK):e===a.CullFaceFront?et.cullFace(et.FRONT):et.cullFace(et.FRONT_AND_BACK),et.enable(et.CULL_FACE))},this.setMaterialFaces=function(e){Lt.setDoubleSided(e.side===a.DoubleSide),Lt.setFlipSided(e.side===a.BackSide)},this.uploadTexture=function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",tr),e.__webglTexture=et.createTexture(),ot.info.memory.textures++),et.bindTexture(et.TEXTURE_2D,e.__webglTexture),et.pixelStorei(et.UNPACK_FLIP_Y_WEBGL,e.flipY),et.pixelStorei(et.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),et.pixelStorei(et.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=Ee(e.image,Ft);var t=e.image,r=a.Math.isPowerOfTwo(t.width)&&a.Math.isPowerOfTwo(t.height),n=De(e.format),i=De(e.type),o=Le(e.format,e.type);we(et.TEXTURE_2D,e,r);var s,l,c,u=e.mipmaps;if(e instanceof a.DataTexture)if(u.length>0&&r){for(l=0,c=u.length;c>l;l++)s=u[l],et.texImage2D(et.TEXTURE_2D,l,o,s.width,s.height,0,n,i,s.data);e.generateMipmaps=!1}else et.texImage2D(et.TEXTURE_2D,0,o,t.width,t.height,0,n,i,t.data);else if(e instanceof a.CompressedTexture){for(l=0,c=u.length;c>l;l++)s=u[l],e.format!==a.RGBAFormat&&e.format!==a.RGBFormat?Yt().indexOf(n)>-1?et.compressedTexImage2D(et.TEXTURE_2D,l,o,s.width,s.height,0,s.data):a.warn("Attempt to load unsupported compressed texture format"):et.texImage2D(et.TEXTURE_2D,l,o,s.width,s.height,0,n,i,s.data);if(u.length>1&&Yt().indexOf(n)>-1)for(var d,h=s.width>>1,f=s.height>>1,p=u.length;h>=1||f>=1;)d=4==s.width&&4==s.height?s.data:new DataView(s.data.buffer,s.data.byteOffset,s.data.byteLength*(Math.max(h,4)*Math.max(f,4))/(s.width*s.height)),et.compressedTexImage2D(et.TEXTURE_2D,p,o,Math.max(h,1),Math.max(f,1),0,d),h>>=1,f>>=1,++p}else if(u.length>0&&r){for(l=0,c=u.length;c>l;l++)et.texImage2D(et.TEXTURE_2D,l,o,n,i,u[l]);e.generateMipmaps=!1}else et.texImage2D(et.TEXTURE_2D,0,o,n,i,e.image);e.generateMipmaps&&r&&et.generateMipmap(et.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()},this.setTexture=function(e,t){et.activeTexture(et.TEXTURE0+t),e.needsUpdate?ot.uploadTexture(e):e.__webglTexture?et.bindTexture(et.TEXTURE_2D,e.__webglTexture):et.bindTexture(et.TEXTURE_2D,Xt.__webglTexture)},ot.uploadTexture(Xt),this.initFrameBufferMRT=function(e,t){var r=e[0],n=!1;if(r&&!r.__webglFramebuffer){void 0===r.depthBuffer&&(r.depthBuffer=!0),void 0===r.stencilBuffer&&(r.stencilBuffer=!0),r.__webglFramebuffer=et.createFramebuffer(),et.bindFramebuffer(et.FRAMEBUFFER,r.__webglFramebuffer);var i;r.shareDepthFrom?i=r.__webglRenderbuffer=r.shareDepthFrom.__webglRenderbuffer:(i=r.__webglRenderbuffer,r.depthBuffer&&!r.stencilBuffer?(i||(i=r.__webglRenderbuffer=et.createRenderbuffer()),et.bindRenderbuffer(et.RENDERBUFFER,i),et.renderbufferStorage(et.RENDERBUFFER,tt?et.DEPTH_COMPONENT32F:et.DEPTH_COMPONENT16,r.width,r.height)):r.depthBuffer&&r.stencilBuffer&&(i||(i=r.__webglRenderbuffer=et.createRenderbuffer()),et.bindRenderbuffer(et.RENDERBUFFER,i),et.renderbufferStorage(et.RENDERBUFFER,tt?et.DEPTH24_STENCIL8:et.DEPTH_STENCIL,r.width,r.height))),r.depthBuffer&&!r.stencilBuffer?et.framebufferRenderbuffer(et.FRAMEBUFFER,et.DEPTH_ATTACHMENT,et.RENDERBUFFER,i):r.depthBuffer&&r.stencilBuffer&&et.framebufferRenderbuffer(et.FRAMEBUFFER,et.DEPTH_STENCIL_ATTACHMENT,et.RENDERBUFFER,i),n=!0}var o=lt;if(et.bindFramebuffer(et.FRAMEBUFFER,r.__webglFramebuffer),Ce(r,e)){var s;for(s=0;s<e.length;s++){var l=e[s];l&&!l.__webglTexture&&Te(l),et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0+s,et.TEXTURE_2D,l&&l.__webglTexture,0)}s=e.length;for(var c=r.__webglBoundBuffers&&r.__webglBoundBuffers.length||s;c>s;)et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0+s,et.TEXTURE_2D,null,0),s++;r.__webglBoundBuffers=e.slice()}if(this.supportsMRT()&&Me(e),t){var u=et.checkFramebufferStatus(et.FRAMEBUFFER);u!==et.FRAMEBUFFER_COMPLETE&&(a.log("Can't use multiple render targets. Falling back to two passes. "+u),o===r.__webglFramebuffer&&(o=lt=null),et.bindFramebuffer(et.FRAMEBUFFER,o),et.deleteFramebuffer(r.__webglFramebuffer),delete r.__webglFramebuffer,t=!1)}return et.bindFramebuffer(et.FRAMEBUFFER,o),n&&(et.bindTexture(et.TEXTURE_2D,null),et.bindRenderbuffer(et.RENDERBUFFER,null),et.bindFramebuffer(et.FRAMEBUFFER,null)),t},this.setRenderTarget=function(e){var t;if(Array.isArray(e))this.initFrameBufferMRT(e),t=e[0],t.initForMRT=!0;else if(e){var r=e.__webglFramebuffer;(!r||lt!==r||e.initForMRT)&&this.initFrameBufferMRT([e]),t=e,t.initForMRT=!1}var n,i,o,s,a,l=!t||Zt;l?(i=yt,o=_t,s=gt,a=vt):(i=t.width,o=t.height,s=0,a=0),n=t?t.__webglFramebuffer:null,n!==lt&&(et.bindFramebuffer(et.FRAMEBUFFER,n),et.viewport(s,a,i,o),lt=n)},this.verifyMRTWorks=function(e){return this.supportsMRT()?this.initFrameBufferMRT(e,!0):!1},this.readRenderTargetPixels=function(e,t,r,n,i,o){if(!(e instanceof a.WebGLRenderTarget))return void a.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");if(e.__webglFramebuffer){if(e.format!==a.RGBAFormat&&e.format!==a.RGBFormat||e.type!==a.UnsignedByteType)return void a.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not a readable format.");var s=!1;e.__webglFramebuffer!==lt&&(et.bindFramebuffer(et.FRAMEBUFFER,e.__webglFramebuffer),s=!0),e.canReadPixels||et.checkFramebufferStatus(et.FRAMEBUFFER)===et.FRAMEBUFFER_COMPLETE?et.readPixels(t,r,n,i,et.RGBA,et.UNSIGNED_BYTE,o):a.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),s&&et.bindFramebuffer(et.FRAMEBUFFER,lt)}}}},"./src/wgs/render/WebGLShader.js":function(e,t,r){"use strict";function n(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),"undefined"!=typeof DEBUG_SHADERS&&DEBUG_SHADERS&&(e.getShaderParameter(n,e.COMPILE_STATUS)===!1&&i.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&i.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e.getShaderInfoLog(n),o(r))),n}r.r(t),r.d(t,"WebGLShader",function(){return n});var i=r("./thirdparty/three.js/three.js"),o=(r.n(i),function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")})},"./src/wgs/render/chunks/cutplanes.glsl":function(e,t){e.exports="#if NUM_CUTPLANES > 0\nuniform vec4 cutplanes[NUM_CUTPLANES];\nvoid checkCutPlanes(vec3 worldPosition) {\n    for (int i=0; i<NUM_CUTPLANES; i++) {\n        if (dot(vec4(worldPosition, 1.0), cutplanes[i]) > 0.0) {\n            discard;\n        }\n    }\n}\n#endif\n"},"./src/wgs/render/chunks/decl_point_size.glsl":function(e,t){e.exports="uniform float point_size;"},"./src/wgs/render/chunks/depth_texture.glsl":function(e,t){e.exports="\nuniform sampler2D tDepth;\nuniform vec4 projInfo;\nuniform float isOrtho;\nuniform mat4 worldMatrix_mainPass;\nvec3 reconstructCSPosition(vec2 fragCoords, float z) {\n    return vec3((fragCoords * projInfo.xy + projInfo.zw) * mix(z, -1.0, isOrtho), z);\n}\nvec3 reconstructWorldPosition(vec2 fragCoords, vec2 screenUv) {\n    float zCam = texture2D(tDepth, screenUv).z;\n    vec3 csPos = reconstructCSPosition(fragCoords, zCam);\n    return (worldMatrix_mainPass * vec4(csPos, 1.0)).xyz;\n}\n"},"./src/wgs/render/chunks/env_sample.glsl":function(e,t){e.exports="\nuniform float envRotationSin;\nuniform float envRotationCos;\nvec3 adjustLookupVector(in vec3 lookup) {\n    return vec3(\n            envRotationCos * lookup.x - envRotationSin * lookup.z,\n            lookup.y,\n            envRotationSin * lookup.x + envRotationCos * lookup.z);\n}\nvec3 RGBMDecode(in vec4 vRGBM, in float exposure) {\n    vec3 ret = vRGBM.rgb * (vRGBM.a * 16.0);\n    ret *= ret;\n    ret *= exposure;\n    return ret;\n}\nvec3 GammaDecode(in vec4 vRGBA, in float exposure) {\n    return vRGBA.xyz * vRGBA.xyz * exposure;\n}\nvec3 sampleIrradianceMap(vec3 dirWorld, samplerCube irrMap, float exposure) {\n    vec4 cubeColor4 = textureCube(irrMap, adjustLookupVector(dirWorld));\n#ifdef IRR_GAMMA\n    vec3 indirectDiffuse = GammaDecode(cubeColor4, exposure);\n#elif defined(IRR_RGBM)\n    vec3 indirectDiffuse = RGBMDecode(cubeColor4, exposure);\n#else\n    vec3 indirectDiffuse = cubeColor4.xyz;\n#ifdef GAMMA_INPUT\n    indirectDiffuse.xyz *= indirectDiffuse.xyz;\n#endif\n#endif\n    return indirectDiffuse;\n}\n"},"./src/wgs/render/chunks/final_frag.glsl":function(e,t){e.exports="#ifdef HATCH_PATTERN\ngl_FragColor = calculateHatchPattern(hatchParams, gl_FragCoord.xy, gl_FragColor, hatchTintColor, hatchTintIntensity);\n#endif\n#ifdef MRT_NORMALS\noutNormal = vec4(geomNormal.x, geomNormal.y, depth, gl_FragColor.a < 1.0 ? 0.0 : 1.0);\n#endif\n#include<id_frag>\n"},"./src/wgs/render/chunks/float3_average.glsl":function(e,t){e.exports="float averageOfFloat3(in vec3 value) { \n    const float oneThird = 1.0 / 3.0; \n    return dot(value, vec3(oneThird, oneThird, oneThird)); \n} \n"},"./src/wgs/render/chunks/hatch_pattern.glsl":function(e,t){e.exports="#ifdef HATCH_PATTERN\nuniform vec2 hatchParams;\nuniform vec3 hatchTintColor;\nuniform float hatchTintIntensity;\nfloat curveGaussian(float r, float invWidth) {\n    float amt = clamp(r * invWidth, 0.0, 1.0);\n    float exponent = amt * 3.5;\n    return exp(-exponent*exponent);\n}\nvec4 calculateHatchPattern(vec2 hatchParams, vec2 coord, vec4 fragColor, vec3 hatchTintColor, float hatchTintIntensity ) {\n    float hatchSlope = hatchParams.x;\n    float hatchPeriod = hatchParams.y;\n    if (abs(hatchSlope) <= 1.0) {\n        float hatchPhase = coord.y - hatchSlope * coord.x;\n        float dist = abs(mod((hatchPhase), (hatchPeriod)));\n        if (dist < 1.0) {\n            fragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            fragColor.xyz = mix(fragColor.xyz, hatchTintColor, hatchTintIntensity);\n        }\n    } else {\n        float hatchPhase = - coord.y / hatchSlope + coord.x;\n        float dist = abs(mod((hatchPhase), (hatchPeriod)));\n        if (dist < 1.0) {\n            fragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            fragColor.xyz = mix(fragColor.xyz, hatchTintColor, hatchTintIntensity);\n        }\n    }\n    return fragColor;\n}\n#endif\n"},"./src/wgs/render/chunks/hsv.glsl":function(e,t){e.exports="vec3 rgb2hsv(vec3 color)\n{\n    float delta;\n    float colorMax, colorMin;\n    float h,s,v;\n    vec3 hsv;\n    colorMax = max(color.r,color.g);\n    colorMax = max(colorMax,color.b);\n    colorMin = min(color.r,color.g);\n    colorMin = min(colorMin,color.b);\n    v = colorMax;\n    if(colorMax != 0.0)\n    {\n        s = (colorMax - colorMin)/colorMax;\n    }\n    else\n    {\n        s = 0.0;\n    }\n    if(s != 0.0)\n    {\n        delta = colorMax-colorMin;\n        if (color.r == colorMax)\n        {\n            h = (color.g-color.b)/delta;\n        }\n        else if (color.g == colorMax)\n        {\n            h = 2.0 + (color.b-color.r) / delta;\n        }\n        else\n        {\n            h = 4.0 + (color.r-color.g)/delta;\n        }\n        h /= 6.0;\n        if( h < 0.0)\n        {\n            h +=1.0;\n        }\n    }\n    else\n    {\n        h = 0.0;\n    }\n    hsv = vec3(h,s,v);\n    return hsv;\n}\nvec3 hsv2rgb(vec3 hsv)\n{\n    vec3 color;\n    float f,p,q,t;\n    float h,s,v;\n    float i,hi;\n    {\n        h = hsv.x*6.0;\n        s = hsv.y;\n        v = hsv.z;\n        i = floor(h);\n        f = h-i;\n        p = v * (1.0 - s);\n        q = v * (1.0 - (s * f));\n        t = v * (1.0 - (s * (1.0 - f)));\n        float r,g,b;\n        if (i == 0.0)\n        {\n            r = v;\n            g = t;\n            b = p;\n        }\n        else if (i == 1.0)\n        {\n            r = q;\n            g = v;\n            b = p;\n        }\n        else if (i == 2.0)\n        {\n            r = p;\n            g = v;\n            b = t;\n        }\n        else if (i == 3.0)\n        {\n            r = p;\n            g = q;\n            b = v;\n        }\n        else if (i == 4.0)\n        {\n            r = t;\n            g = p;\n            b = v;\n        }\n        else\n        {\n            r = v;\n            g = p;\n            b = q;\n        }\n        color = vec3(r,g,b);\n    }\n    return color;\n}"},"./src/wgs/render/chunks/id_decl_frag.glsl":function(e,t){e.exports="#if defined(MRT_NORMALS) || defined(MRT_ID_BUFFER)\n    varying highp float depth;\n#endif\n#if defined(MRT_ID_BUFFER) || defined(ID_COLOR)\n    #ifdef USE_VERTEX_ID\n        varying vec3 vId;\n    #elif defined(LINE_2D_SHADER)\n        varying vec4 dbId;\n    #else\n        uniform vec3 dbId;\n    #endif\n#endif\n#if defined(MRT_ID_BUFFER) || defined(MODEL_COLOR)\n    uniform vec3 modelId;\n#endif\n#ifdef _LMVWEBGL2_\n    #if defined(MRT_NORMALS)\n        layout(location = 1) out vec4 outNormal;\n        #if defined(MRT_ID_BUFFER)\n            layout(location = 2) out vec4 outId;\n            #if defined(MODEL_COLOR)\n                layout(location = 3) out vec4 outModelId;\n            #endif\n        #endif\n    #elif defined(MRT_ID_BUFFER)\n        layout(location = 1) out vec4 outId;\n        #if defined(MODEL_COLOR)\n            layout(location = 2) out vec4 outModelId;\n        #endif\n    #endif\n#else\n    #define gl_FragColor gl_FragData[0]\n    #if defined(MRT_NORMALS)\n        #define outNormal gl_FragData[1]\n        #if defined(MRT_ID_BUFFER)\n            #define outId gl_FragData[2]\n            #if defined(MODEL_COLOR)\n                #define outModelId gl_FragData[3]\n            #endif\n        #endif\n    #elif defined(MRT_ID_BUFFER)\n        #define outId gl_FragData[1]\n        #if defined(MODEL_COLOR)\n            #define outModelId gl_FragData[2]\n        #endif\n    #endif\n#endif"},"./src/wgs/render/chunks/id_decl_vert.glsl":function(e,t){e.exports="#ifdef USE_VERTEX_ID\nattribute vec3 id;\nvarying   vec3 vId;\n#endif\n"},"./src/wgs/render/chunks/id_frag.glsl":function(e,t){e.exports="\n#if defined(USE_VERTEX_ID) && (defined(MRT_ID_BUFFER) || defined(ID_COLOR))\n    vec3 dbId = vId;\n#endif\n#ifdef MRT_ID_BUFFER\n    #ifndef ENABLE_ID_DISCARD\n        const float writeId = 1.0;\n    #endif\n    outId = vec4(dbId.rgb, writeId);\n    #ifdef MODEL_COLOR\n        outModelId = vec4(modelId.rgb, writeId);\n    #endif\n#elif defined(ID_COLOR)\n    #ifdef ENABLE_ID_DISCARD\n        if (writeId==0.0) {\n            discard;\n        }\n    #endif\n    gl_FragColor = vec4(dbId.rgb, 1.0);\n#elif defined(MODEL_COLOR)\n    #ifdef ENABLE_ID_DISCARD\n        if (writeId==0.0) {\n            discard;\n        }\n    #endif\n    gl_FragColor = vec4(modelId.rgb, 1.0);\n#endif\n"},"./src/wgs/render/chunks/id_vert.glsl":function(e,t){e.exports="\n#ifdef USE_VERTEX_ID\nvId = id;\n#endif\n"},"./src/wgs/render/chunks/instancing_decl_vert.glsl":function(e,t){e.exports="\n#ifdef USE_INSTANCING\nattribute vec3 instOffset;\nattribute vec4 instRotation;\nattribute vec3 instScaling;\nvec3 applyQuaternion(vec3 p, vec4 q) {\n    return p + 2.0 * cross(q.xyz, cross(q.xyz, p) + q.w * p);\n}\nvec3 getInstancePos(vec3 pos) {\n    return instOffset + applyQuaternion(instScaling * pos, instRotation);\n}\nvec3 getInstanceNormal(vec3 normal) {\n    return applyQuaternion(normal/instScaling, instRotation);\n}\n#else\nvec3 getInstancePos(vec3 pos)       { return pos;    }\nvec3 getInstanceNormal(vec3 normal) { return normal; }\n#endif\n"},"./src/wgs/render/chunks/line_decl_common.glsl":function(e,t){e.exports="\n#define LINE_2D_SHADER 1\n#define TAU     6.28318530718\n#define PI      3.14159265358979\n#define HALF_PI 1.57079632679\n#define PI_0_5  HALF_PI\n#define PI_1_5  4.71238898038\n#define ENABLE_ID_DISCARD\n#define VBB_GT_TRIANGLE_INDEXED  0.0\n#define VBB_GT_LINE_SEGMENT      1.0\n#define VBB_GT_ARC_CIRCULAR      2.0\n#define VBB_GT_ARC_ELLIPTICAL    3.0\n#define VBB_GT_TEX_QUAD          4.0\n#define VBB_GT_ONE_TRIANGLE      5.0\n#define VBB_GT_MSDF_TRIANGLE_INDEXED 6.0\n#define VBB_INSTANCED_FLAG   0.0\n#define VBB_SEG_START_RIGHT  0.0\n#define VBB_SEG_START_LEFT   1.0\n#define VBB_SEG_END_RIGHT    2.0\n#define VBB_SEG_END_LEFT     3.0\n#define LTSCALE 0.25\nvarying vec4 fsColor;\nvarying vec2 fsOffsetDirection;\nvarying vec4 fsMultipurpose;\nvarying float fsHalfWidth;\nvarying vec2 fsVpTC;\nvarying float fsGhosting;\n#ifdef LOADING_ANIMATION\nvarying float loadingProgress;\n#endif\n"},"./src/wgs/render/chunks/normal_map.glsl":function(e,t){e.exports="#if defined(USE_SURFACE_NORMAL_MAP) || defined( USE_LAYERED_NORMAL_MAP ) || defined( USE_TILING_NORMAL )\nvoid heightMapTransform(\n    sampler2D bumpTexture,\n    vec2 uv,\n    mat3 transform,\n    vec2 bumpScale,\n    inout vec3 T,\n    inout vec3 B,\n    inout vec3 N\n) {\n    vec2 st = (transform * vec3(uv, 1.0)).xy;\n    mat3 mtxTangent = mat3(T, B, N);\n    T = normalize(mtxTangent * (transform * vec3(1.0, 0.0, 0.0)));\n    B = normalize(mtxTangent * (transform * vec3(0.0, 1.0, 0.0)));\n    const float oneThird = 1.0 / 3.0;\n    vec3 avg = vec3(oneThird, oneThird, oneThird);\n    vec2 offset = fwidth(st);\n    float h0 = dot(texture2D(bumpTexture, st).xyz, avg);\n    float hx = dot(texture2D(bumpTexture, st + vec2(offset.x, 0.0)).xyz, avg);\n    float hy = dot(texture2D(bumpTexture, st + vec2(0.0, offset.y)).xyz, avg);\n    vec2 diff = vec2(h0 - hx, h0 - hy) / offset;\n    N = normalize(\n        N + (\n            diff.x * T * bumpScale.x +\n            diff.y * B * bumpScale.y\n        )\n    );\n}\nvoid normalMapTransform(\n    sampler2D bumpTexture,\n    vec2 uv,\n    mat3 transform,\n    vec2 bumpScale,\n    inout vec3 T,\n    inout vec3 B,\n    inout vec3 N\n) {\n    vec2 st = (transform * vec3(uv, 1.0)).xy;\n    vec3 mapN =  2.0 * texture2D(bumpTexture, st).xyz - 1.0;\n    mapN.xy *= bumpScale.x;\n    mapN.z *= bumpScale.y;\n    vec3 v = vec3(mapN.y, -mapN.x, 0.0);\n    float c = -mapN.z;\n    mat3 skewV = mat3(\n        0.0, v.z, -v.y,\n        -v.z, 0.0, v.x,\n        v.y, -v.x, 0.0\n    );\n    mat3 rot = mat3(1.0) + skewV + skewV*skewV * 1.0/(1.0-c);\n    N *= rot;\n    T *= rot;\n    B *= rot;\n}\n#endif\n"},"./src/wgs/render/chunks/ordered_dither.glsl":function(e,t){e.exports="vec3 orderedDithering(vec3 col) {\n    const vec4 m0 = vec4( 1.0, 13.0,  4.0, 16.0);\n    const vec4 m1 = vec4( 9.0,  5.0, 12.0,  8.0);\n    const vec4 m2 = vec4( 3.0, 15.0,  2.0, 14.0);\n    const vec4 m3 = vec4(11.0,  7.0, 10.0,  6.0);\n    int i = int(mod(float(gl_FragCoord.x), 4.0));\n    int j = int(mod(float(gl_FragCoord.y), 4.0));\n    vec4 biasRow;\n    if      (i==0) biasRow = m0;\n    else if (i==1) biasRow = m1;\n    else if (i==2) biasRow = m2;\n    else           biasRow = m3;\n    float bias;\n    if      (j==0) bias = biasRow.x;\n    else if (j==1) bias = biasRow.y;\n    else if (j==2) bias = biasRow.z;\n    else           bias = biasRow.w;\n    return col + bias / 17.0 / 256.0;\n}\n";
},"./src/wgs/render/chunks/pack_depth.glsl":function(e,t){e.exports="\nvec4 packDepth( const in float depth ) {\n    vec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\n    enc = fract(enc);\n    enc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\n    return enc;\n}\nfloat unpackDepth( const in vec4 rgba_depth ) {\n    return dot( rgba_depth, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0) );\n}\n"},"./src/wgs/render/chunks/pack_normals.glsl":function(e,t){e.exports="\n#define kPI 3.14159265358979\nvec2 encodeNormal (vec3 n) {\n    return (vec2(atan(n.y,n.x)/kPI, n.z)+1.0)*0.5;\n}\nvec3 decodeNormal (vec2 enc) {\n    vec2 ang = enc * 2.0 - 1.0;\n    vec2 scth = vec2(sin(ang.x * kPI), cos(ang.x * kPI));\n    vec2 scphi = vec2(sqrt(1.0 - ang.y * ang.y), ang.y);\n    return vec3(scth.y * scphi.x, scth.x * scphi.x, scphi.y);\n}\n"},"./src/wgs/render/chunks/point_size.glsl":function(e,t){e.exports="gl_PointSize = point_size;"},"./src/wgs/render/chunks/prism_glazing.glsl":function(e,t){e.exports="\nvec3 TransmitAdjust(vec3 transmission, vec3 f0) \n{ \n   vec3 limit = max(1.0 - f0, 0.00001); \n   return clamp(transmission, vec3(0.0, 0.0, 0.0), limit) / limit; \n} \nfloat ColorToIlluminance(in vec3 color) \n{ \n   const vec3 rgb2grey = vec3(0.299, 0.587, 0.114); \n   float illuminance = dot(rgb2grey, color); \n   return illuminance; \n} \nvoid applyPrismGlazingOpacity(\n    inout vec4 color,\n    vec3 transmissionF,\n    float transmissionAlpha,\n    float NdotV,\n    float glazingIlluminace) \n{\n    const float third = 1.0/3.0; \n    float transSurface = exp(-(transmissionAlpha + (transmissionAlpha < 0.0025 ? 0.0 : 0.25)) * NdotV * PI); \n    float opacity = 1.0- dot((1.0 - transmissionF), vec3(third,third,third)) * transSurface * glazingIlluminace; \n    opacity = clamp(opacity, 0.01, 0.99);\n    color.a *= opacity;\n} \n"},"./src/wgs/render/chunks/prism_transparency.glsl":function(e,t){e.exports="void applyPrismTransparency(\n    inout vec4 color,\n    vec3 transparentColor,\n    float transparentIor\n) {\n    float fsLevel = max(max(color.r, color.g), color.b);\n    color = vec4(color.rgb/fsLevel, fsLevel);\n    float transLevel = min(min(transparentColor.r, transparentColor.g), transparentColor.b);\n    transLevel = min( (1.0 - surface_roughness), transLevel );\n    float transAlpha = (1.0 - transLevel) * 0.4 + surface_roughness * 0.55;\n    vec3 tr_g_color = sqrt(transparentColor);\n    vec4 transColor = vec4(0.5 * vec3(tr_g_color), transAlpha);\n    float strength = 1.0 - (1.0 - fsLevel) * (1.0 - fsLevel);\n    color = mix(transColor, color, strength);\n    color.a = max(color.a, 0.05);\n    if (transparentIor == 1.0 && tr_g_color == vec3(1.0)) {\n        color.a = 0.0;\n    }\n}"},"./src/wgs/render/chunks/prism_wood.glsl":function(e,t){e.exports="#if defined( PRISMWOOD )\n#define ONE 0.00390625\nfloat GetIndexedValue(vec4 array, int index)\n{\n    if (index == 0)\n        return array[0];\n    else if (index == 1)\n        return array[1];\n    else if (index == 2)\n        return array[2];\n    else if (index == 3)\n        return array[3];\n    else\n        return 0.0;\n}\nint GetIndexedValue(ivec2 array, int index)\n{\n    if (index == 0)\n        return array[0];\n    else if (index == 1)\n        return array[1];\n    else\n        return 0;\n}\n#if defined( USE_WOOD_CURLY_DISTORTION_MAP )\nfloat SampleCurlyPattern(vec2 uv)\n{\n    vec2 uv_wood_curly_distortion_map = (wood_curly_distortion_map_texMatrix * vec3(uv, 1.0)).xy;\n    WOOD_CURLY_DISTORTION_CLAMP_TEST;\n    vec3 curlyDistortion = texture2D(wood_curly_distortion_map, uv_wood_curly_distortion_map).xyz;\n    if(wood_curly_distortion_map_invert) curlyDistortion = vec3(1.0) - curlyDistortion;\n    return curlyDistortion.r;\n}\nvec3 DistortCurly(vec3 p)\n{\n    if (!wood_curly_distortion_enable) return p;\n    float r = length(p.xy);\n    if (r < 0.00001) return p;\n    const float INV_ANGLE_INTERVAL = 1.27323954;\n    const float NUM_INTERVAL = 8.0;\n    float theta = atan(p.y, p.x);\n    if (theta < 0.0)\n        theta += PI2;\n    float intIdx = theta * INV_ANGLE_INTERVAL;\n    int idx0 = int(mod(floor(intIdx), NUM_INTERVAL));\n    int idx1 = int(mod(ceil(intIdx), NUM_INTERVAL));\n    const vec4 HASH_TABLE1 = vec4(0.450572,0.114598, 0.886043, 0.315119);\n    const vec4 HASH_TABLE2 = vec4(0.216133,0.306264, 0.685616, 0.317907);\n    float offset0 = idx0 < 4 ? GetIndexedValue(HASH_TABLE1, idx0) : GetIndexedValue(HASH_TABLE2, idx0-4);\n    float offset1 = idx1 < 4 ? GetIndexedValue(HASH_TABLE1, idx1) : GetIndexedValue(HASH_TABLE2, idx1-4);\n    const float maxOffset = 100.0;\n    offset0 = (offset0 - 0.5) * maxOffset;\n    offset1 = (offset1 - 0.5) * maxOffset;\n    vec2 uv0 = vec2(p.z + offset0, r);\n    float shiftWeight0 =  SampleCurlyPattern(uv0);\n    vec2 uv1 = vec2(p.z + offset1, r);\n    float shiftWeight1 =  SampleCurlyPattern(uv1);\n    float interpWeight = fract(intIdx);\n    float shiftWeight = mix(shiftWeight0, shiftWeight1, interpWeight);\n    const float INV_MIN_RADIUS = 2.0;\n    float shiftWeightAdjust = smoothstep(0.0, 1.0, r * INV_MIN_RADIUS);\n    r -= wood_curly_distortion_scale * (shiftWeight * shiftWeightAdjust);\n    float thetaNew = atan(p.y, p.x);\n    vec3 pNew = p;\n    pNew.x = r * cos(thetaNew);\n    pNew.y = r * sin(thetaNew);\n    return pNew;\n}\n#endif\nvec3 un2sn(vec3 range)\n{\n    return range * 2.0 - 1.0;\n}\nfloat inoise(vec3 p)\n{\n    vec3 modp = mod(floor(p), 256.0);\n    modp.xy = modp.xy * ONE;\n    vec4 AA = texture2D(perm2DMap, vec2(modp.x, modp.y), 0.0) * 255.0;\n    AA = AA + modp.z;\n    AA = mod(floor(AA), 256.0);\n    AA *= ONE;\n    vec3 gradx1 = un2sn(texture2D(permGradMap,vec2(AA.x,0.0),0.0).xyz);\n    vec3 grady1 = un2sn(texture2D(permGradMap,vec2(AA.y,0.0),0.0).xyz);\n    vec3 gradz1 = un2sn(texture2D(permGradMap,vec2(AA.z,0.0),0.0).xyz);\n    vec3 gradw1 = un2sn(texture2D(permGradMap,vec2(AA.w,0.0),0.0).xyz);\n    vec3 gradx2 = un2sn(texture2D(permGradMap,vec2(AA.x + ONE,0.0),0.0).xyz);\n    vec3 grady2 = un2sn(texture2D(permGradMap,vec2(AA.y + ONE,0.0),0.0).xyz);\n    vec3 gradz2 = un2sn(texture2D(permGradMap,vec2(AA.z + ONE,0.0),0.0).xyz);\n    vec3 gradw2 = un2sn(texture2D(permGradMap,vec2(AA.w + ONE,0.0),0.0).xyz);\n    p -= floor(p);\n    vec3 fadep = p * p * p * (p * (p * 6.0 - 15.0) + 10.0);\n    return mix( mix( mix( dot(gradx1, p ),\n                          dot(gradz1, p + vec3(-1.0, 0.0, 0.0)), fadep.x),\n                     mix( dot(grady1, p + vec3(0.0, -1.0, 0.0)),\n                          dot(gradw1, p + vec3(-1.0, -1.0, 0.0)), fadep.x), fadep.y),\n                mix( mix( dot(gradx2, p + vec3(0.0, 0.0, -1.0)),\n                          dot(gradz2, p + vec3(-1.0, 0.0, -1.0)), fadep.x),\n                     mix( dot(grady2, p + vec3(0.0, -1.0, -1.0)),\n                          dot(gradw2, p + vec3(-1.0, -1.0, -1.0)), fadep.x), fadep.y), fadep.z);\n}\nfloat inoise(float p)\n{\n    float modp = mod(floor(p), 256.0);\n    modp = (modp + 256.0) * ONE;\n    float permx = texture2D(permutationMap, vec2(modp, 0.0), 0.0).r;\n    float gradx = texture2D(gradientMap, vec2(permx, 0.0), 0.0).r*2.0-1.0;\n    float permy = texture2D(permutationMap, vec2(modp + ONE, 0.0), 0.0).r;\n    float grady = texture2D(gradientMap, vec2(permy, 0.0), 0.0).r*2.0-1.0;\n    p -= floor(p);\n    float fadep = p * p * p * (p * (p * 6.0 - 15.0) + 10.0);\n    return mix(gradx * p, grady * (p - 1.0), fadep);\n}\nfloat multiband_inoise(vec3 p, int bands, vec4 w, vec4 f)\n{\n    float noise = 0.0;\n    for(int i = 0; i < 4; ++i)\n    {\n        if (i >= bands) break;\n        noise += GetIndexedValue(w, i) * inoise(p * GetIndexedValue(f, i));\n    }\n    return noise;\n}\nfloat multiband_inoise(float p, int bands, vec4 w, vec4 f)\n{\n    float noise = 0.0;\n    for(int i = 0; i < 4; ++i)\n    {\n        if (i >= bands) break;\n        noise += GetIndexedValue(w, i) * inoise(p * GetIndexedValue(f, i));\n    }\n    return noise;\n}\nvec3 Distort3DCosineRadialDir(vec3 p)\n{\n    float radius = length(p.xy);\n    if (radius < 0.00001) return p;\n    vec2 theta = p.xy / radius;\n    float radiusShift = 0.0;\n    for (int i = 0; i < 4; ++i)\n    {\n        if (i >= wood_fiber_cosine_bands) break;\n        radiusShift += GetIndexedValue(wood_fiber_cosine_weights, i) * cos(p.z * RECIPROCAL_PI2 * GetIndexedValue(wood_fiber_cosine_frequencies, i));\n    }\n    const float MIN_RADIUS = 1.5;\n    float weight = clamp(radius / MIN_RADIUS, 0.0, 1.0);\n    if(weight >= 0.5)\n        weight = weight * weight * (3.0 - (weight + weight));\n    p.xy += theta * radiusShift * weight;\n    return p;\n}\nvec3 Distort3DPerlin(vec3 p)\n{\n    vec3 pAniso = vec3(p.xy, p.z * wood_fiber_perlin_scale_z);\n    p.xy += multiband_inoise(pAniso, wood_fiber_perlin_bands, wood_fiber_perlin_weights, wood_fiber_perlin_frequencies);\n    return p;\n}\nvec3 Distort(vec3 p)\n{\n    if(wood_fiber_cosine_enable)\n        p = Distort3DCosineRadialDir(p);\n    if(wood_fiber_perlin_enable)\n        p = Distort3DPerlin(p);\n    return p;\n}\nfloat DistortRadiusLength(float radiusLength)\n{\n    radiusLength += multiband_inoise(radiusLength, wood_growth_perlin_bands, wood_growth_perlin_weights, wood_growth_perlin_frequencies);\n    if (radiusLength < 0.0) radiusLength = 0.0;\n    return radiusLength;\n}\nfloat ComputeEarlyWoodRatio(float radiusLength)\n{\n    float fraction = mod(radiusLength, wood_ring_thickness) / wood_ring_thickness;\n    if (fraction <= wood_ring_fraction.y)\n       return 1.0;\n    else if(fraction <= wood_ring_fraction.x)\n       return (1.0 - (fraction - wood_ring_fraction.y) / wood_fall_rise.x);\n    else if(fraction <= wood_ring_fraction.w)\n       return 0.0;\n    else\n       return ((fraction - wood_ring_fraction.w) / wood_fall_rise.y);\n}\nvec3 DistortEarlyColor(vec3 earlyColor, float radiusLength)\n{\n    float expValue = 1.0 + multiband_inoise(radiusLength,wood_earlycolor_perlin_bands,wood_earlycolor_perlin_weights,wood_earlycolor_perlin_frequencies);\n    earlyColor = pow(abs(earlyColor), vec3(expValue));\n    return earlyColor;\n}\nvec3 DistortLateColor(vec3 lateColor, float radiusLength)\n{\n    float expValue = 1.0 + multiband_inoise(radiusLength,wood_latecolor_perlin_bands,wood_latecolor_perlin_weights,wood_latecolor_perlin_frequencies);\n    lateColor = pow(abs(lateColor), vec3(expValue));\n    return lateColor;\n}\nvec3 DistortDiffuseColor(vec3 diffAlbedo, vec3 p)\n{\n    p.z *= wood_diffuse_perlin_scale_z;\n    float expValue = 1.0 + multiband_inoise(p, wood_diffuse_perlin_bands, wood_diffuse_perlin_weights, wood_diffuse_perlin_frequencies);\n    diffAlbedo = pow(abs(diffAlbedo), vec3(expValue));\n    return diffAlbedo;\n}\nfloat LayerRoughnessVar(float roughness, float earlyWoodRatio)\n{\n    return earlyWoodRatio * wood_groove_roughness + (1.0 - earlyWoodRatio) * roughness;\n}\nfloat hashword(vec2 k)\n{\n    k = mod(k, vec2(256.0)) * ONE;\n    float a = texture2D(permutationMap, vec2(k.x, 0.0)).x + k.y ;\n    a = texture2D(permutationMap, vec2(a, 0.0)).x ;\n    return a*255.0;\n}\nfloat wyvillsq(float rsq)\n{\n    if (rsq >= 1.0) return 0.0;\n    float tmp = 1.0 - rsq;\n    return tmp*tmp*tmp;\n}\nfloat Weight2DNeighborImpulses(vec3 p, float woodWeight)\n{\n    if(woodWeight <= 0.0) return 0.0;\n    float poreRadius = wood_pore_radius * woodWeight;\n    vec2 left = floor((p.xy - poreRadius) / wood_pore_cell_dim);\n    vec2 right = floor((p.xy + poreRadius) / wood_pore_cell_dim);\n    float weight = 0.0;\n    float invRsq = 1.0 / (poreRadius * poreRadius);\n    const float norm =  1.0 / 15.0;\n    for (int j = 0; j <= 4; j++)\n    {\n        if (j > int(right.y - left.y)) continue;\n        for (int i = 0; i <= 4; i++)\n        {\n            if (i > int(right.x - left.x)) continue;\n            vec2 pij = vec2(float(i) + left.x,float(j) + left.y);\n            float hRNum = hashword(pij);\n            float impPosX = mod(hRNum, 16.0) * norm;\n            float impPosY = floor(hRNum / 16.0) * norm;\n            impPosX = (pij.x + impPosX)* wood_pore_cell_dim;\n            impPosY = (pij.y + impPosY)* wood_pore_cell_dim;\n            float dsq = (p.x - impPosX) * (p.x - impPosX) + (p.y - impPosY) * (p.y - impPosY);\n            weight += wyvillsq(dsq * invRsq);\n        }\n    }\n    return weight;\n}\nfloat Weight3DRayImpulses(vec3 p)\n{\n    int segIdx = int(floor(p.z / wood_ray_seg_length_z));\n    float factor = p.z / wood_ray_seg_length_z - float(segIdx);\n    int segIdx1 = segIdx - 1;\n    if ( factor > 0.5 )\n        segIdx1 = segIdx + 1;\n    float theta = atan(p.y, p.x);\n    float sliceIdx = floor(((theta + PI) * RECIPROCAL_PI2) * wood_ray_num_slices);\n    if ( sliceIdx == wood_ray_num_slices)\n        sliceIdx-=1.0;\n    ivec2 arrSegs = ivec2(segIdx, segIdx1);\n    float weight = 0.0;\n    const float norm =  1.0 / 15.0;\n    float radialOffset = 5.0;\n    float radialLength = length(p.xy);\n    for (int seg = 0; seg < 2; seg++)\n    {\n        float hRNum = hashword(vec2(sliceIdx, GetIndexedValue(arrSegs, seg)));\n        float rn1 = mod(hRNum,16.0) * norm;\n        if (radialLength < radialOffset * rn1)\n            continue;\n        float rayTheta = rn1;\n        rayTheta = ( ( sliceIdx + rayTheta ) / wood_ray_num_slices ) * ( 2.0 * PI ) - PI;\n        float rayPosZ = (hRNum/16.0)* norm;\n        rayPosZ = ( float(GetIndexedValue(arrSegs, seg)) + rayPosZ ) * wood_ray_seg_length_z;\n        vec3 pt1 = vec3(0.0);\n        vec3 pt2 = vec3(cos(rayTheta), sin(rayTheta), 0.0);\n        vec3 p1 = p;\n        p1.z -= rayPosZ;\n        p1.z /=  wood_ray_ellipse_z2x;\n        vec3 v1 = pt2 - pt1;\n        vec3 v2 = pt1 - p1;\n        v2 = cross(v1, v2);\n        float dist = length(v2) / length(v1);\n        float invRsq = 1.0 / ( wood_ray_ellipse_radius_x * wood_ray_ellipse_radius_x);\n        weight += wyvillsq( (dist * dist) * invRsq );\n    }\n    return weight;\n}\nvec3 DarkenColorWithPores(vec3 p, vec3 diffColor, float woodWeight)\n{\n    float poresWeight = Weight2DNeighborImpulses(p, woodWeight);\n    float a = wood_pore_color_power - 1.0;\n    float b = 1.0;\n    float y = a * poresWeight + b;\n    return pow(abs(diffColor), vec3(y));\n}\nvec3 DarkenColorWithRays(vec3 p, vec3 diffColor)\n{\n    float raysWeight = Weight3DRayImpulses(p);\n    float a = wood_ray_color_power - 1.0;\n    float b = 1.0;\n    float y = a * raysWeight + b;\n    return pow(abs(diffColor), vec3(y));\n}\nfloat ComputeWoodWeight(float earlyWoodRatio)\n{\n    float woodWeight = 0.0;\n    if (wood_pore_type == 0)\n        woodWeight = 1.0;\n    else if (wood_pore_type == 1)\n        woodWeight = earlyWoodRatio;\n    else if (wood_pore_type == 2)\n        woodWeight = 1.0 - earlyWoodRatio;\n    else\n        woodWeight = -1.0;\n    return woodWeight;\n}\n#if defined( PRISMWOODBUMP )\nfloat ComputeEarlyWoodRatioAA(float radiusLength, float invUnitExt)\n{\n    float transPixels = min(wood_fall_rise.x, wood_fall_rise.y) * wood_ring_thickness * invUnitExt;\n    float samplesf = clamp(4.0 / transPixels, 1.0, 4.0);\n    int samples = int(samplesf);\n    float inverseSamples = 1.0 / float(samples);\n    vec2 rdelta = vec2(dFdx(radiusLength), dFdy(radiusLength)) * inverseSamples;\n    float earlywoodRatio = 0.0;\n    for (int i = 0; i < 4; ++i)\n    {\n        if (i >= samples) break;\n        for (int j = 0; j < 4; ++j)\n        {\n            if (j >= samples) break;\n            float r = radiusLength + dot(vec2(i, j), rdelta);\n            earlywoodRatio += ComputeEarlyWoodRatio(r);\n        }\n    }\n    return earlywoodRatio * (inverseSamples * inverseSamples);\n}\nfloat LatewoodDepthVariation(float invUnitExt)\n{\n    float transPixels = min(wood_fall_rise.x, wood_fall_rise.y) * wood_ring_thickness * invUnitExt;\n    return clamp(transPixels * 0.5, 0.0, 1.0);\n}\nfloat LatewoodHeightVariation(float earlyWoodRatio, float latewoodBumpDepth,\n                              float depthVar)\n{\n    return ( 1.0 - earlyWoodRatio ) * latewoodBumpDepth * depthVar;\n}\nfloat PoreDepthVariation(float woodWeight, float invUnitExt)\n{\n    float porePixels = woodWeight * wood_pore_radius * invUnitExt;\n    return clamp(porePixels, 0.0, 1.0);\n}\nfloat PoreHeightVariation(float earlyWoodRatio, float poresWeight, float poreDepth,\n                          float depthVar)\n{\n    return poresWeight * (-1.0 * poreDepth) * depthVar;\n}\nvoid ComputeTangents(vec3 normal, out vec3 u, out vec3 v)\n{\n    float scale = normal.z < 0.0 ? -1.0 : 1.0;\n    vec3 temp = scale * normal;\n    float e    = temp.z;\n    float h    = 1.0/(1.0 + e);\n    float hvx  = h   *  temp.y;\n    float hvxy = hvx * -temp.x;\n    u = vec3(e + hvx * temp.y, hvxy,                -temp.x);\n    v = vec3(hvxy,             e + h * temp.x * temp.x, -temp.y);\n    u *= scale;\n    v *= scale;\n}\nvec3 WoodBumpHeight(float heightLeft, float heightRight, float heightBack, float heightFront)\n{\n    const float epsilon = 0.001;\n    float heightDeltaX = heightRight - heightLeft;\n    vec3 Tu = vec3(2.0 * epsilon, 0.0, heightDeltaX);\n    float heightDeltaY = heightFront - heightBack;\n    vec3 Tv = vec3(0.0, 2.0 * epsilon, heightDeltaY);\n    return cross(Tu, Tv);\n}\nvec3 SelectNormal(vec3 N, vec3 bumpN, vec3 V)\n{\n    float bumpNdotV = dot(bumpN, V);\n    if(bumpNdotV > 0.0)\n        return bumpN;\n    else return N;\n}\nfloat MinInverseUnitExtent(vec3 p)\n{\n    return 1.0 / max(max(length(dFdx(p.xy)), length(dFdy(p.xy))), 0.000001);\n}\nfloat HeightVariation(vec3 pos)\n{\n    vec3 p = Distort(pos);\n    float radiusLength = length(p.xy);\n    if (wood_growth_perlin_enable)\n        radiusLength = DistortRadiusLength(radiusLength);\n    float invUnitExt = MinInverseUnitExtent(p);\n    float earlyWoodRatio = ComputeEarlyWoodRatioAA(radiusLength, invUnitExt);\n    float woodWeight = ComputeWoodWeight(earlyWoodRatio);\n    float poresWeight = Weight2DNeighborImpulses(p, woodWeight);\n    float depthVar = PoreDepthVariation(woodWeight, invUnitExt);\n    float poreHeightVariation = -1.0 * poresWeight * wood_pore_depth * depthVar;\n    float latewoodHeightVariation = 0.0;\n    if (wood_use_latewood_bump)\n    {\n        float latewoodDepthVar = LatewoodDepthVariation(invUnitExt);\n        latewoodHeightVariation = (1.0 - earlyWoodRatio) * wood_latewood_bump_depth * latewoodDepthVar;\n    }\n    float sumHeightVariation = poreHeightVariation + latewoodHeightVariation;\n    return sumHeightVariation;\n}\n#endif\nvec3 NoiseWood(vec3 p, inout float roughness)\n{\n    p = Distort(p);\n    float radiusLength = length(p.xy);\n    if(wood_growth_perlin_enable)\n        radiusLength = DistortRadiusLength(radiusLength);\n#if defined( PRISMWOODBUMP )\n    float invUnitExt = MinInverseUnitExtent( p );\n    float earlyWoodRatio = ComputeEarlyWoodRatioAA(radiusLength, invUnitExt);\n#else\n    float earlyWoodRatio = ComputeEarlyWoodRatio(radiusLength);\n#endif\n    vec3 earlyColor = wood_early_color;\n    if (wood_earlycolor_perlin_enable)\n        earlyColor = DistortEarlyColor(earlyColor, radiusLength);\n    vec3 lateColor;\n    if (wood_use_manual_late_color)\n        lateColor = wood_manual_late_color;\n    else\n        lateColor = pow(abs(earlyColor), vec3(wood_late_color_power));\n    if(wood_latecolor_perlin_enable)\n        lateColor = DistortLateColor(lateColor, radiusLength);\n    vec3 diffAlbedo = earlyWoodRatio * earlyColor + (1.0 - earlyWoodRatio) * lateColor;\n    if(wood_diffuse_perlin_enable)\n        diffAlbedo = DistortDiffuseColor(diffAlbedo, p);\n    if (wood_use_pores)\n    {\n        float woodWeight = ComputeWoodWeight(earlyWoodRatio);\n        diffAlbedo = DarkenColorWithPores(p, diffAlbedo, woodWeight);\n    }\n    if (wood_use_rays)\n        diffAlbedo = DarkenColorWithRays(p, diffAlbedo);\n    if(wood_use_groove_roughness)\n        roughness = LayerRoughnessVar(roughness, earlyWoodRatio);\n    return clamp(diffAlbedo, vec3(0.0), vec3(1.0));\n}\n#if defined(PRISMWOODBUMP)\nvoid getFinalWoodContext(\n    inout vec3 N, vec3 V, inout vec3 Tu, inout vec3 Tv, vec3 p,\n    vec3 geoNormal, vec3 tNormal, mat3 normalMatrix\n) {\n    vec3 offsetTuLeft = p - 0.001 * Tu;\n    vec3 offsetTuRight = p + 0.001 * Tu;\n    vec3 offsetTvLeft = p - 0.001 * Tv;\n    vec3 offsetTvRight = p + 0.001 * Tv;\n    float heightVariationTuLeft = HeightVariation(offsetTuLeft);\n    float heightVariationTuRight = HeightVariation(offsetTuRight);\n    float heightVariationTvLeft = HeightVariation(offsetTvLeft);\n    float heightVariationTvRight = HeightVariation(offsetTvRight);\n    vec3 bumpHeight = WoodBumpHeight(heightVariationTuLeft, heightVariationTuRight, heightVariationTvLeft, heightVariationTvRight);\n    vec3 newNormal = normalize(bumpHeight.x * Tu + bumpHeight.y * Tv + bumpHeight.z * vtNormal);\n    vec3 newNormalView = normalize(vNormalMatrix * newNormal);\n    vec3 selectedNormal = SelectNormal(geoNormal, newNormalView, V);\n    ComputeTangents(selectedNormal, Tu, Tv);\n    Tu = normalize(Tu);\n    Tv = normalize(Tv);\n    N = faceforward(selectedNormal, -V, selectedNormal);\n}\n#endif\n#endif\n"},"./src/wgs/render/chunks/shadowmap_decl_common.glsl":function(e,t){e.exports="\nuniform float shadowESMConstant;\nuniform float shadowMapRangeMin;\nuniform float shadowMapRangeSize;\n"},"./src/wgs/render/chunks/shadowmap_decl_frag.glsl":function(e,t){e.exports="\n#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap;\nuniform vec2      shadowMapSize;\nuniform float     shadowDarkness;\nuniform float     shadowBias;\nuniform vec3      shadowLightDir;\nvarying vec4 vShadowCoord;\n#include<shadowmap_decl_common>\nfloat getShadowValue() {\n    float fDepth;\n    vec3 shadowColor = vec3( 1.0 );\n    vec3 shadowCoord = vShadowCoord.xyz / vShadowCoord.w;\n    shadowCoord.xyz = 0.5 * (shadowCoord.xyz + vec3(1.0, 1.0, 1.0));\n    bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n    bool inFrustum = all( inFrustumVec );\n    float shadowValue = 1.0;\n    if (inFrustum) {\n        shadowCoord.z = min(0.999, shadowCoord.z);\n        shadowCoord.z -= shadowBias;\n#ifdef USE_HARD_SHADOWS\n        vec4 rgbaDepth = texture2D( shadowMap, shadowCoord.xy );\n        float fDepth = rgbaDepth.r;\n        if ( fDepth < shadowCoord.z ) {\n            shadowValue = 1.0 - shadowDarkness;\n        }\n#else\n        vec4 rgbaDepth = texture2D( shadowMap, shadowCoord.xy );\n        float shadowMapValue = rgbaDepth.r;\n        shadowValue = exp(-shadowESMConstant * shadowCoord.z) * shadowMapValue;\n        shadowValue = min(shadowValue, 1.0);\n        shadowValue = mix(1.0 - shadowDarkness, 1.0, shadowValue);\n#endif\n    }\n    return shadowValue;\n}\n#else\nfloat getShadowValue() { return 1.0; }\n#endif\nvec3 applyEnvShadow(vec3 colorWithoutShadow, vec3 worldNormal) {\n#if defined(USE_SHADOWMAP)\n    float dp  = dot(shadowLightDir, worldNormal);\n    float dpValue = (dp + 1.0) / 2.0;\n    dpValue = min(1.0, dpValue * 1.5);\n    float sv = getShadowValue();\n    vec3 result = colorWithoutShadow * min(sv, dpValue);\n    return result;\n#else\n    return colorWithoutShadow;\n#endif\n}\n"},"./src/wgs/render/chunks/shadowmap_decl_vert.glsl":function(e,t){e.exports="\n#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord;\nuniform mat4 shadowMatrix;\n#endif\n"},"./src/wgs/render/chunks/shadowmap_vert.glsl":function(e,t){e.exports="\n#ifdef USE_SHADOWMAP\n{\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n    vShadowCoord = shadowMatrix * worldPosition;\n}\n#endif\n"},"./src/wgs/render/chunks/theming_decl_frag.glsl":function(e,t){e.exports="uniform vec4 themingColor;\n"},"./src/wgs/render/chunks/theming_frag.glsl":function(e,t){e.exports="gl_FragColor.rgb = mix(gl_FragColor.rgb, themingColor.rgb, themingColor.a);\n"},"./src/wgs/render/chunks/tonemap.glsl":function(e,t){e.exports="\nfloat luminance_post(vec3 rgb) {\n    return dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nfloat luminance_pre(vec3 rgb) {\n    return dot(rgb, vec3(0.212671, 0.715160, 0.072169));\n}\nvec3 xyz2rgb(vec3 xyz) {\n    vec3 R = vec3( 3.240479, -1.537150, -0.498535);\n    vec3 G = vec3(-0.969256,  1.875992,  0.041556);\n    vec3 B = vec3( 0.055648, -0.204043,  1.057311);\n    vec3 rgb;\n    rgb.b = dot(xyz, B);\n    rgb.g = dot(xyz, G);\n    rgb.r = dot(xyz, R);\n    return rgb;\n}\nvec3 rgb2xyz(vec3 rgb) {\n    vec3 X = vec3(0.412453, 0.35758, 0.180423);\n    vec3 Y = vec3(0.212671, 0.71516, 0.0721688);\n    vec3 Z = vec3(0.0193338, 0.119194, 0.950227);\n    vec3 xyz;\n    xyz.x = dot(rgb, X);\n    xyz.y = dot(rgb, Y);\n    xyz.z = dot(rgb, Z);\n    return xyz;\n}\nvec3 xyz2xyY(vec3 xyz) {\n    float sum = xyz.x + xyz.y + xyz.z;\n    sum = 1.0 / sum;\n    vec3 xyY;\n    xyY.z = xyz.y;\n    xyY.x = xyz.x * sum;\n    xyY.y = xyz.y * sum;\n    return xyY;\n}\nvec3 xyY2xyz(vec3 xyY) {\n    float x = xyY.x;\n    float y = xyY.y;\n    float Y = xyY.z;\n    vec3 xyz;\n    xyz.y = Y;\n    xyz.x = x * (Y / y);\n    xyz.z = (1.0 - x - y) * (Y / y);\n    return xyz;\n}\nfloat toneMapCanon_T(float x)\n{\n    float xpow = pow(x, 1.60525727);\n    float tmp = ((1.05542877*4.68037409)*xpow) / (4.68037409*xpow + 1.0);\n    return clamp(tmp, 0.0, 1.0);\n}\nconst float Shift = 1.0 / 0.18;\nfloat toneMapCanonFilmic_NoGamma(float x) {\n    x *= Shift;\n    const float A = 0.2;\n    const float B = 0.34;\n    const float C = 0.002;\n    const float D = 1.68;\n    const float E = 0.0005;\n    const float F = 0.252;\n    const float scale = 1.0/0.833837;\n    return (((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F) * scale;\n}\nvec3 toneMapCanonFilmic_WithGamma(vec3 x) {\n    x *= Shift;\n    const float A = 0.27;\n    const float B = 0.29;\n    const float C = 0.052;\n    const float D = 0.2;\n    const float F = 0.18;\n    const float scale = 1.0/0.897105;\n    return (((x*(A*x+C*B))/(x*(A*x+B)+D*F))) * scale;\n}\nvec3 toneMapCanonOGS_WithGamma_WithColorPerserving(vec3 x) {\n    vec3 outColor = x.rgb;\n    outColor = min(outColor, vec3(3.0));\n    float inLum = luminance_pre(outColor);\n    if (inLum > 0.0) {\n        float outLum = toneMapCanon_T(inLum);\n        outColor = outColor * (outLum / inLum);\n        outColor = clamp(outColor, vec3(0.0), vec3(1.0));\n    }\n    float gamma = 1.0/2.2;\n    outColor = pow(outColor, vec3(gamma));\n    return outColor;\n}\n"},"./src/wgs/render/chunks/wide_lines_decl.glsl":function(e,t){e.exports="\n#ifdef WIDE_LINES\nattribute vec3 prev;\nattribute vec3 next;\nattribute float side;\nuniform vec2 view_size;\nvec2 to2d(vec4 i) {\n  return i.xy / i.w;\n}\n#endif\n"},"./src/wgs/render/chunks/wide_lines_vert.glsl":function(e,t){e.exports="\n#ifdef WIDE_LINES\nvec4 mvpPosition = projectionMatrix * mvPosition; \nmat3 vectorMatrix = mat3(modelViewMatrix);\nvec2 _pos = to2d(mvpPosition) * view_size;\nvec2 _prev = to2d(projectionMatrix * vec4(mvPosition.xyz + vectorMatrix * (prev * 0.01), 1.0)) * view_size;\nvec2 _next = to2d(projectionMatrix * vec4(mvPosition.xyz - vectorMatrix * (next * 0.01), 1.0)) * view_size;\nvec2 dir1 = _pos - _next;\nvec2 dir2 = _prev - _pos;\ndir2 = (length(dir2) > 0.0000001) ? normalize(dir2) : vec2(0.0, 0.0);\ndir1 = (length(dir1) > 0.0000001) ? normalize(dir1) : dir2;\nvec2 dir_sharp = normalize(dir1 + dir2);\nvec2 dir = normalize(dir1 + dir_sharp);\nvec2 offset = vec2(-dir.y, dir.x);\nfloat len = 1.0 / cross(vec3(offset, 0), vec3(dir1, 0)).z;\noffset *= len;\noffset /= view_size;\noffset *= side;\noffset *= mvpPosition.w;\nmvpPosition.xy += offset;\ngl_Position = mvpPosition;\n#endif\n"},"./src/wgs/render/shaders/background_frag.glsl":function(e,t){e.exports="varying vec3 vColor;\nvarying vec2 vUv;\nuniform samplerCube envMap;\nuniform vec3 uCamDir;\nuniform vec3 uCamUp;\nuniform vec2 uResolution;\nuniform float uHalfFovTan;\nuniform float opacity;\nuniform bool envMapBackground;\n#include<env_sample>\nconst int bloomRange = 4;\n#include<ordered_dither>\nuniform float envMapExposure;\n#if TONEMAP_OUTPUT > 0\nuniform float exposureBias;\n#include<tonemap>\n#endif\nvec3 rayDir(in vec2 vUv) {\n    vec3 A = (uResolution.x/uResolution.y)*normalize(cross(uCamDir,uCamUp)) * (uHalfFovTan * 2.0);\n    vec3 B = normalize(uCamUp) * (uHalfFovTan * 2.0);\n    vec3 C = normalize(uCamDir);\n    vec3 ray = normalize( C + (2.0*vUv.x-1.0)*A + (2.0*vUv.y-1.0)*B );\n    return ray;\n}\nvec3 getColor(in vec3 rd) {\n    return RGBMDecode(textureCube(envMap, adjustLookupVector(rd)), envMapExposure);\n}\nvoid main() {\n    vec3 rd = rayDir(vUv);\n    vec3 outColor;\n    if (envMapBackground) {\n        outColor = getColor(rd);\n#if TONEMAP_OUTPUT == 1\n        outColor = toneMapCanonOGS_WithGamma_WithColorPerserving(exposureBias * outColor);\n#elif TONEMAP_OUTPUT == 2\n        outColor = toneMapCanonFilmic_WithGamma(exposureBias * outColor);\n#endif\n    }\n    else {\n        outColor = vColor;\n    }\n    gl_FragColor = vec4(orderedDithering(outColor), opacity);\n}\n"},"./src/wgs/render/shaders/background_vert.glsl":function(e,t){e.exports="uniform vec3 color1;\nuniform vec3 color2;\nvarying vec2 vUv;\nvarying vec3 vColor;\nvoid main() {\n    if (uv.y == 0.0)\n        vColor = color2;\n    else\n        vColor = color1;\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},"./src/wgs/render/shaders/basic_frag.glsl":function(e,t){e.exports="uniform vec3 diffuse;\nuniform float opacity;\n#include<common>\n#include<color_pars_fragment>\n#include<map_pars_fragment>\n#include<alphamap_pars_fragment>\n#include<lightmap_pars_fragment>\n#include<envmap_pars_fragment>\n#include<specularmap_pars_fragment>\n#if NUM_CUTPLANES > 0\nvarying highp vec3 vWorldPosition;\n#endif\n#include<cutplanes>\n#include<id_decl_frag>\n#include<theming_decl_frag>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    vec3 outgoingLight = vec3( 0.0 );\n    vec4 diffuseColor = vec4( diffuse, opacity );\n#include<map_fragment>\n#include<color_fragment>\n#include<alphamap_fragment>\n#include<alphatest_fragment>\n#include<specularmap_fragment>\n    outgoingLight = diffuseColor.rgb;\n#include<lightmap_fragment>\n#include<envmap_fragment>\n#include<linear_to_gamma_fragment>\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    vec3 geomNormal = vec3(0.0,0.0,0.0);\n    float depth = 0.0;\n#include<theming_frag>\n#include<final_frag>\n}\n"},"./src/wgs/render/shaders/basic_vert.glsl":function(e,t){e.exports="#include<id_decl_vert>\n#include<decl_point_size>\n#include<common>\n#include<map_pars_vertex>\n#include<lightmap_pars_vertex>\n#include<envmap_pars_vertex>\n#include<color_pars_vertex>\n#include<wide_lines_decl>\n#include<pack_normals>\n#ifdef USE_INSTANCING\n    #include<instancing_decl_vert>\n#endif\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\nvoid main() {\n#ifdef USE_INSTANCING\n    vec3 instancePosition = getInstancePos(position);\n    #define position instancePosition\n#endif\n#if defined(USE_ENVMAP) && (defined(UNPACK_NORMALS) || defined(USE_INSTANCE))\n    vec3 correctNormal;\n    #ifdef UNPACK_NORMALS\n        correctNormal = decodeNormal(normal);\n    #else\n        correctNormal = normal;\n    #endif\n    #ifdef USE_INSTANCING\n        correctNormal = getInstanceNormal(correctNormal);\n    #endif\n    #define normal correctNormal\n#endif\n#include<map_vertex>\n#include<lightmap_vertex>\n#include<color_vertex>\n#ifdef USE_ENVMAP\n#include<defaultnormal_vertex>\n#endif\n#include<default_vertex>\n#include<wide_lines_vert>\n#include<worldpos_vertex>\n#if NUM_CUTPLANES > 0\n    vec4 _worldPosition = modelMatrix * vec4( position, 1.0 );\n    vWorldPosition = _worldPosition.xyz;\n#endif\n#include<envmap_vertex>\n#include<id_vert>\n#include<point_size>\n}\n"},"./src/wgs/render/shaders/blend_frag.glsl":function(e,t){e.exports="uniform sampler2D tDiffuse;\nuniform sampler2D tAO;\nuniform int useAO;\nuniform float aoOpacity;\nuniform sampler2D tOverlay;\nuniform int useOverlay;\nuniform vec2 resolution;\nuniform vec4 objIDv4;\nuniform sampler2D tID;\nuniform vec4 edgeObjIDv4;\n#if defined(USE_MODEL_ID)\nuniform vec2 modelIDv2;\nuniform sampler2D tID2;\nuniform vec2 edgeModelIDv2;\n#endif\nuniform float highlightIntensity;\nuniform vec3 selectionColor;\nuniform float highlightFullModel;\nuniform vec3 highlightColor;\n#ifdef IS_2D\nuniform float expand2dSelection;\n#endif\nuniform sampler2D tCrossFadeTex0;\nuniform sampler2D tCrossFadeTex1;\nuniform float     crossFadeOpacity0;\nuniform float     crossFadeOpacity1;\nvarying vec2 vUv;\n#ifdef SPATIAL_FILTER\n#include<depth_texture>\n#endif\n#include<tonemap>\n#ifdef USE_IDBUFFER_SELECTION\nbool isSelection(vec2 vUv, float I, float J) {\n    vec4 idAtPixel = texture2D(tID, vUv+resolution*vec2(I,J));\n    if (idAtPixel.rgb == vec3(0.0))\n        return false;\n#if defined(USE_MODEL_ID)\n    vec4 modelAtPixel = texture2D(tID2, vUv+resolution*vec2(I,J));\n    idAtPixel.a = modelAtPixel.b;\n    vec4 idDelta = abs(idAtPixel.rgba - edgeObjIDv4.rgba);\n    vec2 modelDelta = abs(modelAtPixel.rg - edgeModelIDv2.rg);\n#else\n    vec4 idDelta = vec4(abs(idAtPixel.rgb - edgeObjIDv4.rgb), 0.0);\n    vec2 modelDelta = vec2(0.0, 0.0);\n#endif\n    if (max(max(modelDelta.r, modelDelta.g), max(max(idDelta.r, idDelta.g), max(idDelta.b, idDelta.a))) < 1e-3) {\n        return true;\n    } else {\n        return false;\n    }\n}\n#else\nbool isSelected(vec3 C) {\n    float minS = min(selectionColor.r, min(selectionColor.g, selectionColor.b));\n    float maxS = max(selectionColor.r, max(selectionColor.g, selectionColor.b));\n    float satS = maxS - minS;\n    float minC = min(C.r, min(C.g, C.b));\n    float maxC = max(C.r, max(C.g, C.b));\n    float satC = maxC - minC;\n    if (satC < .01 || satS < .01)\n        return false;\n    vec3 S = (selectionColor - minS) / satS;\n    vec3 H = (C - minC) / satC;\n    vec3 D = H - S;\n    float eps = .15;\n    return (abs(D.r) + abs(D.g) + abs(D.b) < eps)\n        || (maxC >= (1.0 - eps) && D.r >= -eps && D.g >= -eps && D.b >= -eps);\n}\n#define IS_SELECTION(C) isSelected((C).rgb)\n#endif\nvec4 overlayEdgeDetect(vec2 vUv) {\n#ifdef IS_2D\n#define MAX_ALPHA(c)\n#define SUM_ALPHA(c, w) sumAlpha += c.a * w; sumWeight += w;\n#else\n#define MAX_ALPHA(c) maxAlpha = max(maxAlpha, c.a);\n#define SUM_ALPHA(c, w) \n#endif\n#ifdef USE_IDBUFFER_SELECTION\n#define CHECK_EDGE_ALPHA(I, J, W)     { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); MAX_ALPHA(c) if (c.a > 0.0 && isSelection(vUv, I, J)) { hasEdge++; SUM_ALPHA(c, W) selectionPixel = c; } }\n#else\n#define CHECK_EDGE_ALPHA(I, J, W)     { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); MAX_ALPHA(c) if (c.a > 0.0 && IS_SELECTION(c)) { hasEdge++; SUM_ALPHA(c, W) selectionPixel = c; } }\n#endif\n#ifndef IS_2D\n#define CHECK_EDGE_SELECTION(I, J) { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); MAX_ALPHA(c) if (c.a <= 0.0) hasEdge++; }\n#endif\n    int hasEdge = 0;\n    vec4 center = texture2D(tOverlay, vUv);\n    vec4 selectionPixel = vec4(0.0);\n#ifdef IS_2D\n    float sumAlpha = 0.0, sumWeight = 0.0;\n#else\n    float maxAlpha = 0.0;\n    bool paintOutline = false;\n#endif\n    if (center.a <= 0.0) {\n        CHECK_EDGE_ALPHA(-1.0,-1.0, 1.0);\n        CHECK_EDGE_ALPHA( 0.0,-1.0, 2.0);\n        CHECK_EDGE_ALPHA( 1.0,-1.0, 1.0);\n        CHECK_EDGE_ALPHA(-1.0, 0.0, 2.0);\n        CHECK_EDGE_ALPHA( 1.0, 0.0, 2.0);\n        CHECK_EDGE_ALPHA(-1.0, 1.0, 1.0);\n        CHECK_EDGE_ALPHA( 0.0, 1.0, 2.0);\n        CHECK_EDGE_ALPHA( 1.0, 1.0, 1.0);\n        if (hasEdge != 0) {\n#ifdef IS_2D\n            center.a = -clamp(expand2dSelection - 1.0 + sumAlpha / sumWeight, 0.0, 1.0);\n            center.rgb = center.a < 0.0 ? selectionPixel.rgb : center.rgb;\n#else\n            center = selectionPixel;\n            paintOutline = true;\n#endif\n        }\n    }\n#ifdef USE_IDBUFFER_SELECTION\n    else if (center.a > 0.0 && isSelection(vUv, 0.0, 0.0)) {\n#else\n    else if (center.a > 0.0 && IS_SELECTION(center)) {\n#endif\n#ifdef IS_2D\n        center.a = -clamp(center.a + expand2dSelection, 0.0, 1.0);\n#else\n        CHECK_EDGE_SELECTION(-1.0,-1.0);\n        CHECK_EDGE_SELECTION( 0.0,-1.0);\n        CHECK_EDGE_SELECTION( 1.0,-1.0);\n        CHECK_EDGE_SELECTION(-1.0, 0.0);\n        CHECK_EDGE_SELECTION( 1.0, 0.0);\n        CHECK_EDGE_SELECTION(-1.0, 1.0);\n        CHECK_EDGE_SELECTION( 0.0, 1.0);\n        CHECK_EDGE_SELECTION( 1.0, 1.0);\n        if (hasEdge != 0)\n            paintOutline = true;\n        else\n            center.a = -center.a;\n#endif\n    }\n#ifndef IS_2D\n    if (paintOutline) {\n        float maxComponent = max(center.r, max(center.g, center.b));\n        center.rgb /= maxComponent;\n        center.rgb = sqrt(center.rgb);\n        center.a = 0.5 + 0.5 * maxAlpha * 0.125 * float(hasEdge);\n    }\n#endif\n    return center;\n}\n#ifdef SPATIAL_FILTER\nSPATIAL_FILTER\n#endif\nvec4 sampleColor() {\n    return texture2D( tDiffuse, vUv );\n}\nfloat sampleAO() {\n    return (useAO != 0) ? sqrt(texture2D(tAO, vUv).r) : 1.0;\n}\nvec3 applyCrossFade(vec3 srcColor, sampler2D fadeTex, float opacity, vec2 vUv) {\n    vec4 blendCol = texture2D(fadeTex, vUv);\n    return mix(srcColor.rgb, blendCol.rgb, blendCol.a * opacity);\n}\nvoid applyHighlighting(inout vec3 rgb, float filterValue) {\n#ifdef IS_2D\n    rgb = mix(rgb, vec3(1.0,1.0,0.0), filterValue * highlightIntensity * 0.25);\n#else\n    rgb += highlightColor * filterValue * highlightIntensity * 0.20;\n#endif\n}\nvoid main() {\n    vec4 texel = sampleColor();\n    float ao = sampleAO();\n    #ifdef NUM_CROSSFADE_TARGETS\n        #if (NUM_CROSSFADE_TARGETS > 1)\n            #if (TARGET_FADE_MODE == 0)\n                texel.rgb = applyCrossFade(texel.rgb, tCrossFadeTex0, crossFadeOpacity0, vUv);\n                texel.rgb = applyCrossFade(texel.rgb, tCrossFadeTex1, crossFadeOpacity1, vUv);\n            #else\n                vec4 t0 = texture2D(tCrossFadeTex0, vUv);\n                vec4 t1 = texture2D(tCrossFadeTex1, vUv);\n                vec4 mixed = mix(t0, t1, crossFadeOpacity1);\n                texel.rgb = mix(texel.rgb, mixed.rgb, mixed.a);\n                float aoGamma = 1.0 + 3.0 * (1.0 - 2.0 * abs(crossFadeOpacity1 - 0.5));\n                if (aoGamma == 0.0)\n                    aoGamma = 1.0;\n                ao = pow(ao, 1.0 / aoGamma);\n            #endif\n        #else\n            vec4 mixed = texture2D(tCrossFadeTex0, vUv);\n            texel.rgb = mix(texel.rgb, mixed.rgb, mixed.a);\n        #endif\n    #else\n    #endif\n    ao = 1.0 - (1.0 - ao) * aoOpacity;\n    texel.rgb *= ao;\n    if (useOverlay != 0) {\n        vec4 overlay = overlayEdgeDetect(vUv);\n        if (overlay.a < 0.0) {\n            overlay.a = -overlay.a;\n#ifdef IS_2D\n            overlay.a *= 0.6;\n#else\n            if (overlay.a >= 0.99) {\n                overlay.a = 0.75;\n                texel.rgb = vec3(luminance_post(texel.rgb));\n            }\n#endif\n        }\n#ifdef IS_2D\n        texel.rgb = texel.rgb * (1.0 - overlay.a) + overlay.rgb;\n#else\n        texel.rgb = texel.rgb * (1.0 - overlay.a) + sqrt(overlay.rgb * overlay.a);\n#endif\n        texel.a += overlay.a * (1.0 - texel.a);\n    }\n    if (objIDv4 != vec4(0.0)) {\n    vec4 idAtPixel = texture2D(tID, vUv);\n    #ifdef SPATIAL_FILTER\n        vec3 worldPos = reconstructWorldPosition(gl_FragCoord.xy, vUv);\n        float filterValue = (spatialFilter(worldPos) ? 1.0 : 0.0);\n        if (idAtPixel != vec4(1,1,1,1)) {\n            applyHighlighting(texel.rgb, filterValue);\n        }\n    #else\n        #if defined(USE_MODEL_ID)\n            vec4 modelAtPixel = texture2D(tID2, vUv);\n            idAtPixel.a = modelAtPixel.b;\n            vec4 idDelta = abs(idAtPixel.rgba - objIDv4.rgba) * (1.0 - highlightFullModel);\n            vec2 modelDelta = abs(modelAtPixel.rg - modelIDv2.rg);\n        #else\n            vec4 idDelta = vec4(abs(idAtPixel.rgb - objIDv4.rgb), 0.0);\n            vec2 modelDelta = vec2(0.0, 0.0);\n        #endif\n            if (max(max(modelDelta.r, modelDelta.g), max(max(idDelta.r, idDelta.g), max(idDelta.b, idDelta.a))) < 1e-3) {\n                applyHighlighting(texel.rgb, 1.0);\n            }\n    #endif\n    }\n    gl_FragColor = texel;\n}\n";
},"./src/wgs/render/shaders/cel_frag.glsl":function(e,t){e.exports="\n#include<depth_texture>\nuniform sampler2D tDiffuse;\nuniform sampler2D tID;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraFar;\nuniform sampler2D tFill;\nuniform sampler2D tPaper;\nuniform int style;\nuniform int idEdges;\nuniform int normalEdges;\nuniform int depthEdges;\nuniform float brightness;\nuniform float contrast;\nuniform int grayscale;\nuniform int preserveColor;\nuniform int outlineNoise;\nuniform float levels;\nuniform float repeats;\nuniform float rotation;\nuniform float outlineRadius;\nuniform sampler2D tGraphite1;\nuniform sampler2D tGraphite2;\nuniform sampler2D tGraphite3;\nuniform sampler2D tGraphite4;\nuniform sampler2D tGraphite5;\nuniform sampler2D tGraphite6;\nuniform sampler2D tGraphite7;\nuniform sampler2D tGraphite8;\nvarying vec2 vUv;\nvec4 recoverNZ(vec4 nrmz) {\n    float z = sqrt(1.0 - dot(nrmz.xy, nrmz.xy));\n    nrmz.w = -(nrmz.z + cameraNear) / (cameraFar - cameraNear);\n    nrmz.z = z;\n    return nrmz;\n}\n#include<tonemap>\n#include<hsv>\nvec3 quantize(vec3 c) {\n    float L = max(c.r, max(c.g, c.b));\n    c *= floor(L * (levels-1.0) + 0.5) / (L * (levels-1.0));\n    return c;\n}\nvec3 quantizeRGB(vec3 c) {\n    c *= c;\n    c *= floor(c * levels * 0.9999) / (levels-1.0);\n    return sqrt(c);\n}\nvec3 clampHue(vec3 c, float hues, float sats, float vals) {\n    vec3 hsv = rgb2hsv(c);\n    hsv.x = floor(hsv.x * hues + 0.5) / hues;\n    hsv.y = floor(hsv.y * sats + 0.5) / sats;\n    hsv.z = floor(hsv.z * vals + 0.5) / vals;\n    vec3 col = hsv2rgb(hsv);\n    return col;\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\n    return normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 getPosition(ivec2 ssP, float depth) {\n    vec3 P;\n    P = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\n    return P;\n}\nint isObjectEdge() {\n    vec2 uv = vUv;\n    if (outlineNoise == 1) {\n        vec4 noise = texture2D(tGraphite7, vUv);\n        uv = vUv + 0.02 * (noise.xy - vec2(0.25));\n    }\n    vec4 MM = texture2D(tID, uv);\n    vec4 LL = texture2D(tID, uv + vec2(-outlineRadius, -outlineRadius) * resolution);\n    if (MM != LL) return 1;\n    vec4 LM = texture2D(tID, uv + vec2( 0.0, -outlineRadius) * resolution);\n    if (MM != LM) return 1;\n    vec4 LR = texture2D(tID, uv + vec2( outlineRadius, -outlineRadius) * resolution);\n    if (MM != LR) return 1;\n    vec4 ML = texture2D(tID, uv + vec2(-outlineRadius,  0.0) * resolution);\n    if (MM != ML) return 1;\n    vec4 MR = texture2D(tID, uv + vec2( outlineRadius,  0.0) * resolution);\n    if (MM != MR) return 1;\n    vec4 UL = texture2D(tID, uv + vec2(-outlineRadius,  outlineRadius) * resolution);\n    if (MM != UL) return 1;\n    vec4 UM = texture2D(tID, uv + vec2( 0.0,  outlineRadius) * resolution);\n    if (MM != UM) return 1;\n    vec4 UR = texture2D(tID, uv + vec2( outlineRadius,  outlineRadius) * resolution);\n    if (MM != UR) return 1;\n    return (MM.x + MM.y + MM.z + MM.w) >= 4.0 ? 0 : -1;\n}\nfloat normalDiff(vec3 n1, vec3 n2) {\n    float d = dot(n1.xyz, n2.xyz);\n    return acos(clamp(d, -1.0, 1.0));\n}\nint isNormalDepthEdge() {\n    ivec2 ssC = ivec2(gl_FragCoord.xy);\n    vec2 uv = vUv;\n    if (outlineNoise == 1) {\n        vec4 noise = texture2D(tGraphite7, vUv);\n        uv = vUv + 0.02 * (noise.xy - vec2(0.25));\n    }\n    vec4 MM = texture2D(tDepth, uv);\n    vec4 LL = texture2D(tDepth, uv + vec2(-outlineRadius, -outlineRadius) * resolution);\n    vec4 LM = texture2D(tDepth, uv + vec2( 0.0, -outlineRadius) * resolution);\n    vec4 LR = texture2D(tDepth, uv + vec2( outlineRadius, -outlineRadius) * resolution);\n \n    vec4 ML = texture2D(tDepth, uv + vec2(-outlineRadius,  0.0) * resolution);\n    vec4 MR = texture2D(tDepth, uv + vec2( outlineRadius,  0.0) * resolution);\n    vec4 UL = texture2D(tDepth, uv + vec2(-outlineRadius, outlineRadius) * resolution);\n    vec4 UM = texture2D(tDepth, uv + vec2( 0.0,  outlineRadius) * resolution);\n    vec4 UR = texture2D(tDepth, uv + vec2( outlineRadius,  outlineRadius) * resolution);\n    LL = recoverNZ(LL);\n    LM = recoverNZ(LM);\n    LR = recoverNZ(LR);\n    ML = recoverNZ(ML);\n    MM = recoverNZ(MM);\n    MR = recoverNZ(MR);\n    UL = recoverNZ(UL);\n    UM = recoverNZ(UM);\n    UR = recoverNZ(UR);\n    float dd = 0.0;\n    if ( depthEdges == 1 ) {\n        float G = (abs(UL.w - MM.w) + 2.0 * abs(UM.w - MM.w) + abs(UR.w - MM.w) + 2.0 * abs(ML.w - MM.w) + 2.0 * abs(MR.w - MM.w) + abs(LL.w - MM.w) + 2.0 * abs(LM.w - MM.w) + abs(LR.w - MM.w));\n        dd = abs(dFdx(G)) + abs(dFdy(G));\n    }\n    float Gn = 0.0;\n    if ( normalEdges == 1 ) {\n        float pLL = normalDiff(LL.xyz, MM.xyz);\n        float pLM = normalDiff(LM.xyz, MM.xyz);\n        float pLR = normalDiff(LR.xyz, MM.xyz);\n        float pML = normalDiff(ML.xyz, MM.xyz);\n        float pMM = normalDiff(MM.xyz, MM.xyz);\n        float pMR = normalDiff(MR.xyz, MM.xyz);\n        float pUL = normalDiff(UL.xyz, MM.xyz);\n        float pUM = normalDiff(UM.xyz, MM.xyz);\n        float pUR = normalDiff(UR.xyz, MM.xyz);\n        Gn = (abs(pUL - pMM) + 2.0 * abs(pUM - pMM) + abs(pUR - pMM) + 2.0 * abs(pML - pMM) + 2.0 * abs(pMR - pMM) + abs(pLL - pMM) + 2.0 * abs(pLM - pMM) + abs(pLR - pMM));\n    }\n    \n    return (dd > 0.004 || Gn > 2.0) ? 1 : 0;\n}\nvec3 computeGraphite( vec3 color, vec2 loc ) {\n    float lum = 0.299 * color.r + 0.587 * color.g + 0.114 * color.b;\n    float offset;\n    vec3 col1, col2;\n    if ( lum > 6.0/7.0 ) {\n        col1 = texture2D(tGraphite1, loc ).xyz;\n        col2 = texture2D(tGraphite2, loc ).xyz;\n        offset = 6.0/7.0;\n    } else if ( lum > 5.0/7.0 ) {\n        col1 = texture2D(tGraphite2, loc ).xyz;\n        col2 = texture2D(tGraphite3, loc ).xyz;\n        offset = 5.0/7.0;\n    } else if ( lum > 4.0/7.0 ) {\n        col1 = texture2D(tGraphite3, loc ).xyz;\n        col2 = texture2D(tGraphite4, loc ).xyz;\n        offset = 4.0/7.0;\n    } else if ( lum > 3.0/7.0 ) {\n        col1 = texture2D(tGraphite4, loc ).xyz;\n        col2 = texture2D(tGraphite5, loc ).xyz;\n        offset = 3.0/7.0;\n    } else if ( lum > 2.0/7.0 ) {\n        col1 = texture2D(tGraphite5, loc ).xyz;\n        col2 = texture2D(tGraphite6, loc ).xyz;\n        offset = 2.0/7.0;\n    } else if ( lum > 1.0/7.0 ) {\n        col1 = texture2D(tGraphite6, loc ).xyz;\n        col2 = texture2D(tGraphite7, loc ).xyz;\n        offset = 1.0/7.0;\n    } else {\n        col1 = texture2D(tGraphite7, loc ).xyz;\n        col2 = texture2D(tGraphite8, loc ).xyz;\n        offset = 0.0;\n    }\n    if ( col1.r == 0.0 && col2.r == 0.0 ) {\n        return vec3(lum,lum,lum);\n    }\n    float t = (lum-offset)*7.0;\n    return (col1 * t + col2 * (1.0 - t));\n}\nvec3 colorWithAdjustments() {\n    vec3 sceneRGB = texture2D(tDiffuse, vUv).xyz;\n    if ( brightness != 0.0 || contrast != 0.0) {\n        if ( brightness < 0.0 )\n        {\n            sceneRGB = sceneRGB * (1.0 + brightness);\n        }\n        else\n        {\n            sceneRGB = sceneRGB + ((1.0 - sceneRGB) * brightness);\n        }\n        float slant = tan(( clamp(contrast,-1.0,1.0) + 1.0) * 3.141592/4.001);\n        sceneRGB = (sceneRGB - 0.5) * slant + 0.5;\n        if ( preserveColor == 1 )\n        {\n            float maxval = max( sceneRGB.r, sceneRGB.g );\n            maxval = max( maxval, sceneRGB.b );\n            if ( maxval > 1.0 )\n            {\n                sceneRGB /= maxval;\n            }\n        }\n        sceneRGB = clamp(sceneRGB,0.0,1.0);\n    }\n    if ( grayscale == 1 ) {\n        sceneRGB.rgb = vec3(luminance_post(sceneRGB.rgb));\n    }\n    return sceneRGB;\n}\nvoid main() {\n    int foundEdge = 0;\n    foundEdge = ( idEdges == 1 && isObjectEdge() == 1 ) ? 1 : 0;\n    if ( foundEdge == 0 && (normalEdges == 1 || depthEdges == 1) ) {\n        foundEdge = isNormalDepthEdge();\n    }\n    vec2 loc = vec2((vUv.x-0.5)*(resolution.y/resolution.x),vUv.y-0.5)*repeats;\n    if ( style > 2 && rotation != 0.0 ) {\n        float rot = 3.14159*rotation;\n        float sinr = sin(rot);\n        float cosr = cos(rot);\n        loc = vec2(loc.x*cosr + -loc.y*sinr, loc.x*sinr + loc.y*cosr);\n    }\n    loc += vec2(0.5,0.5);\n    vec3 color;\n    if ( style == 2 ) {\n        if ( foundEdge == 1 ) {\n            gl_FragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            gl_FragColor = vec4(quantize(colorWithAdjustments()),1.0);\n        }\n    } else if ( style == 3 ) {\n        color = colorWithAdjustments();\n        vec3 graphColor = computeGraphite( color, loc );\n        if ( foundEdge == 1 ) {\n            gl_FragColor = vec4(0.16,0.16,0.16,1.0) + vec4(0.18 * graphColor,0.0);\n        } else {\n            gl_FragColor = vec4(graphColor,1.0);\n        }\n        return;\n    } else if ( style == 4 ) {\n        float fill = texture2D(tFill, loc ).r;\n        float paperStrength = 0.3;\n        vec3 paper = texture2D(tPaper, loc ).rgb;\n        paper = paperStrength * paper + (1.0-paperStrength)*vec3(1.0,1.0,1.0);\n        if ( foundEdge == 1 ) {\n            gl_FragColor = 0.75 * vec4(paper * fill, 1.0);\n        } else {\n            fill = pow(fill,1.6);\n            gl_FragColor = vec4(colorWithAdjustments() * (1.0 - fill) + paper * fill, 1.0);\n        }\n    } else {\n        if ( foundEdge == 1 ) {\n            gl_FragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            gl_FragColor = vec4(colorWithAdjustments(),1.0);\n        }\n        return;        \n    }\n}\n"},"./src/wgs/render/shaders/copy_frag.glsl":function(e,t){e.exports="uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n    gl_FragColor = texture2D(tDiffuse, vUv);\n}\n"},"./src/wgs/render/shaders/edge_frag.glsl":function(e,t){e.exports="\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include<cutplanes>\nuniform vec4 color;\n#include<id_decl_frag>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    gl_FragColor = color;\n#ifdef MRT_NORMALS\noutNormal = vec4(0.0);\n#endif\n#ifdef MRT_ID_BUFFER\n    outId = vec4(0.0);\n    #ifdef MODEL_COLOR\n        outModelId = vec4(0.0);\n    #endif\n#elif defined(ID_COLOR)\n    gl_FragColor = vec4(0.0);\n#elif defined(MODEL_COLOR)\n    gl_FragColor = vec4(0.0);\n#endif\n}"},"./src/wgs/render/shaders/edge_vert.glsl":function(e,t){e.exports="\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include<instancing_decl_vert>\nvoid main() {\n    vec3 instPos = getInstancePos(position);\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( instPos, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n    vec4 mvPosition = modelViewMatrix * vec4( instPos, 1.0 );\n    vec4 p_Position = projectionMatrix * mvPosition;\n    gl_Position = p_Position;\n}"},"./src/wgs/render/shaders/fxaa_frag.glsl":function(e,t){e.exports="#define FXAA_EDGE_SHARPNESS (8.0)\n#define FXAA_EDGE_THRESHOLD (0.125)\n#define FXAA_EDGE_THRESHOLD_MIN (0.05)\n#define FXAA_RCP_FRAME_OPT (0.50)\n#define FXAA_RCP_FRAME_OPT2 (2.0)\nuniform sampler2D tDiffuse;\nuniform highp vec2 uResolution;\nvarying vec2 vPos;\nvarying vec4 vPosPos;\nfloat FxaaLuma(vec3 rgb) {\n    return dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nvoid main() {\n    float lumaNw = FxaaLuma(texture2D(tDiffuse, vPosPos.xy).rgb);\n    float lumaSw = FxaaLuma(texture2D(tDiffuse, vPosPos.xw).rgb);\n    float lumaNe = FxaaLuma(texture2D(tDiffuse, vPosPos.zy).rgb) + 1.0/384.0;\n    float lumaSe = FxaaLuma(texture2D(tDiffuse, vPosPos.zw).rgb);\n    vec4 rgbaM = texture2D(tDiffuse, vPos.xy);    \n    float lumaM = FxaaLuma(rgbaM.rgb);\n    float lumaMax = max(max(lumaNe, lumaSe), max(lumaNw, lumaSw));\n    float lumaMin = min(min(lumaNe, lumaSe), min(lumaNw, lumaSw));\n    float lumaMaxSubMinM = max(lumaMax, lumaM) - min(lumaMin, lumaM);\n    float lumaMaxScaledClamped = max(FXAA_EDGE_THRESHOLD_MIN, lumaMax * FXAA_EDGE_THRESHOLD);\n    if (lumaMaxSubMinM < lumaMaxScaledClamped) {\n        gl_FragColor = rgbaM;\n        return;\n    }\n    float dirSwMinusNe = lumaSw - lumaNe;\n    float dirSeMinusNw = lumaSe - lumaNw;\n    vec2 dir1 = normalize(vec2(dirSwMinusNe + dirSeMinusNw, dirSwMinusNe - dirSeMinusNw));\n    vec3 rgbN1 = texture2D(tDiffuse, vPos.xy - dir1 * FXAA_RCP_FRAME_OPT*uResolution).rgb;\n    vec3 rgbP1 = texture2D(tDiffuse, vPos.xy + dir1 * FXAA_RCP_FRAME_OPT*uResolution).rgb;\n    float dirAbsMinTimesC = min(abs(dir1.x), abs(dir1.y)) * FXAA_EDGE_SHARPNESS;\n    vec2 dir2 = clamp(dir1.xy / dirAbsMinTimesC, -2.0, 2.0);\n    vec3 rgbN2 = texture2D(tDiffuse, vPos.xy - dir2 * FXAA_RCP_FRAME_OPT2*uResolution).rgb;\n    vec3 rgbP2 = texture2D(tDiffuse, vPos.xy + dir2 * FXAA_RCP_FRAME_OPT2*uResolution).rgb;\n    vec3 rgbA = rgbN1 + rgbP1;\n    vec3 rgbB = ((rgbN2 + rgbP2) * 0.25) + (rgbA * 0.25);\n    float lumaB = FxaaLuma(rgbB);\n    float alpha = rgbaM.a;\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        gl_FragColor = vec4(rgbA * 0.5, rgbaM.a);\n    else\n        gl_FragColor = vec4(rgbB, rgbaM.a);\n}\n"},"./src/wgs/render/shaders/fxaa_vert.glsl":function(e,t){e.exports="uniform vec2 uResolution;\nvarying vec2 vPos;\nvarying vec4 vPosPos;\nvoid main() {\n    vPos = uv;\n    vPosPos.xy = uv + vec2(-0.5, -0.5) * uResolution;\n    vPosPos.zw = uv + vec2( 0.5,  0.5) * uResolution;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},"./src/wgs/render/shaders/gaussian_frag.glsl":function(e,t){e.exports="uniform sampler2D tDiffuse;\nuniform vec4 uColor;\nvarying vec2 vUv;\n#ifdef HORIZONTAL\n#define GET_UV(X) vec2(vUv.x + KERNEL_SCALE_H*(X), vUv.y)\n#else\n#define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE_V*(Y))\n#endif\n#define PI 3.14159265358979\n#define SIGMA ((KERNEL_RADIUS+KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#define GAUSSIAN(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\nvoid main() {\n    vec4 texColSum = vec4(0.0);\n    float gaussSum = 0.0;\n    for (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\n        float gauss = GAUSSIAN(x);\n        vec4 texCol = texture2D(tDiffuse, GET_UV(x));\n#ifdef HAS_ALPHA\n        texCol.rgb *= texCol.a;\n#endif\n        texColSum += texCol * gauss;\n        gaussSum += gauss;\n    }\n#ifdef HAS_ALPHA\n    texColSum.rgb /= (texColSum.a == 0.0 ? 0.0001 : texColSum.a);\n#endif\n#ifdef HORIZONTAL\n    gl_FragColor = texColSum/gaussSum;\n#else\n    gl_FragColor = texColSum/gaussSum * uColor;\n#endif\n}\n"},"./src/wgs/render/shaders/gaussian_vert.glsl":function(e,t){e.exports="varying vec2 vUv;\nvoid main() {\n#if defined(HORIZONTAL) && defined(FLIP_UV)\n    vUv = vec2(uv.x, 1.0-uv.y);\n#else\n    vUv = vec2(uv.x, uv.y);\n#endif\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},"./src/wgs/render/shaders/groundreflection_draw_frag.glsl":function(e,t){e.exports="uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tDiffuse, vUv );\n    gl_FragColor = texel;\n}\n"},"./src/wgs/render/shaders/groundshadow_ao_frag.glsl":function(e,t){e.exports="#define NUM_SAMPLES 29.0\n#define NUM_SPIRAL_TURNS 7.0\nuniform sampler2D tDepth;\nuniform vec3 worldSize;\nvarying vec2 vUv;\n#ifdef PRESET_2\n#define SAMPLE_RADIUS 0.3\n#define AO_GAMMA 1.0\n#define AO_INTENSITY 1.0\n#else\n#define SAMPLE_RADIUS 0.2\n#define AO_GAMMA 3.0\n#define AO_INTENSITY 0.8\n#endif\n#include<pack_depth>\n#define PI 3.14159265358979\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\nfloat getRandomAngle(vec2 pos) {\n    return rand(pos) * (2.0 * PI);\n}\nvec2 tapLocation(float sampleNumber, float spinAngle, out float ssR){\n    float alpha = float(sampleNumber + 0.5) * (1.0 / NUM_SAMPLES);\n    float angle = alpha * (NUM_SPIRAL_TURNS * PI * 2.0) + spinAngle;\n    ssR = alpha;\n    return vec2(cos(angle), sin(angle));\n}\nvec2 sampleAO(vec2 unitDirection, float radius) {\n    vec2 sampleOffset = unitDirection * radius;\n    float idepth = unpackDepth(texture2D(tDepth, vUv + sampleOffset));\n    float depth = 1.0 - idepth;\n    if (depth < 1e-6) {\n        if (radius == 0.0)\n            return vec2(1.0, 1.0);\n        else\n            return vec2(0.0, 1.0);\n    }\n    vec3 dir = vec3(sampleOffset.x, depth, sampleOffset.y) * worldSize;\n    float distance2 = dot(dir,dir);\n    float idistance = 1.0 / sqrt(distance2);\n    vec3 ndir = dir * idistance;\n#ifdef PRESET_2\n    float importance = ndir.y * idistance;\n#else\n    float importance = ndir.y / distance2;\n#endif\n    vec2 ret;\n    ret.x = (idepth == 0.0) ? 0.0 : importance;\n    ret.y = importance;\n    return ret;\n}\nvoid main() {\n    vec2 sum = vec2(0.0);\n    float angle = getRandomAngle(vUv);\n    for (float i = 0.0; i<NUM_SAMPLES; i+= 1.0) {\n        float ssR;\n        vec2 uv = tapLocation(i, angle, ssR);\n        sum += sampleAO(uv, ssR * SAMPLE_RADIUS);\n    }\n    float ao = sum.x / sum.y;\n    gl_FragColor = packDepth(AO_INTENSITY * clamp(pow(ao, AO_GAMMA), 0.0, 0.9999));\n}\n"},"./src/wgs/render/shaders/groundshadow_blur_frag.glsl":function(e,t){e.exports="uniform sampler2D tDepth;\nvarying vec2 vUv;\n#ifdef HORIZONTAL\n#define GET_UV(X) vec2(vUv.x + KERNEL_SCALE*(X), vUv.y)\n#else\n#define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE*(Y))\n#endif\n#include<pack_depth>\n#define PI 3.14159265358979\n#define SIGMA ((2.0 * KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#ifdef BOX\n#define KERNEL_VAL(X) 1.0\n#else\n#define KERNEL_VAL(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\n#endif\nvoid main() {\n    float depthVal = 0.0;\n    float sum = 0.0;\n    for (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\n        depthVal += unpackDepth(texture2D(tDepth, GET_UV(x))) * KERNEL_VAL(x);\n        sum += KERNEL_VAL(x);\n    }\n    gl_FragColor = packDepth(depthVal/sum);\n}\n"},"./src/wgs/render/shaders/groundshadow_color_frag.glsl":function(e,t){e.exports="uniform sampler2D tDepth;\nuniform vec4 uShadowColor;\nvarying vec2 vUv;\n#include<pack_depth>\nvoid main() {\n    float depthVal = unpackDepth(texture2D(tDepth, vUv));\n    gl_FragColor = vec4(uShadowColor.rgb, uShadowColor.a * depthVal);\n}\n"},"./src/wgs/render/shaders/groundshadow_depth_frag.glsl":function(e,t){e.exports="#include<pack_depth>\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include<cutplanes>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    depth = 1.0 - depth;\n    gl_FragColor = packDepth(depth);\n}\n"},"./src/wgs/render/shaders/groundshadow_depth_vert.glsl":function(e,t){e.exports="#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );;\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n}\n"},"./src/wgs/render/shaders/leafletdiff_frag.glsl":function(e,t){e.exports="#define HIGHLIGHT_NONE 0\n#define HIGHLIGHT_A 1\n#define HIGHLIGHT_B 2\n#define MIN_DIFF_VAL 0.5\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float splitPosition;\nuniform int model;\nuniform int highlight;\nuniform vec2 resolution1;\nuniform vec2 resolution2;\nuniform float diff_threshold;\nvarying vec2 vUvA;\nvarying vec2 vUvB;\nconst int BIT_COUNT = 2;\nint modi(int x, int y) {\n    return x - y * (x / y);\n}\nint and(int a, int b) {\n    int result = 0;\n    int n = 1;\n    for(int i = 0; i < BIT_COUNT; i++) {\n        if ((modi(a, 2) == 1) && (modi(b, 2) == 1)) {\n            result += n;\n        }\n        a = a / 2;\n        b = b / 2;\n        n = n * 2;\n        if(!(a > 0 && b > 0)) {\n            break;\n        }\n    }\n    return result;\n}\nfloat toGrayscale(vec4 v) {\n    return dot(v.rgb, vec3(0.299, 0.587, 0.114));\n}\nvoid main() {\n#ifdef SINGLE_MODEL\n    vec4 tex = texture2D(texture1, vUvA);\n    #ifdef SPLIT_VIEW\n    if (model == 1 && gl_FragCoord.x < splitPosition ||\n        model == 2 && gl_FragCoord.x >= splitPosition) {\n        gl_FragColor = tex;\n    } else {\n        discard;\n    }\n    #else\n    float gray = toGrayscale(tex);\n    gl_FragColor.rgb = vec3(gray);\n    #endif\n#else\n    vec4 tex1 = texture2D(texture1, vUvA);\n    vec4 tex2 = texture2D(texture2, vUvB);\n    #ifdef SPLIT_VIEW\n    gl_FragColor = gl_FragCoord.x < splitPosition ? tex1 : tex2;\n    #else\n    float gray1 = toGrayscale(tex1);\n    float gray2 = toGrayscale(tex2);\n    float maxGray = min(gray1, gray2);\n    float delta = gray1 - gray2;\n    gl_FragColor.rgb = vec3(maxGray);\n    if (abs(delta) > diff_threshold) {\n        if (delta < 0.0 && and(highlight, HIGHLIGHT_A) == HIGHLIGHT_A) {\n            gl_FragColor = vec4(max(gray2, MIN_DIFF_VAL), 0.0, 0.0, 1.0);\n        } else if (delta > 0.0 && and(highlight, HIGHLIGHT_B) == HIGHLIGHT_B) {\n            gl_FragColor = vec4(0.0, 0.0, max(gray1, MIN_DIFF_VAL), 1.0);\n        }\n    }\n        #ifdef ADD_THICKENING\n    else {\n        bool found = false;\n        for (int i = 0; i < 3; i++) {\n            for (int j = 0; j < 3; j++) {\n                if (i != 1 && j != 1) {\n                    vec4 nTex1 = texture2D(texture1, vUvA + resolution1*vec2(i - 1, j - 1));\n                    vec4 nTex2 = texture2D(texture2, vUvB + resolution2*vec2(i - 1, j - 1));\n                    float nGray1 = toGrayscale(nTex1);\n                    float nGray2 = toGrayscale(nTex2);\n                    delta = nGray1 - nGray2;\n                    if (abs(delta) > diff_threshold) {\n                        if (delta < 0.0 && and(highlight, HIGHLIGHT_A) == HIGHLIGHT_A) {\n                            gl_FragColor = vec4(1.25*max(nGray2, MIN_DIFF_VAL), 0.25, 0.25, 1.0);\n                        } else if (delta > 0.0 && and(highlight, HIGHLIGHT_B) == HIGHLIGHT_B) {\n                            gl_FragColor = vec4(0.25, 0.25, 1.25*max(nGray1, MIN_DIFF_VAL), 1.0);\n                        }\n                        found = true;\n                        break;\n                    }\n                }\n            }\n            if (found) break;\n        }\n    }\n        #endif\n    #endif\n#endif\n}"},"./src/wgs/render/shaders/leafletdiff_vert.glsl":function(e,t){e.exports="varying vec2 vUvA;\nvarying vec2 vUvB;\nuniform vec4 uvTFa;\nuniform vec4 uvTFb;\nuniform vec4 offsetRepeatA;\nuniform vec4 offsetRepeatB;\nvoid main() {\n    vUvA = uv*offsetRepeatA.zw + offsetRepeatA.xy;\n   \n#ifndef SINGLE_MODEL\n    float x = (uv.x - uvTFa.x) / uvTFa.z;\n    float y = (uv.y - uvTFa.y) / uvTFa.w;\n    vec2 uvB;\n    uvB.x = uvTFb.x + x*uvTFb.z;\n    uvB.y = uvTFb.y + y*uvTFb.w;\n    vUvB = uvB * offsetRepeatB.zw + offsetRepeatB.xy;\n#endif\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},"./src/wgs/render/shaders/line_frag.glsl":function(e,t){e.exports="\r\n\r\n\r\n#include<line_decl_common>\r\n#include<id_decl_frag>\r\n\r\nuniform highp float pixelsPerUnit;\r\nuniform highp float aaRange;\r\n\r\nuniform float opacity;\r\nuniform highp float viewportId;\r\nuniform highp float swap;\r\nuniform highp float grayscale;\r\n\r\n#ifdef HAS_RASTER_QUADS\r\nuniform sampler2D tRaster;\r\n#endif\r\n\r\n#ifdef HAS_LINESTYLES\r\nuniform sampler2D tLineStyle;\r\nuniform vec2 vLineStyleTexSize;\r\n#endif\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\nuniform highp vec4 viewportBounds;\r\nvarying highp vec2 vPosition;\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\nvarying highp vec2 vuv;\r\nuniform sampler2D tRaster;\r\n#endif\r\n\r\n\r\nfloat curveGaussian(float r, float invWidth) {\r\n    float amt = clamp(r * invWidth, 0.0, 1.0);\r\n\r\n    float exponent = amt * 2.0;\r\n\r\n    return exp(-exponent*exponent);\r\n\r\n\r\n\r\n}\r\n\r\n#ifdef HAS_LINESTYLES\r\nfloat getLinePatternPixel(int i, int j) {\r\n\r\n    return texture2D(tLineStyle, (vec2(i, j) + 0.5) / vLineStyleTexSize).x * 255.0;\r\n}\r\n\r\nfloat getPatternLength(int whichPattern) {\r\n    float p1 = getLinePatternPixel(0, whichPattern);\r\n    float p2 = getLinePatternPixel(1, whichPattern);\r\n    return (p2 * 256.0 + p1);\r\n}\r\n#endif\r\n\r\n\r\nvoid fillLineSegment() {\r\n\r\n    float radius = abs(fsHalfWidth);\r\n    float parametricDistance = fsMultipurpose.x;\r\n    float segmentLength      = fsMultipurpose.y;\r\n    float totalDistance      = fsMultipurpose.z;\r\n\r\n#ifdef LOADING_ANIMATION\r\n    float distFromStart = parametricDistance / segmentLength;\r\n    if (loadingProgress < 1.0 && distFromStart > loadingProgress) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n\r\n#ifdef HAS_LINESTYLES\r\n    int whichPattern         = int(fsMultipurpose.w);\r\n\r\n    if (whichPattern > 0) {\r\n        const float TEX_TO_UNIT = 1.0 / 96.0;\r\n\r\n        float patternScale;\r\n\r\n\r\n\r\n        if (fsHalfWidth < 0.0) {\r\n            patternScale = LTSCALE;\r\n        } else {\r\n            patternScale = LTSCALE * TEX_TO_UNIT * pixelsPerUnit;\r\n        }\r\n\r\n        float patLen = patternScale * getPatternLength(whichPattern);\r\n        float phase = mod((totalDistance + parametricDistance) * pixelsPerUnit, patLen);\r\n\r\n        bool onPixel = true;\r\n        float radiusPixels = radius * pixelsPerUnit;\r\n\r\n        for (int i=2; i<MAX_LINESTYLE_LENGTH; i+=2) {\r\n\r\n            float on = getLinePatternPixel(i, whichPattern);\r\n            if (on == 1.0) on = 0.0;\r\n            on *= patternScale;\r\n\r\n            onPixel = true;\r\n            phase -= on;\r\n            if (phase < 0.0) {\r\n                break;\r\n            }\r\n            else if (phase <= radiusPixels) {\r\n                onPixel = false;\r\n                break;\r\n            }\r\n\r\n            float off = getLinePatternPixel(i+1, whichPattern);\r\n            if (off <= 1.0) off = 0.0;\r\n            off *= patternScale;\r\n\r\n            onPixel = false;\r\n            phase -= off;\r\n            if (phase < -radiusPixels)\r\n                discard;\r\n            if (phase <= 0.0)\r\n                break;\r\n        }\r\n\r\n\r\n\r\n\r\n        if (!onPixel && (abs(phase) <= radiusPixels)) {\r\n            segmentLength = 0.0;\r\n            parametricDistance = phase / pixelsPerUnit;\r\n        }\r\n    }\r\n#endif\r\n\r\n\r\n\r\n\r\n    float dist;\r\n    float offsetLength2 = dot(fsOffsetDirection, fsOffsetDirection);\r\n\r\n\r\n\r\n\r\n    float ltz = max(0.0, sign(-parametricDistance));\r\n    float gtsl = max(0.0, sign(parametricDistance - segmentLength));\r\n    float d = (ltz + gtsl) * (parametricDistance - gtsl * segmentLength);\r\n    dist = sqrt(max(0.0, offsetLength2 + d*d));\r\n\r\n\r\n\r\n\r\n    float range =  dist - radius;\r\n\r\n    if (range > aaRange) {\r\n        discard;\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    gl_FragColor = fsColor;\r\n    gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\r\n}\r\n\r\n#ifdef HAS_CIRCLES\r\nvoid fillCircularArc() {\r\n\r\n    float dist   = length(fsOffsetDirection);\r\n    vec2 angles  = fsMultipurpose.xz;\r\n    float radius = abs(fsMultipurpose.y);\r\n    float range  =  abs(dist - radius);\r\n    range -= fsHalfWidth;\r\n\r\n\r\n\r\n    if (range > aaRange) {\r\n        discard;\r\n    }\r\n\r\n    vec2 direction = fsOffsetDirection;\r\n    float angle = atan(direction.y, direction.x);\r\n\r\n\r\n\r\n\r\n    if (angles.x > angles.y) {\r\n\r\n        if (angle > angles.x && angle < PI) {\r\n                angle -= TAU;\r\n        }\r\n        angles.x -= TAU;\r\n\r\n\r\n\r\n        if (angle < angles.x ) {\r\n            angle += TAU;\r\n        }\r\n    }\r\n    else if (angle < 0.0)\r\n        angle += TAU;\r\n\r\n#ifdef LOADING_ANIMATION\r\n    if ((angle - angles.x) / (angles.y - angles.x) > loadingProgress) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n\r\n    if (angle > angles.x && angle < angles.y) {\r\n        gl_FragColor = fsColor;\r\n        gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\r\n    }\r\n    else {\r\n        discard;\r\n    }\r\n\r\n}\r\n#endif\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n#ifdef HAS_ELLIPTICALS\r\n\r\n\r\n\r\n\r\n\r\n\r\nfloat EllipticalApprox(\r\n        const int iters,\r\n        inout float t0, inout float t1,\r\n        const vec2 y,   out   vec2 x,\r\n        const vec2 e,   const vec2 ey, const vec2 esqr\r\n        ) {\r\n    vec2 r;\r\n    for (int i = 0; i < 10; ++i) {\r\n        if(i >= iters) break;\r\n\r\n        float t = mix(t0, t1, 0.5);\r\n        r = ey / (vec2(t) + esqr);\r\n\r\n        vec2 rsq = r * r;\r\n        float f = rsq.x + rsq.y - 1.0;\r\n\r\n        if(f > 0.0) { t0 = t; } else { t1 = t; }\r\n    }\r\n\r\n    x = e * r;\r\n    return distance(x, y);\r\n}\r\n\r\nfloat DistancePointEllipseSpecial (vec2 e, vec2 y, out vec2 x, float width, float aaRange) {\r\n    float dist;\r\n\r\n\r\n    vec2 esqr = e * e;\r\n    vec2 ey   = e * y;\r\n    float t0 = -esqr[1] + ey[1];\r\n    float t1 = -esqr[1] + length(ey);\r\n\r\n\r\n\r\n    dist = EllipticalApprox(6, t0, t1, y, x, e, ey, esqr);\r\n\r\n\r\n    if (dist > max(2.0 * (width + aaRange), e[0] * 0.05))\r\n        return dist;\r\n\r\n\r\n    dist = EllipticalApprox(6, t0, t1, y, x, e, ey, esqr);\r\n\r\n\r\n\r\n\r\n    float ecc = 1.0 +  0.1 * e[0] / e[1];\r\n\r\n    if (dist > max(ecc * (width + aaRange), e[0] * 0.001))\r\n        return dist;\r\n    if (dist < (width - aaRange) / ecc)\r\n        return dist;\r\n\r\n\r\n\r\n\r\n    dist = EllipticalApprox(10, t0, t1, y, x, e, ey, esqr);\r\n    return dist;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nfloat DistancePointEllipse(vec2 e, vec2 y, out vec2 locX, float width, float aaRange) {\r\n    vec2 locE, locY;\r\n\r\n\r\n\r\n\r\n    float diff = sign(e[0] - e[1]);\r\n    vec2 swizzle = vec2(max(diff, 0.0), -min(diff, 0.0));\r\n    locE.x = dot(e, swizzle.xy);\r\n    locE.y = dot(e, swizzle.yx);\r\n    locY.x = dot(y, swizzle.xy);\r\n    locY.y = dot(y, swizzle.yx);\r\n\r\n\r\n    vec2 refl = sign(locY);\r\n    locY *= refl;\r\n\r\n    vec2 x;\r\n    float distance = DistancePointEllipseSpecial(locE, locY, x, width, aaRange);\r\n\r\n    x *= refl;\r\n\r\n    locX.x = dot(x, swizzle.xy);\r\n    locX.y = dot(x, swizzle.yx);\r\n\r\n    return distance;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nvoid fillEllipticalArc() {\r\n    vec2 angles = fsMultipurpose.xz;\r\n    vec2 radii  = abs(fsMultipurpose.yw);\r\n    vec2 dir    = fsOffsetDirection;\r\n\r\n\r\n\r\n\r\n    vec2 pos;\r\n    float range = DistancePointEllipse(radii, dir, pos, fsHalfWidth, aaRange);\r\n    range -= fsHalfWidth;\r\n\r\n    if (range > aaRange)\r\n        discard;\r\n\r\n    float ar = radii[0] / radii[1];\r\n\r\n\r\n\r\n\r\n    float angle = atan(ar * pos.y, pos.x);\r\n\r\n\r\n\r\n\r\n    if (angles.x > angles.y) {\r\n\r\n        if (angle > angles.x && angle < PI) {\r\n            angle -= TAU;\r\n        }\r\n        angles.x -= TAU;\r\n\r\n\r\n\r\n        if (angle < angles.x ) {\r\n            angle += TAU;\r\n        }\r\n    }\r\n    else if (angle < 0.0)\r\n        angle += TAU;\r\n\r\n#ifdef LOADING_ANIMATION\r\n    if ((angle - angles.x) / (angles.y - angles.x) > loadingProgress) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n\r\n    if (angle > angles.x && angle < angles.y) {\r\n        gl_FragColor = fsColor;\r\n        gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\r\n    }\r\n    else {\r\n        discard;\r\n    }\r\n}\r\n#endif\r\n\r\n#ifdef HAS_RASTER_QUADS\r\n    void fillTexQuad() {\r\n        gl_FragColor = texture2D(tRaster, fsMultipurpose.xy);\r\n        #ifdef LOADING_ANIMATION\r\n            gl_FragColor.a *= loadingProgress;\r\n        #endif\r\n    }\r\n#endif\r\n\r\nvoid fillTriangle() {\r\n#ifdef IMAGE_UV_TEXTURE\r\n    gl_FragColor = texture2D(tRaster, fract(vuv));\r\n#else\r\n    gl_FragColor = fsColor;\r\n#endif\r\n\r\n#ifdef LOADING_ANIMATION\r\n    gl_FragColor.a *= loadingProgress;\r\n#endif\r\n}\r\n\r\n#if NUM_CUTPLANES > 0\r\nvarying highp vec3 vWorldPosition;\r\n#endif\r\n\r\n#ifdef MSDF_TEXTURE_FONT\r\nvarying highp vec2 vuv;\r\nvarying float isMSDFQuards;\r\nuniform sampler2D tRaster;\r\nfloat median(float r, float g, float b) {\r\n  return max(min(r, g), min(max(r, g), b));\r\n}\r\n\r\n#endif\r\n\r\n#include<cutplanes>\r\n\r\nvoid main() {\r\n\r\n\r\n\r\n\r\n\r\n    if (fsColor == vec4(0.0)) {\r\n        discard;\r\n    }\r\n\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\n    if(vPosition.x < viewportBounds.x || vPosition.x > viewportBounds.z || vPosition.y < viewportBounds.y || vPosition.y > viewportBounds.w) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n#ifdef MSDF_TEXTURE_FONT\r\n    vec4 msdfColor = texture2D(tRaster, vuv);\r\n    float dist = median(msdfColor.r, msdfColor.g, msdfColor.b);\r\n\r\n\r\n    float delta = mix(0.25, 0.5, 1.0 - fwidth(dist));\r\n\r\n    float sigDist = dist - delta;\r\n    float msdfAlpha = clamp(sigDist/fwidth(sigDist) + delta, 0.0, 1.0);\r\n\r\n    msdfAlpha = smoothstep(0., 1., msdfAlpha);\r\n    gl_FragColor.a =  mix(msdfAlpha, 1., 1.-isMSDFQuards);\r\n    if (gl_FragColor.a < 0.0001) discard;\r\n\r\n#endif\r\n\r\n\r\n    if (fsHalfWidth == 0.0) {\r\n#ifdef HAS_RASTER_QUADS\r\n        if (fsMultipurpose.z != 0.0)\r\n            fillTexQuad();\r\n        else\r\n#endif\r\n            fillTriangle();\r\n    }\r\n    else if (fsMultipurpose.y < 0.0) {\r\n#ifdef HAS_CIRCLES\r\n#ifdef HAS_ELLIPTICALS\r\n        if (abs(fsMultipurpose.y) == fsMultipurpose.w)\r\n#endif\r\n            fillCircularArc();\r\n#endif\r\n#ifdef HAS_ELLIPTICALS\r\n#ifdef HAS_CIRCLES\r\n        else\r\n#endif\r\n            fillEllipticalArc();\r\n#endif\r\n    }\r\n    else\r\n        fillLineSegment();\r\n\r\n\r\n#ifdef MRT_NORMALS\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    gl_FragData[1] = vec4(0.0);\r\n#endif\r\n\r\n\r\n\r\n\r\n\r\n\r\n    float writeId = 1.0;\r\n    \r\n    gl_FragColor.a *= opacity;\r\n\r\n    if (gl_FragColor.a == 0.0) {\r\n        discard;\r\n    }\r\n\r\n\r\n\r\n\r\n    if (fsGhosting != 0.0 || \r\n            ((viewportId != 0.0) && (abs(fsVpTC.x * 255.0 + fsVpTC.y) >= 0.5 && abs(fsVpTC.x * 255.0 + fsVpTC.y - viewportId) >= 0.5))) {\r\n\r\n        writeId = 0.0;\r\n\r\n\r\n\r\n        gl_FragColor.a *= ((swap == 1.0) ? 0.21 : 0.1);\r\n    }\r\n\r\n#ifndef SELECTION_RENDERER\r\n\r\n    if (grayscale != 0.0) {\r\n        const vec3 rgb2grey = vec3(0.299, 0.587, 0.114);\r\n        float gray = dot(gl_FragColor.rgb, rgb2grey);\r\n        gl_FragColor.rgb = vec3(gray);\r\n    }\r\n#endif\r\n\r\n#if NUM_CUTPLANES > 0\r\n    checkCutPlanes(vWorldPosition);\r\n#endif\r\n\r\n#include<id_frag>\r\n}\r\n";
},"./src/wgs/render/shaders/line_vert.glsl":function(e,t){e.exports="\r\n\r\n#include<line_decl_common>\r\n\r\nattribute vec2 fields1;\r\nattribute vec4 fields2;\r\nattribute vec4 flags4b;\r\nattribute vec4 layerVp4b;\r\n\r\n#ifdef HAS_ELLIPTICALS\r\nattribute vec3 extraParams;\r\n#endif\r\n\r\n#ifdef USE_INSTANCING\r\nattribute vec4 instFlags4b;\r\n#endif\r\n\r\n#ifdef MSDF_TEXTURE_FONT\r\nvarying highp vec2 vuv;\r\nvarying float isMSDFQuards;\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\nvarying highp vec2 vuv;\r\n#endif\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\nvarying vec2 vPosition;\r\n#endif\r\n\r\nuniform mat4 mvpMatrix;\r\n\r\nuniform float pixelsPerUnit;\r\nuniform float aaRange;\r\nuniform float viewportId;\r\nuniform float swap;\r\n\r\n\r\n\r\n\r\n\r\n#ifdef HAS_LAYERS\r\nuniform sampler2D tLayerMask;\r\n#endif\r\n\r\n#ifdef SELECTION_RENDERER\r\nuniform sampler2D tSelectionTexture;\r\nuniform vec2 vSelTexSize;\r\n#endif\r\n\r\n#ifdef SELECTION_RENDERER\r\nuniform vec4 selectionColor;\r\n#endif\r\n\r\n#ifdef LOADING_ANIMATION\r\nuniform float meshAnimTime;\r\n#endif\r\n\r\n#if NUM_CUTPLANES > 0\r\nvarying vec3 vWorldPosition;\r\n#endif\r\n\r\nvarying vec4 dbId;\r\n\r\n#ifdef UNPACK_POSITIONS\r\nuniform sampler2D tIdColor;\r\nuniform vec2 vIdColorTexSize;\r\nuniform vec4 unpackXform;\r\nattribute vec2 uvIdColor;\r\nfloat unpackLineWeight(float w) {\r\n    if (w > 0.5) {\r\n        return - (w - 0.5) * 1024.0;\r\n    } else {\r\n        return w * max(unpackXform.x, unpackXform.y) * 2.0;\r\n    }\r\n}\r\nvec4 getVertexColor() {\r\n    float u = (uvIdColor.x + 0.5) / vIdColorTexSize.x;\r\n    return texture2D(tIdColor, vec2(u, 0.5));\r\n}\r\nvec4 getDbId() {\r\n    float u = (uvIdColor.y + 0.5) / vIdColorTexSize.x;\r\n    vec4 normDbId = texture2D(tIdColor, vec2(u, 0.5));\r\n    return normDbId * 255.0;\r\n}\r\n#else\r\nattribute vec4 color4b;\r\nattribute vec4 dbId4b;\r\nvec4 unpackXform;\r\nfloat unpackLineWeight(float w) {\r\n    return w;\r\n}\r\nvec4 getVertexColor() {\r\n    return color4b;\r\n}\r\nvec4 getDbId() {\r\n    return dbId4b;\r\n}\r\n#endif\r\n\r\n\r\nvec2 centralVertex;\r\nvec2 offsetPosition;\r\n\r\nvec2 cos_sin(const float angle) { return vec2(cos(angle), sin(angle)); }\r\n\r\nvoid min_max(inout vec2 minPt, inout vec2 maxPt, const vec2 p) {\r\n    minPt = min(minPt, p);\r\n    maxPt = max(maxPt, p);\r\n}\r\n\r\n#if defined(USE_INSTANCING)\r\nfloat getVertexId() { return instFlags4b.x; }\r\n#else\r\nfloat getVertexId() { return flags4b.x; }\r\n#endif\r\n\r\nbool isStartVertex() { return (getVertexId() < VBB_SEG_END_RIGHT); }\r\nbool isLeftVertex()  { float id = getVertexId(); return ((id == VBB_SEG_END_LEFT || id == VBB_SEG_START_LEFT)); }\r\n\r\nstruct SegmentData { float angle, distAlong, distTotal, lineWidthHalf, lineType; };\r\nvoid decodeSegmentData(out SegmentData seg) {\r\n    seg.angle         = fields2.x * TAU - PI;\r\n    seg.distAlong     = fields2.y * max(unpackXform.x, unpackXform.y);\r\n    seg.distTotal     = fields2.w;\r\n    seg.lineWidthHalf = unpackLineWeight(fields2.z);\r\n    seg.lineType      = flags4b.z;\r\n}\r\n\r\nvoid strokeLineSegment() {\r\n    SegmentData seg; decodeSegmentData(seg);\r\n\r\n    float isStartCapVertex = isStartVertex() ? -1.0 :  1.0;\r\n    float isLeftSide       = isLeftVertex( ) ?  1.0 : -1.0;\r\n\r\n\r\n    float angleTransverse = seg.angle + isLeftSide * HALF_PI;\r\n    float lwAdjustment = fsHalfWidth + aaRange;\r\n    vec2 transverseOffset = cos_sin(angleTransverse) * lwAdjustment;\r\n    offsetPosition.xy += transverseOffset;\r\n\r\n\r\n\r\n\r\n    float distanceFromStart = max(isStartCapVertex, 0.0) * seg.distAlong;\r\n    vec2 along = distanceFromStart * cos_sin(seg.angle);\r\n    offsetPosition.xy += along;\r\n    centralVertex.xy  += along;\r\n\r\n\r\n    vec2 moveOffset = isStartCapVertex * isLeftSide * vec2(-transverseOffset.y, transverseOffset.x);\r\n    offsetPosition.xy -= moveOffset;\r\n    centralVertex.xy  -= moveOffset;\r\n\r\n\r\n\r\n\r\n    fsMultipurpose.x = (isStartCapVertex * lwAdjustment) + distanceFromStart;\r\n    fsMultipurpose.y = seg.distAlong;\r\n    fsMultipurpose.z = seg.distTotal;\r\n    fsMultipurpose.w = seg.lineType;\r\n\r\n    if (seg.lineWidthHalf < 0.0)\r\n        fsHalfWidth = -fsHalfWidth;\r\n}\r\n\r\n\r\n#ifdef HAS_TRIANGLE_GEOMS\r\nstruct TriangleData { vec2 p0, p1, p2; };\r\nvoid decodeTriangleData(out TriangleData tri) {\r\n\r\n    tri.p1 = vec2(fields2.x, fields2.y) * unpackXform.xy + unpackXform.zw;\r\n    tri.p2 = fields2.zw * unpackXform.xy + unpackXform.zw;\r\n}\r\n\r\nvoid strokeOneTriangle() {\r\n    TriangleData tri; decodeTriangleData(tri);\r\n\r\n\r\n\r\n\r\n\r\n\r\n    fsHalfWidth = 0.0;\r\n    fsMultipurpose.z = 0.0;\r\n\r\n\r\n\r\n\r\n\r\n    float vertexId = getVertexId();\r\n    if (vertexId == VBB_SEG_END_RIGHT)\r\n        offsetPosition.xy = tri.p1;\r\n    else if (vertexId == VBB_SEG_END_LEFT)\r\n        offsetPosition.xy = tri.p2;\r\n}\r\n#endif\r\n\r\n\r\n\r\n\r\n#ifdef HAS_RASTER_QUADS\r\nstruct TexQuadData { float angle; vec2 size; };\r\nvoid decodeTexQuadData(out TexQuadData quad) {\r\n    quad.angle     = fields2.x * TAU;\r\n    quad.size   = fields2.yz * max(unpackXform.x, unpackXform.y);\r\n}\r\n\r\nvoid strokeTexQuad() {\r\n    TexQuadData quad; decodeTexQuadData(quad);\r\n\r\n    vec2 corner = vec2(isLeftVertex() ? -1.0 : 1.0, isStartVertex() ? -1.0 : 1.0);\r\n\r\n    vec2 p      = 0.5 * corner * quad.size;\r\n    vec2 rot    = cos_sin(quad.angle);\r\n    vec2 offset = vec2(p.x * rot.x - p.y * rot.y, p.x * rot.y + p.y * rot.x);\r\n\r\n    offsetPosition.xy += offset;\r\n\r\n    fsMultipurpose.xy = max(vec2(0.0), corner);\r\n\r\n\r\n    fsMultipurpose.z = 1.0;\r\n    fsHalfWidth = 0.0;\r\n}\r\n#endif\r\n\r\n#if defined(HAS_CIRCLES) || defined(HAS_ELLIPTICALS)\r\nstruct ArcData { vec2 c; float start, end, major, minor, tilt; };\r\nvoid decodeArcData(out ArcData arc) {\r\n    arc.c     = fields1.xy * unpackXform.xy + unpackXform.zw;\r\n    arc.start = fields2.x * TAU;\r\n    arc.end   = fields2.y * TAU;\r\n    arc.major = fields2.w * max(unpackXform.x, unpackXform.y);\r\n#if defined(HAS_ELLIPTICALS)\r\n    arc.minor = extraParams.x;\r\n    arc.tilt  = extraParams.y * TAU;\r\n#endif\r\n}\r\n\r\nvoid strokeArc(const ArcData arc) {\r\n\r\n\r\n    float isStart = isStartVertex() ? -1.0 : 1.0;\r\n    float isLeft  = isLeftVertex()  ? -1.0 : 1.0;\r\n\r\n\r\n\r\n\r\n    vec2 minPt;\r\n    vec2 maxPt;\r\n\r\n    vec2 angles = vec2(arc.start, arc.end);\r\n    vec2 endsX = vec2(arc.c.x) + arc.major * cos(angles);\r\n    vec2 endsY = vec2(arc.c.y) + arc.minor * sin(angles);\r\n    minPt = maxPt = vec2(endsX.x, endsY.x);\r\n    min_max(minPt, maxPt, vec2(endsX.y, endsY.y));\r\n\r\n    if (arc.end > arc.start) {\r\n        if (arc.start < PI_0_5 && arc.end > PI_0_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y + arc.minor));\r\n        }\r\n        if (arc.start < PI && arc.end > PI) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x - arc.major, arc.c.y));\r\n        }\r\n        if (arc.start < PI_1_5 && arc.end > PI_1_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y - arc.minor));\r\n        }\r\n    } else {\r\n\r\n        min_max(minPt, maxPt, vec2(arc.c.x + arc.major, arc.c.y));\r\n\r\n\r\n\r\n        if (arc.start < PI_0_5 || arc.end > PI_0_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y + arc.minor));\r\n        }\r\n        if (arc.start < PI || arc.end > PI) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x - arc.major, arc.c.y));\r\n        }\r\n        if (arc.start < PI_1_5 || arc.end > PI_1_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y - arc.minor));\r\n        }\r\n    }\r\n\r\n    minPt -= fsHalfWidth + aaRange;\r\n    maxPt += fsHalfWidth + aaRange;\r\n\r\n    offsetPosition.x = (isStart < 0.0) ? minPt.x : maxPt.x;\r\n    offsetPosition.y = (isLeft < 0.0)  ? minPt.y : maxPt.y;\r\n\r\n\r\n\r\n\r\n\r\n    fsMultipurpose.x = arc.start;\r\n    fsMultipurpose.y = -arc.major;\r\n    fsMultipurpose.z = arc.end;\r\n    fsMultipurpose.w = arc.minor;\r\n}\r\n#endif\r\n\r\n#if defined(HAS_CIRCLES)\r\n\r\nvoid strokeCircularArc() {\r\n    ArcData arc; decodeArcData(arc);\r\n\r\n    float r = arc.major;\r\n    if (r * pixelsPerUnit < 0.125)\r\n        r = 0.25 * aaRange;\r\n    arc.major = arc.minor = r;\r\n\r\n    strokeArc(arc);\r\n}\r\n\r\n#endif\r\n\r\n#if defined(HAS_ELLIPTICALS)\r\nvoid strokeEllipticalArc() {\r\n    ArcData arc; decodeArcData(arc);\r\n    strokeArc(arc);\r\n}\r\n#endif\r\n\r\nstruct CommonAttribs { vec2 pos; vec4 color; vec2 layerTC, vpTC; float lineWidthHalf, geomType, ghosting; };\r\nvoid decodeCommonAttribs(out CommonAttribs attribs) {\r\n    attribs.pos           = fields1.xy * unpackXform.xy + unpackXform.zw;\r\n    attribs.color         = getVertexColor();\r\n    attribs.geomType      = flags4b.y;\r\n    attribs.layerTC       = layerVp4b.xy / 255.0;\r\n    attribs.vpTC          = layerVp4b.zw / 255.0;\r\n    attribs.lineWidthHalf = unpackLineWeight(fields2.z);\r\n    attribs.ghosting      = flags4b.w;\r\n}\r\n\r\nvoid strokeIndexedTriangle() {\r\n\r\n    fsHalfWidth = 0.0;\r\n    fsMultipurpose.z = 0.0;\r\n}\r\n\r\n#ifdef SELECTION_RENDERER\r\nbool isSelected(const CommonAttribs attribs) {\r\n\r\n\r\n    vec3 oid = getDbId().rgb;\r\n\r\n\r\n    float id01 = oid.r + oid.g * 256.0;\r\n    float t = (id01 + 0.5) * (1.0 / 4096.0);\r\n    float flrt = floor(t);\r\n    float texU = t - flrt;\r\n\r\n\r\n    float id23 = oid.b * (65536.0 / 4096.0) + flrt;\r\n    t = (id23 + 0.5) / vSelTexSize.y;\r\n    float texV = fract(t);\r\n\r\n    vec4 selBit = texture2D(tSelectionTexture, vec2(texU, texV));\r\n    return selBit.r == 1.0;\r\n}\r\n#endif\r\n\r\nbool isLayerOff(const CommonAttribs attribs) {\r\n#ifdef HAS_LAYERS\r\n    vec4 layerBit = texture2D(tLayerMask, attribs.layerTC);\r\n    return (layerBit.r == 0.0);\r\n#else\r\n    return false;\r\n#endif\r\n}\r\n\r\nvec4 getColor(const CommonAttribs attribs) {\r\n\r\n    if (isLayerOff(attribs)) { return vec4(0.0); }\r\n\r\n#ifdef SELECTION_RENDERER\r\n    if (isSelected(attribs)) { return selectionColor; }\r\n    return vec4(0.0);\r\n#else\r\n    return attribs.color;\r\n#endif\r\n}\r\n\r\nvoid main() {\r\n#ifndef UNPACK_POSITIONS\r\n    unpackXform = vec4(1.0, 1.0, 0.0, 0.0);\r\n#endif\r\n\r\n    CommonAttribs attribs; decodeCommonAttribs(attribs);\r\n#ifdef MSDF_TEXTURE_FONT\r\n    vuv = fields2.xy;\r\n    isMSDFQuards = 1.0 - abs(sign(attribs.geomType - VBB_GT_MSDF_TRIANGLE_INDEXED));\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\n    vuv = fields2.xy;\r\n#endif\r\n\r\n    fsColor = getColor(attribs);\r\n\r\n    if (swap != 0.0 ) {\r\n\r\n        if ( fsColor.r == 0.0 && fsColor.g == 0.0 && fsColor.b == 0.0 )\r\n            fsColor.rgb = vec3(1.0,1.0,1.0);\r\n\r\n        else if ( fsColor.r == 1.0 && fsColor.g == 1.0 && fsColor.b == 1.0 )\r\n            fsColor.rgb = vec3(0.0,0.0,0.0);\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    centralVertex = offsetPosition = attribs.pos;\r\n\r\n    float lineWeight = attribs.lineWidthHalf;\r\n    if (lineWeight > 0.0) {\r\n\r\n\r\n        if(lineWeight < 0.5 / pixelsPerUnit) {\r\n            lineWeight = 0.5 / pixelsPerUnit;\r\n        }\r\n    }\r\n    else {\r\n\r\n\r\n        lineWeight = abs(lineWeight) / pixelsPerUnit;\r\n    }\r\n\r\n    fsHalfWidth = lineWeight;\r\n\r\n    dbId = getDbId() / 255.0;\r\n\r\n    fsVpTC     = attribs.vpTC;\r\n    fsGhosting = attribs.ghosting;\r\n\r\n    if      (attribs.geomType == VBB_GT_LINE_SEGMENT)     strokeLineSegment();\r\n#ifdef HAS_CIRCLES\r\n    else if (attribs.geomType == VBB_GT_ARC_CIRCULAR)     strokeCircularArc();\r\n#endif\r\n#ifdef HAS_ELLIPTICALS\r\n    else if (attribs.geomType == VBB_GT_ARC_ELLIPTICAL)   strokeEllipticalArc();\r\n#endif\r\n#ifdef HAS_RASTER_QUADS\r\n    else if (attribs.geomType == VBB_GT_TEX_QUAD)         strokeTexQuad();\r\n#endif\r\n#ifdef HAS_TRIANGLE_GEOMS\r\n    else if (attribs.geomType == VBB_GT_ONE_TRIANGLE)     strokeOneTriangle();\r\n#endif\r\n    else if (attribs.geomType == VBB_GT_TRIANGLE_INDEXED) strokeIndexedTriangle();\r\n\r\n\r\n\r\n    fsOffsetDirection = offsetPosition - centralVertex;\r\n\r\n\r\n    gl_Position = mvpMatrix * modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\r\n\r\n#ifdef LOADING_ANIMATION\r\n\r\n    if (dbId.rgb == vec3(1.0)) {\r\n        loadingProgress = 1.0;\r\n    } else {\r\n        loadingProgress = smoothstep(0.0, 1.0, meshAnimTime);\r\n    }\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\n    fsHalfWidth = 0.0;\r\n#endif\r\n\r\n\r\n#if NUM_CUTPLANES > 0\r\n    vec4 worldPosition = modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\r\n    vWorldPosition = worldPosition.xyz;\r\n#endif\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\n    vPosition = offsetPosition.xy;\r\n#endif\r\n}\r\n"},"./src/wgs/render/shaders/liness_frag.glsl":function(e,t){e.exports="\n#include<line_decl_common>\n#include<id_decl_frag>\nuniform highp float pixelsPerUnit;\nuniform highp float aaRange;\nuniform float opacity;\nuniform highp float viewportId;\nuniform highp float swap;\nuniform highp float grayscale;\n#ifdef HAS_LINESTYLES\nuniform sampler2D tLineStyle;\nuniform vec2 vLineStyleTexSize;\n#endif\n#ifdef VIEWPORT_CLIPPING\nuniform highp vec4 viewportBounds;\nvarying highp vec2 vPosition;\nuniform mat4 mvpMatrix;\n#endif\nfloat curveGaussian(float r, float width) {\n    float amt = clamp(abs(r / (width * 1.0)), 0.0, 1.0);\n    amt = max(amt - 0.0, 0.0);\n    float exponent = amt * 2.0;\n    return clamp(exp(-exponent*exponent), 0.0, 1.0);\n}\n#ifdef HAS_LINESTYLES\nfloat getLinePatternPixel(int i, int j) {\n    return texture2D(tLineStyle, (vec2(i, j) + 0.5) / vLineStyleTexSize).x * 255.0;\n}\nfloat getPatternLength(int whichPattern) {\n    float p1 = getLinePatternPixel(0, whichPattern);\n    float p2 = getLinePatternPixel(1, whichPattern);\n    return (p2 * 256.0 + p1);\n}\n#endif\nvoid fillLineSegment() {\n    float radius = abs(fsHalfWidth);\n    float parametricDistance = fsMultipurpose.x;\n    float segmentLength      = fsMultipurpose.y;\n    float totalDistance      = fsMultipurpose.z;\n#ifdef LOADING_ANIMATION\n    float distFromStart = parametricDistance / segmentLength;\n    if (loadingProgress < 1.0 && distFromStart > loadingProgress) {\n        discard;\n    }\n#endif\n#ifdef HAS_LINESTYLES\n    int whichPattern         = int(fsMultipurpose.w);\n    if (whichPattern > 0) {\n        const float TEX_TO_UNIT = 1.0 / 96.0;\n        float patternScale;\n        if (fsHalfWidth < 0.0) {\n            patternScale = LTSCALE;\n        } else {\n            patternScale = LTSCALE * TEX_TO_UNIT * pixelsPerUnit;\n        }\n        float patLen = patternScale * getPatternLength(whichPattern);\n        float phase = mod((totalDistance + parametricDistance), patLen);\n        bool onPixel = true;\n        float radiusPixels = radius + aaRange;\n        for (int i=2; i<MAX_LINESTYLE_LENGTH; i+=2) {\n            float on = getLinePatternPixel(i, whichPattern);\n            if (on == 1.0) on = 0.0;\n            on *= patternScale;\n            onPixel = true;\n            phase -= on;\n            if (phase < 0.0) {\n                break;\n            }\n            else if (phase <= radiusPixels) {\n                onPixel = false;\n                break;\n            }\n            float off = getLinePatternPixel(i+1, whichPattern);\n            if (off <= 1.0) off = 0.0;\n            off *= patternScale;\n            onPixel = false;\n            phase -= off;\n            if (phase < -radiusPixels)\n                discard;\n            if (phase <= 0.0)\n                break;\n        }\n        if (!onPixel && (abs(phase) <= radiusPixels)) {\n            segmentLength = 0.0;\n            parametricDistance = phase;\n        }\n    }\n#endif\n    float dist;\n    float offsetLength2 = dot(fsOffsetDirection, fsOffsetDirection);\n    float ltz = max(0.0, sign(-parametricDistance));\n    float gtsl = max(0.0, sign(parametricDistance - segmentLength));\n    float d = (ltz + gtsl) * (parametricDistance - gtsl * segmentLength);\n    dist = sqrt(max(0.0, offsetLength2 + d*d));\n    float range =  dist - radius;\n    if (range > aaRange) {\n        discard;\n    }\n    gl_FragColor = fsColor;\n    if (range > -aaRange)\n        gl_FragColor.a *= curveGaussian(range+aaRange, aaRange * 2.0);\n}\n#ifdef LOADING_ANIMATION\n    void fillTriangle() { gl_FragColor = vec4(fsColor.rgb, fsColor.a * loadingProgress); }\n#else\n    void fillTriangle() { gl_FragColor = fsColor; }\n#endif\n#if NUM_CUTPLANES > 0\nvarying highp vec3 vWorldPosition;\n#endif\n#include<cutplanes>\nvoid main() {\n    if (fsColor == vec4(0.0)) {\n        discard;\n    }\n#ifdef VIEWPORT_CLIPPING\n    vec2 topLeft = (mvpMatrix  * vec4(viewportBounds.xy, 0., 1.)).xy;\n    vec2 bottomRight = ( mvpMatrix * vec4(viewportBounds.zw, 0., 1.)).xy;\n    vec2 topRight = (mvpMatrix  * vec4(viewportBounds.zy, 0., 1.)).xy;\n    vec2 bottomLeft = (mvpMatrix  * vec4(viewportBounds.xw, 0., 1.)).xy;\n    float leftBound = min(min(topLeft.x, bottomRight.x), min(topRight.x, bottomLeft.x));\n    float rightBound = max(max(topLeft.x, bottomRight.x), max(topRight.x, bottomLeft.x));\n    float topBound = min(min(topLeft.y, bottomRight.y), min(topRight.y, bottomLeft.y));\n    float bottomBound = max(max(topLeft.y, bottomRight.y), max(topRight.y, bottomLeft.y));\n    if(vPosition.x < leftBound || vPosition.x > rightBound || vPosition.y < topBound || vPosition.y > bottomBound) {\n        discard;\n    }\n#endif\n    if (fsHalfWidth == 0.0) {\n        fillTriangle();\n    }\n    else\n        fillLineSegment();\n#ifdef MRT_NORMALS\n    gl_FragData[1] = vec4(0.0);\n#endif\n    float writeId = 1.0;\n    gl_FragColor.a *= opacity;\n    if (gl_FragColor.a == 0.0) {\n        discard;\n    }\n    if (fsGhosting != 0.0 || \n            ((viewportId != 0.0) && (abs(fsVpTC.x * 255.0 + fsVpTC.y) >= 0.5 && abs(fsVpTC.x * 255.0 + fsVpTC.y - viewportId) >= 0.5))) {\n        writeId = 0.0;\n        gl_FragColor.a *= ((swap == 1.0) ? 0.21 : 0.1);\n    }\n#ifndef SELECTION_RENDERER\n    if (grayscale != 0.0) {\n        const vec3 rgb2grey = vec3(0.299, 0.587, 0.114);\n        float gray = dot(gl_FragColor.rgb, rgb2grey);\n        gl_FragColor.rgb = vec3(gray);\n    }\n#endif\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n#include<id_frag>\n}\n"},"./src/wgs/render/shaders/liness_vert.glsl":function(e,t){e.exports="\n#include<line_decl_common>\nattribute vec2 fields1;\nattribute vec4 fields2;\nattribute vec4 flags4b;\nattribute vec4 layerVp4b;\n#ifdef USE_INSTANCING\nattribute vec4 instFlags4b;\n#endif\n#ifdef VIEWPORT_CLIPPING\nvarying vec2 vPosition;\n#endif\nuniform mat4 mvpMatrix;\nuniform float pixelsPerUnit;\nuniform float aaRange;\nuniform vec2 size;\nuniform float viewportId;\nuniform float swap;\n#ifdef HAS_LAYERS\nuniform sampler2D tLayerMask;\n#endif\n#ifdef SELECTION_RENDERER\nuniform sampler2D tSelectionTexture;\nuniform vec2 vSelTexSize;\n#endif\n#ifdef SELECTION_RENDERER\nuniform vec4 selectionColor;\n#endif\n#ifdef LOADING_ANIMATION\nuniform float meshAnimTime;\n#endif\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\nvarying vec4 dbId;\n#ifdef UNPACK_POSITIONS\nuniform sampler2D tIdColor;\nuniform vec2 vIdColorTexSize;\nuniform vec4 unpackXform;\nattribute vec2 uvIdColor;\nfloat unpackLineWeight(float w) {\n    if (w > 0.5) {\n        return - (w - 0.5) * 1024.0;\n    } else {\n        return w * max(unpackXform.x, unpackXform.y) * 2.0;\n    }\n}\nvec4 getVertexColor() {\n    float u = (uvIdColor.x + 0.5) / vIdColorTexSize.x;\n    return texture2D(tIdColor, vec2(u, 0.5));\n}\nvec4 getDbId() {\n    float u = (uvIdColor.y + 0.5) / vIdColorTexSize.x;\n    vec4 normDbId = texture2D(tIdColor, vec2(u, 0.5));\n    return normDbId * 255.0;\n}\n#else\nattribute vec4 color4b;\nattribute vec4 dbId4b;\nvec4 unpackXform;\nfloat unpackLineWeight(float w) {\n    return w;\n}\nvec4 getVertexColor() {\n    return color4b;\n}\nvec4 getDbId() {\n    return dbId4b;\n}\n#endif\nvec2 centralVertex;\nvec2 offsetPosition;\nvec2 offsetPosDepth;\nvec2 cos_sin(const float angle) { return vec2(cos(angle), sin(angle)); }\nvoid min_max(inout vec2 minPt, inout vec2 maxPt, const vec2 p) {\n    minPt = min(minPt, p);\n    maxPt = max(maxPt, p);\n}\n#if defined(USE_INSTANCING)\nfloat getVertexId() { return instFlags4b.x; }\n#else\nfloat getVertexId() { return flags4b.x; }\n#endif\nbool isStartVertex() { return (getVertexId() < VBB_SEG_END_RIGHT); }\nbool isLeftVertex()  { float id = getVertexId(); return ((id == VBB_SEG_END_LEFT || id == VBB_SEG_START_LEFT)); }\nstruct SegmentData { float angle, distAlong, distTotal, lineWidthHalf, lineType; };\nvoid decodeSegmentData(out SegmentData seg) {\n    seg.angle         = fields2.x * TAU - PI;\n    seg.distAlong     = fields2.y * max(unpackXform.x, unpackXform.y);\n    seg.distTotal     = fields2.w;\n    seg.lineWidthHalf = unpackLineWeight(fields2.z);\n    seg.lineType      = flags4b.z;\n}\nvoid strokeLineSegment() {\n    SegmentData seg; decodeSegmentData(seg);\n    float isStartCapVertex = isStartVertex() ? -1.0 :  1.0;\n    float isLeftSide       = isLeftVertex( ) ?  1.0 : -1.0;\n    vec4 startPosition = (mvpMatrix * modelMatrix * vec4(centralVertex.xy, 0.0, 1.0));\n    float distanceAlong = seg.distAlong;\n    vec2 along = distanceAlong * cos_sin(seg.angle);\n    vec4 endPosition = (mvpMatrix * modelMatrix * vec4(centralVertex.xy + along, 0.0, 1.0));\n    vec2 screenStart = startPosition.xy * 0.5 * size / startPosition.w;\n    vec2 screenEnd = endPosition.xy * 0.5 * size / endPosition.w;\n    if (isStartCapVertex < 0.0) {\n        offsetPosition = centralVertex = screenStart;\n        offsetPosDepth = startPosition.zw;\n    } else {\n        offsetPosition = centralVertex = screenEnd;\n        offsetPosDepth = endPosition.zw;\n    }\n    vec2 screenDelta = screenEnd - screenStart;\n    float screenAngle = (distanceAlong == 0.0) ? 0.0 : atan(screenDelta.y, screenDelta.x);\n    float angleTransverse = screenAngle - isLeftSide * HALF_PI;\n    float lwAdjustment = fsHalfWidth + aaRange;\n    vec2 transverseOffset = cos_sin(angleTransverse) * lwAdjustment;\n    offsetPosition += transverseOffset;\n    vec2 moveOffset = isStartCapVertex * isLeftSide * vec2(-transverseOffset.y, transverseOffset.x);\n    offsetPosition += moveOffset;\n    centralVertex += moveOffset;\n    float distanceFromStart = max(0.0, isStartCapVertex) * length(screenDelta);\n    fsMultipurpose.x = (isStartCapVertex * lwAdjustment) + distanceFromStart;\n    fsMultipurpose.y = length(screenDelta);\n    fsMultipurpose.z = seg.distTotal;\n    fsMultipurpose.w = seg.lineType;\n    if (seg.lineWidthHalf < 0.0)\n        fsHalfWidth = -fsHalfWidth;\n    fsOffsetDirection = offsetPosition - centralVertex;\n    gl_Position = vec4(2.0 * offsetPosition / size * offsetPosDepth.y, offsetPosDepth.xy);\n}\nstruct CommonAttribs { vec2 pos; vec4 color; vec2 layerTC, vpTC; float lineWidthHalf, geomType, ghosting; };\nvoid decodeCommonAttribs(out CommonAttribs attribs) {\n    attribs.pos           = fields1.xy * unpackXform.xy + unpackXform.zw;\n    attribs.color         = getVertexColor();\n    attribs.geomType      = flags4b.y;\n    attribs.layerTC       = layerVp4b.xy / 255.0;\n    attribs.vpTC          = layerVp4b.zw / 255.0;\n    attribs.lineWidthHalf = unpackLineWeight(fields2.z);\n    attribs.ghosting      = flags4b.w;\n}\nvoid strokeIndexedTriangle() {\n    fsHalfWidth = 0.0;\n    fsMultipurpose.z = 0.0;\n    gl_Position = (mvpMatrix * modelMatrix * vec4(centralVertex.xy, 0.0, 1.0));\n}\n#ifdef SELECTION_RENDERER\nbool isSelected(const CommonAttribs attribs) {\n    vec3 oid = getDbId().rgb;\n    float id01 = oid.r + oid.g * 256.0;\n    float t = (id01 + 0.5) * (1.0 / 4096.0);\n    float flrt = floor(t);\n    float texU = t - flrt;\n    float id23 = oid.b * (65536.0 / 4096.0) + flrt;\n    t = (id23 + 0.5) / vSelTexSize.y;\n    float texV = fract(t);\n    vec4 selBit = texture2D(tSelectionTexture, vec2(texU, texV));\n    return selBit.r == 1.0;\n}\n#endif\nbool isLayerOff(const CommonAttribs attribs) {\n#ifdef HAS_LAYERS\n    vec4 layerBit = texture2D(tLayerMask, attribs.layerTC);\n    return (layerBit.r == 0.0);\n#else\n    return false;\n#endif\n}\nvec4 getColor(const CommonAttribs attribs) {\n    if (isLayerOff(attribs)) { return vec4(0.0); }\n#ifdef SELECTION_RENDERER\n    if (isSelected(attribs)) { return selectionColor; }\n    return vec4(0.0);\n#else\n    return attribs.color;\n#endif\n}\nvoid main() {\n#ifndef UNPACK_POSITIONS\n    unpackXform = vec4(1.0, 1.0, 0.0, 0.0);\n#endif\n    CommonAttribs attribs; decodeCommonAttribs(attribs);\n    fsColor = getColor(attribs);\n    if (swap != 0.0 ) {\n        if ( fsColor.r == 0.0 && fsColor.g == 0.0 && fsColor.b == 0.0 )\n            fsColor.rgb = vec3(1.0,1.0,1.0);\n        else if ( fsColor.r == 1.0 && fsColor.g == 1.0 && fsColor.b == 1.0 )\n            fsColor.rgb = vec3(0.0,0.0,0.0);\n    }\n    centralVertex = offsetPosition = attribs.pos;\n    float lineWeight = attribs.lineWidthHalf;\n    if (lineWeight > 0.0) {\n        lineWeight = max(0.5, lineWeight * pixelsPerUnit);\n    }\n    else {\n        lineWeight = max(0.5, abs(lineWeight));\n    }\n    fsHalfWidth = lineWeight;\n    dbId = dbId4b / 255.0;\n    fsVpTC     = attribs.vpTC;\n    fsGhosting = attribs.ghosting;\n#ifdef LOADING_ANIMATION\n    if (dbId.rgb == vec3(1.0)) {\n        loadingProgress = 1.0;\n    } else {\n        loadingProgress = smoothstep(0.0, 1.0, meshAnimTime);\n    }\n#endif\n    if      (attribs.geomType == VBB_GT_LINE_SEGMENT)     strokeLineSegment();\n    else strokeIndexedTriangle();\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n#ifdef VIEWPORT_CLIPPING\n    vPosition = gl_Position.xy;\n#endif\n}\n"},"./src/wgs/render/shaders/normals_frag.glsl":function(e,t){e.exports="varying highp vec3 vNormal;\nvarying highp float depth;\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include<cutplanes>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    vec3 n = vNormal;\n    n = n * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n    n = normalize( n );\n    gl_FragColor = vec4(n.x, n.y, depth, 1.0);\n}\n"},"./src/wgs/render/shaders/normals_vert.glsl":function(e,t){e.exports="varying vec3 vNormal;\nvarying float depth;\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include<pack_normals>\n#include<instancing_decl_vert>\nvoid main() {\n#ifdef UNPACK_NORMALS\n    vec3 objectNormal = decodeNormal(normal);\n#else\n    vec3 objectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\n    objectNormal = -objectNormal;\n#endif\n    objectNormal = getInstanceNormal(objectNormal);\n    vec3 instPos = getInstancePos(position);\n    vec3 transformedNormal = normalMatrix * objectNormal;\n    vNormal = normalize( transformedNormal );\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( instPos, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n    vec4 mvPosition = modelViewMatrix * vec4( instPos, 1.0 );\n    depth = mvPosition.z;\n    vec4 p_Position = projectionMatrix * mvPosition;\n    gl_Position = p_Position;\n}\n"},"./src/wgs/render/shaders/phong_frag.glsl":function(e,t){e.exports="uniform vec3 diffuse;\r\nuniform float opacity;\r\n\r\nuniform vec3 emissive;\r\nuniform vec3 specular;\r\nuniform float shininess;\r\n\r\n#include<env_sample>\r\n\r\n#ifdef USE_COLOR\r\nvarying vec3 vColor;\r\n#endif\r\n\r\n#ifdef GAMMA_INPUT\r\nvec3 InputToLinear(vec3 c) {\r\n    return c * c;\r\n}\r\nfloat InputToLinear(float c) {\r\n    return c * c;\r\n}\r\n#else\r\nvec3 InputToLinear(vec3 c) {\r\n    return c;\r\n}\r\nfloat InputToLinear(float c) {\r\n    return c;\r\n}\r\n#endif\r\n\r\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\r\nvarying vec2 vUv;\r\n#endif\r\n\r\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\nvarying vec2 vUvBump;\r\n#endif\r\n\r\n#if defined( USE_ALPHAMAP )\r\nvarying vec2 vUvAlpha;\r\n#endif\r\n\r\n#ifdef USE_MAP\r\nuniform sampler2D map;\r\n#endif\r\n\r\n#if TONEMAP_OUTPUT > 0\r\nuniform float exposureBias;\r\n#include<tonemap>\r\n#endif\r\n\r\n#if defined(IRR_RGBM) || defined(ENV_RGBM) || defined(ENV_GAMMA) || defined(IRR_GAMMA)\r\nuniform float envMapExposure;\r\n#endif\r\n\r\n#ifdef USE_FOG\r\nuniform vec3 fogColor;\r\nuniform float fogNear;\r\nuniform float fogFar;\r\n#endif\r\n#include<id_decl_frag>\r\n#include<theming_decl_frag>\r\n#include<shadowmap_decl_frag>\r\n\r\n#ifdef USE_ENVMAP\r\n\r\nuniform float reflMipIndex;\r\n\r\nuniform float reflectivity;\r\nuniform samplerCube envMap;\r\n\r\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\n\r\nuniform float refractionRatio;\r\n\r\n#endif\r\n\r\nvec3 sampleReflection(vec3 dir, float mipIndex) {\r\n\r\n    vec3 adjDir = adjustLookupVector(dir);\r\n\r\n#ifdef ENV_GAMMA\r\n\r\n#ifdef HAVE_TEXTURE_LOD\r\n    vec4 envTexColor = textureCubeLodEXT( envMap, adjDir, mipIndex );\r\n#else\r\n\r\n\r\n    vec4 envTexColor = textureCube( envMap, adjDir, mipIndex );\r\n#endif\r\n\r\n    return GammaDecode(envTexColor, envMapExposure);\r\n\r\n#elif defined(ENV_RGBM)\r\n\r\n#ifdef HAVE_TEXTURE_LOD\r\n    vec4 envTexColor = textureCubeLodEXT( envMap, adjDir, mipIndex );\r\n#else\r\n\r\n\r\n    vec4 envTexColor = textureCube( envMap, adjDir, mipIndex );\r\n#endif\r\n\r\n    return RGBMDecode(envTexColor, envMapExposure);\r\n\r\n#else\r\n\r\n\r\n\r\n    vec4 envTexColor = textureCube( envMap, adjDir );\r\n    vec3 cubeColor = envTexColor.xyz;\r\n\r\n#ifdef GAMMA_INPUT\r\n    cubeColor *= cubeColor;\r\n#endif\r\n\r\n    return cubeColor;\r\n\r\n#endif\r\n\r\n}\r\n\r\n#endif\r\n\r\n\r\nuniform vec3 ambientLightColor;\r\n\r\n#if MAX_DIR_LIGHTS > 0\r\n\r\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\r\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\r\n\r\n#endif\r\n\r\n#if MAX_POINT_LIGHTS > 0\r\n\r\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\r\n\r\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\r\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\r\n\r\n#endif\r\n\r\n#if MAX_SPOT_LIGHTS > 0\r\n\r\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\r\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\r\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\r\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\r\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\r\n\r\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\r\n\r\n#endif\r\n\r\n#ifdef USE_IRRADIANCEMAP\r\nuniform samplerCube irradianceMap;\r\n#endif\r\n\r\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\r\nvarying highp vec3 vWorldPosition;\r\n#endif\r\n\r\nvarying highp vec3 vViewPosition;\r\n#ifndef FLAT_SHADED\r\nvarying highp vec3 vNormal;\r\n#endif\r\n\r\n#ifdef USE_BUMPMAP\r\n\r\nuniform sampler2D bumpMap;\r\nuniform float bumpScale;\r\n\r\n\r\n\r\n\r\n\r\n\r\nvec2 dHdxy_fwd() {\r\n\r\n    vec2 dSTdx = dFdx( vUvBump );\r\n    vec2 dSTdy = dFdy( vUvBump );\r\n\r\n    float Hll = bumpScale * GET_BUMPMAP(vUvBump).x;\r\n    float dBx = bumpScale * GET_BUMPMAP(vUvBump + dSTdx).x - Hll;\r\n    float dBy = bumpScale * GET_BUMPMAP(vUvBump + dSTdy).x - Hll;\r\n\r\n    return vec2( dBx, dBy );\r\n\r\n}\r\n\r\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\r\n\r\n    vec3 vSigmaX = dFdx( surf_pos );\r\n    vec3 vSigmaY = dFdy( surf_pos );\r\n    vec3 vN = surf_norm;\r\n\r\n    vec3 R1 = cross( vSigmaY, vN );\r\n    vec3 R2 = cross( vN, vSigmaX );\r\n\r\n    float fDet = dot( vSigmaX, R1 );\r\n\r\n    vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\r\n    return normalize( abs( fDet ) * surf_norm - vGrad );\r\n\r\n}\r\n\r\n#endif\r\n\r\n\r\n#ifdef USE_NORMALMAP\r\n\r\nuniform sampler2D normalMap;\r\nuniform vec2 normalScale;\r\n\r\n\r\n\r\n\r\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\r\n\r\n    vec3 q0 = dFdx( eye_pos.xyz );\r\n    vec3 q1 = dFdy( eye_pos.xyz );\r\n    vec2 st0 = dFdx( vUvBump.st );\r\n    vec2 st1 = dFdy( vUvBump.st );\r\n\r\n    vec3 S = normalize(  q0 * st1.t - q1 * st0.t );\r\n    vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\r\n    vec3 N = normalize( surf_norm );\r\n\r\n    vec3 mapN = GET_NORMALMAP(vUvBump).xyz * 2.0 - 1.0;\r\n    mapN.xy = normalScale * mapN.xy;\r\n    mat3 tsn = mat3( S, T, N );\r\n    return normalize( tsn * mapN );\r\n\r\n}\r\n\r\n#endif\r\n\r\n\r\n#ifdef USE_SPECULARMAP\r\nuniform sampler2D specularMap;\r\n#endif\r\n\r\n#ifdef USE_ALPHAMAP\r\nuniform sampler2D alphaMap;\r\n#endif\r\n\r\n#include<hatch_pattern>\r\n\r\nvec3 Schlick_v3(vec3 v, float cosHV) {\r\n    float facing = max(1.0 - cosHV, 0.0);\r\n    return v + (1.0 - v) * pow(facing, 5.0);\r\n}\r\n\r\nfloat Schlick_f(float v, float cosHV) {\r\n    float facing = max(1.0 - cosHV, 0.0);\r\n    return v + ( 1.0 - v ) * pow(facing, 5.0);\r\n}\r\n\r\n#include<cutplanes>\r\n\r\nvoid main() {\r\n\r\n#if NUM_CUTPLANES > 0\r\n    checkCutPlanes(vWorldPosition);\r\n#endif\r\n\r\n    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );\r\n\r\n#ifdef USE_MAP\r\n    vec4 texelColor = GET_MAP(vUv);\r\n#ifdef MAP_INVERT\r\n    texelColor.xyz = 1.0-texelColor.xyz;\r\n#endif\r\n#ifdef GAMMA_INPUT\r\n    texelColor.xyz *= texelColor.xyz;\r\n#endif\r\n    gl_FragColor = gl_FragColor * texelColor;\r\n#endif\r\n\r\n#ifdef USE_ALPHAMAP\r\n    vec4 texelAlpha = GET_ALPHAMAP(vUvAlpha);\r\n    gl_FragColor.a *= texelAlpha.r;\r\n#endif\r\n\r\n#ifdef ALPHATEST\r\n    if ( gl_FragColor.a < ALPHATEST ) discard;\r\n#endif\r\n\r\n    float specularStrength;\r\n\r\n#ifdef USE_SPECULARMAP\r\n    vec4 texelSpecular = GET_SPECULARMAP(vUv);\r\n    specularStrength = texelSpecular.r;\r\n#else\r\n    specularStrength = 1.0;\r\n#endif\r\n\r\n#ifndef FLAT_SHADED\r\n    vec3 normal = normalize( vNormal );\r\n#ifdef DOUBLE_SIDED\r\n\r\n#endif\r\n#else\r\n    vec3 fdx = dFdx( vViewPosition );\r\n    vec3 fdy = dFdy( vViewPosition );\r\n    vec3 normal = normalize( cross( fdx, fdy ) );\r\n#endif\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    vec3 viewDirection;\r\n    if (projectionMatrix[3][3] == 0.0) {\r\n        viewDirection = normalize( vViewPosition );\r\n    } else {\r\n        viewDirection = vec3(0.0, 0.0, 1.0);\r\n    }\r\n    normal = faceforward(normal, -viewDirection, normal);\r\n\r\n    vec3 geomNormal = normal;\r\n\r\n#ifdef USE_NORMALMAP\r\n    normal = perturbNormal2Arb( -vViewPosition, normal );\r\n#elif defined( USE_BUMPMAP )\r\n    normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\r\n#endif\r\n\r\n    vec3 totalDiffuse = vec3( 0.0 );\r\n    vec3 totalSpecular = vec3( 0.0 );\r\n\r\n\r\n\r\n    float shininessB = shininess * 4.0;\r\n\r\n#if MAX_POINT_LIGHTS > 0\r\n\r\n    vec3 pointDiffuse  = vec3( 0.0 );\r\n    vec3 pointSpecular = vec3( 0.0 );\r\n\r\n    for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\r\n\r\n        vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\r\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\r\n\r\n        float lDistance = 1.0;\r\n        if ( pointLightDistance[ i ] > 0.0 )\r\n            lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\r\n\r\n        lVector = normalize( lVector );\r\n\r\n\r\n\r\n        float dotProduct = dot( normal, lVector );\r\n\r\n        float pointDiffuseWeight = max( dotProduct, 0.0 );\r\n\r\n\r\n        pointDiffuse  += InputToLinear(diffuse) * InputToLinear(pointLightColor[ i ]) * pointDiffuseWeight * lDistance;\r\n\r\n\r\n\r\n        vec3 pointHalfVector = normalize( lVector + viewDirection );\r\n        float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\r\n\r\n        float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininessB ), 0.0 );\r\n        float specularNormalization = shininessB * 0.125 + 0.25;\r\n        vec3 schlick = Schlick_v3(InputToLinear(specular), dot( lVector, pointHalfVector ) );\r\n        pointSpecular += schlick * InputToLinear(pointLightColor[ i ]) * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization ;\r\n\r\n    }\r\n\r\n    totalDiffuse += pointDiffuse;\r\n    totalSpecular += pointSpecular;\r\n\r\n#endif\r\n\r\n#if MAX_SPOT_LIGHTS > 0\r\n\r\n    vec3 spotDiffuse  = vec3( 0.0 );\r\n    vec3 spotSpecular = vec3( 0.0 );\r\n\r\n    for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\r\n\r\n        vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\r\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\r\n\r\n        float lDistance = 1.0;\r\n        if ( spotLightDistance[ i ] > 0.0 )\r\n            lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\r\n\r\n        lVector = normalize( lVector );\r\n\r\n        float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\r\n\r\n        if ( spotEffect > spotLightAngleCos[ i ] ) {\r\n\r\n            spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\r\n\r\n\r\n\r\n            float dotProduct = dot( normal, lVector );\r\n\r\n            float spotDiffuseWeight = max( dotProduct, 0.0 );\r\n\r\n            spotDiffuse += InputToLinear(diffuse) * InputToLinear(spotLightColor[ i ]) * spotDiffuseWeight * lDistance * spotEffect;\r\n\r\n\r\n\r\n            vec3 spotHalfVector = normalize( lVector + viewDirection );\r\n            float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\r\n            float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininessB ), 0.0 );\r\n\r\n            float specularNormalization = shininessB * 0.125 + 0.25;\r\n            vec3 schlick = Schlick_v3(InputToLinear(specular), dot( lVector, spotHalfVector ) );\r\n            spotSpecular += schlick * InputToLinear(spotLightColor[ i ]) * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\r\n        }\r\n\r\n    }\r\n\r\n    totalDiffuse += spotDiffuse;\r\n    totalSpecular += spotSpecular;\r\n\r\n#endif\r\n\r\n#if MAX_DIR_LIGHTS > 0\r\n\r\n    vec3 dirDiffuse  = vec3( 0.0 );\r\n    vec3 dirSpecular = vec3( 0.0 );\r\n\r\n    for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\r\n\r\n        vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\r\n        vec3 dirVector = normalize( lDirection.xyz );\r\n\r\n\r\n\r\n        float dotProduct = dot( normal, dirVector );\r\n\r\n        float dirDiffuseWeight = max( dotProduct, 0.0 );\r\n\r\n        dirDiffuse  += InputToLinear(diffuse) * InputToLinear(directionalLightColor[ i ]) * dirDiffuseWeight;\r\n\r\n\r\n\r\n        vec3 dirHalfVector = normalize( dirVector + viewDirection );\r\n        float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\r\n        float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininessB ), 0.0 );\r\n\r\n        float specularNormalization = shininessB * 0.125 + 0.25;\r\n        vec3 schlick = Schlick_v3(InputToLinear(specular), dot( dirVector, dirHalfVector ));\r\n\r\n        dirSpecular += schlick * InputToLinear(directionalLightColor[ i ]) * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\r\n\r\n    }\r\n\r\n    totalDiffuse += dirDiffuse;\r\n    totalSpecular += dirSpecular;\r\n\r\n#endif\r\n\r\n\r\n\r\n#ifdef USE_IRRADIANCEMAP\r\n    vec3 worldNormal = mat3(viewMatrixInverse) * normal;\r\n    vec3 indirectDiffuse = sampleIrradianceMap(worldNormal, irradianceMap, envMapExposure);\r\n\r\n    indirectDiffuse = applyEnvShadow(indirectDiffuse, worldNormal);\r\n\r\n    totalDiffuse += InputToLinear(diffuse) * indirectDiffuse;\r\n#endif\r\n\r\n\r\n#ifdef METAL\r\n    gl_FragColor.xyz = gl_FragColor.xyz * ( InputToLinear(emissive) + totalDiffuse + ambientLightColor * InputToLinear(diffuse) + totalSpecular );\r\n#else\r\n    gl_FragColor.xyz = gl_FragColor.xyz * ( InputToLinear(emissive) + totalDiffuse + ambientLightColor * InputToLinear(diffuse) ) + totalSpecular;\r\n#endif\r\n\r\n\r\n\r\n#ifdef USE_COLOR\r\n    gl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\r\n#endif\r\n\r\n\r\n#if defined(USE_ENVMAP)\r\n\r\n    vec3 reflectVec;\r\n\r\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\n\r\n#ifdef ENVMAP_MODE_REFLECTION\r\n    reflectVec = reflect( -viewDirection, normal );\r\n#else \r\n    reflectVec = refract( -viewDirection, normal, refractionRatio );\r\n#endif\r\n\r\n#else\r\n\r\n    reflectVec = reflect( -viewDirection, normal );\r\n\r\n#endif\r\n\r\n    reflectVec = mat3(viewMatrixInverse) * reflectVec;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    float reflectScale = 1.0;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    vec3 cubeColor = sampleReflection(reflectVec, reflMipIndex);\r\n\r\n    cubeColor *= reflectScale;\r\n\r\n    float facing = dot( viewDirection, normal );\r\n\r\n\r\n\r\n\r\n\r\n    if (facing < -1e-2)\r\n        facing = 1.0;\r\n    else\r\n        facing = max(1e-6, facing);\r\n\r\n#ifdef USE_BUMPMAP\r\n\r\n\r\n\r\n    facing = min(1.0, facing + bumpScale * 7.0);\r\n\r\n#endif\r\n\r\n    vec3 schlickRefl;\r\n\r\n#ifdef METAL\r\n\r\n\r\n    schlickRefl = InputToLinear(specular);\r\n\r\n#else\r\n\r\n\r\n    schlickRefl = Schlick_v3(InputToLinear(specular), facing);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    gl_FragColor.a = mix(gl_FragColor.a, Schlick_f(gl_FragColor.a, facing), reflectivity);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    float invSchlick = pow(1.0 - facing * 0.5, 5.0);\r\n\r\n\r\n    float norm_factor = (28.0 / 23.0) * (1.0 - invSchlick) * (1.0 - invSchlick);\r\n\r\n    gl_FragColor.xyz *= norm_factor * (1.0 - InputToLinear(specular));\r\n\r\n#endif\r\n\r\n\r\n    gl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\r\n\r\n#ifdef CLEARCOAT\r\n\r\n    vec3 reflectVecClearcoat = reflect( -viewDirection, geomNormal );\r\n    reflectVecClearcoat = mat3(viewMatrixInverse) * reflectVecClearcoat;\r\n\r\n    vec3 cubeColorClearcoat = sampleReflection(reflectVecClearcoat, 0.0);\r\n\r\n\r\n    float schlickClearcoat = Schlick_f(InputToLinear(reflectivity), facing);\r\n\r\n\r\n\r\n    gl_FragColor.xyz = mix(gl_FragColor.xyz, cubeColorClearcoat * schlickClearcoat, 0.5);\r\n\r\n#endif\r\n\r\n\r\n\r\n\r\n#endif\r\n\r\n#if TONEMAP_OUTPUT == 1\r\n    gl_FragColor.xyz = toneMapCanonOGS_WithGamma_WithColorPerserving(exposureBias * gl_FragColor.xyz);\r\n#elif TONEMAP_OUTPUT == 2\r\n    gl_FragColor.xyz = toneMapCanonFilmic_WithGamma( exposureBias * gl_FragColor.xyz );\r\n#endif\r\n\r\n\r\n\r\n#ifdef USE_FOG\r\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\r\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\r\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\r\n#endif\r\n#include<theming_frag>\r\n#include<final_frag>\r\n\r\n}\r\n";
},"./src/wgs/render/shaders/phong_vert.glsl":function(e,t){e.exports="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform mat3 texMatrix;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\nuniform mat3 texMatrixBump;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlpha;\nuniform mat3 texMatrixAlpha;\n#endif\n#if defined( USE_ENVMAP )\n#if ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nuniform float refractionRatio;\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#ifdef MRT_NORMALS\nvarying float depth;\n#endif\n#include<pack_normals>\n#include<instancing_decl_vert>\n#include<id_decl_vert>\n#include<wide_lines_decl>\n#include<shadowmap_decl_vert>\nvoid main() {\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\n    vUv = (texMatrix * vec3(uv, 1.0)).xy;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n    vUvBump = (texMatrixBump * vec3(uv, 1.0)).xy;\n#endif\n#if defined( USE_ALPHAMAP )\n    vUvAlpha = (texMatrixAlpha * vec3(uv, 1.0)).xy;\n#endif\n#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\n    vColor = color * color;\n#else\n    vColor = color;\n#endif\n#endif\n#ifdef UNPACK_NORMALS\n    vec3 objectNormal = decodeNormal(normal);\n#else\n    vec3 objectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\n    objectNormal = -objectNormal;\n#endif\n    objectNormal = getInstanceNormal(objectNormal);\n    vec3 instPos = getInstancePos(position);\n    vec3 transformedNormal = normalMatrix * objectNormal;\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n#endif\n    vec4 mvPosition = modelViewMatrix * vec4( instPos, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n#include<wide_lines_vert>\n    vViewPosition = -mvPosition.xyz;\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( instPos, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n#ifdef MRT_NORMALS\n    depth = mvPosition.z;\n#endif\n#include<shadowmap_vert>\n#include<id_vert>\n}\n"},"./src/wgs/render/shaders/sao_blur_frag.glsl":function(e,t){e.exports="\n#define EDGE_SHARPNESS     (3.0)\n#define SCALE               (2)\n#define R                   (4)\n#define VALUE_TYPE        float\n#define VALUE_COMPONENTS   r\n#define VALUE_IS_KEY       0\n#define KEY_COMPONENTS     gb\n#if __VERSION__ >= 330\nconst float gaussian[R + 1] =\nfloat[](0.153170, 0.144893, 0.122649, 0.092902, 0.062970);\n#endif\nuniform sampler2D   tDiffuse;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform vec2       axis;\nuniform float radius;\n#define  result         gl_FragColor.VALUE_COMPONENTS\n#define  keyPassThrough gl_FragColor.KEY_COMPONENTS\nfloat unpackKey(vec2 p) {\n    return p.x + p.y * (1.0 / 255.0);\n}\nvarying vec2 vUv;\nvoid main() {\n#   if __VERSION__ < 330\n    float gaussian[R + 1];\n#       if R == 3\n    gaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902;\n#       elif R == 4\n    gaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902; gaussian[4] = 0.062970;\n#       elif R == 6\n    gaussian[0] = 0.111220; gaussian[1] = 0.107798; gaussian[2] = 0.098151; gaussian[3] = 0.083953; gaussian[4] = 0.067458; gaussian[5] = 0.050920; gaussian[6] = 0.036108;\n#       endif\n#   endif\n    ivec2 axisi = ivec2(axis);\n    ivec2 ssC = ivec2(gl_FragCoord.xy);\n    vec4 temp = texture2D(tDiffuse, vUv);\n    gl_FragColor.gb = temp.KEY_COMPONENTS;\n    gl_FragColor.a = temp.a;\n    VALUE_TYPE sum = temp.VALUE_COMPONENTS;\n    if (temp.a == 0.0) {\n        result = sum;\n        return;\n    }\n    float key = unpackKey(keyPassThrough);\n    float BASE = gaussian[0];\n    float totalWeight = BASE;\n    sum *= totalWeight;\n    float scale = 1.5 / radius;\n    int r = -4; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[4];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = -3; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[3];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = -2; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[2];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r=-1; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[1];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 1; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[1];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 2; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[2];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 3; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[3];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 4; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[4];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    const float epsilon = 0.0001;\n    result = sum / (totalWeight + epsilon);\n}\n"},"./src/wgs/render/shaders/sao_frag.glsl":function(e,t){e.exports="\n#include <depth_texture>\n#define USE_MIPMAP 1\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform float lumInfluence;\nvarying vec2 vUv;\n#define NUM_SAMPLES (17)\n#define LOG_MAX_OFFSET (3)\n#define MAX_MIP_LEVEL (5)\n#define NUM_SPIRAL_TURNS (5)\n#define MIN_RADIUS (3.0)\nuniform float           projScale;\n#ifdef USE_MIPMAP\nuniform sampler2D tDepth_mip1;\nuniform sampler2D tDepth_mip2;\nuniform sampler2D tDepth_mip3;\nuniform sampler2D tDepth_mip4;\nuniform sampler2D tDepth_mip5;\n#endif\nuniform float radius;\nuniform float bias;\nuniform float intensity;\nvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\n    float alpha = float(float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));\n    float angle = alpha * (float(NUM_SPIRAL_TURNS) * 6.28) + spinAngle;\n    ssR = alpha;\n    return vec2(cos(angle), sin(angle));\n}\nfloat CSZToKey(float z) {\n    return clamp( (z+cameraNear) / (cameraNear-cameraFar), 0.0, 1.0);\n}\nvoid packKey(float key, out vec2 p) {\n    float temp = floor(key * 255.0);\n    p.x = temp * (1.0 / 255.0);\n    p.y = key * 255.0 - temp;\n}\n#include <pack_depth>\nfloat unpackDepthNearFar( const in vec4 rgba_depth ) {\n    float depth = unpackDepth( rgba_depth );\n    if (depth == 0.0)\n        return -cameraFar * 1.0e10;\n    return depth * (cameraNear - cameraFar) - cameraNear;\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\n    return normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 reconstructNonUnitCSFaceNormal(vec3 C) {\n    return cross(dFdy(C), dFdx(C));\n}\nvec3 getPosition(ivec2 ssP, float depth) {\n    vec3 P;\n    P = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\n    return P;\n}\nvec3 getOffsetPosition(ivec2 ssC, vec2 unitOffset, float ssR) {\n    ivec2 ssP = ivec2(ssR * unitOffset) + ssC;\n    vec3 P;\n    vec2 screenUV = (vec2(ssP) + vec2(0.5)) * resolution;\n#ifdef USE_MIPMAP\n    int mipLevel = int(max(0.0, min(floor(log2(ssR)) - float(LOG_MAX_OFFSET), float(MAX_MIP_LEVEL))));\n    if (mipLevel == 0) {\n        P.z = texture2D(tDepth, screenUV).z;\n        if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n    }\n    else if (mipLevel == 1)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip1, screenUV));\n    else if (mipLevel == 2)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip2, screenUV));\n    else if (mipLevel == 3)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip3, screenUV));\n    else if (mipLevel == 4)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip4, screenUV));\n    else if (mipLevel == 5)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip5, screenUV));\n#else\n    P.z = texture2D(tDepth, screenUV).z;\n    if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n#endif\n    P = reconstructCSPosition(vec2(ssP) + vec2(0.5), P.z);\n    return P;\n}\nfloat sampleAO(in ivec2 ssC, in vec3 C, in vec3 n_C, in float ssDiskRadius, in int tapIndex, in float randomPatternRotationAngle) {\n    float ssR;\n    vec2 unitOffset = tapLocation(tapIndex, randomPatternRotationAngle, ssR);\n    ssR = max(0.75, ssR * ssDiskRadius);\n    vec3 Q = getOffsetPosition(ssC, unitOffset, ssR);\n    vec3 v = Q - C;\n    float vv = dot(v, v);\n    float vn = dot(v, n_C);\n    const float epsilon = 0.001;\n    float angAdjust = mix(1.0, max(0.0, 1.5 * n_C.z), 0.35);\n#define HIGH_QUALITY\n#ifdef HIGH_QUALITY\n    float f = max(1.0 - vv / (radius * radius), 0.0); return angAdjust * f * max((vn - bias) / sqrt(epsilon + vv), 0.0);\n#else\n    float f = max(radius * radius - vv, 0.0); return angAdjust * f * f * f * max((vn - bias) / (epsilon + vv), 0.0);\n#endif\n}\nconst bool useNoise = true;\nfloat getRandomAngle(vec2 pos) {\n    float dt= dot(pos ,vec2(12.9898,78.233));\n    return 6.28318 * fract(sin(mod(dt,3.14)) * 43758.5453);\n}\nvoid main() {\n    ivec2 ssC = ivec2(gl_FragCoord.xy);\n    vec4 nrmz = texture2D(tDepth, vUv);\n    if (nrmz.z == 0.0) {\n        gl_FragColor.r = 1.0;\n        gl_FragColor.a = 0.0;\n        packKey(1.0, gl_FragColor.gb);\n        return;\n    }\n    vec3 C = getPosition(ssC, nrmz.z);\n    packKey(CSZToKey(C.z), gl_FragColor.gb);\n    float ssDiskRadius = -projScale * radius / mix(C.z, -1.0, isOrtho);\n    float A;\n    if (ssDiskRadius <= MIN_RADIUS) {\n        A = 1.0;\n    } else {\n        float sum = 0.0;\n        float randomPatternRotationAngle = getRandomAngle(vUv);\n        vec3 n_C = vec3(nrmz.x, nrmz.y, sqrt(1.0 - dot(nrmz.xy, nrmz.xy)));\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 0, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 1, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 2, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 3, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 4, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 5, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 6, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 7, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 8, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 9, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 10, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 11, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 12, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 13, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 14, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 15, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 16, randomPatternRotationAngle);\n        float intensityDivR6 = intensity / pow(radius, 6.0);\n#ifdef HIGH_QUALITY\n        A = pow(max(0.0, 1.0 - sqrt(sum * (3.0 / float(NUM_SAMPLES)))), intensity);\n#else\n        A = max(0.0, 1.0 - sum * intensityDivR6 * (5.0 / float(NUM_SAMPLES)));\n        A = (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;\n#endif\n        if (abs(dFdx(C.z)) < 0.02) {\n            A -= dFdx(A) * (mod(float(ssC.x), 2.0) - 0.5);\n        }\n        if (abs(dFdy(C.z)) < 0.02) {\n            A -= dFdy(A) * (mod(float(ssC.y), 2.0) - 0.5);\n        }\n        A = mix(1.0, A, clamp(ssDiskRadius - MIN_RADIUS,0.0,1.0));\n    }\n    gl_FragColor.r = A;\n    gl_FragColor.a = 1.0;\n}\n"},"./src/wgs/render/shaders/sao_min_frag.glsl":function(e,t){e.exports="uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvoid main() {\n    vec2 ssP = vec2(gl_FragCoord.xy);\n    ssP = ssP * 2.0 + mod(ssP, 2.0);\n    ssP = (ssP + 0.5) * resolution * 0.5;\n    gl_FragColor = texture2D(tDiffuse, ssP);\n}\n"},"./src/wgs/render/shaders/sao_minfirst_frag.glsl":function(e,t){e.exports="uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraInvNearFar;\n#include <pack_depth>\nvoid main() {\n    vec2 ssP = vec2(gl_FragCoord.xy);\n    ssP = ssP * 2.0 + mod(ssP, 2.0);\n    ssP = (ssP + 0.5) * resolution * 0.5;\n    float depth = texture2D(tDiffuse, ssP).z;\n    if (depth != 0.0)\n        depth = (depth + cameraNear) * cameraInvNearFar;\n    gl_FragColor = packDepth(depth);\n}\n"},"./src/wgs/render/shaders/screen_quad_uv_vert.glsl":function(e,t){e.exports="varying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},"./src/wgs/render/shaders/screen_quad_vert.glsl":function(e,t){e.exports="\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},"./src/wgs/render/shaders/shadowmap_frag.glsl":function(e,t){e.exports="#include<shadowmap_decl_common>\nvarying float depth;\n#ifdef USE_SURFACE_CUTOUT_MAP\n#include<float3_average>\n#prism_uniforms<surface_cutout_map>\nvarying vec2 vUv;\n#else\n#ifdef USE_MAP\nvarying vec2 vUv;\nuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\nvarying vec2 vUvAlpha;\nuniform sampler2D alphaMap;\n#endif\n#endif\nuniform float shadowMinOpacity;\nvoid applyCutoutMaps() {\n    float opacity = 1.0;\n#ifdef USE_SURFACE_CUTOUT_MAP\n#prism_sample_texture<surface_cutout, opacity, true, false>\n#else\n#ifdef USE_MAP\n    opacity *= GET_MAP(vUv).a;\n#endif\n#ifdef USE_ALPHAMAP\n    opacity *= GET_ALPHAMAP(vUvAlpha).r;\n#endif\n#endif\n#if defined(USE_SURFACE_CUTOUT_MAP) || defined(USE_MAP) || defined(USE_ALPHAMAP)\n    if (opacity < shadowMinOpacity) discard;\n#endif\n}\nvoid main() {\n    float normalizedLinearDepth = (depth - shadowMapRangeMin) / shadowMapRangeSize;\n    float val = exp(shadowESMConstant * normalizedLinearDepth);\n#ifdef USE_HARD_SHADOWS\n    val = normalizedLinearDepth;\n#endif\n    applyCutoutMaps();\n    gl_FragColor = vec4(val, 0, 0, 1);\n}\n"},"./src/wgs/render/shaders/shadowmap_ground_frag.glsl":function(e,t){e.exports="#include<shadowmap_decl_frag>\nvoid main() {\n    float shadowIntensity = 0.5 * (1.0 - getShadowValue());\n    gl_FragColor = vec4(0.0, 0.0, 0.0, shadowIntensity);\n}\n"},"./src/wgs/render/shaders/shadowmap_ground_vert.glsl":function(e,t){e.exports="#include<shadowmap_decl_vert>\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n#include<shadowmap_vert>\n}\n"},"./src/wgs/render/shaders/shadowmap_vert.glsl":function(e,t){e.exports="#include<shadowmap_decl_common>\nvarying float depth;\n#ifdef USE_SURFACE_CUTOUT_MAP\nvarying vec2 vUv;\n#else\n#ifdef USE_MAP\nvarying vec2 vUv;\nuniform mat3 texMatrix;\n#endif\n#ifdef USE_ALPHAMAP\nvarying vec2 vUvAlpha;\nuniform mat3 texMatrixAlpha;\n#endif\n#endif\nvoid passCutoutUVCoords() {\n#ifdef USE_SURFACE_CUTOUT_MAP\n    vUv = uv;\n#else\n#ifdef USE_MAP\n    vUv = (texMatrix * vec3(uv, 1.0)).xy;\n#endif\n#ifdef USE_ALPHAMAP\n    vUvAlpha = (texMatrixAlpha * vec3(uv, 1.0)).xy;\n#endif\n#endif\n}\nvoid main() {\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vec4 p_Position = projectionMatrix * mvPosition;\n    gl_Position = p_Position;\n    depth = -mvPosition.z;\n    passCutoutUVCoords();\n}\n"},"./src/wgs/scene/BVHBuilder.js":function(e,t,r){"use strict";function n(e,t){t?this.bytes_per_node=32:this.bytes_per_node=36;var r,n;e instanceof ArrayBuffer?(r=e.byteLength/this.bytes_per_node,n=e,this.nodeCount=r):(r=0|e,n=new ArrayBuffer(this.bytes_per_node*r),this.nodeCount=0),this.nodeCapacity=r,this.nodesRaw=n,this.is_lean_node=t,this.node_stride=this.bytes_per_node/4,this.node_stride_short=this.bytes_per_node/2,this.nodesF=new Float32Array(this.nodesRaw),this.nodesI=new Int32Array(this.nodesRaw),this.nodesS=new Uint16Array(this.nodesRaw)}function i(e,t){this.boxes=e.boxes,this.polygonCounts=e.polygonCounts,this.hasPolygonCounts=!!this.polygonCounts,this.materials=e.materials,this.materialDefs=t,this.count=e.length,this.boxStride=6,this.wantSort=!0}function o(e,t,r){this.finfo=r||new i(e,t),this.prim_count=this.finfo.getCount(),this.frags_per_leaf_node=-1,this.frags_per_inner_node=-1,this.nodes=null,this.work_buf=new ArrayBuffer(4*this.prim_count),this.sort_prims=new Int32Array(this.work_buf),this.primitives=new Int32Array(this.prim_count),this.centroids=new Float32Array(s*this.prim_count),this.boxv_o=new Float32Array(6),this.boxc_o=new Float32Array(6),this.boxv_t=new Float32Array(6),this.boxc_t=new Float32Array(6),this.recursion_stack=[]}r.r(t),r.d(t,"NodeArray",function(){return n}),r.d(t,"BVHBuilder",function(){return o}),n.prototype.setLeftChild=function(e,t){this.nodesI[e*this.node_stride+6]=t},n.prototype.getLeftChild=function(e){return this.nodesI[e*this.node_stride+6]},n.prototype.setPrimStart=function(e,t){this.is_lean_node?this.nodesI[e*this.node_stride+6]=t:this.nodesI[e*this.node_stride+8]=t},n.prototype.getPrimStart=function(e){return this.is_lean_node?this.nodesI[e*this.node_stride+6]:this.nodesI[e*this.node_stride+8]},n.prototype.setPrimCount=function(e,t){this.nodesS[e*this.node_stride_short+14]=t},n.prototype.getPrimCount=function(e){return this.nodesS[e*this.node_stride_short+14]},n.prototype.setFlags=function(e,t,r,n){this.nodesS[e*this.node_stride_short+15]=n<<3|r<<2|3&t},n.prototype.getFlags=function(e){return this.nodesS[e*this.node_stride_short+15]},n.prototype.setBox0=function(e,t){var r=e*this.node_stride,n=this.nodesF;n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2],n[r+3]=t[3],n[r+4]=t[4],n[r+5]=t[5]},n.prototype.getBoxThree=function(e,t){var r=e*this.node_stride,n=this.nodesF;t.min.x=n[r],t.min.y=n[r+1],t.min.z=n[r+2],t.max.x=n[r+3],t.max.y=n[r+4],t.max.z=n[r+5]},n.prototype.getBoxArray=function(e,t,r){var n=e*this.node_stride,i=this.nodesF;r=r||0,t[0+r]=i[n],t[1+r]=i[n+1],t[2+r]=i[n+2],t[3+r]=i[n+3],t[4+r]=i[n+4],t[5+r]=i[n+5]},n.prototype.setBoxThree=function(e,t){var r=e*this.node_stride,n=this.nodesF;n[r]=t.min.x,n[r+1]=t.min.y,n[r+2]=t.min.z,n[r+3]=t.max.x,n[r+4]=t.max.y,n[r+5]=t.max.z},n.prototype.makeEmpty=function(e){var t=e*this.node_stride,r=this.nodesI;r[t+6]=-1,r[t+7]=0,this.is_lean_node||(r[t+8]=-1)},n.prototype.realloc=function(e){if(this.nodeCount+e>this.nodeCapacity){var t=0|3*this.nodeCapacity/2;t<this.nodeCount+e&&(t=this.nodeCount+e);var r=new ArrayBuffer(t*this.bytes_per_node),n=new Int32Array(r);n.set(this.nodesI),this.nodeCapacity=t,this.nodesRaw=r,this.nodesF=new Float32Array(r),this.nodesI=n,this.nodesS=new Uint16Array(r)}},n.prototype.nextNodes=function(e){this.realloc(e);var t=this.nodeCount;this.nodeCount+=e;for(var r=0;e>r;r++)this.makeEmpty(t+r);return t},n.prototype.getRawData=function(){return this.nodesRaw.slice(0,this.nodeCount*this.bytes_per_node)};var s=3,a=1e-5,l=1e-5,c=15,u=16,d=function(){function e(e,t,r,n){e[t]=.5*(r[n]+r[n+3]),e[t+1]=.5*(r[n+1]+r[n+4]),e[t+2]=.5*(r[n+2]+r[n+5])}function t(e,t,r){e[0]>t[r]&&(e[0]=t[r]),e[3]<t[r]&&(e[3]=t[r]),e[1]>t[r+1]&&(e[1]=t[r+1]),e[4]<t[r+1]&&(e[4]=t[r+1]),e[2]>t[r+2]&&(e[2]=t[r+2]),e[5]<t[r+2]&&(e[5]=t[r+2])}function r(e,t,r){e[0]>t[r]&&(e[0]=t[r]),e[1]>t[r+1]&&(e[1]=t[r+1]),e[2]>t[r+2]&&(e[2]=t[r+2]),e[3]<t[r+3]&&(e[3]=t[r+3]),e[4]<t[r+4]&&(e[4]=t[r+4]),e[5]<t[r+5]&&(e[5]=t[r+5])}function n(e,t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[3]&&(e[3]=t[3]),e[4]<t[4]&&(e[4]=t[4]),e[5]<t[5]&&(e[5]=t[5])}function i(e,t,r,n){for(var i=0;3>i;i++)e[t+i]=r[n+3+i]-r[n+i]}function o(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]}function s(e){e[0]=w,e[1]=w,e[2]=w,e[3]=-w,e[4]=-w,e[5]=-w}function d(e,t){var r=e[t+3]-e[t],n=e[t+4]-e[t+1],i=e[t+5]-e[t+2];return 0>r||0>n||0>i?0:2*(r*n+n*i+i*r)}function h(e){var t=e[3]-e[0],r=e[4]-e[1],n=e[5]-e[2];return 0>t||0>r||0>n?0:2*(t*r+r*n+n*t)}function f(){this.vb_left=new Float32Array(6),this.vb_right=new Float32Array(6),this.cb_left=new Float32Array(6),this.cb_right=new Float32Array(6),this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1}function p(){this.box_bbox=new Float32Array(6),this.box_centroid=new Float32Array(6),this.num_prims=0}function m(){this.BL=new Float32Array(6),this.CL=new Float32Array(6),this.NL=0,this.AL=0}function g(e,n,i,o,s,a,c){for(var u=e.centroids,d=e.primitives,h=e.finfo.boxes,f=e.finfo.boxStride,p=c*(1-l)/a[o],m=s[o],g=e.sort_prims,v=n;i>=v;v++){var y=0|d[v],_=p*(u[3*y+o]-m),b=0|_;0>b?b=0:b>=c&&(b=c-1),g[v]=b,S[b].num_prims++,r(S[b].box_bbox,h,y*f),t(S[b].box_centroid,u,3*y)}}function v(e,t,r,i,s,a,l){if(a[i]<e.scene_epsilon)return void(l.best_cost=1/0);var c=u;c>r-t+1&&(c=r-t+1);var d;for(d=0;c>d;d++)S[d].reset();for(d=0;c-1>d;d++)A[d].reset();l.num_bins=c,g(e,t,r,i,s,a,c),o(A[0].BL,S[0].box_bbox),o(A[0].CL,S[0].box_centroid),A[0].AL=h(A[0].BL),A[0].NL=S[0].num_prims;var f;for(d=1;c-1>d;d++){f=S[d];var p=A[d];o(p.BL,A[d-1].BL),n(p.BL,f.box_bbox),p.AL=h(p.BL),o(p.CL,A[d-1].CL),n(p.CL,f.box_centroid),p.NL=A[d-1].NL+f.num_prims}d=c-1,o(M,S[d].box_bbox),o(T,S[d].box_centroid);var m=h(M),v=S[d].num_prims,y=d,_=m*v+A[d-1].AL*A[d-1].NL;for(o(l.vb_right,M),o(l.cb_right,S[d].box_centroid),o(l.vb_left,A[d-1].BL),o(l.cb_left,A[d-1].CL),l.num_left=A[d-1].NL,d-=1;d>=1;d--){f=S[d],n(M,f.box_bbox),n(T,f.box_centroid),m=h(M),v+=f.num_prims;var b=m*v+A[d-1].AL*A[d-1].NL;_>=b&&(_=b,y=d,o(l.vb_right,M),o(l.cb_right,T),o(l.vb_left,A[d-1].BL),o(l.cb_left,A[d-1].CL),l.num_left=A[d-1].NL)}l.best_split=y,l.best_cost=_}function y(e,t,r,n,i,o,s){var a,l,c=e.primitives,u=e.sort_prims,d=0,h=0|t,f=0|s.best_split;for(a=t;r>=a;a++){var p=0|c[a],m=u[a];f>m?c[h++]=p:u[d++]=p}for(l=0;d>l;l++)c[h+l]=u[l]}function _(e,r,n,o,a,l,c,u){var d=e.primitives,h=e.centroids,f=a-o+1;f>e.frags_per_inner_node&&(f=e.frags_per_inner_node),f>u&&(f=u),r.setPrimStart(n,o),r.setPrimCount(n,f),o+=f,s(l);for(var p=o;a>=p;p++)t(l,h,3*d[p]);i(c,0,l,0);var m=0;return c[1]>c[0]&&(m=1),c[2]>c[m]&&(m=2),m}function b(e,t,r,n,o,s,a,l){i(C,0,s,0);var u=e.nodes,d=a?e.frags_per_leaf_node_transparent:e.frags_per_leaf_node,h=a?e.frags_per_inner_node_transparent:e.frags_per_inner_node,p=e.max_polys_per_node,m=0;C[1]>C[0]&&(m=1),C[2]>C[m]&&(m=2),u.setBox0(t,o);var g=0,b=0,x=n-r+1;if(e.finfo.hasPolygonCounts&&e.frags_per_inner_node)for(var w=x<=e.frags_per_inner_node?n:r+e.frags_per_inner_node-1,E=r;w>=E&&(g+=e.finfo.getPolygonCount(e.primitives[E]),b++,!(g>p));E++);var S=d>=x&&p>g||1===x;if(S||l>c||C[m]<e.scene_epsilon)return u.setLeftChild(t,-1),u.setPrimStart(t,r),u.setPrimCount(t,n-r+1),void u.setFlags(t,0,0,a?1:0);h&&(m=_(e,u,t,r,n,s,C,b),r+=u.getPrimCount(t));var A=new f;if(v(e,r,n,m,s,C,A),A.num_bins<0)return void u.setPrimCount(t,u.getPrimCount(t)+n-r+1);y(e,r,n,m,s,C,A);var M=u.nextNodes(2),T=.5*(A.vb_left[3+m]+A.vb_left[m]),j=.5*(A.vb_right[3+m]+A.vb_right[m]);u.setFlags(t,m,j>T?0:1,a?1:0),u.setLeftChild(t,M),e.recursion_stack.push([e,M+1,r+A.num_left,n,A.vb_right,A.cb_right,a,l+1]),e.recursion_stack.push([e,M,r,r+A.num_left-1,A.vb_left,A.cb_left,a,l+1])}function x(n){var o=n.boxv_o,l=n.boxc_o,c=n.boxv_t,u=n.boxc_t;s(o),s(l),s(c),s(u);for(var d=n.centroids,h=n.finfo.boxes,f=n.finfo.boxStride,p=0,m=n.prim_count;m>p;p++){var g=n.primitives[p];e(d,3*g,h,f*g),p>=n.first_transparent?(t(u,d,3*g),r(c,h,f*g)):(t(l,d,3*g),r(o,h,f*g))}i(C,0,n.boxv_o,0);var v=Math.max(C[0],C[1],C[2]);n.scene_epsilon=a*v}var w=1/0;f.prototype.reset=function(){this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1},p.prototype.reset=function(){this.num_prims=0,s(this.box_bbox),s(this.box_centroid)},m.prototype.reset=function(){this.NL=0,this.AL=0,s(this.BL),s(this.CL)};var E,S=[];for(E=0;u>E;E++)S.push(new p);var A=[];for(E=0;u-1>E;E++)A.push(new m);var M=new Float32Array(6),T=new Float32Array(6),C=new Float32Array(3);return{bvh_subdivide:b,compute_boxes:x,box_area:d}}();i.prototype.getCount=function(){return this.count},i.prototype.isTransparent=function(e){return this.materialDefs&&this.materialDefs[this.materials[e]]?this.materialDefs[this.materials[e]].transparent:!1},i.prototype.getPolygonCount=function(e){return this.polygonCounts[e]},o.prototype.sortPrimitives=function(e){var t,r,n=new Float32Array(this.work_buf),i=this.primitives,o=0,s=e;for(t=0,r=this.prim_count;r>t;t++){i[t]=t;var a=this.finfo.isTransparent(t);a&&o++,s?(n[t]=d.box_area(this.finfo.boxes,this.finfo.boxStride*t),a&&(n[t]=-n[t])):n[t]=a?-1:1}if(s)Array.prototype.sort.call(this.primitives,function(e,t){return n[t]-n[e]});else if(o&&o<this.prim_count){var l=new Int32Array(o),c=0,u=0;for(t=0,r=this.prim_count;r>t;t++)n[t]>=0?i[c++]=i[t]:l[u++]=i[t];i.set(l,this.prim_count-o)}this.first_transparent=this.prim_count-o},o.prototype.build=function(e){function t(t,r){e.hasOwnProperty(t)?i[t]=e[t]:i[t]=r}var r=e&&!!e.useSlimNodes,i=this;if(r)t("frags_per_leaf_node",1),t("frags_per_inner_node",0),t("frags_per_leaf_node_transparent",1),t("frags_per_inner_node_transparent",0),t("max_polys_per_node",1/0);else{var o=e.isWeakDevice?.5:1;t("frags_per_leaf_node",0|256*o),t("frags_per_inner_node",0|this.frags_per_leaf_node),t("frags_per_leaf_node_transparent",this.frags_per_leaf_node),t("frags_per_inner_node_transparent",0),t("max_polys_per_node",0|2e4*o)}if(this.nodes&&this.nodes.is_lean_node==r)this.nodes.nodeCount=0;else{for(var s=this.prim_count/this.frags_per_leaf_node,a=1;s>a;)a*=2;this.nodes=new n(a,e?e.useSlimNodes:!1)}this.sortPrimitives(this.finfo.wantSort),d.compute_boxes(this);var l=this.nodes.nextNodes(2);d.bvh_subdivide(this,l,0,this.first_transparent-1,this.boxv_o,this.boxc_o,!1,0);for(var c;this.recursion_stack.length;)c=this.recursion_stack.pop(),d.bvh_subdivide(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7]);for(d.bvh_subdivide(this,l+1,this.first_transparent,this.prim_count-1,this.boxv_t,this.boxc_t,!0,0);this.recursion_stack.length;)c=this.recursion_stack.pop(),d.bvh_subdivide(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7])}},"./src/wgs/scene/BufferGeometry.js":function(e,t,r){"use strict";function n(e,t,r){var n;if(t.array)n=new f.BufferAttribute(t.array,t.itemSize);else{var i=e+"|"+t.bytesPerItem+"|"+t.normalize+"|"+t.isPattern+"|"+t.divisor+"|"+t.offset;if(n=m[i])return n;n=new f.BufferAttribute(void 0,t.itemSize),m[i]=n}return n.bytesPerItem=t.bytesPerItem,n.normalize=t.normalize,n.isPattern=t.isPattern,r&&(n.divisor=t.divisor),t.array||(t.hasOwnProperty("offset")?n.itemOffset=t.offset:p.logger.warn("VB attribute is neither interleaved nor separate. Something is wrong with the buffer specificaiton.")),n}function i(e){var t="";for(var r in e.attributes)t+=r+"|";var n=g[t];return n?n:(n=Object.keys(e.attributes),g[t]=n,n)}function o(){l=new f.BufferAttribute(void 0,1),l.bytesPerItem=2,c=new f.BufferAttribute(void 0,1),c.bytesPerItem=4,u=function(){this.id=v++,this.attributes={},this.__webglInit=void 0},u.prototype=Object.create(f.BufferGeometry.prototype),u.prototype.constructor=u}function s(){return u||o(),new u}function a(e){var t=e.mesh,r=s();Object(h.isNodeJS)()&&(r.packId=e.packId,r.meshIndex=e.meshIndex),r.byteSize=0,r.vb=t.vb,r.vbbuffer=void 0,r.vbNeedsUpdate=!0,r.byteSize+=t.vb.byteLength,r.hash=e.hash,r.vbstride=t.vbstride,t.isLines&&(r.isLines=t.isLines),t.isWideLines&&(r.isWideLines=!0,r.lineWidth=t.lineWidth),t.isPoints&&(r.isPoints=t.isPoints,r.pointSize=t.pointSize),e.is2d&&(r.is2d=!0),r.numInstances=t.numInstances;for(var o in t.vblayout){var a=t.vblayout[o];r.attributes[o]=n(o,a,r.numInstances)}if(d.memoryOptimizedLoading)r.attributes.index=t.indices instanceof Uint32Array?c:l,r.ib=t.indices,r.ibbuffer=void 0,t.iblines&&(r.attributes.indexlines=t.iblines instanceof Uint32Array?c:l,r.iblines=t.iblines,r.iblinesbuffer=void 0);else{var u=new f.BufferAttribute(t.indices,1);u.bytesPerItem=t.indices instanceof Uint32Array?4:2,r.addAttribute("index",u)}r.attributesKeys=i(r),r.byteSize+=t.indices.byteLength,r.boundingBox=(new f.Box3).copy(t.boundingBox),r.boundingSphere=(new f.Sphere).copy(t.boundingSphere),e.geometry=r,e.mesh=null}r.r(t),r.d(t,"createBufferGeometry",function(){return s}),r.d(t,"meshToGeometry",function(){return a}),r.d(t,"BufferGeometryUtils",function(){return y});var l,c,u,d=r("./src/wgs/globals.js"),h=r("./src/compat.js"),f=r("./thirdparty/three.js/three.js"),p=(r.n(f),r("./src/logger/Logger.js")),m={},g={},v=1,y={meshToGeometry:a,createBufferGeometry:s,findBufferAttribute:n}},"./src/wgs/scene/DeriveTopology.js":function(e,t,r){"use strict";function n(e,t,r,n,i){var o=0|e.x*n,s=0|e.y*n,a=0|e.z*n,l=r[o];l||(r[o]=l={});var c=l[s];c||(l[s]=c={});var u=c[a];void 0===u&&(c[a]=u=t),i[t]=u}function i(e,t){function r(e,t,r,s){n(e,s,o,d,i)}var i=[],o={},s=1;if(e.boundingBox||t){var l=(new c.LmvBox3).copy(e.boundingBox||t),u=l.size();s=Math.max(u.x,Math.max(u.y,u.z))}var d=65536/s;return Object(a.enumMeshVertices)(e,r),i}function o(e,t){function r(e,t,r,i){n[3*i]=e.x,n[3*i+1]=e.y,n[3*i+2]=e.z}var n=new Float32Array(3*Object(a.getVertexCount)(e));return Object(a.enumMeshVertices)(e,r,t),n}function s(e,t,r,n){function s(e,t){t.x=f[3*e],t.y=f[3*e+1],t.z=f[3*e+2]}function c(e,t,r,n){s(e,g),s(t,v),s(r,y),v.sub(g),y.sub(g),v.cross(y),n.copy(v).normalize()}function u(e,t,r){var i=h[e],o=h[t],s=h[r];if(i!==o&&i!==s&&o!==s){var a=!1;if(i>o){var l=i;i=o,o=l,a=!0}var u=p[i];if(u){var d=u[o];if(void 0===d)u[o]=a?-r-1:r;else{if(n)m.push(e),
m.push(t);else{c(e,t,r,_),0>d?c(o,i,h[-d-1],b):c(i,o,h[d],b);var f=_.dot(b);Math.abs(f)<.25&&(m.push(e),m.push(t))}delete u[o]}}else p[i]={},p[i][o]=r}}function d(e,t,r,n,i,o){u(n,i,o),u(i,o,n),u(o,n,i)}if(!e.isLines&&!e.iblines){var h=i(e,r),f=o(e,t),p={},m=[],g=new l.LmvVector3,v=new l.LmvVector3,y=new l.LmvVector3,_=new l.LmvVector3,b=new l.LmvVector3;Object(a.enumMeshTriangles)(e,d);for(var x in p)for(var w in p[x])m.push(parseInt(x)),m.push(parseInt(w));m.length>1&&(e.iblines=new Uint16Array(m.length),e.iblines.set(m))}}r.r(t),r.d(t,"createWireframe",function(){return s});var a=r("./src/wgs/scene/VertexEnumerator.js"),l=r("./src/wgs/scene/LmvVector3.js"),c=r("./src/wgs/scene/LmvBox3.js")},"./src/wgs/scene/FragmentList.js":function(e,t,r){"use strict";function n(e){this.is2d=e.is2d(),this.modelId=e.getModelId(),this.fragments=e.getData().fragments,this.geoms=e.getGeometryList(),this.isFixedSize=this.fragments.length>0,this.isFixedSize?(this.boxes=this.fragments.boxes,this.transforms=this.fragments.transforms,this.useThreeMesh=!l.memoryOptimizedLoading):(this.boxes=null,this.transforms=null,this.useThreeMesh=!0);var t=this.fragments.length;if(this.vizflags=new Uint16Array(t),this.useThreeMesh&&(this.vizmeshes=new Array(t)),e.isOTG()){var r=e.getData().metadata.stats,n=r.num_materials,i=r.num_geoms;this.materialids=Object(h.allocateUintArray)(t,n),this.geomids=Object(h.allocateUintArray)(t,i)}else this.geomids=new Int32Array(t),this.materialids=new Int32Array(t);this.materialmap={},this.materialIdMap={},this.nextMaterialId=1,this.db2ThemingColor=[],this.originalColors=[],this.themingOrGhostingNeedsUpdate=[],this.dbIdIsHidden=[],this.dbIdIsGhosted=[],this.animxforms=null;for(var o=0;t>o;o++)this.vizflags[o]=1;!e.isOTG()&&this.fragments.visibilityFlags&&this.vizflags.set(this.fragments.visibilityFlags),this.allVisible=!0,this.allVisibleDirty=!0,this.nextAvailableFragID=t,this.linesHidden=!1,this.pointsHidden=!1,this.matrix=null}function i(e){var t=e.r;return e.r=e.b,e.b=t,e}function o(e,t){var r=e.originalColors[t];if(e.themingOrGhostingNeedsUpdate[t]){var n=e.getGeometry(t),i=n?n.attributes:null,o=i?i.color4b:null,s=i?i.dbId4b:null,a=i?i.layerVp4b:null,l=i?i.flags4b:null;if(o&&s&&n.vb&&a&&l){for(var c=new Uint32Array(n.vb.buffer),u=n.vbstride,d=c.length/n.vbstride,h=!1,f=0,p=o.itemOffset,m=s.itemOffset,g=a.itemOffset,v=l.itemOffset,_=0;d>_;_++){var b=c[_*u+m],x=r?r[_]:c[_*u+p],w=c[_*u+g];b=b<<8>>8;var E=-1==b&&(w&parseInt("FFFF",16))==f,S=e.db2ThemingColor[b],A=e.dbIdIsHidden[b];if(S||A){if(!r){r=new Uint32Array(d);for(var M=0;d>M;M++)r[M]=c[M*u+p];e.originalColors[t]=r}x=A?0:y(x,S),h=!0}else r&&(x=r[_]);c[_*u+p]=x;var T=e.dbIdIsGhosted[b]&&!E,C=c[_*u+v];T?C|=255<<24:C&=16777215,c[_*u+v]=C}h||(e.originalColors[t]=null),n.vbNeedsUpdate=!0,e.themingOrGhostingNeedsUpdate[t]=!1}}}function s(e,t){if(e.is2d){var r=e.fragments.dbId2fragId[t];if(Array.isArray(r))for(var n=0;n<r.length;n++)e.themingOrGhostingNeedsUpdate[r[n]]=!0;else"number"==typeof r&&(e.themingOrGhostingNeedsUpdate[r]=!0)}}function a(e,t){this.frags=e,this.fragId=t,this.scale=null,this.quaternion=null,this.position=null}r.r(t),r.d(t,"FragmentList",function(){return n}),r.d(t,"FragmentPointer",function(){return a});var l=r("./src/wgs/globals.js"),c=r("./thirdparty/three.js/three.js"),u=(r.n(c),r("./src/wgs/scene/MeshFlags.js")),d=r("./src/logger/Logger.js"),h=r("./src/wgs/scene/IntArray.js"),f=(r("./src/application/Viewer3D.js"),new c.Matrix4),p=new c.Box3,m=new c.Quaternion,g=new c.Vector3,v=new c.Vector3;n.prototype.getNextAvailableFragmentId=function(){return this.nextAvailableFragID++},n.prototype.fragmentsHaveBeenAdded=function(){return this.vizflags.length>this.fragments.length},n.prototype.getSvfMaterialId=function(e){var t=this.getMaterial(e);return t?t.svfMatId:void 0},n.prototype.setMesh=function(e,t,r,n){if(this.vizmeshes){var i=this.vizmeshes[e];i&&i.parent&&i.parent.remove(i)}if(this.vizflags.length<=e){this.isFixedSize&&(d.logger.warn("Attempting to resize a fragments list that was initialized with fixed data. This will have a performance impact."),this.isFixedSize=!1);var o=Math.ceil(1.5*Math.max(this.vizflags.length,e))||1;this.useThreeMesh&&o<this.vizmeshes.length&&(o=this.vizmeshes.length);var s=new Uint16Array(o);if(s.set(this.vizflags),this.vizflags=s,this.transforms){var a=new Float32Array(12*o);a.set(this.transforms),this.transforms=a}if(this.boxes){var l=new Float32Array(6*o);l.set(this.boxes),this.boxes=l}if(this.geomids){var h=new Int32Array(o);h.set(this.geomids),this.geomids=h}if(this.materialids){var f=new Int32Array(o);f.set(this.materialids),this.materialids=f}}if(this.useThreeMesh){var m;n&&t instanceof c.Mesh?(m=t,t.matrix&&m.matrixWorld.copy(t.matrix),m.dbId=m.dbId||0):(m=new c.Mesh(t.geometry,t.material),t.matrix&&(m.matrix&&m.matrix.copy(t.matrix),m.matrixWorld.copy(t.matrix)),m.is2d=t.is2d,m.isLine=t.isLine,m.isWideLine=t.isWideLine,m.isPoint=t.isPoint,m.dbId=0|this.fragments.fragId2dbId[e]),m.matrixAutoUpdate=!1,m.frustumCulled=!1,m.fragId=e,m.modelId=this.modelId,this.vizmeshes[e]=m}else{var g=void 0;t.geometry.hash?(void 0===t.geomId,g=t.geomId):g=t.geometry.svfid,this.geomids[e]=g,this.setMaterial(e,t.material)}var v=0;if(t.isLine?v=u.MeshFlags.MESH_ISLINE:t.isWideLine?v=u.MeshFlags.MESH_ISWIDELINE:t.isPoint&&(v=u.MeshFlags.MESH_ISPOINT),this.isFixedSize?this.vizflags[e]|=v:this.vizflags[e]|=u.MeshFlags.MESH_VISIBLE|v,r&&this.transforms&&this.boxes){var y=t.matrix,_=12*e,b=y.elements,x=this.transforms;if(x[_]=b[0],x[_+1]=b[1],x[_+2]=b[2],x[_+3]=b[4],x[_+4]=b[5],x[_+5]=b[6],x[_+6]=b[8],x[_+7]=b[9],x[_+8]=b[10],x[_+9]=b[12],x[_+10]=b[13],x[_+11]=b[14],!this.fragments.boxesLoaded){t.bbox?p.copy(t.bbox):(t.geometry&&t.geometry.boundingBox?p.copy(t.geometry.boundingBox):this.geoms.getModelBox(this.geomids[e],p),p.empty()||p.applyMatrix4(y));var w=6*e,E=this.boxes;E[w]=p.min.x,E[w+1]=p.min.y,E[w+2]=p.min.z,E[w+3]=p.max.x,E[w+4]=p.max.y,E[w+5]=p.max.z}}},n.prototype.isFlagSet=function(e,t){return!!(this.vizflags[e]&t)},n.prototype.setFlagFragment=function(e,t,r){var n=this.vizflags[e];return!!(n&t)==r?!1:(r?this.vizflags[e]=n|t:this.vizflags[e]=n&~t,!0)},n.prototype.setFlagGlobal=function(e,t){var r=this.vizflags,n=0,i=r.length;if(t)for(;i>n;n++)r[n]=r[n]|e;else for(var o=~e;i>n;n++)r[n]=r[n]&o},n.prototype.hideLines=function(e){this.linesHidden=e},n.prototype.hidePoints=function(e){this.pointsHidden=e},n.prototype.hideFragments=function(e,t){var r=u.MeshFlags.MESH_HIDE,n=this.vizflags,i=0,o=n.length;if(t)for(;o>i;i++)n[i]&e&&(n[i]=n[i]|r);else for(var s=~r;o>i;i++)n[i]&e&&(n[i]=n[i]&s);this.allVisibleDirty=!0},n.prototype.isFragVisible=function(e){var t=this.linesHidden&&(this.isLine(e)||this.isWideLine(e)),r=this.pointsHidden&&this.isPoint(e);return 1==(7&this.vizflags[e])&&!t&&!r},n.prototype.isFragOff=function(e){return!!(this.vizflags[e]&u.MeshFlags.MESH_HIDE)},n.prototype.isNotLoaded=function(e){return this.vizflags[e]&u.MeshFlags.MESH_NOTLOADED},n.prototype.isLine=function(e){return!!(this.vizflags[e]&u.MeshFlags.MESH_ISLINE)},n.prototype.isWideLine=function(e){return this.isFlagSet(e,u.MeshFlags.MESH_ISWIDELINE)},n.prototype.isPoint=function(e){return this.isFlagSet(e,u.MeshFlags.MESH_ISPOINT)},n.prototype.areAllVisible=function(){if(this.allVisibleDirty){for(var e=this.vizflags,t=!0,r=0,n=e.length;n>r;r++)if(0===(1&e[r])){t=!1;break}this.allVisible=t,this.allVisibleDirty=!1}return this.allVisible};var y=function(){var e=null,t=null,r=parseInt("00FFFFFF",16),n=parseInt("FF000000",16);return function(o,s){return e||(e=new c.Color,t=new c.Color),e.set(o&r),i(e),s&&(t.setRGB(s.x,s.y,s.z),e.lerp(t,s.w)),i(e).getHex()|o&n}}();n.prototype.getVizmesh=function(){var e=new c.Mesh(void 0,void 0,!0);return e.isTemp=!0,e.dbId=0,e.modelId=0,e.fragId=-1,e.hide=!1,e.isLine=!1,e.isWideLine=!1,e.isPoint=!1,function(t,r,n){if(this.is2d&&o(this,t),this.useThreeMesh){var i=this.vizmeshes[t];return i&&(i.themingColor=this.db2ThemingColor[i.dbId]),i}return e.geometry=this.getGeometry(t),e.material=this.getMaterial(t),e.dbId=this.getDbIds(t),e.modelId=this.modelId,e.fragId=t,e.visible=!0,e.isLine=this.isLine(t),e.isWideLine=this.isWideLine(t),e.isPoint=this.isPoint(t),e.hide=this.isFragOff(t),e.themingColor=this.db2ThemingColor[e.dbId],this.getWorldMatrix(t,e.matrixWorld),e}}(),n.prototype.getMaterialId=function(e){var t=this.getMaterial(e);return t?t.id:0},n.prototype.getMaterial=function(e){return this.useThreeMesh?this.vizmeshes[e].material:this.materialIdMap[this.materialids[e]]},n.prototype.getGeometry=function(e){var t;return this.useThreeMesh?(t=this.vizmeshes[e])?t.geometry:null:this.geoms.getGeometry(this.geomids[e])},n.prototype.getGeometryId=function(e){return this.useThreeMesh?e:this.geomids[e]},n.prototype.setMaterial=function(e,t){if(this.useThreeMesh)this.vizmeshes[e].material=t;else{var r=this.materialmap[t.id];r||(r=this.nextMaterialId++,this.materialids=Object(h.reallocateUintArrayMaybe)(this.materialids,r),this.materialIdMap[r]=t,this.materialmap[t.id]=r),this.materialids[e]=r}},n.prototype.getCount=function(){return this.vizmeshes?this.vizmeshes.length:this.vizflags.length},n.prototype.getDbIds=function(e){return this.fragments.fragId2dbId[e]},n.prototype.dispose=function(e){if(this.useThreeMesh)for(var t={type:"dispose"},r={type:"removed"},n=0;n<this.vizmeshes.length;n++){var i=this.vizmeshes[n];i&&(i.dispatchEvent(r),i.geometry.dispatchEvent(t))}else this.geoms.dispose(e)},n.prototype.setVisibility=function(e,t){this.setFlagFragment(e,u.MeshFlags.MESH_VISIBLE,t),this.allVisibleDirty=!0},n.prototype.setFragOff=function(e,t){this.setFlagFragment(e,u.MeshFlags.MESH_HIDE,t),this.allVisibleDirty=!0},n.prototype.setAllVisibility=function(e){if(this.is2d){var t=this.fragments;if(t&&t.dbId2fragId)for(var r in t.dbId2fragId)this.setObject2DGhosted(parseInt(r),!e)}else this.setFlagGlobal(u.MeshFlags.MESH_VISIBLE,e),this.allVisible=e,this.allVisibleDirty=!1},n.prototype.updateAnimTransform=function(e,t,r,n){var i,o=this.animxforms;if(!o){var s=this.getCount();o=this.animxforms=new Float32Array(10*s);for(var a=0;s>a;a++)i=10*a,o[i]=1,o[i+1]=1,o[i+2]=1,o[i+3]=0,o[i+4]=0,o[i+5]=0,o[i+6]=1,o[i+7]=0,o[i+8]=0,o[i+9]=0}i=10*e;var l=!1;t&&(o[i]=t.x,o[i+1]=t.y,o[i+2]=t.z,l=!0),r&&(o[i+3]=r.x,o[i+4]=r.y,o[i+5]=r.z,o[i+6]=r.w,l=!0),n&&(o[i+7]=n.x,o[i+8]=n.y,o[i+9]=n.z,l=!0),this.setFlagFragment(e,u.MeshFlags.MESH_MOVED,l),l||(o[i]=1,o[i+1]=1,o[i+2]=1,o[i+3]=0,o[i+4]=0,o[i+5]=0,o[i+6]=1,o[i+7]=0,o[i+8]=0,o[i+9]=0)},n.prototype.getAnimTransform=function(e,t,r,n){if(!this.animxforms)return!1;if(!this.isFlagSet(e,u.MeshFlags.MESH_MOVED))return!1;var i=10*e,o=this.animxforms;return t&&(t.x=o[i],t.y=o[i+1],t.z=o[i+2]),r&&(r.x=o[i+3],r.y=o[i+4],r.z=o[i+5],r.w=o[i+6]),n&&(n.x=o[i+7],n.y=o[i+8],n.z=o[i+9]),!0},n.prototype.getOriginalWorldMatrix=function(e,t){var r=12*e,n=t.elements,i=this.transforms;if(i)n[0]=i[r],n[1]=i[r+1],n[2]=i[r+2],n[3]=0,n[4]=i[r+3],n[5]=i[r+4],n[6]=i[r+5],n[7]=0,n[8]=i[r+6],n[9]=i[r+7],n[10]=i[r+8],n[11]=0,n[12]=i[r+9],n[13]=i[r+10],n[14]=i[r+11],n[15]=1;else if(this.useThreeMesh){var o=this.getVizmesh(e);o?t.copy(o.matrixWorld):t.identity()}else t.identity()},n.prototype.getWorldMatrix=function(){var e=new c.Matrix4;return function(t,r){this.getOriginalWorldMatrix(t,r),this.isFlagSet(t,u.MeshFlags.MESH_MOVED)&&(this.getAnimTransform(t,v,m,g),e.compose(g,m,v),r.multiplyMatrices(e,r)),this.matrix&&r.multiplyMatrices(this.matrix,r)}}(),n.prototype.getWorldBounds=function(e,t){if(this.boxes&&!this.isFlagSet(e,u.MeshFlags.MESH_MOVED)){var r=this.boxes,n=6*e;return t.min.x=r[n],t.min.y=r[n+1],t.min.z=r[n+2],t.max.x=r[n+3],t.max.y=r[n+4],t.max.z=r[n+5],void(this.matrix&&t.applyMatrix4(this.matrix))}if(this.useThreeMesh){var i=this.getVizmesh(e);i&&i.geometry&&t.copy(i.geometry.boundingBox)}else this.geoms.getModelBox(this.geomids[e],t);t.empty()||(this.getWorldMatrix(e,f),t.applyMatrix4(f))},n.prototype.getOriginalWorldBounds=function(e,t){if(this.boxes){var r=this.boxes,n=6*e;return t[0]=r[n],t[1]=r[n+1],t[2]=r[n+2],t[3]=r[n+3],t[4]=r[n+4],void(t[5]=r[n+5])}if(this.useThreeMesh){var i=this.getVizmesh(e);i&&i.geometry&&p.copy(i.geometry.boundingBox)}else this.geoms.getModelBox(this.geomids[e],p);p.empty()||(this.getOriginalWorldMatrix(e,f),p.applyMatrix4(f)),t[0]=p.min.x,t[1]=p.min.y,t[2]=p.min.z,t[3]=p.max.x,t[4]=p.max.y,t[5]=p.max.z},n.prototype.setThemingColor=function(e,t){var r=this.db2ThemingColor[e],n=r===t||r&&t&&r.equals(t);n||(this.db2ThemingColor[e]=t||void 0,s(this,e))},n.prototype.clearThemingColors=function(){if(this.is2d)for(var e in this.fragments.dbId2fragId)s(this,parseInt(e));this.db2ThemingColor.length=0},n.prototype.setObject2DGhosted=function(e,t){var r=this.dbIdIsGhosted[e];!!t!=!!r&&(this.dbIdIsGhosted[e]=t,s(this,e))},n.prototype.setObject2DVisible=function(e,t){var r=!this.dbIdIsHidden[e];t!==r&&(this.dbIdIsHidden[e]=!t,s(this,e))},a.prototype.getWorldMatrix=function(e){this.frags.getWorldMatrix(this.fragId,e)},a.prototype.getOriginalWorldMatrix=function(e){this.frags.getOriginalWorldMatrix(this.fragId,e)},a.prototype.getWorldBounds=function(e){return this.frags.getWorldBounds(this.fragId,e)},a.prototype.getAnimTransform=function(){return this.scale||(this.scale=new c.Vector3(1,1,1),this.quaternion=new c.Quaternion(0,0,0,1),this.position=new c.Vector3(0,0,0)),this.frags.getAnimTransform(this.fragId,this.scale,this.quaternion,this.position)},a.prototype.updateAnimTransform=function(){this.scale||(this.scale=new c.Vector3(1,1,1),this.quaternion=new c.Quaternion(0,0,0,1),this.position=new c.Vector3(0,0,0)),this.frags.updateAnimTransform(this.fragId,this.scale,this.quaternion,this.position)},a.prototype.getMaterial=function(){return this.frags.getMaterial(this.fragId)},a.prototype.setMaterial=function(e){return this.frags.setMaterial(this.fragId,e)}},"./src/wgs/scene/FrustumIntersector.js":function(e,t,r){"use strict";function n(){this.frustum=new s.Frustum,this.viewProj=new s.Matrix4,this.viewDir=[0,0,1],this.ar=1,this.viewport=new s.Vector3(1,1,1),this.areaConv=1,this.areaCullThreshold=1,this.eye=new s.Vector3,this.perspective=!1}function i(e,t,r){return r.x=1&t?e.max.x:e.min.x,r.y=2&t?e.max.y:e.min.y,r.z=4&t?e.max.z:e.min.z,r}function o(e,t){var r=e.x*t.x+e.y*t.y+e.z*t.z+t.w;return r>1e-6}r.r(t),r.d(t,"FrustumIntersector",function(){return n}),r.d(t,"OUTSIDE",function(){return l}),r.d(t,"INTERSECTS",function(){return c}),r.d(t,"CONTAINS",function(){return u}),r.d(t,"CONTAINMENT_UNKNOWN",function(){return d});var s=r("./thirdparty/three.js/three.js"),a=(r.n(s),[[1,5,4,7,3,2,6],[0,3,2,1,5,4,6],[0,3,2,6,5,4,6],[0,4,7,3,2,1,6],[0,3,2,1,-1,-1,4],[0,3,2,6,5,1,6],[0,4,7,6,2,1,6],[0,3,7,6,2,1,6],[0,3,7,6,5,1,6],[0,1,5,4,7,3,6],[0,1,5,4,-1,-1,4],[0,1,2,6,5,4,6],[0,4,7,3,-1,-1,4],[-1,-1,-1,-1,-1,-1,0],[1,2,6,5,-1,-1,4],[0,4,7,6,2,3,6],[2,3,7,6,-1,-1,4],[1,2,3,7,6,5,6],[0,1,5,6,7,3,6],[0,1,5,6,7,4,6],[0,1,2,6,7,4,6],[0,4,5,6,7,3,6],[4,5,6,7,-1,-1,4],[1,2,6,7,4,5,6],[0,4,5,6,2,3,6],[2,3,7,4,5,6,6],[1,2,3,7,4,5,6]]),l=0,c=1,u=2,d=-1;n.OUTSIDE=l,n.INTERSECTS=c,n.CONTAINS=u,n.CONTAINMENT_UNKNOWN=d,n.prototype.reset=function(e,t){this.viewProj.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this.perspective=e.isPerspective,this.frustum.setFromMatrix(this.viewProj);var r=e.matrixWorldInverse.elements;this.ar=e.aspect,this.viewDir[0]=-r[2],this.viewDir[1]=-r[6],this.viewDir[2]=-r[10],this.eye.x=e.position.x,this.eye.y=e.position.y,this.eye.z=e.position.z,this.areaConv=e.clientWidth*e.clientHeight/4,this.cutPlanes=t},n.prototype.projectedArea=function(){function e(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements,s=o[3]*r+o[7]*n+o[11]*i+o[15];0>s&&(s=-s);var a=1/s;e.x=(o[0]*r+o[4]*n+o[8]*i+o[12])*a,e.y=(o[1]*r+o[5]*n+o[9]*i+o[13])*a}var t=[new s.Vector3,new s.Vector3,new s.Vector3,new s.Vector3,new s.Vector3,new s.Vector3,new s.Vector3,new s.Vector3],r=new s.Box2;return function(n){if(n.empty())return 0;var i=this.viewProj;t[0].set(n.min.x,n.min.y,n.min.z),t[1].set(n.min.x,n.min.y,n.max.z),t[2].set(n.min.x,n.max.y,n.min.z),t[3].set(n.min.x,n.max.y,n.max.z),t[4].set(n.max.x,n.min.y,n.min.z),t[5].set(n.max.x,n.min.y,n.max.z),t[6].set(n.max.x,n.max.y,n.min.z),t[7].set(n.max.x,n.max.y,n.max.z);for(var o=0;8>o;o++)e(t[o],i);return r.makeEmpty(),r.setFromPoints(t),r.min.x<-1&&(r.min.x=-1),r.min.x>1&&(r.min.x=1),r.min.y<-1&&(r.min.y=-1),r.min.y>1&&(r.min.y=1),r.max.x>1&&(r.max.x=1),r.max.x<-1&&(r.max.x=-1),r.max.y>1&&(r.max.y=1),r.max.y<-1&&(r.max.y=-1),(r.max.x-r.min.x)*(r.max.y-r.min.y)}}(),n.prototype.projectedBoxArea=function(){function e(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements,s=o[3]*r+o[7]*n+o[11]*i+o[15];0>s&&(s=-s);var a=1/s;e.x=(o[0]*r+o[4]*n+o[8]*i+o[12])*a,e.y=(o[1]*r+o[5]*n+o[9]*i+o[13])*a}function t(e,t){var n,o,s,a,l,c,u,d,h=e,f=i,p=function(e){switch(u){case 0:return e.x>=-1;case 1:return e.x<=1;case 2:return e.y>=-1;case 3:return e.y<=1}},m=function(e){f[d].x=e.x,f[d++].y=e.y},g=function(){var e,t;switch(u){case 0:e=-1,t=o.y+(s.y-o.y)*(e-o.x)/(s.x-o.x);break;case 1:e=1,t=o.y+(s.y-o.y)*(e-o.x)/(s.x-o.x);break;case 2:t=-1,e=o.x+(s.x-o.x)*(t-o.y)/(s.y-o.y);break;case 3:t=1,e=o.x+(s.x-o.x)*(t-o.y)/(s.y-o.y)}f[d].x=e,f[d++].y=t};for(u=0;4>u&&t>2;u++){for(d=0,o=h[t-1],a=p(o),c=0;t>c;c++)s=h[c],l=p(s),a?l?m(s):g():l&&(g(),m(s)),o=s,a=l;t=d,n=h,h=f,f=n}return r=t,h}for(var r,n=[],i=[],o=0;10>o;o++)n.push(new s.Vector3),i.push(new s.Vector3);return function(i,o){if(i.empty())return 0;var s,l=this.viewProj;if(this.perspective?(s=this.eye.x>=i.min.x?this.eye.x>i.max.x?2:1:0,this.eye.y>=i.min.y&&(s+=this.eye.y>i.max.y?6:3),this.eye.z>=i.min.z&&(s+=this.eye.z>i.max.z?18:9)):(s=this.viewDir[0]<=0?this.viewDir[0]<0?2:1:0,this.viewDir[1]<=0&&(s+=this.viewDir[1]<0?6:3),this.viewDir[2]<=0&&(s+=this.viewDir[2]<0?18:9)),13===s)return 4;var c,u=a[s][6];for(c=0;u>c;c++){var d=a[s][c];n[c].set(2>(d+1)%4?i.min.x:i.max.x,2>d%4?i.min.y:i.max.y,4>d?i.min.z:i.max.z),e(n[c],l)}var h=0;if(o)for(h=(n[u-1].x-n[0].x)*(n[u-1].y+n[0].y),c=0;u-1>c;c++)h+=(n[c].x-n[c+1].x)*(n[c].y+n[c+1].y);else{var f=t(n,u);if(r>=3)for(h=(f[r-1].x-f[0].x)*(f[r-1].y+f[0].y),c=0;r-1>c;c++)h+=(f[c].x-f[c+1].x)*(f[c].y+f[c+1].y)}return Math.abs(.5*h)}}(),n.prototype.estimateDepth=function(e){var t=this.viewProj.elements,r=(e.min.x+e.max.x)/2,n=(e.min.y+e.max.y)/2,i=(e.min.z+e.max.z)/2,o=1/(t[3]*r+t[7]*n+t[11]*i+t[15]);return(t[2]*r+t[6]*n+t[10]*i+t[14])*o},n.prototype.intersectsBox=function(){var e=new s.Vector3,t=new s.Vector3;return function(r){for(var i=this.frustum.planes,o=0,s=0;6>s;s++){var a=i[s];e.x=a.normal.x>0?r.min.x:r.max.x,t.x=a.normal.x>0?r.max.x:r.min.x,e.y=a.normal.y>0?r.min.y:r.max.y,t.y=a.normal.y>0?r.max.y:r.min.y,e.z=a.normal.z>0?r.min.z:r.max.z,t.z=a.normal.z>0?r.max.z:r.min.z;var l=a.distanceToPoint(e),c=a.distanceToPoint(t);if(0>l&&0>c)return n.OUTSIDE;l>0&&c>0&&o++}return 6==o?n.CONTAINS:n.INTERSECTS}}();var h=function(){var e;return function(t,r){e||(e=new s.Vector3);for(var n=0;8>n;n++){var a=i(t,n,e);if(!o(a,r))return!1}return!0}}();n.prototype.boxOutsideCutPlanes=function(e){if(!this.cutPlanes)return!1;for(var t=0;t<this.cutPlanes.length;t++){var r=this.cutPlanes[t];if(h(e,r))return!0}return!1}},"./src/wgs/scene/GeometryList.js":function(e,t,r){"use strict";function n(e,t,r,n){this.geoms=[null],this.numGeomsInMemory=0,this.geomMemory=0,this.gpuMeshMemory=0,this.gpuNumMeshes=0,this.geomPolyCount=0,this.instancePolyCount=0,this.is2d=t,this.geomBoxes=n?null:new Float32Array(6*Math.max(1,e+1)),this.numObjects=e,this.disableStreaming=!!r}r.r(t),r.d(t,"GeometryList",function(){return n});var i=r("./src/wgs/globals.js"),o=r("./src/compat.js"),s=r("./thirdparty/three.js/three.js");r.n(s);n.prototype.getGeometry=function(e){return this.geoms[e]},n.prototype.chooseMemoryType=function(e,t,r,n){var o=i.GPU_MEMORY_LIMIT,s=2*o,a=i.GPU_OBJECT_LIMIT;if(0===o)return e.streamingDraw=!0,void(e.streamingIndex=!0);if(this.disableStreaming||o>n&&a>r)e.streamingDraw=!1,e.streamingIndex=!1;else if(n>=s)e.streamingDraw=!0,e.streamingIndex=!0;else{var l;l=this.is2d?100001:e.byteSize*(t||1),1e5>l&&(e.streamingDraw=!0,e.streamingIndex=!0)}},n.prototype.addGeometry=function(e,t,r){this.chooseMemoryType(e,t,this.gpuNumMeshes,this.gpuMeshMemory);var n=e.byteSize+i.GEOMETRY_OVERHEAD;if(e.streamingDraw||(Object(o.isMobileDevice)()&&(n+=e.byteSize),this.gpuMeshMemory+=e.byteSize,this.gpuNumMeshes+=1),this.numGeomsInMemory++,(void 0===r||0>=r)&&(r=this.geoms.length),this.geoms[r]=e,this.geomBoxes){var a=this.geomBoxes.length/6|0;if(a<this.geoms.length){var l=3*this.geoms.length/2|0,c=new Float32Array(6*l);c.set(this.geomBoxes);var u=new s.Box3;for(u.makeEmpty();l>a;)c[6*a]=u.min.x,c[6*a+1]=u.min.y,c[6*a+2]=u.min.z,c[6*a+3]=u.max.x,c[6*a+4]=u.max.y,c[6*a++ +5]=u.max.z;this.geomBoxes=c}var d=e.boundingBox;d?(this.geomBoxes[6*r]=d.min.x,this.geomBoxes[6*r+1]=d.min.y,this.geomBoxes[6*r+2]=d.min.z,this.geomBoxes[6*r+3]=d.max.x,this.geomBoxes[6*r+4]=d.max.y,this.geomBoxes[6*r+5]=d.max.z):(!e.hash,this.geomBoxes[6*r]=-.5,this.geomBoxes[6*r+1]=-.5,this.geomBoxes[6*r+2]=-.5,this.geomBoxes[6*r+3]=.5,this.geomBoxes[6*r+4]=.5,this.geomBoxes[6*r+5]=.5)}i.memoryOptimizedLoading&&!this.is2d&&(e.boundingBox=null,e.boundingSphere=null),this.geomMemory+=n;var h,f=e.attributes.index&&e.attributes.index.array||e.ib,p=e.isLines?2:3;return h=f?f.length/p:e.vb?e.vb.length/(p*e.stride):e.attributes.position.length/(3*p),this.geomPolyCount+=h,this.instancePolyCount+=h*(t||1),e.polyCount=h,e.instanceCount=t||1,e.svfid=r,r},n.prototype.removeGeometry=function(e,t){var r=this.getGeometry(e);if(!r)return 0;var n=r.byteSize+i.GEOMETRY_OVERHEAD;return t&&t.deallocateGeometry(r),r.streamingDraw||(Object(o.isMobileDevice)()&&(n+=r.byteSize),this.gpuMeshMemory-=r.byteSize,this.gpuNumMeshes-=1),this.geoms[e]=null,this.geomMemory-=n,this.numGeomsInMemory--,this.geomPolyCount-=r.polyCount,this.instancePolyCount-=r.instanceCount*r.polyCount,n},n.prototype.getModelBox=function(e,t){if(!this.geomBoxes)return void(e>=1&&e<=this.numObjects?(t.min.x=-.5,t.min.y=-.5,t.min.z=-.5,t.max.x=.5,t.max.y=.5,t.max.z=.5):t.makeEmpty());if(0===e||this.geomBoxes.length/6<=e)return void t.makeEmpty();var r=6*e,n=this.geomBoxes;t.min.x=n[r],t.min.y=n[r+1],t.min.z=n[r+2],t.max.x=n[r+3],t.max.y=n[r+4],t.max.z=n[r+5]},n.prototype.dispose=function(e){if(e)for(var t=0,r=this.geoms.length;r>t;t++)this.geoms[t]&&e.deallocateGeometry(this.geoms[t])},n.prototype.printStats=function(){s.log("Total geometry size: "+this.geomMemory/1048576+" MB"),s.log("Number of meshes: "+(this.geoms.length-1)),s.log("Num Meshes on GPU: "+this.gpuNumMeshes),s.log("Net GPU geom memory used: "+this.gpuMeshMemory)}},"./src/wgs/scene/InstanceTree.js":function(e,t,r){"use strict";function n(e,t,r){this.nodeAccess=e,this.maxDepth=r,this.objectCount=t,this.numHidden=0,this.numOff=0,this.fragList=null}r.r(t),r.d(t,"InstanceTree",function(){return n});var i=r("./src/wgs/scene/SelectionMode.js"),o=r("./src/logger/Logger.js"),s=2,a=3,l=4,c=5,u=7,d=536870912,h=1073741824,f=2147483648,p=4096,m=8192,g=16384;n.prototype.setFlagNode=function(e,t,r){var n=this.nodeAccess.getNodeFlags(e);return!!(n&t)==r?!1:(r?this.nodeAccess.setNodeFlags(e,n|t):this.nodeAccess.setNodeFlags(e,n&~t),!0)},n.prototype.setFlagGlobal=function(e,t){var r=this.nodeAccess,n=0,i=r.numNodes;if(t)for(;i>n;n++)r.setNodeFlags(n,r.getNodeFlags(n)|e);else for(var o=~e;i>n;n++)r.setNodeFlags(n,r.getNodeFlags(n)&o)},n.prototype.setNodeOff=function(e,t){var r=this.setFlagNode(e,h,t);return r&&(t?this.numOff++:this.numOff--),r},n.prototype.isNodeOff=function(e){return!!(this.nodeAccess.getNodeFlags(e)&h)},n.prototype.setNodeHidden=function(e,t){var r=this.setFlagNode(e,f,t);return r&&(t?this.numHidden++:this.numHidden--),r},n.prototype.isNodeHidden=function(e){return!!(this.nodeAccess.getNodeFlags(e)&f)},n.prototype.lockNodeSelection=function(e,t){return this.setFlagNode(e,g,t)},n.prototype.isNodeSelectionLocked=function(e){return!!(this.nodeAccess.getNodeFlags(e)&g)},n.prototype.lockNodeVisible=function(e,t){return this.setFlagNode(e,p,t)},n.prototype.isNodeVisibleLocked=function(e){return!!(this.nodeAccess.getNodeFlags(e)&p)},n.prototype.isNodeExplodeLocked=function(e){return!!(this.nodeAccess.getNodeFlags(e)&m)},n.prototype.lockNodeExplode=function(e,t){return this.setFlagNode(e,m,t)},n.prototype.getNodeType=function(e){return this.nodeAccess.getNodeFlags(e)&u},n.prototype.isNodeSelectable=function(e){return!(this.nodeAccess.getNodeFlags(e)&d)},n.prototype.getNodeParentId=function(e){return this.nodeAccess.getParentId(e)},n.prototype.getRootId=function(){return this.nodeAccess.rootId},n.prototype.getNodeName=function(e,t){return this.nodeAccess.name(e,t)},n.prototype.getChildCount=function(e){return this.nodeAccess.getNumChildren(e)};var v=new Array(6);n.prototype.getNodeBox=function(e,t){if(this.nodeAccess.nodeBoxes)return void this.nodeAccess.getNodeBox(e,t);var r=this.fragList;return r?(t[0]=t[1]=t[2]=1/0,t[3]=t[4]=t[5]=-(1/0),void this.enumNodeFragments(e,function(e){r.getOriginalWorldBounds(e,v),t[0]=Math.min(t[0],v[0]),t[1]=Math.min(t[1],v[1]),t[2]=Math.min(t[2],v[2]),t[3]=Math.max(t[3],v[3]),t[4]=Math.max(t[4],v[4]),t[5]=Math.max(t[5],v[5])},!0)):void o.logger.error("getNodeBox() requires fragBoxes or nodeBoxes")},n.prototype.getNodeIndex=function(e){return this.nodeAccess.getIndex(e)},n.prototype.enumNodeFragments=function(e,t,r){function n(e){var i=o.nodeAccess.enumNodeFragments(e,t);return i?i:r&&(i=o.enumNodeChildren(e,function(e){return n(e)}))?i:void 0}var i;"number"==typeof e?i=e:e&&(i=e.dbId);var o=this;return n(i)},n.prototype.enumNodeChildren=function(e,t,r){function n(e){var i=o.nodeAccess.enumNodeChildren(e,function(e){return t(e)?e:r?n(e):void 0});return i?i:void 0}var i;"number"==typeof e?i=e:e&&(i=e.dbId);var o=this;return r&&t(i)?i:n(i)},n.prototype.findNodeForSelection=function(e,t){if(t===i.SelectionMode.LEAF_OBJECT)return e;var r,n,o=e;if(t===i.SelectionMode.FIRST_OBJECT){var u=[];for(r=e;r;)u.push(r),r=this.getNodeParentId(r);for(var d=u.length-1;d>=0;d--)if(n=this.getNodeType(u[d]),n!==c&&n!==s&&n!==a){o=u[d];break}}else if(t===i.SelectionMode.LAST_OBJECT)for(r=e;r;){if(n=this.getNodeType(r),n===l){o=r;break}r=this.getNodeParentId(r)}return o},n.prototype.setFragmentList=function(e){this.fragList=e}},"./src/wgs/scene/InstanceTreeStorage.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e,t){this.nodes=[],this.nextNode=0,this.children=[],this.nextChild=0,this.dbIdToIndex={},this.names=[],this.s2i={},this.strings=new u,this.nameSuffixes=[],this.getIndex(0)}function a(e){var t=new Int32Array(e.length);return t.set(e),t}function l(e,t,r){this.nodes=e.nodes,this.children=e.children,this.dbIdToIndex=e.dbIdToIndex,this.names=e.names,this.nameSuffixes=e.nameSuffixes,this.strings=new u(e.strings),this.rootId=t,this.numNodes=this.nodes.length/d,this.visibleIds=null,this.nodeBoxes=r}r.r(t),r.d(t,"FlatStringStorage",function(){return u}),r.d(t,"InstanceTreeStorage",function(){return s}),r.d(t,"InstanceTreeAccess",function(){return l});var c=r("./src/file-loaders/lmvtk/common/StringUtils.js"),u=function(){function e(t){n(this,e),t?(this.buf=t.buf,this.idx=t.idx,this.next=t.next):(this.buf=new Uint8Array(256),this.next=0,this.idx=[0])}return o(e,[{key:"allocate",value:function(e){if(this.buf.length-this.next<e){var t=Math.max(3*this.buf.length/2,this.buf.length+e),r=new Uint8Array(t);r.set(this.buf),this.buf=r}}},{key:"add",value:function(e){if(null===e||"undefined"==typeof e)return 0;if(!e.length)return this.idx.push(this.next),this.idx.length-1;var t=Object(c.utf16to8)(e,null);return this.allocate(t),this.next+=Object(c.utf16to8)(e,this.buf,this.next),this.idx.push(this.next),this.idx.length-1}},{key:"get",value:function(e){if(e){var t=this.idx[e-1],r=this.idx[e];return t===r?"":Object(c.utf8BlobToStr)(this.buf,t,r-t)}}},{key:"flatten",value:function(){this.idx=a(this.idx)}}]),e}(),d=5,h=0,f=1,p=2,m=3,g=4;s.prototype.getIndex=function(e){var t=this.dbIdToIndex[e];if(t)return t;t=this.nextNode++,this.nodes.push(e);for(var r=1;d>r;r++)this.nodes.push(0);return this.dbIdToIndex[e]=t,t},s.prototype.setNode=function(e,t,r,n,i,o){var s=this.getIndex(e),a=s*d,l=i.length,c=o&&o.length;c&&(l+=o.length),this.nodes[a+f]=t,this.nodes[a+p]=this.nextChild,this.nodes[a+m]=c?-l:l,this.nodes[a+g]=n;var u;for(u=0;u<i.length;u++)this.children[this.nextChild++]=this.getIndex(i[u]);if(c)for(u=0;u<o.length;u++)this.children[this.nextChild++]=-o[u]-1;this.nextChild>this.children.length,this.processName(s,r)},s.prototype.processName=function(e,t){var r,n,i=-1,o=-1;if(t&&(o=t.lastIndexOf("]"),i=t.lastIndexOf("["),(-1===i||-1===o)&&(i=t.lastIndexOf(":"),o=t.length)),i>=0&&o>i){r=t.slice(0,i+1);var s=t.slice(i+1,o);n=parseInt(s,10),n&&n+""===s||(r=t,n=0)}else r=t,n=0;var a=this.s2i[r];void 0===a&&(a=this.strings.add(r),this.s2i[r]=a),this.names[e]=a,this.nameSuffixes[e]=n},s.prototype.flatten=function(e,t,r,n,i,o){this.nodes=a(this.nodes),this.children=a(this.children),this.names=a(this.names),this.nameSuffixes=a(this.nameSuffixes),this.strings.flatten(),this.s2i=null},l.prototype.getNumNodes=function(){return this.numNodes},l.prototype.getIndex=function(e){return this.dbIdToIndex[e]},l.prototype.name=function(e,t){var r,n=this.dbIdToIndex[e],i=this.strings.get(this.names[n]),o=this.nameSuffixes[n];if(o){var s=i.charAt(i.length-1);r="["===s?i+o+"]":i+o}else r=i;return t&&(this.childCounts||this.computeChildCounts(),this.childCounts[e]>0&&(r+=" ("+this.childCounts[e]+")")),r},l.prototype.getParentId=function(e){var t=this.dbIdToIndex[e];return this.nodes[t*d+f]},l.prototype.getNodeFlags=function(e){var t=this.dbIdToIndex[e];return this.nodes[t*d+g]},l.prototype.setNodeFlags=function(e,t){var r=this.dbIdToIndex[e];r&&(this.nodes[r*d+g]=t)},l.prototype.getNumChildren=function(e){var t=this.dbIdToIndex[e],r=this.nodes[t*d+m];if(r>=0)return r;var n=this.nodes[t*d+p];r=Math.abs(r);for(var i=0,o=0;r>o;o++){var s=this.children[n+o];if(0>s)break;i++}return i},l.prototype.getNumFragments=function(e){var t=this.dbIdToIndex[e],r=this.nodes[t*d+m];if(r>=0)return 0;var n=this.nodes[t*d+p];r=Math.abs(r);for(var i=0,o=r-1;o>=0;o--){var s=this.children[n+o];if(s>=0)break;i++}return i},l.prototype.getNodeBox=function(e,t){for(var r=this.getIndex(e),n=6*r,i=0;6>i;i++)t[i]=this.nodeBoxes[n+i]},l.prototype.getVisibleIds=function(){return this.visibleIds||(this.visibleIds=Object.keys(this.dbIdToIndex).map(function(e){return parseInt(e)})),this.visibleIds},l.prototype.enumNodeChildren=function(e,t){var r=this.dbIdToIndex[e],n=this.nodes[r*d+p],i=this.nodes[r*d+m];i=Math.abs(i);for(var o=0;i>o;o++){var s=this.children[n+o];if(0>s)break;var a=this.nodes[s*d+h];if(t(a,e,r))return e}},l.prototype.enumNodeFragments=function(e,t){var r=this.dbIdToIndex[e],n=this.nodes[r*d+p],i=this.nodes[r*d+m];if(0>i){i=-i;for(var o=0;i>o;o++){var s=this.children[n+o];if(!(s>0)&&t(-s-1,e,r))return e}}},l.prototype.computeBoxes=function(e){function t(e,t,r){var o=i.getIndex(e);n(e,o);for(var a=6*r,l=6*o,c=0;3>c;c++)s[a+c]>s[l+c]&&(s[a+c]=s[l+c]),s[a+c+3]<s[l+c+3]&&(s[a+c+3]=s[l+c+3])}function r(t,r,n){for(var i=6*t,o=6*n,a=0;3>a;a++)s[o+a]>e[i+a]&&(s[o+a]=e[i+a]),s[o+a+3]<e[i+a+3]&&(s[o+a+3]=e[i+a+3])}function n(e,n){var o=6*n;s[o]=s[o+1]=s[o+2]=1/0,s[o+3]=s[o+4]=s[o+5]=-(1/0),i.getNumChildren(e)&&i.enumNodeChildren(e,t,!0),i.getNumFragments(e)&&i.enumNodeFragments(e,r)}this.nodeBoxes||(this.nodeBoxes=new Float32Array(6*this.numNodes));var i=this,o=i.getIndex(i.rootId),s=i.nodeBoxes;n(i.rootId,o)},l.prototype.computeChildCounts=function(){function e(e,n,o){var s=r.getIndex(e),a=t(e,s);i[n]+=a}function t(t,n){var o=r.getNodeFlags(t),s=0;return 4===o?s=1:(r.getNumChildren(t)&&r.enumNodeChildren(t,e,!0),r.getNumFragments(t)&&(s=1)),
s+i[t]}this.childCounts||(this.childCounts=new Uint32Array(this.numNodes));var r=this,n=r.getIndex(r.rootId),i=r.childCounts;t(r.rootId,n)}},"./src/wgs/scene/IntArray.js":function(e,t,r){"use strict";function n(e,t){return 255>=t?new Uint8Array(e):65535>=t?new Uint16Array(e):new Uint32Array(e)}function i(e,t){if(255>=t)return e;if(65535>=t&&e instanceof Uint8Array){var r=new Uint16Array(e.length);return r.set(e),r}if(!e instanceof Uint32Array){var n=new Uint32Array(e.length);return n.set(e),n}return e}r.r(t),r.d(t,"allocateUintArray",function(){return n}),r.d(t,"reallocateUintArrayMaybe",function(){return i})},"./src/wgs/scene/LmvBox3.js":function(e,t,r){"use strict";r.r(t),r.d(t,"LmvBox3",function(){return i});var n=r("./src/wgs/scene/LmvVector3.js"),i=function(e,t){this.min=void 0!==e?e:new n.LmvVector3(1/0,1/0,1/0),this.max=void 0!==t?t:new n.LmvVector3(-(1/0),-(1/0),-(1/0))};i.prototype={constructor:i,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;r>t;t++)this.expandByPoint(e[t]);return this},setFromArray:function(e,t){return this.min.x=e[t],this.min.y=e[t+1],this.min.z=e[t+2],this.max.x=e[t+3],this.max.y=e[t+4],this.max.z=e[t+5],this},copyToArray:function(e,t){e[t]=this.min.x,e[t+1]=this.min.y,e[t+2]=this.min.z,e[t+3]=this.max.x,e[t+4]=this.max.y,e[t+5]=this.max.z},setFromCenterAndSize:function(){var e=new n.LmvVector3;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){var t=e||new n.LmvVector3;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new n.LmvVector3;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e,t){var r=t||new n.LmvVector3;return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},clampPoint:function(e,t){var r=t||new n.LmvVector3;return r.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new n.LmvVector3;return function(t){var r=e.copy(t).clamp(this.min,this.max);return r.sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new n.LmvVector3,new n.LmvVector3,new n.LmvVector3,new n.LmvVector3,new n.LmvVector3,new n.LmvVector3,new n.LmvVector3,new n.LmvVector3];return function(t){return e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(e),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}},"./src/wgs/scene/LmvMatrix4.js":function(e,t,r){"use strict";r.r(t),r.d(t,"LmvMatrix4",function(){return n});var n=function(e){e?this.elements=new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};n.prototype={constructor:n,set:function(e,t,r,n,i,o,s,a,l,c,u,d,h,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},makeRotationFromQuaternion:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z,o=e.w,s=r+r,a=n+n,l=i+i,c=r*s,u=r*a,d=r*l,h=n*a,f=n*l,p=i*l,m=o*s,g=o*a,v=o*l;return t[0]=1-(h+p),t[4]=u-v,t[8]=d+g,t[1]=u+v,t[5]=1-(c+p),t[9]=f-m,t[2]=d-g,t[6]=f+m,t[10]=1-(c+h),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},multiply:function(e){return this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],s=r[4],a=r[8],l=r[12],c=r[1],u=r[5],d=r[9],h=r[13],f=r[2],p=r[6],m=r[10],g=r[14],v=r[3],y=r[7],_=r[11],b=r[15],x=n[0],w=n[4],E=n[8],S=n[12],A=n[1],M=n[5],T=n[9],C=n[13],j=n[2],P=n[6],L=n[10],D=n[14],I=n[3],R=n[7],O=n[11],k=n[15];return i[0]=o*x+s*A+a*j+l*I,i[4]=o*w+s*M+a*P+l*R,i[8]=o*E+s*T+a*L+l*O,i[12]=o*S+s*C+a*D+l*k,i[1]=c*x+u*A+d*j+h*I,i[5]=c*w+u*M+d*P+h*R,i[9]=c*E+u*T+d*L+h*O,i[13]=c*S+u*C+d*D+h*k,i[2]=f*x+p*A+m*j+g*I,i[6]=f*w+p*M+m*P+g*R,i[10]=f*E+p*T+m*L+g*O,i[14]=f*S+p*C+m*D+g*k,i[3]=v*x+y*A+_*j+b*I,i[7]=v*w+y*M+_*P+b*R,i[11]=v*E+y*T+_*L+b*O,i[15]=v*S+y*C+_*D+b*k,this},multiplyToArray:function(e,t,r){var n=this.elements;return this.multiplyMatrices(e,t),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],s=e[5],a=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14],f=e[3],p=e[7],m=e[11],g=e[15];return f*(+i*a*u-n*l*u-i*s*d+r*l*d+n*s*h-r*a*h)+p*(+t*a*h-t*l*d+i*o*d-n*o*h+n*l*c-i*a*c)+m*(+t*l*u-t*s*h-i*o*u+r*o*h+i*s*c-r*l*c)+g*(-n*s*c-t*a*u+t*s*d+n*o*u-r*o*d+r*a*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],o=n[4],s=n[8],a=n[12],l=n[1],c=n[5],u=n[9],d=n[13],h=n[2],f=n[6],p=n[10],m=n[14],g=n[3],v=n[7],y=n[11],_=n[15];r[0]=u*m*v-d*p*v+d*f*y-c*m*y-u*f*_+c*p*_,r[4]=a*p*v-s*m*v-a*f*y+o*m*y+s*f*_-o*p*_,r[8]=s*d*v-a*u*v+a*c*y-o*d*y-s*c*_+o*u*_,r[12]=a*u*f-s*d*f-a*c*p+o*d*p+s*c*m-o*u*m,r[1]=d*p*g-u*m*g-d*h*y+l*m*y+u*h*_-l*p*_,r[5]=s*m*g-a*p*g+a*h*y-i*m*y-s*h*_+i*p*_,r[9]=a*u*g-s*d*g-a*l*y+i*d*y+s*l*_-i*u*_,r[13]=s*d*h-a*u*h+a*l*p-i*d*p-s*l*m+i*u*m,r[2]=c*m*g-d*f*g+d*h*v-l*m*v-c*h*_+l*f*_,r[6]=a*f*g-o*m*g-a*h*v+i*m*v+o*h*_-i*f*_,r[10]=o*d*g-a*c*g+a*l*v-i*d*v-o*l*_+i*c*_,r[14]=a*c*h-o*d*h-a*l*f+i*d*f+o*l*m-i*c*m,r[3]=u*f*g-c*p*g-u*h*v+l*p*v+c*h*y-l*f*y,r[7]=o*p*g-s*f*g+s*h*v-i*p*v-o*h*y+i*f*y,r[11]=s*c*g-o*u*g-s*l*v+i*u*v+o*l*y-i*c*y,r[15]=o*u*h-s*c*h+s*l*f-i*u*f-o*l*p+i*c*p;var b=i*r[0]+l*r[4]+h*r[8]+g*r[12];if(0==b){var x="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(x);return this.identity(),this}return this.multiplyScalar(1/b),this},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,s=e.y,a=e.z,l=i*o,c=i*s;return this.set(l*o+r,l*s-n*a,l*a+n*s,0,l*s+n*a,c*s+r,c*a-n*o,0,l*a-n*s,c*a+n*o,i*a*a+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},compose:function(e,t,r){return this.makeRotationFromQuaternion(t),this.scale(r),this.setPosition(e),this},transformPoint:function(e){var t=e.x,r=e.y,n=e.z,i=this.elements;return e.x=i[0]*t+i[4]*r+i[8]*n+i[12],e.y=i[1]*t+i[5]*r+i[9]*n+i[13],e.z=i[2]*t+i[6]*r+i[10]*n+i[14],e},transformDirection:function(e){var t=e.x,r=e.y,n=e.z,i=this.elements;e.x=i[0]*t+i[4]*r+i[8]*n,e.y=i[1]*t+i[5]*r+i[9]*n,e.z=i[2]*t+i[6]*r+i[10]*n;var o=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);if(o>0){var s=1/o;e.x*=s,e.y*=s,e.z*=s}return e},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return new n(this.elements instanceof Float64Array).fromArray(this.elements)}}},"./src/wgs/scene/LmvVector3.js":function(e,t,r){"use strict";r.r(t),r.d(t,"LmvVector3",function(){return n});var n=function(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0};n.prototype={constructor:n,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?this.addVectors(e,t):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?this.subVectors(e,t):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?this.multiplyVectors(e,t):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n+i[12],this.y=i[1]*t+i[5]*r+i[9]*n+i[13],this.z=i[2]*t+i[6]*r+i[10]*n+i[14],this},applyProjection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,o=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,s=e.z,a=e.w,l=a*t+o*n-s*r,c=a*r+s*t-i*n,u=a*n+i*r-o*t,d=-i*t-o*r-s*n;return this.x=l*a+d*-i+c*-s-u*-o,this.y=c*a+d*-o+u*-i-l*-s,this.z=u*a+d*-s+l*-o-c*-i,this},transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(){var e,t;return function(r,i){return void 0===e&&(e=new n,t=new n),e.set(r,r,r),t.set(i,i,i),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e),this},cross:function(e,t){if(void 0!==t)return this.crossVectors(e,t);var r=this.x,n=this.y,i=this.z;return this.x=n*e.z-i*e.y,this.y=i*e.x-r*e.z,this.z=r*e.y-n*e.x,this},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,s=t.y,a=t.z;return this.x=n*a-i*s,this.y=i*o-r*a,this.z=r*s-n*o,this},projectOnVector:function(){var e,t;return function(r){return void 0===e&&(e=new n),e.copy(r).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new n),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new n),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},setEulerFromRotationMatrix:function(e,t){},setEulerFromQuaternion:function(e,t){},getPositionFromMatrix:function(e){return this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),r=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),n=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){var r=4*e,n=t.elements;return this.x=n[r],this.y=n[r+1],this.z=n[r+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,r){return void 0===r&&(r=0),t=t*e.itemSize+r,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this}}},"./src/wgs/scene/MeshFlags.js":function(e,t,r){"use strict";r.r(t),r.d(t,"MeshFlags",function(){return n});var n={MESH_VISIBLE:1,MESH_HIGHLIGHTED:2,MESH_HIDE:4,MESH_ISLINE:8,MESH_MOVED:16,MESH_RENDERFLAG:32,MESH_NOTLOADED:64,MESH_ISPOINT:128,MESH_ISWIDELINE:256,MESH_TRAVERSED:512,MESH_DRAWN:1024}},"./src/wgs/scene/ModelExploder.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e,t,r,n){function i(n,o,l,d,h,f,p,m){var g=2*r;o==s&&(g*=a),e.getNodeBox(n,u);var v=.5*(u[0]+u[3]),y=.5*(u[1]+u[4]),_=.5*(u[2]+u[5]);if(o>0&&s>=o){var b=(v-l)*g,x=(y-d)*g,w=(_-h)*g;f+=b,p+=x,m+=w}e.isNodeExplodeLocked(n)&&(f=p=m=0),e.enumNodeChildren(n,function(e){i(e,o+1,v,y,_,f,p,m)},!1),c.x=f,c.y=p,c.z=m,e.enumNodeFragments(n,function(e){t.updateAnimTransform(e,null,null,c)},!1)}r*=2;var o=r*(e.maxDepth-1)+1;1===e.maxDepth&&(o=r);var s=0|o,a=o-s;i(e.getRootId(),0,n.x,n.y,n.z,0,0,0)}function a(e,t,r,n){var i,o,s=e.fragments.boxes;e.useThreeMesh?i=e.vizmeshes:o=e.fragments.fragId2dbId;for(var a=0,l=e.getCount();l>a;a++)if(0==r||t&&t.isNodeExplodeLocked(i?i[a]&&i[a].dbId:o[a]))e.updateAnimTransform(a);else{var u=6*a,d=.5*(s[u]+s[u+3]),h=.5*(s[u+1]+s[u+4]),f=.5*(s[u+2]+s[u+5]);c.x=r*(d-n.x),c.y=r*(h-n.y),c.z=r*(f-n.z),e.updateAnimTransform(a,null,null,c)}}r.r(t),r.d(t,"ModelExploder",function(){return f});var l=r("./thirdparty/three.js/three.js"),c=(r.n(l),new l.Vector3),u=new Float32Array(6),d="hierarchy",h=d,f=function(){function e(){n(this,e)}return o(e,null,[{key:"setStrategy",value:function(e){return h!==e?(h=e,!0):void 0}},{key:"getStrategy",value:function(){return h}},{key:"explode",value:function(e,t){var r=e.getData().instanceTree,n=e.getFragmentList(),i=e.getVisibleBounds(!0).center();h===d&&r&&0!==t?s(r,n,t,i):a(n,r,t,i)}}]),e}()},"./src/wgs/scene/ModelIteratorBVH.js":function(e,t,r){"use strict";function n(){function e(e){var t=p[e],r=s;if(m)for(;r>n&&p[f[r-1]]>t;)f[r]=f[r-1],r--;else for(;r>n&&p[f[r-1]]<t;)f[r]=f[r-1],r--;f[r]=e,s++}function t(e){var r=c.getLeftChild(e);-1!==r&&(t(r),t(r+1)),_.makeEmpty(),-1!==r&&(c.getBoxThree(r,b),_.union(b),c.getBoxThree(r+1,b),_.union(b));var n=c.getPrimCount(e);n&&(_.union(d[e].getBoundingBox()),_.union(d[e].getBoundingBoxHidden())),c.setBoxThree(e,_)}var r,n,s,a,l,c=null,u=null,d=null,h=null,f=null,p=null,m=1,g=!0,v=!1,y=!1,_=new o.Box3,b=new o.Box3,x=!1,w=!0;this.initialize=function(e,t,n,i){r=e.getFragmentList(),l=e.RenderBatch,i&&i.hasOwnProperty("prioritize_screen_size")&&(g=i.prioritize_screen_size),u=n,d=new Array(t.nodeCount),h=new Int8Array(t.nodeCount),c=t,f=new Int32Array(t.nodeCount+1),p=new Float32Array(t.nodeCount);for(var o=0;o<t.nodeCount;o++){var s=t.getPrimCount(o);s&&(d[o]=new l(r,u,t.getPrimStart(o),s),d[o].lastItem=d[o].start+s,d[o].numAdded=s,d[o].nodeIndex=o,8&t.getFlags(o)&&(d[o].sortObjects=!0),t.getBoxArray(o,d[o].bboxes))}},this.addFragment=function(e,t){},this.reset=function(e){if(a=e,n=0,s=0,h[0]=h[1]=i.FrustumIntersector.CONTAINMENT_UNKNOWN,f[s++]=0,v=!1,y=!1,x=!1,w){for(var t=d,r=t.length,o=0;r>o;++o){var l=t[o];l&&l.resetVisStatus&&l.resetVisStatus()}w=!1}},this.nextBatch=function(){for(y||v||n!==s||(f[s++]=1,v=!0);n!==s;){var t=m||v?f[--s]:f[n++],r=h[t];if(r!==i.FrustumIntersector.CONTAINS&&(c.getBoxThree(t,_),r=a.intersectsBox(_)),r!==i.FrustumIntersector.OUTSIDE){var o,l,u=c.getLeftChild(t),b=-1!==u;if(b){var w=c.getFlags(t),E=a.viewDir[3&w]<0?1:0,S=w>>2&1,A=w>>3&1,M=m||v?1:0,T=0,C=0;g&&!v?(o=u+S,l=u+1-S,c.getBoxThree(o,_),p[o]=T=a.projectedBoxArea(_,r===i.FrustumIntersector.CONTAINS),c.getBoxThree(l,_),p[l]=C=a.projectedBoxArea(_,r===i.FrustumIntersector.CONTAINS),h[o]=h[l]=r,T>0&&e(o),C>0&&e(l)):(E^M^A&&(S=1-S),o=u+S,l=u+1-S,f[s++]=o,p[o]=-1,f[s++]=l,p[l]=-1,h[o]=h[l]=r)}var j=c.getPrimCount(t);if(0!==j){var P=d[t];return P.renderImportance=a.projectedBoxArea(P.getBoundingBox(),r===i.FrustumIntersector.CONTAINS),P}}v||y||n!==s||(f[s++]=1,v=!0)}return x=!0,null},this.skipOpaqueShapes=function(){v||y||(n=0,s=0,f[s++]=1,y=!0)},this.getVisibleBounds=function(e,r){for(var n=0;n<d.length;n++){var i=d[n];if(i){i.calculateBounds();var o=i.getBoundingBox();e.union(o),r.union(o),r.union(i.getBoundingBoxHidden())}}t(0),t(1)},this.rayCast=function(e,t,r){for(var n=[1,0],i=new o.Vector3;n.length;){var s=n.pop();c.getBoxThree(s,_),_.expandByScalar(.5);var a=e.ray.intersectBox(_,i);if(null!==a){var l=c.getLeftChild(s);-1!==l&&(n.push(l),n.push(l+1));var u=c.getPrimCount(s);if(0!==u){var h=d[s];h.raycast(e,t,r)}}}},this.getSceneCount=function(){return d.length},this.getGeomScenes=function(){return d},this.done=function(){return x},this.resetVisStatus=function(){w=!0}}r.r(t),r.d(t,"ModelIteratorBVH",function(){return n});var i=r("./src/wgs/scene/FrustumIntersector.js"),o=r("./thirdparty/three.js/three.js");r.n(o)},"./src/wgs/scene/ModelIteratorLinear.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}r.r(t),r.d(t,"ModelIteratorLinear",function(){return c});var s=(r("./src/wgs/scene/RenderBatch.js"),r("./src/compat.js")),a=500,l=function(e){var t=a;return e&&(t/=6),Object(s.isMobileDevice)()&&(t/=3),t=Math.floor(t),t>0?t:a},c=function(){function e(t){n(this,e),this._frags=t.getFragmentList(),this._RenderBatch=t.RenderBatch,this._model=t,this._fillLast=this._model.is2d(),this._fragsPerScene=l(t.is2d()),this._fragOrder=[],this._geomScenes=[];var r=this._frags.getCount();this._currentScene=0;for(var i=new Int32Array(r),o=0;r>o;o++)i[o]=o;this.setFragmentOrder(i,r)}return o(e,[{key:"setFragmentOrder",value:function(e,t){this._fragCount=t,this._fragOrder[0]=e;var r=Math.floor((this._fragCount+this._fragsPerScene-1)/this._fragsPerScene);this._geomScenes.length=r;for(var n=0;r>n;n++){var i=n*this._fragsPerScene,o=this._geomScenes[n]=new this._RenderBatch(this._frags,this._fragOrder,i,this._fragsPerScene),s=i+this._fragsPerScene;s>this._fragCount&&(s=this._fragCount),o.lastItem=s}}},{key:"addFragment",value:function(e){if(this._fragOrder[0].length<=e){var t=2*this._fragOrder[0].length;e>=t&&(t=e+1);var r=new Int32Array(t);r.set(this._fragOrder[0]),this._fragOrder[0]=r,this.visibleBoundsDirty=!0}this._fragOrder[0][e]=e;var n=Math.floor(e/this._fragsPerScene);if(this._geomScenes){var i=this._geomScenes[n];i||(this._geomScenes[n]=i=new this._RenderBatch(this._frags,this._fragOrder,n*this._fragsPerScene,this._fragsPerScene)),i&&i.onFragmentAdded(e)}}},{key:"reset",value:function(e,t){if(this._currentScene=0,this._fillLast&&this._geomScenes[0]&&(this._geomScenes[0].drawEnd=0),this._resetVisStatus){for(var r=this._geomScenes,n=r.length,i=0;n>i;++i){var o=r[i];o&&o.resetVisStatus&&o.resetVisStatus()}this._resetVisStatus=!1}}},{key:"getSceneCount",value:function(){return this._geomScenes.length}},{key:"getGeomScenes",value:function(){return this._geomScenes}},{key:"resetVisStatus",value:function(){this._resetVisStatus=!0}},{key:"done",value:function(){if(this._fillLast&&!this._model.isLoadDone())return!1;var e;return this._currentScene>=this._geomScenes.length-1&&(!(e=this._geomScenes[this._currentScene])||e.drawStart>=e.lastItem)}},{key:"nextBatch",value:function(){if(this._currentScene>=this.getSceneCount())return null;var e=this._geomScenes[this._currentScene];if(this._fillLast){if(e.lastItem>=e.start+e.count&&(++this._currentScene,this._geomScenes[this._currentScene]&&(this._geomScenes[this._currentScene].drawEnd=this._geomScenes[this._currentScene].start)),e.drawStart=e.drawEnd,e.drawEnd=e.lastItem,e.hasOwnProperty("drawStart")&&e.lastItem<=e.drawStart)return null}else++this._currentScene;return e.renderImportance=1e20,e}},{key:"getVisibleBounds",value:function(e,t){for(var r=this.getSceneCount(),n=0;r>n;n++){this._geomScenes[n].calculateBounds();var i=this._geomScenes[n].getBoundingBox();e.union(i),t.union(i),t.union(this._geomScenes[n].getBoundingBoxHidden())}}},{key:"rayCast",value:function(e,t,r){for(var n=this.getSceneCount(),i=0;n>i;i++)this._geomScenes[i].raycast(e,t,r)}}]),e}()},"./src/wgs/scene/RenderBatch.js":function(e,t,r){"use strict";function n(e,t,r,n){this.frags=e,this.indices=t,this.start=r,this.count=n,this.lastItem=r,this.overrideMaterial=null,this.sortDone=!1,this.numAdded=0,this.avgFrameTime=void 0,this.nodeIndex=void 0,this.bboxes=new Array(12),this.bboxes[0]=this.bboxes[1]=this.bboxes[2]=1/0,this.bboxes[3]=this.bboxes[4]=this.bboxes[5]=-(1/0),this.bboxes[6]=this.bboxes[7]=this.bboxes[8]=1/0,this.bboxes[9]=this.bboxes[10]=this.bboxes[11]=-(1/0),this.sortObjects=!1,this.sortDone=!1,this.sortByShaderDone=!1,this.frustumCulled=!0,this.forceVisible=!1,this.renderImmediate=!e.useThreeMesh,this.renderImportance=0}function i(e,t,r,n,i){var o,s=l.MeshFlags.MESH_RENDERFLAG,a=t[r]&~s;switch(e){case c.RenderFlags.RENDER_HIDDEN:o=!(a&l.MeshFlags.MESH_VISIBLE);break;case c.RenderFlags.RENDER_HIGHLIGHTED:o=a&l.MeshFlags.MESH_HIGHLIGHTED;break;default:o=1==(a&(l.MeshFlags.MESH_VISIBLE|l.MeshFlags.MESH_HIGHLIGHTED|l.MeshFlags.MESH_HIDE))}if(n){var u=a&(l.MeshFlags.MESH_ISLINE|l.MeshFlags.MESH_ISWIDELINE);o=o&&!u}if(i){var d=a&l.MeshFlags.MESH_ISPOINT;o=o&&!d}return t[r]=a|(o?s:0),o}function o(e,t,r,n){var i=!1;return r.getWorldBounds(n,h),e&&!t.intersectsBox(h)&&(i=!0),!i&&t.boxOutsideCutPlanes(h)&&(i=!0),i}r.r(t),r.d(t,"RenderBatch",function(){return n});var s=r("./src/wgs/scene/VBIntersector.js"),a=r("./src/wgs/scene/FrustumIntersector.js"),l=r("./src/wgs/scene/MeshFlags.js"),c=r("./src/wgs/scene/RenderFlags.js"),u=r("./src/logger/Logger.js"),d=r("./src/wgs/scene/LmvBox3.js"),h=new d.LmvBox3,f=null;n.prototype.getIndices=function(){return Array.isArray(this.indices)?this.indices[0]:this.indices},n.prototype.sortByMaterial=function(){if(!(this.numAdded<this.count)){var e=this.frags,t=this.getIndices();if(!t)return void u.logger.warn("Only indexed RenderSubsets can be sorted.");var r=t.subarray(this.start,this.start+this.count);Array.prototype.sort.call(r,function(t,r){var n=e.getMaterialId(t),i=e.getMaterialId(r);return void 0===n?i?1:0:void 0===i?-1:n-i}),this.numAdded=0,this.sortDone=!0}},n.prototype.sortByShader=function(){if(this.sortDone&&!this.sortByShaderDone){var e=this.frags,t=this.getIndices(),r=t.subarray(this.start,this.start+this.count);Array.prototype.sort.call(r,function(t,r){var n=e.getMaterial(t),i=e.getMaterial(r),o=n.program.id-i.program.id;return o?o:n.id-i.id}),this.numAdded=0,this.sortByShaderDone=!0}},n.prototype.sortByDepth=function(e){var t=this.frags,r=this.getIndices(),n=e,i=h;if(!r)return void u.logger.warn("Only indexed RenderSubsets can be sorted.");(!f||f.length<this.count)&&(f=new Float32Array(this.count));var o=f,s=this.start;this.forEachNoMesh(function(e,r){t.getGeometry(e)?(t.getWorldBounds(e,i),o[r]=n.estimateDepth(i)):o[r]=-(1/0)});for(var a,l,c=1;c<this.count;c++)for(var d=c;d>0&&o[d-1]<o[d];)a=o[d-1],o[d-1]=o[d],o[d]=a,l=r[s+d-1],r[s+d-1]=r[s+d],r[s+d]=l,d--},n.prototype.addToBox=function(e,t){var r=t?6:0,n=this.bboxes;n[0+r]=Math.min(n[0+r],e.min.x),n[1+r]=Math.min(n[1+r],e.min.y),n[2+r]=Math.min(n[2+r],e.min.z),n[3+r]=Math.max(n[3+r],e.max.x),n[4+r]=Math.max(n[4+r],e.max.y),n[5+r]=Math.max(n[5+r],e.max.z)},n.prototype.getBoundingBox=function(e){e=e||h;var t=this.bboxes;return e.min.x=t[0],e.min.y=t[1],e.min.z=t[2],e.max.x=t[3],e.max.y=t[4],e.max.z=t[5],e},n.prototype.getBoundingBoxHidden=function(e){e=e||h;var t=this.bboxes,r=6;return e.min.x=t[0+r],e.min.y=t[1+r],e.min.z=t[2+r],e.max.x=t[3+r],e.max.y=t[4+r],e.max.z=t[5+r],e},n.prototype.onFragmentAdded=function(){return function(e){this.frags.getWorldBounds(e,h),this.addToBox(h,!1),this.sortDone=!1,this.lastItem<=e&&(this.lastItem=e+1,void 0!==this.visibleStats&&(this.visibleStats=0),this.numAdded++)}}(),n.prototype.forEach=function(e,t,r){var n,i,o,s,a=this.getIndices(),c=this.frags,u=!this.sortByShaderDone;if(t||r||u)for(n=t===l.MeshFlags.MESH_RENDERFLAG&&this.hasOwnProperty("drawStart")?this.drawStart:this.start,i=this.lastItem;i>n;n++){o=a?a[n]:n;var s=c.getVizmesh(o,this.renderImportance);!u||s&&s.material&&s.material.program&&!s.geometry_proxy||(u=!1),!(r||s&&s.geometry)||t&&!c.isFlagSet(o,t)||e(s,o)}else for(n=this.start,i=this.lastItem;i>n;n++){o=a?a[n]:n;var s=c.getVizmesh(o,this.renderImportance);s&&s.geometry&&e(s,o)}u&&this.sortByShader()},n.prototype.forEachNoMesh=function(e,t,r){for(var n=this.getIndices(),i=this.frags,o=this.start,s=this.lastItem;s>o;o++){var a,l=n?n[o]:o;if(i.useThreeMesh){var c=i.getVizmesh(l);c&&(a=c.geometry)}else a=i.getGeometry(l);!r&&!a||t&&!i.isFlagSet(l,t)||e(l,o-this.start)}},n.prototype.raycast=function(){return function(e,t,r){if(e.ray.isIntersectionBox(this.getBoundingBox())!==!1){var n=this,i=h;this.forEach(function(o,a){if(!n.frags.isFlagSet(a,l.MeshFlags.MESH_HIDE)){if(r&&r.length){var c=0|n.frags.getDbIds(a);if(-1===r.indexOf(c))return}n.frags.getWorldBounds(a,i),i.expandByScalar(.5),e.ray.isIntersectionBox(i)&&s.VBIntersector.rayCast(o,e,t)}},l.MeshFlags.MESH_VISIBLE)}}}(),n.prototype.calculateBounds=function(){function e(e){r.getWorldBounds(e,n);var o=t[e];i.addToBox(n,!(1&o))}var t,r,n,i;return function(){this.bboxes[0]=this.bboxes[1]=this.bboxes[2]=1/0,this.bboxes[3]=this.bboxes[4]=this.bboxes[5]=-(1/0),this.bboxes[6]=this.bboxes[7]=this.bboxes[8]=1/0,this.bboxes[9]=this.bboxes[10]=this.bboxes[11]=-(1/0),t=this.frags.vizflags,r=this.frags,n=h,i=this,this.forEachNoMesh(e,0,!0)}}(),n.prototype.applyVisibility=function(){function e(e,t){if((e||!r.useThreeMesh)&&e.geometry){var a=o(h,s,r,t);if(a)return e?e.visible=!1:u.logger.warn("Unexpected null mesh"),void(n[t]=n[t]&~l.MeshFlags.MESH_RENDERFLAG);var c=i(d,n,t,r.linesHidden,r.pointsHidden);e&&(e.visible=!!c),f=f&&!c}}function t(e){if(r.getGeometryId(e)){var t=o(h,s,r,e);if(t)return void(n[e]=n[e]&~l.MeshFlags.MESH_RENDERFLAG);var a=i(d,n,e,r.linesHidden,r.pointsHidden);f=f&&!a}}var r,n,s,d,h,f;return function(i,o){f=!0,s=o,d=i;var l=d===c.RenderFlags.RENDER_HIDDEN?this.getBoundingBoxHidden():this.getBoundingBox(),u=s.intersectsBox(l);return u===a.FrustumIntersector.OUTSIDE?f:o.boxOutsideCutPlanes(l)?f:(n=this.frags.vizflags,r=this.frags,h=u!==a.FrustumIntersector.CONTAINS,r.useThreeMesh?this.forEach(e,null):this.forEachNoMesh(t,0,!1),r=null,f)}}()},"./src/wgs/scene/RenderFlags.js":function(e,t,r){"use strict";r.r(t),r.d(t,"RenderFlags",function(){return n});var n={RENDER_NORMAL:0,RENDER_HIGHLIGHTED:1,RENDER_HIDDEN:2,RENDER_SHADOWMAP:3,RENDER_FINISHED:4}},"./src/wgs/scene/RenderModel.js":function(e,t,r){"use strict";function n(e,t,r){if(e){var n=e-3*t*2;if(n<=o.GPU_MEMORY_LIMIT&&r<o.GPU_OBJECT_LIMIT)return!1}return!0}function i(){var e=new p.Box3,t=new p.Box3,r=new p.Box3;this.visibleBoundsDirty=!1,this.enforceBvh=!1;var i=0;this.id=y++;var o=null,_=null,b=null,x=null,w=null,E=null,S=null,A=0,M=null,T=g.RenderFlags.RENDER_NORMAL,C=!1;this.getGeometryList=function(){return o},this.getFragmentList=function(){return _},this.getModelId=function(){return this.id},this.RenderBatch=l.RenderBatch,this.initialize=function(){
var r=this.getData(),i=r.numGeoms||0,l=!n(r.packFileTotalSize,r.primitiveCount,i);o=new s.GeometryList(i,this.is2d(),l,this.isOTG()),_=new a.FragmentList(this);var c=this.getBoundingBox();c&&(e.copy(c),t.copy(c)),w=b=new d.ModelIteratorLinear(this)},this.getIterator=function(){return w},this.initFromCustomIterator=function(e){w=e,this.visibleBoundsDirty=!0},this.dtor=function(e){_&&_.dispose(e),w&&w.dtor&&(w.dtor(),b=null),E&&E.dispose()},this.activateFragment=function(n,i,o){_&&(_.setMesh(n,i,o),w.addFragment(n),_.getWorldBounds(n,r),e.union(r),t.union(r))},this.setFragment=function(n,i,o){return void 0===n&&(n=this.getFragmentList().getNextAvailableFragmentId()),_.setMesh(n,i,!0,o),b&&b.addFragment(n),x&&!_.fragmentsHaveBeenAdded()&&x.addFragment(n),_.getWorldBounds(n,r),e.union(r),t.union(r),n},this.setBVH=function(e,t,r){w=x=new h.ModelIteratorBVH,w.initialize(this,e,t,r)},this.resetIterator=function(e,t,r){return C=!1,x&&!_.fragmentsHaveBeenAdded()&&(C=!0),C?w=x:b&&(w=b),A=0,T=r,M=t,w.reset(t,e),E&&E.reset(),w},this.nextBatch=function(){for(;;){var e=w.nextBatch();if(A++,!e)return null;if(E&&e instanceof l.RenderBatch&&(e=E.consolidateNextBatch(e,M,T)),e.modelId=this.id,e instanceof p.Scene)return e;if(!this.applyVisibility(e,T,M))return e}},this.applyVisibility=function(e,t,r){var n=e.applyVisibility(t,r);return n||this.is2d()||(e.sortObjects&&!this.getFragmentList().useThreeMesh?e.sortByDepth(r):e.sortDone||e.sortByMaterial()),n},this.getVisibleBounds=function(r){return this.visibleBoundsDirty&&(e.makeEmpty(),t.makeEmpty(),w.getVisibleBounds(e,t,r),this.visibleBoundsDirty=!1),r?t:e},this.rayIntersect=function(e,t,r,n){this.visibleBoundsDirty&&this.getVisibleBounds();var i,o=[];if(r&&r.length>0){var s=this.getInstanceTree(),a=[];if(s)for(i=0;i<r.length;i++)s.enumNodeFragments(r[i],function(e){a.push(e)},!0);else a=r;if(a.length>2)w.rayCast(e,o,r);else for(i=0;i<a.length;i++){var l=_.getVizmesh(a[i]);if(l){var c=f.VBIntersector.rayCast(l,e,o);c&&o.push(c)}}}else w.rayCast(e,o);if(!o.length)return null;o.sort(function(e,t){return e.distance-t.distance});var u=!!n;for(n=n||[],i=0;i<o.length;i++){var d=o[i].fragId;if(!this.is2d()){var h=this.isFragVisible(d);if(h){var m=_.getMaterial(d);if(t&&m.transparent)continue;var g=o[i],v=!1,y=g.point;if(m&&m.cutplanes)for(var b=0;b<m.cutplanes.length;b++)v=v||m.cutplanes[b].dot(new p.Vector4(y.x,y.y,y.z,1))>1e-6;if(v||n.push(g),g.model=this,!u&&n.length>0)break}}}var x=n[0]||null;return x&&(x.model=this),x},this.setHighlighted=function(e,t){if(!_)return!1;var r=_.setFlagFragment(e,m.MeshFlags.MESH_HIGHLIGHTED,t);return r&&(t?i++:i--),r},this.setVisibility=function(e,t){_&&(_.setVisibility(e,t),this.visibleBoundsDirty=!0)},this.setAllVisibility=function(e){_&&(_.setAllVisibility(e),this.visibleBoundsDirty=!0)},this.hideLines=function(e){_&&_.hideLines(e)},this.hidePoints=function(e){_&&_.hidePoints(e)},this.hasHighlighted=function(){return!!i},this.isFragVisible=function(e){return _.isFragVisible(e)},this.areAllVisible=function(){return _?_.areAllVisible():!0},this.getGeomScenes=function(){return w.getGeomScenes()},this.getRenderProgress=function(){var e=A/w.getSceneCount();return e>1?1:e},this.update=function(e){return w&&w.update?w.update(e):!1},this.setThemingColor=function(e,t,r){if(e=this.reverseMapDbId(e),_){var n=this.getInstanceTree();r&&n?n.enumNodeChildren(e,function(e){_.setThemingColor(e,t)},!0):_.setThemingColor(e,t)}else v.logger.warn("Theming colors are not supported by this model type.")},this.clearThemingColors=function(){_&&_.clearThemingColors()},this.getLeaflet=function(){return w.isModelIteratorTexQuad?w:null},this.consolidate=function(e,t,r){var n=Object(c.consolidateFragmentList)(this,e,t,r,S);E=new u.ConsolidationIterator(_,n),S=n.consolidationMap},this.unconsolidate=function(){E&&(E.dispose(),E=null)},this.isConsolidated=function(){return!!E},this.getConsolidation=function(){return E?E.getConsolidation():null},this.setDbIdRemap=function(e){this.is2d&&(this.idRemap=e)},this.remapDbId=function(e){return this.idRemap&&e>0&&e<this.idRemap.length?this.idRemap[e]:e},this.reverseMapDbId=function(e){if(!this.idRemap||0>=e)return e;if(!this.reverseMap){this.reverseMap={};for(var t=0;t<this.idRemap.length;t++)this.reverseMap[this.idRemap[t]]=t}return this.reverseMap[e]},this.updateRenderProxy=function(e,t){E&&E.updateRenderProxy(e,t)},this.skipOpaqueShapes=function(){w&&w.skipOpaqueShapes&&w.skipOpaqueShapes()},this.invalidateBBoxes=function(){this.visibleBoundsDirty=!0},this.setModelTransform=function(e){e?(_.matrix=_.matrix||new p.Matrix4,_.matrix.copy(e)):_.matrix=null,E&&E.modelMatrixChanged(),this.invalidateBBoxes(),this.getVisibleBounds(!0)},this.getModelTransform=function(){return _&&_.matrix},this.setInnerAttributes=function(n){this.id=n._id,e=n._visibleBounds,t=n._visibleBoundsWithHidden,r=n._tmpBox,this.enforceBvh=n._enforceBvh,i=n._numHighlighted,o=n._geoms,_=n._frags,b=n._linearIterator,x=n._bvhIterator,w=n._iterator,E=n._consolidationIterator,S=n._consolidationMap,A=n._renderCounter,M=n._frustum,T=n._drawMode,C=n._bvhOn},this.getInnerAttributes=function(){return{_id:this.id,_visibleBounds:e,_visibleBoundsWithHidden:t,_tmpBox:r,_enforceBvh:this.enforceBvh,_numHighlighted:i,_geoms:o,_frags:_,_linearIterator:b,_bvhIterator:x,_iterator:w,_consolidationIterator:E,_consolidationMap:S,_renderCounter:A,_frustum:M,_drawMode:T,_bvhOn:C}}}r.r(t),r.d(t,"RenderModel",function(){return i});var o=r("./src/wgs/globals.js"),s=r("./src/wgs/scene/GeometryList.js"),a=r("./src/wgs/scene/FragmentList.js"),l=r("./src/wgs/scene/RenderBatch.js"),c=r("./src/wgs/scene/consolidation/FragmentListConsolidation.js"),u=r("./src/wgs/scene/consolidation/ConsolidationIterator.js"),d=r("./src/wgs/scene/ModelIteratorLinear.js"),h=r("./src/wgs/scene/ModelIteratorBVH.js"),f=r("./src/wgs/scene/VBIntersector.js"),p=r("./thirdparty/three.js/three.js"),m=(r.n(p),r("./src/wgs/scene/MeshFlags.js")),g=r("./src/wgs/scene/RenderFlags.js"),v=r("./src/logger/Logger.js"),y=1},"./src/wgs/scene/RenderScene.js":function(e,t,r){"use strict";function n(){function e(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n&&n.id===t)return n}return null}function t(e,t){void 0===e.avgFrameTime?e.avgFrameTime=t:e.avgFrameTime=.8*e.avgFrameTime+.2*t}function r(e,r,n){var i,o;for(i=0;i<e.length;i++){o=e[i];var s=o.boundingBox||o.getBoundingBox();o.cameraDistance=s.distanceToPoint(r.position)}var a=function(e,t){return t.cameraDistance-e.cameraDistance};e.sort(a);var l=performance.now();for(i=0;i<e.length;i++){o=e[i],n(o);var c=performance.now(),u=c-l;l=c,t(o,u)}}var n=!1,u=!1,d=[],h=[],f=[],p=new s.Box3,m=[],g=new o.FrustumIntersector,v=new s.Raycaster,y=performance;this.enableNonResumableFrames=!1,this.budgetForTransparent=.1;var _=!1,b=[],x=null;this.frustum=function(){return g},this.findModel=function(t){return e(d,t)},this.findHiddenModel=function(t){return e(m,t)},this.addModel=function(e){d.push(e),h.length=d.length,f.length=d.length,this.recomputeLinePrecision()},this.removeModel=function(e){var t=d.indexOf(e);return t>=0&&d.splice(t,1),h.length=d.length,f.length=d.length,this.recomputeLinePrecision(),t>=0},this.addHiddenModel=function(e){var t=m.indexOf(e);return 0>t&&m.push(e),0>t},this.removeHiddenModel=function(e){var t=m.indexOf(e);return t>=0&&m.splice(t,1),t>=0},this.isEmpty=function(){return 0===d.length},this.needsRender=function(){return n},this.resetNeedsRender=function(){n=!1},this.recomputeLinePrecision=function(){for(var e=1,t=0,r=d.length;r>t;++t){var n=d[t].getData().bbox,i=.001*s.Box3.prototype.getBoundingSphere.call(n).radius;e=Math.min(e,i)}v.linePrecision=e},this.frameResumePossible=function(){return!_},this.renderSome=function(e,n){for(var i,o,s=y.now(),a=this.budgetForTransparent*n;;){for(var l=0,c=null,f=0;f<h.length;f++){var p=h[f];o=d[f],p||(h[f]=p=o.nextBatch());var m=_&&a>n;if(m){var g=p&&!p.sortObjects;g&&(o.skipOpaqueShapes(),p=o.nextBatch())}null!==p&&(c||(l=f,c=p),p.renderImportance>c.renderImportance&&(l=f,c=p))}if(!c){u=!0;break}if(h[l]=d[l].nextBatch(),c.sortObjects&&_)b.push(c),n-=void 0===c.avgFrameTime?.05:c.avgFrameTime;else{e(c),c.hasOwnProperty("drawEnd")&&(c.drawEnd=c.lastItem),i=y.now();var v=i-s;s=i,t(c,v),n-=c.avgFrameTime}i=y.now();var v=i-s;if(s=i,t(c,v),n-=c.avgFrameTime,0>=n)break}return b.length>0&&(r(b,x,e),b.length=0),n},this.reset=function(e,t,r,n){if(u=!1,this.resetNeedsRender(),g.reset(e,n),g.areaCullThreshold=i.PIXEL_CULLING_THRESHOLD,d.length){_=this.enableNonResumableFrames&&r==l.ResetFlags.RESET_RELOAD&&t===a.RenderFlags.RENDER_NORMAL,x=e;for(var o=0;o<d.length;o++)d[o].resetIterator(e,g,t,r),h[o]=d[o].nextBatch(),f[o]=null}},this.isDone=function(){return u||this.isEmpty()},this.setAllVisibility=function(e){for(var t=0;t<d.length;t++)d[t].setAllVisibility(e)},this.hideLines=function(e){for(var t=0;t<d.length;t++)d[t].hideLines(e)},this.hidePoints=function(e){for(var t=0;t<d.length;t++)d[t].hidePoints(e)},this.hasHighlighted=function(){for(var e=0;e<d.length;e++)if(d[e].hasHighlighted())return!0;return!1},this.areAllVisible=function(){for(var e=0;e<d.length;e++)if(!d[e].areAllVisible())return!1;return!0},this.areAll2D=function(){for(var e=0;e<d.length;e++)if(!d[e].is2d())return!1;return!0},this.areAll3D=function(){for(var e=0;e<d.length;e++)if(!d[e].is3d())return!1;return!0},this.invalidateVisibleBounds=function(){for(var e=0;e<d.length;e++)d[e].visibleBoundsDirty=!0},this.getVisibleBounds=function(e){if(1===d.length)return d[0].getVisibleBounds(e);p.makeEmpty();for(var t=0;t<d.length;t++)p.union(d[t].getVisibleBounds(e));return p},this.rayIntersect=function(e,t,r,n,i,o){v.set(e,t);var s;if(d.length>1){var a=[];if(i)for(s=0;s<i.length;s++){var l=this.findModel(i[s]);if(l){var c=n&&n[s],u=l.rayIntersect(v,r,c);u&&a.push(u)}}else for(s=0;s<d.length;s++)if(!d[s].is2d()){var u=d[s].rayIntersect(v,r,n,o);u&&a.push(u)}return a.length?(a.sort(function(e,t){return e.distance-t.distance}),a[0]):null}if(!d.length||d[0].is2d())return null;var l=d[0];return i&&-1===i.indexOf(l.id)?null:l.rayIntersect(v,r,n,o)},this.getRenderProgress=function(){return d[0].getRenderProgress()},this.getModels=function(){return d},this.getHiddenModels=function(){return m},this.getFragmentList=function(){return d[0].getFragmentList()},this.getGeometryList=function(){return d[0].getGeometryList()},this.getSceneCount=function(){return d[0].getSceneCount()},this.getGeomScenes=function(){return d[0].getGeomScenes()},this.explode=function(e){if(d.length){for(var t=0;t<d.length;t++){var r=d[t];c.ModelExploder.explode(r,e)}this.invalidateVisibleBounds()}},this.update=function(e){for(var t=!1,r=0;r<d.length;r++){var n=d[r];t=t||n.update(e)}return t},this.hideModel=function(e){for(var t=0;t<d.length;t++){var r=d[t];if(r&&r.id===e)return this.removeModel(r),m.push(r),!0}return!1},this.showModel=function(e){for(var t=0;t<m.length;++t){var r=m[t];if(r&&r.id===e)return this.addModel(r),m.splice(t,1),!0}return!1}}r.r(t),r.d(t,"RenderScene",function(){return n});var i=r("./src/wgs/globals.js"),o=r("./src/wgs/scene/FrustumIntersector.js"),s=r("./thirdparty/three.js/three.js"),a=(r.n(s),r("./src/wgs/scene/RenderFlags.js")),l=r("./src/wgs/scene/ResetFlags.js"),c=r("./src/wgs/scene/ModelExploder.js")},"./src/wgs/scene/ResetFlags.js":function(e,t,r){"use strict";r.r(t),r.d(t,"ResetFlags",function(){return n});var n={RESET_NORMAL:0,RESET_REDRAW:1,RESET_RELOAD:2}},"./src/wgs/scene/SceneMath.js":function(e,t,r){"use strict";function n(e,t){for(var r=[],n=0;n<l.length;n++){c.normal.copy(l[n]);var i=3>n?e.max:e.min;c.constant=-c.normal.dot(i),t&&c.applyMatrix4(t),r.push(new a.Vector4(c.normal.x,c.normal.y,c.normal.z,c.constant))}return r}function i(e,t,r,n,i,s){var l,c;if(t){var u="z",d=o(new a.Vector3(0,0,1),e,u,s);l=d?e.position.distanceTo(d):e.position.distanceTo(r.center()),c=n/(2*l*Math.tan(a.Math.degToRad(.5*e.fov)))}else{var h;if(i){var f=i,p=e.target.clone().sub(e.position).normalize(),m=p.dot(f);if(0===m)h=r.center();else{var g=-(e.position.clone().dot(f)+f.w)/m;h=r.clampPoint(p.multiplyScalar(g).add(e.position))}}else h=r.center();l=e.position.distanceTo(h),c=n/(2*l*Math.tan(a.Math.degToRad(.5*e.fov)))}return c}function o(e,t,r,n){var i=e;i.z=-1;var o=new a.Vector3(i.x,i.y,1);i=i.unproject(t),o=o.unproject(t),o.sub(i).normalize();var s=o;if(Math.abs(s[r])<1e-6)return null;var l;l=t.isPerspective?t.position:i;var c=n?n.min[r]:0,u=(c-l[r])/s[r];return s.multiplyScalar(u),s.add(l),s}function s(e,t){t=t||e.getData().bbox;var r=new a.Matrix4;r.makeTranslation(-t.min.x,-t.min.y,-t.min.z);var n=new a.Vector3(0,0,0).subVectors(t.max,t.min),i=new a.Matrix4;i.makeScale(1/n.x,1/n.y,1);var o=new a.Matrix4;return o.multiplyMatrices(i,r),o}r.r(t),r.d(t,"SceneMath",function(){return u});var a=r("./thirdparty/three.js/three.js"),l=(r.n(a),[new a.Vector3(1,0,0),new a.Vector3(0,1,0),new a.Vector3(0,0,1),new a.Vector3(-1,0,0),new a.Vector3(0,-1,0),new a.Vector3(0,0,-1)]),c=new a.Plane,u={box2CutPlanes:n,getPixelsPerUnit:i,intersectGroundViewport:o,getNormalizingMatrix:s}},"./src/wgs/scene/SelectionMode.js":function(e,t,r){"use strict";r.r(t),r.d(t,"SelectionMode",function(){return n});var n={LEAF_OBJECT:0,FIRST_OBJECT:1,LAST_OBJECT:2}},"./src/wgs/scene/SortedList.js":function(e,t,r){"use strict";function n(e){function t(e,o,s){if(o||(o=0),s||(s=i.length),o>=s)return s;if(s===o+1){var a=n[i[o]];return r(a,e)?s:o}var l=parseInt(o+(s-o)/2),c=n[i[l-1]];return r(e,c)?t(e,o,l):r(c,e)?t(e,l,s):l-1}var r=e?e:function(e,t){return t>e},n=[],i=[];this.add=function(e){var r=t(e);return r==i.length?(n.push(e),void i.push(n.length-1)):(n.push(e),void i.splice(r,0,n.length-1))},this.size=function(){return i.length},this.get=function(e){return n[i[e]]},this.removeAt=function(e){var t=i[e];n[t]=void 0,i.splice(e,1)},this.toString=function(){for(var e="",t=0,r=this.size();r>t;++t)e+=this.get(t),r-1>t&&(e+=", ");return e}}r.r(t),r.d(t,"SortedList",function(){return n})},"./src/wgs/scene/VBIntersector.js":function(e,t,r){"use strict";function n(){u||(u=new g.Matrix4,d=new g.Ray,h=new g.Vector3,f=new g.Vector3,p=new g.Vector3)}function i(e,t,r){n();var i=e.geometry;if(i){var o=e.material,s=o?o.side:g.FrontSide;u.getInverse(e.matrixWorld),d.copy(t.ray).applyMatrix4(u);var a,l,c=t.precision;Object(m.enumMeshTriangles)(i,function(n,i,o,u,h,f,p,m,v,y){a=s===g.BackSide?d.intersectTriangle(o,i,n,!0):d.intersectTriangle(n,i,o,s!==g.DoubleSide),null!==a&&(a.applyMatrix4(e.matrixWorld),l=t.ray.origin.distanceTo(a),c>l||l<t.near||l>t.far||r.push({distance:l,point:a,face:new g.Face3(u,h,f,g.Triangle.normal(n,i,o)),faceIndex:y,fragId:e.fragId,dbId:e.dbId,object:e}))})}}function o(e,t,r){n();var i=e.geometry;if(i){var o=t.linePrecision;e.isWideLine&&(e.material.linewidth?o=e.material.linewidth:e.geometry.lineWidth&&(o=e.geometry.lineWidth));var s=o*o;u.getInverse(e.matrixWorld),d.copy(t.ray).applyMatrix4(u);var a=new g.Vector3,l=new g.Vector3;i instanceof g.BufferGeometry&&Object(m.enumMeshLines)(i,function(n,i,o,c,u){var h,f;d.distanceSqToSegment(n,i,l,a),a.applyMatrix4(e.matrixWorld),l.applyMatrix4(e.matrixWorld),f=a.distanceToSquared(l),f>s||(h=t.ray.origin.distanceTo(a),h<t.near||h>t.far||r.push({distance:h,point:a,face:{a:o,b:c},faceIndex:u,fragId:e.fragId,dbId:e.dbId,object:e}))})}}function s(e,t,r){n();var i=e.geometry;if(i){u.getInverse(e.matrixWorld),d.copy(t.ray).applyMatrix4(u);var o=t.precision,s=t.params.PointCloud.threshold;s||(s=1),s*=Math.max(3,i.pointSize),s/=4,i instanceof g.BufferGeometry&&Object(m.enumMeshVertices)(i,function(n,i,a,l){var c=d.distanceToPoint(n);if(!(c>s)){var u=d.closestPointToPoint(n);if(null!==u){u.applyMatrix4(e.matrixWorld);var h=t.ray.origin.distanceTo(u);o>h||h<t.near||h>t.far||r.push({distance:h,point:n,face:{a:l},faceIndex:l,fragId:e.fragId,dbId:e.dbId,object:e})}}})}}function a(e,t,r){e.isLine||e.isWideLine?o(e,t,r):e.isPoint?s(e,t,r):i(e,t,r)}function l(e,t,r,n){if(e instanceof g.Mesh?a(e,t,r):e.raycast(t,r),n===!0)for(var i=e.children,o=0,s=i.length;s>o;o++)l(i[o],t,r,!0)}function c(e,t,r,n){l(e,t,r,n),r.sort(v)}r.r(t),r.d(t,"VBIntersector",function(){return y});var u,d,h,f,p,m=r("./src/wgs/scene/VertexEnumerator.js"),g=r("./thirdparty/three.js/three.js"),v=(r.n(g),function(e,t){return e.distance-t.distance}),y={meshRayCast:i,lineRayCast:o,rayCast:a,intersectObject:c}},"./src/wgs/scene/VertexBufferReader.js":function(e,t,r){"use strict";function n(e){this.vb=e.vb.buffer,this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.vbs=new Uint16Array(this.vb),this.ib=e.ib,this.stride=e.vbstride,this.vcount=this.vbf.length/this.stride,this.useInstancing=e.numInstances>0,this.useCompactBuffers=e.unpackXform,this.texData=this.useCompactBuffers&&e.tIdColor&&e.tIdColor.image&&e.tIdColor.image.data&&new Uint32Array(e.tIdColor.image.data.buffer)}function i(e){this.bounds=e,this.point=new o.Vector4,this.point.z=0,this.point.w=1}r.r(t),r.d(t,"VertexBufferReader",function(){return n}),r.d(t,"BoundsCallback",function(){return i});var o=r("./thirdparty/three.js/three.js"),s=(r.n(o),2*Math.PI),a=0,l=1,c=2,u=3,d=4,h=5,f=6,p=7,m=8,g=9;n.prototype.getDbIdAt=function(e){return this.texData?this.texData[this.vbs[e*this.stride*2+p]]:this.vbi[e*this.stride+p]},n.prototype.getColorAt=function(e){return this.texData?this.texData[this.vbs[e*this.stride*2+f]]:this.vbi[e*this.stride+f]},n.prototype.getVertexFlagsAt=function(e){return this.texData?this.vbi[e*this.stride+4]:this.vbi[e*this.stride+m]},n.prototype.getLayerIndexAt=function(e){return this.texData?65535&this.vbi[e*this.stride+5]:65535&this.vbi[e*this.stride+g]},n.prototype.getViewportIndexAt=function(e){return this.texData?this.vbi[e*this.stride+5]>>16&65535:this.vbi[e*this.stride+g]>>16&65535},n.prototype.decodeLineAt=function(e,t,r,n){if(n.onLineSegment){if(this.useCompactBuffers)var i=this.stride*e*2,o=this.useCompactBuffers.x*this.vbs[i]/65535+this.useCompactBuffers.z,a=this.useCompactBuffers.y*this.vbs[i+1]/65535+this.useCompactBuffers.w,l=this.vbs[i+2]/65535*s-Math.PI,c=this.vbs[i+3]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y),u=this.vbs[i+4]/32767*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y)*2;else var d=this.stride*e,o=this.vbf[d],a=this.vbf[d+1],l=this.vbf[d+2]*s-Math.PI,c=this.vbf[d+3],u=2*this.vbf[d+4];var h=o+c*Math.cos(l),f=a+c*Math.sin(l);n.onLineSegment(o,a,h,f,r,u)}},n.prototype.decodeCircularArcAt=function(e,t,r,n){if(n.onCircularArc){if(this.useCompactBuffers)var i=this.stride*e*2,o=this.useCompactBuffers.x*this.vbs[i]/65535+this.useCompactBuffers.z,a=this.useCompactBuffers.y*this.vbs[i+1]/65535+this.useCompactBuffers.w,l=this.vbs[i+2]/65535*s,c=this.vbs[i+3]/65535*s,u=this.vbs[i+5]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y);else var d=this.stride*e,o=this.vbf[d],a=this.vbf[d+1],l=this.vbf[d+2]*s,c=this.vbf[d+3]*s,u=this.vbf[d+5];n.onCircularArc(o,a,l,c,u,r)}},n.prototype.decodeEllipticalArcAt=function(e,t,r,n){if(n.onEllipticalArc){var i=this.stride*e,o=this.vbf[i],a=this.vbf[i+1],l=this.vbf[i+2]*s,c=this.vbf[i+3]*s,u=this.vbf[i+5],d=this.vbf[i+10],h=this.vbf[i+11];n.onEllipticalArc(o,a,l,c,u,d,h,r)}},n.prototype.decodeTexQuadAt=function(e,t,r,n){if(n.onTexQuad){if(this.useCompactBuffers)var i=this.stride*e*2,o=this.useCompactBuffers.x*this.vbs[i]/65535+this.useCompactBuffers.z,a=this.useCompactBuffers.y*this.vbs[i+1]/65535+this.useCompactBuffers.w,l=this.vbs[i+2]/65535*s,c=this.vbs[i+3]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y),u=this.vbs[i+4]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y);else var d=this.stride*e,o=this.vbf[d],a=this.vbf[d+1],l=this.vbf[d+2]*s,c=this.vbf[d+3],u=this.vbf[d+4];n.onTexQuad(o,a,c,u,l,r)}},n.prototype.decodeOneTriangleAt=function(e,t,r,n){if(n.onOneTriangle){if(this.useCompactBuffers)var i=this.stride*e*2,o=this.useCompactBuffers.x*this.vbs[i]/65535+this.useCompactBuffers.z,s=this.useCompactBuffers.y*this.vbs[i+1]/65535+this.useCompactBuffers.w,a=this.useCompactBuffers.x*this.vbs[i+2]/65535+this.useCompactBuffers.z,l=this.useCompactBuffers.y*this.vbs[i+3]/65535+this.useCompactBuffers.w,c=this.useCompactBuffers.x*this.vbs[i+4]/65535+this.useCompactBuffers.z,u=this.useCompactBuffers.y*this.vbs[i+5]/65535+this.useCompactBuffers.w;else var d=this.stride*e,o=this.vbf[d],s=this.vbf[d+1],a=this.vbf[d+2],l=this.vbf[d+3],c=this.vbf[d+4],u=this.vbf[d+5];n.onOneTriangle(o,s,a,l,c,u,r)}},n.prototype.decodeTriangleIndexed=function(e,t,r,n,i,o){if(o.onOneTriangle){if(this.useCompactBuffers){var s=this.stride*e*2,a=this.useCompactBuffers.x*this.vbs[s]/65535+this.useCompactBuffers.z,l=this.useCompactBuffers.y*this.vbs[s+1]/65535+this.useCompactBuffers.w;s=this.stride*t*2;var c=this.useCompactBuffers.x*this.vbs[s]/65535+this.useCompactBuffers.z,u=this.useCompactBuffers.y*this.vbs[s+1]/65535+this.useCompactBuffers.w;s=this.stride*r*2;var d=this.useCompactBuffers.x*this.vbs[s]/65535+this.useCompactBuffers.z,h=this.useCompactBuffers.y*this.vbs[s+1]/65535+this.useCompactBuffers.w}else{var f=this.stride*e,a=this.vbf[f],l=this.vbf[f+1];f=this.stride*t;var c=this.vbf[f],u=this.vbf[f+1];f=this.stride*r;var d=this.vbf[f],h=this.vbf[f+1]}o.onOneTriangle(a,l,c,u,d,h,i)}},n.prototype.enumGeomsForObject=function(e,t){if(this.useInstancing)for(var r=0;r<this.vcount;){var n=this.getVertexFlagsAt(r),i=n>>8&255,o=this.getLayerIndexAt(r),s=this.getViewportIndexAt(r),f=this.getDbIdAt(r)===e;if(f)switch(i){case l:this.decodeLineAt(r,o,s,t);break;case c:this.decodeCircularArcAt(r,o,s,t);break;case u:this.decodeEllipticalArcAt(r,o,s,t);break;case d:this.decodeTexQuadAt(r,o,s,t);break;case h:this.decodeOneTriangleAt(r,o,s,t)}r+=1}else for(var r=0;r<this.ib.length;){var p=this.ib[r],n=this.getVertexFlagsAt(p),i=n>>8&255,o=this.getLayerIndexAt(p),s=this.getViewportIndexAt(p),f=this.getDbIdAt(p)===e;if(i===a)f&&this.decodeTriangleIndexed(this.ib[r],this.ib[r+1],this.ib[r+2],o,s,t),r+=3;else{if(f)switch(i){case l:this.decodeLineAt(p,o,s,t);break;case c:this.decodeCircularArcAt(p,o,s,t);break;case u:this.decodeEllipticalArcAt(p,o,s,t);break;case d:this.decodeTexQuadAt(p,o,s,t);break;case h:this.decodeOneTriangleAt(p,o,s,t)}r+=6}}},n.prototype.enumGeomsForVisibleLayer=function(e,t){var r=function(t,r,n){return!e||0!==r&&-1!==e.indexOf(r)};this.enumGeoms(r,t)},n.prototype.enumGeoms=function(e,t){if(this.useInstancing)for(var r=0;r<this.vcount;){var n=this.getVertexFlagsAt(r),i=n>>8&255,o=this.getLayerIndexAt(r),s=this.getViewportIndexAt(r),f=this.getDbIdAt(r),p=!e||e(f,o,s);if(p)switch(i){case l:this.decodeLineAt(r,o,s,t);break;case c:this.decodeCircularArcAt(r,o,s,t);break;case u:this.decodeEllipticalArcAt(r,o,s,t);break;case d:this.decodeTexQuadAt(r,o,s,t);break;case h:this.decodeOneTriangleAt(r,o,s,t)}r+=1}else for(var r=0;r<this.ib.length;){var m=this.ib[r],n=this.getVertexFlagsAt(m),i=n>>8&255,o=this.getLayerIndexAt(m),s=this.getViewportIndexAt(m),f=this.getDbIdAt(m),p=!e||e(f,o,s);if(i===a)p&&this.decodeTriangleIndexed(this.ib[r],this.ib[r+1],this.ib[r+2],o,s,t),r+=3;else{if(p)switch(i){case l:this.decodeLineAt(m,o,s,t);break;case c:this.decodeCircularArcAt(m,o,s,t);break;case u:this.decodeEllipticalArcAt(m,o,s,t);break;case d:this.decodeTexQuadAt(m,o,s,t);break;case h:this.decodeOneTriangleAt(m,o,s,t)}r+=6}}},i.prototype.onVertex=function(e,t,r){this.point.x=e,this.point.y=t,this.bounds.expandByPoint(this.point)},i.prototype.onLineSegment=function(e,t,r,n,i){this.onVertex(e,t),this.onVertex(r,n)},i.prototype.onCircularArc=function(e,t,r,n,i,o){this.onEllipticalArc(e,t,r,n,i,i,0,o)},i.prototype.onEllipticalArc=function(e,t,r,n,i,o,s,a){0==s?0>=r&&n>=2*Math.PI-1e-5?this.onTexQuad(e,t,2*i,2*o,s,a):(this.point.x=e+Math.cos(r)*i,this.point.y=t+Math.sin(r)*o,this.bounds.expandByPoint(this.point),this.point.x=e+Math.cos(n)*i,this.point.y=t+Math.sin(n)*o,this.bounds.expandByPoint(this.point),r>n&&(this.point.x=e+i,this.point.y=t,this.bounds.expandByPoint(this.point),r-=2*Math.PI),r<.5*Math.PI&&n>.5*Math.PI&&(this.point.x=e,this.point.y=t+o,this.bounds.expandByPoint(this.point)),r<Math.PI&&n>Math.PI&&(this.point.x=e-i,this.point.y=t,this.bounds.expandByPoint(this.point)),r<1.5*Math.PI&&n>1.5*Math.PI&&(this.point.x=e,this.point.y=t-o,this.bounds.expandByPoint(this.point))):this.onTexQuad(e,t,2*i,2*o,s,a)},i.prototype.onTexQuad=function(e,t,r,n,i,s){var a=.5*r,l=.5*r;if(0==i)this.onVertex(e-a,t-l),this.onVertex(e+a,t+l);else{var c=new o.Matrix4,u=new o.Matrix4;c.makeRotationZ(i),u.makeTranslation(e,t,0),u.multiply(c);for(var d=0;4>d;d++)this.point.x=d%2==1?a:-a,this.point.y=d>=2?l:-l,this.point.applyMatrix4(u),this.bounds.expandByPoint(this.point)}},i.prototype.onOneTriangle=function(e,t,r,n,i,o,s){this.onVertex(e,t),this.onVertex(r,n),this.onVertex(i,o)}},"./src/wgs/scene/VertexEnumerator.js":function(e,t,r){"use strict";function n(e){return e.vb?e.vb.length/e.vbstride:e.attributes.position?e.attributes.position.length:0}function i(e,t,r){var n=e.attributes;c||(c=new x.LmvVector3,u=new x.LmvVector3,d=new x.LmvVector3),r&&(h||(h=new THREE.Matrix3),h.getNormalMatrix(r));var i,o=e.vb||n.position.array,s=e.vb||n.normal&&n.normal.array,a=e.vb?e.vbstride:3;if(e.vblayout){if(!e.vblayout.position)return;i=e.vblayout.position.offset}else{if(!n.position)return;i=n.position.itemOffset||0}var l=0,f=e.vblayout?e.vblayout.normal:n.normal||null;f?l=f.offset||f.itemOffset||0:s=null,!f||3===f.itemSize&&4===f.bytesPerItem||(s=null);for(var p=e.vb?e.vb.length/e.vbstride:o.length/a,m=i,g=l,v=0;p>v;v++,m+=a,g+=a)c.set(o[m],o[m+1],o[m+2]),r&&c.applyMatrix4(r),s&&(u.set(s[g],s[g+1],s[g+2]),r&&u.applyMatrix3(h)),t(c,s?u:null,null,v)}function o(e,t){var r=e.ib||e.indices||(attributes.index?attributes.index.array:null);if(r){var n=e.offsets;n&&0!==n.length||(n=[{start:0,count:r.length,index:0}]);for(var i=0,o=n.length;o>i;++i)for(var s=n[i].start,a=n[i].count,l=n[i].index,c=s,u=s+a;u>c;c+=3){var d=l+r[c],h=l+r[c+1],f=l+r[c+2];t(d,h,f)}}else for(var p=e.vb||attributes.position.array,m=e.vb?e.vb.length/e.vbstride:p.length/3,g=0;m>g;g++){var v=3*g,y=3*g+1,_=3*g+2;t(v,y,_)}}function s(e,t){var r,n,i,o=e.attributes;f||(f=new x.LmvVector3,p=new x.LmvVector3,m=new x.LmvVector3,g=new x.LmvVector3,v=new x.LmvVector3,y=new x.LmvVector3);var s,a=e.vb||o.position.array,l=e.vb||o.normal&&o.normal.array,c=e.vb?e.vbstride:3;if(e.vblayout){if(!e.vblayout.position)return;s=e.vblayout.position.offset}else{if(!o.position)return;s=o.position.itemOffset||0}var u=0,d=e.vblayout?e.vblayout.normal:o.normal||null;d?u=d.offset||d.itemOffset||0:l=null,!d||3===d.itemSize&&4===d.bytesPerItem||(l=null);var h=e.ib||e.indices||(o.index?o.index.array:null);if(h){var _=e.offsets;_&&0!==_.length||(_=[{start:0,count:h.length,index:0}]);for(var b=0,w=_.length;w>b;++b)for(var E=_[b].start,S=_[b].count,A=_[b].index,M=E,T=E+S;T>M;M+=3){r=A+h[M],n=A+h[M+1],i=A+h[M+2];var C=r*c+s,j=n*c+s,P=i*c+s;if(f.x=a[C],f.y=a[C+1],f.z=a[C+2],p.x=a[j],p.y=a[j+1],p.z=a[j+2],m.x=a[P],m.y=a[P+1],m.z=a[P+2],l){var L=r*c+u,D=n*c+u,I=i*c+u;g.x=l[L],g.y=l[L+1],g.z=l[L+2],v.x=l[D],v.y=l[D+1],v.z=l[D+2],y.x=l[I],y.y=l[I+1],y.z=l[I+2],t(f,p,m,r,n,i,g,v,y,M/3)}else t(f,p,m,r,n,i,null,null,null,M/3)}}else for(var R=e.vb?e.vb.length/e.vbstride:a.length/3,M=0;R>M;M+=3){r=M,n=M+1,i=M+2;var C=r*c+s,j=n*c+s,P=i*c+s;if(f.x=a[C],f.y=a[C+1],f.z=a[C+2],p.x=a[j],p.y=a[j+1],p.z=a[j+2],m.x=a[P],m.y=a[P+1],m.z=a[P+2],l){var L=r*c+u,D=n*c+u,I=i*c+u;g.x=l[L],g.y=l[L+1],g.z=l[L+2],v.x=l[D],v.y=l[D+1],v.z=l[D+2],y.x=l[I],y.y=l[I+1],y.z=l[I+2],t(f,p,m,r,n,i,g,v,y,M/3)}else t(f,p,m,r,n,i,null,null,null,M/3)}}function a(e,t){var r,n,i=e.attributes;_||(_=new x.LmvVector3,b=new x.LmvVector3);var o=2;e.lineWidth&&(o=6);var s=e.ib||e.indices||(i.index?i.index.array:null);if(s){var a=e.vb?e.vb:i.position.array,l=e.vb?e.vbstride:3,c=e.offsets;c&&0!==c.length||(c=[{start:0,count:s.length,index:0}]);for(var u=0,d=c.length;d>u;++u)for(var h=c[u].start,f=c[u].count,p=c[u].index,m=h,g=h+f,v=h/o;g>m;m+=o,v++)r=p+s[m],n=p+s[m+1],_.x=a[r*l],_.y=a[r*l+1],_.z=a[r*l+2],b.x=a[n*l],b.y=a[n*l+1],b.z=a[n*l+2],t(_,b,r,n,v)}else for(var a=e.vb?e.vb:i.position.array,l=e.vb?e.vbstride:3,m=0,g=a.length/l,v=0;g>m;m+=o,v++)r=m,n=m+1,_.x=a[r*l],_.y=a[r*l+1],_.z=a[r*l+2],b.x=a[n*l],b.y=a[n*l+1],b.z=a[n*l+2],t(_,b,r,n,v)}function l(e,t){var r,n,i=e.attributes;_||(_=new x.LmvVector3,b=new x.LmvVector3);var o=2,s=e.iblines;if(s){var a=e.vb?e.vb:i.position.array,l=e.vb?e.vbstride:3,c=e.offsets;c&&0!==c.length||(c=[{start:0,count:s.length,index:0}]);for(var u=0,d=c.length;d>u;++u)for(var h=c[u].start,f=c[u].count,p=c[u].index,m=h,g=h+f;g>m;m+=o)r=p+s[m],n=p+s[m+1],_.x=a[r*l],_.y=a[r*l+1],_.z=a[r*l+2],b.x=a[n*l],b.y=a[n*l+1],b.z=a[n*l+2],t(_,b,r,n)}}r.r(t),r.d(t,"getVertexCount",function(){return n}),r.d(t,"enumMeshVertices",function(){return i}),r.d(t,"enumMeshIndices",function(){return o}),r.d(t,"enumMeshTriangles",function(){return s}),r.d(t,"enumMeshLines",function(){return a}),r.d(t,"enumMeshEdges",function(){return l}),r.d(t,"VertexEnumerator",function(){return w});var c,u,d,h,f,p,m,g,v,y,_,b,x=r("./src/wgs/scene/LmvVector3.js"),w={getVertexCount:n,enumMeshVertices:i,enumMeshIndices:o,enumMeshTriangles:s,enumMeshLines:a,enumMeshEdges:l}},"./src/wgs/scene/consolidation/Consolidation.js":function(e,t,r){"use strict";function n(e){return e.isLines?M.LINES:e.isPoints?M.POINTS:e.isWideLines?M.WIDE_LINES:M.TRIANGLES}function i(e,t){switch(e.isLines===!0&&(e.isLines=void 0),e.isWideLines===!0&&(e.isWideLines=void 0),e.isPoints===!0&&(e.isPoints=void 0),t){case M.LINES:e.isLines=!0;break;case M.WIDE_LINES:e.isWideLines=!0;break;case M.POINTS:e.isPoints=!0}}function o(e,t){switch(t){case R:return(e&P)===L;case O:return(e&D)===I}return(e&C)==j}function s(e){this.geoms=[],this.matrices=[],this.vertexCount=0,this.material=e,this.fragIds=[],this.worldBox=new v.Box3}function a(e,t){e.vb&&e.vbstride||x.logger.warn("copyVertexFormat() supports only interleaved buffers");for(var r in e.attributes)t.attributes[r]=e.attributes[r];t.attributesKeys=e.attributesKeys.slice(0),t.vbstride=e.vbstride}function l(e,t){var r=n(e);i(t,r),t.lineWidth=e.lineWidth,t.pointSize=e.pointSize}function c(e){for(var t=e[0].vbstride,r=0,o=0,s=0,c=0;c<e.length;c++){var u=e[c];r+=e[c].ib.length,o+=Object(y.getVertexCount)(u),e[c].iblines&&(s+=e[c].iblines.length)}var d=Object(_.createBufferGeometry)();d.vb=new Float32Array(o*t),d.ib=new Uint16Array(r),s&&(d.iblines=new Uint16Array(s)),d.byteSize=d.vb.byteLength+d.ib.byteLength,d.iblines&&(d.byteSize+=d.iblines.byteLength),l(e[0],d),a(e[0],d);var h=3,f=new v.BufferAttribute(null,h);f.normalize=!0,f.bytesPerItem=1,d.addAttribute("id",f);var p=e[0],m=n(p);return i(d,m),p.isPoints&&(d=p.pointSize),p.isWideLines&&(d=p.lineWidth),d}function u(e,t){for(var r=0,n=0,i=0,o=0,s=0;s<e.length;s++){for(var a=e[s],l=Object(y.getVertexCount)(a),c=0;c<a.ib.length;c++)t.ib[i+c]=a.ib[c]+n;if(a.iblines){for(var c=0;c<a.iblines.length;c++)t.iblines[o+c]=a.iblines[c]+n;o+=a.iblines.length}t.vb.set(a.vb,r),r+=a.vb.length,n+=l,i+=a.ib.length}}function d(e,t,r,n,i){var o=c(e);return o.boundingBox=n.clone(),u(e,o),i?i.addMergeTask(e,o,t,r):Object(b.runMergeSingleThreaded)(e,o,t,r),o}function h(e,t){if(e.vbstride!=t.vbstride)return!1;var r=n(e),i=n(t);if(r!==i)return!1;if(e.isPoints&&e.pointSize!==t.pointSize)return!1;if(e.isWideLines&&e.lineWidth!==t.lineWidth)return!1;if(e.attributesKeys.length!=t.attributesKeys.length)return!1;for(var o=0,s=e.attributesKeys.length;s>o;o++){var a=e.attributesKeys[o],l=e.attributes[a],c=t.attributes[a];if(!c)return!1;if(l!==c&&(l.itemOffset!==c.itemOffset||l.normalize!==c.normalize||l.itemSize!==c.itemSize||l.bytesPerItem!==c.bytesPerItem||l.isPattern!==c.isPattern))return!1}return!0}function f(e){this.meshes=[],this.fragId2MeshIndex=new Int32Array(e);for(var t=0;t<this.fragId2MeshIndex.length;t++)this.fragId2MeshIndex[t]=-1;this.byteSize=0,this.consolidationMap=null}function p(){this.buckets={},this.bucketCount=0,this.costs=0}function m(e,t){this.fragOrder=new Uint32Array(e),this.ranges=new Uint32Array(t),this.boxes=new Array(t),this.numConsolidated=-1;
}function g(){return!!b.ParallelGeomMerge.createWorker}r.r(t),r.d(t,"isVisible",function(){return o}),r.d(t,"copyVertexFormat",function(){return a}),r.d(t,"copyPrimitiveProps",function(){return l}),r.d(t,"mergeGeometries",function(){return d}),r.d(t,"Consolidation",function(){return f}),r.d(t,"ConsolidationBuilder",function(){return p});var v=r("./thirdparty/three.js/three.js"),y=(r.n(v),r("./src/wgs/scene/VertexEnumerator.js")),_=r("./src/wgs/scene/BufferGeometry.js"),b=r("./src/wgs/scene/consolidation/ParallelGeomMerge.js"),x=r("./src/logger/Logger.js"),w=r("./src/wgs/render/MaterialManager.js"),E=r("./src/wgs/scene/MeshFlags.js"),S=r("./src/wgs/scene/RenderFlags.js"),A=65535,M={UNKNOWN:0,TRIANGLES:1,LINES:2,WIDE_LINES:3,POINTS:4},T=E.MeshFlags.MESH_HIGHLIGHTED,C=E.MeshFlags.MESH_VISIBLE|E.MeshFlags.MESH_HIDE|T,j=E.MeshFlags.MESH_VISIBLE,P=E.MeshFlags.MESH_VISIBLE|E.MeshFlags.MESH_HIDE,L=0,D=E.MeshFlags.MESH_HIGHLIGHTED|E.MeshFlags.MESH_HIDE,I=E.MeshFlags.MESH_HIGHLIGHTED,R=S.RenderFlags.RENDER_HIDDEN,O=S.RenderFlags.RENDER_HIGHLIGHTED;s.prototype={constructor:s,addGeom:function(e,t,r){this.geoms.push(e),this.fragIds.push(r),this.worldBox.union(t),this.vertexCount+=Object(y.getVertexCount)(e);var n=this.geoms.length;return 1==n?0:(void 0===e.byteSize&&x.logger.warn("Error in consolidation: Geometry must contain byteSize."),e.byteSize+(2==n?this.geoms[0].byteSize:0))}},f.prototype={constructor:f,addContainerMesh:function(e,t,r,n,i){var o=new v.Mesh(e,t);this.meshes.push(o),this.byteSize+=e.byteSize;var s=n||0,a=i||r.length,l=s+a;o.frustumCulled=!1;for(var c=this.meshes.length-1,u=s;l>u;u++){var d=r[u];this.fragId2MeshIndex[d]=c}},addSingleMesh:function(e,t,r,n,i){var o=new v.Mesh(e,t);o.matrix.copy(n),o.matrixAutoUpdate=!1,o.dbId=i,o.fragId=r,this.meshes.push(o),o.frustumCulled=!1,this.fragId2MeshIndex[r]=this.meshes.length-1},addSingleFragment:function(e,t){var r=e.getVizmesh(t);this.addSingleMesh(r.geometry,r.material,t,r.matrixWorld,r.dbId)},applyAttributes:function(e,t,r,n){function i(){if(y){d.drawcalls=d.offsets=d.offsets||[];var e=d.offsets[S]||{index:0};d.offsets[S++]=e,m?(e.start=0,e.count=d.ib.length,d.iblines&&(e.edgeStart=0,e.edgeCount=d.iblines.length),e.instanceStart=b,e.numInstances=x-b):(e.start=b,e.count=x-b,d.iblines&&(e.edgeStart=w,e.edgeCount=E-w)),e.themingColor=_}}function s(){0===b?(u.themingColor=_,u.visible=y):(u.visible=!0,i()),d.offsets&&(d.offsets.length=S)}var a,l,c,u=this.meshes[e],d=u.geometry,h=t.vizflags,f=this.consolidationMap,p=f.fragOrder,m=d.numInstances,g=t.db2ThemingColor,v=g.length>0||void 0;if(m?(a=u.rangeStart,l=a+u.geometry.numInstances):d.attributes.id?(a=f.ranges[e],l=e+1>=f.ranges.length?f.numConsolidated:f.ranges[e+1]):c=u.fragId,!n||void 0!==c)return d.offsets&&void 0===c&&(d.offsets=d.drawcalls=void 0),u.visible=o(h[void 0===c?p[a]:c],r),u.themingColor=v&&g[t.fragments.fragId2dbId[c]],u;for(var y,_,b=0,x=0,w=0,E=0,S=0,A=a;l>A;++A){var c=p[A],M=o(h[c],r),T=v&&t.db2ThemingColor[t.fragments.fragId2dbId[c]];if((M!==y||M&&T!==_)&&(x>b&&i(),b=x,w=E,y=M,_=T),m)x+=1;else{var C=t.getGeometry(c);x+=C.ib.length,C.iblines&&(E+=C.iblines.length)}}return s(),u}},p.prototype={addGeom:function(e,t,r,n){var i=null,o=this.buckets[t.id];if(o)for(var a=0;a<o.length;a++){var l=o[a],c=l.geoms[0];if(h(c,e)){var u=Object(y.getVertexCount)(e);if(!(u+l.vertexCount>A)){i=l;break}}}i||(i=new s(t),this.bucketCount++,this.buckets[t.id]?this.buckets[t.id].push(i):this.buckets[t.id]=[i]),this.costs+=i.addGeom(e,r,n)},createConsolidationMap:function(e,t){var r=e.length,n=new m(r,this.bucketCount),i=0,o=0;for(var s in this.buckets)for(var a=this.buckets[s],l=0;l<a.length;l++){var c=a[l];n.ranges[o]=i,n.boxes[o]=c.worldBox,n.fragOrder.set(c.fragIds,i),i+=c.fragIds.length,o++}n.numConsolidated=t;for(var u=t;u<e.length;u++)n.fragOrder[u]=e[u];return n}},m.prototype={buildConsolidation:function(e,t,r){var n=this.fragOrder,i=e.getCount(),o=this.ranges.length,s=new f(i),a=null;g()&&(a=new b.ParallelGeomMerge(s));for(var l=[],c=new v.Matrix4,u=0;o>u;u++){var h=this.ranges[u],p=u===o-1?this.numConsolidated:this.ranges[u+1],m=p-h;if(1!==m){l.length=m;for(var y=new Float32Array(16*m),_=new Uint32Array(m),x=0;m>x;x++)C=n[h+x],l[x]=e.getGeometry(C),e.getOriginalWorldMatrix(C,c),y.set(c.elements,16*x),_[x]=e.getDbIds(C);var E=this.boxes[u],S=n[h],A=e.getMaterial(S),M=d(l,y,_,E,a),T=t.getMaterialVariant(A,w.MATERIAL_VARIANT.VERTEX_IDS,r);s.addContainerMesh(M,T,n,h,m)}else{var C=n[h];s.addSingleFragment(e,C,s)}}return a&&a.runTasks(),s.consolidationMap=this,s}},f.applyBVHDefaults=function(e){e.frags_per_leaf_node=512,e.max_polys_per_node=1e5},f.getDefaultBVHOptions=function(){var e={};return f.applyBVHDefaults(e),e}},"./src/wgs/scene/consolidation/ConsolidationIterator.js":function(e,t,r){"use strict";function n(e,t){function r(e){var t=d.matrix;t?(e.matrixWorld.copy(t),e.matrixAutoUpdate=!1):e.matrixWorld.identity()}function n(e){m[e]||(m[e]=new s.Scene,r(m[e]));var t=m[e];return t.children.length=0,t}function c(e){return e.numInstances?_.Instanced:e.attributes.id?_.Merged:_.Original}function u(e){if(p)return _.Original;var t=h.fragId2MeshIndex[e],r=h.meshes[t],n=r.geometry;return c(n)}var d=e,h=t,f=[],p=!1,m=[],g=[],v=new s.Matrix4,y=new s.Box3;this.modelMatrixChanged=function(){for(var e=h.meshes,t=0;t<m.length;t++){var n=m[t];n&&r(n)}for(var i=0;i<e.length;i++)e[i].matrixWorldNeedsUpdate=!0},this.getConsolidation=function(){return h},this.reset=function(){f.length=null,g.length=0;var e=d.getCount(),t=a.MeshFlags.MESH_MOVED,r=a.MeshFlags.MESH_VISIBLE,n=r|a.MeshFlags.MESH_HIDE|a.MeshFlags.MESH_HIGHLIGHTED,i=d.vizflags,o=h.fragId2MeshIndex;h.meshes;p=!1;for(var s=d.db2ThemingColor.length>0,l=0;e>l;l++){var c=i[l];if(c&t){p=!0;break}var u;if(s){var m=d.fragments.fragId2dbId[l];u=d.db2ThemingColor[m]}var v=o[l];g[v]=g[v]||!!(u||c&n^r)}},this.dispose=function(){for(var e={type:"dispose"},t={type:"removed"},r=0;r<h.meshes.length;r++){var n=h.meshes[r],i=n.geometry;i&&(n.dispatchEvent(t),i.dispatchEvent(e),i.needsUpdate=!0)}},this.consolidateNextBatch=function(e,t,r){var i=e.nodeIndex;if(p||void 0===i)return e;if(h.inProgress)return e;for(var o=n(i),a=e.start;a<e.lastItem;a++){var c=e.indices?e.indices[a]:a,u=h.fragId2MeshIndex[c],m=null;if(-1===u){if(!d.getGeometry(c))continue;return l.logger.warn("Warning: Missing fragment in consolidation. Consolidation disabled."),e}if(!f[u]&&(d.getWorldBounds(c,y),t.intersectsBox(y)&&(f[u]=!0,m=h.applyAttributes(u,d,r,g[u]),m.visible))){var v=m&&m.geometry,_=v&&(v.isLines||v.isWideLines),b=v&&v.isPoints,x=d.linesHidden&&_||d.pointsHidden&&b;x||o.add(m)}}return o.boundingBox||(o.boundingBox=new s.Box3),e.getBoundingBox(o.boundingBox),o.renderImportance=e.renderImportance,o.sortObjects=e.sortObjects,o};var _={Merged:1,Instanced:2,Original:3};this.updateRenderProxy=function(e,t){if(e.geometry&&e.geometry.attributes){var r=u(t),n=c(e.geometry);if(e.needsUpdate||n!=r){var s=d.getGeometry(t),a=h.fragId2MeshIndex[t],l=h.meshes[a];if(r===_.Original)e.geometry=s,e.material=d.getMaterial(t),d.getWorldMatrix(t,e.matrix);else if(r===_.Instanced){d.getWorldMatrix(t,v);var f=d.fragments.fragId2dbId[t],p=new o.InstanceBufferBuilder(s,1);p.addInstance(v,f),e.geometry=p.finish(),e.material=l.material,e.matrix.identity()}else d.getWorldMatrix(t,v),d.getWorldBounds(t,y),f=d.fragments.fragId2dbId[t],e.geometry=Object(i.mergeGeometries)([s],v.elements,[f],y),e.material=l.material,e.matrix.identity();e.needsUpdate=!1,e.dispatchEvent({type:"removed"})}}}}r.r(t),r.d(t,"ConsolidationIterator",function(){return n});var i=r("./src/wgs/scene/consolidation/Consolidation.js"),o=r("./src/wgs/scene/consolidation/InstanceBufferBuilder.js"),s=r("./thirdparty/three.js/three.js"),a=(r.n(s),r("./src/wgs/scene/MeshFlags.js")),l=r("./src/logger/Logger.js")},"./src/wgs/scene/consolidation/FragmentListConsolidation.js":function(e,t,r){"use strict";function n(e,t,r,n){for(var i=new h.Box3,o=new c.ConsolidationBuilder,s=0;s<r.length&&!(o.costs>=n);s++){var a=r[s];e.getWorldBounds(a,i);var l=e.getGeometry(a),u=e.getMaterial(a);o.addGeom(l,u,i,a)}return o.createConsolidationMap(r,s)}function i(e,t,r,n,i){var o=e.getFragmentList();if(!(n>=r.length)){for(var s=n,a=-1,l=-1,c=n;c<r.length;c++){var u=r[c],d=o.getGeometryId(u),h=o.getMaterialId(u);(d!=a||h!=l)&&(c!=n&&f(e,t,r,s,c,i),s=c,a=d,l=h)}f(e,t,r,s,r.length,i)}}function o(e){for(var t=e.getCount(),r=[],n=0;t>n;n++){var i=e.getGeometryId(n),o=0|r[i];r[i]=o+1}return r}function s(e,t){function r(r,n){var i=e.getGeometry(r),o=e.getGeometry(n),s=e.getGeometryId(r),a=e.getGeometryId(n),l=t[s],c=t[a],u=l*i.byteSize,d=c*o.byteSize;if(u!=d)return u-d;if(i.id!=o.id)return i.id-o.id;var h=e.getMaterialId(r),f=e.getMaterialId(n);return h-f}for(var n=0,i=e.getCount(),o=new Int32Array(i),s=0;i>s;s++)e.getGeometry(s)&&(o[n]=s,n++);if(i>n&&(o=new Int32Array(o.buffer,o.byteOffset,n)),o.sort)o.sort(r);else{var a=new Array(i);for(s=0;i>s;s++)a[s]=o[s];for(a.sort(r),s=0;s<o.length;s++)o[s]=a[s]}return o}function a(e,t,r,n){for(var i=e.geoms,o=[],s=0,a=0,l=0;l<t.meshes.length;l++){var c=t.meshes[l],u=c.geometry;u.byteSize||(u.byteSize=(u.vb.byteLength||0)+(u.ib.byteLength||0));var d=Number.isInteger(c.fragId);i.chooseMemoryType(u,u.numInstances,s,a),u.streamingDraw||(a+=u.byteSize,s+=1,d||(u.discardAfterUpload=!0)),d&&(o[u.id]=!0)}for(l=1;l<i.geoms.length;l++)if(u=i.geoms[l],u&&!o[l]){var h=r[l];i.chooseMemoryType(u,h,s,a),u.streamingDraw&&n.deallocateGeometry(u),u.streamingDraw||(a+=u.byteSize,s+=1)}}function l(e,t,r,l,c){var u=e.getFragmentList(),d=l.supportsInstancedArrays();r=r||100<<20;var h=o(u);if(!c){var f=s(u,h);c=n(u,t,f,r)}var p=c.buildConsolidation(u,t,e),m=c.fragOrder,g=c.numConsolidated;if(d)i(e,t,m,g,p);else for(var v=g;v<m.length;v++){var y=m[v];p.addSingleFragment(u,y)}a(u,p,h,l);var _=e.getModelId();for(v=0;v<p.meshes.length;v++){var b=p.meshes[v];b.modelId=_}return p}r.r(t),r.d(t,"consolidateFragmentList",function(){return l});var c=r("./src/wgs/scene/consolidation/Consolidation.js"),u=r("./src/wgs/scene/consolidation/InstanceBufferBuilder.js"),d=r("./src/wgs/render/MaterialManager.js"),h=r("./thirdparty/three.js/three.js"),f=(r.n(h),function(){var e=null;return function(t,r,n,i,o,s){var a=t.getFragmentList();e||(e=new h.Matrix4);var l=n[i],c=a.getGeometry(l),f=a.getMaterial(l),p=o-i;if(1==p)return void s.addSingleFragment(a,l);for(var m=o-1,g=new u.InstanceBufferBuilder(c,p),v=i;m>=v;v++){var y=n[v];a.getOriginalWorldMatrix(y,e);var _=a.fragments.fragId2dbId[y],b=g.addInstance(e,_);if(!b){var x=n[m];n[m]=y,n[v]=x,--v,--m}}var w=g.finish();if(w){var E=r.getMaterialVariant(f,d.MATERIAL_VARIANT.INSTANCED,t);s.addContainerMesh(w,E,n,i,p),s.meshes[s.meshes.length-1].rangeStart=i}for(v=m+1;o>v;v++)y=n[v],s.addSingleFragment(a,y)}}())},"./src/wgs/scene/consolidation/GeomMergeTask.js":function(e,t,r){"use strict";function n(){return u++}function i(){this.vb=null,this.vbstride=0,this.posOffset=0,this.normalOffset=0,this.matrices=null,this.ranges=null,this.dbIds=null,this.id=n()}function o(e){e.x=.5*(1+Math.atan2(e.y,e.x)/Math.PI),e.y=.5*(1+e.z),e.z=0}function s(e){var t=2*e.x-1,r=2*e.y-1,n=Math.sin(t*Math.PI),i=Math.cos(t*Math.PI),o=Math.sqrt(1-r*r),s=r;e.x=i*o,e.y=n*o,e.z=s}function a(e,t,r){t[r++]=255&e,t[r++]=e>>8&255,t[r++]=e>>16&255,t[r]=0}function l(e,t){return t.copy(e),t[12]=0,t[13]=0,t[14]=0,t.getInverse(t).transpose()}function c(e,t,r){for(var n=16*e,i=0;16>i;i++)r.elements[i]=t[i+n]}r.r(t),r.d(t,"GeomMergeTask",function(){return i}),r.d(t,"writeIdToBuffer",function(){return a});var u=1,d=function(e,t,r,n,i,a,c){for(var u=e.posOffset,d=n;i>d;d++){var h=d*e.vbstride+u;c.set(e.vb[h],e.vb[h+1],e.vb[h+2]),c.applyMatrix4(r),e.vb[h]=c.x,e.vb[h+1]=c.y,e.vb[h+2]=c.z}if(-1!==e.normalOffset){var f=2*e.vbstride,p=2*e.normalOffset,m=65535,g=l(r,a);for(d=n;i>d;d++){var v=d*f+p;c.set(t[v],t[v+1],0),c.divideScalar(m),s(c),c.applyMatrix4(g),c.normalize(),o(c),c.multiplyScalar(m),t[v]=c.x,t[v+1]=c.y}}};i.prototype.run=function(e,t){for(var r=this.vb,n=r.length/this.vbstride,i=e.clone(),o=3,s=new Uint8Array(o*n),l=-1!==this.normalOffset,u=l?new Uint16Array(r.buffer,r.byteOffset,2*r.length):null,h=this.ranges,f=this.matrices,p=h.length-1,m=0;p>m;m++){var g=h[m],v=h[m+1];c(m,f,e),d(this,u,e,g,v,i,t);for(var y=g*o,_=v-g,b=this.dbIds[m],x=0;_>x;x++)a(b,s,y),y+=o}return{taskId:this.id,vb:this.vb,vertexIds:s}}},"./src/wgs/scene/consolidation/InstanceBufferBuilder.js":function(e,t,r){"use strict";function n(e,t){function r(e,t,r,n){p.compose(t,r,n);for(var i=1e-5,o=e.elements,s=p.elements,a=0;16>a;a++){var l=o[a],c=s[a];if(Math.abs(c-l)>i)return!1}return!0}var n=Object(s.createBufferGeometry)();n.ib=e.ib,n.vb=e.vb,n.iblines=e.iblines,Object(i.copyVertexFormat)(e,n),Object(i.copyPrimitiveProps)(e,n);var c=3,u=3;this.offsets=new Float32Array(3*t),this.rotations=new Float32Array(4*t),this.scalings=new Float32Array(3*t),this.ids=new Uint8Array(u*t);var d=new l.Vector3,h=new l.Quaternion,f=new l.Vector3,p=new l.Matrix4,m=0,g=t;this.addInstance=function(e,t){return m>=g?(a.logger.warn("Instance buffer is already full."),!1):(e.decompose(d,h,f),r(e,d,h,f)?(this.offsets[3*m]=d.x,this.offsets[3*m+1]=d.y,this.offsets[3*m+2]=d.z,this.rotations[4*m]=h.x,this.rotations[4*m+1]=h.y,this.rotations[4*m+2]=h.z,this.rotations[4*m+3]=h.w,this.scalings[u*m]=f.x,this.scalings[u*m+1]=f.y,this.scalings[u*m+2]=f.z,Object(o.writeIdToBuffer)(t,this.ids,u*m),m++,!0):!1)},this.finish=function(){if(0==m)return null;g>m&&(this.offsets=new Float32Array(this.offsets.buffer,0,3*m),this.rotations=new Float32Array(this.rotations.buffer,0,4*m),this.scalings=new Float32Array(this.scalings.buffer,0,3*m),this.ids=new Uint8Array(this.ids.buffer,0,u*m));var e=new l.BufferAttribute(this.offsets,3),t=new l.BufferAttribute(this.rotations,4),r=new l.BufferAttribute(this.scalings,3),i=new l.BufferAttribute(this.ids,c);return i.normalize=!0,i.bytesPerItem=1,e.divisor=1,t.divisor=1,r.divisor=1,i.divisor=1,n.addAttribute("instOffset",e),n.addAttribute("instRotation",t),n.addAttribute("instScaling",r),n.addAttribute("id",i),n.numInstances=m,n.byteSize=n.vb.byteLength+n.ib.byteLength+this.offsets.byteLength+this.rotations.byteLength+this.scalings.byteLength,n}}r.r(t),r.d(t,"InstanceBufferBuilder",function(){return n});var i=r("./src/wgs/scene/consolidation/Consolidation.js"),o=r("./src/wgs/scene/consolidation/GeomMergeTask.js"),s=r("./src/wgs/scene/BufferGeometry.js"),a=r("./src/logger/Logger.js"),l=r("./thirdparty/three.js/three.js");r.n(l)},"./src/wgs/scene/consolidation/ParallelGeomMerge.js":function(e,t,r){"use strict";function n(e){for(var t=new Uint16Array(e.length+1),r=0,n=0;n<e.length;n++)t[n]=r,r+=Object(c.getVertexCount)(e[n]);return t[n]=r,t}function i(e,t,r,i){var o=n(e),s=new l.GeomMergeTask;return s.vb=t.vb,s.vbstride=t.vbstride,s.posOffset=t.attributes.position.itemOffset,s.normalOffset=t.attributes.normal?t.attributes.normal.itemOffset:-1,s.matrices=r,s.ranges=o,s.dbIds=i,s}function o(e,t){t.vb=e.vb,t.attributes.id.array=e.vertexIds,t.needsUpdate=!0}function s(e){function t(e){for(var t=e.data,r=0;r<t.length;r++){var i=t[r],s=i.taskId,l=a[s];o(i,l),delete a[s]}if(n--,0===n)for(c.inProgress=!1,r=0;r<u.length;r++)u[r].clearAllEventListenerWithIntercept(),u[r].terminate(),u[r]=null}var r=2,n=0,a={},l=[],c=e,u=new Array(r);this.addMergeTask=function(e,t,r,n){var o=i(e,t,r,n);l.push(o),a[o.id]=t},this.runTasks=function(){for(var e=0;r>e;e++)u[e]=s.createWorker(),u[e].addEventListenerWithIntercept(t);for(var i=l.length,o=Math.floor(i/r),a=0;r>a;a++){var d=a===r-1,h=a*o,f=d?i:h+o,p=f-h,m=[],g=new Array(4*p),v=0;for(e=h;f>e;e++){var y=l[e];g[v++]=y.vb.buffer,g[v++]=y.matrices.buffer,g[v++]=y.ranges.buffer,g[v++]=y.dbIds.buffer,m.push(y)}var _={operation:"MERGE_GEOMETRY",tasks:m},b=u[a];b.doOperation(_,g),n++}c.inProgress=!0}}function a(e,t,r,n){var s=i(e,t,r,n),a=new h.LmvVector3,l=new d.LmvMatrix4,c=s.run(l,a);o(c,t)}r.r(t),r.d(t,"ParallelGeomMerge",function(){return s}),r.d(t,"runMergeSingleThreaded",function(){return a});var l=r("./src/wgs/scene/consolidation/GeomMergeTask.js"),c=r("./src/wgs/scene/VertexEnumerator.js"),u=r("./src/file-loaders/main/WorkerCreator.js"),d=(r.n(u),r("./src/wgs/scene/LmvMatrix4.js")),h=r("./src/wgs/scene/LmvVector3.js");s.createWorker=u.createWorkerWithIntercept},"./src/wgs/scene/leaflet/LeafletDiffIterator.js":function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-(1/0),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-(1/0);this.l=e,this.b=t,this.r=r,this.t=n}function i(){function e(e){r[e]=[],n[e]=0}function t(e){e&&(e.dispose(),e.needsUpdate=!0)}var r={},n={};this.acquireShaderMaterial=function(t,i){r[i]||e(i);var o=r[i][n[i]];if(o){o.defines={};for(var s in t)o.uniforms[s].value=t[s].value}else o=new d.ShaderMaterial({uniforms:t,vertexShader:c.a,fragmentShader:a.a}),r[i][n[i]]=o;return n[i]++,o},this.reset=function(){for(var e in n)n[e]=0},this.setThreshold=function(e){for(var t in r)for(var n=0;n<r[t].length;n++)r[t][n].uniforms.diff_threshold.value=e,r[t][n].needsUpdate=!0},this.dispose=function(){for(var e in r)for(var n=0;n<r[e].length;n++)t(r[e][n])}}function o(e,t){function r(){return 0!==P.x||0!==P.y}function o(e,t,r){r.position[e](P),r.target[e](P),r.updateMatrixWorld(!0),r.matrixWorldInverse.getInverse(r.matrixWorld),t.reset(r)}function s(e,t,r){var n=e.clone();n.position.z=t;var i=e.material.map,o={diff_threshold:{type:"f",value:S},texture1:{type:"t",value:i},offsetRepeatA:{type:"v4",value:new d.Vector4(i.offset.x,i.offset.y,i.repeat.x,i.repeat.y)},model:{type:"i",value:r},splitPosition:{type:"f",value:L*D*U}},s=z===f.SPLIT_VIEW,a=j.acquireShaderMaterial(o,"nonintersect"+(s?"split":""));return a.defines.SINGLE_MODEL=1,s&&(a.defines.SPLIT_VIEW=1),n.material=a,E.add(n),n}function a(e,t,r,n){e.offsetX=t.offsetX+(n.l-r.l)/r.width()*t.scaleX,e.offsetY=t.offsetY+(n.b-r.b)/r.height()*t.scaleY,e.scaleX=t.scaleX*n.width()/r.width(),e.scaleY=t.scaleY*n.height()/r.height()}function l(e,t,r,n,i){var o=e.rect,s=r.getIntersection(o);if(s){e.intersecStatus=H,e.intersec.union(s);var l=e.material.map,c=t.clone(),h=new u.UVTransform,p=c.geometry.uvTransform;s.equals(r)?(p.copyTo(h),s.equals(o)&&(e.intersecStatus=W)):(a(h,p,r,s),c.geometry=C.acquireQuadGeom(h));var m=new u.UVTransform,g=e.geometry.uvTransform;a(m,g,o,s),c.position.set(s.l,s.b,0),c.scale.set(s.width(),s.height(),1);var v=new d.Vector2,y=new d.Vector2;I&&(v.x=1/(1|n.image.width*U),v.y=1/(1|n.image.height*U),y.x=1/(1|l.image.width*U),y.y=1/(1|l.image.height*U));var _={diff_threshold:{type:"f",value:S},texture1:{type:"t",value:n},texture2:{type:"t",value:l},offsetRepeatA:{type:"v4",value:new d.Vector4(n.offset.x,n.offset.y,n.repeat.x,n.repeat.y)},offsetRepeatB:{type:"v4",value:new d.Vector4(l.offset.x,l.offset.y,l.repeat.x,l.repeat.y)},uvTFa:{type:"v4",value:h.toVec4()},uvTFb:{type:"v4",value:m.toVec4()},highlight:{type:"i",value:i?R:F},splitPosition:{type:"f",value:L*D*U},resolution1:{type:"v2",value:v},resolution2:{type:"v2",value:y}},b=z===f.SPLIT_VIEW,x=j.acquireShaderMaterial(_,"intersection"+(b?"split":""));return b&&(x.defines.SPLIT_VIEW=1),I&&(x.defines.ADD_THICKENING=1),c.material=x,E.add(c),s}return null}function c(e){for(var t=0;t<e.children.length;t++){var r=e.children[t];r.intersecStatus=G,r.intersec=new n;var i=new d.Vector3;i.addVectors(r.position,P);var o=r.scale;r.rect=new n(i.x,i.y,i.x+o.x,i.y+o.y)}}function p(e,t){var n=r();B=.5*(t.far-t.near);var i=_.reset(e,t);n&&o("sub",e,t);var s=b.reset(e,t);return n&&o("add",e,t),m(!i||!s),i&&s}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,t=_.getScene(),r=b.getScene();c(r);for(var i=0;i<t.children.length;i++){for(var o=G,a=t.children[i],u=a.tile,d=a.material.map,h=a.material.tile,f=a.position,p=a.scale,m=new n(f.x,f.y,f.x+p.x,f.y+p.y),g=new n,v=i<r.children.length?i:0,y=r.children.length,x=v;y>x;x++){var w=r.children[x],E=w.tile,S=w.material.tile,A=e&&(S.level!==h.level||u.level!==E.level||h.level<u.level||S.level<E.level),M=l(w,a,m,d,A);if(M&&(o=w.intersecStatus,g.union(M),o===W))break;v>0&&x===y-1&&(y=v,v=0,x=-1)}(o===G||o===H&&!m.equals(g))&&s(a,-.2*B,1)}for(var T=0;T<r.children.length;T++){var w=r.children[T];if(w.intersecStatus===G||w.intersecStatus===H&&!w.rect.equals(w.intersec)){var C=s(w,-.1*B,2);C.position.add(P)}}}function g(e,t){_.reset(e,t),E=_.getScene().clone()}function v(e,t){var n=r();n&&o("sub",e,t),b.reset(e,t),E=b.getScene().clone(),E.position.copy(P),n&&o("add",e,t)}function y(e,t){p(e,t)}var _=e,b=t,x=.25,w=.1,E=new d.Scene,S=e.getDpiScale()<1||t.getDpiScale()<1?x:w,A=!0,M=!1,T=!0,C=new u.GeometryManager,j=new i,P=new d.Vector3,L=.5,D=0,I=!1,R=0,O=1,k=2,N=3,F=N,V=Object(h.getGlobal)(),U=V.devicePixelRatio||1,B=0,z=f.NORMAL_DIFF,G=0,H=1,W=2;this.setThreshold=function(e){S=e,j.setThreshold(e)},this.setDiffMode=function(e){z=e,M=!0},this.getDiffMode=function(){return z},this.getOffset=function(){return P},this.setOffset=function(e){P=e},this.setSplitPosition=function(e){L=e},this.rayCast=function(e,t){return null},this.getVisibleBounds=function(e,t){var r=new d.Box3,n=new d.Box3;_.getVisibleBounds(r,n),b.getVisibleBounds(e,t),e.union(r),t.union(n)};var q=0,X=0,Y=!0;this.updateProgress=function(e){if(e)this.onProgress(100),q=0,Y=!0;else{if(Y)X=Date.now(),q=10,Y=!1;else{var t=Date.now(),r=q>60?10:5;q+=r*(t-X)/250,q=Math.min(95,q),X=t}this.onProgress(q)}},this.reset=function(e,t){A=!1;for(var r=0;r<E.children.length;r++){var n=E.children[r];n.dispatchEvent({type:"removed"})}E.children.length=0,E.position.set(0,0,0),D=t.clientWidth,C.reset(),j.reset();var i=!0;switch(z){case f.NORMAL_DIFF:F=N,i=p(e,t);break;case f.MODEL_A_ONLY:g(e,t);break;case f.MODEL_B_ONLY:v(e,t);break;case f.SPLIT_VIEW:y(e,t);break;case f.HIGHLIGHT_A:F=O,i=p(e,t);break;case f.HIGHLIGHT_B:F=k,i=p(e,t)}T?i&&(this.onFirstSceneComplete&&this.onFirstSceneComplete(),T=!1):this.onProgress&&this.updateProgress(i)},this.nextBatch=function(){return A?null:(A=!0,E)},this.getScene=function(){return E},this.getSceneCount=function(){return 1},this.done=function(){return A},this.update=function(){return M?(M=!1,!0):_.update()||b.update()},this.dispose=function(){j.dispose(),C.dispose()},this.dtor=function(){this.dispose()}}r.r(t),r.d(t,"LeafletDiffModes",function(){return f}),r.d(t,"LeafletDiffIterator",function(){return o});var s=r("./src/wgs/render/shaders/leafletdiff_frag.glsl"),a=r.n(s),l=r("./src/wgs/render/shaders/leafletdiff_vert.glsl"),c=r.n(l),u=r("./src/wgs/scene/leaflet/TexQuadUtils.js"),d=r("./thirdparty/three.js/three.js"),h=(r.n(d),r("./src/compat.js")),f={NORMAL_DIFF:0,MODEL_A_ONLY:1,MODEL_B_ONLY:2,SPLIT_VIEW:3,HIGHLIGHT_A:4,HIGHLIGHT_B:5};n.prototype.width=function(){return this.r-this.l},n.prototype.height=function(){return this.t-this.b},n.prototype.getIntersection=function(e){var t=Math.max(this.l,e.l),r=Math.min(this.r,e.r),i=Math.max(this.b,e.b),o=Math.min(this.t,e.t);return r>t&&o>i?new n(t,i,r,o):null},n.prototype.equals=function(e){return this.l===e.l&&this.r===e.r&&this.t===e.t&&this.b===e.b},n.prototype.union=function(e){return this.l=Math.min(this.l,e.l),this.r=Math.max(this.r,e.r),this.b=Math.min(this.b,e.b),this.t=Math.max(this.t,e.t),this}},"./src/wgs/scene/leaflet/ModelIteratorTexQuad.js":function(e,t,r){"use strict";function n(e,t,r){var n=e.clone();return n.max(t),n.min(r),n.distanceToSquared(e)}function i(e,t,r,n){var i=e.clone();return i.max(r),i.min(n),i.sub(e).dot(t)}function o(){function e(e,t,r){var n=Math.ceil(Math.log2(e)),i=Math.ceil(Math.log2(t)),o=Math.max(n,i);return o-Math.log2(r)}function t(e,t,r){for(;r>0&&e.skippedLevels[r];)--r;var n=t-r;n>0&&(e.texWidth>>=n,e.texHeight>>=n,e.maxLevel=r)}function r(e){var t=[];if(e.zips){r=e.urlPattern.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),r=r.replace(/\\{x\\}/,"[0-9]+"),r=r.replace(/\\{y\\}/,"[0-9]+"),r=r.replace(/\\{z\\}/,"([0-9]+)");var r=new RegExp("^"+r+"$");t.length=e.maxLevel+1,t.fill(!0);var n=0;e.zips.forEach(function(i){Object.keys(i.fileTable).forEach(function(i){var o=r.exec(i);if(o&&o[1]){var s=parseInt(o[1])-e.levelOffset;s>=0&&s<=e.maxLevel&&(t[s]=!1,++n)}})}),0===n&&(t.length=0,f.logger.info("No leaflet levels found - assume all are present"))}return t}this.urlPattern=null,this.tileSize=null,this.maxLevel=null,this.skippedLevels=[],this.textureLoader=null,this.texWidth=0,this.texHeight=0,this.maxActiveTiles=Object(a.isMobileDevice)()?0:400,this.cacheSize=Object(a.isMobileDevice)()?0:150,this.onRootLoaded=null,this.levelOffset=0,this.pixelRatio=1,this.getRootTileSize=function(){return 1*(this.tileSize<<this.maxLevel)},this.getQuadWidth=function(){return this.scale*this.texWidth/this.getRootTileSize()},this.getQuadHeight=function(){return this.scale*this.texHeight/this.getRootTileSize()},this.getPageToModelTransform=function(e,t){var r=e/this.getQuadWidth(),n=t/this.getQuadHeight();return new u.LmvMatrix4(!0).set(r,0,0,0,0,n,0,0,0,0,1,0,0,0,0,1)},this.getBBox=function(){var e=this.getQuadWidth(),t=this.getQuadHeight();if(this.fitPaperSize)return new h.Box3(new h.Vector3,new h.Vector3(e,t,0));var r=1-t;return new h.Box3(new h.Vector3(0,r,0),new h.Vector3(e,1,0))},this.valid=function(){return"string"==typeof this.urlPattern&&this.urlPattern.length>0&&"number"==typeof this.tileSize&&this.tileSize>0&&"number"==typeof this.maxLevel&&this.maxLevel>0&&"number"==typeof this.texWidth&&this.texWidth>0&&"number"==typeof this.texHeight&&this.texHeight>0},this.initForSimpleImage=function(e){this.urlPattern=decodeURIComponent(e),this.maxLevel=0,this.levelOffset=0,this.scale=1,this.tileSize=-1,this.texWidth=-1,this.texHeight=-1,this.isSimpleImage=!0},this.isLevelPresent=function(e){return!this.skippedLevels[e]},this.initFromLoadOptions=function(n,i,o){this.urlPattern=decodeURIComponent(n),this.textureLoader=o,i&&(this.tileSize=i.tileSize,this.maxLevel=e(i.texWidth,i.texHeight,i.tileSize),this.texWidth=i.texWidth,this.texHeight=i.texHeight,this.levelOffset=i.levelOffset,this.zips=i.zips,this.fitPaperSize=i.fitPaperSize,this.paperHeight=i.paperHeight,this.scale=this.fitPaperSize?i.paperWidth*this.getRootTileSize()/this.texWidth:1,this.skippedLevels=r(this),"number"==typeof i.maxLevel&&t(this,this.maxLevel,i.maxLevel),this.maxActiveTiles=i.maxActiveTiles||this.maxActiveTiles,this.cacheSize=i.cacheSize||this.cacheSize)}}function s(e,t){function r(e){var t=N.maxLevel-e;return N.texWidth>>t}function o(e){var t=N.maxLevel-e;return N.texHeight>>t}function s(e){var t=r(e.level),n=o(e.level),i=e.x*N.tileSize,s=e.y*N.tileSize;return i>=t||s>=n}function a(e){var t=r(e.level),n=o(e.level),i=e.x*N.tileSize,s=e.y*N.tileSize,a=Math.max(0,Math.min(N.tileSize,t-i)),l=Math.max(0,Math.min(N.tileSize,n-s)),c=1*N.tileSize;return new h.Vector2(a/c,l/c)}function u(e){return N.scale/(1<<e)}function f(e,t){var r=e.level-t.level,n=1<<r,i=1/n,o=i,s=a(t);i/=s.x,o/=s.y;var l=t.x*n,c=t.y*n,u=e.x-l,h=e.y-c,f=a(e);u*=i,h*=o,h=1-h-o*f.y;var p=new d.UVTransform;return p.offsetX=u,p.offsetY=h,p.scaleX=i*f.x,p.scaleY=o*f.y,p}function _(e,t){var r=u(e.level);return r*e.x*t}function b(e,t){var r=u(e.level),n=N.fitPaperSize?N.paperHeight:1;return n-(e.y+1)*r*t}function x(e){return G[Object(l.tile2Index)(e)]}function w(e){var t=x(e);return t instanceof y&&t.state==g}function E(e,t){for(var r=e.getParent();r;){var n=x(r),i=n&&n.state==g;if(i&&t&&n.mesh.material.map.needsUpdate&&r.level>0&&(i=!1),i)break;r=r.getParent()}return r}function S(e,t,r,n){var i;if(t)Z||(Z=$.createQuadGeom()),i=Z;else{var o=E(e),s=T(o);t=s.material;var l=f(e,o);i=$.acquireQuadGeom(l)}var c=new h.Mesh(i,t);c.tile=e;var d=u(e.level),p=a(e),m=(1-p.y)*d*n,g=_(e,n),v=b(e,n);return c.position.set(g,v+m,0),c.scale.set(d*p.x*n,d*p.y*n,1),c}function A(e){var t=N.levelOffset?N.levelOffset:0,r=N.urlPattern.replace("{x}",e.x).replace("{y}",e.y).replace("{z}",e.level+t);return r}function M(t){var r=Object(l.tile2Index)(t),n=G[r];if(!n||n.state==p){n||(n=new y(H.slice()),G[r]=n),n.state=m;var i=A(t),o=function(r){if(te&&r){0==N.maxLevel&&(-1==N.texWidth&&(N.texWidth=r.image.width),-1==N.texHeight&&(N.texHeight=r.image.height),-1==N.tileSize&&(N.tileSize=Math.max(r.image.width,r.image.height)),V=e.getBBox()),ee(r),r.minFilter=h.LinearMipMapLinearFilter,r.magFilter=h.LinearFilter;var o=new h.MeshBasicMaterial({color:4294967295});o.map=r,o.name=i,o.tile=t,o.disableEnvMap=!0,-1!==i.toLowerCase().indexOf(".png")&&(o.transparent=!0,o.alphaTest=.01),B.addMaterial(o.name,o,!0);var s=S(t,o,!1,F);n.mesh=s,n.state=g,X--,K=!0;var a=r&&r.image?r.image.src:null;a&&h.Cache&&h.Cache.get(a)&&h.Cache.remove(a),0==t.level&&N.onRootLoaded&&N.onRootLoaded()}};X++,N.textureLoader(i,function(e,t){o(e)},function(e){N.onDone(e,null)})}}function T(e){var t=Object(l.tile2Index)(e),r=G[t];return r&&r.state==g?r.mesh:null}function C(e,t,r){var n=_(e,r),i=b(e,r);t.set(n,i,0)}function j(e,t,r){var n=u(e.level),i=_(e,r)+n,o=b(e,r)+n;t.set(i,o,0)}function P(e,t){this.tile=e,this.prio=t}function L(e,t){return e.prio>t.prio}function D(e,t){var r=G[Object(l.tile2Index)(e)];r&&r.timeStamps[t]!==H[t]&&(r.timeStamps[t]=H[t],W++)}function I(e,t,r){e.sort(function(e,n){var i=ne(e,t,r),o=ne(n,t,r);return o-i});for(var n=0,i=0;i<e.length;i++){var o=x(e[i]);if(!o||o.state!=m){if(X>=q)break;M(e[i]),n++}}return n}function R(e){if(e&&e.mesh&&e.mesh.material){var t=e.mesh.material;B.removeMaterial(t.name),t.map.dispose(),t.map.needsUpdate=!0;var r={type:"dispose"};t.dispatchEvent(r),t.needsUpdate=!0}}function O(e){for(var t=0;t<H.length;t++){var r=!!U[t];if(r&&e.timeStamps[t]===H[t])return!0}return!1}function k(e,t,r){var n=Object.keys(G),i=n.length,o=N.cacheSize-i,s=e-o;if(!(0>=s)){n.sort(function(e,n){var i=G[e].timeStamps[0],o=G[n].timeStamps[0];if(i!=o)return i-o;var s=Object(l.index2Tile)(e),a=Object(l.index2Tile)(n),c=ne(s,t,r),u=ne(a,t,r);return c-u});for(var a=Math.min(s,n.length),c=0;a>c;c++){var u=n[c],d=Object(l.index2Tile)(u);if(0!==d.level){var h=G[u];if(h.state==g){if(O(h))break;R(h),delete G[u]}}}}}this.isModelIteratorTexQuad=!0;var N=e,F=1,V=e.getBBox(),U=[],B=t,z=[],G=[],H=[];this.registerView=function(){var e=U.indexOf(void 0);-1===e&&(e=U.length);var t=new h.Scene;return t.skipIdTarget=!0,U[e]=t,H[e]=0,z[e]=!0,e},this.registerView();var W=0,q=5,X=0,Y=5,K=!1,Q=[],Z=null,J=!1,$=new d.GeometryManager;this.setAggressivePrefetching=function(e){J=e},this.getScene=function(e){var e=e||0;return U[e]},this.nextBatch=function(e){var e=e||0;return z[e]?null:(z[e]=!0,U[0])},this.getSceneCount=function(){return 1},this.done=function(e){return z[e||0]},this.rayCast=function(e,t){return null},this.getVisibleBounds=function(e,t){e&&e.copy(V),t&&t.copy(V)};var ee=function(e){for(var t=e.image,r=1;(r*=2)<t.width;);for(var n=1;(n*=2)<t.height;);if(r!==t.width||n!==t.height){var i=v.createElement("canvas");i.width=r,i.height=n;var o=i.getContext("2d");o.drawImage(t,0,0);var s,a,l=o.getImageData(0,0,r,n),c=new Uint32Array(l.data.buffer,0,r*n);if(t.height<n){var u=t.height*r;for(s=t.height;n>s;++s,u+=r)for(a=0;a<t.width;++a)c[u+a]=c[u+a-r]}if(t.width<r){var d=0;for(s=0;n>s;++s,d+=r)for(a=t.width;r>a;++a)c[d+a]=c[d+a-1]}o.putImageData(l,0,0),e.image=i,e.flipY&&e.offset.set(0,1-t.height/n),e.repeat.set(t.width/r,t.height/n)}},te=this;this.requestRootTile=function(){M(new l.TileCoords(0,0,0))};var re=function(){var e=new h.Vector3,t=new h.Vector3,r=new h.Box3;return function(n,i,o){return C(n,e,o),j(n,t,o),r.set(e,t),i.intersectsBox(r)>0}}(),ne=function(){var e=new h.Vector3,t=new h.Vector3;return function(r,i,o,s){var a=u(r.level);C(r,e,s),j(r,t,s);var l=n(o,e,t),c=re(r,i,s),d=c?100:1,h=1e-4;l=Math.max(l,h);var f=a*a,p=d*f/l;return p}}(),ie=function(){var e=new h.Vector3,t=new h.Vector3;return function(r,n,o,s,a,l){C(r,e,l),j(r,t,l);var c=i(n,o,e,t),u=t.x-e.x,d=Math.tan(h.Math.degToRad(s/2)),f=u/(d*c);return.5*f*a}}();this.dispose=function(){var e;for(e in G)R(G[e]);Z&&(Z.dispose(),Z.needsUpdate=!0),$.dispose()},this.dtor=function(){
this.dispose(),te=null,B=null},this.reset=function(e,t,r){r=r||0;var n,i,o=r>0,a=U[r];for(n=0;n<a.children.length;n++){var u=a.children[n];u.dispatchEvent({type:"removed"})}a.children.length=0,H[r]++,W=0,$.reset();var d=new l.TileCoords(0,0,0);if(!w(d))return z[r]=!0,!1;var h=new c.SortedList(L),f=new l.TileCoords(0,0,0),p=ne(f,e,t.position);h.add(new P(f,p));for(var m=t.getWorldDirection(),g=0|t.clientHeight*N.pixelRatio,v=[],y=[],_=[];h.size()>0;){var b=h.get(0);if(i=b.tile,h.removeAt(0),!s(i)){var x=!0;i.level==N.maxLevel&&(x=!1);var E=ie(i,t.position,m,t.fov,g,F);E<N.tileSize&&N.isLevelPresent(i.level)&&(x=!1);var A=re(i,e,F);if(A&&(!w(i)&&N.isLevelPresent(i.level)&&_.push(i),D(i,r)),!A&&v.length+y.length>N.maxActiveTiles&&(x=!1),x)for(var M=0;4>M;M++){var C=i.getChild(M);p=ne(C,e,t.position,F),h.add(new P(C,p))}else A?v.push(i):y.push(i)}}var j=0;K=!1;var R=!0;for(n=0;n<v.length;++n){i=v[n];var O=T(i);O&&O.material.map.needsUpdate&&!J&&(Y>j||o?j++:(O=S(i,null,!0,F),K=!0,R=!1)),O||(O=S(i,null,!1,F),R=!1),a.add(O)}z[r]=!1;var V=I(_,e,t.position);W+=X;var B=[];for(n=0;n<y.length&&!(W>=N.maxActiveTiles);n++)if(i=y[n],w(i))for(var G=0;G<=i.level;G++){var q=i.getParentAtLevel(G);if(D(q,r),W>N.maxActiveTiles)break}else B.push(i),W++;if(V+=I(B,e,t.position),J){for(B=[],n=0;n<v.length;++n)if(i=v[n],i.level!=N.maxLevel&&N.isLevelPresent(i.level+1))for(var M=0;4>M;M++){var C=i.getChild(M);!s(C)&&re(C,e,F)&&(w(C)||(B.push(C),W++))}V+=I(B,e,t.position)}if(o||k(V,e,t.position),R&&Q.length>0){var Z=Q.splice(0,Q.length);setTimeout(function(){for(var e=0;e<Z.length;e++)Z[e](r)},1)}return R},this.callWhenRefined=function(e){Q.push(e)},this.update=function(){return K},this.setDpiScale=function(e){F=e},this.getDpiScale=function(){return F},this.unregisterView=function(e){U[e]=void 0,H[e]=void 0,z[e]=void 0;for(var t=U.length;t>0&&!U[t-1];)t--;U.length=t,H.length=t,z.length=t}}r.r(t),r.d(t,"TexQuadConfig",function(){return o}),r.d(t,"ModelIteratorTexQuad",function(){return s});var a=r("./src/compat.js"),l=r("./src/wgs/scene/leaflet/TileCoords.js"),c=r("./src/wgs/scene/SortedList.js"),u=r("./src/wgs/scene/LmvMatrix4.js"),d=r("./src/wgs/scene/leaflet/TexQuadUtils.js"),h=r("./thirdparty/three.js/three.js"),f=(r.n(h),r("./src/logger/Logger.js")),p=0,m=1,g=2,v=Object(a.getGlobal)().document,y=function(e,t){this.timeStamps=e,this.mesh=t,this.state=p}},"./src/wgs/scene/leaflet/TexQuadUtils.js":function(e,t,r){"use strict";function n(){this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1}function i(){function e(e,t){var r=t?t:i,n=[];n.push(new o.Vector2(r.offsetX,r.offsetY)),n.push(new o.Vector2(r.offsetX+r.scaleX,r.offsetY)),n.push(new o.Vector2(r.offsetX+r.scaleX,r.offsetY+r.scaleY)),n.push(new o.Vector2(r.offsetX,r.offsetY+r.scaleY)),e.faceVertexUvs[0].length=0,e.faceVertexUvs[0].push([n[0],n[1],n[2]]),e.faceVertexUvs[0].push([n[0],n[2],n[3]]),e.uvTransform=r,e.uvsNeedUpdate=!0}var t=[],r=0,i=new n;this.acquireQuadGeom=function(n){var i=t[r];return i?e(i,n):(i=this.createQuadGeom(n),t[r]=i),r++,i},this.createQuadGeom=function(t){var r=new o.Geometry;return r.vertices.push(new o.Vector3(0,0,0),new o.Vector3(1,0,0),new o.Vector3(1,1,0),new o.Vector3(0,1,0)),r.faces.push(new o.Face3(0,1,2)),r.faces.push(new o.Face3(0,2,3)),e(r,t),r.computeFaceNormals(),r},this.reset=function(){r=0},this.dispose=function(){for(var e=0;e<t.length;e++){var r=t[e];r&&(r.dispose(),r.needsUpdate=!0)}}}r.r(t),r.d(t,"UVTransform",function(){return n}),r.d(t,"GeometryManager",function(){return i});var o=r("./thirdparty/three.js/three.js");r.n(o);n.prototype.toVec4=function(){return new o.Vector4(this.offsetX,this.offsetY,this.scaleX,this.scaleY)},n.prototype.copyTo=function(e){e.offsetX=this.offsetX,e.offsetY=this.offsetY,e.scaleX=this.scaleX,e.scaleY=this.scaleY}},"./src/wgs/scene/leaflet/TileCoords.js":function(e,t,r){"use strict";function n(e,t,r){this.level=e,this.x=t,this.y=r}function i(e){var t=((1<<2*e.level)-1)/3,r=1<<e.level;return t+e.y*r+e.x}function o(e){for(var t=new n(0,0,0);i(t)<=e;)t.level++;t.level--;var r=e-i(t),o=1<<t.level;return t.y=Math.floor(r/o),t.x=r%o,t}r.r(t),r.d(t,"TileCoords",function(){return n}),r.d(t,"tile2Index",function(){return i}),r.d(t,"index2Tile",function(){return o}),n.prototype={constructor:n,copy:function(){return new n(this.level,this.x,this.y)},isValid:function(){return Number.isInteger(this.level)&&this.level>=0&&Number.isInteger(this.x)&&Number.isInteger(this.y)},getChild:function(e){var t=1&e?1:0,r=2&e?1:0;return new n(this.level+1,2*this.x+t,2*this.y+r)},getParent:function(){return 0==this.level?null:new n(this.level-1,Math.floor(this.x/2),Math.floor(this.y/2))},getParentAtLevel:function(e){if(0>e||e>this.level)return null;var t=this.level-e,r=Math.floor(this.x>>t),i=Math.floor(this.y>>t);return new n(e,r,i)},toString:function(){return"("+this.level+", "+this.x+", "+this.y+")"},equals:function(e,t,r){return e instanceof n?this.equals(e.level,e.x,e.y):this.level===e&&this.x===t&&this.y===r}}},"./thirdparty/hammer/hammer.js":function(e,t,r){function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i;!function(o,s,a,l){"use strict";function c(e,t,r){return setTimeout(p(e,r),t)}function u(e,t,r){return Array.isArray(e)?(d(e,r[t],r),!0):!1}function d(e,t,r){var n;if(e)if(e.forEach)e.forEach(t,r);else if(e.length!==l)for(n=0;n<e.length;)t.call(r,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n,e)}function h(e,t,r){var n="DEPRECATED METHOD: "+t+"\n"+r+" AT \n";return function(){var t=new Error("get-stack-trace"),r=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=o.console&&(o.console.warn||o.console.log);return i&&i.call(o.console,n,r),e.apply(this,arguments)}}function f(e,t,r){var n,i=t.prototype;n=e.prototype=Object.create(i),n.constructor=e,n._super=i,r&&we(n,r)}function p(e,t){return function(){return e.apply(t,arguments)}}function m(e,t){return n(e)==ye?e.apply(t?t[0]||l:l,t):e}function g(e,t){return e===l?t:e}function v(e,t,r){d(x(t),function(t){e.addEventListener(t,r,!1)})}function y(e,t,r){d(x(t),function(t){e.removeEventListener(t,r,!1)})}function _(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function b(e,t){return e.indexOf(t)>-1}function x(e){return e.trim().split(/\s+/g)}function w(e,t,r){if(e.indexOf&&!r)return e.indexOf(t);for(var n=0;n<e.length;){if(r&&e[n][r]==t||!r&&e[n]===t)return n;n++}return-1}function E(e){return Array.prototype.slice.call(e,0)}function S(e,t,r){for(var n=[],i=[],o=0;o<e.length;){var s=t?e[o][t]:e[o];w(i,s)<0&&n.push(e[o]),i[o]=s,o++}return r&&(n=t?n.sort(function(e,r){return e[t]>r[t]}):n.sort()),n}function A(e,t){for(var r,n,i=t[0].toUpperCase()+t.slice(1),o=0;o<ge.length;){if(r=ge[o],n=r?r+i:t,n in e)return n;o++}return l}function M(){return Ae++}function T(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||o}function C(e,t){var r=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){m(e.options.enable,[e])&&r.handler(t)},this.init()}function j(e){var t,r=e.options.inputClass;return new(t=r?r:Ce?G:je?q:Te?Y:z)(e,P)}function P(e,t,r){var n=r.pointers.length,i=r.changedPointers.length,o=t&Oe&&n-i===0,s=t&(Ne|Fe)&&n-i===0;r.isFirst=!!o,r.isFinal=!!s,o&&(e.session={}),r.eventType=t,L(e,r),e.emit("hammer.input",r),e.recognize(r),e.session.prevInput=r}function L(e,t){var r=e.session,n=t.pointers,i=n.length;r.firstInput||(r.firstInput=R(t)),i>1&&!r.firstMultiple?r.firstMultiple=R(t):1===i&&(r.firstMultiple=!1);var o=r.firstInput,s=r.firstMultiple,a=s?s.center:o.center,l=t.center=O(n);t.timeStamp=xe(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=V(a,l),t.distance=F(a,l),D(r,t),t.offsetDirection=N(t.deltaX,t.deltaY);var c=k(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=be(c.x)>be(c.y)?c.x:c.y,t.scale=s?B(s.pointers,n):1,t.rotation=s?U(s.pointers,n):0,t.maxPointers=r.prevInput?t.pointers.length>r.prevInput.maxPointers?t.pointers.length:r.prevInput.maxPointers:t.pointers.length,I(r,t);var u=e.element;_(t.srcEvent.target,u)&&(u=t.srcEvent.target),t.target=u}function D(e,t){var r=t.center,n=e.offsetDelta||{},i=e.prevDelta||{},o=e.prevInput||{};(t.eventType===Oe||o.eventType===Ne)&&(i=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},n=e.offsetDelta={x:r.x,y:r.y}),t.deltaX=i.x+(r.x-n.x),t.deltaY=i.y+(r.y-n.y)}function I(e,t){var r,n,i,o,s=e.lastInterval||t,a=t.timeStamp-s.timeStamp;if(t.eventType!=Fe&&(a>Re||s.velocity===l)){var c=t.deltaX-s.deltaX,u=t.deltaY-s.deltaY,d=k(a,c,u);n=d.x,i=d.y,r=be(d.x)>be(d.y)?d.x:d.y,o=N(c,u),e.lastInterval=t}else r=s.velocity,n=s.velocityX,i=s.velocityY,o=s.direction;t.velocity=r,t.velocityX=n,t.velocityY=i,t.direction=o}function R(e){for(var t=[],r=0;r<e.pointers.length;)t[r]={clientX:_e(e.pointers[r].clientX),clientY:_e(e.pointers[r].clientY)},r++;return{timeStamp:xe(),pointers:t,center:O(t),deltaX:e.deltaX,deltaY:e.deltaY}}function O(e){var t=e.length;if(1===t)return{x:_e(e[0].clientX),y:_e(e[0].clientY)};for(var r=0,n=0,i=0;t>i;)r+=e[i].clientX,n+=e[i].clientY,i++;return{x:_e(r/t),y:_e(n/t)}}function k(e,t,r){return{x:t/e||0,y:r/e||0}}function N(e,t){return e===t?Ve:be(e)>=be(t)?0>e?Ue:Be:0>t?ze:Ge}function F(e,t,r){r||(r=Xe);var n=t[r[0]]-e[r[0]],i=t[r[1]]-e[r[1]];return Math.sqrt(n*n+i*i)}function V(e,t,r){r||(r=Xe);var n=t[r[0]]-e[r[0]],i=t[r[1]]-e[r[1]];return 180*Math.atan2(i,n)/Math.PI}function U(e,t){return V(t[1],t[0],Ye)-V(e[1],e[0],Ye)}function B(e,t){return F(t[0],t[1],Ye)/F(e[0],e[1],Ye)}function z(){this.evEl=Qe,this.evWin=Ze,this.pressed=!1,C.apply(this,arguments)}function G(){this.evEl=et,this.evWin=tt,C.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function H(){this.evTarget=nt,this.evWin=it,this.started=!1,C.apply(this,arguments)}function W(e,t){var r=E(e.touches),n=E(e.changedTouches);return t&(Ne|Fe)&&(r=S(r.concat(n),"identifier",!0)),[r,n]}function q(){this.evTarget=st,this.targetIds={},C.apply(this,arguments)}function X(e,t){var r=E(e.touches),n=this.targetIds;if(t&(Oe|ke)&&1===r.length)return n[r[0].identifier]=!0,[r,r];var i,o,s=E(e.changedTouches),a=[],l=this.target;if(o=r.filter(function(e){return _(e.target,l)}),t===Oe)for(i=0;i<o.length;)n[o[i].identifier]=!0,i++;for(i=0;i<s.length;)n[s[i].identifier]&&a.push(s[i]),t&(Ne|Fe)&&delete n[s[i].identifier],i++;return a.length?[S(o.concat(a),"identifier",!0),a]:void 0}function Y(){C.apply(this,arguments);var e=p(this.handler,this);this.touch=new q(this.manager,e),this.mouse=new z(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function K(e,t){e&Oe?(this.primaryTouch=t.changedPointers[0].identifier,Q.call(this,t)):e&(Ne|Fe)&&Q.call(this,t)}function Q(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var r={x:t.clientX,y:t.clientY};this.lastTouches.push(r);var n=this.lastTouches,i=function(){var e=n.indexOf(r);e>-1&&n.splice(e,1)};setTimeout(i,at)}}function Z(e){for(var t=e.srcEvent.clientX,r=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var i=this.lastTouches[n],o=Math.abs(t-i.x),s=Math.abs(r-i.y);if(lt>=o&&lt>=s)return!0}return!1}function J(e,t){this.manager=e,this.set(t)}function $(e){if(b(e,pt))return pt;var t=b(e,mt),r=b(e,gt);return t&&r?pt:t||r?t?mt:gt:b(e,ft)?ft:ht}function ee(){if(!ut)return!1;var e={},t=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){e[r]=t?o.CSS.supports("touch-action",r):!0}),e}function te(e){this.options=we({},this.defaults,e||{}),this.id=M(),this.manager=null,this.options.enable=g(this.options.enable,!0),this.state=yt,this.simultaneous={},this.requireFail=[]}function re(e){return e&Et?"cancel":e&xt?"end":e&bt?"move":e&_t?"start":""}function ne(e){return e==Ge?"down":e==ze?"up":e==Ue?"left":e==Be?"right":""}function ie(e,t){var r=t.manager;return r?r.get(e):e}function oe(){te.apply(this,arguments)}function se(){oe.apply(this,arguments),this.pX=null,this.pY=null}function ae(){oe.apply(this,arguments)}function le(){te.apply(this,arguments),this._timer=null,this._input=null}function ce(){oe.apply(this,arguments)}function ue(){oe.apply(this,arguments)}function de(){te.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function he(e,t){return t=t||{},t.recognizers=g(t.recognizers,he.defaults.preset),new fe(e,t)}function fe(e,t){this.options=we({},he.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=j(this),this.touchAction=new J(this,this.options.touchAction),pe(this,!0),d(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function pe(e,t){var r=e.element;if(r.style){var n;d(e.options.cssProps,function(i,o){n=A(r.style,o),t?(e.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={})}}function me(e,t){var r=s.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=t,t.target.dispatchEvent(r)}var ge=["","webkit","Moz","MS","ms","o"],ve=s.createElement("div"),ye="function",_e=Math.round,be=Math.abs,xe=Date.now,we=function(e){if(e===l||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(n!==l&&null!==n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=Array.isArray(n[i])?n[i].slice(0):n[i])}return t},Ee=h(function(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;)(!r||r&&e[n[i]]===l)&&(e[n[i]]=t[n[i]]),i++;return e},"extend","Use `assign`."),Se=h(function(e,t){return Ee(e,t,!0)},"merge","Use `assign`."),Ae=1,Me=/mobile|tablet|ip(ad|hone|od)|android/i,Te="ontouchstart"in o,Ce=A(o,"PointerEvent")!==l,je=Te&&Me.test(navigator.userAgent),Pe="touch",Le="pen",De="mouse",Ie="kinect",Re=25,Oe=1,ke=2,Ne=4,Fe=8,Ve=1,Ue=2,Be=4,ze=8,Ge=16,He=Ue|Be,We=ze|Ge,qe=He|We,Xe=["x","y"],Ye=["clientX","clientY"];C.prototype={handler:function(){},init:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(T(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&y(this.element,this.evEl,this.domHandler),this.evTarget&&y(this.target,this.evTarget,this.domHandler),this.evWin&&y(T(this.element),this.evWin,this.domHandler)}};var Ke={mousedown:Oe,mousemove:ke,mouseup:Ne},Qe="mousedown",Ze="mousemove mouseup";f(z,C,{handler:function(e){var t=Ke[e.type];t&Oe&&0===e.button&&(this.pressed=!0),t&ke&&1!==e.which&&(t=Ne),this.pressed&&(t&Ne&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:De,srcEvent:e}))}});var Je={pointerdown:Oe,pointermove:ke,pointerup:Ne,pointercancel:Fe,pointerout:Fe},$e={2:Pe,3:Le,4:De,5:Ie},et="pointerdown",tt="pointermove pointerup pointercancel";o.MSPointerEvent&&!o.PointerEvent&&(et="MSPointerDown",tt="MSPointerMove MSPointerUp MSPointerCancel"),f(G,C,{handler:function(e){var t=this.store,r=!1,n=e.type.toLowerCase().replace("ms",""),i=Je[n],o=$e[e.pointerType]||e.pointerType,s=o===Pe,a=o===De,l=w(t,e.pointerId,"pointerId");i&Oe&&(0===e.button||s)?0>l&&(t.push(e),l=t.length-1):i&(Ne|Fe)&&(r=!0),0>l||(t[l]=e,(!a||this.manager.options.handlePointerEventMouse)&&this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),r&&t.splice(l,1))}});var rt={touchstart:Oe,touchmove:ke,touchend:Ne,touchcancel:Fe},nt="touchstart",it="touchstart touchmove touchend touchcancel";f(H,C,{handler:function(e){var t=rt[e.type];if(t===Oe&&(this.started=!0),this.started){var r=W.call(this,e,t);t&(Ne|Fe)&&r[0].length-r[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:Pe,srcEvent:e})}}});var ot={touchstart:Oe,touchmove:ke,touchend:Ne,touchcancel:Fe},st="touchstart touchmove touchend touchcancel";f(q,C,{handler:function(e){var t=ot[e.type],r=X.call(this,e,t);r&&this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:Pe,srcEvent:e})}});var at=2500,lt=25;f(Y,C,{handler:function(e,t,r){var n=r.pointerType==Pe,i=r.pointerType==De;if(!(i&&r.sourceCapabilities&&r.sourceCapabilities.firesTouchEvents)){if(n)K.call(this,t,r);else if(i&&Z.call(this,r))return;this.callback(e,t,r)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ct=A(ve.style,"touchAction"),ut=ct!==l,dt="compute",ht="auto",ft="manipulation",pt="none",mt="pan-x",gt="pan-y",vt=ee();J.prototype={set:function(e){e==dt&&(e=this.compute()),ut&&this.manager.element.style&&vt[e]&&(this.manager.element.style[ct]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return d(this.manager.recognizers,function(t){m(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),$(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,r=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var n=this.actions,i=b(n,pt)&&!vt[pt],o=b(n,gt)&&!vt[gt],s=b(n,mt)&&!vt[mt];if(i){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}return s&&o?void 0:i||o&&r&He||s&&r&We?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var yt=1,_t=2,bt=4,xt=8,wt=xt,Et=16,St=32;te.prototype={defaults:{},set:function(e){return we(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(u(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=ie(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return u(e,"dropRecognizeWith",this)?this:(e=ie(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(u(e,"requireFailure",this))return this;var t=this.requireFail;return e=ie(e,this),-1===w(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(u(e,"dropRequireFailure",this))return this;e=ie(e,this);var t=w(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function Ct(e){function Ct(r){t.manager.emit(r,e)}var t=this,r=this.state;xt>r&&Ct(t.options.event+re(r)),Ct(t.options.event),e.additionalEvent&&Ct(e.additionalEvent),r>=xt&&Ct(t.options.event+re(r))},tryEmit:function(e){return this.canEmit()?this.emit(e):void(this.state=St)},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(St|yt)))return!1;e++}return!0},recognize:function(e){var t=we({},e);return m(this.options.enable,[this,t])?(this.state&(wt|Et|St)&&(this.state=yt),this.state=this.process(t),void(this.state&(_t|bt|xt|Et)&&this.tryEmit(t))):(this.reset(),void(this.state=St))},process:function(e){},getTouchAction:function(){},reset:function(){}},f(oe,te,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,r=e.eventType,n=t&(_t|bt),i=this.attrTest(e);return n&&(r&Fe||!i)?t|Et:n||i?r&Ne?t|xt:t&_t?t|bt:_t:St}}),f(se,oe,{defaults:{event:"pan",threshold:10,pointers:1,direction:qe},getTouchAction:function(){var e=this.options.direction,t=[];return e&He&&t.push(gt),e&We&&t.push(mt),t},directionTest:function(e){var t=this.options,r=!0,n=e.distance,i=e.direction,o=e.deltaX,s=e.deltaY;return i&t.direction||(t.direction&He?(i=0===o?Ve:0>o?Ue:Be,r=o!=this.pX,n=Math.abs(e.deltaX)):(i=0===s?Ve:0>s?ze:Ge,r=s!=this.pY,n=Math.abs(e.deltaY))),e.direction=i,r&&n>t.threshold&&i&t.direction},attrTest:function(e){return oe.prototype.attrTest.call(this,e)&&(this.state&_t||!(this.state&_t)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=ne(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),f(ae,oe,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[pt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&_t)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),f(le,te,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ht]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,n=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!n||!r||e.eventType&(Ne|Fe)&&!i)this.reset();else if(e.eventType&Oe)this.reset(),this._timer=c(function(){this.state=wt,this.tryEmit()},t.time,this);else if(e.eventType&Ne)return wt;return St},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===wt&&(e&&e.eventType&Ne?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=xe(),this.manager.emit(this.options.event,this._input)))}}),f(ce,oe,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[pt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&_t)}}),f(ue,oe,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:He|We,pointers:1},getTouchAction:function(){return se.prototype.getTouchAction.call(this)},attrTest:function(e){var t,r=this.options.direction;return r&(He|We)?t=e.overallVelocity:r&He?t=e.overallVelocityX:r&We&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&r&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&be(t)>this.options.velocity&&e.eventType&Ne},emit:function(e){var t=ne(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),f(de,te,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ft]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,n=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),e.eventType&Oe&&0===this.count)return this.failTimeout();if(n&&i&&r){if(e.eventType!=Ne)return this.failTimeout();var o=this.pTime?e.timeStamp-this.pTime<t.interval:!0,s=!this.pCenter||F(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,s&&o?this.count+=1:this.count=1,this._input=e;var a=this.count%t.taps;if(0===a)return this.hasRequireFailures()?(this._timer=c(function(){this.state=wt,this.tryEmit()},t.interval,this),_t):wt}return St},failTimeout:function(){return this._timer=c(function(){this.state=St},this.options.interval,this),St},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==wt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),he.VERSION="2.0.8",he.defaults={domEvents:!1,touchAction:dt,enable:!0,handlePointerEventMouse:!0,inputTarget:null,inputClass:null,preset:[[ce,{enable:!1}],[ae,{enable:!1},["rotate"]],[ue,{direction:He}],[se,{direction:He},["swipe"]],[de],[de,{event:"doubletap",taps:2},["tap"]],[le]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var At=1,Mt=2;fe.prototype={set:function(e){return we(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?Mt:At},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var r,n=this.recognizers,i=t.curRecognizer;(!i||i&&i.state&wt)&&(i=t.curRecognizer=null);for(var o=0;o<n.length;)r=n[o],t.stopped===Mt||i&&r!=i&&!r.canRecognizeWith(i)?r.reset():r.recognize(e),!i&&r.state&(_t|bt|xt)&&(i=t.curRecognizer=r),o++}},get:function(e){if(e instanceof te)return e;for(var t=this.recognizers,r=0;r<t.length;r++)if(t[r].options.event==e)return t[r];return null},add:function(e){if(u(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(u(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,r=w(t,e);-1!==r&&(t.splice(r,1),this.touchAction.update())}return this},on:function(e,t){if(e!==l&&t!==l){var r=this.handlers;return d(x(e),function(e){r[e]=r[e]||[],r[e].push(t)}),this}},off:function(e,t){if(e!==l){var r=this.handlers;return d(x(e),function(e){t?r[e]&&r[e].splice(w(r[e],t),1):delete r[e]}),this}},emit:function(e,t){this.options.domEvents&&me(e,t);var r=this.handlers[e]&&this.handlers[e].slice();if(r&&r.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()},t.stopPropagation=function(){t.srcEvent.stopPropagation()};for(var n=0;n<r.length;)r[n](t),n++}},destroy:function(){this.element&&pe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},we(he,{INPUT_START:Oe,INPUT_MOVE:ke,INPUT_END:Ne,INPUT_CANCEL:Fe,STATE_POSSIBLE:yt,STATE_BEGAN:_t,STATE_CHANGED:bt,STATE_ENDED:xt,STATE_RECOGNIZED:wt,STATE_CANCELLED:Et,STATE_FAILED:St,DIRECTION_NONE:Ve,DIRECTION_LEFT:Ue,DIRECTION_RIGHT:Be,DIRECTION_UP:ze,DIRECTION_DOWN:Ge,DIRECTION_HORIZONTAL:He,DIRECTION_VERTICAL:We,DIRECTION_ALL:qe,Manager:fe,Input:C,TouchAction:J,TouchInput:q,MouseInput:z,PointerEventInput:G,TouchMouseInput:Y,SingleTouchInput:H,Recognizer:te,AttrRecognizer:oe,Tap:de,Pan:se,Swipe:ue,Pinch:ae,Rotate:ce,Press:le,on:v,off:y,each:d,merge:Se,extend:Ee,assign:we,inherit:f,bindFn:p,prefixed:A});var Tt="undefined"!=typeof o?o:"undefined"!=typeof self?self:{};Tt.Hammer=he,i=function(){return he}.call(t,r,t,e),!(i!==l&&(e.exports=i))}(window,document,"Hammer")},"./thirdparty/resize-observer-polyfill/ResizeObserver.min.js":function(e,t){!function(r,n){"object"==typeof t&&"undefined"!=typeof e?e.exports=n():"function"==typeof define&&define.amd?define(n):r.ResizeObserver=n()}(this,function(){"use strict";function e(e){return parseFloat(e)||0}function t(t){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return r.reduce(function(r,n){return r+e(t["border-"+n+"-width"])},0)}function r(r){var n=r.clientWidth,o=r.clientHeight;if(!n&&!o)return m;var s,a=p(r).getComputedStyle(r),l=function(t){for(var r={},n=0,i=["top","right","bottom","left"];n<i.length;n+=1){var o=i[n],s=t["padding-"+o];r[o]=e(s)}return r}(a),c=l.left+l.right,u=l.top+l.bottom,d=e(a.width),h=e(a.height);if("border-box"===a.boxSizing&&(Math.round(d+c)!==n&&(d-=t(a,"left","right")+c),Math.round(h+u)!==o&&(h-=t(a,"top","bottom")+u)),(s=r)!==p(s).document.documentElement){var f=Math.round(d+c)-n,g=Math.round(h+u)-o;1!==Math.abs(f)&&(d-=f),1!==Math.abs(g)&&(h-=g)}return i(l.left,l.top,d,h)}function n(e){return s?g(e)?i(0,0,(t=e.getBBox()).width,t.height):r(e):m;var t}function i(e,t,r,n){return{x:e,y:t,width:r,height:n}}var o=function(){function e(e,t){var r=-1;return e.some(function(e,n){return e[0]===t&&(r=n,!0)}),r}return"undefined"!=typeof Map?Map:function(){function t(){this.__entries__=[]}var r={size:{configurable:!0}};return r.size.get=function(){return this.__entries__.length},t.prototype.get=function(t){var r=e(this.__entries__,t),n=this.__entries__[r];return n&&n[1]},t.prototype.set=function(t,r){var n=e(this.__entries__,t);~n?this.__entries__[n][1]=r:this.__entries__.push([t,r])},t.prototype["delete"]=function(t){var r=this.__entries__,n=e(r,t);~n&&r.splice(n,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,n=this.__entries__;r<n.length;r+=1){var i=n[r];e.call(t,i[1],i[0])}},Object.defineProperties(t.prototype,r),t}()}(),s="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,a="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),l="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(a):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},c=2,u=["top","right","bottom","left","width","height","size","weight"],d="undefined"!=typeof MutationObserver,h=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){function r(){o&&(o=!1,e()),s&&i()}function n(){l(r)}function i(){var e=Date.now();if(o){if(c>e-a)return;s=!0}else o=!0,s=!1,setTimeout(n,t);a=e}var o=!1,s=!1,a=0;return i}(this.refresh.bind(this),20)};h.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},h.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},h.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},h.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},h.prototype.connect_=function(){s&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),d?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},h.prototype.disconnect_=function(){s&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},h.prototype.onTransitionEnd_=function(e){var t=e.propertyName;void 0===t&&(t=""),u.some(function(e){return!!~t.indexOf(e)})&&this.refresh()},h.getInstance=function(){return this.instance_||(this.instance_=new h),this.instance_},h.instance_=null;var f=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r+=1){var i=n[r];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},p=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||a},m=i(0,0,0,0),g="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof p(e).SVGGraphicsElement}:function(e){return e instanceof p(e).SVGElement&&"function"==typeof e.getBBox},v=function(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=i(0,0,0,0),this.target=e};v.prototype.isActive=function(){var e=n(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},v.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e};var y=function(e,t){var r,n,i,o,s,a,l,c=(n=(r=t).x,i=r.y,o=r.width,s=r.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(a.prototype),f(l,{x:n,y:i,width:o,height:s,top:i,right:n+o,bottom:s+i,left:n}),l);f(this,{target:e,contentRect:c})},_=function(e,t,r){if(this.activeObservations_=[],this.observations_=new o,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r};_.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof p(e).Element))throw new TypeError('parameter 1 is not of type "Element".');
var t=this.observations_;t.has(e)||(t.set(e,new v(e)),this.controller_.addObserver(this),this.controller_.refresh())}},_.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof p(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t["delete"](e),t.size||this.controller_.removeObserver(this))}},_.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},_.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},_.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new y(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},_.prototype.clearActive=function(){this.activeObservations_.splice(0)},_.prototype.hasActive=function(){return this.activeObservations_.length>0};var b="undefined"!=typeof WeakMap?new WeakMap:new o,x=function(e){if(!(this instanceof x))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=h.getInstance(),r=new _(e,t,this);b.set(this,r)};return["observe","unobserve","disconnect"].forEach(function(e){x.prototype[e]=function(){return(t=b.get(this))[e].apply(t,arguments);var t}}),void 0!==a.ResizeObserver?a.ResizeObserver:x})},"./thirdparty/three.js/DDSLoader.js":function(e,t,r){"use strict";r.r(t),r.d(t,"DDSLoader",function(){return i});var n=r("./thirdparty/three.js/three.js"),i=(r.n(n),function o(){this._parser=o.parse});i.prototype=Object.create(n.CompressedTextureLoader.prototype),i.prototype.constructor=i,i.parse=function(e,t){function r(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function i(e,t,r,n){for(var i=r*n*4,o=new Uint8Array(e,t,i),s=new Uint8Array(i),a=0,l=0,c=0;n>c;c++)for(var u=0;r>u;u++){var d=o[l];l++;var h=o[l];l++;var f=o[l];l++;var p=o[l];l++,s[a]=f,a++,s[a]=h,a++,s[a]=d,a++,s[a]=p,a++}return s}var o={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},s=542327876,a=512,l=4,c=r("DXT1"),u=r("DXT3"),d=r("DXT5"),h=31,f=0,p=1,m=3,g=4,v=7,y=20,_=21,b=22,x=23,w=24,E=25,S=26,A=28,M=4*h;if(e.byteLength<M)return o;var T=new Int32Array(e,0,h);if(T[f]!==s)return o;if(!T[y]&l)return o;var C,j=T[_],P=!1;switch(j){case c:C=8,o.format=n.RGB_S3TC_DXT1_Format;break;case u:C=16,o.format=n.RGBA_S3TC_DXT3_Format;break;case d:C=16,o.format=n.RGBA_S3TC_DXT5_Format;break;default:if(!(32==T[b]&&16711680&T[x]&&65280&T[w]&&255&T[E]&&4278190080&T[S]))return o;P=!0,C=64,o.format=n.RGBAFormat}o.mipmapCount=1,T[v]>0&&t!==!1&&(o.mipmapCount=Math.max(1,T[v])),o.isCubemap=T[A]&a?!0:!1,o.width=T[g],o.height=T[m];for(var L=T[p]+4,D=o.width,I=o.height,R=o.isCubemap?6:1,O=0;R>O;O++){for(var k=0;k<o.mipmapCount;k++){if(P)var N=i(e,L,D,I),F=N.length;else var F=Math.max(4,D)/4*Math.max(4,I)/4*C,N=new Uint8Array(e,L,F);var V={data:N,width:D,height:I};o.mipmaps.push(V),L+=F,D=Math.max(.5*D,1),I=Math.max(.5*I,1)}D=o.width,I=o.height}return o}},"./thirdparty/three.js/three.js":function(e,t,r){(function(e){function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r={REVISION:"71"};"object"===t(e)&&(e.exports=r),void 0===Math.sign&&(Math.sign=function(e){return 0>e?-1:e>0?1:+e}),r.log=function(){},r.warn=function(){},r.error=function(){},r.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},r.CullFaceNone=0,r.CullFaceBack=1,r.CullFaceFront=2,r.CullFaceFrontBack=3,r.FrontFaceDirectionCW=0,r.FrontFaceDirectionCCW=1,r.BasicShadowMap=0,r.PCFShadowMap=1,r.PCFSoftShadowMap=2,r.FrontSide=0,r.BackSide=1,r.DoubleSide=2,r.NoShading=0,r.FlatShading=1,r.SmoothShading=2,r.NoColors=0,r.FaceColors=1,r.VertexColors=2,r.NoBlending=0,r.NormalBlending=1,r.AdditiveBlending=2,r.SubtractiveBlending=3,r.MultiplyBlending=4,r.CustomBlending=5,r.AddEquation=100,r.SubtractEquation=101,r.ReverseSubtractEquation=102,r.MinEquation=103,r.MaxEquation=104,r.ZeroFactor=200,r.OneFactor=201,r.SrcColorFactor=202,r.OneMinusSrcColorFactor=203,r.SrcAlphaFactor=204,r.OneMinusSrcAlphaFactor=205,r.DstAlphaFactor=206,r.OneMinusDstAlphaFactor=207,r.DstColorFactor=208,r.OneMinusDstColorFactor=209,r.SrcAlphaSaturateFactor=210,r.MultiplyOperation=0,r.MixOperation=1,r.AddOperation=2,r.UVMapping=300,r.CubeReflectionMapping=301,r.CubeRefractionMapping=302,r.EquirectangularReflectionMapping=303,r.EquirectangularRefractionMapping=304,r.SphericalReflectionMapping=305,r.RepeatWrapping=1e3,r.ClampToEdgeWrapping=1001,r.MirroredRepeatWrapping=1002,r.NearestFilter=1003,r.NearestMipMapNearestFilter=1004,r.NearestMipMapLinearFilter=1005,r.LinearFilter=1006,r.LinearMipMapNearestFilter=1007,r.LinearMipMapLinearFilter=1008,r.UnsignedByteType=1009,r.ByteType=1010,r.ShortType=1011,r.UnsignedShortType=1012,r.IntType=1013,r.UnsignedIntType=1014,r.FloatType=1015,r.HalfFloatType=1025,r.UnsignedShort4444Type=1016,r.UnsignedShort5551Type=1017,r.UnsignedShort565Type=1018,r.AlphaFormat=1019,r.RGBFormat=1020,r.RGBAFormat=1021,r.LuminanceFormat=1022,r.LuminanceAlphaFormat=1023,r.RGBEFormat=r.RGBAFormat,r.RGB_S3TC_DXT1_Format=2001,r.RGBA_S3TC_DXT1_Format=2002,r.RGBA_S3TC_DXT3_Format=2003,r.RGBA_S3TC_DXT5_Format=2004,r.RGB_PVRTC_4BPPV1_Format=2100,r.RGB_PVRTC_2BPPV1_Format=2101,r.RGBA_PVRTC_4BPPV1_Format=2102,r.RGBA_PVRTC_2BPPV1_Format=2103,r.Projector=function(){r.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){r.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){r.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){r.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},r.CanvasRenderer=function(){r.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},r.Color=function(e){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(e)},r.Color.prototype={constructor:r.Color,r:1,g:1,b:1,set:function(e){return e instanceof r.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(e,t,r){if(0===t)this.r=this.g=this.b=r;else{var n=function(e,t,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?e+6*(t-e)*r:.5>r?t:2/3>r?e+6*(t-e)*(2/3-r):e},i=.5>=r?r*(1+t):r+t-r*t,o=2*r-i;this.r=n(o,i,e+1/3),this.g=n(o,i,e),this.b=n(o,i,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e)){var t=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e);return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,this}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(e)){var t=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(e);return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(e)){var t=/^\#([0-9a-f]{6})$/i.exec(e);return this.setHex(parseInt(t[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){var t=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);return this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16)),this}return/^(\w+)$/i.test(e)?(this.setHex(r.ColorKeywords[e]),this):void 0},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function(){var e=this.r,t=this.g,r=this.b;return this.r=e*e,this.g=t*t,this.b=r*r,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,r,n=e||{h:0,s:0,l:0},i=this.r,o=this.g,s=this.b,a=Math.max(i,o,s),l=Math.min(i,o,s),c=(l+a)/2;if(l===a)t=0,r=0;else{var u=a-l;switch(r=.5>=c?u/(a+l):u/(2-a-l),a){case i:t=(o-s)/u+(s>o?6:0);break;case o:t=(s-i)/u+2;break;case s:t=(i-o)/u+4}t/=6}return n.h=t,n.s=r,n.l=c,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,r){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=r,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e){return this.r=e[0],this.g=e[1],this.b=e[2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},clone:function(){return(new r.Color).setRGB(this.r,this.g,this.b)}},r.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},r.Quaternion=function(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0!==n?n:1},r.Quaternion.prototype={constructor:r.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get w(){return this._w},set w(e){this._w=e,this.onChangeCallback()},set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this.onChangeCallback(),this},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(e instanceof r.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(e._x/2),i=Math.cos(e._y/2),o=Math.cos(e._z/2),s=Math.sin(e._x/2),a=Math.sin(e._y/2),l=Math.sin(e._z/2);return"XYZ"===e.order?(this._x=s*i*o+n*a*l,this._y=n*a*o-s*i*l,this._z=n*i*l+s*a*o,this._w=n*i*o-s*a*l):"YXZ"===e.order?(this._x=s*i*o+n*a*l,this._y=n*a*o-s*i*l,this._z=n*i*l-s*a*o,this._w=n*i*o+s*a*l):"ZXY"===e.order?(this._x=s*i*o-n*a*l,this._y=n*a*o+s*i*l,this._z=n*i*l+s*a*o,this._w=n*i*o-s*a*l):"ZYX"===e.order?(this._x=s*i*o-n*a*l,this._y=n*a*o+s*i*l,this._z=n*i*l-s*a*o,this._w=n*i*o+s*a*l):"YZX"===e.order?(this._x=s*i*o+n*a*l,this._y=n*a*o+s*i*l,this._z=n*i*l-s*a*o,this._w=n*i*o-s*a*l):"XZY"===e.order&&(this._x=s*i*o-n*a*l,this._y=n*a*o-s*i*l,this._z=n*i*l+s*a*o,this._w=n*i*o+s*a*l),t!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,r=e.elements,n=r[0],i=r[4],o=r[8],s=r[1],a=r[5],l=r[9],c=r[2],u=r[6],d=r[10],h=n+a+d;return h>0?(t=.5/Math.sqrt(h+1),this._w=.25/t,this._x=(u-l)*t,this._y=(o-c)*t,this._z=(s-i)*t):n>a&&n>d?(t=2*Math.sqrt(1+n-a-d),this._w=(u-l)/t,this._x=.25*t,this._y=(i+s)/t,this._z=(o+c)/t):a>d?(t=2*Math.sqrt(1+a-n-d),this._w=(o-c)/t,this._x=(i+s)/t,this._y=.25*t,this._z=(l+u)/t):(t=2*Math.sqrt(1+d-n-a),this._w=(s-i)/t,this._x=(o+c)/t,this._y=(l+u)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t,n=1e-6;return function(i,o){return void 0===e&&(e=new r.Vector3),t=i.dot(o)+1,n>t?(t=0,Math.abs(i.x)>Math.abs(i.z)?e.set(-i.y,i.x,0):e.set(0,-i.z,i.y)):e.crossVectors(i,o),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(r.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,o=e._w,s=t._x,a=t._y,l=t._z,c=t._w;return this._x=r*c+o*s+n*l-i*a,this._y=n*c+o*a+i*s-r*l,this._z=i*c+o*l+r*a-n*s,this._w=o*c-r*s-n*a-i*l,this.onChangeCallback(),this},multiplyVector3:function(e){return r.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,o=this._w,s=o*e._w+r*e._x+n*e._y+i*e._z;if(0>s?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;var a=Math.acos(s),l=Math.sqrt(1-s*s);if(Math.abs(l)<.001)return this._w=.5*(o+this._w),this._x=.5*(r+this._x),this._y=.5*(n+this._y),this._z=.5*(i+this._z),this;var c=Math.sin((1-t)*a)/l,u=Math.sin(t*a)/l;return this._w=o*c+this._w*u,this._x=r*c+this._x*u,this._y=n*c+this._y*u,this._z=i*c+this._z*u,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new r.Quaternion(this._x,this._y,this._z,this._w)}},r.Quaternion.slerp=function(e,t,r,n){return r.copy(e).slerp(t,n)},r.Vector2=function(e,t){this.x=e||0,this.y=t||0},r.Vector2.prototype={constructor:r.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(r.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},sub:function(e,t){return void 0!==t?(r.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t}else this.x=0,this.y=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},clampScalar:function(){var e,t;return function(n,i){return void 0===e&&(e=new r.Vector2,t=new r.Vector2),e.set(n,n),t.set(i,i),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromAttribute:function(e,t,r){return void 0===r&&(r=0),t=t*e.itemSize+r,this.x=e.array[t],this.y=e.array[t+1],this},clone:function(){return new r.Vector2(this.x,this.y)}},r.Vector3=function(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0},r.Vector3.prototype={constructor:r.Vector3,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(r.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(r.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(r.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e;return function(t){return t instanceof r.Euler==!1&&r.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===e&&(e=new r.Quaternion),this.applyQuaternion(e.setFromEuler(t)),this}}(),applyAxisAngle:function(){var e;return function(t,n){return void 0===e&&(e=new r.Quaternion),this.applyQuaternion(e.setFromAxisAngle(t,n)),this}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n+i[12],this.y=i[1]*t+i[5]*r+i[9]*n+i[13],this.z=i[2]*t+i[6]*r+i[10]*n+i[14],this},applyProjection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,o=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,s=e.z,a=e.w,l=a*t+o*n-s*r,c=a*r+s*t-i*n,u=a*n+i*r-o*t,d=-i*t-o*r-s*n;return this.x=l*a+d*-i+c*-s-u*-o,this.y=c*a+d*-o+u*-i-l*-s,this.z=u*a+d*-s+l*-o-c*-i,this},project:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyProjection(e)}}(),unproject:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyProjection(e)}}(),transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(){var e,t;return function(n,i){return void 0===e&&(e=new r.Vector3,t=new r.Vector3),e.set(n,n,n),t.set(i,i,i),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e),this},cross:function(e,t){if(void 0!==t)return r.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,i=this.y,o=this.z;return this.x=i*e.z-o*e.y,this.y=o*e.x-n*e.z,this.z=n*e.y-i*e.x,this},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,s=t.y,a=t.z;return this.x=n*a-i*s,this.y=i*o-r*a,this.z=r*s-n*o,this},projectOnVector:function(){var e,t;return function(n){return void 0===e&&(e=new r.Vector3),e.copy(n).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new r.Vector3),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new r.Vector3),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos(r.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},setEulerFromRotationMatrix:function(e,t){r.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(e,t){r.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return r.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return r.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return r.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),r=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),n=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){var r=4*e,n=t.elements;return this.x=n[r],this.y=n[r+1],this.z=n[r+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,r){return void 0===r&&(r=0),t=t*e.itemSize+r,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this},clone:function(){return new r.Vector3(this.x,this.y,this.z)}},r.Vector4=function(e,t,r,n){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0!==n?n:1},r.Vector4.prototype={constructor:r.Vector4,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(r.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},sub:function(e,t){return void 0!==t?(r.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*i,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t,this.w*=t}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,o=.01,s=.1,a=e.elements,l=a[0],c=a[4],u=a[8],d=a[1],h=a[5],f=a[9],p=a[2],m=a[6],g=a[10];if(Math.abs(c-d)<o&&Math.abs(u-p)<o&&Math.abs(f-m)<o){if(Math.abs(c+d)<s&&Math.abs(u+p)<s&&Math.abs(f+m)<s&&Math.abs(l+h+g-3)<s)return this.set(1,0,0,0),this;t=Math.PI;var v=(l+1)/2,y=(h+1)/2,_=(g+1)/2,b=(c+d)/4,x=(u+p)/4,w=(f+m)/4;return v>y&&v>_?o>v?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(v),n=b/r,i=x/r):y>_?o>y?(r=.707106781,
n=0,i=.707106781):(n=Math.sqrt(y),r=b/n,i=w/n):o>_?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(_),r=x/i,n=w/i),this.set(r,n,i,t),this}var E=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(d-c)*(d-c));return Math.abs(E)<.001&&(E=1),this.x=(m-f)/E,this.y=(u-p)/E,this.z=(d-c)/E,this.w=Math.acos((l+h+g-1)/2),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},clampScalar:function(){var e,t;return function(n,i){return void 0===e&&(e=new r.Vector4,t=new r.Vector4),e.set(n,n,n,n),t.set(i,i,i,i),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromAttribute:function(e,t,r){return void 0===r&&(r=0),t=t*e.itemSize+r,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this.w=e.array[t+3],this},clone:function(){return new r.Vector4(this.x,this.y,this.z,this.w)}},r.Euler=function(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._order=i||r.Euler.DefaultOrder},r.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],r.Euler.DefaultOrder="XYZ",r.Euler.prototype={constructor:r.Euler,_x:0,_y:0,_z:0,_order:r.Euler.DefaultOrder,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get order(){return this._order},set order(e){this._order=e,this.onChangeCallback()},set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var i=r.Math.clamp,o=e.elements,s=o[0],a=o[4],l=o[8],c=o[1],u=o[5],d=o[9],h=o[2],f=o[6],p=o[10];return t=t||this._order,"XYZ"===t?(this._y=Math.asin(i(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(f,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-i(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,s),this._z=0)):"ZXY"===t?(this._x=Math.asin(i(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,s))):"ZYX"===t?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===t?(this._z=Math.asin(i(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(l,p))):"XZY"===t?(this._z=Math.asin(-i(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,s)):(this._x=Math.atan2(-d,p),this._y=0)):r.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,n!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var e;return function(t,n,i){return void 0===e&&(e=new r.Matrix4),e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,i),this}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new r.Quaternion;return function(t){e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new r.Vector3(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new r.Euler(this._x,this._y,this._z,this._order)}},r.Line3=function(e,t){this.start=void 0!==e?e:new r.Vector3,this.end=void 0!==t?t:new r.Vector3},r.Line3.prototype={constructor:r.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){var t=e||new r.Vector3;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new r.Vector3;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var n=t||new r.Vector3;return this.delta(n).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new r.Vector3,t=new r.Vector3;return function(n,i){e.subVectors(n,this.start),t.subVectors(this.end,this.start);var o=t.dot(t),s=t.dot(e),a=s/o;return i&&(a=r.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(e,t,n){var i=this.closestPointToPointParameter(e,t),o=n||new r.Vector3;return this.delta(o).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new r.Line3).copy(this)}},r.Box2=function(e,t){this.min=void 0!==e?e:new r.Vector2(1/0,1/0),this.max=void 0!==t?t:new r.Vector2(-(1/0),-(1/0))},r.Box2.prototype={constructor:r.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;r>t;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new r.Vector2;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){var t=e||new r.Vector2;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new r.Vector2;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y?!0:!1},getParameter:function(e,t){var n=t||new r.Vector2;return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?!1:!0},clampPoint:function(e,t){var n=t||new r.Vector2;return n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new r.Vector2;return function(t){var r=e.copy(t).clamp(this.min,this.max);return r.sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new r.Box2).copy(this)}},r.Box3=function(e,t){this.min=void 0!==e?e:new r.Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new r.Vector3(-(1/0),-(1/0),-(1/0))},r.Box3.prototype={constructor:r.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;r>t;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new r.Vector3;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(){var e=new r.Vector3;return function(t){var n=this;return t.updateMatrixWorld(!0),this.makeEmpty(),t.traverse(function(t){var i=t.geometry;if(void 0!==i)if(i instanceof r.Geometry)for(var o=i.vertices,s=0,a=o.length;a>s;s++)e.copy(o[s]),e.applyMatrix4(t.matrixWorld),n.expandByPoint(e);else if(i instanceof r.BufferGeometry&&void 0!==i.attributes.position)for(var l=i.attributes.position.array,s=0,a=l.length;a>s;s+=3)e.set(l[s],l[s+1],l[s+2]),e.applyMatrix4(t.matrixWorld),n.expandByPoint(e)}),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){var t=e||new r.Vector3;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new r.Vector3;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e,t){var n=t||new r.Vector3;return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},clampPoint:function(e,t){var n=t||new r.Vector3;return n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new r.Vector3;return function(t){var r=e.copy(t).clamp(this.min,this.max);return r.sub(t).length()}}(),getBoundingSphere:function(){var e=new r.Vector3;return function(t){var n=t||new r.Sphere;return n.center=this.center(),n.radius=.5*this.size(e).length(),n}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3];return function(t){return e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(e),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new r.Box3).copy(this)}},r.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&r.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},r.Matrix3.prototype={constructor:r.Matrix3,set:function(e,t,r,n,i,o,s,a,l){var c=this.elements;return c[0]=e,c[3]=t,c[6]=r,c[1]=n,c[4]=i,c[7]=o,c[2]=s,c[5]=a,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(e){return r.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){return r.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new r.Vector3;return function(t,r,n){void 0===r&&(r=0),void 0===n&&(n=t.length);for(var i=0,o=r;n>i;i+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix3(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8];return t*o*c-t*s*l-r*i*c+r*s*a+n*i*l-n*o*a},getInverse:function(e,t){var n=e.elements,i=this.elements;i[0]=n[10]*n[5]-n[6]*n[9],i[1]=-n[10]*n[1]+n[2]*n[9],i[2]=n[6]*n[1]-n[2]*n[5],i[3]=-n[10]*n[4]+n[6]*n[8],i[4]=n[10]*n[0]-n[2]*n[8],i[5]=-n[6]*n[0]+n[2]*n[4],i[6]=n[9]*n[4]-n[5]*n[8],i[7]=-n[9]*n[0]+n[1]*n[8],i[8]=n[5]*n[0]-n[1]*n[4];var o=n[0]*i[0]+n[1]*i[3]+n[2]*i[6];if(0===o){var s="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(s);return r.warn(s),this.identity(),this}return this.multiplyScalar(1/o),this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},flattenToArrayOffset:function(e,t){var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},clone:function(){return(new r.Matrix3).fromArray(this.elements)}},r.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&r.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},r.Matrix4.prototype={constructor:r.Matrix4,set:function(e,t,r,n,i,o,s,a,l,c,u,d,h,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},extractPosition:function(e){return r.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){var n=this.elements;return e.set(n[0],n[1],n[2]),t.set(n[4],n[5],n[6]),r.set(n[8],n[9],n[10]),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(){var e=new r.Vector3;return function(t){var r=this.elements,n=t.elements,i=1/e.set(n[0],n[1],n[2]).length(),o=1/e.set(n[4],n[5],n[6]).length(),s=1/e.set(n[8],n[9],n[10]).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[8]=n[8]*s,r[9]=n[9]*s,r[10]=n[10]*s,this}}(),makeRotationFromEuler:function(e){e instanceof r.Euler==!1&&r.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,i=e.y,o=e.z,s=Math.cos(n),a=Math.sin(n),l=Math.cos(i),c=Math.sin(i),u=Math.cos(o),d=Math.sin(o);if("XYZ"===e.order){var h=s*u,f=s*d,p=a*u,m=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+p*c,t[5]=h-m*c,t[9]=-a*l,t[2]=m-h*c,t[6]=p+f*c,t[10]=s*l}else if("YXZ"===e.order){var g=l*u,v=l*d,y=c*u,_=c*d;t[0]=g+_*a,t[4]=y*a-v,t[8]=s*c,t[1]=s*d,t[5]=s*u,t[9]=-a,t[2]=v*a-y,t[6]=_+g*a,t[10]=s*l}else if("ZXY"===e.order){var g=l*u,v=l*d,y=c*u,_=c*d;t[0]=g-_*a,t[4]=-s*d,t[8]=y+v*a,t[1]=v+y*a,t[5]=s*u,t[9]=_-g*a,t[2]=-s*c,t[6]=a,t[10]=s*l}else if("ZYX"===e.order){var h=s*u,f=s*d,p=a*u,m=a*d;t[0]=l*u,t[4]=p*c-f,t[8]=h*c+m,t[1]=l*d,t[5]=m*c+h,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=s*l}else if("YZX"===e.order){var b=s*l,x=s*c,w=a*l,E=a*c;t[0]=l*u,t[4]=E-b*d,t[8]=w*d+x,t[1]=d,t[5]=s*u,t[9]=-a*u,t[2]=-c*u,t[6]=x*d+w,t[10]=b-E*d}else if("XZY"===e.order){var b=s*l,x=s*c,w=a*l,E=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=b*d+E,t[5]=s*u,t[9]=x*d-w,t[2]=w*d-x,t[6]=a*u,t[10]=E*d+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},setRotationFromQuaternion:function(e){return r.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z,o=e.w,s=r+r,a=n+n,l=i+i,c=r*s,u=r*a,d=r*l,h=n*a,f=n*l,p=i*l,m=o*s,g=o*a,v=o*l;return t[0]=1-(h+p),t[4]=u-v,t[8]=d+g,t[1]=u+v,t[5]=1-(c+p),t[9]=f-m,t[2]=d-g,t[6]=f+m,t[10]=1-(c+h),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new r.Vector3,t=new r.Vector3,n=new r.Vector3;return function(r,i,o){var s=this.elements;return n.subVectors(r,i).normalize(),0===n.length()&&(n.z=1),e.crossVectors(o,n).normalize(),0===e.length()&&(n.x+=1e-4,e.crossVectors(o,n).normalize()),t.crossVectors(n,e),s[0]=e.x,s[4]=t.x,s[8]=n.x,s[1]=e.y,s[5]=t.y,s[9]=n.y,s[2]=e.z,s[6]=t.z,s[10]=n.z,this}}(),multiply:function(e,t){return void 0!==t?(r.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],s=r[4],a=r[8],l=r[12],c=r[1],u=r[5],d=r[9],h=r[13],f=r[2],p=r[6],m=r[10],g=r[14],v=r[3],y=r[7],_=r[11],b=r[15],x=n[0],w=n[4],E=n[8],S=n[12],A=n[1],M=n[5],T=n[9],C=n[13],j=n[2],P=n[6],L=n[10],D=n[14],I=n[3],R=n[7],O=n[11],k=n[15];return i[0]=o*x+s*A+a*j+l*I,i[4]=o*w+s*M+a*P+l*R,i[8]=o*E+s*T+a*L+l*O,i[12]=o*S+s*C+a*D+l*k,i[1]=c*x+u*A+d*j+h*I,i[5]=c*w+u*M+d*P+h*R,i[9]=c*E+u*T+d*L+h*O,i[13]=c*S+u*C+d*D+h*k,i[2]=f*x+p*A+m*j+g*I,i[6]=f*w+p*M+m*P+g*R,i[10]=f*E+p*T+m*L+g*O,i[14]=f*S+p*C+m*D+g*k,i[3]=v*x+y*A+_*j+b*I,i[7]=v*w+y*M+_*P+b*R,i[11]=v*E+y*T+_*L+b*O,i[15]=v*S+y*C+_*D+b*k,this},multiplyToArray:function(e,t,r){var n=this.elements;return this.multiplyMatrices(e,t),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return r.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return r.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){return r.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new r.Vector3;return function(t,r,n){void 0===r&&(r=0),void 0===n&&(n=t.length);for(var i=0,o=r;n>i;i+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix4(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}(),rotateAxis:function(e){r.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return r.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],s=e[5],a=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14],f=e[3],p=e[7],m=e[11],g=e[15];return f*(+i*a*u-n*l*u-i*s*d+r*l*d+n*s*h-r*a*h)+p*(+t*a*h-t*l*d+i*o*d-n*o*h+n*l*c-i*a*c)+m*(+t*l*u-t*s*h-i*o*u+r*o*h+i*s*c-r*l*c)+g*(-n*s*c-t*a*u+t*s*d+n*o*u-r*o*d+r*a*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e},getPosition:function(){var e=new r.Vector3;return function(){r.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,i=e.elements,o=i[0],s=i[4],a=i[8],l=i[12],c=i[1],u=i[5],d=i[9],h=i[13],f=i[2],p=i[6],m=i[10],g=i[14],v=i[3],y=i[7],_=i[11],b=i[15];n[0]=d*g*y-h*m*y+h*p*_-u*g*_-d*p*b+u*m*b,n[4]=l*m*y-a*g*y-l*p*_+s*g*_+a*p*b-s*m*b,n[8]=a*h*y-l*d*y+l*u*_-s*h*_-a*u*b+s*d*b,n[12]=l*d*p-a*h*p-l*u*m+s*h*m+a*u*g-s*d*g,n[1]=h*m*v-d*g*v-h*f*_+c*g*_+d*f*b-c*m*b,n[5]=a*g*v-l*m*v+l*f*_-o*g*_-a*f*b+o*m*b,n[9]=l*d*v-a*h*v-l*c*_+o*h*_+a*c*b-o*d*b,n[13]=a*h*f-l*d*f+l*c*m-o*h*m-a*c*g+o*d*g,n[2]=u*g*v-h*p*v+h*f*y-c*g*y-u*f*b+c*p*b,n[6]=l*p*v-s*g*v-l*f*y+o*g*y+s*f*b-o*p*b,n[10]=s*h*v-l*u*v+l*c*y-o*h*y-s*c*b+o*u*b,n[14]=l*u*f-s*h*f-l*c*p+o*h*p+s*c*g-o*u*g,n[3]=d*p*v-u*m*v-d*f*y+c*m*y+u*f*_-c*p*_,n[7]=s*m*v-a*p*v+a*f*y-o*m*y-s*f*_+o*p*_,n[11]=a*u*v-s*d*v-a*c*y+o*d*y+s*c*_-o*u*_,n[15]=s*d*f-a*u*f+a*c*p-o*d*p-s*c*m+o*u*m;var x=o*n[0]+c*n[4]+f*n[8]+v*n[12];if(0==x){var w="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(w);return r.warn(w),this.identity(),this}return this.multiplyScalar(1/x),this},translate:function(e){r.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(e){r.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(e){r.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(e){r.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(e,t){r.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(r,n)))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,s=e.y,a=e.z,l=i*o,c=i*s;return this.set(l*o+r,l*s-n*a,l*a+n*s,0,l*s+n*a,c*s+r,c*a-n*o,0,l*a-n*s,c*a+n*o,i*a*a+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},compose:function(e,t,r){return this.makeRotationFromQuaternion(t),this.scale(r),this.setPosition(e),this},decompose:function(){var e=new r.Vector3,t=new r.Matrix4;return function(r,n,i){var o=this.elements,s=e.set(o[0],o[1],o[2]).length(),a=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length(),c=this.determinant();0>c&&(s=-s),r.x=o[12],r.y=o[13],r.z=o[14],t.elements.set(this.elements);var u=1/s,d=1/a,h=1/l;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=d,t.elements[5]*=d,t.elements[6]*=d,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),i.x=s,i.y=a,i.z=l,this}}(),makeFrustum:function(e,t,r,n,i,o){var s=this.elements,a=2*i/(t-e),l=2*i/(n-r),c=(t+e)/(t-e),u=(n+r)/(n-r),d=-(o+i)/(o-i),h=-2*o*i/(o-i);return s[0]=a,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=l,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=d,s[14]=h,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makePerspective:function(e,t,n,i){var o=n*Math.tan(r.Math.degToRad(.5*e)),s=-o,a=s*t,l=o*t;return this.makeFrustum(a,l,s,o,n,i)},makeOrthographic:function(e,t,r,n,i,o){var s=this.elements,a=t-e,l=r-n,c=o-i,u=(t+e)/a,d=(r+n)/l,h=(o+i)/c;return s[0]=2/a,s[4]=0,s[8]=0,s[12]=-u,s[1]=0,s[5]=2/l,s[9]=0,s[13]=-d,s[2]=0,s[6]=0,s[10]=-2/c,s[14]=-h,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return(new r.Matrix4).fromArray(this.elements)}},r.Ray=function(e,t){this.origin=void 0!==e?e:new r.Vector3,this.direction=void 0!==t?t:new r.Vector3},r.Ray.prototype={constructor:r.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){var n=t||new r.Vector3;return n.copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new r.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var n=t||new r.Vector3;n.subVectors(e,this.origin);var i=n.dot(this.direction);return 0>i?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(){var e=new r.Vector3;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return 0>r?this.origin.distanceTo(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceTo(t))}}(),distanceSqToSegment:function(){var e=new r.Vector3,t=new r.Vector3,n=new r.Vector3;return function(r,i,o,s){e.copy(r).add(i).multiplyScalar(.5),t.copy(i).sub(r).normalize(),n.copy(this.origin).sub(e);var a,l,c,u,d=.5*r.distanceTo(i),h=-this.direction.dot(t),f=n.dot(this.direction),p=-n.dot(t),m=n.lengthSq(),g=Math.abs(1-h*h);if(g>0)if(a=h*p-f,l=h*f-p,u=d*g,a>=0)if(l>=-u)if(u>=l){var v=1/g;a*=v,l*=v,c=a*(a+h*l+2*f)+l*(h*a+l+2*p)+m}else l=d,a=Math.max(0,-(h*l+f)),c=-a*a+l*(l+2*p)+m;else l=-d,a=Math.max(0,-(h*l+f)),c=-a*a+l*(l+2*p)+m;else-u>=l?(a=Math.max(0,-(-h*d+f)),l=a>0?-d:Math.min(Math.max(-d,-p),d),c=-a*a+l*(l+2*p)+m):u>=l?(a=0,l=Math.min(Math.max(-d,-p),d),c=l*(l+2*p)+m):(a=Math.max(0,-(h*d+f)),l=a>0?d:Math.min(Math.max(-d,-p),d),c=-a*a+l*(l+2*p)+m);else l=h>0?-d:d,a=Math.max(0,-(h*l+f)),c=-a*a+l*(l+2*p)+m;return o&&o.copy(this.direction).multiplyScalar(a).add(this.origin),s&&s.copy(t).multiplyScalar(l).add(e),c}}(),isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},intersectSphere:function(){var e=new r.Vector3;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,o=t.radius*t.radius;if(i>o)return null;var s=Math.sqrt(o-i),a=n-s,l=n+s;return 0>a&&0>l?null:0>a?this.at(l,r):this.at(a,r)}}(),isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);if(0===t)return!0;var r=e.normal.dot(this.direction);return 0>r*t?!0:!1},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0==t)return 0==e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},isIntersectionBox:function(){var e=new r.Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectBox:function(e,t){var r,n,i,o,s,a,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,d=this.origin;return l>=0?(r=(e.min.x-d.x)*l,n=(e.max.x-d.x)*l):(r=(e.max.x-d.x)*l,n=(e.min.x-d.x)*l),c>=0?(i=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(i=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),r>o||i>n?null:((i>r||r!==r)&&(r=i),(n>o||n!==n)&&(n=o),u>=0?(s=(e.min.z-d.z)*u,a=(e.max.z-d.z)*u):(s=(e.max.z-d.z)*u,a=(e.min.z-d.z)*u),r>a||s>n?null:((s>r||r!==r)&&(r=s),(n>a||n!==n)&&(n=a),0>n?null:this.at(r>=0?r:n,t)))},intersectTriangle:function(){var e=new r.Vector3,t=new r.Vector3,n=new r.Vector3,i=new r.Vector3;return function(r,o,s,a,l){t.subVectors(o,r),n.subVectors(s,r),i.crossVectors(t,n);var c,u=this.direction.dot(i);if(u>0){if(a)return null;c=1}else{if(!(0>u))return null;c=-1,u=-u}e.subVectors(this.origin,r);var d=c*this.direction.dot(n.crossVectors(e,n));if(0>d)return null;var h=c*this.direction.dot(t.cross(e));if(0>h)return null;if(d+h>u)return null;var f=-c*e.dot(i);return 0>f?null:this.at(f/u,l)}}(),applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new r.Ray).copy(this)}},r.Sphere=function(e,t){this.center=void 0!==e?e:new r.Vector3,this.radius=void 0!==t?t:0},r.Sphere.prototype={constructor:r.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new r.Box3;return function(t,r){var n=this.center;void 0!==r?n.copy(r):e.setFromPoints(t).center(n);for(var i=0,o=0,s=t.length;s>o;o++)i=Math.max(i,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(i),this}}(),copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var n=this.center.distanceToSquared(e),i=t||new r.Vector3;return i.copy(e),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),
i},getBoundingBox:function(e){var t=e||new r.Box3;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new r.Sphere).copy(this)}},r.Frustum=function(e,t,n,i,o,s){this.planes=[void 0!==e?e:new r.Plane,void 0!==t?t:new r.Plane,void 0!==n?n:new r.Plane,void 0!==i?i:new r.Plane,void 0!==o?o:new r.Plane,void 0!==s?s:new r.Plane]},r.Frustum.prototype={constructor:r.Frustum,set:function(e,t,r,n,i,o){var s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(r),s[3].copy(n),s[4].copy(i),s[5].copy(o),this},copy:function(e){for(var t=this.planes,r=0;6>r;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],l=r[5],c=r[6],u=r[7],d=r[8],h=r[9],f=r[10],p=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(s-n,u-a,p-d,y-m).normalize(),t[1].setComponents(s+n,u+a,p+d,y+m).normalize(),t[2].setComponents(s+i,u+l,p+h,y+g).normalize(),t[3].setComponents(s-i,u-l,p-h,y-g).normalize(),t[4].setComponents(s-o,u-c,p-f,y-v).normalize(),t[5].setComponents(s+o,u+c,p+f,y+v).normalize(),this},intersectsObject:function(){var e=new r.Sphere;return function(t){var r=t.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere),e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,r=e.center,n=-e.radius,i=0;6>i;i++){var o=t[i].distanceToPoint(r);if(n>o)return!1}return!0},intersectsBox:function(){var e=new r.Vector3,t=new r.Vector3;return function(r){for(var n=this.planes,i=0;6>i;i++){var o=n[i];e.x=o.normal.x>0?r.min.x:r.max.x,t.x=o.normal.x>0?r.max.x:r.min.x,e.y=o.normal.y>0?r.min.y:r.max.y,t.y=o.normal.y>0?r.max.y:r.min.y,e.z=o.normal.z>0?r.min.z:r.max.z,t.z=o.normal.z>0?r.max.z:r.min.z;var s=o.distanceToPoint(e),a=o.distanceToPoint(t);if(0>s&&0>a)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,r=0;6>r;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0},clone:function(){return(new r.Frustum).copy(this)}},r.Plane=function(e,t){this.normal=void 0!==e?e:new r.Vector3(1,0,0),this.constant=void 0!==t?t:0},r.Plane.prototype={constructor:r.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new r.Vector3,t=new r.Vector3;return function(r,n,i){var o=e.subVectors(i,n).cross(t.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,r),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var n=this.distanceToPoint(e),i=t||new r.Vector3;return i.copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return 0>t&&r>0||0>r&&t>0},intersectLine:function(){var e=new r.Vector3;return function(t,n){var i=n||new r.Vector3,o=t.delta(e),s=this.normal.dot(o);if(0!=s){var a=-(t.start.dot(this.normal)+this.constant)/s;if(!(0>a||a>1))return i.copy(o).multiplyScalar(a).add(t.start)}else if(0==this.distanceToPoint(t.start))return i.copy(t.start)}}(),coplanarPoint:function(e){var t=e||new r.Vector3;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new r.Vector3,t=new r.Vector3,n=new r.Matrix3;return function(r,i){var o=i||n.getNormalMatrix(r),s=e.copy(this.normal).applyMatrix3(o);s.normalize();var a=this.coplanarPoint(t);return a.applyMatrix4(r),this.setFromNormalAndCoplanarPoint(s,a),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new r.Plane).copy(this)}},r.Math={generateUUID:function(){var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=new Array(36),n=0;return function(){for(var i=0;36>i;i++)8==i||13==i||18==i||23==i?r[i]="-":14==i?r[i]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),e=15&n,n>>=4,r[i]=t[19==i?3&e|8:e]);return r.join("")}}(),clamp:function(e,t,r){return t>e?t:e>r?r:e},clampBottom:function(e,t){return t>e?t:e},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},smoothstep:function(e,t,r){return t>=e?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))},smootherstep:function(e,t,r){return t>=e?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(6*e-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return Math.floor(this.randFloat(e,t))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}(),isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e}},r.Spline=function(e){function t(e,t,r,n,i,o,s){var a=.5*(r-e),l=.5*(n-t);return(2*(t-r)+a+l)*s+(-3*(t-r)-2*a-l)*o+a*i+t}this.points=e;var n,i,o,s,a,l,c,u,d,h=[],f={x:0,y:0,z:0};this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return n=(this.points.length-1)*e,i=Math.floor(n),o=n-i,h[0]=0===i?i:i-1,h[1]=i,h[2]=i>this.points.length-2?this.points.length-1:i+1,h[3]=i>this.points.length-3?this.points.length-1:i+2,l=this.points[h[0]],c=this.points[h[1]],u=this.points[h[2]],d=this.points[h[3]],s=o*o,a=o*s,f.x=t(l.x,c.x,u.x,d.x,o,s,a),f.y=t(l.y,c.y,u.y,d.y,o,s,a),f.z=t(l.z,c.z,u.z,d.z,o,s,a),f},this.getControlPointsArray=function(){var e,t,r=this.points.length,n=[];for(e=0;r>e;e++)t=this.points[e],n[e]=[t.x,t.y,t.z];return n},this.getLength=function(e){var t,n,i,o,s=0,a=0,l=0,c=new r.Vector3,u=new r.Vector3,d=[],h=0;for(d[0]=0,e||(e=100),i=this.points.length*e,c.copy(this.points[0]),t=1;i>t;t++)n=t/i,o=this.getPoint(n),u.copy(o),h+=u.distanceTo(c),c.copy(o),s=(this.points.length-1)*n,a=Math.floor(s),a!=l&&(d[a]=h,l=a);return d[d.length]=h,{chunks:d,total:h}},this.reparametrizeByArcLength=function(e){var t,n,i,o,s,a,l,c,u=[],d=new r.Vector3,h=this.getLength();for(u.push(d.copy(this.points[0]).clone()),t=1;t<this.points.length;t++){for(a=h.chunks[t]-h.chunks[t-1],l=Math.ceil(e*a/h.total),o=(t-1)/(this.points.length-1),s=t/(this.points.length-1),n=1;l-1>n;n++)i=o+n*(1/l)*(s-o),c=this.getPoint(i),u.push(d.copy(c).clone());u.push(d.copy(this.points[t]).clone())}this.points=u}},r.Triangle=function(e,t,n){this.a=void 0!==e?e:new r.Vector3,this.b=void 0!==t?t:new r.Vector3,this.c=void 0!==n?n:new r.Vector3},r.Triangle.normal=function(){var e=new r.Vector3;return function(t,n,i,o){var s=o||new r.Vector3;s.subVectors(i,n),e.subVectors(t,n),s.cross(e);var a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}}(),r.Triangle.barycoordFromPoint=function(){var e=new r.Vector3,t=new r.Vector3,n=new r.Vector3;return function(i,o,s,a,l){e.subVectors(a,o),t.subVectors(s,o),n.subVectors(i,o);var c=e.dot(e),u=e.dot(t),d=e.dot(n),h=t.dot(t),f=t.dot(n),p=c*h-u*u,m=l||new r.Vector3;if(0==p)return m.set(-2,-1,-1);var g=1/p,v=(h*d-u*f)*g,y=(c*f-u*d)*g;return m.set(1-v-y,y,v)}}(),r.Triangle.containsPoint=function(){var e=new r.Vector3;return function(t,n,i,o){var s=r.Triangle.barycoordFromPoint(t,n,i,o,e);return s.x>=0&&s.y>=0&&s.x+s.y<=1}}(),r.Triangle.prototype={constructor:r.Triangle,set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new r.Vector3,t=new r.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){var t=e||new r.Vector3;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return r.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new r.Plane;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return r.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return r.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new r.Triangle).copy(this)}},r.Clock=function(e){this.autoStart=void 0!==e?e:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},r.Clock.prototype={constructor:r.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running&&this.start(),this.running){var t=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();e=.001*(t-this.oldTime),this.oldTime=t,this.elapsedTime+=e}return e}},r.EventDispatcher=function(){},r.EventDispatcher.prototype={constructor:r.EventDispatcher,apply:function(e){e.addEventListener=r.EventDispatcher.prototype.addEventListener,e.hasEventListener=r.EventDispatcher.prototype.hasEventListener,e.removeEventListener=r.EventDispatcher.prototype.removeEventListener,e.dispatchEvent=r.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners,n=r[e];if(void 0!==n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,r=t[e.type];if(void 0!==r){e.target=this;for(var n=[],i=r.length,o=0;i>o;o++)n[o]=r[o];for(var o=0;i>o;o++)n[o].call(this,e)}}}},function(e){e.Raycaster=function(t,r,n,i){this.ray=new e.Ray(t,r),this.near=n||0,this.far=i||1/0,this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var t=function(e,t){return e.distance-t.distance},r=function(e,t,n,i){if(e.raycast(t,n),i===!0)for(var o=e.children,s=0,a=o.length;a>s;s++)r(o[s],t,n,!0)};e.Raycaster.prototype={constructor:e.Raycaster,precision:1e-4,linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(t,r){r instanceof e.PerspectiveCamera?(this.ray.origin.copy(r.position),this.ray.direction.set(t.x,t.y,.5).unproject(r).sub(r.position).normalize()):r instanceof e.OrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld)):e.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,n){var i=[];return r(e,this,i,n),i.sort(t),i},intersectObjects:function(n,i){var o=[];if(n instanceof Array==!1)return e.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),o;for(var s=0,a=n.length;a>s;s++)r(n[s],this,o,i);return o.sort(t),o}}}(r),r.Object3D=function(){Object.defineProperty(this,"id",{value:r.Object3DIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=void 0,this.children=[],this.up=r.Object3D.DefaultUp.clone();var e=new r.Vector3,t=new r.Euler,n=new r.Quaternion,i=new r.Vector3(1,1,1),o=function(){n.setFromEuler(t,!1)},s=function(){t.setFromQuaternion(n,void 0,!1)};t.onChange(o),n.onChange(s),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:i}}),this.rotationAutoUpdate=!0,this.matrix=new r.Matrix4,this.matrixWorld=new r.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},r.Object3D.DefaultUp=new r.Vector3(0,1,0),r.Object3D.prototype={constructor:r.Object3D,get eulerOrder(){return r.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(e){r.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=e},get useQuaternion(){r.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(e){r.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new r.Quaternion;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.multiply(e),this}}(),rotateX:function(){var e=new r.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new r.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new r.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new r.Vector3;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translate:function(e,t){return r.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},translateX:function(){var e=new r.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new r.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new r.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new r.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new r.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(r.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e instanceof r.Object3D?(void 0!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):r.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);var r=this.children.indexOf(e);-1!==r&&(e.parent=void 0,e.dispatchEvent({type:"removed"}),this.children.splice(r,1))},getChildByName:function(e){return r.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;n>r;r++){var i=this.children[r],o=i.getObjectByProperty(e,t);if(void 0!==o)return o}},getWorldPosition:function(e){var t=e||new r.Vector3;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new r.Vector3,t=new r.Vector3;return function(n){var i=n||new r.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,i,t),i}}(),getWorldRotation:function(){var e=new r.Quaternion;return function(t){var n=t||new r.Euler;return this.getWorldQuaternion(e),n.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new r.Vector3,t=new r.Quaternion;return function(n){var i=n||new r.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,i),i}}(),getWorldDirection:function(){var e=new r.Quaternion;return function(t){var n=t||new r.Vector3;return this.getWorldQuaternion(e),n.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=0,r=this.children.length;r>t;t++)this.children[t].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var t=0,r=this.children.length;r>t;t++)this.children[t].traverseVisible(e)}},traverseAncestors:function(e){this.parent&&(e(this.parent),this.parent.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||e===!0)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,r=this.children.length;r>t;t++)this.children[t].updateMatrixWorld(e)},toJSON:function(){var e={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}},t={},n=function(r){if(void 0===e.geometries&&(e.geometries=[]),void 0===t[r.uuid]){var n=r.toJSON();delete n.metadata,t[r.uuid]=n,e.geometries.push(n)}return r.uuid},i={},o=function(t){if(void 0===e.materials&&(e.materials=[]),void 0===i[t.uuid]){var r=t.toJSON();delete r.metadata,i[t.uuid]=r,e.materials.push(r)}return t.uuid},s=function a(e){var t={};if(t.uuid=e.uuid,t.type=e.type,""!==e.name&&(t.name=e.name),"{}"!==JSON.stringify(e.userData)&&(t.userData=e.userData),e.visible!==!0&&(t.visible=e.visible),e instanceof r.PerspectiveCamera?(t.fov=e.fov,t.aspect=e.aspect,t.near=e.near,t.far=e.far):e instanceof r.OrthographicCamera?(t.left=e.left,t.right=e.right,t.top=e.top,t.bottom=e.bottom,t.near=e.near,t.far=e.far):e instanceof r.AmbientLight?t.color=e.color.getHex():e instanceof r.DirectionalLight?(t.color=e.color.getHex(),t.intensity=e.intensity):e instanceof r.PointLight?(t.color=e.color.getHex(),t.intensity=e.intensity,t.distance=e.distance,t.decay=e.decay):e instanceof r.SpotLight?(t.color=e.color.getHex(),t.intensity=e.intensity,t.distance=e.distance,t.angle=e.angle,t.exponent=e.exponent,t.decay=e.decay):e instanceof r.HemisphereLight?(t.color=e.color.getHex(),t.groundColor=e.groundColor.getHex()):e instanceof r.Mesh||e instanceof r.Line||e instanceof r.PointCloud?(t.geometry=n(e.geometry),t.material=o(e.material),e instanceof r.Line&&(t.mode=e.mode)):e instanceof r.Sprite&&(t.material=o(e.material)),t.matrix=e.matrix.toArray(),e.children.length>0){t.children=[];for(var i=0;i<e.children.length;i++)t.children.push(a(e.children[i]))}return t};return e.object=s(this),e},clone:function(e,t){if(void 0===e&&(e=new r.Object3D),void 0===t&&(t=!0),e.name=this.name,e.up.copy(this.up),e.position.copy(this.position),e.quaternion.copy(this.quaternion),e.scale.copy(this.scale),e.rotationAutoUpdate=this.rotationAutoUpdate,e.matrix.copy(this.matrix),e.matrixWorld.copy(this.matrixWorld),e.matrixAutoUpdate=this.matrixAutoUpdate,e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,e.visible=this.visible,e.castShadow=this.castShadow,e.receiveShadow=this.receiveShadow,e.frustumCulled=this.frustumCulled,e.userData=JSON.parse(JSON.stringify(this.userData)),t===!0)for(var n=0;n<this.children.length;n++){var i=this.children[n];e.add(i.clone())}return e}},r.EventDispatcher.prototype.apply(r.Object3D.prototype),r.Object3DIdCount=0,r.Face3=function(e,t,n,i,o,s){this.a=e,this.b=t,this.c=n,this.normal=i instanceof r.Vector3?i:new r.Vector3,this.vertexNormals=i instanceof Array?i:[],this.color=o instanceof r.Color?o:new r.Color,this.vertexColors=o instanceof Array?o:[],this.vertexTangents=[],this.materialIndex=void 0!==s?s:0},r.Face3.prototype={constructor:r.Face3,clone:function(){var e=new r.Face3(this.a,this.b,this.c);e.normal.copy(this.normal),e.color.copy(this.color),e.materialIndex=this.materialIndex;for(var t=0,n=this.vertexNormals.length;n>t;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();for(var t=0,n=this.vertexColors.length;n>t;t++)e.vertexColors[t]=this.vertexColors[t].clone();for(var t=0,n=this.vertexTangents.length;n>t;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},r.Face4=function(e,t,n,i,o,s,a){return r.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new r.Face3(e,t,n,o,s,a)},r.BufferAttribute=function(e,t){this.array=e,this.itemSize=t,this.needsUpdate=!1},r.BufferAttribute.prototype={constructor:r.BufferAttribute,get length(){return this.array.length},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(var n=0,i=this.itemSize;i>n;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},setX:function(e,t){return this.array[e*this.itemSize]=t,this},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},clone:function(){return new r.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}},r.Int8Attribute=function(e,t){return r.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(e,t)},r.Uint8Attribute=function(e,t){return r.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(e,t)},r.Uint8ClampedAttribute=function(e,t){return r.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(e,t)},r.Int16Attribute=function(e,t){return r.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(e,t)},r.Uint16Attribute=function(e,t){return r.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(e,t)},r.Int32Attribute=function(e,t){return r.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(e,t)},r.Uint32Attribute=function(e,t){return r.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(e,t)},r.Float32Attribute=function(e,t){return r.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(e,t)},r.Float64Attribute=function(e,t){return r.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new r.BufferAttribute(e,t)},r.DynamicBufferAttribute=function(e,t){r.BufferAttribute.call(this,e,t),this.updateRange={offset:0,count:-1}},r.DynamicBufferAttribute.prototype=Object.create(r.BufferAttribute.prototype),r.DynamicBufferAttribute.prototype.constructor=r.DynamicBufferAttribute,r.DynamicBufferAttribute.prototype.clone=function(){return new r.DynamicBufferAttribute(new this.array.constructor(this.array),this.itemSize)},r.BufferGeometry=function(){Object.defineProperty(this,"id",{value:r.GeometryIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.attributes={},this.attributesKeys=[],this.drawcalls=[],this.offsets=this.drawcalls,this.boundingBox=null,this.boundingSphere=null},r.BufferGeometry.prototype={constructor:r.BufferGeometry,addAttribute:function(e,t){return t instanceof r.BufferAttribute==!1?(r.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void(this.attributes[e]={array:arguments[1],itemSize:arguments[2]})):(this.attributes[e]=t,void(this.attributesKeys=Object.keys(this.attributes)))},getAttribute:function(e){return this.attributes[e]},addDrawCall:function(e,t,r){this.drawcalls.push({start:e,count:t,index:void 0!==r?r:0})},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToVector3Array(t.array),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var i=(new r.Matrix3).getNormalMatrix(e);i.applyToVector3Array(n.array),n.needsUpdate=!0}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere()},center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.applyMatrix((new r.Matrix4).setPosition(e)),e},fromGeometry:function(e,t){t=t||{vertexColors:r.NoColors};var n=e.vertices,i=e.faces,o=e.faceVertexUvs,s=t.vertexColors,a=o[0].length>0,l=3==i[0].vertexNormals.length,c=new Float32Array(3*i.length*3);this.addAttribute("position",new r.BufferAttribute(c,3));var u=new Float32Array(3*i.length*3);if(this.addAttribute("normal",new r.BufferAttribute(u,3)),s!==r.NoColors){var d=new Float32Array(3*i.length*3);this.addAttribute("color",new r.BufferAttribute(d,3))}if(a===!0){var h=new Float32Array(3*i.length*2);this.addAttribute("uv",new r.BufferAttribute(h,2))}for(var f=0,p=0,m=0;f<i.length;f++,p+=6,m+=9){var g=i[f],v=n[g.a],y=n[g.b],_=n[g.c];if(c[m]=v.x,c[m+1]=v.y,c[m+2]=v.z,c[m+3]=y.x,c[m+4]=y.y,c[m+5]=y.z,c[m+6]=_.x,c[m+7]=_.y,c[m+8]=_.z,l===!0){var b=g.vertexNormals[0],x=g.vertexNormals[1],w=g.vertexNormals[2];u[m]=b.x,u[m+1]=b.y,u[m+2]=b.z,u[m+3]=x.x,u[m+4]=x.y,u[m+5]=x.z,u[m+6]=w.x,u[m+7]=w.y,u[m+8]=w.z}else{var E=g.normal;u[m]=E.x,u[m+1]=E.y,u[m+2]=E.z,u[m+3]=E.x,u[m+4]=E.y,u[m+5]=E.z,u[m+6]=E.x,u[m+7]=E.y,u[m+8]=E.z}if(s===r.FaceColors){var S=g.color;d[m]=S.r,d[m+1]=S.g,d[m+2]=S.b,d[m+3]=S.r,d[m+4]=S.g,d[m+5]=S.b,d[m+6]=S.r,d[m+7]=S.g,d[m+8]=S.b}else if(s===r.VertexColors){var A=g.vertexColors[0],M=g.vertexColors[1],T=g.vertexColors[2];d[m]=A.r,d[m+1]=A.g,d[m+2]=A.b,d[m+3]=M.r,d[m+4]=M.g,d[m+5]=M.b,d[m+6]=T.r,d[m+7]=T.g,d[m+8]=T.b}if(a===!0){var C=o[0][f][0],j=o[0][f][1],P=o[0][f][2];h[p]=C.x,h[p+1]=C.y,h[p+2]=j.x,h[p+3]=j.y,h[p+4]=P.x,h[p+5]=P.y}}return this.computeBoundingSphere(),this},computeBoundingBox:function(){var e=new r.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new r.Box3);var t=this.attributes.position.array;if(t){var n=this.boundingBox;n.makeEmpty();for(var i=0,o=t.length;o>i;i+=3)e.set(t[i],t[i+1],t[i+2]),n.expandByPoint(e)}(void 0===t||0===t.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&r.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),computeBoundingSphere:function(){var e=new r.Box3,t=new r.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new r.Sphere);var n=this.attributes.position.array;if(n){e.makeEmpty();for(var i=this.boundingSphere.center,o=0,s=n.length;s>o;o+=3)t.set(n[o],n[o+1],n[o+2]),e.expandByPoint(t);e.center(i);for(var a=0,o=0,s=n.length;s>o;o+=3)t.set(n[o],n[o+1],n[o+2]),a=Math.max(a,i.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&r.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.attributes;if(e.position){var t=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new r.BufferAttribute(new Float32Array(t.length),3));else for(var n=e.normal.array,i=0,o=n.length;o>i;i++)n[i]=0;var s,a,l,n=e.normal.array,c=new r.Vector3,u=new r.Vector3,d=new r.Vector3,h=new r.Vector3,f=new r.Vector3;if(e.index)for(var p=e.index.array,m=this.offsets.length>0?this.offsets:[{start:0,count:p.length,index:0}],g=0,v=m.length;v>g;++g)for(var y=m[g].start,_=m[g].count,b=m[g].index,i=y,o=y+_;o>i;i+=3)s=3*(b+p[i]),a=3*(b+p[i+1]),l=3*(b+p[i+2]),c.fromArray(t,s),u.fromArray(t,a),d.fromArray(t,l),h.subVectors(d,u),f.subVectors(c,u),h.cross(f),n[s]+=h.x,n[s+1]+=h.y,n[s+2]+=h.z,n[a]+=h.x,n[a+1]+=h.y,n[a+2]+=h.z,n[l]+=h.x,n[l+1]+=h.y,n[l+2]+=h.z;else for(var i=0,o=t.length;o>i;i+=9)c.fromArray(t,i),u.fromArray(t,i+3),d.fromArray(t,i+6),h.subVectors(d,u),f.subVectors(c,u),h.cross(f),n[i]=h.x,n[i+1]=h.y,n[i+2]=h.z,n[i+3]=h.x,n[i+4]=h.y,n[i+5]=h.z,n[i+6]=h.x,n[i+7]=h.y,n[i+8]=h.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},computeTangents:function(){function e(e,t,r){P.fromArray(i,3*e),L.fromArray(i,3*t),D.fromArray(i,3*r),I.fromArray(s,2*e),R.fromArray(s,2*t),O.fromArray(s,2*r),h=L.x-P.x,f=D.x-P.x,p=L.y-P.y,m=D.y-P.y,g=L.z-P.z,v=D.z-P.z,y=R.x-I.x,_=O.x-I.x,b=R.y-I.y,x=O.y-I.y,w=1/(y*x-_*b),k.set((x*h-b*f)*w,(x*p-b*m)*w,(x*g-b*v)*w),N.set((y*f-_*h)*w,(y*m-_*p)*w,(y*v-_*g)*w),c[e].add(k),c[t].add(k),c[r].add(k),u[e].add(N),u[t].add(N),u[r].add(N)}function t(e){X.fromArray(o,3*e),Y.copy(X),G=c[e],W.copy(G),W.sub(X.multiplyScalar(X.dot(G))).normalize(),q.crossVectors(Y,G),H=q.dot(u[e]),z=0>H?-1:1,l[4*e]=W.x,l[4*e+1]=W.y,l[4*e+2]=W.z,l[4*e+3]=z}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)return void r.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");var n=this.attributes.index.array,i=this.attributes.position.array,o=this.attributes.normal.array,s=this.attributes.uv.array,a=i.length/3;void 0===this.attributes.tangent&&this.addAttribute("tangent",new r.BufferAttribute(new Float32Array(4*a),4));for(var l=this.attributes.tangent.array,c=[],u=[],d=0;a>d;d++)c[d]=new r.Vector3,u[d]=new r.Vector3;var h,f,p,m,g,v,y,_,b,x,w,E,S,A,M,T,C,j,P=new r.Vector3,L=new r.Vector3,D=new r.Vector3,I=new r.Vector2,R=new r.Vector2,O=new r.Vector2,k=new r.Vector3,N=new r.Vector3;0===this.drawcalls.length&&this.addDrawCall(0,n.length,0);var F=this.drawcalls;for(A=0,M=F.length;M>A;++A){var V=F[A].start,U=F[A].count,B=F[A].index;for(E=V,S=V+U;S>E;E+=3)T=B+n[E],C=B+n[E+1],j=B+n[E+2],e(T,C,j)}var z,G,H,W=new r.Vector3,q=new r.Vector3,X=new r.Vector3,Y=new r.Vector3;for(A=0,M=F.length;M>A;++A){var V=F[A].start,U=F[A].count,B=F[A].index;for(E=V,S=V+U;S>E;E+=3)T=B+n[E],C=B+n[E+1],j=B+n[E+2],t(T),t(C),t(j)}},computeOffsets:function(e){void 0===e&&(e=65535);for(var t=this.attributes.index.array,r=this.attributes.position.array,n=t.length/3,i=new Uint16Array(t.length),o=0,s=0,a=[{start:0,count:0,index:0}],l=a[0],c=0,u=0,d=new Int32Array(6),h=new Int32Array(r.length),f=new Int32Array(r.length),p=0;p<r.length;p++)h[p]=-1,f[p]=-1;for(var m=0;n>m;m++){u=0;for(var g=0;3>g;g++){var v=t[3*m+g];-1==h[v]?(d[2*g]=v,d[2*g+1]=-1,u++):h[v]<l.index?(d[2*g]=v,d[2*g+1]=-1,c++):(d[2*g]=v,d[2*g+1]=h[v])}var y=s+u;if(y>l.index+e){var _={start:o,count:0,index:s};a.push(_),l=_;for(var b=0;6>b;b+=2){var x=d[b+1];x>-1&&x<l.index&&(d[b+1]=-1);
}}for(var b=0;6>b;b+=2){var v=d[b],x=d[b+1];-1===x&&(x=s++),h[v]=x,f[x]=v,i[o++]=x-l.index,l.count++}}return this.reorderBuffers(i,f,s),this.offsets=a,this.drawcalls=a,a},merge:function(e,t){if(e instanceof r.BufferGeometry==!1)return void r.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0);var n=this.attributes;for(var i in n)if(void 0!==e.attributes[i])for(var o=n[i],s=o.array,a=e.attributes[i],l=a.array,c=a.itemSize,u=0,d=c*t;u<l.length;u++,d++)s[d]=l[u];return this},normalizeNormals:function(){for(var e,t,r,n,i=this.attributes.normal.array,o=0,s=i.length;s>o;o+=3)e=i[o],t=i[o+1],r=i[o+2],n=1/Math.sqrt(e*e+t*t+r*r),i[o]*=n,i[o+1]*=n,i[o+2]*=n},reorderBuffers:function(e,t,r){var n={};for(var i in this.attributes)if("index"!=i){var o=this.attributes[i].array;n[i]=new o.constructor(this.attributes[i].itemSize*r)}for(var s=0;r>s;s++){var a=t[s];for(var i in this.attributes)if("index"!=i)for(var l=this.attributes[i].array,c=this.attributes[i].itemSize,u=n[i],d=0;c>d;d++)u[s*c+d]=l[a*c+d]}this.attributes.index.array=e;for(var i in this.attributes)"index"!=i&&(this.attributes[i].array=n[i],this.attributes[i].numItems=this.attributes[i].itemSize*r)},toJSON:function(){var e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}},t=this.attributes,r=this.offsets,n=this.boundingSphere;for(var i in t){var o=t[i],s=Array.prototype.slice.call(o.array);e.data.attributes[i]={itemSize:o.itemSize,type:o.array.constructor.name,array:s}}return r.length>0&&(e.data.offsets=JSON.parse(JSON.stringify(r))),null!==n&&(e.data.boundingSphere={center:n.center.toArray(),radius:n.radius}),e},clone:function(){var e=new r.BufferGeometry;for(var t in this.attributes){var n=this.attributes[t];e.addAttribute(t,n.clone())}for(var i=0,o=this.offsets.length;o>i;i++){var s=this.offsets[i];e.offsets.push({start:s.start,index:s.index,count:s.count})}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.BufferGeometry.prototype),r.Geometry=function(){Object.defineProperty(this,"id",{value:r.GeometryIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},r.Geometry.prototype={constructor:r.Geometry,applyMatrix:function(e){for(var t=(new r.Matrix3).getNormalMatrix(e),n=0,i=this.vertices.length;i>n;n++){var o=this.vertices[n];o.applyMatrix4(e)}for(var n=0,i=this.faces.length;i>n;n++){var s=this.faces[n];s.normal.applyMatrix3(t).normalize();for(var a=0,l=s.vertexNormals.length;l>a;a++)s.vertexNormals[a].applyMatrix3(t).normalize()}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0},fromBufferGeometry:function(e){for(var t=this,n=e.attributes,i=n.position.array,o=void 0!==n.index?n.index.array:void 0,s=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,l=void 0!==n.uv?n.uv.array:void 0,c=[],u=[],d=0,h=0;d<i.length;d+=3,h+=2)t.vertices.push(new r.Vector3(i[d],i[d+1],i[d+2])),void 0!==s&&c.push(new r.Vector3(s[d],s[d+1],s[d+2])),void 0!==a&&t.colors.push(new r.Color(a[d],a[d+1],a[d+2])),void 0!==l&&u.push(new r.Vector2(l[h],l[h+1]));var f=function(e,n,i){var o=void 0!==s?[c[e].clone(),c[n].clone(),c[i].clone()]:[],d=void 0!==a?[t.colors[e].clone(),t.colors[n].clone(),t.colors[i].clone()]:[];t.faces.push(new r.Face3(e,n,i,o,d)),void 0!==l&&t.faceVertexUvs[0].push([u[e].clone(),u[n].clone(),u[i].clone()])};if(void 0!==o){var p=e.drawcalls;if(p.length>0)for(var d=0;d<p.length;d++)for(var m=p[d],g=m.start,v=m.count,y=m.index,h=g,_=g+v;_>h;h+=3)f(y+o[h],y+o[h+1],y+o[h+2]);else for(var d=0;d<o.length;d+=3)f(o[d],o[d+1],o[d+2])}else for(var d=0;d<i.length/3;d+=3)f(d,d+1,d+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.applyMatrix((new r.Matrix4).setPosition(e)),e},computeFaceNormals:function(){for(var e=new r.Vector3,t=new r.Vector3,n=0,i=this.faces.length;i>n;n++){var o=this.faces[n],s=this.vertices[o.a],a=this.vertices[o.b],l=this.vertices[o.c];e.subVectors(l,a),t.subVectors(s,a),e.cross(t),e.normalize(),o.normal.copy(e)}},computeVertexNormals:function(e){var t,n,i,o,s,a;for(a=new Array(this.vertices.length),t=0,n=this.vertices.length;n>t;t++)a[t]=new r.Vector3;if(e){var l,c,u,d=new r.Vector3,h=new r.Vector3;for(i=0,o=this.faces.length;o>i;i++)s=this.faces[i],l=this.vertices[s.a],c=this.vertices[s.b],u=this.vertices[s.c],d.subVectors(u,c),h.subVectors(l,c),d.cross(h),a[s.a].add(d),a[s.b].add(d),a[s.c].add(d)}else for(i=0,o=this.faces.length;o>i;i++)s=this.faces[i],a[s.a].add(s.normal),a[s.b].add(s.normal),a[s.c].add(s.normal);for(t=0,n=this.vertices.length;n>t;t++)a[t].normalize();for(i=0,o=this.faces.length;o>i;i++)s=this.faces[i],s.vertexNormals[0]=a[s.a].clone(),s.vertexNormals[1]=a[s.b].clone(),s.vertexNormals[2]=a[s.c].clone()},computeMorphNormals:function(){var e,t,n,i,o;for(n=0,i=this.faces.length;i>n;n++)for(o=this.faces[n],o.__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]),e=0,t=o.vertexNormals.length;t>e;e++)o.__originalVertexNormals[e]?o.__originalVertexNormals[e].copy(o.vertexNormals[e]):o.__originalVertexNormals[e]=o.vertexNormals[e].clone();var s=new r.Geometry;for(s.faces=this.faces,e=0,t=this.morphTargets.length;t>e;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a,l,c=this.morphNormals[e].faceNormals,u=this.morphNormals[e].vertexNormals;for(n=0,i=this.faces.length;i>n;n++)a=new r.Vector3,l={a:new r.Vector3,b:new r.Vector3,c:new r.Vector3},c.push(a),u.push(l)}var d=this.morphNormals[e];s.vertices=this.morphTargets[e].vertices,s.computeFaceNormals(),s.computeVertexNormals();var a,l;for(n=0,i=this.faces.length;i>n;n++)o=this.faces[n],a=d.faceNormals[n],l=d.vertexNormals[n],a.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}for(n=0,i=this.faces.length;i>n;n++)o=this.faces[n],o.normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeTangents:function(){function e(e,t,r,n,i,o,s){u=e.vertices[t],d=e.vertices[r],h=e.vertices[n],f=c[i],p=c[o],m=c[s],g=d.x-u.x,v=h.x-u.x,y=d.y-u.y,_=h.y-u.y,b=d.z-u.z,x=h.z-u.z,w=p.x-f.x,E=m.x-f.x,S=p.y-f.y,A=m.y-f.y,M=1/(w*A-E*S),D.set((A*g-S*v)*M,(A*y-S*_)*M,(A*b-S*x)*M),I.set((w*v-E*g)*M,(w*_-E*y)*M,(w*x-E*b)*M),P[t].add(D),P[r].add(D),P[n].add(D),L[t].add(I),L[r].add(I),L[n].add(I)}var t,n,i,o,s,a,l,c,u,d,h,f,p,m,g,v,y,_,b,x,w,E,S,A,M,T,C,j,P=[],L=[],D=new r.Vector3,I=new r.Vector3,R=new r.Vector3,O=new r.Vector3,k=new r.Vector3;for(i=0,o=this.vertices.length;o>i;i++)P[i]=new r.Vector3,L[i]=new r.Vector3;for(t=0,n=this.faces.length;n>t;t++)l=this.faces[t],c=this.faceVertexUvs[0][t],e(this,l.a,l.b,l.c,0,1,2);var N=["a","b","c","d"];for(t=0,n=this.faces.length;n>t;t++)for(l=this.faces[t],s=0;s<Math.min(l.vertexNormals.length,3);s++)k.copy(l.vertexNormals[s]),a=l[N[s]],T=P[a],R.copy(T),R.sub(k.multiplyScalar(k.dot(T))).normalize(),O.crossVectors(l.vertexNormals[s],T),C=O.dot(L[a]),j=0>C?-1:1,l.vertexTangents[s]=new r.Vector4(R.x,R.y,R.z,j);this.hasTangents=!0},computeLineDistances:function(){for(var e=0,t=this.vertices,r=0,n=t.length;n>r;r++)r>0&&(e+=t[r].distanceTo(t[r-1])),this.lineDistances[r]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new r.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new r.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e instanceof r.Geometry==!1)return void r.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);var i,o=this.vertices.length,s=this.vertices,a=e.vertices,l=this.faces,c=e.faces,u=this.faceVertexUvs[0],d=e.faceVertexUvs[0];void 0===n&&(n=0),void 0!==t&&(i=(new r.Matrix3).getNormalMatrix(t));for(var h=0,f=a.length;f>h;h++){var p=a[h],m=p.clone();void 0!==t&&m.applyMatrix4(t),s.push(m)}for(h=0,f=c.length;f>h;h++){var g,v,y,_=c[h],b=_.vertexNormals,x=_.vertexColors;g=new r.Face3(_.a+o,_.b+o,_.c+o),g.normal.copy(_.normal),void 0!==i&&g.normal.applyMatrix3(i).normalize();for(var w=0,E=b.length;E>w;w++)v=b[w].clone(),void 0!==i&&v.applyMatrix3(i).normalize(),g.vertexNormals.push(v);g.color.copy(_.color);for(var w=0,E=x.length;E>w;w++)y=x[w],g.vertexColors.push(y.clone());g.materialIndex=_.materialIndex+n,l.push(g)}for(h=0,f=d.length;f>h;h++){var S=d[h],A=[];if(void 0!==S){for(var w=0,E=S.length;E>w;w++)A.push(S[w].clone());u.push(A)}}},mergeMesh:function(e){return e instanceof r.Mesh==!1?void r.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e):(e.matrixAutoUpdate&&e.updateMatrix(),void this.merge(e.geometry,e.matrix))},mergeVertices:function(){var e,t,r,n,i,o,s,a,l={},c=[],u=[],d=4,h=Math.pow(10,d);for(r=0,n=this.vertices.length;n>r;r++)e=this.vertices[r],t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h),void 0===l[t]?(l[t]=r,c.push(this.vertices[r]),u[r]=c.length-1):u[r]=u[l[t]];var f=[];for(r=0,n=this.faces.length;n>r;r++){i=this.faces[r],i.a=u[i.a],i.b=u[i.b],i.c=u[i.c],o=[i.a,i.b,i.c];for(var p=-1,m=0;3>m;m++)if(o[m]==o[(m+1)%3]){p=m,f.push(r);break}}for(r=f.length-1;r>=0;r--){var g=f[r];for(this.faces.splice(g,1),s=0,a=this.faceVertexUvs.length;a>s;s++)this.faceVertexUvs[s].splice(g,1)}var v=this.vertices.length-c.length;return this.vertices=c,v},toJSON:function(){function e(e,t,r){return r?e|1<<t:e&~(1<<t)}function t(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==h[t]?h[t]:(h[t]=d.length/3,d.push(e.x,e.y,e.z),h[t])}function r(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==p[t]?p[t]:(p[t]=f.length,f.push(e.getHex()),p[t])}function n(e){var t=e.x.toString()+e.y.toString();return void 0!==g[t]?g[t]:(g[t]=m.length/2,m.push(e.x,e.y),g[t])}var i={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type};if(""!==this.name&&(i.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var s in o)void 0!==o[s]&&(i[s]=o[s]);return i}for(var a=[],l=0;l<this.vertices.length;l++){var c=this.vertices[l];a.push(c.x,c.y,c.z)}for(var u=[],d=[],h={},f=[],p={},m=[],g={},l=0;l<this.faces.length;l++){var v=this.faces[l],y=!1,_=!1,b=void 0!==this.faceVertexUvs[0][l],x=v.normal.length()>0,w=v.vertexNormals.length>0,E=1!==v.color.r||1!==v.color.g||1!==v.color.b,S=v.vertexColors.length>0,A=0;if(A=e(A,0,0),A=e(A,1,y),A=e(A,2,_),A=e(A,3,b),A=e(A,4,x),A=e(A,5,w),A=e(A,6,E),A=e(A,7,S),u.push(A),u.push(v.a,v.b,v.c),b){var M=this.faceVertexUvs[0][l];u.push(n(M[0]),n(M[1]),n(M[2]))}if(x&&u.push(t(v.normal)),w){var T=v.vertexNormals;u.push(t(T[0]),t(T[1]),t(T[2]))}if(E&&u.push(r(v.color)),S){var C=v.vertexColors;u.push(r(C[0]),r(C[1]),r(C[2]))}}return i.data={},i.data.vertices=a,i.data.normals=d,f.length>0&&(i.data.colors=f),m.length>0&&(i.data.uvs=[m]),i.data.faces=u,i},clone:function(){for(var e=new r.Geometry,t=this.vertices,n=0,i=t.length;i>n;n++)e.vertices.push(t[n].clone());for(var o=this.faces,n=0,i=o.length;i>n;n++)e.faces.push(o[n].clone());for(var n=0,i=this.faceVertexUvs.length;i>n;n++){var s=this.faceVertexUvs[n];void 0===e.faceVertexUvs[n]&&(e.faceVertexUvs[n]=[]);for(var a=0,l=s.length;l>a;a++){for(var c=s[a],u=[],d=0,h=c.length;h>d;d++){var f=c[d];u.push(f.clone())}e.faceVertexUvs[n].push(u)}}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.Geometry.prototype),r.GeometryIdCount=0,r.Camera=function(){r.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new r.Matrix4,this.projectionMatrix=new r.Matrix4},r.Camera.prototype=Object.create(r.Object3D.prototype),r.Camera.prototype.constructor=r.Camera,r.Camera.prototype.getWorldDirection=function(){var e=new r.Quaternion;return function(t){var n=t||new r.Vector3;return this.getWorldQuaternion(e),n.set(0,0,-1).applyQuaternion(e)}}(),r.Camera.prototype.lookAt=function(){var e=new r.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(e)}}(),r.Camera.prototype.clone=function(e){return void 0===e&&(e=new r.Camera),r.Object3D.prototype.clone.call(this,e),e.matrixWorldInverse.copy(this.matrixWorldInverse),e.projectionMatrix.copy(this.projectionMatrix),e},r.CubeCamera=function(e,t,n){r.Object3D.call(this),this.type="CubeCamera";var i=90,o=1,s=new r.PerspectiveCamera(i,o,e,t);s.up.set(0,-1,0),s.lookAt(new r.Vector3(1,0,0)),this.add(s);var a=new r.PerspectiveCamera(i,o,e,t);a.up.set(0,-1,0),a.lookAt(new r.Vector3(-1,0,0)),this.add(a);var l=new r.PerspectiveCamera(i,o,e,t);l.up.set(0,0,1),l.lookAt(new r.Vector3(0,1,0)),this.add(l);var c=new r.PerspectiveCamera(i,o,e,t);c.up.set(0,0,-1),c.lookAt(new r.Vector3(0,-1,0)),this.add(c);var u=new r.PerspectiveCamera(i,o,e,t);u.up.set(0,-1,0),u.lookAt(new r.Vector3(0,0,1)),this.add(u);var d=new r.PerspectiveCamera(i,o,e,t);d.up.set(0,-1,0),d.lookAt(new r.Vector3(0,0,-1)),this.add(d),this.renderTarget=new r.WebGLRenderTargetCube(n,n,{format:r.RGBFormat,magFilter:r.LinearFilter,minFilter:r.LinearFilter}),this.updateCubeMap=function(e,t){var r=this.renderTarget,n=r.generateMipmaps;r.generateMipmaps=!1,r.activeCubeFace=0,e.render(t,s,r),r.activeCubeFace=1,e.render(t,a,r),r.activeCubeFace=2,e.render(t,l,r),r.activeCubeFace=3,e.render(t,c,r),r.activeCubeFace=4,e.render(t,u,r),r.generateMipmaps=n,r.activeCubeFace=5,e.render(t,d,r)}},r.CubeCamera.prototype=Object.create(r.Object3D.prototype),r.CubeCamera.prototype.constructor=r.CubeCamera,r.OrthographicCamera=function(e,t,n,i,o,s){r.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=void 0!==o?o:.1,this.far=void 0!==s?s:2e3,this.updateProjectionMatrix()},r.OrthographicCamera.prototype=Object.create(r.Camera.prototype),r.OrthographicCamera.prototype.constructor=r.OrthographicCamera,r.OrthographicCamera.prototype.updateProjectionMatrix=function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(r-e,r+e,n+t,n-t,this.near,this.far)},r.OrthographicCamera.prototype.clone=function(){var e=new r.OrthographicCamera;return r.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},r.PerspectiveCamera=function(e,t,n,i){r.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()},r.PerspectiveCamera.prototype=Object.create(r.Camera.prototype),r.PerspectiveCamera.prototype.constructor=r.PerspectiveCamera,r.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24),this.fov=2*r.Math.radToDeg(Math.atan(t/(2*e))),this.updateProjectionMatrix()},r.PerspectiveCamera.prototype.setViewOffset=function(e,t,r,n,i,o){this.fullWidth=e,this.fullHeight=t,this.x=r,this.y=n,this.width=i,this.height=o,this.updateProjectionMatrix()},r.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var e=r.Math.radToDeg(2*Math.atan(Math.tan(.5*r.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var t=this.fullWidth/this.fullHeight,n=Math.tan(r.Math.degToRad(.5*e))*this.near,i=-n,o=t*i,s=t*n,a=Math.abs(s-o),l=Math.abs(n-i);this.projectionMatrix.makeFrustum(o+this.x*a/this.fullWidth,o+(this.x+this.width)*a/this.fullWidth,n-(this.y+this.height)*l/this.fullHeight,n-this.y*l/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(e,this.aspect,this.near,this.far)},r.PerspectiveCamera.prototype.clone=function(){var e=new r.PerspectiveCamera;return r.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},r.Light=function(e){r.Object3D.call(this),this.type="Light",this.color=new r.Color(e)},r.Light.prototype=Object.create(r.Object3D.prototype),r.Light.prototype.constructor=r.Light,r.Light.prototype.clone=function(e){return void 0===e&&(e=new r.Light),r.Object3D.prototype.clone.call(this,e),e.color.copy(this.color),e},r.AmbientLight=function(e){r.Light.call(this,e),this.type="AmbientLight"},r.AmbientLight.prototype=Object.create(r.Light.prototype),r.AmbientLight.prototype.constructor=r.AmbientLight,r.AmbientLight.prototype.clone=function(){var e=new r.AmbientLight;return r.Light.prototype.clone.call(this,e),e},r.AreaLight=function(e,t){r.Light.call(this,e),this.type="AreaLight",this.normal=new r.Vector3(0,-1,0),this.right=new r.Vector3(1,0,0),this.intensity=void 0!==t?t:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},r.AreaLight.prototype=Object.create(r.Light.prototype),r.AreaLight.prototype.constructor=r.AreaLight,r.DirectionalLight=function(e,t){r.Light.call(this,e),this.type="DirectionalLight",this.position.set(0,1,0),this.target=new r.Object3D,this.intensity=void 0!==t?t:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new r.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},r.DirectionalLight.prototype=Object.create(r.Light.prototype),r.DirectionalLight.prototype.constructor=r.DirectionalLight,r.DirectionalLight.prototype.clone=function(){var e=new r.DirectionalLight;return r.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraLeft=this.shadowCameraLeft,e.shadowCameraRight=this.shadowCameraRight,e.shadowCameraTop=this.shadowCameraTop,e.shadowCameraBottom=this.shadowCameraBottom,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e.shadowCascade=this.shadowCascade,e.shadowCascadeOffset.copy(this.shadowCascadeOffset),e.shadowCascadeCount=this.shadowCascadeCount,e.shadowCascadeBias=this.shadowCascadeBias.slice(0),e.shadowCascadeWidth=this.shadowCascadeWidth.slice(0),e.shadowCascadeHeight=this.shadowCascadeHeight.slice(0),e.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0),e.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0),e},r.HemisphereLight=function(e,t,n){r.Light.call(this,e),this.type="HemisphereLight",this.position.set(0,100,0),this.groundColor=new r.Color(t),this.intensity=void 0!==n?n:1},r.HemisphereLight.prototype=Object.create(r.Light.prototype),r.HemisphereLight.prototype.constructor=r.HemisphereLight,r.HemisphereLight.prototype.clone=function(){var e=new r.HemisphereLight;return r.Light.prototype.clone.call(this,e),e.groundColor.copy(this.groundColor),e.intensity=this.intensity,e},r.PointLight=function(e,t,n,i){r.Light.call(this,e),this.type="PointLight",this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1},r.PointLight.prototype=Object.create(r.Light.prototype),r.PointLight.prototype.constructor=r.PointLight,r.PointLight.prototype.clone=function(){var e=new r.PointLight;return r.Light.prototype.clone.call(this,e),e.intensity=this.intensity,e.distance=this.distance,e.decay=this.decay,e},r.SpotLight=function(e,t,n,i,o,s){r.Light.call(this,e),this.type="SpotLight",this.position.set(0,1,0),this.target=new r.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.exponent=void 0!==o?o:10,this.decay=void 0!==s?s:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},r.SpotLight.prototype=Object.create(r.Light.prototype),r.SpotLight.prototype.constructor=r.SpotLight,r.SpotLight.prototype.clone=function(){var e=new r.SpotLight;return r.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.distance=this.distance,e.angle=this.angle,e.exponent=this.exponent,e.decay=this.decay,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraFov=this.shadowCameraFov,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e},r.Cache={files:{},add:function(e,t){this.files[e]=t},get:function(e){return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},r.Loader=function(e){this.showStatus=e,this.statusDomElement=e?r.Loader.prototype.addStatusElement():null,this.imageLoader=new r.ImageLoader,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},r.Loader.prototype={constructor:r.Loader,crossOrigin:void 0,addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(e){var t="Loaded ";t+=e.total?(100*e.loaded/e.total).toFixed(0)+"%":(e.loaded/1024).toFixed(2)+" KB",this.statusDomElement.innerHTML=t},extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t){for(var r=[],n=0;n<e.length;++n)r[n]=this.createMaterial(e[n],t);return r},needsTangents:function(e){for(var t=0,n=e.length;n>t;t++){var i=e[t];if(i instanceof r.ShaderMaterial)return!0}return!1},createMaterial:function(e,t){function n(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function i(e,i,o,a,l,c,u){var d,h=t+o,f=r.Loader.Handlers.get(h);if(null!==f?d=f.load(h):(d=new r.Texture,f=s.imageLoader,f.crossOrigin=s.crossOrigin,f.load(h,function(e){if(r.Math.isPowerOfTwo(e.width)===!1||r.Math.isPowerOfTwo(e.height)===!1){var t=n(e.width),i=n(e.height),o=document.createElement("canvas");o.width=t,o.height=i;var s=o.getContext("2d");s.drawImage(e,0,0,t,i),d.image=o}else d.image=e;d.needsUpdate=!0})),d.sourceFile=o,a&&(d.repeat.set(a[0],a[1]),1!==a[0]&&(d.wrapS=r.RepeatWrapping),1!==a[1]&&(d.wrapT=r.RepeatWrapping)),l&&d.offset.set(l[0],l[1]),c){var p={repeat:r.RepeatWrapping,mirror:r.MirroredRepeatWrapping};void 0!==p[c[0]]&&(d.wrapS=p[c[0]]),void 0!==p[c[1]]&&(d.wrapT=p[c[1]])}u&&(d.anisotropy=u),e[i]=d}function o(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var s=this,a="MeshLambertMaterial",l={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(e.shading){var c=e.shading.toLowerCase();"phong"===c?a="MeshPhongMaterial":"basic"===c&&(a="MeshBasicMaterial")}void 0!==e.blending&&void 0!==r[e.blending]&&(l.blending=r[e.blending]),void 0!==e.transparent&&(l.transparent=e.transparent),void 0!==e.opacity&&e.opacity<1&&(l.transparent=!0),void 0!==e.depthTest&&(l.depthTest=e.depthTest),void 0!==e.depthWrite&&(l.depthWrite=e.depthWrite),void 0!==e.visible&&(l.visible=e.visible),void 0!==e.flipSided&&(l.side=r.BackSide),void 0!==e.doubleSided&&(l.side=r.DoubleSide),void 0!==e.wireframe&&(l.wireframe=e.wireframe),void 0!==e.vertexColors&&("face"===e.vertexColors?l.vertexColors=r.FaceColors:e.vertexColors&&(l.vertexColors=r.VertexColors)),e.colorDiffuse?l.color=o(e.colorDiffuse):e.DbgColor&&(l.color=e.DbgColor),e.colorSpecular&&(l.specular=o(e.colorSpecular)),e.colorEmissive&&(l.emissive=o(e.colorEmissive)),void 0!==e.transparency&&(e.opacity=e.transparency),void 0!==e.opacity&&(l.opacity=e.opacity),e.specularCoef&&(l.shininess=e.specularCoef),e.mapDiffuse&&t&&i(l,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy),e.mapLight&&t&&i(l,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy),e.mapBump&&t&&i(l,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy),e.mapNormal&&t&&i(l,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy),e.mapSpecular&&t&&i(l,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy),e.mapAlpha&&t&&i(l,"alphaMap",e.mapAlpha,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy),e.mapBumpScale&&(l.bumpScale=e.mapBumpScale),e.mapNormalFactor&&(l.normalScale=new r.Vector2(e.mapNormalFactor,e.mapNormalFactor));var u=new r[a](l);return void 0!==e.DbgName&&(u.name=e.DbgName),u}},r.Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=0,r=this.handlers.length;r>t;t+=2){var n=this.handlers[t],i=this.handlers[t+1];if(n.test(e))return i}return null}},r.XHRLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager},r.XHRLoader.prototype={constructor:r.XHRLoader,load:function(e,t,n,i){var o=this,s=r.Cache.get(e);if(void 0!==s)return void(t&&t(s));var a=new XMLHttpRequest;a.open("GET",e,!0),a.addEventListener("load",function(n){r.Cache.add(e,this.response),t&&t(this.response),o.manager.itemEnd(e)},!1),void 0!==n&&a.addEventListener("progress",function(e){n(e)},!1),void 0!==i&&a.addEventListener("error",function(e){i(e)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(a.responseType=this.responseType),a.send(null),o.manager.itemStart(e)},setResponseType:function(e){this.responseType=e},setCrossOrigin:function(e){this.crossOrigin=e}},r.ImageLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager},r.ImageLoader.prototype={constructor:r.ImageLoader,load:function(e,t,n,i){var o=this,s=r.Cache.get(e);if(void 0!==s)return void t(s);var a=document.createElement("img");return a.addEventListener("load",function(n){r.Cache.add(e,this),t&&t(this),o.manager.itemEnd(e)},!1),void 0!==n&&a.addEventListener("progress",function(e){n(e)},!1),void 0!==i&&a.addEventListener("error",function(e){i(e)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),a.src=e,o.manager.itemStart(e),a},setCrossOrigin:function(e){this.crossOrigin=e}},r.JSONLoader=function(e){r.Loader.call(this,e),this.withCredentials=!1},r.JSONLoader.prototype=Object.create(r.Loader.prototype),r.JSONLoader.prototype.constructor=r.JSONLoader,r.JSONLoader.prototype.load=function(e,t,r){r=r&&"string"==typeof r?r:this.extractUrlBase(e),this.onLoadStart(),this.loadAjaxJSON(this,e,t,r)},r.JSONLoader.prototype.loadAjaxJSON=function(e,t,n,i,o){var s=new XMLHttpRequest,a=0;s.onreadystatechange=function(){if(s.readyState===s.DONE)if(200===s.status||0===s.status){if(s.responseText){var l=JSON.parse(s.responseText),c=l.metadata;if(void 0!==c){if("object"===c.type)return void r.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===c.type)return void r.error("THREE.JSONLoader: "+t+" seems to be a Scene. Use THREE.SceneLoader instead.")}var u=e.parse(l,i);n(u.geometry,u.materials)}else r.error("THREE.JSONLoader: "+t+" seems to be unreachable or the file is empty.");e.onLoadComplete()}else r.error("THREE.JSONLoader: Couldn't load "+t+" ("+s.status+")");else s.readyState===s.LOADING?o&&(0===a&&(a=s.getResponseHeader("Content-Length")),o({total:a,loaded:s.responseText.length})):s.readyState===s.HEADERS_RECEIVED&&void 0!==o&&(a=s.getResponseHeader("Content-Length"))},s.open("GET",t,!0),s.withCredentials=this.withCredentials,s.send(null)},r.JSONLoader.prototype.parse=function(e,t){function n(t){function n(e,t){return e&1<<t}var i,o,a,l,c,u,d,h,f,p,m,g,v,y,_,b,x,w,E,S,A,M,T,C,j,P,L,D=e.faces,I=e.vertices,R=e.normals,O=e.colors,k=0;if(void 0!==e.uvs){for(i=0;i<e.uvs.length;i++)e.uvs[i].length&&k++;for(i=0;k>i;i++)s.faceVertexUvs[i]=[]}for(l=0,c=I.length;c>l;)w=new r.Vector3,w.x=I[l++]*t,w.y=I[l++]*t,w.z=I[l++]*t,s.vertices.push(w);for(l=0,c=D.length;c>l;)if(p=D[l++],m=n(p,0),g=n(p,1),v=n(p,3),y=n(p,4),_=n(p,5),b=n(p,6),x=n(p,7),m){if(S=new r.Face3,S.a=D[l],S.b=D[l+1],S.c=D[l+3],A=new r.Face3,A.a=D[l+1],A.b=D[l+2],A.c=D[l+3],l+=4,g&&(f=D[l++],S.materialIndex=f,A.materialIndex=f),a=s.faces.length,v)for(i=0;k>i;i++)for(C=e.uvs[i],s.faceVertexUvs[i][a]=[],s.faceVertexUvs[i][a+1]=[],o=0;4>o;o++)h=D[l++],P=C[2*h],L=C[2*h+1],j=new r.Vector2(P,L),2!==o&&s.faceVertexUvs[i][a].push(j),0!==o&&s.faceVertexUvs[i][a+1].push(j);if(y&&(d=3*D[l++],S.normal.set(R[d++],R[d++],R[d]),A.normal.copy(S.normal)),_)for(i=0;4>i;i++)d=3*D[l++],T=new r.Vector3(R[d++],R[d++],R[d]),2!==i&&S.vertexNormals.push(T),0!==i&&A.vertexNormals.push(T);if(b&&(u=D[l++],M=O[u],S.color.setHex(M),A.color.setHex(M)),x)for(i=0;4>i;i++)u=D[l++],M=O[u],2!==i&&S.vertexColors.push(new r.Color(M)),0!==i&&A.vertexColors.push(new r.Color(M));s.faces.push(S),s.faces.push(A)}else{if(E=new r.Face3,E.a=D[l++],E.b=D[l++],E.c=D[l++],g&&(f=D[l++],E.materialIndex=f),a=s.faces.length,v)for(i=0;k>i;i++)for(C=e.uvs[i],s.faceVertexUvs[i][a]=[],o=0;3>o;o++)h=D[l++],P=C[2*h],L=C[2*h+1],j=new r.Vector2(P,L),s.faceVertexUvs[i][a].push(j);if(y&&(d=3*D[l++],E.normal.set(R[d++],R[d++],R[d])),_)for(i=0;3>i;i++)d=3*D[l++],T=new r.Vector3(R[d++],R[d++],R[d]),E.vertexNormals.push(T);if(b&&(u=D[l++],E.color.setHex(O[u])),x)for(i=0;3>i;i++)u=D[l++],E.vertexColors.push(new r.Color(O[u]));s.faces.push(E)}}function i(){var t=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,i=e.skinWeights.length;i>n;n+=t){var o=e.skinWeights[n],a=t>1?e.skinWeights[n+1]:0,l=t>2?e.skinWeights[n+2]:0,c=t>3?e.skinWeights[n+3]:0;s.skinWeights.push(new r.Vector4(o,a,l,c))}if(e.skinIndices)for(var n=0,i=e.skinIndices.length;i>n;n+=t){var u=e.skinIndices[n],d=t>1?e.skinIndices[n+1]:0,h=t>2?e.skinIndices[n+2]:0,f=t>3?e.skinIndices[n+3]:0;s.skinIndices.push(new r.Vector4(u,d,h,f))}s.bones=e.bones,s.bones&&s.bones.length>0&&(s.skinWeights.length!==s.skinIndices.length||s.skinIndices.length!==s.vertices.length)&&r.warn("THREE.JSONLoader: When skinning, number of vertices ("+s.vertices.length+"), skinIndices ("+s.skinIndices.length+"), and skinWeights ("+s.skinWeights.length+") should match."),s.animation=e.animation,s.animations=e.animations}function o(t){
if(void 0!==e.morphTargets){var n,i,o,a,l,c;for(n=0,i=e.morphTargets.length;i>n;n++)for(s.morphTargets[n]={},s.morphTargets[n].name=e.morphTargets[n].name,s.morphTargets[n].vertices=[],l=s.morphTargets[n].vertices,c=e.morphTargets[n].vertices,o=0,a=c.length;a>o;o+=3){var u=new r.Vector3;u.x=c[o]*t,u.y=c[o+1]*t,u.z=c[o+2]*t,l.push(u)}}if(void 0!==e.morphColors){var n,i,d,h,f,p,m;for(n=0,i=e.morphColors.length;i>n;n++)for(s.morphColors[n]={},s.morphColors[n].name=e.morphColors[n].name,s.morphColors[n].colors=[],f=s.morphColors[n].colors,p=e.morphColors[n].colors,d=0,h=p.length;h>d;d+=3)m=new r.Color(16755200),m.setRGB(p[d],p[d+1],p[d+2]),f.push(m)}}var s=new r.Geometry,a=void 0!==e.scale?1/e.scale:1;if(n(a),i(),o(a),s.computeFaceNormals(),s.computeBoundingSphere(),void 0===e.materials||0===e.materials.length)return{geometry:s};var l=this.initMaterials(e.materials,t);return this.needsTangents(l)&&s.computeTangents(),{geometry:s,materials:l}},r.LoadingManager=function(e,t,r){var n=this,i=0,o=0;this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){o++},this.itemEnd=function(e){i++,void 0!==n.onProgress&&n.onProgress(e,i,o),i===o&&void 0!==n.onLoad&&n.onLoad()}},r.DefaultLoadingManager=new r.LoadingManager,r.BufferGeometryLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager},r.BufferGeometryLoader.prototype={constructor:r.BufferGeometryLoader,load:function(e,t,n,i){var o=this,s=new r.XHRLoader(o.manager);s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){t(o.parse(JSON.parse(e)))},n,i)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new r.BufferGeometry,n=e.data.attributes;for(var i in n){var o=n[i],s=new self[o.type](o.array);t.addAttribute(i,new r.BufferAttribute(s,o.itemSize))}var a=e.data.offsets;void 0!==a&&(t.offsets=JSON.parse(JSON.stringify(a)));var l=e.data.boundingSphere;if(void 0!==l){var c=new r.Vector3;void 0!==l.center&&c.fromArray(l.center),t.boundingSphere=new r.Sphere(c,l.radius)}return t}},r.MaterialLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager},r.MaterialLoader.prototype={constructor:r.MaterialLoader,load:function(e,t,n,i){var o=this,s=new r.XHRLoader(o.manager);s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){t(o.parse(JSON.parse(e)))},n,i)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new r[e.type];if(void 0!==e.color&&t.color.setHex(e.color),void 0!==e.emissive&&t.emissive.setHex(e.emissive),void 0!==e.specular&&t.specular.setHex(e.specular),void 0!==e.shininess&&(t.shininess=e.shininess),void 0!==e.uniforms&&(t.uniforms=e.uniforms),void 0!==e.vertexShader&&(t.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(t.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors),void 0!==e.shading&&(t.shading=e.shading),void 0!==e.blending&&(t.blending=e.blending),void 0!==e.side&&(t.side=e.side),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.transparent&&(t.transparent=e.transparent),void 0!==e.wireframe&&(t.wireframe=e.wireframe),void 0!==e.size&&(t.size=e.size),void 0!==e.sizeAttenuation&&(t.sizeAttenuation=e.sizeAttenuation),void 0!==e.materials)for(var n=0,i=e.materials.length;i>n;n++)t.materials.push(this.parse(e.materials[n]));return t}},r.ObjectLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager,this.texturePath=""},r.ObjectLoader.prototype={constructor:r.ObjectLoader,load:function(e,t,n,i){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var o=this,s=new r.XHRLoader(o.manager);s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){o.parse(JSON.parse(e),t)},n,i)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var r=this.parseGeometries(e.geometries),n=this.parseImages(e.images,function(){void 0!==t&&t(s)}),i=this.parseTextures(e.textures,n),o=this.parseMaterials(e.materials,i),s=this.parseObject(e.object,r,o);return(void 0===e.images||0===e.images.length)&&void 0!==t&&t(s),s},parseGeometries:function(e){var t={};if(void 0!==e)for(var n=new r.JSONLoader,i=new r.BufferGeometryLoader,o=0,s=e.length;s>o;o++){var a,l=e[o];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new r[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"CubeGeometry":a=new r.BoxGeometry(l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":a=new r.CircleGeometry(l.radius,l.segments);break;case"CylinderGeometry":a=new r.CylinderGeometry(l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded);break;case"SphereGeometry":a=new r.SphereGeometry(l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"IcosahedronGeometry":a=new r.IcosahedronGeometry(l.radius,l.detail);break;case"TorusGeometry":a=new r.TorusGeometry(l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":a=new r.TorusKnotGeometry(l.radius,l.tube,l.radialSegments,l.tubularSegments,l.p,l.q,l.heightScale);break;case"BufferGeometry":a=i.parse(l);break;case"Geometry":a=n.parse(l.data).geometry}a.uuid=l.uuid,void 0!==l.name&&(a.name=l.name),t[l.uuid]=a}return t},parseMaterials:function(e,t){var n={};if(void 0!==e)for(var i=function(e){return void 0===t[e]&&r.warn("THREE.ObjectLoader: Undefined texture",e),t[e]},o=new r.MaterialLoader,s=0,a=e.length;a>s;s++){var l=e[s],c=o.parse(l);c.uuid=l.uuid,void 0!==l.name&&(c.name=l.name),void 0!==l.map&&(c.map=i(l.map)),void 0!==l.bumpMap&&(c.bumpMap=i(l.bumpMap),l.bumpScale&&(c.bumpScale=new r.Vector2(l.bumpScale,l.bumpScale))),void 0!==l.alphaMap&&(c.alphaMap=i(l.alphaMap)),void 0!==l.envMap&&(c.envMap=i(l.envMap)),void 0!==l.normalMap&&(c.normalMap=i(l.normalMap),l.normalScale&&(c.normalScale=new r.Vector2(l.normalScale,l.normalScale))),void 0!==l.lightMap&&(c.lightMap=i(l.lightMap)),void 0!==l.specularMap&&(c.specularMap=i(l.specularMap)),n[l.uuid]=c}return n},parseImages:function(e,t){var n=this,i={};if(void 0!==e&&e.length>0){var o=new r.LoadingManager(t),s=new r.ImageLoader(o);s.setCrossOrigin(this.crossOrigin);for(var a=function(e){return n.manager.itemStart(e),s.load(e,function(){n.manager.itemEnd(e)})},l=0,c=e.length;c>l;l++){var u=e[l],d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.texturePath+u.url;i[u.uuid]=a(d)}}return i},parseTextures:function(e,t){var n={};if(void 0!==e)for(var i=0,o=e.length;o>i;i++){var s=e[i];void 0===s.image&&r.warn('THREE.ObjectLoader: No "image" speficied for',s.uuid),void 0===t[s.image]&&r.warn("THREE.ObjectLoader: Undefined image",s.image);var a=new r.Texture(t[s.image]);a.needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.repeat&&(a.repeat=new r.Vector2(s.repeat[0],s.repeat[1])),void 0!==s.minFilter&&(a.minFilter=r[s.minFilter]),void 0!==s.magFilter&&(a.magFilter=r[s.magFilter]),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),s.wrap instanceof Array&&(a.wrapS=r[s.wrap[0]],a.wrapT=r[s.wrap[1]]),n[s.uuid]=a}return n},parseObject:function(){var e=new r.Matrix4;return function(t,n,i){var o,s=function(e){return void 0===n[e]&&r.warn("THREE.ObjectLoader: Undefined geometry",e),n[e]},a=function(e){return void 0===i[e]&&r.warn("THREE.ObjectLoader: Undefined material",e),i[e]};switch(t.type){case"Scene":o=new r.Scene;break;case"PerspectiveCamera":o=new r.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":o=new r.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":o=new r.AmbientLight(t.color);break;case"DirectionalLight":o=new r.DirectionalLight(t.color,t.intensity);break;case"PointLight":o=new r.PointLight(t.color,t.intensity,t.distance,t.decay);break;case"SpotLight":o=new r.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent,t.decay);break;case"HemisphereLight":o=new r.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":o=new r.Mesh(s(t.geometry),a(t.material));break;case"Line":o=new r.Line(s(t.geometry),a(t.material),t.mode);break;case"PointCloud":o=new r.PointCloud(s(t.geometry),a(t.material));break;case"Sprite":o=new r.Sprite(a(t.material));break;case"Group":o=new r.Group;break;default:o=new r.Object3D}if(o.uuid=t.uuid,void 0!==t.name&&(o.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(o.position,o.quaternion,o.scale)):(void 0!==t.position&&o.position.fromArray(t.position),void 0!==t.rotation&&o.rotation.fromArray(t.rotation),void 0!==t.scale&&o.scale.fromArray(t.scale)),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.children)for(var l in t.children)o.add(this.parseObject(t.children[l],n,i));return o}}()},r.TextureLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager},r.TextureLoader.prototype={constructor:r.TextureLoader,load:function(e,t,n,i){var o=this,s=new r.ImageLoader(o.manager);s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){var n=new r.Texture(e);n.needsUpdate=!0,void 0!==t&&t(n)},n,i)},setCrossOrigin:function(e){this.crossOrigin=e}},r.DataTextureLoader=r.BinaryTextureLoader=function(){this._parser=null},r.BinaryTextureLoader.prototype={constructor:r.BinaryTextureLoader,load:function(e,t,n,i){var o=this,s=new r.DataTexture,a=new r.XHRLoader;return a.setResponseType("arraybuffer"),a.load(e,function(e){var n=o._parser(e);n&&(void 0!==n.image?s.image=n.image:void 0!==n.data&&(s.image.width=n.width,s.image.height=n.height,s.image.data=n.data),s.wrapS=void 0!==n.wrapS?n.wrapS:r.ClampToEdgeWrapping,s.wrapT=void 0!==n.wrapT?n.wrapT:r.ClampToEdgeWrapping,s.magFilter=void 0!==n.magFilter?n.magFilter:r.LinearFilter,s.minFilter=void 0!==n.minFilter?n.minFilter:r.LinearMipMapLinearFilter,s.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(s.format=n.format),void 0!==n.type&&(s.type=n.type),void 0!==n.mipmaps&&(s.mipmaps=n.mipmaps),1===n.mipmapCount&&(s.minFilter=r.LinearFilter),s.needsUpdate=!0,t&&t(s,n))},n,i),s}},r.CompressedTextureLoader=function(){this._parser=null},r.CompressedTextureLoader.prototype={constructor:r.CompressedTextureLoader,load:function(e,t,n){var i=this,o=[],s=new r.CompressedTexture;s.image=o;var a=new r.XHRLoader;if(a.setResponseType("arraybuffer"),e instanceof Array)for(var l=0,c=function(n){a.load(e[n],function(e){var a=i._parser(e,!0);o[n]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps},l+=1,6===l&&(1==a.mipmapCount&&(s.minFilter=r.LinearFilter),s.format=a.format,s.needsUpdate=!0,t&&t(s))})},u=0,d=e.length;d>u;++u)c(u);else a.load(e,function(e){var n=i._parser(e,!0);if(n.isCubemap)for(var a=n.mipmaps.length/n.mipmapCount,l=0;a>l;l++){o[l]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)o[l].mipmaps.push(n.mipmaps[l*n.mipmapCount+c]),o[l].format=n.format,o[l].width=n.width,o[l].height=n.height}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=r.LinearFilter),s.format=n.format,s.needsUpdate=!0,t&&t(s)});return s}},r.Material=function(){Object.defineProperty(this,"id",{value:r.MaterialIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="Material",this.side=r.FrontSide,this.opacity=1,this.transparent=!1,this.blending=r.NormalBlending,this.blendSrc=r.SrcAlphaFactor,this.blendDst=r.OneMinusSrcAlphaFactor,this.blendEquation=r.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},r.Material.prototype={constructor:r.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){e===!0&&this.update(),this._needsUpdate=e},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n){if(t in this){var i=this[t];i instanceof r.Color?i.set(n):i instanceof r.Vector3&&n instanceof r.Vector3?i.copy(n):"overdraw"==t?this[t]=Number(n):this[t]=n}}else r.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(){var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};return""!==this.name&&(e.name=this.name),this instanceof r.MeshBasicMaterial?(e.color=this.color.getHex(),this.vertexColors!==r.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==r.NormalBlending&&(e.blending=this.blending),this.side!==r.FrontSide&&(e.side=this.side)):this instanceof r.MeshLambertMaterial?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),this.vertexColors!==r.NoColors&&(e.vertexColors=this.vertexColors),this.shading!==r.SmoothShading&&(e.shading=this.shading),this.blending!==r.NormalBlending&&(e.blending=this.blending),this.side!==r.FrontSide&&(e.side=this.side)):this instanceof r.MeshPhongMaterial?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),e.specular=this.specular.getHex(),e.shininess=this.shininess,this.vertexColors!==r.NoColors&&(e.vertexColors=this.vertexColors),this.shading!==r.SmoothShading&&(e.shading=this.shading),this.blending!==r.NormalBlending&&(e.blending=this.blending),this.side!==r.FrontSide&&(e.side=this.side)):this instanceof r.MeshNormalMaterial?(this.blending!==r.NormalBlending&&(e.blending=this.blending),this.side!==r.FrontSide&&(e.side=this.side)):this instanceof r.MeshDepthMaterial?(this.blending!==r.NormalBlending&&(e.blending=this.blending),this.side!==r.FrontSide&&(e.side=this.side)):this instanceof r.PointCloudMaterial?(e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.color=this.color.getHex(),this.vertexColors!==r.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==r.NormalBlending&&(e.blending=this.blending)):this instanceof r.ShaderMaterial?(e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader):this instanceof r.SpriteMaterial&&(e.color=this.color.getHex()),this.opacity<1&&(e.opacity=this.opacity),this.transparent!==!1&&(e.transparent=this.transparent),this.wireframe!==!1&&(e.wireframe=this.wireframe),e},clone:function(e){return void 0===e&&(e=new r.Material),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.blendSrcAlpha=this.blendSrcAlpha,e.blendDstAlpha=this.blendDstAlpha,e.blendEquationAlpha=this.blendEquationAlpha,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.Material.prototype),r.MaterialIdCount=0,r.LineBasicMaterial=function(e){r.Material.call(this),this.type="LineBasicMaterial",this.color=new r.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=r.NoColors,this.fog=!0,this.setValues(e)},r.LineBasicMaterial.prototype=Object.create(r.Material.prototype),r.LineBasicMaterial.prototype.constructor=r.LineBasicMaterial,r.LineBasicMaterial.prototype.clone=function(){var e=new r.LineBasicMaterial;return r.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e},r.LineDashedMaterial=function(e){r.Material.call(this),this.type="LineDashedMaterial",this.color=new r.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},r.LineDashedMaterial.prototype=Object.create(r.Material.prototype),r.LineDashedMaterial.prototype.constructor=r.LineDashedMaterial,r.LineDashedMaterial.prototype.clone=function(){var e=new r.LineDashedMaterial;return r.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.scale=this.scale,e.dashSize=this.dashSize,e.gapSize=this.gapSize,e.vertexColors=this.vertexColors,e.fog=this.fog,e},r.MeshBasicMaterial=function(e){r.Material.call(this),this.type="MeshBasicMaterial",this.color=new r.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=r.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(e)},r.MeshBasicMaterial.prototype=Object.create(r.Material.prototype),r.MeshBasicMaterial.prototype.constructor=r.MeshBasicMaterial,r.MeshBasicMaterial.prototype.clone=function(){var e=new r.MeshBasicMaterial;return r.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e},r.MeshLambertMaterial=function(e){r.Material.call(this),this.type="MeshLambertMaterial",this.color=new r.Color(16777215),this.emissive=new r.Color(0),this.wrapAround=!1,this.wrapRGB=new r.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=r.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},r.MeshLambertMaterial.prototype=Object.create(r.Material.prototype),r.MeshLambertMaterial.prototype.constructor=r.MeshLambertMaterial,r.MeshLambertMaterial.prototype.clone=function(){var e=new r.MeshLambertMaterial;return r.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.emissive.copy(this.emissive),e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},r.MeshPhongMaterial=function(e){r.Material.call(this),this.type="MeshPhongMaterial",this.color=new r.Color(16777215),this.emissive=new r.Color(0),this.specular=new r.Color(1118481),this.shininess=30,this.metal=!1,this.wrapAround=!1,this.wrapRGB=new r.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new r.Vector2(1,1),this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=r.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},r.MeshPhongMaterial.prototype=Object.create(r.Material.prototype),r.MeshPhongMaterial.prototype.constructor=r.MeshPhongMaterial,r.MeshPhongMaterial.prototype.clone=function(){var e=new r.MeshPhongMaterial;return r.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},r.MeshDepthMaterial=function(e){r.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},r.MeshDepthMaterial.prototype=Object.create(r.Material.prototype),r.MeshDepthMaterial.prototype.constructor=r.MeshDepthMaterial,r.MeshDepthMaterial.prototype.clone=function(){var e=new r.MeshDepthMaterial;return r.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},r.MeshNormalMaterial=function(e){r.Material.call(this,e),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},r.MeshNormalMaterial.prototype=Object.create(r.Material.prototype),r.MeshNormalMaterial.prototype.constructor=r.MeshNormalMaterial,r.MeshNormalMaterial.prototype.clone=function(){var e=new r.MeshNormalMaterial;return r.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},r.MeshFaceMaterial=function(e){this.uuid=r.Math.generateUUID(),this.type="MeshFaceMaterial",this.materials=e instanceof Array?e:[]},r.MeshFaceMaterial.prototype={constructor:r.MeshFaceMaterial,toJSON:function(){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},t=0,r=this.materials.length;r>t;t++)e.materials.push(this.materials[t].toJSON());return e},clone:function(){for(var e=new r.MeshFaceMaterial,t=0;t<this.materials.length;t++)e.materials.push(this.materials[t].clone());return e}},r.PointCloudMaterial=function(e){r.Material.call(this),this.type="PointCloudMaterial",this.color=new r.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=r.NoColors,this.fog=!0,this.setValues(e)},r.PointCloudMaterial.prototype=Object.create(r.Material.prototype),r.PointCloudMaterial.prototype.constructor=r.PointCloudMaterial,r.PointCloudMaterial.prototype.clone=function(){var e=new r.PointCloudMaterial;return r.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.vertexColors=this.vertexColors,e.fog=this.fog,e},r.ParticleBasicMaterial=function(e){return r.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial."),new r.PointCloudMaterial(e)},r.ParticleSystemMaterial=function(e){return r.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial."),new r.PointCloudMaterial(e)},r.ShaderMaterial=function(e){r.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.attributes=null,this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=r.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.setValues(e)},r.ShaderMaterial.prototype=Object.create(r.Material.prototype),r.ShaderMaterial.prototype.constructor=r.ShaderMaterial,r.ShaderMaterial.prototype.clone=function(){var e=new r.ShaderMaterial;return r.Material.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=r.UniformsUtils.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},r.RawShaderMaterial=function(e){r.ShaderMaterial.call(this,e),this.type="RawShaderMaterial"},r.RawShaderMaterial.prototype=Object.create(r.ShaderMaterial.prototype),r.RawShaderMaterial.prototype.constructor=r.RawShaderMaterial,r.RawShaderMaterial.prototype.clone=function(){var e=new r.RawShaderMaterial;return r.ShaderMaterial.prototype.clone.call(this,e),e},r.SpriteMaterial=function(e){r.Material.call(this),this.type="SpriteMaterial",this.color=new r.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(e)},r.SpriteMaterial.prototype=Object.create(r.Material.prototype),r.SpriteMaterial.prototype.constructor=r.SpriteMaterial,r.SpriteMaterial.prototype.clone=function(){var e=new r.SpriteMaterial;return r.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.rotation=this.rotation,e.fog=this.fog,e},r.Texture=function(e,t,n,i,o,s,a,l,c){Object.defineProperty(this,"id",{value:r.TextureIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==e?e:r.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:r.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:r.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:r.ClampToEdgeWrapping,this.magFilter=void 0!==o?o:r.LinearFilter,this.minFilter=void 0!==s?s:r.LinearMipMapLinearFilter,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:r.RGBAFormat,this.type=void 0!==l?l:r.UnsignedByteType,this.offset=new r.Vector2(0,0),this.repeat=new r.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},r.Texture.DEFAULT_IMAGE=void 0,r.Texture.DEFAULT_MAPPING=r.UVMapping,r.Texture.prototype={constructor:r.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){e===!0&&this.update(),this._needsUpdate=e},clone:function(e){return void 0===e&&(e=new r.Texture),e.image=this.image,e.mipmaps=this.mipmaps.slice(0),e.mapping=this.mapping,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.format=this.format,e.type=this.type,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.generateMipmaps=this.generateMipmaps,e.premultiplyAlpha=this.premultiplyAlpha,e.flipY=this.flipY,e.unpackAlignment=this.unpackAlignment,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.Texture.prototype),r.TextureIdCount=0,r.CubeTexture=function(e,t,n,i,o,s,a,l,c){t=void 0!==t?t:r.CubeReflectionMapping,r.Texture.call(this,e,t,n,i,o,s,a,l,c),this.images=e},r.CubeTexture.prototype=Object.create(r.Texture.prototype),r.CubeTexture.prototype.constructor=r.CubeTexture,r.CubeTexture.clone=function(e){return void 0===e&&(e=new r.CubeTexture),r.Texture.prototype.clone.call(this,e),e.images=this.images,e},r.CompressedTexture=function(e,t,n,i,o,s,a,l,c,u,d){r.Texture.call(this,null,s,a,l,c,u,i,o,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1},r.CompressedTexture.prototype=Object.create(r.Texture.prototype),r.CompressedTexture.prototype.constructor=r.CompressedTexture,r.CompressedTexture.prototype.clone=function(){var e=new r.CompressedTexture;return r.Texture.prototype.clone.call(this,e),e},r.DataTexture=function(e,t,n,i,o,s,a,l,c,u,d){r.Texture.call(this,null,s,a,l,c,u,i,o,d),this.image={data:e,width:t,height:n}},r.DataTexture.prototype=Object.create(r.Texture.prototype),r.DataTexture.prototype.constructor=r.DataTexture,r.DataTexture.prototype.clone=function(){var e=new r.DataTexture;return r.Texture.prototype.clone.call(this,e),e},r.VideoTexture=function(e,t,n,i,o,s,a,l,c){r.Texture.call(this,e,t,n,i,o,s,a,l,c),this.generateMipmaps=!1;var u=this,d=function h(){requestAnimationFrame(h),e.readyState===e.HAVE_ENOUGH_DATA&&(u.needsUpdate=!0)};d()},r.VideoTexture.prototype=Object.create(r.Texture.prototype),r.VideoTexture.prototype.constructor=r.VideoTexture,r.Group=function(){r.Object3D.call(this),this.type="Group"},r.Group.prototype=Object.create(r.Object3D.prototype),r.Group.prototype.constructor=r.Group,r.PointCloud=function(e,t){r.Object3D.call(this),this.type="PointCloud",this.geometry=void 0!==e?e:new r.Geometry,this.material=void 0!==t?t:new r.PointCloudMaterial({color:16777215*Math.random()})},r.PointCloud.prototype=Object.create(r.Object3D.prototype),r.PointCloud.prototype.constructor=r.PointCloud,r.PointCloud.prototype.raycast=function(){var e=new r.Matrix4,t=new r.Ray;return function(n,i){var o=this,s=o.geometry,a=n.params.PointCloud.threshold;if(e.getInverse(this.matrixWorld),t.copy(n.ray).applyMatrix4(e),null===s.boundingBox||t.isIntersectionBox(s.boundingBox)!==!1){var l=a/((this.scale.x+this.scale.y+this.scale.z)/3),c=new r.Vector3,u=function(e,r){var s=t.distanceToPoint(e);if(l>s){var a=t.closestPointToPoint(e);a.applyMatrix4(o.matrixWorld);var c=n.ray.origin.distanceTo(a);i.push({distance:c,distanceToRay:s,point:a.clone(),index:r,face:null,object:o})}};if(s instanceof r.BufferGeometry){var d=s.attributes,h=d.position.array;if(void 0!==d.index){var f=d.index.array,p=s.offsets;if(0===p.length){var m={start:0,count:f.length,index:0};p=[m]}for(var g=0,v=p.length;v>g;++g)for(var y=p[g].start,_=p[g].count,b=p[g].index,x=y,w=y+_;w>x;x++){var E=b+f[x];c.fromArray(h,3*E),u(c,E)}}else for(var S=h.length/3,x=0;S>x;x++)c.set(h[3*x],h[3*x+1],h[3*x+2]),u(c,x)}else for(var A=this.geometry.vertices,x=0;x<A.length;x++)u(A[x],x)}}}(),r.PointCloud.prototype.clone=function(e){return void 0===e&&(e=new r.PointCloud(this.geometry,this.material)),r.Object3D.prototype.clone.call(this,e),e},r.ParticleSystem=function(e,t){return r.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud."),new r.PointCloud(e,t)},r.Line=function(e,t,n){r.Object3D.call(this),this.type="Line",this.geometry=void 0!==e?e:new r.Geometry,this.material=void 0!==t?t:new r.LineBasicMaterial({color:16777215*Math.random()}),this.mode=void 0!==n?n:r.LineStrip},r.LineStrip=0,r.LinePieces=1,r.Line.prototype=Object.create(r.Object3D.prototype),r.Line.prototype.constructor=r.Line,r.Line.prototype.raycast=function(){var e=new r.Matrix4,t=new r.Ray,n=new r.Sphere;return function(i,o){var s=i.linePrecision,a=s*s,l=this.geometry;if(null===l.boundingSphere&&l.computeBoundingSphere(),n.copy(l.boundingSphere),n.applyMatrix4(this.matrixWorld),i.ray.isIntersectionSphere(n)!==!1){e.getInverse(this.matrixWorld),t.copy(i.ray).applyMatrix4(e);var c=new r.Vector3,u=new r.Vector3,d=new r.Vector3,h=new r.Vector3,f=this.mode===r.LineStrip?1:2;if(l instanceof r.BufferGeometry){var p=l.attributes;if(void 0!==p.index){var m=p.index.array,g=p.position.array,v=l.offsets;0===v.length&&(v=[{start:0,count:m.length,index:0}]);for(var y=0;y<v.length;y++)for(var _=v[y].start,b=v[y].count,x=v[y].index,w=_;_+b-1>w;w+=f){var E=x+m[w],S=x+m[w+1];c.fromArray(g,3*E),u.fromArray(g,3*S);var A=t.distanceSqToSegment(c,u,h,d);if(!(A>a)){var M=t.origin.distanceTo(h);M<i.near||M>i.far||o.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:w,offsetIndex:y,face:null,faceIndex:null,object:this})}}}else for(var g=p.position.array,w=0;w<g.length/3-1;w+=f){c.fromArray(g,3*w),u.fromArray(g,3*w+3);var A=t.distanceSqToSegment(c,u,h,d);
if(!(A>a)){var M=t.origin.distanceTo(h);M<i.near||M>i.far||o.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}else if(l instanceof r.Geometry)for(var T=l.vertices,C=T.length,w=0;C-1>w;w+=f){var A=t.distanceSqToSegment(T[w],T[w+1],h,d);if(!(A>a)){var M=t.origin.distanceTo(h);M<i.near||M>i.far||o.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}}}(),r.Line.prototype.clone=function(e){return void 0===e&&(e=new r.Line(this.geometry,this.material,this.mode)),r.Object3D.prototype.clone.call(this,e),e},r.Mesh=function(e,t){r.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new r.Geometry,this.material=void 0!==t?t:new r.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},r.Mesh.prototype=Object.create(r.Object3D.prototype),r.Mesh.prototype.constructor=r.Mesh,r.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;t>e;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},r.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(r.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},r.Mesh.prototype.raycast=function(){var e=new r.Matrix4,t=new r.Ray,n=new r.Sphere,i=new r.Vector3,o=new r.Vector3,s=new r.Vector3;return function(a,l){var c=this.geometry;if(null===c.boundingSphere&&c.computeBoundingSphere(),n.copy(c.boundingSphere),n.applyMatrix4(this.matrixWorld),a.ray.isIntersectionSphere(n)!==!1&&(e.getInverse(this.matrixWorld),t.copy(a.ray).applyMatrix4(e),null===c.boundingBox||t.isIntersectionBox(c.boundingBox)!==!1))if(c instanceof r.BufferGeometry){var u=this.material;if(void 0===u)return;var d,h,f,p=c.attributes,m=a.precision;if(void 0!==p.index){var g=p.index.array,v=p.position.array,y=c.offsets;0===y.length&&(y=[{start:0,count:g.length,index:0}]);for(var _=0,b=y.length;b>_;++_)for(var x=y[_].start,w=y[_].count,E=y[_].index,S=x,A=x+w;A>S;S+=3){if(d=E+g[S],h=E+g[S+1],f=E+g[S+2],i.fromArray(v,3*d),o.fromArray(v,3*h),s.fromArray(v,3*f),u.side===r.BackSide)var M=t.intersectTriangle(s,o,i,!0);else var M=t.intersectTriangle(i,o,s,u.side!==r.DoubleSide);if(null!==M){M.applyMatrix4(this.matrixWorld);var T=a.ray.origin.distanceTo(M);m>T||T<a.near||T>a.far||l.push({distance:T,point:M,face:new r.Face3(d,h,f,r.Triangle.normal(i,o,s)),faceIndex:null,object:this})}}}else for(var v=p.position.array,S=0,C=0,A=v.length;A>S;S+=3,C+=9){if(d=S,h=S+1,f=S+2,i.fromArray(v,C),o.fromArray(v,C+3),s.fromArray(v,C+6),u.side===r.BackSide)var M=t.intersectTriangle(s,o,i,!0);else var M=t.intersectTriangle(i,o,s,u.side!==r.DoubleSide);if(null!==M){M.applyMatrix4(this.matrixWorld);var T=a.ray.origin.distanceTo(M);m>T||T<a.near||T>a.far||l.push({distance:T,point:M,face:new r.Face3(d,h,f,r.Triangle.normal(i,o,s)),faceIndex:null,object:this})}}}else if(c instanceof r.Geometry)for(var d,h,f,j=this.material instanceof r.MeshFaceMaterial,P=j===!0?this.material.materials:null,m=a.precision,L=c.vertices,D=0,I=c.faces.length;I>D;D++){var R=c.faces[D],u=j===!0?P[R.materialIndex]:this.material;if(void 0!==u){if(d=L[R.a],h=L[R.b],f=L[R.c],u.morphTargets===!0){var O=c.morphTargets,k=this.morphTargetInfluences;i.set(0,0,0),o.set(0,0,0),s.set(0,0,0);for(var N=0,F=O.length;F>N;N++){var V=k[N];if(0!==V){var U=O[N].vertices;i.x+=(U[R.a].x-d.x)*V,i.y+=(U[R.a].y-d.y)*V,i.z+=(U[R.a].z-d.z)*V,o.x+=(U[R.b].x-h.x)*V,o.y+=(U[R.b].y-h.y)*V,o.z+=(U[R.b].z-h.z)*V,s.x+=(U[R.c].x-f.x)*V,s.y+=(U[R.c].y-f.y)*V,s.z+=(U[R.c].z-f.z)*V}}i.add(d),o.add(h),s.add(f),d=i,h=o,f=s}if(u.side===r.BackSide)var M=t.intersectTriangle(f,h,d,!0);else var M=t.intersectTriangle(d,h,f,u.side!==r.DoubleSide);if(null!==M){M.applyMatrix4(this.matrixWorld);var T=a.ray.origin.distanceTo(M);m>T||T<a.near||T>a.far||l.push({distance:T,point:M,face:R,faceIndex:D,object:this})}}}}}(),r.Mesh.prototype.clone=function(e,t){return void 0===e&&(e=new r.Mesh(this.geometry,this.material)),r.Object3D.prototype.clone.call(this,e,t),e},r.Bone=function(e){r.Object3D.call(this),this.type="Bone",this.skin=e},r.Bone.prototype=Object.create(r.Object3D.prototype),r.Bone.prototype.constructor=r.Bone,r.Skeleton=function(e,t,n){if(this.useVertexTexture=void 0!==n?n:!0,this.identityMatrix=new r.Matrix4,e=e||[],this.bones=e.slice(0),this.useVertexTexture){var i;i=this.bones.length>256?64:this.bones.length>64?32:this.bones.length>16?16:8,this.boneTextureWidth=i,this.boneTextureHeight=i,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new r.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,r.RGBAFormat,r.FloatType),this.boneTexture.minFilter=r.NearestFilter,this.boneTexture.magFilter=r.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{r.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var o=0,s=this.bones.length;s>o;o++)this.boneInverses.push(new r.Matrix4)}},r.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var e=0,t=this.bones.length;t>e;e++){var n=new r.Matrix4;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},r.Skeleton.prototype.pose=function(){for(var e,t=0,r=this.bones.length;r>t;t++)e=this.bones[t],e&&e.matrixWorld.getInverse(this.boneInverses[t]);for(var t=0,r=this.bones.length;r>t;t++)e=this.bones[t],e&&(e.parent?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},r.Skeleton.prototype.update=function(){var e=new r.Matrix4;return function(){for(var t=0,r=this.bones.length;r>t;t++){var n=this.bones[t]?this.bones[t].matrixWorld:this.identityMatrix;e.multiplyMatrices(n,this.boneInverses[t]),e.flattenToArrayOffset(this.boneMatrices,16*t)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),r.SkinnedMesh=function(e,t,n){r.Mesh.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new r.Matrix4,this.bindMatrixInverse=new r.Matrix4;var i=[];if(this.geometry&&void 0!==this.geometry.bones){for(var o,s,a,l,c,u=0,d=this.geometry.bones.length;d>u;++u)s=this.geometry.bones[u],a=s.pos,l=s.rotq,c=s.scl,o=new r.Bone(this),i.push(o),o.name=s.name,o.position.set(a[0],a[1],a[2]),o.quaternion.set(l[0],l[1],l[2],l[3]),void 0!==c?o.scale.set(c[0],c[1],c[2]):o.scale.set(1,1,1);for(var u=0,d=this.geometry.bones.length;d>u;++u)s=this.geometry.bones[u],-1!==s.parent?i[s.parent].add(i[u]):this.add(i[u])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new r.Skeleton(i,void 0,n))},r.SkinnedMesh.prototype=Object.create(r.Mesh.prototype),r.SkinnedMesh.prototype.constructor=r.SkinnedMesh,r.SkinnedMesh.prototype.bind=function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},r.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},r.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof r.Geometry)for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e],n=1/t.lengthManhattan();n!==1/0?t.multiplyScalar(n):t.set(1)}},r.SkinnedMesh.prototype.updateMatrixWorld=function(e){r.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):r.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)},r.SkinnedMesh.prototype.clone=function(e){return void 0===e&&(e=new r.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),r.Mesh.prototype.clone.call(this,e),e},r.MorphAnimMesh=function(e,t){r.Mesh.call(this,e,t),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},r.MorphAnimMesh.prototype=Object.create(r.Mesh.prototype),r.MorphAnimMesh.prototype.constructor=r.MorphAnimMesh,r.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},r.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},r.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},r.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;e.animations||(e.animations={});for(var t,r=e.animations,n=/([a-z]+)_?(\d+)/,i=0,o=e.morphTargets.length;o>i;i++){var s=e.morphTargets[i],a=s.name.match(n);if(a&&a.length>1){var l=a[1];r[l]||(r[l]={start:1/0,end:-(1/0)});var c=r[l];i<c.start&&(c.start=i),i>c.end&&(c.end=i),t||(t=l)}}e.firstAnimation=t},r.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,r){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:r}},r.MorphAnimMesh.prototype.playAnimation=function(e,t){var n=this.geometry.animations[e];n?(this.setFrameRange(n.start,n.end),this.duration=1e3*((n.end-n.start)/t),this.time=0):r.warn("THREE.MorphAnimMesh: animation["+e+"] undefined in .playAnimation()")},r.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var n=this.startKeyframe+r.Math.clamp(Math.floor(this.time/t),0,this.length-1);n!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[n]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=n);var i=this.time%t/t;this.directionBackwards&&(i=1-i),this.morphTargetInfluences[this.currentKeyframe]=i,this.morphTargetInfluences[this.lastKeyframe]=1-i},r.MorphAnimMesh.prototype.interpolateTargets=function(e,t,r){for(var n=this.morphTargetInfluences,i=0,o=n.length;o>i;i++)n[i]=0;e>-1&&(n[e]=1-r),t>-1&&(n[t]=r)},r.MorphAnimMesh.prototype.clone=function(e){return void 0===e&&(e=new r.MorphAnimMesh(this.geometry,this.material)),e.duration=this.duration,e.mirroredLoop=this.mirroredLoop,e.time=this.time,e.lastKeyframe=this.lastKeyframe,e.currentKeyframe=this.currentKeyframe,e.direction=this.direction,e.directionBackwards=this.directionBackwards,r.Mesh.prototype.clone.call(this,e),e},r.LOD=function(){r.Object3D.call(this),this.objects=[]},r.LOD.prototype=Object.create(r.Object3D.prototype),r.LOD.prototype.constructor=r.LOD,r.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var r=0;r<this.objects.length&&!(t<this.objects[r].distance);r++);this.objects.splice(r,0,{distance:t,object:e}),this.add(e)},r.LOD.prototype.getObjectForDistance=function(e){for(var t=1,r=this.objects.length;r>t&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object},r.LOD.prototype.raycast=function(){var e=new r.Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(t,r)}}(),r.LOD.prototype.update=function(){var e=new r.Vector3,t=new r.Vector3;return function(r){if(this.objects.length>1){e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var n=e.distanceTo(t);this.objects[0].object.visible=!0;for(var i=1,o=this.objects.length;o>i&&n>=this.objects[i].distance;i++)this.objects[i-1].object.visible=!1,this.objects[i].object.visible=!0;for(;o>i;i++)this.objects[i].object.visible=!1}}}(),r.LOD.prototype.clone=function(e){void 0===e&&(e=new r.LOD),r.Object3D.prototype.clone.call(this,e);for(var t=0,n=this.objects.length;n>t;t++){var i=this.objects[t].object.clone();i.visible=0===t,e.addLevel(i,this.objects[t].distance)}return e},r.Sprite=function(){var e=new Uint16Array([0,1,2,0,2,3]),t=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),n=new Float32Array([0,0,1,0,1,1,0,1]),i=new r.BufferGeometry;return i.addAttribute("index",new r.BufferAttribute(e,1)),i.addAttribute("position",new r.BufferAttribute(t,3)),i.addAttribute("uv",new r.BufferAttribute(n,2)),function(e){r.Object3D.call(this),this.type="Sprite",this.geometry=i,this.material=void 0!==e?e:new r.SpriteMaterial}}(),r.Sprite.prototype=Object.create(r.Object3D.prototype),r.Sprite.prototype.constructor=r.Sprite,r.Sprite.prototype.raycast=function(){var e=new r.Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.distanceToPoint(e);n>this.scale.x||r.push({distance:n,point:this.position,face:null,object:this})}}(),r.Sprite.prototype.clone=function(e){return void 0===e&&(e=new r.Sprite(this.material)),r.Object3D.prototype.clone.call(this,e),e},r.Particle=r.Sprite,r.LensFlare=function(e,t,n,i,o){r.Object3D.call(this),this.lensFlares=[],this.positionScreen=new r.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,n,i,o)},r.LensFlare.prototype=Object.create(r.Object3D.prototype),r.LensFlare.prototype.constructor=r.LensFlare,r.LensFlare.prototype.add=function(e,t,n,i,o,s){void 0===t&&(t=-1),void 0===n&&(n=0),void 0===s&&(s=1),void 0===o&&(o=new r.Color(16777215)),void 0===i&&(i=r.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:e,size:t,distance:n,x:0,y:0,z:0,scale:1,rotation:1,opacity:s,color:o,blending:i})},r.LensFlare.prototype.updateLensFlares=function(){var e,t,r=this.lensFlares.length,n=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(e=0;r>e;e++)t=this.lensFlares[e],t.x=this.positionScreen.x+n*t.distance,t.y=this.positionScreen.y+i*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)},r.Scene=function(){r.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},r.Scene.prototype=Object.create(r.Object3D.prototype),r.Scene.prototype.constructor=r.Scene,r.Scene.prototype.clone=function(e){return void 0===e&&(e=new r.Scene),r.Object3D.prototype.clone.call(this,e),null!==this.fog&&(e.fog=this.fog.clone()),null!==this.overrideMaterial&&(e.overrideMaterial=this.overrideMaterial.clone()),e.autoUpdate=this.autoUpdate,e.matrixAutoUpdate=this.matrixAutoUpdate,e},r.Fog=function(e,t,n){this.name="",this.color=new r.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3},r.Fog.prototype.clone=function(){return new r.Fog(this.color.getHex(),this.near,this.far)},r.FogExp2=function(e,t){this.name="",this.color=new r.Color(e),this.density=void 0!==t?t:25e-5},r.FogExp2.prototype.clone=function(){return new r.FogExp2(this.color.getHex(),this.density)},r.ShaderChunk={},r.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n	return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n	float distance = dot( planeNormal, point-pointOnPlane );\n	return point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n	if ( decayExponent > 0.0 ) {\n	  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n	}\n	return 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n	return pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n	return a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n	return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n	return a;\n#endif\n}\n",r.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n	if ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",r.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n	vec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n	float dotProduct = dot( transformedNormal, dirVector );\n	vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n	#ifdef DOUBLE_SIDED\n\n		vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n		#ifdef WRAP_AROUND\n\n			vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n		#endif\n\n	#endif\n\n	#ifdef WRAP_AROUND\n\n		vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n		directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n		#ifdef DOUBLE_SIDED\n\n			directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n		#endif\n\n	#endif\n\n	vLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n	#ifdef DOUBLE_SIDED\n\n		vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n	#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n		lVector = normalize( lVector );\n		float dotProduct = dot( transformedNormal, lVector );\n\n		vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n		#ifdef DOUBLE_SIDED\n\n			vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n			#ifdef WRAP_AROUND\n\n				vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n			#endif\n\n		#endif\n\n		#ifdef WRAP_AROUND\n\n			vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n			pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n			#ifdef DOUBLE_SIDED\n\n				pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n			#endif\n\n		#endif\n\n		vLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n			float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n			lVector = normalize( lVector );\n\n			float dotProduct = dot( transformedNormal, lVector );\n			vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n			#ifdef DOUBLE_SIDED\n\n				vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n				#ifdef WRAP_AROUND\n\n					vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n				#endif\n\n			#endif\n\n			#ifdef WRAP_AROUND\n\n				vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n				spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n				#ifdef DOUBLE_SIDED\n\n					spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n				#endif\n\n			#endif\n\n			vLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\n\n			#ifdef DOUBLE_SIDED\n\n				vLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\n\n			#endif\n\n		}\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n		float dotProduct = dot( transformedNormal, lVector );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n		float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n		vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n		#endif\n\n	}\n\n#endif\n\nvLightFront += ambientLightColor;\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack += ambientLightColor;\n\n#endif\n",r.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n	uniform vec4 offsetRepeat;\n	uniform sampler2D map;\n\n#endif\n",r.ShaderChunk.default_vertex="#ifdef USE_SKINNING\n\n	vec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n\n	vec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n\n	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",r.ShaderChunk.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",r.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n	#ifdef USE_MORPHNORMALS\n\n	vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n	#else\n\n	vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n	#endif\n\n#endif\n",r.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n	uniform float logDepthBufFC;\n\n#endif",r.ShaderChunk.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n\n#endif",r.ShaderChunk.lights_phong_fragment="#ifndef FLAT_SHADED\n\n	vec3 normal = normalize( vNormal );\n\n	#ifdef DOUBLE_SIDED\n\n		normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n	#endif\n\n#else\n\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef USE_NORMALMAP\n\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n		lVector = normalize( lVector );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lVector );\n\n		#ifdef WRAP_AROUND\n\n			float pointDiffuseWeightFull = max( dotProduct, 0.0 );\n			float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float pointDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		totalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\n\n				// specular\n\n		vec3 pointHalfVector = normalize( lVector + viewPosition );\n		float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n		float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n		totalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n		lVector = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n			// diffuse\n\n			float dotProduct = dot( normal, lVector );\n\n			#ifdef WRAP_AROUND\n\n				float spotDiffuseWeightFull = max( dotProduct, 0.0 );\n				float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n				vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n			#else\n\n				float spotDiffuseWeight = max( dotProduct, 0.0 );\n\n			#endif\n\n			totalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\n\n			// specular\n\n			vec3 spotHalfVector = normalize( lVector + viewPosition );\n			float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n			float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n			float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n			totalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n		// diffuse\n\n		float dotProduct = dot( normal, dirVector );\n\n		#ifdef WRAP_AROUND\n\n			float dirDiffuseWeightFull = max( dotProduct, 0.0 );\n			float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float dirDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		totalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\n\n		// specular\n\n		vec3 dirHalfVector = normalize( dirVector + viewPosition );\n		float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n		float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n		/*\n		// fresnel term from skin shader\n		const float F0 = 0.128;\n\n		float base = 1.0 - dot( viewPosition, dirHalfVector );\n		float exponential = pow( base, 5.0 );\n\n		float fresnel = exponential + F0 * ( 1.0 - exponential );\n		*/\n\n		/*\n		// fresnel term from fresnel shader\n		const float mFresnelBias = 0.08;\n		const float mFresnelScale = 0.3;\n		const float mFresnelPower = 5.0;\n\n		float fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n		*/\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		// 		dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n		totalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lVector );\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		totalDiffuseLight += hemiColor;\n\n		// specular (sky light)\n\n		vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n		float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n		float hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n		// specular (ground light)\n\n		vec3 lVectorGround = -lVector;\n\n		vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n		float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n		float hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n		float dotProductGround = dot( normal, lVectorGround );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n		vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n		totalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n	}\n\n#endif\n\n#ifdef METAL\n\n	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\n\n#else\n\n	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\n\n#endif\n",
r.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n	uniform vec3 fogColor;\n\n	#ifdef FOG_EXP2\n\n		uniform float fogDensity;\n\n	#else\n\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n\n#endif",r.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n	vec3 morphedNormal = vec3( 0.0 );\n\n	morphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	morphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	morphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	morphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n	morphedNormal += normal;\n\n#endif",r.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n	uniform float reflectivity;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	uniform float flipEnvMap;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		uniform float refractionRatio;\n\n	#else\n\n		varying vec3 vReflect;\n\n	#endif\n\n#endif\n",r.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",r.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n\n	// Per-Pixel Tangent Space Normal Mapping\n	// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n\n	}\n\n#endif\n",r.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n",r.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n	uniform sampler2D lightMap;\n\n#endif",r.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n	}\n\n#endif",r.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	vWorldPosition = worldPosition.xyz;\n\n#endif",r.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n	vec4 texelColor = texture2D( map, vUv );\n\n	texelColor.xyz = inputToLinear( texelColor.xyz );\n\n	diffuseColor *= texelColor;\n\n#endif",r.ShaderChunk.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n	vUv2 = uv2;\n\n#endif",r.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n	diffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n",r.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif\n",r.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n	vColor.xyz = inputToLinear( color.xyz );\n\n#endif",r.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n	#ifdef USE_MORPHTARGETS\n\n	vec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n	#else\n\n	vec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n	#endif\n\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n\n#endif\n",r.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	varying vec3 vReflect;\n\n	uniform float refractionRatio;\n\n#endif\n",r.ShaderChunk.linear_to_gamma_fragment="\n	outgoingLight = linearToOutput( outgoingLight );\n",r.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif",r.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n",r.ShaderChunk.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n\n#endif\n",r.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n		// Transforming Normal Vectors with the Inverse Transformation\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n		#ifdef ENVMAP_MODE_REFLECTION\n\n			vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n		#else\n\n			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n		#endif\n\n	#else\n\n		vec3 reflectVec = vReflect;\n\n	#endif\n\n	#ifdef DOUBLE_SIDED\n		float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n	#else\n		float flipNormal = 1.0;\n	#endif\n\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#elif defined( ENVMAP_TYPE_EQUIREC )\n		vec2 sampleUV;\n		sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n		sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n		vec4 envColor = texture2D( envMap, sampleUV );\n\n	#elif defined( ENVMAP_TYPE_SPHERE )\n		vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n	#endif\n\n	envColor.xyz = inputToLinear( envColor.xyz );\n\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_MIX )\n\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_ADD )\n\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n	#endif\n\n#endif\n",r.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n	uniform sampler2D specularMap;\n\n#endif",r.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n	gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n	#endif\n\n#endif",r.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n	#ifndef USE_MORPHNORMALS\n\n	uniform float morphTargetInfluences[ 8 ];\n\n	#else\n\n	uniform float morphTargetInfluences[ 4 ];\n\n	#endif\n\n#endif",r.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n\n#else\n\n	specularStrength = 1.0;\n\n#endif",r.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n	#else\n\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n	#endif\n\n	#ifdef FOG_EXP2\n\n		float fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\n		fogFactor = whiteCompliment( fogFactor );\n\n	#else\n\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n	#endif\n	\n	outgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif",r.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n\n	// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n	// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n	vec2 dHdxy_fwd() {\n\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n		return vec2( dBx, dBy );\n\n	}\n\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;		// normalized\n\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n\n		float fDet = dot( vSigmaX, R1 );\n\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n\n	}\n\n#endif\n",r.ShaderChunk.defaultnormal_vertex="#ifdef USE_SKINNING\n\n	vec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n	vec3 objectNormal = morphedNormal;\n\n#else\n\n	vec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n	objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",r.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n	varying vec3 vNormal;\n\n#endif\n",r.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",r.ShaderChunk.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",r.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n	outgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\n\n#endif",r.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n	uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",r.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n	diffuseColor.rgb *= vColor;\n\n#endif",r.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n	vec3 morphed = vec3( 0.0 );\n	morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n	#ifndef USE_MORPHNORMALS\n\n	morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n	#endif\n\n	morphed += position;\n\n#endif",r.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	vec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n	#ifdef ENVMAP_MODE_REFLECTION\n\n		vReflect = reflect( cameraToVertex, worldNormal );\n\n	#else\n\n		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n	#endif\n\n#endif\n",r.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n	#ifdef SHADOWMAP_DEBUG\n\n		vec3 frustumColors[3];\n		frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n		frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n		frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n	#endif\n\n	#ifdef SHADOWMAP_CASCADE\n\n		int inFrustumCount = 0;\n\n	#endif\n\n	float fDepth;\n	vec3 shadowColor = vec3( 1.0 );\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n				// if ( something && something ) breaks ATI OpenGL shader compiler\n				// if ( all( something, something ) ) using this instead\n\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n\n				// don't shadow pixels outside of light frustum\n				// use just first frustum (for cascades)\n				// don't shadow pixels behind far plane of light frustum\n\n		#ifdef SHADOWMAP_CASCADE\n\n			inFrustumCount += int( inFrustum );\n			bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n		#else\n\n			bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n		#endif\n\n		bool frustumTest = all( frustumTestVec );\n\n		if ( frustumTest ) {\n\n			shadowCoord.z += shadowBias[ i ];\n\n			#if defined( SHADOWMAP_TYPE_PCF )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n		/*\n						// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n						// must enroll loop manually\n\n				for ( float y = -1.25; y <= 1.25; y += 1.25 )\n					for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n						vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n								// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n								//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n						float fDepth = unpackDepth( rgbaDepth );\n\n						if ( fDepth < shadowCoord.z )\n							shadow += 1.0;\n\n				}\n\n				shadow /= 9.0;\n\n		*/\n\n				const float shadowDelta = 1.0 / 9.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.25 * xPixelOffset;\n				float dy0 = -1.25 * yPixelOffset;\n				float dx1 = 1.25 * xPixelOffset;\n				float dy1 = 1.25 * yPixelOffset;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.0 * xPixelOffset;\n				float dy0 = -1.0 * yPixelOffset;\n				float dx1 = 1.0 * xPixelOffset;\n				float dy1 = 1.0 * yPixelOffset;\n\n				mat3 shadowKernel;\n				mat3 depthKernel;\n\n				depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n				vec3 shadowZ = vec3( shadowCoord.z );\n				shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n				shadowKernel[0] *= vec3(0.25);\n\n				shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n				shadowKernel[1] *= vec3(0.25);\n\n				shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n				shadowKernel[2] *= vec3(0.25);\n\n				vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n				shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n				shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n				vec4 shadowValues;\n				shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n				shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n				shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n				shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n				shadow = dot( shadowValues, vec4( 1.0 ) );\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#else\n\n				vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n				float fDepth = unpackDepth( rgbaDepth );\n\n				if ( fDepth < shadowCoord.z )\n\n		// spot with multiple shadows is darker\n\n					shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n		// spot with multiple shadows has the same color as single shadow spot\n\n		// 					shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n			#endif\n\n		}\n\n\n		#ifdef SHADOWMAP_DEBUG\n\n			#ifdef SHADOWMAP_CASCADE\n\n				if ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\n\n			#else\n\n				if ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n			#endif\n\n		#endif\n\n	}\n\n	// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\n	shadowColor = inputToLinear( shadowColor );\n\n	outgoingLight = outgoingLight * shadowColor;\n\n#endif\n",r.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n	#ifdef USE_SKINNING\n\n		vec4 worldPosition = modelMatrix * skinned;\n\n	#elif defined( USE_MORPHTARGETS )\n\n		vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n	#else\n\n		vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n	#endif\n\n#endif\n",r.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n	uniform sampler2D shadowMap[ MAX_SHADOWS ];\n	uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n	uniform float shadowDarkness[ MAX_SHADOWS ];\n	uniform float shadowBias[ MAX_SHADOWS ];\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n	float unpackDepth( const in vec4 rgba_depth ) {\n\n		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n		float depth = dot( rgba_depth, bit_shift );\n		return depth;\n\n	}\n\n#endif",r.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n\n	#ifdef BONE_TEXTURE\n\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n\n			y = dy * ( y + 0.5 );\n\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n			mat4 bone = mat4( v1, v2, v3, v4 );\n\n			return bone;\n\n		}\n\n	#else\n\n		uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			mat4 bone = boneGlobalMatrices[ int(i) ];\n			return bone;\n\n		}\n\n	#endif\n\n#endif\n",r.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n	uniform float logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		#extension GL_EXT_frag_depth : enable\n		varying float vFragDepth;\n\n	#endif\n\n#endif",r.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",r.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n	uniform sampler2D alphaMap;\n\n#endif\n",r.UniformsUtils={merge:function(e){for(var t={},r=0;r<e.length;r++){var n=this.clone(e[r]);for(var i in n)t[i]=n[i]}return t},clone:function(e){var t={};for(var n in e){t[n]={};for(var i in e[n]){var o=e[n][i];o instanceof r.Color||o instanceof r.Vector2||o instanceof r.Vector3||o instanceof r.Vector4||o instanceof r.Matrix4||o instanceof r.Texture?t[n][i]=o.clone():o instanceof Array?t[n][i]=o.slice():t[n][i]=o}}return t}},r.UniformsLib={common:{diffuse:{type:"c",value:new r.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new r.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new r.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new r.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new r.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new r.Vector4(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new r.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},r.ShaderLib={basic:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.fog,r.UniformsLib.shadowmap]),vertexShader:[r.ShaderChunk.common,r.ShaderChunk.map_pars_vertex,r.ShaderChunk.lightmap_pars_vertex,r.ShaderChunk.envmap_pars_vertex,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.map_vertex,r.ShaderChunk.lightmap_vertex,r.ShaderChunk.color_vertex,r.ShaderChunk.skinbase_vertex,"	#ifdef USE_ENVMAP",r.ShaderChunk.morphnormal_vertex,r.ShaderChunk.skinnormal_vertex,r.ShaderChunk.defaultnormal_vertex,"	#endif",r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.worldpos_vertex,r.ShaderChunk.envmap_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.map_pars_fragment,r.ShaderChunk.alphamap_pars_fragment,r.ShaderChunk.lightmap_pars_fragment,r.ShaderChunk.envmap_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.specularmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphamap_fragment,r.ShaderChunk.alphatest_fragment,r.ShaderChunk.specularmap_fragment,"	outgoingLight = diffuseColor.rgb;",r.ShaderChunk.lightmap_fragment,r.ShaderChunk.envmap_fragment,r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.linear_to_gamma_fragment,r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},lambert:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.fog,r.UniformsLib.lights,r.UniformsLib.shadowmap,{emissive:{type:"c",value:new r.Color(0)},wrapRGB:{type:"v3",value:new r.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",r.ShaderChunk.common,r.ShaderChunk.map_pars_vertex,r.ShaderChunk.lightmap_pars_vertex,r.ShaderChunk.envmap_pars_vertex,r.ShaderChunk.lights_lambert_pars_vertex,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.map_vertex,r.ShaderChunk.lightmap_vertex,r.ShaderChunk.color_vertex,r.ShaderChunk.morphnormal_vertex,r.ShaderChunk.skinbase_vertex,r.ShaderChunk.skinnormal_vertex,r.ShaderChunk.defaultnormal_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.worldpos_vertex,r.ShaderChunk.envmap_vertex,r.ShaderChunk.lights_lambert_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.map_pars_fragment,r.ShaderChunk.alphamap_pars_fragment,r.ShaderChunk.lightmap_pars_fragment,r.ShaderChunk.envmap_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.specularmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphamap_fragment,r.ShaderChunk.alphatest_fragment,r.ShaderChunk.specularmap_fragment,"	#ifdef DOUBLE_SIDED","		if ( gl_FrontFacing )","			outgoingLight += diffuseColor.rgb * vLightFront + emissive;","		else","			outgoingLight += diffuseColor.rgb * vLightBack + emissive;","	#else","		outgoingLight += diffuseColor.rgb * vLightFront + emissive;","	#endif",r.ShaderChunk.lightmap_fragment,r.ShaderChunk.envmap_fragment,r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.linear_to_gamma_fragment,r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},phong:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.bump,r.UniformsLib.normalmap,r.UniformsLib.fog,r.UniformsLib.lights,r.UniformsLib.shadowmap,{emissive:{type:"c",value:new r.Color(0)},specular:{type:"c",value:new r.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new r.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","	varying vec3 vNormal;","#endif",r.ShaderChunk.common,r.ShaderChunk.map_pars_vertex,r.ShaderChunk.lightmap_pars_vertex,r.ShaderChunk.envmap_pars_vertex,r.ShaderChunk.lights_phong_pars_vertex,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.map_vertex,r.ShaderChunk.lightmap_vertex,r.ShaderChunk.color_vertex,r.ShaderChunk.morphnormal_vertex,r.ShaderChunk.skinbase_vertex,r.ShaderChunk.skinnormal_vertex,r.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","	vNormal = normalize( transformedNormal );","#endif",r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,"	vViewPosition = -mvPosition.xyz;",r.ShaderChunk.worldpos_vertex,r.ShaderChunk.envmap_vertex,r.ShaderChunk.lights_phong_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.map_pars_fragment,r.ShaderChunk.alphamap_pars_fragment,r.ShaderChunk.lightmap_pars_fragment,r.ShaderChunk.envmap_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.lights_phong_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.bumpmap_pars_fragment,r.ShaderChunk.normalmap_pars_fragment,r.ShaderChunk.specularmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphamap_fragment,r.ShaderChunk.alphatest_fragment,r.ShaderChunk.specularmap_fragment,r.ShaderChunk.lights_phong_fragment,r.ShaderChunk.lightmap_fragment,r.ShaderChunk.envmap_fragment,r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.linear_to_gamma_fragment,r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")
},particle_basic:{uniforms:r.UniformsUtils.merge([r.UniformsLib.particle,r.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",r.ShaderChunk.common,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.color_vertex,"	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	#ifdef USE_SIZEATTENUATION","		gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","	#else","		gl_PointSize = size;","	#endif","	gl_Position = projectionMatrix * mvPosition;",r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.worldpos_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.map_particle_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( psColor, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_particle_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphatest_fragment,"	outgoingLight = diffuseColor.rgb;",r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},dashed:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",r.ShaderChunk.common,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.color_vertex,"	vLineDistance = scale * lineDistance;","	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	if ( mod( vLineDistance, totalSize ) > dashSize ) {","		discard;","	}","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.color_fragment,"	outgoingLight = diffuseColor.rgb;",r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[r.ShaderChunk.common,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",r.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		float depth = gl_FragDepthEXT / gl_FragCoord.w;","	#else","		float depth = gl_FragCoord.z / gl_FragCoord.w;","	#endif","	float color = 1.0 - smoothstep( mNear, mFar, depth );","	gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",r.ShaderChunk.common,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vNormal = normalize( normalMatrix * normal );",r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",r.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vWorldPosition = transformDirection( position, modelMatrix );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",r.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vWorldPosition = transformDirection( position, modelMatrix );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","uniform float tFlip;","varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","vec3 direction = normalize( vWorldPosition );","vec2 sampleUV;","sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );","sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","gl_FragColor = texture2D( tEquirect, sampleUV );",r.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[r.ShaderChunk.common,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.skinbase_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.default_vertex,r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","	res -= res.xxyz * bit_mask;","	return res;","}","void main() {",r.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","	#else","		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","	#endif","}"].join("\n")}},r.WebGLRenderer=function(e){function t(e){e.__webglVertexBuffer=Le.createBuffer(),e.__webglColorBuffer=Le.createBuffer(),De.info.memory.geometries++}function n(e){e.__webglVertexBuffer=Le.createBuffer(),e.__webglColorBuffer=Le.createBuffer(),e.__webglLineDistanceBuffer=Le.createBuffer(),De.info.memory.geometries++}function i(e){e.__webglVertexBuffer=Le.createBuffer(),e.__webglNormalBuffer=Le.createBuffer(),e.__webglTangentBuffer=Le.createBuffer(),e.__webglColorBuffer=Le.createBuffer(),e.__webglUVBuffer=Le.createBuffer(),e.__webglUV2Buffer=Le.createBuffer(),e.__webglSkinIndicesBuffer=Le.createBuffer(),e.__webglSkinWeightsBuffer=Le.createBuffer(),e.__webglFaceBuffer=Le.createBuffer(),e.__webglLineBuffer=Le.createBuffer();var t=e.numMorphTargets;if(t){e.__webglMorphTargetsBuffers=[];for(var r=0,n=t;n>r;r++)e.__webglMorphTargetsBuffers.push(Le.createBuffer())}var i=e.numMorphNormals;if(i){e.__webglMorphNormalsBuffers=[];for(var r=0,n=i;n>r;r++)e.__webglMorphNormalsBuffers.push(Le.createBuffer())}De.info.memory.geometries++}function o(e){var t=e.geometry,r=e.material,n=t.vertices.length;if(r.attributes){void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]);for(var i in r.attributes){var o=r.attributes[i];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var s=1;"v2"===o.type?s=2:"v3"===o.type?s=3:"v4"===o.type?s=4:"c"===o.type&&(s=3),o.size=s,o.array=new Float32Array(n*s),o.buffer=Le.createBuffer(),o.buffer.belongsToAttribute=i,o.needsUpdate=!0}t.__webglCustomAttributesList.push(o)}}}function s(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__webglParticleCount=r,o(t)}function a(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__lineDistanceArray=new Float32Array(1*r),e.__webglLineCount=r,o(t)}function l(e,t){var r=t.geometry,n=e.faces3,i=3*n.length,o=1*n.length,s=3*n.length,a=c(t,e);e.__vertexArray=new Float32Array(3*i),e.__normalArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__uvArray=new Float32Array(2*i),r.faceVertexUvs.length>1&&(e.__uv2Array=new Float32Array(2*i)),r.hasTangents&&(e.__tangentArray=new Float32Array(4*i)),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*i),e.__skinWeightArray=new Float32Array(4*i));var l=null!==tt.get("OES_element_index_uint")&&o>21845?Uint32Array:Uint16Array;e.__typeArray=l,e.__faceArray=new l(3*o),e.__lineArray=new l(2*s);var u=e.numMorphTargets;if(u){e.__morphTargetsArrays=[];for(var d=0,h=u;h>d;d++)e.__morphTargetsArrays.push(new Float32Array(3*i))}var f=e.numMorphNormals;if(f){e.__morphNormalsArrays=[];for(var d=0,h=f;h>d;d++)e.__morphNormalsArrays.push(new Float32Array(3*i))}if(e.__webglFaceCount=3*o,e.__webglLineCount=2*s,a.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var p in a.attributes){var m=a.attributes[p],g={};for(var v in m)g[v]=m[v];if(!g.__webglInitialized||g.createUniqueBuffers){g.__webglInitialized=!0;var y=1;"v2"===g.type?y=2:"v3"===g.type?y=3:"v4"===g.type?y=4:"c"===g.type&&(y=3),g.size=y,g.array=new Float32Array(i*y),g.buffer=Le.createBuffer(),g.buffer.belongsToAttribute=p,m.needsUpdate=!0,g.__original=m}e.__webglCustomAttributesList.push(g)}}e.__inittedArrays=!0}function c(e,t){return e.material instanceof r.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function u(e){return e instanceof r.MeshPhongMaterial==!1&&e.shading===r.FlatShading}function d(e,t,r){var n,i,o,s,a,l,c,u,d,h,f,p=e.vertices,m=p.length,g=e.colors,v=g.length,y=e.__vertexArray,_=e.__colorArray,b=e.verticesNeedUpdate,x=e.colorsNeedUpdate,w=e.__webglCustomAttributesList;if(b){for(n=0;m>n;n++)o=p[n],s=3*n,y[s]=o.x,y[s+1]=o.y,y[s+2]=o.z;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglVertexBuffer),Le.bufferData(Le.ARRAY_BUFFER,y,t)}if(x){for(i=0;v>i;i++)a=g[i],s=3*i,_[s]=a.r,_[s+1]=a.g,_[s+2]=a.b;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglColorBuffer),Le.bufferData(Le.ARRAY_BUFFER,_,t)}if(w)for(l=0,c=w.length;c>l;l++){if(f=w[l],f.needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo))if(d=f.value.length,s=0,1===f.size)for(u=0;d>u;u++)f.array[u]=f.value[u];else if(2===f.size)for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.x,f.array[s+1]=h.y,s+=2;else if(3===f.size)if("c"===f.type)for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.r,f.array[s+1]=h.g,f.array[s+2]=h.b,s+=3;else for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.x,f.array[s+1]=h.y,f.array[s+2]=h.z,s+=3;else if(4===f.size)for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.x,f.array[s+1]=h.y,f.array[s+2]=h.z,f.array[s+3]=h.w,s+=4;Le.bindBuffer(Le.ARRAY_BUFFER,f.buffer),Le.bufferData(Le.ARRAY_BUFFER,f.array,t),f.needsUpdate=!1}}function h(e,t){var r,n,i,o,s,a,l,c,u,d,h,f,p=e.vertices,m=e.colors,g=e.lineDistances,v=p.length,y=m.length,_=g.length,b=e.__vertexArray,x=e.__colorArray,w=e.__lineDistanceArray,E=e.verticesNeedUpdate,S=e.colorsNeedUpdate,A=e.lineDistancesNeedUpdate,M=e.__webglCustomAttributesList;if(E){for(r=0;v>r;r++)o=p[r],s=3*r,b[s]=o.x,b[s+1]=o.y,b[s+2]=o.z;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglVertexBuffer),Le.bufferData(Le.ARRAY_BUFFER,b,t)}if(S){for(n=0;y>n;n++)a=m[n],s=3*n,x[s]=a.r,x[s+1]=a.g,x[s+2]=a.b;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglColorBuffer),Le.bufferData(Le.ARRAY_BUFFER,x,t)}if(A){for(i=0;_>i;i++)w[i]=g[i];Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglLineDistanceBuffer),Le.bufferData(Le.ARRAY_BUFFER,w,t)}if(M)for(l=0,c=M.length;c>l;l++)if(f=M[l],f.needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo)){if(s=0,d=f.value.length,1===f.size)for(u=0;d>u;u++)f.array[u]=f.value[u];else if(2===f.size)for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.x,f.array[s+1]=h.y,s+=2;else if(3===f.size)if("c"===f.type)for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.r,f.array[s+1]=h.g,f.array[s+2]=h.b,s+=3;else for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.x,f.array[s+1]=h.y,f.array[s+2]=h.z,s+=3;else if(4===f.size)for(u=0;d>u;u++)h=f.value[u],f.array[s]=h.x,f.array[s+1]=h.y,f.array[s+2]=h.z,f.array[s+3]=h.w,s+=4;Le.bindBuffer(Le.ARRAY_BUFFER,f.buffer),Le.bufferData(Le.ARRAY_BUFFER,f.array,t),f.needsUpdate=!1}}function f(e,t,n,i,o){if(e.__inittedArrays){var s,a,l,c,d,h,f,p,m,g,v,y,_,b,x,w,E,S,A,M,T,C,j,P,L,D,I,R,O,k,N,F,V,U,B,z,G,H,W,q,X,Y,K=u(o),Q=0,Z=0,J=0,$=0,ee=0,te=0,re=0,ne=0,ie=0,oe=0,se=0,ae=0,le=e.__vertexArray,ce=e.__uvArray,ue=e.__uv2Array,de=e.__normalArray,he=e.__tangentArray,fe=e.__colorArray,pe=e.__skinIndexArray,me=e.__skinWeightArray,ge=e.__morphTargetsArrays,ve=e.__morphNormalsArrays,ye=e.__webglCustomAttributesList,_e=e.__faceArray,be=e.__lineArray,xe=t.geometry,we=xe.verticesNeedUpdate,Ee=xe.elementsNeedUpdate,Se=xe.uvsNeedUpdate,Ae=xe.normalsNeedUpdate,Me=xe.tangentsNeedUpdate,Te=xe.colorsNeedUpdate,Ce=xe.morphTargetsNeedUpdate,je=xe.vertices,Pe=e.faces3,De=xe.faces,Ie=xe.faceVertexUvs[0],Re=xe.faceVertexUvs[1],Oe=xe.skinIndices,ke=xe.skinWeights,Ne=xe.morphTargets,Fe=xe.morphNormals;if(we){for(s=0,a=Pe.length;a>s;s++)c=De[Pe[s]],y=je[c.a],_=je[c.b],b=je[c.c],le[Z]=y.x,le[Z+1]=y.y,le[Z+2]=y.z,le[Z+3]=_.x,le[Z+4]=_.y,le[Z+5]=_.z,le[Z+6]=b.x,le[Z+7]=b.y,le[Z+8]=b.z,Z+=9;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglVertexBuffer),Le.bufferData(Le.ARRAY_BUFFER,le,n)}if(Ce)for(B=0,z=Ne.length;z>B;B++){for(se=0,s=0,a=Pe.length;a>s;s++)W=Pe[s],c=De[W],y=Ne[B].vertices[c.a],_=Ne[B].vertices[c.b],b=Ne[B].vertices[c.c],G=ge[B],G[se]=y.x,G[se+1]=y.y,G[se+2]=y.z,G[se+3]=_.x,G[se+4]=_.y,G[se+5]=_.z,G[se+6]=b.x,G[se+7]=b.y,G[se+8]=b.z,o.morphNormals&&(K?(S=Fe[B].faceNormals[W],A=S,M=S):(q=Fe[B].vertexNormals[W],S=q.a,A=q.b,M=q.c),H=ve[B],H[se]=S.x,H[se+1]=S.y,H[se+2]=S.z,H[se+3]=A.x,H[se+4]=A.y,H[se+5]=A.z,H[se+6]=M.x,H[se+7]=M.y,H[se+8]=M.z),se+=9;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[B]),Le.bufferData(Le.ARRAY_BUFFER,ge[B],n),o.morphNormals&&(Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[B]),Le.bufferData(Le.ARRAY_BUFFER,ve[B],n))}if(ke.length){for(s=0,a=Pe.length;a>s;s++)c=De[Pe[s]],P=ke[c.a],L=ke[c.b],D=ke[c.c],me[oe]=P.x,me[oe+1]=P.y,me[oe+2]=P.z,me[oe+3]=P.w,me[oe+4]=L.x,me[oe+5]=L.y,me[oe+6]=L.z,me[oe+7]=L.w,me[oe+8]=D.x,me[oe+9]=D.y,me[oe+10]=D.z,me[oe+11]=D.w,I=Oe[c.a],R=Oe[c.b],O=Oe[c.c],pe[oe]=I.x,pe[oe+1]=I.y,pe[oe+2]=I.z,pe[oe+3]=I.w,pe[oe+4]=R.x,pe[oe+5]=R.y,pe[oe+6]=R.z,pe[oe+7]=R.w,pe[oe+8]=O.x,pe[oe+9]=O.y,pe[oe+10]=O.z,pe[oe+11]=O.w,oe+=12;oe>0&&(Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),Le.bufferData(Le.ARRAY_BUFFER,pe,n),Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),Le.bufferData(Le.ARRAY_BUFFER,me,n))}if(Te){for(s=0,a=Pe.length;a>s;s++)c=De[Pe[s]],f=c.vertexColors,p=c.color,3===f.length&&o.vertexColors===r.VertexColors?(T=f[0],C=f[1],j=f[2]):(T=p,C=p,j=p),fe[ie]=T.r,fe[ie+1]=T.g,fe[ie+2]=T.b,fe[ie+3]=C.r,fe[ie+4]=C.g,fe[ie+5]=C.b,fe[ie+6]=j.r,fe[ie+7]=j.g,fe[ie+8]=j.b,ie+=9;ie>0&&(Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglColorBuffer),Le.bufferData(Le.ARRAY_BUFFER,fe,n))}if(Me&&xe.hasTangents){for(s=0,a=Pe.length;a>s;s++)c=De[Pe[s]],m=c.vertexTangents,x=m[0],w=m[1],E=m[2],he[re]=x.x,he[re+1]=x.y,he[re+2]=x.z,he[re+3]=x.w,he[re+4]=w.x,he[re+5]=w.y,he[re+6]=w.z,he[re+7]=w.w,he[re+8]=E.x,he[re+9]=E.y,he[re+10]=E.z,he[re+11]=E.w,re+=12;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglTangentBuffer),Le.bufferData(Le.ARRAY_BUFFER,he,n)}if(Ae){for(s=0,a=Pe.length;a>s;s++)if(c=De[Pe[s]],d=c.vertexNormals,h=c.normal,3===d.length&&K===!1)for(k=0;3>k;k++)F=d[k],de[te]=F.x,de[te+1]=F.y,de[te+2]=F.z,te+=3;else for(k=0;3>k;k++)de[te]=h.x,de[te+1]=h.y,de[te+2]=h.z,te+=3;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglNormalBuffer),Le.bufferData(Le.ARRAY_BUFFER,de,n)}if(Se&&Ie){for(s=0,a=Pe.length;a>s;s++)if(l=Pe[s],g=Ie[l],void 0!==g)for(k=0;3>k;k++)V=g[k],ce[J]=V.x,ce[J+1]=V.y,J+=2;J>0&&(Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglUVBuffer),Le.bufferData(Le.ARRAY_BUFFER,ce,n))}if(Se&&Re){for(s=0,a=Pe.length;a>s;s++)if(l=Pe[s],v=Re[l],void 0!==v)for(k=0;3>k;k++)U=v[k],ue[$]=U.x,ue[$+1]=U.y,$+=2;$>0&&(Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglUV2Buffer),Le.bufferData(Le.ARRAY_BUFFER,ue,n))}if(Ee){for(s=0,a=Pe.length;a>s;s++)_e[ee]=Q,_e[ee+1]=Q+1,_e[ee+2]=Q+2,ee+=3,be[ne]=Q,be[ne+1]=Q+1,be[ne+2]=Q,be[ne+3]=Q+2,be[ne+4]=Q+1,be[ne+5]=Q+2,ne+=6,Q+=3;Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),Le.bufferData(Le.ELEMENT_ARRAY_BUFFER,_e,n),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),Le.bufferData(Le.ELEMENT_ARRAY_BUFFER,be,n)}if(ye)for(k=0,N=ye.length;N>k;k++)if(Y=ye[k],Y.__original.needsUpdate){if(ae=0,1===Y.size){if(void 0===Y.boundTo||"vertices"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)c=De[Pe[s]],Y.array[ae]=Y.value[c.a],Y.array[ae+1]=Y.value[c.b],Y.array[ae+2]=Y.value[c.c],ae+=3;else if("faces"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)X=Y.value[Pe[s]],Y.array[ae]=X,Y.array[ae+1]=X,Y.array[ae+2]=X,ae+=3}else if(2===Y.size){if(void 0===Y.boundTo||"vertices"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)c=De[Pe[s]],y=Y.value[c.a],_=Y.value[c.b],b=Y.value[c.c],Y.array[ae]=y.x,Y.array[ae+1]=y.y,Y.array[ae+2]=_.x,Y.array[ae+3]=_.y,Y.array[ae+4]=b.x,Y.array[ae+5]=b.y,ae+=6;else if("faces"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)X=Y.value[Pe[s]],y=X,_=X,b=X,Y.array[ae]=y.x,Y.array[ae+1]=y.y,Y.array[ae+2]=_.x,Y.array[ae+3]=_.y,Y.array[ae+4]=b.x,Y.array[ae+5]=b.y,ae+=6}else if(3===Y.size){var Ve;if(Ve="c"===Y.type?["r","g","b"]:["x","y","z"],void 0===Y.boundTo||"vertices"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)c=De[Pe[s]],y=Y.value[c.a],_=Y.value[c.b],b=Y.value[c.c],Y.array[ae]=y[Ve[0]],Y.array[ae+1]=y[Ve[1]],Y.array[ae+2]=y[Ve[2]],Y.array[ae+3]=_[Ve[0]],Y.array[ae+4]=_[Ve[1]],Y.array[ae+5]=_[Ve[2]],Y.array[ae+6]=b[Ve[0]],Y.array[ae+7]=b[Ve[1]],Y.array[ae+8]=b[Ve[2]],ae+=9;else if("faces"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)X=Y.value[Pe[s]],y=X,_=X,b=X,Y.array[ae]=y[Ve[0]],Y.array[ae+1]=y[Ve[1]],Y.array[ae+2]=y[Ve[2]],Y.array[ae+3]=_[Ve[0]],Y.array[ae+4]=_[Ve[1]],Y.array[ae+5]=_[Ve[2]],Y.array[ae+6]=b[Ve[0]],Y.array[ae+7]=b[Ve[1]],Y.array[ae+8]=b[Ve[2]],ae+=9;else if("faceVertices"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)X=Y.value[Pe[s]],y=X[0],_=X[1],b=X[2],Y.array[ae]=y[Ve[0]],Y.array[ae+1]=y[Ve[1]],Y.array[ae+2]=y[Ve[2]],Y.array[ae+3]=_[Ve[0]],Y.array[ae+4]=_[Ve[1]],Y.array[ae+5]=_[Ve[2]],Y.array[ae+6]=b[Ve[0]],Y.array[ae+7]=b[Ve[1]],Y.array[ae+8]=b[Ve[2]],ae+=9}else if(4===Y.size)if(void 0===Y.boundTo||"vertices"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)c=De[Pe[s]],y=Y.value[c.a],_=Y.value[c.b],b=Y.value[c.c],Y.array[ae]=y.x,Y.array[ae+1]=y.y,Y.array[ae+2]=y.z,Y.array[ae+3]=y.w,Y.array[ae+4]=_.x,Y.array[ae+5]=_.y,Y.array[ae+6]=_.z,Y.array[ae+7]=_.w,Y.array[ae+8]=b.x,Y.array[ae+9]=b.y,Y.array[ae+10]=b.z,Y.array[ae+11]=b.w,ae+=12;else if("faces"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)X=Y.value[Pe[s]],y=X,_=X,b=X,Y.array[ae]=y.x,Y.array[ae+1]=y.y,Y.array[ae+2]=y.z,Y.array[ae+3]=y.w,Y.array[ae+4]=_.x,Y.array[ae+5]=_.y,Y.array[ae+6]=_.z,Y.array[ae+7]=_.w,Y.array[ae+8]=b.x,Y.array[ae+9]=b.y,Y.array[ae+10]=b.z,Y.array[ae+11]=b.w,ae+=12;else if("faceVertices"===Y.boundTo)for(s=0,a=Pe.length;a>s;s++)X=Y.value[Pe[s]],y=X[0],_=X[1],b=X[2],Y.array[ae]=y.x,Y.array[ae+1]=y.y,Y.array[ae+2]=y.z,Y.array[ae+3]=y.w,Y.array[ae+4]=_.x,Y.array[ae+5]=_.y,Y.array[ae+6]=_.z,Y.array[ae+7]=_.w,Y.array[ae+8]=b.x,Y.array[ae+9]=b.y,Y.array[ae+10]=b.z,Y.array[ae+11]=b.w,ae+=12;Le.bindBuffer(Le.ARRAY_BUFFER,Y.buffer),Le.bufferData(Le.ARRAY_BUFFER,Y.array,n)}i&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function p(e,t,r,n){for(var i=r.attributes,o=t.attributes,s=t.attributesKeys,a=0,l=s.length;l>a;a++){var c=s[a],u=o[c];if(u>=0){var d=i[c];if(void 0!==d){var h=d.itemSize;Le.bindBuffer(Le.ARRAY_BUFFER,d.buffer),et.enableAttribute(u),Le.vertexAttribPointer(u,h,Le.FLOAT,!1,0,n*h*4)}else void 0!==e.defaultAttributeValues&&(2===e.defaultAttributeValues[c].length?Le.vertexAttrib2fv(u,e.defaultAttributeValues[c]):3===e.defaultAttributeValues[c].length&&Le.vertexAttrib3fv(u,e.defaultAttributeValues[c]))}}et.disableUnusedAttributes()}function m(e,t,r){var n=e.program.attributes;if(-1!==r.morphTargetBase&&n.position>=0?(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[r.morphTargetBase]),et.enableAttribute(n.position),Le.vertexAttribPointer(n.position,3,Le.FLOAT,!1,0,0)):n.position>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglVertexBuffer),et.enableAttribute(n.position),Le.vertexAttribPointer(n.position,3,Le.FLOAT,!1,0,0)),r.morphTargetForcedOrder.length)for(var i,o=0,s=r.morphTargetForcedOrder,a=r.morphTargetInfluences;o<e.numSupportedMorphTargets&&o<s.length;)i=n["morphTarget"+o],i>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[s[o]]),et.enableAttribute(i),Le.vertexAttribPointer(i,3,Le.FLOAT,!1,0,0)),i=n["morphNormal"+o],i>=0&&e.morphNormals&&(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[s[o]]),et.enableAttribute(i),Le.vertexAttribPointer(i,3,Le.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[o]=a[s[o]],o++;else{var l=[],a=r.morphTargetInfluences,c=r.geometry.morphTargets;a.length>c.length&&(a.length=c.length);for(var u=0,d=a.length;d>u;u++){var h=a[u];l.push([h,u])}l.length>e.numSupportedMorphTargets?(l.sort(y),l.length=e.numSupportedMorphTargets):l.length>e.numSupportedMorphNormals?l.sort(y):0===l.length&&l.push([0,0]);for(var i,o=0,f=e.numSupportedMorphTargets;f>o;o++)if(l[o]){var p=l[o][1];i=n["morphTarget"+o],i>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[p]),et.enableAttribute(i),Le.vertexAttribPointer(i,3,Le.FLOAT,!1,0,0)),i=n["morphNormal"+o],i>=0&&e.morphNormals&&(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[p]),et.enableAttribute(i),Le.vertexAttribPointer(i,3,Le.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[o]=a[p]}else r.__webglMorphTargetInfluences[o]=0}null!==e.program.uniforms.morphTargetInfluences&&Le.uniform1fv(e.program.uniforms.morphTargetInfluences,r.__webglMorphTargetInfluences)}function g(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function v(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function y(e,t){return t[0]-e[0]}function _(e){if(e.visible!==!1){if(e instanceof r.Scene||e instanceof r.Group);else if(S(e),e instanceof r.Light)Se.push(e);else if(e instanceof r.Sprite)je.push(e);else if(e instanceof r.LensFlare)Pe.push(e);else{var t=Ae[e.id];if(t&&(e.frustumCulled===!1||qe.intersectsObject(e)===!0))for(var n=0,i=t.length;i>n;n++){var o=t[n];E(o),o.render=!0,De.sortObjects===!0&&(Ye.setFromMatrixPosition(e.matrixWorld),Ye.applyProjection(Xe),o.z=Ye.z)}}for(var n=0,i=e.children.length;i>n;n++)_(e.children[n])}}function b(e,t,n,i,o){for(var s,a=0,l=e.length;l>a;a++){var c=e[a],u=c.object,d=c.buffer;if(Q(u,t),o)s=o;else{if(s=c.material,!s)continue;O(s)}De.setMaterialFaces(s),d instanceof r.BufferGeometry?De.renderBufferDirect(t,n,i,s,d,u):De.renderBuffer(t,n,i,s,d,u)}}function x(e,t,r,n,i,o){for(var s,a=0,l=e.length;l>a;a++){var c=e[a],u=c.object;if(u.visible){if(o)s=o;else{if(s=c[t],!s)continue;O(s)}De.renderImmediateObject(r,n,i,s,u)}}}function w(e){var t=e.object,r=t.material;r.transparent?(e.transparent=r,e.opaque=null):(e.opaque=r,e.transparent=null)}function E(e){var t=e.object,n=e.buffer,i=t.geometry,o=t.material;if(o instanceof r.MeshFaceMaterial){var s=i instanceof r.BufferGeometry?0:n.materialIndex;o=o.materials[s],e.material=o,o.transparent?Ce.push(e):Te.push(e)}else o&&(e.material=o,o.transparent?Ce.push(e):Te.push(e))}function S(e){void 0===e.__webglInit&&(e.__webglInit=!0,e._modelViewMatrix=new r.Matrix4,e._normalMatrix=new r.Matrix3,e.addEventListener("removed",xt));var i=e.geometry;if(void 0===i||void 0===i.__webglInit&&(i.__webglInit=!0,i.addEventListener("dispose",wt),i instanceof r.BufferGeometry?De.info.memory.geometries++:e instanceof r.Mesh?M(e,i):e instanceof r.Line?void 0===i.__webglVertexBuffer&&(n(i),a(i,e),i.verticesNeedUpdate=!0,i.colorsNeedUpdate=!0,i.lineDistancesNeedUpdate=!0):e instanceof r.PointCloud&&void 0===i.__webglVertexBuffer&&(t(i),s(i,e),i.verticesNeedUpdate=!0,i.colorsNeedUpdate=!0)),void 0===e.__webglActive)if(e.__webglActive=!0,e instanceof r.Mesh){if(i instanceof r.BufferGeometry)T(Ae,i,e);else if(i instanceof r.Geometry)for(var o=Lt[i.id],l=0,c=o.length;c>l;l++)T(Ae,o[l],e)}else e instanceof r.Line||e instanceof r.PointCloud?T(Ae,i,e):(e instanceof r.ImmediateRenderObject||e.immediateRenderCallback)&&C(Me,e)}function A(e,t){for(var r,n,i=tt.get("OES_element_index_uint")?4294967296:65535,o={},s=e.morphTargets.length,a=e.morphNormals.length,l={},c=[],u=0,d=e.faces.length;d>u;u++){var h=e.faces[u],f=t?h.materialIndex:0;f in o||(o[f]={hash:f,counter:0}),r=o[f].hash+"_"+o[f].counter,r in l||(n={id:Dt++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:s,numMorphNormals:a},l[r]=n,c.push(n)),l[r].vertices+3>i&&(o[f].counter+=1,r=o[f].hash+"_"+o[f].counter,r in l||(n={id:Dt++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:s,numMorphNormals:a},l[r]=n,c.push(n))),l[r].faces3.push(u),l[r].vertices+=3}return c}function M(e,t){var n=e.material,o=!1;(void 0===Lt[t.id]||t.groupsNeedUpdate===!0)&&(delete Ae[e.id],Lt[t.id]=A(t,n instanceof r.MeshFaceMaterial),t.groupsNeedUpdate=!1);for(var s=Lt[t.id],a=0,c=s.length;c>a;a++){var u=s[a];void 0===u.__webglVertexBuffer?(i(u),l(u,e),t.verticesNeedUpdate=!0,t.morphTargetsNeedUpdate=!0,t.elementsNeedUpdate=!0,t.uvsNeedUpdate=!0,t.normalsNeedUpdate=!0,t.tangentsNeedUpdate=!0,t.colorsNeedUpdate=!0,o=!0):o=!1,(o||void 0===e.__webglActive)&&T(Ae,u,e)}e.__webglActive=!0}function T(e,t,r){var n=r.id;e[n]=e[n]||[],e[n].push({id:n,buffer:t,object:r,material:null,z:0})}function C(e,t){e.push({id:null,object:t,opaque:null,transparent:null,z:0})}function j(e){var t=e.geometry;if(t instanceof r.BufferGeometry)for(var n=t.attributes,i=t.attributesKeys,o=0,s=i.length;s>o;o++){var a=i[o],l=n[a],u="index"===a?Le.ELEMENT_ARRAY_BUFFER:Le.ARRAY_BUFFER;void 0===l.buffer?(l.buffer=Le.createBuffer(),Le.bindBuffer(u,l.buffer),Le.bufferData(u,l.array,l instanceof r.DynamicBufferAttribute?Le.DYNAMIC_DRAW:Le.STATIC_DRAW),l.needsUpdate=!1):l.needsUpdate===!0&&(Le.bindBuffer(u,l.buffer),void 0===l.updateRange||-1===l.updateRange.count?Le.bufferSubData(u,0,l.array):0===l.updateRange.count||(Le.bufferSubData(u,l.updateRange.offset*l.array.BYTES_PER_ELEMENT,l.array.subarray(l.updateRange.offset,l.updateRange.offset+l.updateRange.count)),l.updateRange.count=0),l.needsUpdate=!1)}else if(e instanceof r.Mesh){t.groupsNeedUpdate===!0&&M(e,t);for(var p=Lt[t.id],o=0,m=p.length;m>o;o++){var g=p[o],v=c(e,g),y=v.attributes&&P(v);(t.verticesNeedUpdate||t.morphTargetsNeedUpdate||t.elementsNeedUpdate||t.uvsNeedUpdate||t.normalsNeedUpdate||t.colorsNeedUpdate||t.tangentsNeedUpdate||y)&&f(g,e,Le.DYNAMIC_DRAW,!t.dynamic,v)}t.verticesNeedUpdate=!1,t.morphTargetsNeedUpdate=!1,t.elementsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.tangentsNeedUpdate=!1,v.attributes&&L(v)}else if(e instanceof r.Line){var v=c(e,t),y=v.attributes&&P(v);(t.verticesNeedUpdate||t.colorsNeedUpdate||t.lineDistancesNeedUpdate||y)&&h(t,Le.DYNAMIC_DRAW),t.verticesNeedUpdate=!1,t.colorsNeedUpdate=!1,t.lineDistancesNeedUpdate=!1,v.attributes&&L(v)}else if(e instanceof r.PointCloud){var v=c(e,t),y=v.attributes&&P(v);(t.verticesNeedUpdate||t.colorsNeedUpdate||y)&&d(t,Le.DYNAMIC_DRAW,e),t.verticesNeedUpdate=!1,t.colorsNeedUpdate=!1,v.attributes&&L(v)}}function P(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function L(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function D(e){e instanceof r.Mesh||e instanceof r.PointCloud||e instanceof r.Line?delete Ae[e.id]:(e instanceof r.ImmediateRenderObject||e.immediateRenderCallback)&&I(Me,e),delete e.__webglInit,delete e._modelViewMatrix,delete e._normalMatrix,delete e.__webglActive}function I(e,t){for(var r=e.length-1;r>=0;r--)e[r].object===t&&e.splice(r,1)}function R(e,t,n,i){e.addEventListener("dispose",At);var o=It[e.type];if(o){var s=r.ShaderLib[o];e.__webglShader={uniforms:r.UniformsUtils.clone(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}}else e.__webglShader={uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};var a=ce(t),l=ue(t),c=le(i),u={precision:pe,supportsVertexTextures:ct,map:!!e.map,envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,combine:e.combine,vertexColors:e.vertexColors,fog:n,useFog:e.fog,fogExp:n instanceof r.FogExp2,flatShading:e.shading===r.FlatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:xe,skinning:e.skinning,maxBones:c,useVertexTexture:ut&&i&&i.skeleton&&i.skeleton.useVertexTexture,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:De.maxMorphTargets,maxMorphNormals:De.maxMorphNormals,maxDirLights:a.directional,maxPointLights:a.point,maxSpotLights:a.spot,maxHemiLights:a.hemi,maxShadows:l,shadowMapEnabled:De.shadowMapEnabled&&i.receiveShadow&&l>0,shadowMapType:De.shadowMapType,shadowMapDebug:De.shadowMapDebug,shadowMapCascade:De.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,wrapAround:e.wrapAround,doubleSided:e.side===r.DoubleSide,flipSided:e.side===r.BackSide},d=[];if(o?d.push(o):(d.push(e.fragmentShader),d.push(e.vertexShader)),void 0!==e.defines)for(var h in e.defines)d.push(h),d.push(e.defines[h]);for(var h in u)d.push(h),d.push(u[h]);for(var f,p=d.join(),m=0,g=Ie.length;g>m;m++){var v=Ie[m];if(v.code===p){f=v,f.usedTimes++;break}}void 0===f&&(f=new r.WebGLProgram(De,p,e,u),Ie.push(f),De.info.memory.programs=Ie.length),e.program=f;var y=f.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0;for(var _,b="morphTarget",x=0;x<De.maxMorphTargets;x++)_=b+x,y[_]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;var _,b="morphNormal";for(x=0;x<De.maxMorphNormals;x++)_=b+x,y[_]>=0&&e.numSupportedMorphNormals++}e.uniformsList=[];for(var w in e.__webglShader.uniforms){var E=e.program.uniforms[w];E&&e.uniformsList.push([e.__webglShader.uniforms[w],E])}}function O(e){e.transparent===!0?et.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha):et.setBlending(r.NoBlending),et.setDepthTest(e.depthTest),et.setDepthWrite(e.depthWrite),et.setColorWrite(e.colorWrite),et.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function k(e,t,n,i,o){Ve=0,i.needsUpdate&&(i.program&&Pt(i),R(i,t,n,o),i.needsUpdate=!1),i.morphTargets&&(o.__webglMorphTargetInfluences||(o.__webglMorphTargetInfluences=new Float32Array(De.maxMorphTargets)));var s=!1,a=!1,l=!1,c=i.program,u=c.uniforms,d=i.__webglShader.uniforms;if(c.id!==Re&&(Le.useProgram(c.program),Re=c.id,s=!0,a=!0,l=!0),i.id!==ke&&(-1===ke&&(l=!0),ke=i.id,a=!0),(s||e!==Fe)&&(Le.uniformMatrix4fv(u.projectionMatrix,!1,e.projectionMatrix.elements),xe&&Le.uniform1f(u.logDepthBufFC,2/(Math.log(e.far+1)/Math.LN2)),e!==Fe&&(Fe=e),(i instanceof r.ShaderMaterial||i instanceof r.MeshPhongMaterial||i.envMap)&&null!==u.cameraPosition&&(Ye.setFromMatrixPosition(e.matrixWorld),
Le.uniform3f(u.cameraPosition,Ye.x,Ye.y,Ye.z)),(i instanceof r.MeshPhongMaterial||i instanceof r.MeshLambertMaterial||i instanceof r.MeshBasicMaterial||i instanceof r.ShaderMaterial||i.skinning)&&null!==u.viewMatrix&&Le.uniformMatrix4fv(u.viewMatrix,!1,e.matrixWorldInverse.elements)),i.skinning)if(o.bindMatrix&&null!==u.bindMatrix&&Le.uniformMatrix4fv(u.bindMatrix,!1,o.bindMatrix.elements),o.bindMatrixInverse&&null!==u.bindMatrixInverse&&Le.uniformMatrix4fv(u.bindMatrixInverse,!1,o.bindMatrixInverse.elements),ut&&o.skeleton&&o.skeleton.useVertexTexture){if(null!==u.boneTexture){var h=Y();Le.uniform1i(u.boneTexture,h),De.setTexture(o.skeleton.boneTexture,h)}null!==u.boneTextureWidth&&Le.uniform1i(u.boneTextureWidth,o.skeleton.boneTextureWidth),null!==u.boneTextureHeight&&Le.uniform1i(u.boneTextureHeight,o.skeleton.boneTextureHeight)}else o.skeleton&&o.skeleton.boneMatrices&&null!==u.boneGlobalMatrices&&Le.uniformMatrix4fv(u.boneGlobalMatrices,!1,o.skeleton.boneMatrices);return a&&(n&&i.fog&&B(d,n),(i instanceof r.MeshPhongMaterial||i instanceof r.MeshLambertMaterial||i.lights)&&(Qe&&(l=!0,J(t),Qe=!1),l?(H(d,Ze),W(d,!0)):W(d,!1)),(i instanceof r.MeshBasicMaterial||i instanceof r.MeshLambertMaterial||i instanceof r.MeshPhongMaterial)&&N(d,i),i instanceof r.LineBasicMaterial?F(d,i):i instanceof r.LineDashedMaterial?(F(d,i),V(d,i)):i instanceof r.PointCloudMaterial?U(d,i):i instanceof r.MeshPhongMaterial?z(d,i):i instanceof r.MeshLambertMaterial?G(d,i):i instanceof r.MeshDepthMaterial?(d.mNear.value=e.near,d.mFar.value=e.far,d.opacity.value=i.opacity):i instanceof r.MeshNormalMaterial&&(d.opacity.value=i.opacity),o.receiveShadow&&!i._shadowPass&&q(d,t),K(i.uniformsList)),X(u,o),null!==u.modelMatrix&&Le.uniformMatrix4fv(u.modelMatrix,!1,o.matrixWorld.elements),c}function N(e,t){e.opacity.value=t.opacity,e.diffuse.value=t.color,e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));var n;if(t.map?n=t.map:t.specularMap?n=t.specularMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.alphaMap&&(n=t.alphaMap),void 0!==n){var i=n.offset,o=n.repeat;e.offsetRepeat.value.set(i.x,i.y,o.x,o.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap instanceof r.WebGLRenderTargetCube?1:-1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}function F(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function V(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function U(e,t){if(e.psColor.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size,e.scale.value=de.height/2,e.map.value=t.map,null!==t.map){var r=t.map.offset,n=t.map.repeat;e.offsetRepeat.value.set(r.x,r.y,n.x,n.y)}}function B(e,t){e.fogColor.value=t.color,t instanceof r.Fog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t instanceof r.FogExp2&&(e.fogDensity.value=t.density)}function z(e,t){e.shininess.value=t.shininess,e.emissive.value=t.emissive,e.specular.value=t.specular,t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function G(e,t){e.emissive.value=t.emissive,t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function H(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.pointLightDecay.value=t.point.decays,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.spotLightDecay.value=t.spot.decays,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}function W(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.pointLightDecay.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.spotLightDecay.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function q(e,t){if(e.shadowMatrix)for(var n=0,i=0,o=t.length;o>i;i++){var s=t[i];s.castShadow&&(s instanceof r.SpotLight||s instanceof r.DirectionalLight&&!s.shadowCascade)&&(e.shadowMap.value[n]=s.shadowMap,e.shadowMapSize.value[n]=s.shadowMapSize,e.shadowMatrix.value[n]=s.shadowMatrix,e.shadowDarkness.value[n]=s.shadowDarkness,e.shadowBias.value[n]=s.shadowBias,n++)}}function X(e,t){Le.uniformMatrix4fv(e.modelViewMatrix,!1,t._modelViewMatrix.elements),e.normalMatrix&&Le.uniformMatrix3fv(e.normalMatrix,!1,t._normalMatrix.elements)}function Y(){var e=Ve;return e>=ot&&r.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+ot),Ve+=1,e}function K(e){for(var t,n,i,o=0,s=e.length;s>o;o++){var a=e[o][0];if(a.needsUpdate!==!1){var l=a.type,c=a.value,u=e[o][1];switch(l){case"1i":Le.uniform1i(u,c);break;case"1f":Le.uniform1f(u,c);break;case"2f":Le.uniform2f(u,c[0],c[1]);break;case"3f":Le.uniform3f(u,c[0],c[1],c[2]);break;case"4f":Le.uniform4f(u,c[0],c[1],c[2],c[3]);break;case"1iv":Le.uniform1iv(u,c);break;case"3iv":Le.uniform3iv(u,c);break;case"1fv":Le.uniform1fv(u,c);break;case"2fv":Le.uniform2fv(u,c);break;case"3fv":Le.uniform3fv(u,c);break;case"4fv":Le.uniform4fv(u,c);break;case"Matrix3fv":Le.uniformMatrix3fv(u,!1,c);break;case"Matrix4fv":Le.uniformMatrix4fv(u,!1,c);break;case"i":Le.uniform1i(u,c);break;case"f":Le.uniform1f(u,c);break;case"v2":Le.uniform2f(u,c.x,c.y);break;case"v3":Le.uniform3f(u,c.x,c.y,c.z);break;case"v4":Le.uniform4f(u,c.x,c.y,c.z,c.w);break;case"c":Le.uniform3f(u,c.r,c.g,c.b);break;case"iv1":Le.uniform1iv(u,c);break;case"iv":Le.uniform3iv(u,c);break;case"fv1":Le.uniform1fv(u,c);break;case"fv":Le.uniform3fv(u,c);break;case"v2v":void 0===a._array&&(a._array=new Float32Array(2*c.length));for(var d=0,h=c.length;h>d;d++)i=2*d,a._array[i]=c[d].x,a._array[i+1]=c[d].y;Le.uniform2fv(u,a._array);break;case"v3v":void 0===a._array&&(a._array=new Float32Array(3*c.length));for(var d=0,h=c.length;h>d;d++)i=3*d,a._array[i]=c[d].x,a._array[i+1]=c[d].y,a._array[i+2]=c[d].z;Le.uniform3fv(u,a._array);break;case"v4v":void 0===a._array&&(a._array=new Float32Array(4*c.length));for(var d=0,h=c.length;h>d;d++)i=4*d,a._array[i]=c[d].x,a._array[i+1]=c[d].y,a._array[i+2]=c[d].z,a._array[i+3]=c[d].w;Le.uniform4fv(u,a._array);break;case"m3":Le.uniformMatrix3fv(u,!1,c.elements);break;case"m3v":void 0===a._array&&(a._array=new Float32Array(9*c.length));for(var d=0,h=c.length;h>d;d++)c[d].flattenToArrayOffset(a._array,9*d);Le.uniformMatrix3fv(u,!1,a._array);break;case"m4":Le.uniformMatrix4fv(u,!1,c.elements);break;case"m4v":void 0===a._array&&(a._array=new Float32Array(16*c.length));for(var d=0,h=c.length;h>d;d++)c[d].flattenToArrayOffset(a._array,16*d);Le.uniformMatrix4fv(u,!1,a._array);break;case"t":if(t=c,n=Y(),Le.uniform1i(u,n),!t)continue;t instanceof r.CubeTexture||t.image instanceof Array&&6===t.image.length?te(t,n):t instanceof r.WebGLRenderTargetCube?re(t,n):De.setTexture(t,n);break;case"tv":void 0===a._array&&(a._array=[]);for(var d=0,h=a.value.length;h>d;d++)a._array[d]=Y();Le.uniform1iv(u,a._array);for(var d=0,h=a.value.length;h>d;d++)t=a.value[d],n=a._array[d],t&&De.setTexture(t,n);break;default:r.warn("THREE.WebGLRenderer: Unknown uniform type: "+l)}}}}function Q(e,t){e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld),e._normalMatrix.getNormalMatrix(e._modelViewMatrix)}function Z(e,t,r,n){e[t]=r.r*n,e[t+1]=r.g*n,e[t+2]=r.b*n}function J(e){var t,n,i,o,s,a,l,c,u=0,d=0,h=0,f=Ze,p=f.directional.colors,m=f.directional.positions,g=f.point.colors,v=f.point.positions,y=f.point.distances,_=f.point.decays,b=f.spot.colors,x=f.spot.positions,w=f.spot.distances,E=f.spot.directions,S=f.spot.anglesCos,A=f.spot.exponents,M=f.spot.decays,T=f.hemi.skyColors,C=f.hemi.groundColors,j=f.hemi.positions,P=0,L=0,D=0,I=0,R=0,O=0,k=0,N=0,F=0,V=0,U=0,B=0;for(t=0,n=e.length;n>t;t++)if(i=e[t],!i.onlyShadow)if(o=i.color,l=i.intensity,c=i.distance,i instanceof r.AmbientLight){if(!i.visible)continue;u+=o.r,d+=o.g,h+=o.b}else if(i instanceof r.DirectionalLight){if(R+=1,!i.visible)continue;Ke.setFromMatrixPosition(i.matrixWorld),Ye.setFromMatrixPosition(i.target.matrixWorld),Ke.sub(Ye),Ke.normalize(),F=3*P,m[F]=Ke.x,m[F+1]=Ke.y,m[F+2]=Ke.z,Z(p,F,o,l),P+=1}else if(i instanceof r.PointLight){if(O+=1,!i.visible)continue;V=3*L,Z(g,V,o,l),Ye.setFromMatrixPosition(i.matrixWorld),v[V]=Ye.x,v[V+1]=Ye.y,v[V+2]=Ye.z,y[L]=c,_[L]=0===i.distance?0:i.decay,L+=1}else if(i instanceof r.SpotLight){if(k+=1,!i.visible)continue;U=3*D,Z(b,U,o,l),Ke.setFromMatrixPosition(i.matrixWorld),x[U]=Ke.x,x[U+1]=Ke.y,x[U+2]=Ke.z,w[D]=c,Ye.setFromMatrixPosition(i.target.matrixWorld),Ke.sub(Ye),Ke.normalize(),E[U]=Ke.x,E[U+1]=Ke.y,E[U+2]=Ke.z,S[D]=Math.cos(i.angle),A[D]=i.exponent,M[D]=0===i.distance?0:i.decay,D+=1}else if(i instanceof r.HemisphereLight){if(N+=1,!i.visible)continue;Ke.setFromMatrixPosition(i.matrixWorld),Ke.normalize(),B=3*I,j[B]=Ke.x,j[B+1]=Ke.y,j[B+2]=Ke.z,s=i.color,a=i.groundColor,Z(T,B,s,l),Z(C,B,a,l),I+=1}for(t=3*P,n=Math.max(p.length,3*R);n>t;t++)p[t]=0;for(t=3*L,n=Math.max(g.length,3*O);n>t;t++)g[t]=0;for(t=3*D,n=Math.max(b.length,3*k);n>t;t++)b[t]=0;for(t=3*I,n=Math.max(T.length,3*N);n>t;t++)T[t]=0;for(t=3*I,n=Math.max(C.length,3*N);n>t;t++)C[t]=0;f.directional.length=P,f.point.length=L,f.spot.length=D,f.hemi.length=I,f.ambient[0]=u,f.ambient[1]=d,f.ambient[2]=h}function $(e,t,n){var i;n?(Le.texParameteri(e,Le.TEXTURE_WRAP_S,ae(t.wrapS)),Le.texParameteri(e,Le.TEXTURE_WRAP_T,ae(t.wrapT)),Le.texParameteri(e,Le.TEXTURE_MAG_FILTER,ae(t.magFilter)),Le.texParameteri(e,Le.TEXTURE_MIN_FILTER,ae(t.minFilter))):(Le.texParameteri(e,Le.TEXTURE_WRAP_S,Le.CLAMP_TO_EDGE),Le.texParameteri(e,Le.TEXTURE_WRAP_T,Le.CLAMP_TO_EDGE),(t.wrapS!==r.ClampToEdgeWrapping||t.wrapT!==r.ClampToEdgeWrapping)&&r.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+t.sourceFile+" )"),Le.texParameteri(e,Le.TEXTURE_MAG_FILTER,se(t.magFilter)),Le.texParameteri(e,Le.TEXTURE_MIN_FILTER,se(t.minFilter)),t.minFilter!==r.NearestFilter&&t.minFilter!==r.LinearFilter&&r.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+t.sourceFile+" )")),i=tt.get("EXT_texture_filter_anisotropic"),i&&t.type!==r.FloatType&&t.type!==r.HalfFloatType&&(t.anisotropy>1||t.__currentAnisotropy)&&(Le.texParameterf(e,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,De.getMaxAnisotropy())),t.__currentAnisotropy=t.anisotropy)}function ee(e,t){if(e.width>t||e.height>t){var n=t/Math.max(e.width,e.height),i=document.createElement("canvas");i.width=Math.floor(e.width*n),i.height=Math.floor(e.height*n);var o=i.getContext("2d");return o.drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),r.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+i.width+"x"+i.height,e),i}return e}function te(e,t){if(6===e.image.length)if(e.needsUpdate){e.image.__webglTextureCube||(e.addEventListener("dispose",Et),e.image.__webglTextureCube=Le.createTexture(),De.info.memory.textures++),Le.activeTexture(Le.TEXTURE0+t),Le.bindTexture(Le.TEXTURE_CUBE_MAP,e.image.__webglTextureCube),Le.pixelStorei(Le.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var n=e instanceof r.CompressedTexture,i=e.image[0]instanceof r.DataTexture,o=[],s=0;6>s;s++)!De.autoScaleCubemaps||n||i?o[s]=i?e.image[s].image:e.image[s]:o[s]=ee(e.image[s],lt);var a=o[0],l=r.Math.isPowerOfTwo(a.width)&&r.Math.isPowerOfTwo(a.height),c=ae(e.format),u=ae(e.type);$(Le.TEXTURE_CUBE_MAP,e,l);for(var s=0;6>s;s++)if(n)for(var d,h=o[s].mipmaps,f=0,p=h.length;p>f;f++)d=h[f],e.format!==r.RGBAFormat&&e.format!==r.RGBFormat?mt().indexOf(c)>-1?Le.compressedTexImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+s,f,c,d.width,d.height,0,d.data):r.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):Le.texImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+s,f,c,d.width,d.height,0,c,u,d.data);else i?Le.texImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,c,o[s].width,o[s].height,0,c,u,o[s].data):Le.texImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,c,c,u,o[s]);e.generateMipmaps&&l&&Le.generateMipmap(Le.TEXTURE_CUBE_MAP),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else Le.activeTexture(Le.TEXTURE0+t),Le.bindTexture(Le.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}function re(e,t){Le.activeTexture(Le.TEXTURE0+t),Le.bindTexture(Le.TEXTURE_CUBE_MAP,e.__webglTexture)}function ne(e,t,r){Le.bindFramebuffer(Le.FRAMEBUFFER,e),Le.framebufferTexture2D(Le.FRAMEBUFFER,Le.COLOR_ATTACHMENT0,r,t.__webglTexture,0)}function ie(e,t){Le.bindRenderbuffer(Le.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(Le.renderbufferStorage(Le.RENDERBUFFER,Le.DEPTH_COMPONENT16,t.width,t.height),Le.framebufferRenderbuffer(Le.FRAMEBUFFER,Le.DEPTH_ATTACHMENT,Le.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(Le.renderbufferStorage(Le.RENDERBUFFER,Le.DEPTH_STENCIL,t.width,t.height),Le.framebufferRenderbuffer(Le.FRAMEBUFFER,Le.DEPTH_STENCIL_ATTACHMENT,Le.RENDERBUFFER,e)):Le.renderbufferStorage(Le.RENDERBUFFER,Le.RGBA4,t.width,t.height)}function oe(e){e instanceof r.WebGLRenderTargetCube?(Le.bindTexture(Le.TEXTURE_CUBE_MAP,e.__webglTexture),Le.generateMipmap(Le.TEXTURE_CUBE_MAP),Le.bindTexture(Le.TEXTURE_CUBE_MAP,null)):(Le.bindTexture(Le.TEXTURE_2D,e.__webglTexture),Le.generateMipmap(Le.TEXTURE_2D),Le.bindTexture(Le.TEXTURE_2D,null))}function se(e){return e===r.NearestFilter||e===r.NearestMipMapNearestFilter||e===r.NearestMipMapLinearFilter?Le.NEAREST:Le.LINEAR}function ae(e){var t;if(e===r.RepeatWrapping)return Le.REPEAT;if(e===r.ClampToEdgeWrapping)return Le.CLAMP_TO_EDGE;if(e===r.MirroredRepeatWrapping)return Le.MIRRORED_REPEAT;if(e===r.NearestFilter)return Le.NEAREST;if(e===r.NearestMipMapNearestFilter)return Le.NEAREST_MIPMAP_NEAREST;if(e===r.NearestMipMapLinearFilter)return Le.NEAREST_MIPMAP_LINEAR;if(e===r.LinearFilter)return Le.LINEAR;if(e===r.LinearMipMapNearestFilter)return Le.LINEAR_MIPMAP_NEAREST;if(e===r.LinearMipMapLinearFilter)return Le.LINEAR_MIPMAP_LINEAR;if(e===r.UnsignedByteType)return Le.UNSIGNED_BYTE;if(e===r.UnsignedShort4444Type)return Le.UNSIGNED_SHORT_4_4_4_4;if(e===r.UnsignedShort5551Type)return Le.UNSIGNED_SHORT_5_5_5_1;if(e===r.UnsignedShort565Type)return Le.UNSIGNED_SHORT_5_6_5;if(e===r.ByteType)return Le.BYTE;if(e===r.ShortType)return Le.SHORT;if(e===r.UnsignedShortType)return Le.UNSIGNED_SHORT;if(e===r.IntType)return Le.INT;if(e===r.UnsignedIntType)return Le.UNSIGNED_INT;if(e===r.FloatType)return Le.FLOAT;if(t=tt.get("OES_texture_half_float"),null!==t&&e===r.HalfFloatType)return t.HALF_FLOAT_OES;if(e===r.AlphaFormat)return Le.ALPHA;if(e===r.RGBFormat)return Le.RGB;if(e===r.RGBAFormat)return Le.RGBA;if(e===r.LuminanceFormat)return Le.LUMINANCE;if(e===r.LuminanceAlphaFormat)return Le.LUMINANCE_ALPHA;if(e===r.AddEquation)return Le.FUNC_ADD;if(e===r.SubtractEquation)return Le.FUNC_SUBTRACT;if(e===r.ReverseSubtractEquation)return Le.FUNC_REVERSE_SUBTRACT;if(e===r.ZeroFactor)return Le.ZERO;if(e===r.OneFactor)return Le.ONE;if(e===r.SrcColorFactor)return Le.SRC_COLOR;if(e===r.OneMinusSrcColorFactor)return Le.ONE_MINUS_SRC_COLOR;if(e===r.SrcAlphaFactor)return Le.SRC_ALPHA;if(e===r.OneMinusSrcAlphaFactor)return Le.ONE_MINUS_SRC_ALPHA;if(e===r.DstAlphaFactor)return Le.DST_ALPHA;if(e===r.OneMinusDstAlphaFactor)return Le.ONE_MINUS_DST_ALPHA;if(e===r.DstColorFactor)return Le.DST_COLOR;if(e===r.OneMinusDstColorFactor)return Le.ONE_MINUS_DST_COLOR;if(e===r.SrcAlphaSaturateFactor)return Le.SRC_ALPHA_SATURATE;if(t=tt.get("WEBGL_compressed_texture_s3tc"),null!==t){if(e===r.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===r.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===r.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===r.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t=tt.get("WEBGL_compressed_texture_pvrtc"),null!==t){if(e===r.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===r.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===r.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===r.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t=tt.get("EXT_blend_minmax"),null!==t){if(e===r.MinEquation)return t.MIN_EXT;if(e===r.MaxEquation)return t.MAX_EXT}return 0}function le(e){if(ut&&e&&e.skeleton&&e.skeleton.useVertexTexture)return 1024;var t=Le.getParameter(Le.MAX_VERTEX_UNIFORM_VECTORS),n=Math.floor((t-20)/4),i=n;return void 0!==e&&e instanceof r.SkinnedMesh&&(i=Math.min(e.skeleton.bones.length,i),i<e.skeleton.bones.length&&r.warn("WebGLRenderer: too many bones - "+e.skeleton.bones.length+", this GPU supports just "+i+" (try OpenGL instead of ANGLE)")),i}function ce(e){for(var t=0,n=0,i=0,o=0,s=0,a=e.length;a>s;s++){var l=e[s];l.onlyShadow||l.visible===!1||(l instanceof r.DirectionalLight&&t++,l instanceof r.PointLight&&n++,l instanceof r.SpotLight&&i++,l instanceof r.HemisphereLight&&o++)}return{directional:t,point:n,spot:i,hemi:o}}function ue(e){for(var t=0,n=0,i=e.length;i>n;n++){var o=e[n];o.castShadow&&(o instanceof r.SpotLight&&t++,o instanceof r.DirectionalLight&&!o.shadowCascade&&t++)}return t}e=e||{};var de=void 0!==e.canvas?e.canvas:document.createElement("canvas"),he=void 0!==e.context?e.context:null,fe=1,pe=void 0!==e.precision?e.precision:"highp",me=void 0!==e.alpha?e.alpha:!1,ge=void 0!==e.depth?e.depth:!0,ve=void 0!==e.stencil?e.stencil:!0,ye=void 0!==e.antialias?e.antialias:!1,_e=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,be=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!1,xe=void 0!==e.logarithmicDepthBuffer?e.logarithmicDepthBuffer:!1,we=new r.Color(0),Ee=0,Se=[],Ae={},Me=[],Te=[],Ce=[],je=[],Pe=[];this.domElement=de,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.shadowMapEnabled=!1,this.shadowMapType=r.PCFShadowMap,this.shadowMapCullFace=r.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var Le,De=this,Ie=[],Re=null,Oe=null,ke=-1,Ne="",Fe=null,Ve=0,Ue=0,Be=0,ze=de.width,Ge=de.height,He=0,We=0,qe=new r.Frustum,Xe=new r.Matrix4,Ye=new r.Vector3,Ke=new r.Vector3,Qe=!0,Ze={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};try{var Je={alpha:me,depth:ge,stencil:ve,antialias:ye,premultipliedAlpha:_e,preserveDrawingBuffer:be};if(Le=he||de.getContext("webgl",Je)||de.getContext("experimental-webgl",Je),null===Le)throw null!==de.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";de.addEventListener("webglcontextlost",function(e){e.preventDefault(),it(),nt(),Ae={}},!1)}catch($e){r.error("THREE.WebGLRenderer: "+$e)}var et=new r.WebGLState(Le,ae);void 0===Le.getShaderPrecisionFormat&&(Le.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});var tt=new r.WebGLExtensions(Le);tt.get("OES_texture_float"),tt.get("OES_texture_float_linear"),tt.get("OES_texture_half_float"),tt.get("OES_texture_half_float_linear"),tt.get("OES_standard_derivatives"),xe&&tt.get("EXT_frag_depth");var rt=function(e,t,r,n){_e===!0&&(e*=n,t*=n,r*=n),Le.clearColor(e,t,r,n)},nt=function(){Le.clearColor(0,0,0,1),Le.clearDepth(1),Le.clearStencil(0),Le.enable(Le.DEPTH_TEST),Le.depthFunc(Le.LEQUAL),Le.frontFace(Le.CCW),Le.cullFace(Le.BACK),Le.enable(Le.CULL_FACE),Le.enable(Le.BLEND),Le.blendEquation(Le.FUNC_ADD),Le.blendFunc(Le.SRC_ALPHA,Le.ONE_MINUS_SRC_ALPHA),Le.viewport(Ue,Be,ze,Ge),rt(we.r,we.g,we.b,Ee)},it=function(){Re=null,Fe=null,Ne="",ke=-1,Qe=!0,et.reset()};nt(),this.context=Le,this.state=et;var ot=Le.getParameter(Le.MAX_TEXTURE_IMAGE_UNITS),st=Le.getParameter(Le.MAX_VERTEX_TEXTURE_IMAGE_UNITS),at=Le.getParameter(Le.MAX_TEXTURE_SIZE),lt=Le.getParameter(Le.MAX_CUBE_MAP_TEXTURE_SIZE),ct=st>0,ut=ct&&tt.get("OES_texture_float"),dt=Le.getShaderPrecisionFormat(Le.VERTEX_SHADER,Le.HIGH_FLOAT),ht=Le.getShaderPrecisionFormat(Le.VERTEX_SHADER,Le.MEDIUM_FLOAT),ft=Le.getShaderPrecisionFormat(Le.FRAGMENT_SHADER,Le.HIGH_FLOAT),pt=Le.getShaderPrecisionFormat(Le.FRAGMENT_SHADER,Le.MEDIUM_FLOAT),mt=function(){var e;return function(){if(void 0!==e)return e;if(e=[],tt.get("WEBGL_compressed_texture_pvrtc")||tt.get("WEBGL_compressed_texture_s3tc"))for(var t=Le.getParameter(Le.COMPRESSED_TEXTURE_FORMATS),r=0;r<t.length;r++)e.push(t[r]);return e}}(),gt=dt.precision>0&&ft.precision>0,vt=ht.precision>0&&pt.precision>0;"highp"!==pe||gt||(vt?(pe="mediump",r.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(pe="lowp",r.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp."))),"mediump"!==pe||vt||(pe="lowp",r.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));var yt=new r.ShadowMapPlugin(this,Se,Ae,Me),_t=new r.SpritePlugin(this,je),bt=new r.LensFlarePlugin(this,Pe);this.getContext=function(){return Le},this.forceContextLoss=function(){tt.get("WEBGL_lose_context").loseContext()},this.supportsVertexTextures=function(){return ct},this.supportsFloatTextures=function(){return tt.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return tt.get("OES_texture_half_float")},this.supportsStandardDerivatives=function(){return tt.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return tt.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return tt.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return tt.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){var e;return function(){if(void 0!==e)return e;var t=tt.get("EXT_texture_filter_anisotropic");return e=null!==t?Le.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return pe},this.getPixelRatio=function(){return fe},this.setPixelRatio=function(e){fe=e},this.setSize=function(e,t,r){de.width=e*fe,de.height=t*fe,r!==!1&&(de.style.width=e+"px",de.style.height=t+"px"),this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,n){Ue=e*fe,Be=t*fe,ze=r*fe,Ge=n*fe,Le.viewport(Ue,Be,ze,Ge)},this.setScissor=function(e,t,r,n){Le.scissor(e*fe,t*fe,r*fe,n*fe)},this.enableScissorTest=function(e){e?Le.enable(Le.SCISSOR_TEST):Le.disable(Le.SCISSOR_TEST)},this.getClearColor=function(){return we},this.setClearColor=function(e,t){we.set(e),Ee=void 0!==t?t:1,rt(we.r,we.g,we.b,Ee)},this.getClearAlpha=function(){return Ee},this.setClearAlpha=function(e){Ee=e,rt(we.r,we.g,we.b,Ee)},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=Le.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=Le.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=Le.STENCIL_BUFFER_BIT),Le.clear(n)},this.clearColor=function(){Le.clear(Le.COLOR_BUFFER_BIT)},this.clearDepth=function(){Le.clear(Le.DEPTH_BUFFER_BIT)},this.clearStencil=function(){Le.clear(Le.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,r,n){this.setRenderTarget(e),this.clear(t,r,n)},this.resetGLState=it;var xt=function Rt(e){var t=e.target;t.traverse(function(e){e.removeEventListener("remove",Rt),D(e)})},wt=function Ot(e){var t=e.target;t.removeEventListener("dispose",Ot),Tt(t)},Et=function kt(e){var t=e.target;t.removeEventListener("dispose",kt),Ct(t),De.info.memory.textures--},St=function Nt(e){var t=e.target;t.removeEventListener("dispose",Nt),jt(t),De.info.memory.textures--},At=function Ft(e){var t=e.target;t.removeEventListener("dispose",Ft),Pt(t)},Mt=function(e){for(var t=["__webglVertexBuffer","__webglNormalBuffer","__webglTangentBuffer","__webglColorBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","__webglLineDistanceBuffer"],r=0,n=t.length;n>r;r++){var i=t[r];void 0!==e[i]&&(Le.deleteBuffer(e[i]),delete e[i])}if(void 0!==e.__webglCustomAttributesList){for(var i in e.__webglCustomAttributesList)Le.deleteBuffer(e.__webglCustomAttributesList[i].buffer);delete e.__webglCustomAttributesList}De.info.memory.geometries--},Tt=function(e){if(delete e.__webglInit,e instanceof r.BufferGeometry){for(var t in e.attributes){var n=e.attributes[t];void 0!==n.buffer&&(Le.deleteBuffer(n.buffer),delete n.buffer)}De.info.memory.geometries--}else{var i=Lt[e.id];if(void 0!==i){for(var o=0,s=i.length;s>o;o++){var a=i[o];if(void 0!==a.numMorphTargets){for(var l=0,c=a.numMorphTargets;c>l;l++)Le.deleteBuffer(a.__webglMorphTargetsBuffers[l]);delete a.__webglMorphTargetsBuffers}if(void 0!==a.numMorphNormals){for(var l=0,c=a.numMorphNormals;c>l;l++)Le.deleteBuffer(a.__webglMorphNormalsBuffers[l]);delete a.__webglMorphNormalsBuffers}Mt(a)}delete Lt[e.id]}else Mt(e)}Ne=""},Ct=function(e){if(e.image&&e.image.__webglTextureCube)Le.deleteTexture(e.image.__webglTextureCube),delete e.image.__webglTextureCube;else{if(void 0===e.__webglInit)return;Le.deleteTexture(e.__webglTexture),delete e.__webglTexture,delete e.__webglInit}},jt=function(e){if(e&&void 0!==e.__webglTexture){if(Le.deleteTexture(e.__webglTexture),delete e.__webglTexture,e instanceof r.WebGLRenderTargetCube)for(var t=0;6>t;t++)Le.deleteFramebuffer(e.__webglFramebuffer[t]),Le.deleteRenderbuffer(e.__webglRenderbuffer[t]);else Le.deleteFramebuffer(e.__webglFramebuffer),Le.deleteRenderbuffer(e.__webglRenderbuffer);delete e.__webglFramebuffer,delete e.__webglRenderbuffer}},Pt=function(e){var t=e.program.program;if(void 0!==t){e.program=void 0;var r,n,i,o=!1;for(r=0,n=Ie.length;n>r;r++)if(i=Ie[r],i.program===t){i.usedTimes--,0===i.usedTimes&&(o=!0);break}if(o===!0){var s=[];for(r=0,n=Ie.length;n>r;r++)i=Ie[r],i.program!==t&&s.push(i);Ie=s,Le.deleteProgram(t),De.info.memory.programs--}}};this.renderBufferImmediate=function(e,t,n){if(et.initAttributes(),e.hasPositions&&!e.__webglVertexBuffer&&(e.__webglVertexBuffer=Le.createBuffer()),e.hasNormals&&!e.__webglNormalBuffer&&(e.__webglNormalBuffer=Le.createBuffer()),e.hasUvs&&!e.__webglUvBuffer&&(e.__webglUvBuffer=Le.createBuffer()),e.hasColors&&!e.__webglColorBuffer&&(e.__webglColorBuffer=Le.createBuffer()),e.hasPositions&&(Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglVertexBuffer),Le.bufferData(Le.ARRAY_BUFFER,e.positionArray,Le.DYNAMIC_DRAW),et.enableAttribute(t.attributes.position),Le.vertexAttribPointer(t.attributes.position,3,Le.FLOAT,!1,0,0)),e.hasNormals){if(Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglNormalBuffer),n instanceof r.MeshPhongMaterial==!1&&n.shading===r.FlatShading){var i,o,s,a,l,c,u,d,h,f,p,m,g,v,y=3*e.count;for(v=0;y>v;v+=9)g=e.normalArray,a=g[v],u=g[v+1],f=g[v+2],l=g[v+3],d=g[v+4],p=g[v+5],c=g[v+6],h=g[v+7],m=g[v+8],i=(a+l+c)/3,o=(u+d+h)/3,s=(f+p+m)/3,g[v]=i,g[v+1]=o,g[v+2]=s,g[v+3]=i,g[v+4]=o,g[v+5]=s,g[v+6]=i,g[v+7]=o,g[v+8]=s}Le.bufferData(Le.ARRAY_BUFFER,e.normalArray,Le.DYNAMIC_DRAW),et.enableAttribute(t.attributes.normal),Le.vertexAttribPointer(t.attributes.normal,3,Le.FLOAT,!1,0,0)}e.hasUvs&&n.map&&(Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglUvBuffer),Le.bufferData(Le.ARRAY_BUFFER,e.uvArray,Le.DYNAMIC_DRAW),et.enableAttribute(t.attributes.uv),Le.vertexAttribPointer(t.attributes.uv,2,Le.FLOAT,!1,0,0)),e.hasColors&&n.vertexColors!==r.NoColors&&(Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglColorBuffer),Le.bufferData(Le.ARRAY_BUFFER,e.colorArray,Le.DYNAMIC_DRAW),et.enableAttribute(t.attributes.color),Le.vertexAttribPointer(t.attributes.color,3,Le.FLOAT,!1,0,0)),et.disableUnusedAttributes(),Le.drawArrays(Le.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,i,o,s){if(i.visible!==!1){j(s);var a=k(e,t,n,i,s),l=!1,c=i.wireframe?1:0,u="direct_"+o.id+"_"+a.id+"_"+c;if(u!==Ne&&(Ne=u,l=!0),l&&et.initAttributes(),s instanceof r.Mesh){var d=i.wireframe===!0?Le.LINES:Le.TRIANGLES,h=o.attributes.index;if(h){var f,m;h.array instanceof Uint32Array&&tt.get("OES_element_index_uint")?(f=Le.UNSIGNED_INT,m=4):(f=Le.UNSIGNED_SHORT,m=2);var g=o.offsets;if(0===g.length)l&&(p(i,a,o,0),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(d,h.array.length,f,0),De.info.render.calls++,De.info.render.vertices+=h.array.length,De.info.render.faces+=h.array.length/3;else{l=!0;for(var v=0,y=g.length;y>v;v++){var _=g[v].index;l&&(p(i,a,o,_),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(d,g[v].count,f,g[v].start*m),De.info.render.calls++,De.info.render.vertices+=g[v].count,De.info.render.faces+=g[v].count/3}}}else{l&&p(i,a,o,0);var b=o.attributes.position;Le.drawArrays(d,0,b.array.length/b.itemSize),De.info.render.calls++,De.info.render.vertices+=b.array.length/b.itemSize,De.info.render.faces+=b.array.length/(3*b.itemSize)}}else if(s instanceof r.PointCloud){var d=Le.POINTS,h=o.attributes.index;if(h){var f,m;h.array instanceof Uint32Array&&tt.get("OES_element_index_uint")?(f=Le.UNSIGNED_INT,m=4):(f=Le.UNSIGNED_SHORT,m=2);var g=o.offsets;if(0===g.length)l&&(p(i,a,o,0),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(d,h.array.length,f,0),De.info.render.calls++,De.info.render.points+=h.array.length;else{g.length>1&&(l=!0);for(var v=0,y=g.length;y>v;v++){var _=g[v].index;l&&(p(i,a,o,_),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(d,g[v].count,f,g[v].start*m),De.info.render.calls++,De.info.render.points+=g[v].count}}}else{l&&p(i,a,o,0);var b=o.attributes.position,g=o.offsets;if(0===g.length)Le.drawArrays(d,0,b.array.length/3),De.info.render.calls++,De.info.render.points+=b.array.length/3;else for(var v=0,y=g.length;y>v;v++)Le.drawArrays(d,g[v].index,g[v].count),De.info.render.calls++,De.info.render.points+=g[v].count}}else if(s instanceof r.Line){var d=s.mode===r.LineStrip?Le.LINE_STRIP:Le.LINES;et.setLineWidth(i.linewidth*fe);var h=o.attributes.index;if(h){var f,m;h.array instanceof Uint32Array?(f=Le.UNSIGNED_INT,m=4):(f=Le.UNSIGNED_SHORT,m=2);var g=o.offsets;if(0===g.length)l&&(p(i,a,o,0),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(d,h.array.length,f,0),De.info.render.calls++,De.info.render.vertices+=h.array.length;else{g.length>1&&(l=!0);for(var v=0,y=g.length;y>v;v++){var _=g[v].index;l&&(p(i,a,o,_),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(d,g[v].count,f,g[v].start*m),De.info.render.calls++,De.info.render.vertices+=g[v].count}}}else{l&&p(i,a,o,0);var b=o.attributes.position,g=o.offsets;if(0===g.length)Le.drawArrays(d,0,b.array.length/3),De.info.render.calls++,De.info.render.vertices+=b.array.length/3;else for(var v=0,y=g.length;y>v;v++)Le.drawArrays(d,g[v].index,g[v].count),De.info.render.calls++,De.info.render.vertices+=g[v].count}}}},this.renderBuffer=function(e,t,n,i,o,s){if(i.visible!==!1){j(s);var a=k(e,t,n,i,s),l=a.attributes,c=!1,u=i.wireframe?1:0,d=o.id+"_"+a.id+"_"+u;if(d!==Ne&&(Ne=d,c=!0),c&&et.initAttributes(),!i.morphTargets&&l.position>=0?c&&(Le.bindBuffer(Le.ARRAY_BUFFER,o.__webglVertexBuffer),et.enableAttribute(l.position),Le.vertexAttribPointer(l.position,3,Le.FLOAT,!1,0,0)):s.morphTargetBase&&m(i,o,s),c){if(o.__webglCustomAttributesList)for(var h=0,f=o.__webglCustomAttributesList.length;f>h;h++){
var p=o.__webglCustomAttributesList[h];l[p.buffer.belongsToAttribute]>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,p.buffer),et.enableAttribute(l[p.buffer.belongsToAttribute]),Le.vertexAttribPointer(l[p.buffer.belongsToAttribute],p.size,Le.FLOAT,!1,0,0))}l.color>=0&&(s.geometry.colors.length>0||s.geometry.faces.length>0?(Le.bindBuffer(Le.ARRAY_BUFFER,o.__webglColorBuffer),et.enableAttribute(l.color),Le.vertexAttribPointer(l.color,3,Le.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&Le.vertexAttrib3fv(l.color,i.defaultAttributeValues.color)),l.normal>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,o.__webglNormalBuffer),et.enableAttribute(l.normal),Le.vertexAttribPointer(l.normal,3,Le.FLOAT,!1,0,0)),l.tangent>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,o.__webglTangentBuffer),et.enableAttribute(l.tangent),Le.vertexAttribPointer(l.tangent,4,Le.FLOAT,!1,0,0)),l.uv>=0&&(s.geometry.faceVertexUvs[0]?(Le.bindBuffer(Le.ARRAY_BUFFER,o.__webglUVBuffer),et.enableAttribute(l.uv),Le.vertexAttribPointer(l.uv,2,Le.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&Le.vertexAttrib2fv(l.uv,i.defaultAttributeValues.uv)),l.uv2>=0&&(s.geometry.faceVertexUvs[1]?(Le.bindBuffer(Le.ARRAY_BUFFER,o.__webglUV2Buffer),et.enableAttribute(l.uv2),Le.vertexAttribPointer(l.uv2,2,Le.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&Le.vertexAttrib2fv(l.uv2,i.defaultAttributeValues.uv2)),i.skinning&&l.skinIndex>=0&&l.skinWeight>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,o.__webglSkinIndicesBuffer),et.enableAttribute(l.skinIndex),Le.vertexAttribPointer(l.skinIndex,4,Le.FLOAT,!1,0,0),Le.bindBuffer(Le.ARRAY_BUFFER,o.__webglSkinWeightsBuffer),et.enableAttribute(l.skinWeight),Le.vertexAttribPointer(l.skinWeight,4,Le.FLOAT,!1,0,0)),l.lineDistance>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,o.__webglLineDistanceBuffer),et.enableAttribute(l.lineDistance),Le.vertexAttribPointer(l.lineDistance,1,Le.FLOAT,!1,0,0))}if(et.disableUnusedAttributes(),s instanceof r.Mesh){var g=o.__typeArray===Uint32Array?Le.UNSIGNED_INT:Le.UNSIGNED_SHORT;i.wireframe?(et.setLineWidth(i.wireframeLinewidth*fe),c&&Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,o.__webglLineBuffer),Le.drawElements(Le.LINES,o.__webglLineCount,g,0)):(c&&Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,o.__webglFaceBuffer),Le.drawElements(Le.TRIANGLES,o.__webglFaceCount,g,0)),De.info.render.calls++,De.info.render.vertices+=o.__webglFaceCount,De.info.render.faces+=o.__webglFaceCount/3}else if(s instanceof r.Line){var v=s.mode===r.LineStrip?Le.LINE_STRIP:Le.LINES;et.setLineWidth(i.linewidth*fe),Le.drawArrays(v,0,o.__webglLineCount),De.info.render.calls++}else s instanceof r.PointCloud&&(Le.drawArrays(Le.POINTS,0,o.__webglParticleCount),De.info.render.calls++,De.info.render.points+=o.__webglParticleCount)}},this.render=function(e,t,n,i){if(t instanceof r.Camera==!1)return void r.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var o=e.fog;Ne="",ke=-1,Fe=null,Qe=!0,e.autoUpdate===!0&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),e.traverse(function(e){e instanceof r.SkinnedMesh&&e.skeleton.update()}),t.matrixWorldInverse.getInverse(t.matrixWorld),Xe.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),qe.setFromMatrix(Xe),Se.length=0,Te.length=0,Ce.length=0,je.length=0,Pe.length=0,_(e),De.sortObjects===!0&&(Te.sort(g),Ce.sort(v)),yt.render(e,t),De.info.render.calls=0,De.info.render.vertices=0,De.info.render.faces=0,De.info.render.points=0,this.setRenderTarget(n),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);for(var s=0,a=Me.length;a>s;s++){var l=Me[s],c=l.object;c.visible&&(Q(c,t),w(l))}if(e.overrideMaterial){var u=e.overrideMaterial;O(u),b(Te,t,Se,o,u),b(Ce,t,Se,o,u),x(Me,"",t,Se,o,u)}else et.setBlending(r.NoBlending),b(Te,t,Se,o,null),x(Me,"opaque",t,Se,o,null),b(Ce,t,Se,o,null),x(Me,"transparent",t,Se,o,null);_t.render(e,t),bt.render(e,t,He,We),n&&n.generateMipmaps&&n.minFilter!==r.NearestFilter&&n.minFilter!==r.LinearFilter&&oe(n),et.setDepthTest(!0),et.setDepthWrite(!0),et.setColorWrite(!0)},this.renderImmediateObject=function(e,t,r,n,i){var o=k(e,t,r,n,i);Ne="",De.setMaterialFaces(n),i.immediateRenderCallback?i.immediateRenderCallback(o,Le,qe):i.render(function(e){De.renderBufferImmediate(e,o,n)})};var Lt={},Dt=0,It={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointCloudMaterial:"particle_basic"};this.setFaceCulling=function(e,t){e===r.CullFaceNone?Le.disable(Le.CULL_FACE):(t===r.FrontFaceDirectionCW?Le.frontFace(Le.CW):Le.frontFace(Le.CCW),e===r.CullFaceBack?Le.cullFace(Le.BACK):e===r.CullFaceFront?Le.cullFace(Le.FRONT):Le.cullFace(Le.FRONT_AND_BACK),Le.enable(Le.CULL_FACE))},this.setMaterialFaces=function(e){et.setDoubleSided(e.side===r.DoubleSide),et.setFlipSided(e.side===r.BackSide)},this.uploadTexture=function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",Et),e.__webglTexture=Le.createTexture(),De.info.memory.textures++),Le.bindTexture(Le.TEXTURE_2D,e.__webglTexture),Le.pixelStorei(Le.UNPACK_FLIP_Y_WEBGL,e.flipY),Le.pixelStorei(Le.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),Le.pixelStorei(Le.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=ee(e.image,at);var t=e.image,n=r.Math.isPowerOfTwo(t.width)&&r.Math.isPowerOfTwo(t.height),i=ae(e.format),o=ae(e.type);$(Le.TEXTURE_2D,e,n);var s,a=e.mipmaps;if(e instanceof r.DataTexture)if(a.length>0&&n){for(var l=0,c=a.length;c>l;l++)s=a[l],Le.texImage2D(Le.TEXTURE_2D,l,i,s.width,s.height,0,i,o,s.data);e.generateMipmaps=!1}else Le.texImage2D(Le.TEXTURE_2D,0,i,t.width,t.height,0,i,o,t.data);else if(e instanceof r.CompressedTexture)for(var l=0,c=a.length;c>l;l++)s=a[l],e.format!==r.RGBAFormat&&e.format!==r.RGBFormat?mt().indexOf(i)>-1?Le.compressedTexImage2D(Le.TEXTURE_2D,l,i,s.width,s.height,0,s.data):r.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Le.texImage2D(Le.TEXTURE_2D,l,i,s.width,s.height,0,i,o,s.data);else if(a.length>0&&n){for(var l=0,c=a.length;c>l;l++)s=a[l],Le.texImage2D(Le.TEXTURE_2D,l,i,i,o,s);e.generateMipmaps=!1}else Le.texImage2D(Le.TEXTURE_2D,0,i,i,o,e.image);e.generateMipmaps&&n&&Le.generateMipmap(Le.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()},this.setTexture=function(e,t){Le.activeTexture(Le.TEXTURE0+t),e.needsUpdate?De.uploadTexture(e):Le.bindTexture(Le.TEXTURE_2D,e.__webglTexture)},this.setRenderTarget=function(e){var t=e instanceof r.WebGLRenderTargetCube;if(e&&void 0===e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",St),e.__webglTexture=Le.createTexture(),De.info.memory.textures++;var n=r.Math.isPowerOfTwo(e.width)&&r.Math.isPowerOfTwo(e.height),i=ae(e.format),o=ae(e.type);if(t){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],Le.bindTexture(Le.TEXTURE_CUBE_MAP,e.__webglTexture),$(Le.TEXTURE_CUBE_MAP,e,n);for(var s=0;6>s;s++)e.__webglFramebuffer[s]=Le.createFramebuffer(),e.__webglRenderbuffer[s]=Le.createRenderbuffer(),Le.texImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,i,e.width,e.height,0,i,o,null),ne(e.__webglFramebuffer[s],e,Le.TEXTURE_CUBE_MAP_POSITIVE_X+s),ie(e.__webglRenderbuffer[s],e);n&&Le.generateMipmap(Le.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=Le.createFramebuffer(),e.shareDepthFrom?e.__webglRenderbuffer=e.shareDepthFrom.__webglRenderbuffer:e.__webglRenderbuffer=Le.createRenderbuffer(),Le.bindTexture(Le.TEXTURE_2D,e.__webglTexture),$(Le.TEXTURE_2D,e,n),Le.texImage2D(Le.TEXTURE_2D,0,i,e.width,e.height,0,i,o,null),ne(e.__webglFramebuffer,e,Le.TEXTURE_2D),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?Le.framebufferRenderbuffer(Le.FRAMEBUFFER,Le.DEPTH_ATTACHMENT,Le.RENDERBUFFER,e.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&Le.framebufferRenderbuffer(Le.FRAMEBUFFER,Le.DEPTH_STENCIL_ATTACHMENT,Le.RENDERBUFFER,e.__webglRenderbuffer):ie(e.__webglRenderbuffer,e),n&&Le.generateMipmap(Le.TEXTURE_2D);t?Le.bindTexture(Le.TEXTURE_CUBE_MAP,null):Le.bindTexture(Le.TEXTURE_2D,null),Le.bindRenderbuffer(Le.RENDERBUFFER,null),Le.bindFramebuffer(Le.FRAMEBUFFER,null)}var a,l,c,u,d;e?(a=t?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,l=e.width,c=e.height,u=0,d=0):(a=null,l=ze,c=Ge,u=Ue,d=Be),a!==Oe&&(Le.bindFramebuffer(Le.FRAMEBUFFER,a),Le.viewport(u,d,l,c),Oe=a),He=l,We=c},this.readRenderTargetPixels=function(e,t,n,i,o,s){if(e instanceof r.WebGLRenderTarget&&e.__webglFramebuffer){if(e.format!==r.RGBAFormat)return;var a=!1;e.__webglFramebuffer!==Oe&&(Le.bindFramebuffer(Le.FRAMEBUFFER,e.__webglFramebuffer),a=!0),Le.checkFramebufferStatus(Le.FRAMEBUFFER)===Le.FRAMEBUFFER_COMPLETE&&Le.readPixels(t,n,i,o,Le.RGBA,Le.UNSIGNED_BYTE,s),a&&Le.bindFramebuffer(Le.FRAMEBUFFER,Oe)}},this.initMaterial=function(){r.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){r.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){r.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){r.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},r.WebGLRenderTarget=function(e,t,n){this.width=e,this.height=t,n=n||{},this.wrapS=void 0!==n.wrapS?n.wrapS:r.ClampToEdgeWrapping,this.wrapT=void 0!==n.wrapT?n.wrapT:r.ClampToEdgeWrapping,this.magFilter=void 0!==n.magFilter?n.magFilter:r.LinearFilter,this.minFilter=void 0!==n.minFilter?n.minFilter:r.LinearMipMapLinearFilter,this.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,this.offset=new r.Vector2(0,0),this.repeat=new r.Vector2(1,1),this.format=void 0!==n.format?n.format:r.RGBAFormat,this.type=void 0!==n.type?n.type:r.UnsignedByteType,this.depthBuffer=void 0!==n.depthBuffer?n.depthBuffer:!0,this.stencilBuffer=void 0!==n.stencilBuffer?n.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=void 0!==n.shareDepthFrom?n.shareDepthFrom:null},r.WebGLRenderTarget.prototype={constructor:r.WebGLRenderTarget,setSize:function(e,t){this.width=e,this.height=t},clone:function(){var e=new r.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e.generateMipmaps=this.generateMipmaps,e.shareDepthFrom=this.shareDepthFrom,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.WebGLRenderTarget.prototype),r.WebGLRenderTargetCube=function(e,t,n){r.WebGLRenderTarget.call(this,e,t,n),this.activeCubeFace=0},r.WebGLRenderTargetCube.prototype=Object.create(r.WebGLRenderTarget.prototype),r.WebGLRenderTargetCube.prototype.constructor=r.WebGLRenderTargetCube,r.WebGLExtensions=function(e){var t={};this.get=function(n){if(void 0!==t[n])return t[n];var i;switch(n){case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return null===i&&r.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=i,i}},r.WebGLProgram=function(){var e=0,t=function(e){var t,r,n=[];for(var i in e)t=e[i],t!==!1&&(r="#define "+i+" "+t,n.push(r));return n.join("\n")},n=function(e,t,r){for(var n={},i=0,o=r.length;o>i;i++){var s=r[i];n[s]=e.getUniformLocation(t,s)}return n},i=function(e,t,r){for(var n={},i=0,o=r.length;o>i;i++){var s=r[i];n[s]=e.getAttribLocation(t,s)}return n};return function(o,s,a,l){var c=o,u=c.context,d=a.defines,h=a.__webglShader.uniforms,f=a.attributes,p=a.__webglShader.vertexShader,m=a.__webglShader.fragmentShader,g=a.index0AttributeName;void 0===g&&l.morphTargets===!0&&(g="position");var v="SHADOWMAP_TYPE_BASIC";l.shadowMapType===r.PCFShadowMap?v="SHADOWMAP_TYPE_PCF":l.shadowMapType===r.PCFSoftShadowMap&&(v="SHADOWMAP_TYPE_PCF_SOFT");var y="ENVMAP_TYPE_CUBE",_="ENVMAP_MODE_REFLECTION",b="ENVMAP_BLENDING_MULTIPLY";if(l.envMap){switch(a.envMap.mapping){case r.CubeReflectionMapping:case r.CubeRefractionMapping:y="ENVMAP_TYPE_CUBE";break;case r.EquirectangularReflectionMapping:case r.EquirectangularRefractionMapping:y="ENVMAP_TYPE_EQUIREC";break;case r.SphericalReflectionMapping:y="ENVMAP_TYPE_SPHERE"}switch(a.envMap.mapping){case r.CubeRefractionMapping:case r.EquirectangularRefractionMapping:_="ENVMAP_MODE_REFRACTION"}switch(a.combine){case r.MultiplyOperation:b="ENVMAP_BLENDING_MULTIPLY";break;case r.MixOperation:b="ENVMAP_BLENDING_MIX";break;case r.AddOperation:b="ENVMAP_BLENDING_ADD"}}var x,w,E=o.gammaFactor>0?o.gammaFactor:1,S=t(d),A=u.createProgram();a instanceof r.RawShaderMaterial?(x="",w=""):(x=["precision "+l.precision+" float;","precision "+l.precision+" int;",S,l.supportsVertexTextures?"#define VERTEX_TEXTURES":"",c.gammaInput?"#define GAMMA_INPUT":"",c.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+E,"#define MAX_DIR_LIGHTS "+l.maxDirLights,"#define MAX_POINT_LIGHTS "+l.maxPointLights,"#define MAX_SPOT_LIGHTS "+l.maxSpotLights,"#define MAX_HEMI_LIGHTS "+l.maxHemiLights,"#define MAX_SHADOWS "+l.maxShadows,"#define MAX_BONES "+l.maxBones,l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+_:"",l.lightMap?"#define USE_LIGHTMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.flatShading?"#define FLAT_SHADED":"",l.skinning?"#define USE_SKINNING":"",l.useVertexTexture?"#define BONE_TEXTURE":"",l.morphTargets?"#define USE_MORPHTARGETS":"",l.morphNormals?"#define USE_MORPHNORMALS":"",l.wrapAround?"#define WRAP_AROUND":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+v:"",l.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",l.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",l.sizeAttenuation?"#define USE_SIZEATTENUATION":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",""].join("\n"),w=["precision "+l.precision+" float;","precision "+l.precision+" int;",l.bumpMap||l.normalMap||l.flatShading?"#extension GL_OES_standard_derivatives : enable":"",S,"#define MAX_DIR_LIGHTS "+l.maxDirLights,"#define MAX_POINT_LIGHTS "+l.maxPointLights,"#define MAX_SPOT_LIGHTS "+l.maxSpotLights,"#define MAX_HEMI_LIGHTS "+l.maxHemiLights,"#define MAX_SHADOWS "+l.maxShadows,l.alphaTest?"#define ALPHATEST "+l.alphaTest:"",c.gammaInput?"#define GAMMA_INPUT":"",c.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+E,l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+y:"",l.envMap?"#define "+_:"",l.envMap?"#define "+b:"",l.lightMap?"#define USE_LIGHTMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.flatShading?"#define FLAT_SHADED":"",l.metal?"#define METAL":"",l.wrapAround?"#define WRAP_AROUND":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+v:"",l.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",l.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"));var M=new r.WebGLShader(u,u.VERTEX_SHADER,x+p),T=new r.WebGLShader(u,u.FRAGMENT_SHADER,w+m);u.attachShader(A,M),u.attachShader(A,T),void 0!==g&&u.bindAttribLocation(A,0,g),u.linkProgram(A);var C=u.getProgramInfoLog(A);u.getProgramParameter(A,u.LINK_STATUS)===!1&&r.error("THREE.WebGLProgram: shader error: "+u.getError(),"gl.VALIDATE_STATUS",u.getProgramParameter(A,u.VALIDATE_STATUS),"gl.getPRogramInfoLog",C),""!==C&&r.warn("THREE.WebGLProgram: gl.getProgramInfoLog()"+C),u.deleteShader(M),u.deleteShader(T);var j=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences","bindMatrix","bindMatrixInverse"];l.useVertexTexture?(j.push("boneTexture"),j.push("boneTextureWidth"),j.push("boneTextureHeight")):j.push("boneGlobalMatrices"),l.logarithmicDepthBuffer&&j.push("logDepthBufFC");for(var P in h)j.push(P);this.uniforms=n(u,A,j),j=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(var L=0;L<l.maxMorphTargets;L++)j.push("morphTarget"+L);for(var L=0;L<l.maxMorphNormals;L++)j.push("morphNormal"+L);for(var D in f)j.push(D);return this.attributes=i(u,A,j),this.attributesKeys=Object.keys(this.attributes),this.id=e++,this.code=s,this.usedTimes=1,this.program=A,this.vertexShader=M,this.fragmentShader=T,this}}(),r.WebGLShader=function(){var e=function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")};return function(t,n,i){var o=t.createShader(n);return t.shaderSource(o,i),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)===!1&&r.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(o)&&r.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t.getShaderInfoLog(o),e(i)),o}}(),r.WebGLState=function(e,t){var n=new Uint8Array(16),i=new Uint8Array(16),o=null,s=null,a=null,l=null,c=null,u=null,d=null,h=null,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=null;this.initAttributes=function(){for(var e=0,t=n.length;t>e;e++)n[e]=0},this.enableAttribute=function(t){n[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1)},this.disableUnusedAttributes=function(){for(var t=0,r=i.length;r>t;t++)i[t]!==n[t]&&(e.disableVertexAttribArray(t),i[t]=0)},this.setBlending=function(n,i,h,f,p,m,g){n!==o&&(n===r.NoBlending?e.disable(e.BLEND):n===r.AdditiveBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)):n===r.SubtractiveBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)):n===r.MultiplyBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR)):n===r.CustomBlending?e.enable(e.BLEND):(e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)),o=n),n===r.CustomBlending?(p=p||i,m=m||h,g=g||f,(i!==s||p!==c)&&(e.blendEquationSeparate(t(i),t(p)),s=i,c=p),(h!==a||f!==l||m!==u||g!==d)&&(e.blendFuncSeparate(t(h),t(f),t(m),t(g)),a=h,l=f,u=m,d=g)):(s=null,a=null,l=null,c=null,u=null,d=null)},this.setDepthTest=function(t){h!==t&&(t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),h=t)},this.setDepthWrite=function(t){f!==t&&(e.depthMask(t),f=t)},this.setColorWrite=function(t){p!==t&&(e.colorMask(t,t,t,t),p=t)},this.setDoubleSided=function(t){m!==t&&(t?e.disable(e.CULL_FACE):e.enable(e.CULL_FACE),m=t)},this.setFlipSided=function(t){g!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),g=t)},this.setLineWidth=function(t){t!==v&&(e.lineWidth(t),v=t)},this.setPolygonOffset=function(t,r,n){y!==t&&(t?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),y=t),!t||_===r&&b===n||(e.polygonOffset(r,n),_=r,b=n)},this.reset=function(){for(var e=0;e<i.length;e++)i[e]=0;o=null,h=null,f=null,p=null,m=null,g=null}},r.LensFlarePlugin=function(e,t){function n(t){var r=h.createProgram(),n=h.createShader(h.FRAGMENT_SHADER),i=h.createShader(h.VERTEX_SHADER),o="precision "+e.getPrecision()+" float;\n";return h.shaderSource(n,o+t.fragmentShader),h.shaderSource(i,o+t.vertexShader),h.compileShader(n),h.compileShader(i),h.attachShader(r,n),h.attachShader(r,i),h.linkProgram(r),r}var i,o,s,a,l,c,u,d,h=e.context,f=function(){var e=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),t=new Uint16Array([0,1,2,0,2,3]);i=h.createBuffer(),o=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,i),h.bufferData(h.ARRAY_BUFFER,e,h.STATIC_DRAW),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),h.bufferData(h.ELEMENT_ARRAY_BUFFER,t,h.STATIC_DRAW),u=h.createTexture(),d=h.createTexture(),h.bindTexture(h.TEXTURE_2D,u),h.texImage2D(h.TEXTURE_2D,0,h.RGB,16,16,0,h.RGB,h.UNSIGNED_BYTE,null),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.bindTexture(h.TEXTURE_2D,d),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,16,16,0,h.RGBA,h.UNSIGNED_BYTE,null),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),c=h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;var r;r=c?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},s=n(r),a={vertex:h.getAttribLocation(s,"position"),uv:h.getAttribLocation(s,"uv")},l={renderType:h.getUniformLocation(s,"renderType"),map:h.getUniformLocation(s,"map"),occlusionMap:h.getUniformLocation(s,"occlusionMap"),opacity:h.getUniformLocation(s,"opacity"),color:h.getUniformLocation(s,"color"),scale:h.getUniformLocation(s,"scale"),rotation:h.getUniformLocation(s,"rotation"),screenPosition:h.getUniformLocation(s,"screenPosition")}};this.render=function(n,p,m,g){if(0!==t.length){var v=new r.Vector3,y=g/m,_=.5*m,b=.5*g,x=16/g,w=new r.Vector2(x*y,x),E=new r.Vector3(1,1,0),S=new r.Vector2(1,1);void 0===s&&f(),h.useProgram(s),h.enableVertexAttribArray(a.vertex),h.enableVertexAttribArray(a.uv),h.uniform1i(l.occlusionMap,0),h.uniform1i(l.map,1),h.bindBuffer(h.ARRAY_BUFFER,i),h.vertexAttribPointer(a.vertex,2,h.FLOAT,!1,16,0),h.vertexAttribPointer(a.uv,2,h.FLOAT,!1,16,8),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),h.disable(h.CULL_FACE),h.depthMask(!1);for(var A=0,M=t.length;M>A;A++){x=16/g,w.set(x*y,x);var T=t[A];if(v.set(T.matrixWorld.elements[12],T.matrixWorld.elements[13],T.matrixWorld.elements[14]),v.applyMatrix4(p.matrixWorldInverse),v.applyProjection(p.projectionMatrix),E.copy(v),S.x=E.x*_+_,S.y=E.y*b+b,c||S.x>0&&S.x<m&&S.y>0&&S.y<g){h.activeTexture(h.TEXTURE1),h.bindTexture(h.TEXTURE_2D,u),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGB,S.x-8,S.y-8,16,16,0),h.uniform1i(l.renderType,0),h.uniform2f(l.scale,w.x,w.y),h.uniform3f(l.screenPosition,E.x,E.y,E.z),h.disable(h.BLEND),h.enable(h.DEPTH_TEST),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,d),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,S.x-8,S.y-8,16,16,0),h.uniform1i(l.renderType,1),h.disable(h.DEPTH_TEST),h.activeTexture(h.TEXTURE1),h.bindTexture(h.TEXTURE_2D,u),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0),T.positionScreen.copy(E),T.customUpdateCallback?T.customUpdateCallback(T):T.updateLensFlares(),h.uniform1i(l.renderType,2),h.enable(h.BLEND);for(var C=0,j=T.lensFlares.length;j>C;C++){var P=T.lensFlares[C];P.opacity>.001&&P.scale>.001&&(E.x=P.x,E.y=P.y,E.z=P.z,x=P.size*P.scale/g,w.x=x*y,w.y=x,h.uniform3f(l.screenPosition,E.x,E.y,E.z),h.uniform2f(l.scale,w.x,w.y),h.uniform1f(l.rotation,P.rotation),h.uniform1f(l.opacity,P.opacity),h.uniform3f(l.color,P.color.r,P.color.g,P.color.b),e.state.setBlending(P.blending,P.blendEquation,P.blendSrc,P.blendDst),e.setTexture(P.texture,1),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0))}}}h.enable(h.CULL_FACE),h.enable(h.DEPTH_TEST),h.depthMask(!0),e.resetGLState()}}},r.ShadowMapPlugin=function(e,t,n,i){function o(e,t,r){if(t.visible){var i=n[t.id];if(i&&t.castShadow&&(t.frustumCulled===!1||m.intersectsObject(t)===!0))for(var s=0,a=i.length;a>s;s++){var l=i[s];t._modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),b.push(l)}for(var s=0,a=t.children.length;a>s;s++)o(e,t.children[s],r)}}function s(e,t){var n=new r.DirectionalLight;n.isVirtual=!0,n.onlyShadow=!0,n.castShadow=!0,n.shadowCameraNear=e.shadowCameraNear,n.shadowCameraFar=e.shadowCameraFar,n.shadowCameraLeft=e.shadowCameraLeft,n.shadowCameraRight=e.shadowCameraRight,n.shadowCameraBottom=e.shadowCameraBottom,n.shadowCameraTop=e.shadowCameraTop,n.shadowCameraVisible=e.shadowCameraVisible,n.shadowDarkness=e.shadowDarkness,n.shadowBias=e.shadowCascadeBias[t],n.shadowMapWidth=e.shadowCascadeWidth[t],n.shadowMapHeight=e.shadowCascadeHeight[t],n.pointsWorld=[],n.pointsFrustum=[];for(var i=n.pointsWorld,o=n.pointsFrustum,s=0;8>s;s++)i[s]=new r.Vector3,o[s]=new r.Vector3;var a=e.shadowCascadeNearZ[t],l=e.shadowCascadeFarZ[t];return o[0].set(-1,-1,a),o[1].set(1,-1,a),o[2].set(-1,1,a),o[3].set(1,1,a),o[4].set(-1,-1,l),o[5].set(1,-1,l),o[6].set(-1,1,l),o[7].set(1,1,l),n}function a(e,t){var r=e.shadowCascadeArray[t];r.position.copy(e.position),r.target.position.copy(e.target.position),r.lookAt(r.target),r.shadowCameraVisible=e.shadowCameraVisible,r.shadowDarkness=e.shadowDarkness,r.shadowBias=e.shadowCascadeBias[t];var n=e.shadowCascadeNearZ[t],i=e.shadowCascadeFarZ[t],o=r.pointsFrustum;o[0].z=n,o[1].z=n,o[2].z=n,o[3].z=n,o[4].z=i,o[5].z=i,o[6].z=i,o[7].z=i}function l(e,t){var r=t.shadowCamera,n=t.pointsFrustum,i=t.pointsWorld;v.set(1/0,1/0,1/0),y.set(-(1/0),-(1/0),-(1/0));for(var o=0;8>o;o++){var s=i[o];s.copy(n[o]),s.unproject(e),s.applyMatrix4(r.matrixWorldInverse),s.x<v.x&&(v.x=s.x),s.x>y.x&&(y.x=s.x),s.y<v.y&&(v.y=s.y),s.y>y.y&&(y.y=s.y),s.z<v.z&&(v.z=s.z),s.z>y.z&&(y.z=s.z)}r.left=v.x,r.right=y.x,r.top=y.y,r.bottom=v.y,r.updateProjectionMatrix()}function c(e){return e.material instanceof r.MeshFaceMaterial?e.material.materials[0]:e.material}var u,d,h,f,p=e.context,m=new r.Frustum,g=new r.Matrix4,v=new r.Vector3,y=new r.Vector3,_=new r.Vector3,b=[],x=r.ShaderLib.depthRGBA,w=r.UniformsUtils.clone(x.uniforms);u=new r.ShaderMaterial({uniforms:w,vertexShader:x.vertexShader,fragmentShader:x.fragmentShader}),d=new r.ShaderMaterial({uniforms:w,vertexShader:x.vertexShader,fragmentShader:x.fragmentShader,morphTargets:!0}),h=new r.ShaderMaterial({uniforms:w,vertexShader:x.vertexShader,fragmentShader:x.fragmentShader,skinning:!0}),f=new r.ShaderMaterial({uniforms:w,vertexShader:x.vertexShader,fragmentShader:x.fragmentShader,morphTargets:!0,skinning:!0}),u._shadowPass=!0,d._shadowPass=!0,h._shadowPass=!0,f._shadowPass=!0,this.render=function(n,v){if(e.shadowMapEnabled!==!1){var y,x,w,E,S,A,M,T,C,j,P,L,D,I=[],R=0,O=null;for(p.clearColor(1,1,1,1),p.disable(p.BLEND),p.enable(p.CULL_FACE),p.frontFace(p.CCW),e.shadowMapCullFace===r.CullFaceFront?p.cullFace(p.FRONT):p.cullFace(p.BACK),e.state.setDepthTest(!0),y=0,x=t.length;x>y;y++)if(D=t[y],D.castShadow)if(D instanceof r.DirectionalLight&&D.shadowCascade)for(S=0;S<D.shadowCascadeCount;S++){var k;if(D.shadowCascadeArray[S])k=D.shadowCascadeArray[S];else{k=s(D,S),k.originalCamera=v;var N=new r.Gyroscope;N.position.copy(D.shadowCascadeOffset),N.add(k),N.add(k.target),v.add(N),D.shadowCascadeArray[S]=k}a(D,S),I[R]=k,R++}else I[R]=D,R++;for(y=0,x=I.length;x>y;y++){if(D=I[y],!D.shadowMap){var F=r.LinearFilter;e.shadowMapType===r.PCFSoftShadowMap&&(F=r.NearestFilter);var V={minFilter:F,magFilter:F,format:r.RGBAFormat};D.shadowMap=new r.WebGLRenderTarget(D.shadowMapWidth,D.shadowMapHeight,V),D.shadowMapSize=new r.Vector2(D.shadowMapWidth,D.shadowMapHeight),D.shadowMatrix=new r.Matrix4}if(!D.shadowCamera){if(D instanceof r.SpotLight)D.shadowCamera=new r.PerspectiveCamera(D.shadowCameraFov,D.shadowMapWidth/D.shadowMapHeight,D.shadowCameraNear,D.shadowCameraFar);else{if(!(D instanceof r.DirectionalLight)){r.error("THREE.ShadowMapPlugin: Unsupported light type for shadow",D);continue}D.shadowCamera=new r.OrthographicCamera(D.shadowCameraLeft,D.shadowCameraRight,D.shadowCameraTop,D.shadowCameraBottom,D.shadowCameraNear,D.shadowCameraFar);
}n.add(D.shadowCamera),n.autoUpdate===!0&&n.updateMatrixWorld()}D.shadowCameraVisible&&!D.cameraHelper&&(D.cameraHelper=new r.CameraHelper(D.shadowCamera),n.add(D.cameraHelper)),D.isVirtual&&k.originalCamera==v&&l(v,D),A=D.shadowMap,M=D.shadowMatrix,T=D.shadowCamera,T.position.setFromMatrixPosition(D.matrixWorld),_.setFromMatrixPosition(D.target.matrixWorld),T.lookAt(_),T.updateMatrixWorld(),T.matrixWorldInverse.getInverse(T.matrixWorld),D.cameraHelper&&(D.cameraHelper.visible=D.shadowCameraVisible),D.shadowCameraVisible&&D.cameraHelper.update(),M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(T.projectionMatrix),M.multiply(T.matrixWorldInverse),g.multiplyMatrices(T.projectionMatrix,T.matrixWorldInverse),m.setFromMatrix(g),e.setRenderTarget(A),e.clear(),b.length=0,o(n,n,T);var U,B,z;for(w=0,E=b.length;E>w;w++)P=b[w],L=P.object,C=P.buffer,U=c(L),B=void 0!==L.geometry.morphTargets&&L.geometry.morphTargets.length>0&&U.morphTargets,z=L instanceof r.SkinnedMesh&&U.skinning,j=L.customDepthMaterial?L.customDepthMaterial:z?B?f:h:B?d:u,e.setMaterialFaces(U),C instanceof r.BufferGeometry?e.renderBufferDirect(T,t,O,j,C,L):e.renderBuffer(T,t,O,j,C,L);for(w=0,E=i.length;E>w;w++)P=i[w],L=P.object,L.visible&&L.castShadow&&(L._modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,L.matrixWorld),e.renderImmediateObject(T,t,O,u,L))}var G=e.getClearColor(),H=e.getClearAlpha();p.clearColor(G.r,G.g,G.b,H),p.enable(p.BLEND),e.shadowMapCullFace===r.CullFaceFront&&p.cullFace(p.BACK),e.resetGLState()}}},r.SpritePlugin=function(e,t){function n(){var t=d.createProgram(),r=d.createShader(d.VERTEX_SHADER),n=d.createShader(d.FRAGMENT_SHADER);return d.shaderSource(r,["precision "+e.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),d.shaderSource(n,["precision "+e.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),d.compileShader(r),d.compileShader(n),d.attachShader(t,r),d.attachShader(t,n),d.linkProgram(t),t}function i(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}var o,s,a,l,c,u,d=e.context,h=new r.Vector3,f=new r.Quaternion,p=new r.Vector3,m=function(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),t=new Uint16Array([0,1,2,0,2,3]);o=d.createBuffer(),s=d.createBuffer(),d.bindBuffer(d.ARRAY_BUFFER,o),d.bufferData(d.ARRAY_BUFFER,e,d.STATIC_DRAW),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,s),d.bufferData(d.ELEMENT_ARRAY_BUFFER,t,d.STATIC_DRAW),a=n(),l={position:d.getAttribLocation(a,"position"),uv:d.getAttribLocation(a,"uv")},c={uvOffset:d.getUniformLocation(a,"uvOffset"),uvScale:d.getUniformLocation(a,"uvScale"),rotation:d.getUniformLocation(a,"rotation"),scale:d.getUniformLocation(a,"scale"),color:d.getUniformLocation(a,"color"),map:d.getUniformLocation(a,"map"),opacity:d.getUniformLocation(a,"opacity"),modelViewMatrix:d.getUniformLocation(a,"modelViewMatrix"),projectionMatrix:d.getUniformLocation(a,"projectionMatrix"),fogType:d.getUniformLocation(a,"fogType"),fogDensity:d.getUniformLocation(a,"fogDensity"),fogNear:d.getUniformLocation(a,"fogNear"),fogFar:d.getUniformLocation(a,"fogFar"),fogColor:d.getUniformLocation(a,"fogColor"),alphaTest:d.getUniformLocation(a,"alphaTest")};var i=document.createElement("canvas");i.width=8,i.height=8;var h=i.getContext("2d");h.fillStyle="white",h.fillRect(0,0,8,8),u=new r.Texture(i),u.needsUpdate=!0};this.render=function(n,g){if(0!==t.length){void 0===a&&m(),d.useProgram(a),d.enableVertexAttribArray(l.position),d.enableVertexAttribArray(l.uv),d.disable(d.CULL_FACE),d.enable(d.BLEND),d.bindBuffer(d.ARRAY_BUFFER,o),d.vertexAttribPointer(l.position,2,d.FLOAT,!1,16,0),d.vertexAttribPointer(l.uv,2,d.FLOAT,!1,16,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,s),d.uniformMatrix4fv(c.projectionMatrix,!1,g.projectionMatrix.elements),d.activeTexture(d.TEXTURE0),d.uniform1i(c.map,0);var v=0,y=0,_=n.fog;_?(d.uniform3f(c.fogColor,_.color.r,_.color.g,_.color.b),_ instanceof r.Fog?(d.uniform1f(c.fogNear,_.near),d.uniform1f(c.fogFar,_.far),d.uniform1i(c.fogType,1),v=1,y=1):_ instanceof r.FogExp2&&(d.uniform1f(c.fogDensity,_.density),d.uniform1i(c.fogType,2),v=2,y=2)):(d.uniform1i(c.fogType,0),v=0,y=0);for(var b=0,x=t.length;x>b;b++){var w=t[b];w._modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,w.matrixWorld),w.z=-w._modelViewMatrix.elements[14]}t.sort(i);for(var E=[],b=0,x=t.length;x>b;b++){var w=t[b],S=w.material;d.uniform1f(c.alphaTest,S.alphaTest),d.uniformMatrix4fv(c.modelViewMatrix,!1,w._modelViewMatrix.elements),w.matrixWorld.decompose(h,f,p),E[0]=p.x,E[1]=p.y;var A=0;n.fog&&S.fog&&(A=y),v!==A&&(d.uniform1i(c.fogType,A),v=A),null!==S.map?(d.uniform2f(c.uvOffset,S.map.offset.x,S.map.offset.y),d.uniform2f(c.uvScale,S.map.repeat.x,S.map.repeat.y)):(d.uniform2f(c.uvOffset,0,0),d.uniform2f(c.uvScale,1,1)),d.uniform1f(c.opacity,S.opacity),d.uniform3f(c.color,S.color.r,S.color.g,S.color.b),d.uniform1f(c.rotation,S.rotation),d.uniform2fv(c.scale,E),e.state.setBlending(S.blending,S.blendEquation,S.blendSrc,S.blendDst),e.state.setDepthTest(S.depthTest),e.state.setDepthWrite(S.depthWrite),S.map&&S.map.image&&S.map.image.width?e.setTexture(S.map,0):e.setTexture(u,0),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0)}d.enable(d.CULL_FACE),e.resetGLState()}}},r.GeometryUtils={merge:function(e,t,n){r.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var i;t instanceof r.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),i=t.matrix,t=t.geometry),e.merge(t,i,n)},center:function(e){return r.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},r.ImageUtils={crossOrigin:void 0,loadTexture:function(e,t,n,i){var o=new r.ImageLoader;o.crossOrigin=this.crossOrigin;var s=new r.Texture(void 0,t);return o.load(e,function(e){s.image=e,s.needsUpdate=!0,n&&n(s)},void 0,function(e){i&&i(e)}),s.sourceFile=e,s},loadTextureCube:function(e,t,n,i){var o=[],s=new r.ImageLoader;s.crossOrigin=this.crossOrigin;var a=new r.CubeTexture(o,t);a.flipY=!1;for(var l=0,c=function(t){s.load(e[t],function(e){a.images[t]=e,l+=1,6===l&&(a.needsUpdate=!0,n&&n(a))},void 0,i)},u=0,d=e.length;d>u;++u)c(u);return a},loadCompressedTexture:function(){r.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){r.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(e,t){var r=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},n=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},i=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t=1|t;var o=e.width,s=e.height,a=document.createElement("canvas");a.width=o,a.height=s;var l=a.getContext("2d");l.drawImage(e,0,0);for(var c=l.getImageData(0,0,o,s).data,u=l.createImageData(o,s),d=u.data,h=0;o>h;h++)for(var f=0;s>f;f++){var p=0>f-1?0:f-1,m=f+1>s-1?s-1:f+1,g=0>h-1?0:h-1,v=h+1>o-1?o-1:h+1,y=[],_=[0,0,c[4*(f*o+h)]/255*t];y.push([-1,0,c[4*(f*o+g)]/255*t]),y.push([-1,-1,c[4*(p*o+g)]/255*t]),y.push([0,-1,c[4*(p*o+h)]/255*t]),y.push([1,-1,c[4*(p*o+v)]/255*t]),y.push([1,0,c[4*(f*o+v)]/255*t]),y.push([1,1,c[4*(m*o+v)]/255*t]),y.push([0,1,c[4*(m*o+h)]/255*t]),y.push([-1,1,c[4*(m*o+g)]/255*t]);for(var b=[],x=y.length,w=0;x>w;w++){var E=y[w],S=y[(w+1)%x];E=n(E,_),S=n(S,_),b.push(i(r(E,S)))}for(var A=[0,0,0],w=0;w<b.length;w++)A[0]+=b[w][0],A[1]+=b[w][1],A[2]+=b[w][2];A[0]/=b.length,A[1]/=b.length,A[2]/=b.length;var M=4*(f*o+h);d[M]=(A[0]+1)/2*255|0,d[M+1]=(A[1]+1)/2*255|0,d[M+2]=255*A[2]|0,d[M+3]=255}return l.putImageData(u,0,0),a},generateDataTexture:function(e,t,n){for(var i=e*t,o=new Uint8Array(3*i),s=Math.floor(255*n.r),a=Math.floor(255*n.g),l=Math.floor(255*n.b),c=0;i>c;c++)o[3*c]=s,o[3*c+1]=a,o[3*c+2]=l;var u=new r.DataTexture(o,e,t,r.RGBFormat);return u.needsUpdate=!0,u}},r.SceneUtils={createMultiMaterialObject:function(e,t){for(var n=new r.Object3D,i=0,o=t.length;o>i;i++)n.add(new r.Mesh(e,t[i]));return n},detach:function(e,t,r){e.applyMatrix(t.matrixWorld),t.remove(e),r.add(e)},attach:function(e,t,n){var i=new r.Matrix4;i.getInverse(n.matrixWorld),e.applyMatrix(i),t.remove(e),n.add(e)}},r.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(e){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(e){var t=e.familyName.toLowerCase(),r=this;return r.faces[t]=r.faces[t]||{},r.faces[t][e.cssFontWeight]=r.faces[t][e.cssFontWeight]||{},r.faces[t][e.cssFontWeight][e.cssFontStyle]=e,r.faces[t][e.cssFontWeight][e.cssFontStyle]=e,e},drawText:function(e){var t,n=this.getFace(),i=this.size/n.resolution,o=0,s=String(e).split(""),a=s.length,l=[];for(t=0;a>t;t++){var c=new r.Path,u=this.extractGlyphPoints(s[t],n,i,o,c);o+=u.offset,l.push(u.path)}var d=o/2;return{paths:l,offset:d}},extractGlyphPoints:function(e,t,n,i,o){var s,a,l,c,u,d,h,f,p,m,g,v,y,_,b,x,w,E,S,A=[],M=t.glyphs[e]||t.glyphs["?"];if(M){if(M.o)for(c=M._cachedOutline||(M._cachedOutline=M.o.split(" ")),d=c.length,h=n,f=n,s=0;d>s;)switch(u=c[s++]){case"m":p=c[s++]*h+i,m=c[s++]*f,o.moveTo(p,m);break;case"l":p=c[s++]*h+i,m=c[s++]*f,o.lineTo(p,m);break;case"q":if(g=c[s++]*h+i,v=c[s++]*f,b=c[s++]*h+i,x=c[s++]*f,o.quadraticCurveTo(b,x,g,v),S=A[A.length-1])for(y=S.x,_=S.y,a=1,l=this.divisions;l>=a;a++){var T=a/l;r.Shape.Utils.b2(T,y,b,g),r.Shape.Utils.b2(T,_,x,v)}break;case"b":if(g=c[s++]*h+i,v=c[s++]*f,b=c[s++]*h+i,x=c[s++]*f,w=c[s++]*h+i,E=c[s++]*f,o.bezierCurveTo(b,x,w,E,g,v),S=A[A.length-1])for(y=S.x,_=S.y,a=1,l=this.divisions;l>=a;a++){var T=a/l;r.Shape.Utils.b3(T,y,b,w,g),r.Shape.Utils.b3(T,_,x,E,v)}}return{offset:M.ha*n,path:o}}}},r.FontUtils.generateShapes=function(e,t){t=t||{};var n=void 0!==t.size?t.size:100,i=void 0!==t.curveSegments?t.curveSegments:4,o=void 0!==t.font?t.font:"helvetiker",s=void 0!==t.weight?t.weight:"normal",a=void 0!==t.style?t.style:"normal";r.FontUtils.size=n,r.FontUtils.divisions=i,r.FontUtils.face=o,r.FontUtils.weight=s,r.FontUtils.style=a;for(var l=r.FontUtils.drawText(e),c=l.paths,u=[],d=0,h=c.length;h>d;d++)Array.prototype.push.apply(u,c[d].toShapes());return u},function(e){var t=1e-10,n=function(e,t){var n=e.length;if(3>n)return null;var s,a,l,c=[],u=[],d=[];if(i(e)>0)for(a=0;n>a;a++)u[a]=a;else for(a=0;n>a;a++)u[a]=n-1-a;var h=n,f=2*h;for(a=h-1;h>2;){if(f--<=0)return r.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()"),t?d:c;if(s=a,s>=h&&(s=0),a=s+1,a>=h&&(a=0),l=a+1,l>=h&&(l=0),o(e,s,a,l,h,u)){var p,m,g,v,y;for(p=u[s],m=u[a],g=u[l],c.push([e[p],e[m],e[g]]),d.push([u[s],u[a],u[l]]),v=a,y=a+1;h>y;v++,y++)u[v]=u[y];h--,f=2*h}}return t?d:c},i=function(e){for(var t=e.length,r=0,n=t-1,i=0;t>i;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},o=function(e,r,n,i,o,s){var a,l,c,u,d,h,f,p,m;if(l=e[s[r]].x,c=e[s[r]].y,u=e[s[n]].x,d=e[s[n]].y,h=e[s[i]].x,f=e[s[i]].y,t>(u-l)*(f-c)-(d-c)*(h-l))return!1;var g,v,y,_,b,x,w,E,S,A,M,T,C,j,P;for(g=h-u,v=f-d,y=l-h,_=c-f,b=u-l,x=d-c,a=0;o>a;a++)if(p=e[s[a]].x,m=e[s[a]].y,!(p===l&&m===c||p===u&&m===d||p===h&&m===f)&&(w=p-l,E=m-c,S=p-u,A=m-d,M=p-h,T=m-f,P=g*A-v*S,C=b*E-x*w,j=y*T-_*M,P>=-t&&j>=-t&&C>=-t))return!1;return!0};return e.Triangulate=n,e.Triangulate.area=i,e}(r.FontUtils),r.Audio=function(e){r.Object3D.call(this),this.type="Audio",this.context=e.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.autoplay=!1,this.startTime=0,this.isPlaying=!1},r.Audio.prototype=Object.create(r.Object3D.prototype),r.Audio.prototype.constructor=r.Audio,r.Audio.prototype.load=function(e){var t=this,r=new XMLHttpRequest;return r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(e){t.context.decodeAudioData(this.response,function(e){t.source.buffer=e,t.autoplay&&t.play()})},r.send(),this},r.Audio.prototype.play=function(){if(this.isPlaying===!0)return void r.warn("THREE.Audio: Audio is already playing.");var e=this.context.createBufferSource();e.buffer=this.source.buffer,e.loop=this.source.loop,e.onended=this.source.onended,e.connect(this.panner),e.start(0,this.startTime),this.isPlaying=!0,this.source=e},r.Audio.prototype.pause=function(){this.source.stop(),this.startTime=this.context.currentTime},r.Audio.prototype.stop=function(){this.source.stop(),this.startTime=0},r.Audio.prototype.onEnded=function(){this.isPlaying=!1},r.Audio.prototype.setLoop=function(e){this.source.loop=e},r.Audio.prototype.setRefDistance=function(e){this.panner.refDistance=e},r.Audio.prototype.setRolloffFactor=function(e){this.panner.rolloffFactor=e},r.Audio.prototype.setVolume=function(e){this.gain.gain.value=e},r.Audio.prototype.updateMatrixWorld=function(){var e=new r.Vector3;return function(t){r.Object3D.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}(),r.AudioListener=function(){r.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},r.AudioListener.prototype=Object.create(r.Object3D.prototype),r.AudioListener.prototype.constructor=r.AudioListener,r.AudioListener.prototype.updateMatrixWorld=function(){var e=new r.Vector3,t=new r.Quaternion,n=new r.Vector3,i=new r.Vector3,o=new r.Vector3,s=new r.Vector3;return function(a){r.Object3D.prototype.updateMatrixWorld.call(this,a);var l=this.context.listener,c=this.up;this.matrixWorld.decompose(e,t,n),i.set(0,0,-1).applyQuaternion(t),o.subVectors(e,s),l.setPosition(e.x,e.y,e.z),l.setOrientation(i.x,i.y,i.z,c.x,c.y,c.z),l.setVelocity(o.x,o.y,o.z),s.copy(e)}}(),r.Curve=function(){},r.Curve.prototype.getPoint=function(e){return r.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},r.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},r.Curve.prototype.getPoints=function(e){e||(e=5);var t,r=[];for(t=0;e>=t;t++)r.push(this.getPoint(t/e));return r},r.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,r=[];for(t=0;e>=t;t++)r.push(this.getPointAt(t/e));return r},r.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},r.Curve.prototype.getLengths=function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,r,n=[],i=this.getPoint(0),o=0;for(n.push(0),r=1;e>=r;r++)t=this.getPoint(r/e),o+=t.distanceTo(i),n.push(o),i=t;return this.cacheArcLengths=n,n},r.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},r.Curve.prototype.getUtoTmapping=function(e,t){var r,n=this.getLengths(),i=0,o=n.length;r=t?t:e*n[o-1];for(var s,a=0,l=o-1;l>=a;)if(i=Math.floor(a+(l-a)/2),s=n[i]-r,0>s)a=i+1;else{if(!(s>0)){l=i;break}l=i-1}if(i=l,n[i]==r){var c=i/(o-1);return c}var u=n[i],d=n[i+1],h=d-u,f=(r-u)/h,c=(i+f)/(o-1);return c},r.Curve.prototype.getTangent=function(e){var t=1e-4,r=e-t,n=e+t;0>r&&(r=0),n>1&&(n=1);var i=this.getPoint(r),o=this.getPoint(n),s=o.clone().sub(i);return s.normalize()},r.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},r.Curve.Utils={tangentQuadraticBezier:function(e,t,r,n){return 2*(1-e)*(r-t)+2*e*(n-r)},tangentCubicBezier:function(e,t,r,n,i){return-3*t*(1-e)*(1-e)+3*r*(1-e)*(1-e)-6*e*r*(1-e)+6*e*n*(1-e)-3*e*e*n+3*e*e*i},tangentSpline:function(e,t,r,n,i){var o=6*e*e-6*e,s=3*e*e-4*e+1,a=-6*e*e+6*e,l=3*e*e-2*e;return o+s+a+l},interpolate:function(e,t,r,n,i){var o=.5*(r-e),s=.5*(n-t),a=i*i,l=i*a;return(2*t-2*r+o+s)*l+(-3*t+3*r-2*o-s)*a+o*i+t}},r.Curve.create=function(e,t){return e.prototype=Object.create(r.Curve.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},r.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},r.CurvePath.prototype=Object.create(r.Curve.prototype),r.CurvePath.prototype.constructor=r.CurvePath,r.CurvePath.prototype.add=function(e){this.curves.push(e)},r.CurvePath.prototype.checkConnection=function(){},r.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new r.LineCurve(t,e))},r.CurvePath.prototype.getPoint=function(e){for(var t,r,n=e*this.getLength(),i=this.getCurveLengths(),o=0;o<i.length;){if(i[o]>=n){t=i[o]-n,r=this.curves[o];var s=1-t/r.getLength();return r.getPointAt(s)}o++}return null},r.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},r.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e,t=[],r=0,n=this.curves.length;for(e=0;n>e;e++)r+=this.curves[e].getLength(),t.push(r);return this.cacheLengths=t,t},r.CurvePath.prototype.getBoundingBox=function(){var e,t,n,i,o,s,a=this.getPoints();e=t=Number.NEGATIVE_INFINITY,i=o=Number.POSITIVE_INFINITY;var l,c,u,d,h=a[0]instanceof r.Vector3;for(d=h?new r.Vector3:new r.Vector2,c=0,u=a.length;u>c;c++)l=a[c],l.x>e?e=l.x:l.x<i&&(i=l.x),l.y>t?t=l.y:l.y<o&&(o=l.y),h&&(l.z>n?n=l.z:l.z<s&&(s=l.z)),d.add(l);var f={minX:i,minY:o,maxX:e,maxY:t};return h&&(f.maxZ=n,f.minZ=s),f},r.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,!0);return this.createGeometry(t)},r.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,!0);return this.createGeometry(t)},r.CurvePath.prototype.createGeometry=function(e){for(var t=new r.Geometry,n=0;n<e.length;n++)t.vertices.push(new r.Vector3(e[n].x,e[n].y,e[n].z||0));return t},r.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},r.CurvePath.prototype.getTransformedPoints=function(e,t){var r,n,i=this.getPoints(e);for(t||(t=this.bends),r=0,n=t.length;n>r;r++)i=this.getWrapPoints(i,t[r]);return i},r.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var r,n,i=this.getSpacedPoints(e);for(t||(t=this.bends),r=0,n=t.length;n>r;r++)i=this.getWrapPoints(i,t[r]);return i},r.CurvePath.prototype.getWrapPoints=function(e,t){var r,n,i,o,s,a,l=this.getBoundingBox();for(r=0,n=e.length;n>r;r++){i=e[r],o=i.x,s=i.y,a=o/l.maxX,a=t.getUtoTmapping(a,o);var c=t.getPoint(a),u=t.getTangent(a);u.set(-u.y,u.x).multiplyScalar(s),i.x=c.x+u.x,i.y=c.y+u.y}return e},r.Gyroscope=function(){r.Object3D.call(this)},r.Gyroscope.prototype=Object.create(r.Object3D.prototype),r.Gyroscope.prototype.constructor=r.Gyroscope,r.Gyroscope.prototype.updateMatrixWorld=function(){var e=new r.Vector3,t=new r.Quaternion,n=new r.Vector3,i=new r.Vector3,o=new r.Quaternion,s=new r.Vector3;return function(r){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||r)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(i,o,s),this.matrix.decompose(e,t,n),this.matrixWorld.compose(i,t,s)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,r=!0);for(var a=0,l=this.children.length;l>a;a++)this.children[a].updateMatrixWorld(r)}}(),r.Path=function(e){r.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},r.Path.prototype=Object.create(r.CurvePath.prototype),r.Path.prototype.constructor=r.Path,r.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},r.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;r>t;t++)this.lineTo(e[t].x,e[t].y)},r.Path.prototype.moveTo=function(e,t){var n=Array.prototype.slice.call(arguments);this.actions.push({action:r.PathActions.MOVE_TO,args:n})},r.Path.prototype.lineTo=function(e,t){var n=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,o=i[i.length-2],s=i[i.length-1],a=new r.LineCurve(new r.Vector2(o,s),new r.Vector2(e,t));this.curves.push(a),this.actions.push({action:r.PathActions.LINE_TO,args:n})},r.Path.prototype.quadraticCurveTo=function(e,t,n,i){var o=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,a=s[s.length-2],l=s[s.length-1],c=new r.QuadraticBezierCurve(new r.Vector2(a,l),new r.Vector2(e,t),new r.Vector2(n,i));this.curves.push(c),this.actions.push({action:r.PathActions.QUADRATIC_CURVE_TO,args:o})},r.Path.prototype.bezierCurveTo=function(e,t,n,i,o,s){var a=Array.prototype.slice.call(arguments),l=this.actions[this.actions.length-1].args,c=l[l.length-2],u=l[l.length-1],d=new r.CubicBezierCurve(new r.Vector2(c,u),new r.Vector2(e,t),new r.Vector2(n,i),new r.Vector2(o,s));this.curves.push(d),this.actions.push({action:r.PathActions.BEZIER_CURVE_TO,args:a})},r.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,i=n[n.length-2],o=n[n.length-1],s=[new r.Vector2(i,o)];Array.prototype.push.apply(s,e);var a=new r.SplineCurve(s);this.curves.push(a),this.actions.push({action:r.PathActions.CSPLINE_THRU,args:t})},r.Path.prototype.arc=function(e,t,r,n,i,o){var s=this.actions[this.actions.length-1].args,a=s[s.length-2],l=s[s.length-1];this.absarc(e+a,t+l,r,n,i,o)},r.Path.prototype.absarc=function(e,t,r,n,i,o){this.absellipse(e,t,r,r,n,i,o)},r.Path.prototype.ellipse=function(e,t,r,n,i,o,s){var a=this.actions[this.actions.length-1].args,l=a[a.length-2],c=a[a.length-1];this.absellipse(e+l,t+c,r,n,i,o,s)},r.Path.prototype.absellipse=function(e,t,n,i,o,s,a){var l=Array.prototype.slice.call(arguments),c=new r.EllipseCurve(e,t,n,i,o,s,a);this.curves.push(c);var u=c.getPoint(1);l.push(u.x),l.push(u.y),this.actions.push({action:r.PathActions.ELLIPSE,args:l})},r.Path.prototype.getSpacedPoints=function(e,t){e||(e=40);for(var r=[],n=0;e>n;n++)r.push(this.getPoint(n/e));return r},r.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints)return this.getSpacedPoints(e,t);e=e||12;var n,i,o,s,a,l,c,u,d,h,f,p,m,g,v,y,_,b,x=[];for(n=0,i=this.actions.length;i>n;n++)switch(o=this.actions[n],s=o.action,a=o.args,s){case r.PathActions.MOVE_TO:x.push(new r.Vector2(a[0],a[1]));break;case r.PathActions.LINE_TO:x.push(new r.Vector2(a[0],a[1]));break;case r.PathActions.QUADRATIC_CURVE_TO:for(l=a[2],c=a[3],h=a[0],f=a[1],x.length>0?(g=x[x.length-1],p=g.x,m=g.y):(g=this.actions[n-1].args,p=g[g.length-2],m=g[g.length-1]),v=1;e>=v;v++)y=v/e,_=r.Shape.Utils.b2(y,p,h,l),b=r.Shape.Utils.b2(y,m,f,c),x.push(new r.Vector2(_,b));break;case r.PathActions.BEZIER_CURVE_TO:for(l=a[4],c=a[5],h=a[0],f=a[1],u=a[2],d=a[3],x.length>0?(g=x[x.length-1],p=g.x,m=g.y):(g=this.actions[n-1].args,p=g[g.length-2],m=g[g.length-1]),v=1;e>=v;v++)y=v/e,_=r.Shape.Utils.b3(y,p,h,u,l),b=r.Shape.Utils.b3(y,m,f,d,c),x.push(new r.Vector2(_,b));break;case r.PathActions.CSPLINE_THRU:g=this.actions[n-1].args;var w=new r.Vector2(g[g.length-2],g[g.length-1]),E=[w],S=e*a[0].length;E=E.concat(a[0]);var A=new r.SplineCurve(E);for(v=1;S>=v;v++)x.push(A.getPointAt(v/S));break;case r.PathActions.ARC:var M,T=a[0],C=a[1],j=a[2],P=a[3],L=a[4],D=!!a[5],I=L-P,R=2*e;for(v=1;R>=v;v++)y=v/R,D||(y=1-y),M=P+y*I,_=T+j*Math.cos(M),b=C+j*Math.sin(M),x.push(new r.Vector2(_,b));break;case r.PathActions.ELLIPSE:var M,T=a[0],C=a[1],O=a[2],k=a[3],P=a[4],L=a[5],D=!!a[6],I=L-P,R=2*e;for(v=1;R>=v;v++)y=v/R,D||(y=1-y),M=P+y*I,_=T+O*Math.cos(M),b=C+k*Math.sin(M),x.push(new r.Vector2(_,b))}var N=x[x.length-1],F=1e-10;return Math.abs(N.x-x[0].x)<F&&Math.abs(N.y-x[0].y)<F&&x.splice(x.length-1,1),t&&x.push(x[0]),x},r.Path.prototype.toShapes=function(e,t){function n(e){var t,n,i,o,s,a=[],l=new r.Path;for(t=0,n=e.length;n>t;t++)i=e[t],s=i.args,o=i.action,o==r.PathActions.MOVE_TO&&0!=l.actions.length&&(a.push(l),l=new r.Path),l[o].apply(l,s);return 0!=l.actions.length&&a.push(l),a}function i(e){for(var t=[],n=0,i=e.length;i>n;n++){var o=e[n],s=new r.Shape;s.actions=o.actions,s.curves=o.curves,t.push(s)}return t}function o(e,t){for(var r=1e-10,n=t.length,i=!1,o=n-1,s=0;n>s;o=s++){var a=t[o],l=t[s],c=l.x-a.x,u=l.y-a.y;if(Math.abs(u)>r){if(0>u&&(a=t[s],c=-c,l=t[o],u=-u),e.y<a.y||e.y>l.y)continue;if(e.y==a.y){if(e.x==a.x)return!0}else{var d=u*(e.x-a.x)-c*(e.y-a.y);if(0==d)return!0;if(0>d)continue;i=!i}}else{if(e.y!=a.y)continue;if(l.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=l.x)return!0}}return i}var s=n(this.actions);if(0==s.length)return[];if(t===!0)return i(s);var a,l,c,u=[];if(1==s.length)return l=s[0],c=new r.Shape,c.actions=l.actions,c.curves=l.curves,u.push(c),u;var d=!r.Shape.Utils.isClockWise(s[0].getPoints());d=e?!d:d;var h,f=[],p=[],m=[],g=0;p[g]=void 0,m[g]=[];var v,y;for(v=0,y=s.length;y>v;v++)l=s[v],h=l.getPoints(),a=r.Shape.Utils.isClockWise(h),a=e?!a:a,a?(!d&&p[g]&&g++,p[g]={s:new r.Shape,p:h},p[g].s.actions=l.actions,p[g].s.curves=l.curves,d&&g++,m[g]=[]):m[g].push({h:l,p:h[0]});if(!p[0])return i(s);if(p.length>1){for(var _=!1,b=[],x=0,w=p.length;w>x;x++)f[x]=[];for(var x=0,w=p.length;w>x;x++)for(var E=m[x],S=0;S<E.length;S++){for(var A=E[S],M=!0,T=0;T<p.length;T++)o(A.p,p[T].p)&&(x!=T&&b.push({froms:x,tos:T,hole:S}),M?(M=!1,f[T].push(A)):_=!0);M&&f[x].push(A)}b.length>0&&(_||(m=f))}var C,j,P;for(v=0,y=p.length;y>v;v++)for(c=p[v].s,u.push(c),C=m[v],j=0,P=C.length;P>j;j++)c.holes.push(C[j].h);return u},r.Shape=function(){r.Path.apply(this,arguments),this.holes=[]},r.Shape.prototype=Object.create(r.Path.prototype),r.Shape.prototype.constructor=r.Shape,r.Shape.prototype.extrude=function(e){var t=new r.ExtrudeGeometry(this,e);return t},r.Shape.prototype.makeGeometry=function(e){var t=new r.ShapeGeometry(this,e);return t},r.Shape.prototype.getPointsHoles=function(e){var t,r=this.holes.length,n=[];for(t=0;r>t;t++)n[t]=this.holes[t].getTransformedPoints(e,this.bends);return n},r.Shape.prototype.getSpacedPointsHoles=function(e){var t,r=this.holes.length,n=[];for(t=0;r>t;t++)n[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return n},r.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},r.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},r.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},r.Shape.Utils={triangulateShape:function(e,t){function n(e,t,r){return e.x!=t.x?e.x<t.x?e.x<=r.x&&r.x<=t.x:t.x<=r.x&&r.x<=e.x:e.y<t.y?e.y<=r.y&&r.y<=t.y:t.y<=r.y&&r.y<=e.y}function i(e,t,r,i,o){var s=1e-10,a=t.x-e.x,l=t.y-e.y,c=i.x-r.x,u=i.y-r.y,d=e.x-r.x,h=e.y-r.y,f=l*c-a*u,p=l*d-a*h;if(Math.abs(f)>s){var m;if(f>0){if(0>p||p>f)return[];if(m=u*d-c*h,0>m||m>f)return[]}else{if(p>0||f>p)return[];if(m=u*d-c*h,m>0||f>m)return[]}if(0==m)return!o||0!=p&&p!=f?[e]:[];if(m==f)return!o||0!=p&&p!=f?[t]:[];if(0==p)return[r];if(p==f)return[i];var g=m/f;return[{x:e.x+g*a,y:e.y+g*l}]}if(0!=p||u*d!=c*h)return[];var v=0==a&&0==l,y=0==c&&0==u;if(v&&y)return e.x!=r.x||e.y!=r.y?[]:[e];if(v)return n(r,i,e)?[e]:[];if(y)return n(e,t,r)?[r]:[];var _,b,x,w,E,S,A,M;return 0!=a?(e.x<t.x?(_=e,x=e.x,b=t,w=t.x):(_=t,x=t.x,b=e,w=e.x),r.x<i.x?(E=r,A=r.x,S=i,M=i.x):(E=i,A=i.x,S=r,M=r.x)):(e.y<t.y?(_=e,x=e.y,b=t,w=t.y):(_=t,x=t.y,b=e,w=e.y),r.y<i.y?(E=r,A=r.y,S=i,M=i.y):(E=i,A=i.y,S=r,M=r.y)),A>=x?A>w?[]:w==A?o?[]:[E]:M>=w?[E,b]:[E,S]:x>M?[]:x==M?o?[]:[_]:M>=w?[_,b]:[_,S]}function o(e,t,r,n){var i=1e-10,o=t.x-e.x,s=t.y-e.y,a=r.x-e.x,l=r.y-e.y,c=n.x-e.x,u=n.y-e.y,d=o*l-s*a,h=o*u-s*c;if(Math.abs(d)>i){var f=c*l-u*a;return d>0?h>=0&&f>=0:h>=0||f>=0}return h>0}function s(e,t){function r(e,t){var r=y.length-1,n=e-1;0>n&&(n=r);var i=e+1;i>r&&(i=0);var s=o(y[e],y[n],y[i],a[t]);if(!s)return!1;var l=a.length-1,c=t-1;0>c&&(c=l);var u=t+1;return u>l&&(u=0),s=o(a[t],a[c],a[u],y[e]),s?!0:!1}function n(e,t){var r,n,o;for(r=0;r<y.length;r++)if(n=r+1,n%=y.length,o=i(e,t,y[r],y[n],!0),o.length>0)return!0;return!1}function s(e,r){var n,o,s,a,l;for(n=0;n<_.length;n++)for(o=t[_[n]],s=0;s<o.length;s++)if(a=s+1,a%=o.length,l=i(e,r,o[s],o[a],!0),l.length>0)return!0;return!1}for(var a,l,c,u,d,h,f,p,m,g,v,y=e.concat(),_=[],b=[],x=0,w=t.length;w>x;x++)_.push(x);for(var E=0,S=2*_.length;_.length>0&&(S--,!(0>S));)for(c=E;c<y.length;c++){u=y[c],l=-1;for(var x=0;x<_.length;x++)if(h=_[x],f=u.x+":"+u.y+":"+h,void 0===b[f]){a=t[h];for(var A=0;A<a.length;A++)if(d=a[A],r(c,A)&&!n(u,d)&&!s(u,d)){l=A,_.splice(x,1),p=y.slice(0,c+1),m=y.slice(c),g=a.slice(l),v=a.slice(0,l+1),y=p.concat(g).concat(v).concat(m),E=c;break}if(l>=0)break;b[f]=!0}if(l>=0)break}return y}for(var a,l,c,u,d,h,f={},p=e.concat(),m=0,g=t.length;g>m;m++)Array.prototype.push.apply(p,t[m]);for(a=0,l=p.length;l>a;a++)d=p[a].x+":"+p[a].y,void 0!==f[d]&&r.warn("THREE.Shape: Duplicate point",d),f[d]=a;var v=s(e,t),y=r.FontUtils.Triangulate(v,!1);for(a=0,l=y.length;l>a;a++)for(u=y[a],c=0;3>c;c++)d=u[c].x+":"+u[c].y,h=f[d],void 0!==h&&(u[c]=h);return y.concat()},isClockWise:function(e){return r.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var r=1-e;return r*r*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,r,n){return this.b2p0(e,t)+this.b2p1(e,r)+this.b2p2(e,n)},b3p0:function(e,t){var r=1-e;return r*r*r*t},b3p1:function(e,t){var r=1-e;return 3*r*r*e*t},b3p2:function(e,t){var r=1-e;return 3*r*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,r,n,i){return this.b3p0(e,t)+this.b3p1(e,r)+this.b3p2(e,n)+this.b3p3(e,i)}},r.LineCurve=function(e,t){this.v1=e,this.v2=t},r.LineCurve.prototype=Object.create(r.Curve.prototype),r.LineCurve.prototype.constructor=r.LineCurve,r.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},r.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},r.LineCurve.prototype.getTangent=function(e){var t=this.v2.clone().sub(this.v1);return t.normalize()},r.QuadraticBezierCurve=function(e,t,r){this.v0=e,this.v1=t,this.v2=r},r.QuadraticBezierCurve.prototype=Object.create(r.Curve.prototype),r.QuadraticBezierCurve.prototype.constructor=r.QuadraticBezierCurve,r.QuadraticBezierCurve.prototype.getPoint=function(e){var t=new r.Vector2;return t.x=r.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=r.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t},r.QuadraticBezierCurve.prototype.getTangent=function(e){var t=new r.Vector2;return t.x=r.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),
t.y=r.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y),t.normalize()},r.CubicBezierCurve=function(e,t,r,n){this.v0=e,this.v1=t,this.v2=r,this.v3=n},r.CubicBezierCurve.prototype=Object.create(r.Curve.prototype),r.CubicBezierCurve.prototype.constructor=r.CubicBezierCurve,r.CubicBezierCurve.prototype.getPoint=function(e){var t,n;return t=r.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=r.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new r.Vector2(t,n)},r.CubicBezierCurve.prototype.getTangent=function(e){var t,n;t=r.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=r.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var i=new r.Vector2(t,n);return i.normalize(),i},r.SplineCurve=function(e){this.points=void 0==e?[]:e},r.SplineCurve.prototype=Object.create(r.Curve.prototype),r.SplineCurve.prototype.constructor=r.SplineCurve,r.SplineCurve.prototype.getPoint=function(e){var t=this.points,n=(t.length-1)*e,i=Math.floor(n),o=n-i,s=t[0==i?i:i-1],a=t[i],l=t[i>t.length-2?t.length-1:i+1],c=t[i>t.length-3?t.length-1:i+2],u=new r.Vector2;return u.x=r.Curve.Utils.interpolate(s.x,a.x,l.x,c.x,o),u.y=r.Curve.Utils.interpolate(s.y,a.y,l.y,c.y,o),u},r.EllipseCurve=function(e,t,r,n,i,o,s){this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=s},r.EllipseCurve.prototype=Object.create(r.Curve.prototype),r.EllipseCurve.prototype.constructor=r.EllipseCurve,r.EllipseCurve.prototype.getPoint=function(e){var t=this.aEndAngle-this.aStartAngle;0>t&&(t+=2*Math.PI),t>2*Math.PI&&(t-=2*Math.PI);var n;n=this.aClockwise===!0?this.aEndAngle+(1-e)*(2*Math.PI-t):this.aStartAngle+e*t;var i=new r.Vector2;return i.x=this.aX+this.xRadius*Math.cos(n),i.y=this.aY+this.yRadius*Math.sin(n),i},r.ArcCurve=function(e,t,n,i,o,s){r.EllipseCurve.call(this,e,t,n,n,i,o,s)},r.ArcCurve.prototype=Object.create(r.EllipseCurve.prototype),r.ArcCurve.prototype.constructor=r.ArcCurve,r.LineCurve3=r.Curve.create(function(e,t){this.v1=e,this.v2=t},function(e){var t=new r.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t}),r.QuadraticBezierCurve3=r.Curve.create(function(e,t,r){this.v0=e,this.v1=t,this.v2=r},function(e){var t=new r.Vector3;return t.x=r.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=r.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t.z=r.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),t}),r.CubicBezierCurve3=r.Curve.create(function(e,t,r,n){this.v0=e,this.v1=t,this.v2=r,this.v3=n},function(e){var t=new r.Vector3;return t.x=r.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t.y=r.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t.z=r.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),t}),r.SplineCurve3=r.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=this.points,n=(t.length-1)*e,i=Math.floor(n),o=n-i,s=t[0==i?i:i-1],a=t[i],l=t[i>t.length-2?t.length-1:i+1],c=t[i>t.length-3?t.length-1:i+2],u=new r.Vector3;return u.x=r.Curve.Utils.interpolate(s.x,a.x,l.x,c.x,o),u.y=r.Curve.Utils.interpolate(s.y,a.y,l.y,c.y,o),u.z=r.Curve.Utils.interpolate(s.z,a.z,l.z,c.z,o),u}),r.ClosedSplineCurve3=r.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=this.points,n=(t.length-0)*e,i=Math.floor(n),o=n-i;i+=i>0?0:(Math.floor(Math.abs(i)/t.length)+1)*t.length;var s=t[(i-1)%t.length],a=t[i%t.length],l=t[(i+1)%t.length],c=t[(i+2)%t.length],u=new r.Vector3;return u.x=r.Curve.Utils.interpolate(s.x,a.x,l.x,c.x,o),u.y=r.Curve.Utils.interpolate(s.y,a.y,l.y,c.y,o),u.z=r.Curve.Utils.interpolate(s.z,a.z,l.z,c.z,o),u}),r.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){r.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){r.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){r.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(e){if(e.initialized===!0)return e;for(var t=0;t<e.hierarchy.length;t++){for(var n=0;n<e.hierarchy[t].keys.length;n++)if(e.hierarchy[t].keys[n].time<0&&(e.hierarchy[t].keys[n].time=0),void 0!==e.hierarchy[t].keys[n].rot&&!(e.hierarchy[t].keys[n].rot instanceof r.Quaternion)){var i=e.hierarchy[t].keys[n].rot;e.hierarchy[t].keys[n].rot=(new r.Quaternion).fromArray(i)}if(e.hierarchy[t].keys.length&&void 0!==e.hierarchy[t].keys[0].morphTargets){for(var o={},n=0;n<e.hierarchy[t].keys.length;n++)for(var s=0;s<e.hierarchy[t].keys[n].morphTargets.length;s++){var a=e.hierarchy[t].keys[n].morphTargets[s];o[a]=-1}e.hierarchy[t].usedMorphTargets=o;for(var n=0;n<e.hierarchy[t].keys.length;n++){var l={};for(var a in o){for(var s=0;s<e.hierarchy[t].keys[n].morphTargets.length;s++)if(e.hierarchy[t].keys[n].morphTargets[s]===a){l[a]=e.hierarchy[t].keys[n].morphTargetsInfluences[s];break}s===e.hierarchy[t].keys[n].morphTargets.length&&(l[a]=0)}e.hierarchy[t].keys[n].morphTargetsInfluences=l}}for(var n=1;n<e.hierarchy[t].keys.length;n++)e.hierarchy[t].keys[n].time===e.hierarchy[t].keys[n-1].time&&(e.hierarchy[t].keys.splice(n,1),n--);for(var n=0;n<e.hierarchy[t].keys.length;n++)e.hierarchy[t].keys[n].index=n}return e.initialized=!0,e},parse:function(e){var t=function o(e,t){t.push(e);for(var r=0;r<e.children.length;r++)o(e.children[r],t)},n=[];if(e instanceof r.SkinnedMesh)for(var i=0;i<e.skeleton.bones.length;i++)n.push(e.skeleton.bones[i]);else t(e,n);return n},play:function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},stop:function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},update:function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].resetBlendWeights();for(var t=0;t<this.animations.length;t++)this.animations[t].update(e)}},r.Animation=function(e,t){this.root=e,this.data=r.AnimationHandler.init(t),this.hierarchy=r.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=r.AnimationHandler.LINEAR},r.Animation.prototype={constructor:r.Animation,keyTypes:["pos","rot","scl"],play:function(e,t){this.currentTime=void 0!==e?e:0,this.weight=void 0!==t?t:1,this.isPlaying=!0,this.reset(),r.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,r.AnimationHandler.stop(this)},reset:function(){for(var e=0,t=this.hierarchy.length;t>e;e++){var r=this.hierarchy[e];void 0===r.animationCache&&(r.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});var n=this.data.name,i=r.animationCache.animations,o=i[n];void 0===o&&(o={prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:r.matrix},i[n]=o);for(var s=0;3>s;s++){for(var a=this.keyTypes[s],l=this.data.hierarchy[e].keys[0],c=this.getNextKeyWith(a,e,1);c.time<this.currentTime&&c.index>l.index;)l=c,c=this.getNextKeyWith(a,e,c.index+1);o.prevKey[a]=l,o.nextKey[a]=c}}},resetBlendWeights:function(){for(var e=0,t=this.hierarchy.length;t>e;e++){var r=this.hierarchy[e],n=r.animationCache;if(void 0!==n){var i=n.blending;i.positionWeight=0,i.quaternionWeight=0,i.scaleWeight=0}}},update:function(){var e=[],t=new r.Vector3,n=new r.Vector3,i=new r.Quaternion,o=function(e,t){var r,n,i,o,a,l,c,u,d,h=[],f=[];return r=(e.length-1)*t,n=Math.floor(r),i=r-n,h[0]=0===n?n:n-1,h[1]=n,h[2]=n>e.length-2?n:n+1,h[3]=n>e.length-3?n:n+2,l=e[h[0]],c=e[h[1]],u=e[h[2]],d=e[h[3]],o=i*i,a=i*o,f[0]=s(l[0],c[0],u[0],d[0],i,o,a),f[1]=s(l[1],c[1],u[1],d[1],i,o,a),f[2]=s(l[2],c[2],u[2],d[2],i,o,a),f},s=function(e,t,r,n,i,o,s){var a=.5*(r-e),l=.5*(n-t);return(2*(t-r)+a+l)*s+(-3*(t-r)-2*a-l)*o+a*i+t};return function(s){if(this.isPlaying!==!1&&(this.currentTime+=s*this.timeScale,0!==this.weight)){var a=this.data.length;(this.currentTime>a||this.currentTime<0)&&(this.loop?(this.currentTime%=a,this.currentTime<0&&(this.currentTime+=a),this.reset()):this.stop());for(var l=0,c=this.hierarchy.length;c>l;l++)for(var u=this.hierarchy[l],d=u.animationCache.animations[this.data.name],h=u.animationCache.blending,f=0;3>f;f++){var p=this.keyTypes[f],m=d.prevKey[p],g=d.nextKey[p];if(this.timeScale>0&&g.time<=this.currentTime||this.timeScale<0&&m.time>=this.currentTime){for(m=this.data.hierarchy[l].keys[0],g=this.getNextKeyWith(p,l,1);g.time<this.currentTime&&g.index>m.index;)m=g,g=this.getNextKeyWith(p,l,g.index+1);d.prevKey[p]=m,d.nextKey[p]=g}var v=(this.currentTime-m.time)/(g.time-m.time),y=m[p],_=g[p];if(0>v&&(v=0),v>1&&(v=1),"pos"===p){if(this.interpolationType===r.AnimationHandler.LINEAR){n.x=y[0]+(_[0]-y[0])*v,n.y=y[1]+(_[1]-y[1])*v,n.z=y[2]+(_[2]-y[2])*v;var b=this.weight/(this.weight+h.positionWeight);u.position.lerp(n,b),h.positionWeight+=this.weight}else if(this.interpolationType===r.AnimationHandler.CATMULLROM||this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD){e[0]=this.getPrevKeyWith("pos",l,m.index-1).pos,e[1]=y,e[2]=_,e[3]=this.getNextKeyWith("pos",l,g.index+1).pos,v=.33*v+.33;var x=o(e,v),b=this.weight/(this.weight+h.positionWeight);h.positionWeight+=this.weight;var w=u.position;if(w.x=w.x+(x[0]-w.x)*b,w.y=w.y+(x[1]-w.y)*b,w.z=w.z+(x[2]-w.z)*b,this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD){var E=o(e,1.01*v);t.set(E[0],E[1],E[2]),t.sub(w),t.y=0,t.normalize();var S=Math.atan2(t.x,t.z);u.rotation.set(0,S,0)}}}else if("rot"===p)if(r.Quaternion.slerp(y,_,i,v),0===h.quaternionWeight)u.quaternion.copy(i),h.quaternionWeight=this.weight;else{var b=this.weight/(this.weight+h.quaternionWeight);r.Quaternion.slerp(u.quaternion,i,u.quaternion,b),h.quaternionWeight+=this.weight}else if("scl"===p){n.x=y[0]+(_[0]-y[0])*v,n.y=y[1]+(_[1]-y[1])*v,n.z=y[2]+(_[2]-y[2])*v;var b=this.weight/(this.weight+h.scaleWeight);u.scale.lerp(n,b),h.scaleWeight+=this.weight}}return!0}}}(),getNextKeyWith:function(e,t,n){var i=this.data.hierarchy[t].keys;for(this.interpolationType===r.AnimationHandler.CATMULLROM||this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD?n=n<i.length-1?n:i.length-1:n%=i.length;n<i.length;n++)if(void 0!==i[n][e])return i[n];return this.data.hierarchy[t].keys[0]},getPrevKeyWith:function(e,t,n){var i=this.data.hierarchy[t].keys;for(n=this.interpolationType===r.AnimationHandler.CATMULLROM||this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD?n>0?n:0:n>=0?n:n+i.length;n>=0;n--)if(void 0!==i[n][e])return i[n];return this.data.hierarchy[t].keys[i.length-1]}},r.KeyFrameAnimation=function(e){this.root=e.node,this.data=r.AnimationHandler.init(e),this.hierarchy=r.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(var t=0,n=this.hierarchy.length;n>t;t++){var i=this.data.hierarchy[t].keys,o=this.data.hierarchy[t].sids,s=this.hierarchy[t];if(i.length&&o){for(var a=0;a<o.length;a++){var l=o[a],c=this.getNextKeyWith(l,t,0);c&&c.apply(l)}s.matrixAutoUpdate=!1,this.data.hierarchy[t].node.updateMatrix(),s.matrixWorldNeedsUpdate=!0}}},r.KeyFrameAnimation.prototype={constructor:r.KeyFrameAnimation,play:function(e){if(this.currentTime=void 0!==e?e:0,this.isPlaying===!1){this.isPlaying=!0;var t,n,i,o=this.hierarchy.length;for(t=0;o>t;t++){n=this.hierarchy[t],i=this.data.hierarchy[t],void 0===i.animationCache&&(i.animationCache={},i.animationCache.prevKey=null,i.animationCache.nextKey=null,i.animationCache.originalMatrix=n.matrix);var s=this.data.hierarchy[t].keys;s.length&&(i.animationCache.prevKey=s[0],i.animationCache.nextKey=s[1],this.startTime=Math.min(s[0].time,this.startTime),this.endTime=Math.max(s[s.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,r.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,this.isPaused=!1,r.AnimationHandler.stop(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e],n=this.data.hierarchy[e];if(void 0!==n.animationCache){var i=n.animationCache.originalMatrix;i.copy(t.matrix),t.matrix=i,delete n.animationCache}}},update:function(e){if(this.isPlaying!==!1){this.currentTime+=e*this.timeScale;var t=this.data.length;this.loop===!0&&this.currentTime>t&&(this.currentTime%=t),this.currentTime=Math.min(this.currentTime,t);for(var r=0,n=this.hierarchy.length;n>r;r++){var i=this.hierarchy[r],o=this.data.hierarchy[r],s=o.keys,a=o.animationCache;if(s.length){var l=a.prevKey,c=a.nextKey;if(c.time<=this.currentTime){for(;c.time<this.currentTime&&c.index>l.index;)l=c,c=s[l.index+1];a.prevKey=l,a.nextKey=c}c.time>=this.currentTime?l.interpolate(c,this.currentTime):l.interpolate(c,c.time),this.data.hierarchy[r].node.updateMatrix(),i.matrixWorldNeedsUpdate=!0}}}},getNextKeyWith:function(e,t,r){var n=this.data.hierarchy[t].keys;for(r%=n.length;r<n.length;r++)if(n[r].hasTarget(e))return n[r];return n[0]},getPrevKeyWith:function(e,t,r){var n=this.data.hierarchy[t].keys;for(r=r>=0?r:r+n.length;r>=0;r--)if(n[r].hasTarget(e))return n[r];return n[n.length-1]}},r.MorphAnimation=function(e){this.mesh=e,this.frames=e.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.lastFrame=0,this.currentFrame=0,this.isPlaying=!1},r.MorphAnimation.prototype={constructor:r.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(e){if(this.isPlaying!==!1){this.currentTime+=e,this.loop===!0&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var t=this.duration/this.frames,r=Math.floor(this.currentTime/t),n=this.mesh.morphTargetInfluences;r!=this.currentFrame&&(n[this.lastFrame]=0,n[this.currentFrame]=1,n[r]=0,this.lastFrame=this.currentFrame,this.currentFrame=r),n[r]=this.currentTime%t/t,n[this.lastFrame]=1-n[r]}}},r.BoxGeometry=function(e,t,n,i,o,s){function a(e,t,n,i,o,s,a,c){var u,d,h,f=l.widthSegments,p=l.heightSegments,m=o/2,g=s/2,v=l.vertices.length;"x"===e&&"y"===t||"y"===e&&"x"===t?u="z":"x"===e&&"z"===t||"z"===e&&"x"===t?(u="y",p=l.depthSegments):("z"===e&&"y"===t||"y"===e&&"z"===t)&&(u="x",f=l.depthSegments);var y=f+1,_=p+1,b=o/f,x=s/p,w=new r.Vector3;for(w[u]=a>0?1:-1,h=0;_>h;h++)for(d=0;y>d;d++){var E=new r.Vector3;E[e]=(d*b-m)*n,E[t]=(h*x-g)*i,E[u]=a,l.vertices.push(E)}for(h=0;p>h;h++)for(d=0;f>d;d++){var S=d+y*h,A=d+y*(h+1),M=d+1+y*(h+1),T=d+1+y*h,C=new r.Vector2(d/f,1-h/p),j=new r.Vector2(d/f,1-(h+1)/p),P=new r.Vector2((d+1)/f,1-(h+1)/p),L=new r.Vector2((d+1)/f,1-h/p),D=new r.Face3(S+v,A+v,T+v);D.normal.copy(w),D.vertexNormals.push(w.clone(),w.clone(),w.clone()),D.materialIndex=c,l.faces.push(D),l.faceVertexUvs[0].push([C,j,L]),D=new r.Face3(A+v,M+v,T+v),D.normal.copy(w),D.vertexNormals.push(w.clone(),w.clone(),w.clone()),D.materialIndex=c,l.faces.push(D),l.faceVertexUvs[0].push([j.clone(),P,L.clone()])}}r.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:o,depthSegments:s},this.widthSegments=i||1,this.heightSegments=o||1,this.depthSegments=s||1;var l=this,c=e/2,u=t/2,d=n/2;a("z","y",-1,-1,n,t,c,0),a("z","y",1,-1,n,t,-c,1),a("x","z",1,1,e,n,u,2),a("x","z",1,-1,e,n,-u,3),a("x","y",1,-1,e,t,d,4),a("x","y",-1,-1,e,t,-d,5),this.mergeVertices()},r.BoxGeometry.prototype=Object.create(r.Geometry.prototype),r.BoxGeometry.prototype.constructor=r.BoxGeometry,r.CircleGeometry=function(e,t,n,i){r.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||50,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var o,s=[],a=new r.Vector3,l=new r.Vector2(.5,.5);for(this.vertices.push(a),s.push(l),o=0;t>=o;o++){var c=new r.Vector3,u=n+o/t*i;c.x=e*Math.cos(u),c.y=e*Math.sin(u),this.vertices.push(c),s.push(new r.Vector2((c.x/e+1)/2,(c.y/e+1)/2))}var d=new r.Vector3(0,0,1);for(o=1;t>=o;o++)this.faces.push(new r.Face3(o,o+1,0,[d.clone(),d.clone(),d.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[o+1].clone(),l.clone()]);this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,e)},r.CircleGeometry.prototype=Object.create(r.Geometry.prototype),r.CircleGeometry.prototype.constructor=r.CircleGeometry,r.CubeGeometry=function(e,t,n,i,o,s){return r.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry."),new r.BoxGeometry(e,t,n,i,o,s)},r.CylinderGeometry=function(e,t,n,i,o,s,a,l){r.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:o,openEnded:s,thetaStart:a,thetaLength:l},e=void 0!==e?e:20,t=void 0!==t?t:20,n=void 0!==n?n:100,i=i||8,o=o||1,s=void 0!==s?s:!1,a=void 0!==a?a:0,l=void 0!==l?l:2*Math.PI;var c,u,d=n/2,h=[],f=[];for(u=0;o>=u;u++){var p=[],m=[],g=u/o,v=g*(t-e)+e;for(c=0;i>=c;c++){var y=c/i,_=new r.Vector3;_.x=v*Math.sin(y*l+a),_.y=-g*n+d,_.z=v*Math.cos(y*l+a),this.vertices.push(_),p.push(this.vertices.length-1),m.push(new r.Vector2(y,1-g))}h.push(p),f.push(m)}var b,x,w=(t-e)/n;for(c=0;i>c;c++)for(0!==e?(b=this.vertices[h[0][c]].clone(),x=this.vertices[h[0][c+1]].clone()):(b=this.vertices[h[1][c]].clone(),x=this.vertices[h[1][c+1]].clone()),b.setY(Math.sqrt(b.x*b.x+b.z*b.z)*w).normalize(),x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*w).normalize(),u=0;o>u;u++){var E=h[u][c],S=h[u+1][c],A=h[u+1][c+1],M=h[u][c+1],T=b.clone(),C=b.clone(),j=x.clone(),P=x.clone(),L=f[u][c].clone(),D=f[u+1][c].clone(),I=f[u+1][c+1].clone(),R=f[u][c+1].clone();this.faces.push(new r.Face3(E,S,M,[T,C,P])),this.faceVertexUvs[0].push([L,D,R]),this.faces.push(new r.Face3(S,A,M,[C.clone(),j,P.clone()])),this.faceVertexUvs[0].push([D.clone(),I,R.clone()])}if(s===!1&&e>0)for(this.vertices.push(new r.Vector3(0,d,0)),c=0;i>c;c++){var E=h[0][c],S=h[0][c+1],A=this.vertices.length-1,T=new r.Vector3(0,1,0),C=new r.Vector3(0,1,0),j=new r.Vector3(0,1,0),L=f[0][c].clone(),D=f[0][c+1].clone(),I=new r.Vector2(D.x,0);this.faces.push(new r.Face3(E,S,A,[T,C,j])),this.faceVertexUvs[0].push([L,D,I])}if(s===!1&&t>0)for(this.vertices.push(new r.Vector3(0,-d,0)),c=0;i>c;c++){var E=h[o][c+1],S=h[o][c],A=this.vertices.length-1,T=new r.Vector3(0,-1,0),C=new r.Vector3(0,-1,0),j=new r.Vector3(0,-1,0),L=f[o][c+1].clone(),D=f[o][c].clone(),I=new r.Vector2(D.x,1);this.faces.push(new r.Face3(E,S,A,[T,C,j])),this.faceVertexUvs[0].push([L,D,I])}this.computeFaceNormals()},r.CylinderGeometry.prototype=Object.create(r.Geometry.prototype),r.CylinderGeometry.prototype.constructor=r.CylinderGeometry,r.ExtrudeGeometry=function(e,t){return"undefined"==typeof e?void(e=[]):(r.Geometry.call(this),this.type="ExtrudeGeometry",e=e instanceof Array?e:[e],this.addShapeList(e,t),void this.computeFaceNormals())},r.ExtrudeGeometry.prototype=Object.create(r.Geometry.prototype),r.ExtrudeGeometry.prototype.constructor=r.ExtrudeGeometry,r.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var r=e.length,n=0;r>n;n++){var i=e[n];this.addShape(i,t)}},r.ExtrudeGeometry.prototype.addShape=function(e,t){function n(e,t,n){return t||r.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}function i(e,t,n){var i,o,s=1e-10,a=1,l=e.x-t.x,c=e.y-t.y,u=n.x-e.x,d=n.y-e.y,h=l*l+c*c,f=l*d-c*u;if(Math.abs(f)>s){var p=Math.sqrt(h),m=Math.sqrt(u*u+d*d),g=t.x-c/p,v=t.y+l/p,y=n.x-d/m,_=n.y+u/m,b=((y-g)*d-(_-v)*u)/(l*d-c*u);i=g+l*b-e.x,o=v+c*b-e.y;var x=i*i+o*o;if(2>=x)return new r.Vector2(i,o);a=Math.sqrt(x/2)}else{var w=!1;l>s?u>s&&(w=!0):-s>l?-s>u&&(w=!0):Math.sign(c)==Math.sign(d)&&(w=!0),w?(i=-c,o=l,a=Math.sqrt(h)):(i=l,o=c,a=Math.sqrt(h/2))}return new r.Vector2(i/a,o/a)}function o(){if(b){var e=0,t=W*e;for(Y=0;q>Y;Y++)H=N[Y],c(H[2]+t,H[1]+t,H[0]+t);for(e=w+2*_,t=W*e,Y=0;q>Y;Y++)H=N[Y],c(H[0]+t,H[1]+t,H[2]+t)}else{for(Y=0;q>Y;Y++)H=N[Y],c(H[2],H[1],H[0]);for(Y=0;q>Y;Y++)H=N[Y],c(H[0]+W*w,H[1]+W*w,H[2]+W*w)}}function s(){var e=0;for(a(F,e),e+=F.length,j=0,P=O.length;P>j;j++)C=O[j],a(C,e),e+=C.length}function a(e,t){var r,n;for(Y=e.length;--Y>=0;){r=Y,n=Y-1,0>n&&(n=e.length-1);var i=0,o=w+2*_;for(i=0;o>i;i++){var s=W*i,a=W*(i+1),l=t+r+s,c=t+n+s,d=t+n+a,h=t+r+a;u(l,c,d,h,e,i,o,r,n)}}}function l(e,t,n){L.vertices.push(new r.Vector3(e,t,n))}function c(e,t,n){e+=D,t+=D,n+=D,L.faces.push(new r.Face3(e,t,n,null,null,A));var i=T.generateTopUV(L,e,t,n);L.faceVertexUvs[0].push(i)}function u(e,t,n,i,o,s,a,l,c){e+=D,t+=D,n+=D,i+=D,L.faces.push(new r.Face3(e,t,i,null,null,M)),L.faces.push(new r.Face3(t,n,i,null,null,M));var u=T.generateSideWallUV(L,e,t,n,i);L.faceVertexUvs[0].push([u[0],u[1],u[3]]),L.faceVertexUvs[0].push([u[1],u[2],u[3]])}var d,h,f,p,m,g=void 0!==t.amount?t.amount:100,v=void 0!==t.bevelThickness?t.bevelThickness:6,y=void 0!==t.bevelSize?t.bevelSize:v-2,_=void 0!==t.bevelSegments?t.bevelSegments:3,b=void 0!==t.bevelEnabled?t.bevelEnabled:!0,x=void 0!==t.curveSegments?t.curveSegments:12,w=void 0!==t.steps?t.steps:1,E=t.extrudePath,S=!1,A=t.material,M=t.extrudeMaterial,T=void 0!==t.UVGenerator?t.UVGenerator:r.ExtrudeGeometry.WorldUVGenerator;E&&(d=E.getSpacedPoints(w),S=!0,b=!1,h=void 0!==t.frames?t.frames:new r.TubeGeometry.FrenetFrames(E,w,!1),f=new r.Vector3,p=new r.Vector3,m=new r.Vector3),b||(_=0,v=0,y=0);var C,j,P,L=this,D=this.vertices.length,I=e.extractPoints(x),R=I.shape,O=I.holes,k=!r.Shape.Utils.isClockWise(R);if(k){for(R=R.reverse(),j=0,P=O.length;P>j;j++)C=O[j],r.Shape.Utils.isClockWise(C)&&(O[j]=C.reverse());k=!1}var N=r.Shape.Utils.triangulateShape(R,O),F=R;for(j=0,P=O.length;P>j;j++)C=O[j],R=R.concat(C);for(var V,U,B,z,G,H,W=R.length,q=N.length,X=[],Y=0,K=F.length,Q=K-1,Z=Y+1;K>Y;Y++,Q++,Z++)Q===K&&(Q=0),Z===K&&(Z=0),X[Y]=i(F[Y],F[Q],F[Z]);var J,$=[],ee=X.concat();for(j=0,P=O.length;P>j;j++){for(C=O[j],J=[],Y=0,K=C.length,Q=K-1,Z=Y+1;K>Y;Y++,Q++,Z++)Q===K&&(Q=0),Z===K&&(Z=0),J[Y]=i(C[Y],C[Q],C[Z]);$.push(J),ee=ee.concat(J)}for(V=0;_>V;V++){for(B=V/_,z=v*(1-B),U=y*Math.sin(B*Math.PI/2),Y=0,K=F.length;K>Y;Y++)G=n(F[Y],X[Y],U),l(G.x,G.y,-z);for(j=0,P=O.length;P>j;j++)for(C=O[j],J=$[j],Y=0,K=C.length;K>Y;Y++)G=n(C[Y],J[Y],U),l(G.x,G.y,-z)}for(U=y,Y=0;W>Y;Y++)G=b?n(R[Y],ee[Y],U):R[Y],S?(p.copy(h.normals[0]).multiplyScalar(G.x),f.copy(h.binormals[0]).multiplyScalar(G.y),m.copy(d[0]).add(p).add(f),l(m.x,m.y,m.z)):l(G.x,G.y,0);var te;for(te=1;w>=te;te++)for(Y=0;W>Y;Y++)G=b?n(R[Y],ee[Y],U):R[Y],S?(p.copy(h.normals[te]).multiplyScalar(G.x),f.copy(h.binormals[te]).multiplyScalar(G.y),m.copy(d[te]).add(p).add(f),l(m.x,m.y,m.z)):l(G.x,G.y,g/w*te);for(V=_-1;V>=0;V--){for(B=V/_,z=v*(1-B),U=y*Math.sin(B*Math.PI/2),Y=0,K=F.length;K>Y;Y++)G=n(F[Y],X[Y],U),l(G.x,G.y,g+z);for(j=0,P=O.length;P>j;j++)for(C=O[j],J=$[j],Y=0,K=C.length;K>Y;Y++)G=n(C[Y],J[Y],U),S?l(G.x,G.y+d[w-1].y,d[w-1].x+z):l(G.x,G.y,g+z)}o(),s()},r.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,n,i){var o=e.vertices,s=o[t],a=o[n],l=o[i];return[new r.Vector2(s.x,s.y),new r.Vector2(a.x,a.y),new r.Vector2(l.x,l.y)]},generateSideWallUV:function(e,t,n,i,o){var s=e.vertices,a=s[t],l=s[n],c=s[i],u=s[o];return Math.abs(a.y-l.y)<.01?[new r.Vector2(a.x,1-a.z),new r.Vector2(l.x,1-l.z),new r.Vector2(c.x,1-c.z),new r.Vector2(u.x,1-u.z)]:[new r.Vector2(a.y,1-a.z),new r.Vector2(l.y,1-l.z),new r.Vector2(c.y,1-c.z),new r.Vector2(u.y,1-u.z)]}},r.ShapeGeometry=function(e,t){r.Geometry.call(this),this.type="ShapeGeometry",e instanceof Array==!1&&(e=[e]),this.addShapeList(e,t),this.computeFaceNormals()},r.ShapeGeometry.prototype=Object.create(r.Geometry.prototype),r.ShapeGeometry.prototype.constructor=r.ShapeGeometry,r.ShapeGeometry.prototype.addShapeList=function(e,t){for(var r=0,n=e.length;n>r;r++)this.addShape(e[r],t);return this},r.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var n,i,o,s=void 0!==t.curveSegments?t.curveSegments:12,a=t.material,l=void 0===t.UVGenerator?r.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,c=this.vertices.length,u=e.extractPoints(s),d=u.shape,h=u.holes,f=!r.Shape.Utils.isClockWise(d);if(f){for(d=d.reverse(),n=0,i=h.length;i>n;n++)o=h[n],r.Shape.Utils.isClockWise(o)&&(h[n]=o.reverse());f=!1}var p=r.Shape.Utils.triangulateShape(d,h);for(n=0,i=h.length;i>n;n++)o=h[n],d=d.concat(o);var m,g,v=d.length,y=p.length;for(n=0;v>n;n++)m=d[n],this.vertices.push(new r.Vector3(m.x,m.y,0));for(n=0;y>n;n++){g=p[n];var _=g[0]+c,b=g[1]+c,x=g[2]+c;this.faces.push(new r.Face3(_,b,x,null,null,a)),this.faceVertexUvs[0].push(l.generateTopUV(this,_,b,x))}},r.LatheGeometry=function(e,t,n,i){r.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=t||12,n=n||0,i=i||2*Math.PI;for(var o=1/(e.length-1),s=1/t,a=0,l=t;l>=a;a++)for(var c=n+a*s*i,u=Math.cos(c),d=Math.sin(c),h=0,f=e.length;f>h;h++){var p=e[h],m=new r.Vector3;m.x=u*p.x-d*p.y,m.y=d*p.x+u*p.y,m.z=p.z,this.vertices.push(m)}for(var g=e.length,a=0,l=t;l>a;a++)for(var h=0,f=e.length-1;f>h;h++){var v=h+g*a,y=v,_=v+g,u=v+1+g,b=v+1,x=a*s,w=h*o,E=x+s,S=w+o;this.faces.push(new r.Face3(y,_,b)),this.faceVertexUvs[0].push([new r.Vector2(x,w),new r.Vector2(E,w),new r.Vector2(x,S)]),this.faces.push(new r.Face3(_,u,b)),this.faceVertexUvs[0].push([new r.Vector2(E,w),new r.Vector2(E,S),new r.Vector2(x,S)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},r.LatheGeometry.prototype=Object.create(r.Geometry.prototype),r.LatheGeometry.prototype.constructor=r.LatheGeometry,r.PlaneGeometry=function(e,t,n,i){r.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new r.PlaneBufferGeometry(e,t,n,i))},r.PlaneGeometry.prototype=Object.create(r.Geometry.prototype),r.PlaneGeometry.prototype.constructor=r.PlaneGeometry,r.PlaneBufferGeometry=function(e,t,n,i){r.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};for(var o=e/2,s=t/2,a=n||1,l=i||1,c=a+1,u=l+1,d=e/a,h=t/l,f=new Float32Array(c*u*3),p=new Float32Array(c*u*3),m=new Float32Array(c*u*2),g=0,v=0,y=0;u>y;y++)for(var _=y*h-s,b=0;c>b;b++){var x=b*d-o;f[g]=x,f[g+1]=-_,p[g+2]=1,m[v]=b/a,m[v+1]=1-y/l,g+=3,v+=2}g=0;for(var w=new(f.length/3>65535?Uint32Array:Uint16Array)(a*l*6),y=0;l>y;y++)for(var b=0;a>b;b++){var E=b+c*y,S=b+c*(y+1),A=b+1+c*(y+1),M=b+1+c*y;w[g]=E,w[g+1]=S,w[g+2]=M,w[g+3]=S,w[g+4]=A,w[g+5]=M,g+=6}this.addAttribute("index",new r.BufferAttribute(w,1)),this.addAttribute("position",new r.BufferAttribute(f,3)),this.addAttribute("normal",new r.BufferAttribute(p,3)),this.addAttribute("uv",new r.BufferAttribute(m,2))},r.PlaneBufferGeometry.prototype=Object.create(r.BufferGeometry.prototype),r.PlaneBufferGeometry.prototype.constructor=r.PlaneBufferGeometry,r.RingGeometry=function(e,t,n,i,o,s){r.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:o,thetaLength:s},e=e||0,t=t||50,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI,n=void 0!==n?Math.max(3,n):8,i=void 0!==i?Math.max(1,i):8;var a,l,c=[],u=e,d=(t-e)/i;for(a=0;i+1>a;a++){for(l=0;n+1>l;l++){var h=new r.Vector3,f=o+l/n*s;h.x=u*Math.cos(f),h.y=u*Math.sin(f),this.vertices.push(h),c.push(new r.Vector2((h.x/t+1)/2,(h.y/t+1)/2))}u+=d}var p=new r.Vector3(0,0,1);for(a=0;i>a;a++){var m=a*(n+1);for(l=0;n>l;l++){var f=l+m,g=f,v=f+n+1,y=f+n+2;this.faces.push(new r.Face3(g,v,y,[p.clone(),p.clone(),p.clone()])),this.faceVertexUvs[0].push([c[g].clone(),c[v].clone(),c[y].clone()]),g=f,v=f+n+2,y=f+1,this.faces.push(new r.Face3(g,v,y,[p.clone(),p.clone(),p.clone()])),this.faceVertexUvs[0].push([c[g].clone(),c[v].clone(),c[y].clone()])}}this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,u)},r.RingGeometry.prototype=Object.create(r.Geometry.prototype),r.RingGeometry.prototype.constructor=r.RingGeometry,r.SphereGeometry=function(e,t,n,i,o,s,a){r.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:o,thetaStart:s,thetaLength:a},e=e||50,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,s=void 0!==s?s:0,a=void 0!==a?a:Math.PI;var l,c,u=[],d=[];for(c=0;n>=c;c++){var h=[],f=[];for(l=0;t>=l;l++){var p=l/t,m=c/n,g=new r.Vector3;g.x=-e*Math.cos(i+p*o)*Math.sin(s+m*a),g.y=e*Math.cos(s+m*a),g.z=e*Math.sin(i+p*o)*Math.sin(s+m*a),this.vertices.push(g),h.push(this.vertices.length-1),f.push(new r.Vector2(p,1-m))}u.push(h),d.push(f)}for(c=0;n>c;c++)for(l=0;t>l;l++){var v=u[c][l+1],y=u[c][l],_=u[c+1][l],b=u[c+1][l+1],x=this.vertices[v].clone().normalize(),w=this.vertices[y].clone().normalize(),E=this.vertices[_].clone().normalize(),S=this.vertices[b].clone().normalize(),A=d[c][l+1].clone(),M=d[c][l].clone(),T=d[c+1][l].clone(),C=d[c+1][l+1].clone();Math.abs(this.vertices[v].y)===e?(A.x=(A.x+M.x)/2,this.faces.push(new r.Face3(v,_,b,[x,E,S])),this.faceVertexUvs[0].push([A,T,C])):Math.abs(this.vertices[_].y)===e?(T.x=(T.x+C.x)/2,this.faces.push(new r.Face3(v,y,_,[x,w,E])),this.faceVertexUvs[0].push([A,M,T])):(this.faces.push(new r.Face3(v,y,b,[x,w,S])),this.faceVertexUvs[0].push([A,M,C]),this.faces.push(new r.Face3(y,_,b,[w.clone(),E,S.clone()])),this.faceVertexUvs[0].push([M.clone(),T,C.clone()]))}this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,e)},r.SphereGeometry.prototype=Object.create(r.Geometry.prototype),r.SphereGeometry.prototype.constructor=r.SphereGeometry,r.TextGeometry=function(e,t){t=t||{};var n=r.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),r.ExtrudeGeometry.call(this,n,t),this.type="TextGeometry"},r.TextGeometry.prototype=Object.create(r.ExtrudeGeometry.prototype),r.TextGeometry.prototype.constructor=r.TextGeometry,r.TorusGeometry=function(e,t,n,i,o){r.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:o},e=e||100,t=t||40,n=n||8,i=i||6,o=o||2*Math.PI;for(var s=new r.Vector3,a=[],l=[],c=0;n>=c;c++)for(var u=0;i>=u;u++){var d=u/i*o,h=c/n*Math.PI*2;s.x=e*Math.cos(d),s.y=e*Math.sin(d);var f=new r.Vector3;f.x=(e+t*Math.cos(h))*Math.cos(d),f.y=(e+t*Math.cos(h))*Math.sin(d),f.z=t*Math.sin(h),this.vertices.push(f),a.push(new r.Vector2(u/i,c/n)),l.push(f.clone().sub(s).normalize())}for(var c=1;n>=c;c++)for(var u=1;i>=u;u++){var p=(i+1)*c+u-1,m=(i+1)*(c-1)+u-1,g=(i+1)*(c-1)+u,v=(i+1)*c+u,y=new r.Face3(p,m,v,[l[p].clone(),l[m].clone(),l[v].clone()]);this.faces.push(y),this.faceVertexUvs[0].push([a[p].clone(),a[m].clone(),a[v].clone()]),y=new r.Face3(m,g,v,[l[m].clone(),l[g].clone(),l[v].clone()]),this.faces.push(y),this.faceVertexUvs[0].push([a[m].clone(),a[g].clone(),a[v].clone()])}this.computeFaceNormals()},r.TorusGeometry.prototype=Object.create(r.Geometry.prototype),r.TorusGeometry.prototype.constructor=r.TorusGeometry,r.TorusKnotGeometry=function(e,t,n,i,o,s,a){function l(e,t,n,i,o){var s=Math.cos(e),a=Math.sin(e),l=t/n*e,c=Math.cos(l),u=i*(2+c)*.5*s,d=i*(2+c)*a*.5,h=o*i*Math.sin(l)*.5;return new r.Vector3(u,d,h)}r.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,p:o,q:s,heightScale:a},e=e||100,t=t||40,n=n||64,i=i||8,o=o||2,s=s||3,a=a||1;for(var c=new Array(n),u=new r.Vector3,d=new r.Vector3,h=new r.Vector3,f=0;n>f;++f){c[f]=new Array(i);var p=f/n*2*o*Math.PI,m=l(p,s,o,e,a),g=l(p+.01,s,o,e,a);u.subVectors(g,m),d.addVectors(g,m),h.crossVectors(u,d),d.crossVectors(h,u),h.normalize(),d.normalize();for(var v=0;i>v;++v){var y=v/i*2*Math.PI,_=-t*Math.cos(y),b=t*Math.sin(y),x=new r.Vector3;x.x=m.x+_*d.x+b*h.x,x.y=m.y+_*d.y+b*h.y,x.z=m.z+_*d.z+b*h.z,c[f][v]=this.vertices.push(x)-1}}for(var f=0;n>f;++f)for(var v=0;i>v;++v){var w=(f+1)%n,E=(v+1)%i,S=c[f][v],A=c[w][v],M=c[w][E],T=c[f][E],C=new r.Vector2(f/n,v/i),j=new r.Vector2((f+1)/n,v/i),P=new r.Vector2((f+1)/n,(v+1)/i),L=new r.Vector2(f/n,(v+1)/i);this.faces.push(new r.Face3(S,A,T)),this.faceVertexUvs[0].push([C,j,L]),this.faces.push(new r.Face3(A,M,T)),this.faceVertexUvs[0].push([j.clone(),P,L.clone()])}this.computeFaceNormals(),this.computeVertexNormals()},r.TorusKnotGeometry.prototype=Object.create(r.Geometry.prototype),r.TorusKnotGeometry.prototype.constructor=r.TorusKnotGeometry,
r.TubeGeometry=function(e,t,n,i,o,s){function a(e,t,n){return P.vertices.push(new r.Vector3(e,t,n))-1}r.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:e,segments:t,radius:n,radialSegments:i,closed:o},t=t||64,n=n||1,i=i||8,o=o||!1,s=s||r.TubeGeometry.NoTaper;var l,c,u,d,h,f,p,m,g,v,y,_,b,x,w,E,S,A,M,T,C,j=[],P=this,L=t+1,D=new r.Vector3,I=new r.TubeGeometry.FrenetFrames(e,t,o),R=I.tangents,O=I.normals,k=I.binormals;for(this.tangents=R,this.normals=O,this.binormals=k,v=0;L>v;v++)for(j[v]=[],d=v/(L-1),g=e.getPointAt(d),l=R[v],c=O[v],u=k[v],f=n*s(d),y=0;i>y;y++)h=y/i*2*Math.PI,p=-f*Math.cos(h),m=f*Math.sin(h),D.copy(g),D.x+=p*c.x+m*u.x,D.y+=p*c.y+m*u.y,D.z+=p*c.z+m*u.z,j[v][y]=a(D.x,D.y,D.z);for(v=0;t>v;v++)for(y=0;i>y;y++)_=o?(v+1)%t:v+1,b=(y+1)%i,x=j[v][y],w=j[_][y],E=j[_][b],S=j[v][b],A=new r.Vector2(v/t,y/i),M=new r.Vector2((v+1)/t,y/i),T=new r.Vector2((v+1)/t,(y+1)/i),C=new r.Vector2(v/t,(y+1)/i),this.faces.push(new r.Face3(x,w,S)),this.faceVertexUvs[0].push([A,M,C]),this.faces.push(new r.Face3(w,E,S)),this.faceVertexUvs[0].push([M.clone(),T,C.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},r.TubeGeometry.prototype=Object.create(r.Geometry.prototype),r.TubeGeometry.prototype.constructor=r.TubeGeometry,r.TubeGeometry.NoTaper=function(e){return 1},r.TubeGeometry.SinusoidalTaper=function(e){return Math.sin(Math.PI*e)},r.TubeGeometry.FrenetFrames=function(e,t,n){function i(){p[0]=new r.Vector3,m[0]=new r.Vector3,s=Number.MAX_VALUE,a=Math.abs(f[0].x),l=Math.abs(f[0].y),c=Math.abs(f[0].z),s>=a&&(s=a,h.set(1,0,0)),s>=l&&(s=l,h.set(0,1,0)),s>=c&&h.set(0,0,1),g.crossVectors(f[0],h).normalize(),p[0].crossVectors(f[0],g),m[0].crossVectors(f[0],p[0])}var o,s,a,l,c,u,d,h=new r.Vector3,f=[],p=[],m=[],g=new r.Vector3,v=new r.Matrix4,y=t+1,_=1e-4;for(this.tangents=f,this.normals=p,this.binormals=m,u=0;y>u;u++)d=u/(y-1),f[u]=e.getTangentAt(d),f[u].normalize();for(i(),u=1;y>u;u++)p[u]=p[u-1].clone(),m[u]=m[u-1].clone(),g.crossVectors(f[u-1],f[u]),g.length()>_&&(g.normalize(),o=Math.acos(r.Math.clamp(f[u-1].dot(f[u]),-1,1)),p[u].applyMatrix4(v.makeRotationAxis(g,o))),m[u].crossVectors(f[u],p[u]);if(n)for(o=Math.acos(r.Math.clamp(p[0].dot(p[y-1]),-1,1)),o/=y-1,f[0].dot(g.crossVectors(p[0],p[y-1]))>0&&(o=-o),u=1;y>u;u++)p[u].applyMatrix4(v.makeRotationAxis(f[u],o*u)),m[u].crossVectors(f[u],p[u])},r.PolyhedronGeometry=function(e,t,n,i){function o(e){var t=e.normalize().clone();t.index=d.vertices.push(t)-1;var n=l(e)/2/Math.PI+.5,i=c(e)/Math.PI+.5;return t.uv=new r.Vector2(n,1-i),t}function s(e,t,n){var i=new r.Face3(e.index,t.index,n.index,[e.clone(),t.clone(),n.clone()]);d.faces.push(i),b.copy(e).add(t).add(n).divideScalar(3);var o=l(b);d.faceVertexUvs[0].push([u(e.uv,e,o),u(t.uv,t,o),u(n.uv,n,o)])}function a(e,t){for(var r=Math.pow(2,t),n=o(d.vertices[e.a]),i=o(d.vertices[e.b]),a=o(d.vertices[e.c]),l=[],c=0;r>=c;c++){l[c]=[];for(var u=o(n.clone().lerp(a,c/r)),h=o(i.clone().lerp(a,c/r)),f=r-c,p=0;f>=p;p++)0==p&&c==r?l[c][p]=u:l[c][p]=o(u.clone().lerp(h,p/f))}for(var c=0;r>c;c++)for(var p=0;2*(r-c)-1>p;p++){var m=Math.floor(p/2);p%2==0?s(l[c][m+1],l[c+1][m],l[c][m]):s(l[c][m+1],l[c+1][m+1],l[c+1][m])}}function l(e){return Math.atan2(e.z,-e.x)}function c(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}function u(e,t,n){return 0>n&&1===e.x&&(e=new r.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new r.Vector2(n/2/Math.PI+.5,e.y)),e.clone()}r.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},n=n||1,i=i||0;for(var d=this,h=0,f=e.length;f>h;h+=3)o(new r.Vector3(e[h],e[h+1],e[h+2]));for(var p=this.vertices,m=[],h=0,g=0,f=t.length;f>h;h+=3,g++){var v=p[t[h]],y=p[t[h+1]],_=p[t[h+2]];m[g]=new r.Face3(v.index,y.index,_.index,[v.clone(),y.clone(),_.clone()])}for(var b=new r.Vector3,h=0,f=m.length;f>h;h++)a(m[h],i);for(var h=0,f=this.faceVertexUvs[0].length;f>h;h++){var x=this.faceVertexUvs[0][h],w=x[0].x,E=x[1].x,S=x[2].x,A=Math.max(w,Math.max(E,S)),M=Math.min(w,Math.min(E,S));A>.9&&.1>M&&(.2>w&&(x[0].x+=1),.2>E&&(x[1].x+=1),.2>S&&(x[2].x+=1))}for(var h=0,f=this.vertices.length;f>h;h++)this.vertices[h].multiplyScalar(n);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,n)},r.PolyhedronGeometry.prototype=Object.create(r.Geometry.prototype),r.PolyhedronGeometry.prototype.constructor=r.PolyhedronGeometry,r.DodecahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};var n=(1+Math.sqrt(5))/2,i=1/n,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];r.PolyhedronGeometry.call(this,o,s,e,t)},r.DodecahedronGeometry.prototype=Object.create(r.Geometry.prototype),r.DodecahedronGeometry.prototype.constructor=r.DodecahedronGeometry,r.IcosahedronGeometry=function(e,t){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];r.PolyhedronGeometry.call(this,i,o,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}},r.IcosahedronGeometry.prototype=Object.create(r.Geometry.prototype),r.IcosahedronGeometry.prototype.constructor=r.IcosahedronGeometry,r.OctahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];r.PolyhedronGeometry.call(this,n,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}},r.OctahedronGeometry.prototype=Object.create(r.Geometry.prototype),r.OctahedronGeometry.prototype.constructor=r.OctahedronGeometry,r.TetrahedronGeometry=function(e,t){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];r.PolyhedronGeometry.call(this,n,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}},r.TetrahedronGeometry.prototype=Object.create(r.Geometry.prototype),r.TetrahedronGeometry.prototype.constructor=r.TetrahedronGeometry,r.ParametricGeometry=function(e,t,n){r.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};var i,o,s,a,l,c=this.vertices,u=this.faces,d=this.faceVertexUvs[0],h=t+1;for(i=0;n>=i;i++)for(l=i/n,o=0;t>=o;o++)a=o/t,s=e(a,l),c.push(s);var f,p,m,g,v,y,_,b;for(i=0;n>i;i++)for(o=0;t>o;o++)f=i*h+o,p=i*h+o+1,m=(i+1)*h+o+1,g=(i+1)*h+o,v=new r.Vector2(o/t,i/n),y=new r.Vector2((o+1)/t,i/n),_=new r.Vector2((o+1)/t,(i+1)/n),b=new r.Vector2(o/t,(i+1)/n),u.push(new r.Face3(f,p,g)),d.push([v,y,b]),u.push(new r.Face3(p,m,g)),d.push([y.clone(),_,b.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},r.ParametricGeometry.prototype=Object.create(r.Geometry.prototype),r.ParametricGeometry.prototype.constructor=r.ParametricGeometry,r.AxisHelper=function(e){e=e||1;var t=new Float32Array([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e]),n=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),i=new r.BufferGeometry;i.addAttribute("position",new r.BufferAttribute(t,3)),i.addAttribute("color",new r.BufferAttribute(n,3));var o=new r.LineBasicMaterial({vertexColors:r.VertexColors});r.Line.call(this,i,o,r.LinePieces)},r.AxisHelper.prototype=Object.create(r.Line.prototype),r.AxisHelper.prototype.constructor=r.AxisHelper,r.ArrowHelper=function(){var e=new r.Geometry;e.vertices.push(new r.Vector3(0,0,0),new r.Vector3(0,1,0));var t=new r.CylinderGeometry(0,.5,1,5,1);return t.applyMatrix((new r.Matrix4).makeTranslation(0,-.5,0)),function(n,i,o,s,a,l){r.Object3D.call(this),void 0===s&&(s=16776960),void 0===o&&(o=1),void 0===a&&(a=.2*o),void 0===l&&(l=.2*a),this.position.copy(i),this.line=new r.Line(e,new r.LineBasicMaterial({color:s})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new r.Mesh(t,new r.MeshBasicMaterial({color:s})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(n),this.setLength(o,a,l)}}(),r.ArrowHelper.prototype=Object.create(r.Object3D.prototype),r.ArrowHelper.prototype.constructor=r.ArrowHelper,r.ArrowHelper.prototype.setDirection=function(){var e,t=new r.Vector3;return function(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(r.z,0,-r.x).normalize(),e=Math.acos(r.y),this.quaternion.setFromAxisAngle(t,e))}}(),r.ArrowHelper.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,e-t,1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},r.ArrowHelper.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},r.BoxHelper=function(e){var t=new r.BufferGeometry;t.addAttribute("position",new r.BufferAttribute(new Float32Array(72),3)),r.Line.call(this,t,new r.LineBasicMaterial({color:16776960}),r.LinePieces),void 0!==e&&this.update(e)},r.BoxHelper.prototype=Object.create(r.Line.prototype),r.BoxHelper.prototype.constructor=r.BoxHelper,r.BoxHelper.prototype.update=function(e){var t=e.geometry;null===t.boundingBox&&t.computeBoundingBox();var r=t.boundingBox.min,n=t.boundingBox.max,i=this.geometry.attributes.position.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=r.x,i[4]=n.y,i[5]=n.z,i[6]=r.x,i[7]=n.y,i[8]=n.z,i[9]=r.x,i[10]=r.y,i[11]=n.z,i[12]=r.x,i[13]=r.y,i[14]=n.z,i[15]=n.x,i[16]=r.y,i[17]=n.z,i[18]=n.x,i[19]=r.y,i[20]=n.z,i[21]=n.x,i[22]=n.y,i[23]=n.z,i[24]=n.x,i[25]=n.y,i[26]=r.z,i[27]=r.x,i[28]=n.y,i[29]=r.z,i[30]=r.x,i[31]=n.y,i[32]=r.z,i[33]=r.x,i[34]=r.y,i[35]=r.z,i[36]=r.x,i[37]=r.y,i[38]=r.z,i[39]=n.x,i[40]=r.y,i[41]=r.z,i[42]=n.x,i[43]=r.y,i[44]=r.z,i[45]=n.x,i[46]=n.y,i[47]=r.z,i[48]=n.x,i[49]=n.y,i[50]=n.z,i[51]=n.x,i[52]=n.y,i[53]=r.z,i[54]=r.x,i[55]=n.y,i[56]=n.z,i[57]=r.x,i[58]=n.y,i[59]=r.z,i[60]=r.x,i[61]=r.y,i[62]=n.z,i[63]=r.x,i[64]=r.y,i[65]=r.z,i[66]=n.x,i[67]=r.y,i[68]=n.z,i[69]=n.x,i[70]=r.y,i[71]=r.z,this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},r.BoundingBoxHelper=function(e,t){var n=void 0!==t?t:8947848;this.object=e,this.box=new r.Box3,r.Mesh.call(this,new r.BoxGeometry(1,1,1),new r.MeshBasicMaterial({color:n,wireframe:!0}))},r.BoundingBoxHelper.prototype=Object.create(r.Mesh.prototype),r.BoundingBoxHelper.prototype.constructor=r.BoundingBoxHelper,r.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},r.CameraHelper=function(e){function t(e,t,r){n(e,r),n(t,r)}function n(e,t){i.vertices.push(new r.Vector3),i.colors.push(new r.Color(t)),void 0===s[e]&&(s[e]=[]),s[e].push(i.vertices.length-1)}var i=new r.Geometry,o=new r.LineBasicMaterial({color:16777215,vertexColors:r.FaceColors}),s={},a=16755200,l=16711680,c=43775,u=16777215,d=3355443;t("n1","n2",a),t("n2","n4",a),t("n4","n3",a),t("n3","n1",a),t("f1","f2",a),t("f2","f4",a),t("f4","f3",a),t("f3","f1",a),t("n1","f1",a),t("n2","f2",a),t("n3","f3",a),t("n4","f4",a),t("p","n1",l),t("p","n2",l),t("p","n3",l),t("p","n4",l),t("u1","u2",c),t("u2","u3",c),t("u3","u1",c),t("c","t",u),t("p","c",d),t("cn1","cn2",d),t("cn3","cn4",d),t("cf1","cf2",d),t("cf3","cf4",d),r.Line.call(this,i,o,r.LinePieces),this.camera=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()},r.CameraHelper.prototype=Object.create(r.Line.prototype),r.CameraHelper.prototype.constructor=r.CameraHelper,r.CameraHelper.prototype.update=function(){var e,t,n=new r.Vector3,i=new r.Camera,o=function(r,o,s,a){n.set(o,s,a).unproject(i);var l=t[r];if(void 0!==l)for(var c=0,u=l.length;u>c;c++)e.vertices[l[c]].copy(n)};return function(){e=this.geometry,t=this.pointMap;var r=1,n=1;i.projectionMatrix.copy(this.camera.projectionMatrix),o("c",0,0,-1),o("t",0,0,1),o("n1",-r,-n,-1),o("n2",r,-n,-1),o("n3",-r,n,-1),o("n4",r,n,-1),o("f1",-r,-n,1),o("f2",r,-n,1),o("f3",-r,n,1),o("f4",r,n,1),o("u1",.7*r,1.1*n,-1),o("u2",.7*-r,1.1*n,-1),o("u3",0,2*n,-1),o("cf1",-r,0,1),o("cf2",r,0,1),o("cf3",0,-n,1),o("cf4",0,n,1),o("cn1",-r,0,-1),o("cn2",r,0,-1),o("cn3",0,-n,-1),o("cn4",0,n,-1),e.verticesNeedUpdate=!0}}(),r.DirectionalLightHelper=function(e,t){r.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,t=t||1;var n=new r.Geometry;n.vertices.push(new r.Vector3(-t,t,0),new r.Vector3(t,t,0),new r.Vector3(t,-t,0),new r.Vector3(-t,-t,0),new r.Vector3(-t,t,0));var i=new r.LineBasicMaterial({fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new r.Line(n,i),this.add(this.lightPlane),n=new r.Geometry,n.vertices.push(new r.Vector3,new r.Vector3),i=new r.LineBasicMaterial({fog:!1}),i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new r.Line(n,i),this.add(this.targetLine),this.update()},r.DirectionalLightHelper.prototype=Object.create(r.Object3D.prototype),r.DirectionalLightHelper.prototype.constructor=r.DirectionalLightHelper,r.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},r.DirectionalLightHelper.prototype.update=function(){var e=new r.Vector3,t=new r.Vector3,n=new r.Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(n),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(n),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),r.EdgesHelper=function(e,t,n){var i=void 0!==t?t:16777215;n=void 0!==n?n:1;var o,s=Math.cos(r.Math.degToRad(n)),a=[0,0],l={},c=function(e,t){return e-t},u=["a","b","c"],d=new r.BufferGeometry;e.geometry instanceof r.BufferGeometry?(o=new r.Geometry,o.fromBufferGeometry(e.geometry)):o=e.geometry.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,f=o.faces,p=0,m=0,g=f.length;g>m;m++)for(var v=f[m],y=0;3>y;y++){a[0]=v[u[y]],a[1]=v[u[(y+1)%3]],a.sort(c);var _=a.toString();void 0===l[_]?(l[_]={vert1:a[0],vert2:a[1],face1:m,face2:void 0},p++):l[_].face2=m}var b=new Float32Array(2*p*3),x=0;for(var _ in l){var w=l[_];if(void 0===w.face2||f[w.face1].normal.dot(f[w.face2].normal)<=s){var E=h[w.vert1];b[x++]=E.x,b[x++]=E.y,b[x++]=E.z,E=h[w.vert2],b[x++]=E.x,b[x++]=E.y,b[x++]=E.z}}d.addAttribute("position",new r.BufferAttribute(b,3)),r.Line.call(this,d,new r.LineBasicMaterial({color:i}),r.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},r.EdgesHelper.prototype=Object.create(r.Line.prototype),r.EdgesHelper.prototype.constructor=r.EdgesHelper,r.FaceNormalsHelper=function(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;for(var o=void 0!==n?n:16776960,s=void 0!==i?i:1,a=new r.Geometry,l=this.object.geometry.faces,c=0,u=l.length;u>c;c++)a.vertices.push(new r.Vector3,new r.Vector3);r.Line.call(this,a,new r.LineBasicMaterial({color:o,linewidth:s}),r.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new r.Matrix3,this.update()},r.FaceNormalsHelper.prototype=Object.create(r.Line.prototype),r.FaceNormalsHelper.prototype.constructor=r.FaceNormalsHelper,r.FaceNormalsHelper.prototype.update=function(){var e=this.geometry.vertices,t=this.object,r=t.geometry.vertices,n=t.geometry.faces,i=t.matrixWorld;t.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(i);for(var o=0,s=0,a=n.length;a>o;o++,s+=2){var l=n[o];e[s].copy(r[l.a]).add(r[l.b]).add(r[l.c]).divideScalar(3).applyMatrix4(i),e[s+1].copy(l.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(e[s])}return this.geometry.verticesNeedUpdate=!0,this},r.GridHelper=function(e,t){var n=new r.Geometry,i=new r.LineBasicMaterial({vertexColors:r.VertexColors});this.color1=new r.Color(4473924),this.color2=new r.Color(8947848);for(var o=-e;e>=o;o+=t){n.vertices.push(new r.Vector3(-e,0,o),new r.Vector3(e,0,o),new r.Vector3(o,0,-e),new r.Vector3(o,0,e));var s=0===o?this.color1:this.color2;n.colors.push(s,s,s,s)}r.Line.call(this,n,i,r.LinePieces)},r.GridHelper.prototype=Object.create(r.Line.prototype),r.GridHelper.prototype.constructor=r.GridHelper,r.GridHelper.prototype.setColors=function(e,t){this.color1.set(e),this.color2.set(t),this.geometry.colorsNeedUpdate=!0},r.HemisphereLightHelper=function(e,t){r.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new r.Color,new r.Color];var n=new r.SphereGeometry(t,4,2);n.applyMatrix((new r.Matrix4).makeRotationX(-Math.PI/2));for(var i=0,o=8;o>i;i++)n.faces[i].color=this.colors[4>i?0:1];var s=new r.MeshBasicMaterial({vertexColors:r.FaceColors,wireframe:!0});this.lightSphere=new r.Mesh(n,s),this.add(this.lightSphere),this.update()},r.HemisphereLightHelper.prototype=Object.create(r.Object3D.prototype),r.HemisphereLightHelper.prototype.constructor=r.HemisphereLightHelper,r.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},r.HemisphereLightHelper.prototype.update=function(){var e=new r.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),r.PointLightHelper=function(e,t){this.light=e,this.light.updateMatrixWorld();var n=new r.SphereGeometry(t,4,2),i=new r.MeshBasicMaterial({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.Mesh.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},r.PointLightHelper.prototype=Object.create(r.Mesh.prototype),r.PointLightHelper.prototype.constructor=r.PointLightHelper,r.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},r.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},r.SkeletonHelper=function(e){this.bones=this.getBoneList(e);for(var t=new r.Geometry,n=0;n<this.bones.length;n++){var i=this.bones[n];i.parent instanceof r.Bone&&(t.vertices.push(new r.Vector3),t.vertices.push(new r.Vector3),t.colors.push(new r.Color(0,0,1)),t.colors.push(new r.Color(0,1,0)))}var o=new r.LineBasicMaterial({vertexColors:r.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});r.Line.call(this,t,o,r.LinePieces),this.root=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.update()},r.SkeletonHelper.prototype=Object.create(r.Line.prototype),r.SkeletonHelper.prototype.constructor=r.SkeletonHelper,r.SkeletonHelper.prototype.getBoneList=function(e){var t=[];e instanceof r.Bone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,this.getBoneList(e.children[n]));return t},r.SkeletonHelper.prototype.update=function(){for(var e=this.geometry,t=(new r.Matrix4).getInverse(this.root.matrixWorld),n=new r.Matrix4,i=0,o=0;o<this.bones.length;o++){var s=this.bones[o];s.parent instanceof r.Bone&&(n.multiplyMatrices(t,s.matrixWorld),e.vertices[i].setFromMatrixPosition(n),n.multiplyMatrices(t,s.parent.matrixWorld),e.vertices[i+1].setFromMatrixPosition(n),i+=2)}e.verticesNeedUpdate=!0,e.computeBoundingSphere()},r.SpotLightHelper=function(e){r.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var t=new r.CylinderGeometry(0,1,1,8,1,!0);t.applyMatrix((new r.Matrix4).makeTranslation(0,-.5,0)),t.applyMatrix((new r.Matrix4).makeRotationX(-Math.PI/2));var n=new r.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new r.Mesh(t,n),this.add(this.cone),this.update()},r.SpotLightHelper.prototype=Object.create(r.Object3D.prototype),r.SpotLightHelper.prototype.constructor=r.SpotLightHelper,r.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},r.SpotLightHelper.prototype.update=function(){var e=new r.Vector3,t=new r.Vector3;return function(){var r=this.light.distance?this.light.distance:1e4,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),r.VertexNormalsHelper=function(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;for(var o=void 0!==n?n:16711680,s=void 0!==i?i:1,a=new r.Geometry,l=e.geometry.faces,c=0,u=l.length;u>c;c++)for(var d=l[c],h=0,f=d.vertexNormals.length;f>h;h++)a.vertices.push(new r.Vector3,new r.Vector3);r.Line.call(this,a,new r.LineBasicMaterial({color:o,linewidth:s}),r.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new r.Matrix3,this.update()},r.VertexNormalsHelper.prototype=Object.create(r.Line.prototype),r.VertexNormalsHelper.prototype.constructor=r.VertexNormalsHelper,r.VertexNormalsHelper.prototype.update=function(e){var t=new r.Vector3;return function(e){var r=["a","b","c","d"];this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var n=this.geometry.vertices,i=this.object.geometry.vertices,o=this.object.geometry.faces,s=this.object.matrixWorld,a=0,l=0,c=o.length;c>l;l++)for(var u=o[l],d=0,h=u.vertexNormals.length;h>d;d++){var f=u[r[d]],p=i[f],m=u.vertexNormals[d];n[a].copy(p).applyMatrix4(s),t.copy(m).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),t.add(n[a]),a+=1,n[a].copy(t),a+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),r.VertexTangentsHelper=function(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;for(var o=void 0!==n?n:255,s=void 0!==i?i:1,a=new r.Geometry,l=e.geometry.faces,c=0,u=l.length;u>c;c++)for(var d=l[c],h=0,f=d.vertexTangents.length;f>h;h++)a.vertices.push(new r.Vector3),a.vertices.push(new r.Vector3);r.Line.call(this,a,new r.LineBasicMaterial({color:o,linewidth:s}),r.LinePieces),this.matrixAutoUpdate=!1,this.update()},r.VertexTangentsHelper.prototype=Object.create(r.Line.prototype),r.VertexTangentsHelper.prototype.constructor=r.VertexTangentsHelper,r.VertexTangentsHelper.prototype.update=function(e){var t=new r.Vector3;return function(e){var r=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var n=this.geometry.vertices,i=this.object.geometry.vertices,o=this.object.geometry.faces,s=this.object.matrixWorld,a=0,l=0,c=o.length;c>l;l++)for(var u=o[l],d=0,h=u.vertexTangents.length;h>d;d++){var f=u[r[d]],p=i[f],m=u.vertexTangents[d];n[a].copy(p).applyMatrix4(s),t.copy(m).transformDirection(s).multiplyScalar(this.size),t.add(n[a]),a+=1,n[a].copy(t),a+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),r.WireframeHelper=function(e,t){var n=void 0!==t?t:16777215,i=[0,0],o={},s=function(e,t){return e-t},a=["a","b","c"],l=new r.BufferGeometry;if(e.geometry instanceof r.Geometry){for(var c=e.geometry.vertices,u=e.geometry.faces,d=0,h=new Uint32Array(6*u.length),f=0,p=u.length;p>f;f++)for(var m=u[f],g=0;3>g;g++){i[0]=m[a[g]],i[1]=m[a[(g+1)%3]],i.sort(s);var v=i.toString();void 0===o[v]&&(h[2*d]=i[0],h[2*d+1]=i[1],o[v]=!0,d++)}for(var y=new Float32Array(2*d*3),f=0,p=d;p>f;f++)for(var g=0;2>g;g++){var _=c[h[2*f+g]],b=6*f+3*g;y[b+0]=_.x,y[b+1]=_.y,y[b+2]=_.z}l.addAttribute("position",new r.BufferAttribute(y,3))}else if(e.geometry instanceof r.BufferGeometry)if(void 0!==e.geometry.attributes.index){var c=e.geometry.attributes.position.array,x=e.geometry.attributes.index.array,w=e.geometry.drawcalls,d=0;0===w.length&&(w=[{count:x.length,index:0,start:0}]);for(var h=new Uint32Array(2*x.length),E=0,S=w.length;S>E;++E)for(var A=w[E].start,M=w[E].count,b=w[E].index,f=A,T=A+M;T>f;f+=3)for(var g=0;3>g;g++){i[0]=b+x[f+g],i[1]=b+x[f+(g+1)%3],i.sort(s);var v=i.toString();void 0===o[v]&&(h[2*d]=i[0],h[2*d+1]=i[1],o[v]=!0,d++)}for(var y=new Float32Array(2*d*3),f=0,p=d;p>f;f++)for(var g=0;2>g;g++){var b=6*f+3*g,C=3*h[2*f+g];y[b+0]=c[C],y[b+1]=c[C+1],y[b+2]=c[C+2]}l.addAttribute("position",new r.BufferAttribute(y,3))}else{for(var c=e.geometry.attributes.position.array,d=c.length/3,j=d/3,y=new Float32Array(2*d*3),f=0,p=j;p>f;f++)for(var g=0;3>g;g++){var b=18*f+6*g,P=9*f+3*g;y[b+0]=c[P],y[b+1]=c[P+1],y[b+2]=c[P+2];var C=9*f+3*((g+1)%3);y[b+3]=c[C],y[b+4]=c[C+1],y[b+5]=c[C+2]}l.addAttribute("position",new r.BufferAttribute(y,3))}r.Line.call(this,l,new r.LineBasicMaterial({color:n}),r.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},r.WireframeHelper.prototype=Object.create(r.Line.prototype),r.WireframeHelper.prototype.constructor=r.WireframeHelper,r.ImmediateRenderObject=function(){r.Object3D.call(this),this.render=function(e){}},r.ImmediateRenderObject.prototype=Object.create(r.Object3D.prototype),r.ImmediateRenderObject.prototype.constructor=r.ImmediateRenderObject,r.MorphBlendMesh=function(e,t){r.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,i="__default",o=0,s=n-1,a=n/1;this.createAnimation(i,o,s,a),this.setAnimationWeight(i,1)},r.MorphBlendMesh.prototype=Object.create(r.Mesh.prototype),r.MorphBlendMesh.prototype.constructor=r.MorphBlendMesh,r.MorphBlendMesh.prototype.createAnimation=function(e,t,r,n){var i={startFrame:t,endFrame:r,length:r-t+1,fps:n,duration:(r-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=i,this.animationsList.push(i)},r.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t,r=/([a-z]+)_?(\d+)/,n={},i=this.geometry,o=0,s=i.morphTargets.length;s>o;o++){var a=i.morphTargets[o],l=a.name.match(r);if(l&&l.length>1){var c=l[1];n[c]||(n[c]={start:1/0,end:-(1/0)});var u=n[c];o<u.start&&(u.start=o),o>u.end&&(u.end=o),t||(t=c)}}for(var c in n){var u=n[c];this.createAnimation(c,u.start,u.end,e)}this.firstAnimation=t},r.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},r.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},r.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var r=this.animationsMap[e];r&&(r.fps=t,r.duration=(r.end-r.start)/r.fps)},r.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var r=this.animationsMap[e];r&&(r.duration=t,r.fps=(r.end-r.start)/r.duration)},r.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var r=this.animationsMap[e];r&&(r.weight=t)},r.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var r=this.animationsMap[e];r&&(r.time=t)},r.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0,r=this.animationsMap[e];return r&&(t=r.time),t},r.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1,r=this.animationsMap[e];return r&&(t=r.duration),t},r.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):r.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},r.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},r.MorphBlendMesh.prototype.update=function(e){for(var t=0,n=this.animationsList.length;n>t;t++){var i=this.animationsList[t];if(i.active){var o=i.duration/i.length;i.time+=i.direction*e,i.mirroredLoop?(i.time>i.duration||i.time<0)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),i.time<0&&(i.time=0,i.directionBackwards=!1)):(i.time=i.time%i.duration,i.time<0&&(i.time+=i.duration));var s=i.startFrame+r.Math.clamp(Math.floor(i.time/o),0,i.length-1),a=i.weight;s!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*a,this.morphTargetInfluences[s]=0,i.lastFrame=i.currentFrame,i.currentFrame=s);var l=i.time%o/o;i.directionBackwards&&(l=1-l),this.morphTargetInfluences[i.currentFrame]=l*a,this.morphTargetInfluences[i.lastFrame]=(1-l)*a}}}}).call(this,r("./node_modules/webpack/buildin/module.js")(e))}});