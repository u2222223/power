// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define("../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(h,n,w,x,y,z,b){class A extends x{dispose(){}getGeometryType(){return n.WGLGeometryType.FILL}supportsSymbology(f){return f!==n.WGLSymbologyType.DOT_DENSITY}drawGeometry(f,k,g,a){const {context:l,painter:p,rendererInfo:r,requiredLevel:B,passOptions:t,requestRender:u,allowDelayedRender:C}=f;var d=y.FillMaterialKey.load(g.materialKey),c=z.getTechniqueFromMaterialKey(d.data);
const q=null!=t&&"hittest"===t.type;var e=p.materialManager;if(null==(c=c.programSpec)){c={geometry:[{location:0,name:"a_pos",count:2,type:b.DataType.SHORT},{location:1,name:"a_id",count:3,type:b.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:b.DataType.UNSIGNED_BYTE},{location:3,name:"a_color",count:4,type:b.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_aux1",count:4,type:b.DataType.UNSIGNED_SHORT},{location:5,name:"a_aux2",count:4,type:b.DataType.SHORT},{location:6,
name:"a_aux3",count:4,type:b.DataType.UNSIGNED_BYTE},{location:7,name:"a_zoomRange",count:2,type:b.DataType.UNSIGNED_SHORT}]};switch(d.symbologyType){case n.WGLSymbologyType.SIMPLE:case n.WGLSymbologyType.OUTLINE_FILL_SIMPLE:c.geometry.splice(7,1),c.geometry.splice(4,1)}c={shader:"materials/fill",vertexLayout:c}}const {shader:D,vertexLayout:E,hittestAttributes:F}=c;c=b.PrimitiveType.TRIANGLES;var m=w.createProgramDescriptor(d.data,E);q&&(m=this._getTriangleDesc(g.materialKey,m,F),c=b.PrimitiveType.POINTS);
const {attributes:v,bufferLayouts:G}=m;a=e.getMaterialProgram(f,d,D,v,a);if(C&&null!=u&&!a.compiled)u();else{l.useProgram(a);this._setSharedUniforms(a,f,k);var {row:H,col:I}=k.key;e=I*h.tileSize;m=H*h.tileSize;a.setUniform2f("u_tileOffset",e%h.maxRepresentableInt,m%h.maxRepresentableInt);a.setUniform2f("u_maxIntNumOfCrossing",Math.floor(e/h.maxRepresentableInt),Math.floor(m/h.maxRepresentableInt));d.textureBinding&&(p.textureManager.bindTextures(l,a,d),a.setUniform1f("u_zoomFactor",1/2**(B-k.key.level)));
e=1/f.pixelRatio;a.setUniform1f("u_blur",e);a.setUniform1f("u_antialiasing",e);this._setSizeVVUniforms(d,a,r,k);this._setColorAndOpacityVVUniforms(d,a,r);d=g.target.getVAO(l,G,v,q);e=g.indexCount;g=g.indexFrom*Uint32Array.BYTES_PER_ELEMENT;q&&(e/=3,g/=3);l.bindVAO(d);this._drawFills(f,k,a,c,e,g)}}_drawFills(f,k,g,a,l,p){f.context.drawElements(a,l,b.DataType.UNSIGNED_INT,p)}}return A});