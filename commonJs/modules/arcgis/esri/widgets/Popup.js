// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Features":function(){define("require ../chunks/tslib.es6 ../intl ../core/Collection ../core/events ../core/Logger ../core/reactiveUtils ../core/throttle ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Feature ./Spinner ./Widget ./Feature/resources ./Feature/support/FeatureContentMixin ./Features/css ./Features/FeaturesRelatedRecords ./Features/FeaturesViewModel ./Features/FeaturesVisibleElements ./Popup/actions ./Popup/actionUtils ./support/componentsUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute ../intl/number".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r,x,N,k,h,a,e,f,E,w,L,D,G,P,S){t=class extends p.FeatureContentMixin(l){constructor(C,u){super(C,u);this._featureMenuIntersectionObserverCallback=([v])=>{v?.isIntersecting&&null!=this.viewModel.featurePage&&this.viewModel.featurePage++};this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document});this._feature=this._spinner=this._focusOn=this._featureMenuIntersectionObserverNode=null;
this._relatedRecordsFlowItems=new y;this._relatedRecordsWidget=new x({flowItems:this._relatedRecordsFlowItems});this._featureMenuViewportNode=this._rootFlowItemNode=null;this.collapsed=!1;this.icon=null;this.featureNavigationTop=!1;this.headerActions=new h.ActionsCollection;this.headingLevel=2;this.messagesCommon=this.messages=null;this.responsiveActionsEnabled=!1;this.viewModel=new N;this.visibleElements=new k;this._renderAction=(v,B)=>{const Q=this._getActionTitle(v),{type:T,active:X,uid:ba,disabled:da,
indicator:aa}=v;return v.visible?G.tsx("calcite-action",{active:"toggle"===T?v.value:!1,appearance:"solid",bind:this,"data-action-uid":ba,disabled:da,icon:this._getActionIcon(v),indicator:aa,key:`action-${B}`,loading:X,onclick:this._triggerAction,scale:"s",text:Q,title:this._hideActionText?Q:void 0},this._getFallbackIcon(v)):null};this._openFeatureMenu=()=>{this.featureMenuOpen=!0};this._previousFeature=()=>{this.viewModel.selectedFeatureIndex--};this._nextFeature=()=>{this.viewModel.selectedFeatureIndex++};
this._handleFeatureMenuBack=()=>{this.featureMenuOpen&&(this._focusOn="root-flow-item",this.featureMenuOpen=!1)};this._focusFlowItemNode=v=>{this._focusOn===v&&requestAnimationFrame(async()=>{switch(v){case "menu-flow-item":await this._featureMenuViewportNode?.setFocus();break;case "root-flow-item":await this._rootFlowItemNode?.setFocus()}this._focusOn=null})};this._focusFlowItemNodeThrottled=K.throttle(this._focusFlowItemNode,50);this._displaySpinnerThrottled=K.throttle(()=>this._displaySpinner(),
0);this._addSelectedFeatureIndexHandle();this.addHandles([this._displaySpinnerThrottled,this._focusFlowItemNodeThrottled,J.watch(()=>this.viewModel?.active,()=>this._toggleScreenLocationEnabled()),J.watch(()=>this.viewModel?.active,v=>this._relatedRecordsWidget.closed=!v),J.watch(()=>this.visibleElements?.closeButton,v=>this._relatedRecordsWidget.closable=v),J.watch(()=>this.visibleElements?.spinner,v=>this._spinnerEnabledChange(v)),J.watch(()=>this.viewModel?.view,(v,B)=>this._viewChange(v,B)),J.watch(()=>
this.viewModel?.view?.ready,(v,B)=>this._viewReadyChange(v??!1,B??!1)),J.watch(()=>[this.viewModel?.waitingForResult,this.viewModel?.location],()=>{this._hideSpinner();this._displaySpinnerThrottled()}),J.watch(()=>this.selectedFeatureWidget,()=>this._destroyRelatedRecordsFlowItemWidgets()),J.watch(()=>{const v=this.selectedFeatureWidget?.viewModel;return[v?.title,v?.state]},()=>this._setTitleFromFeatureWidget()),J.watch(()=>{const v=this.selectedFeatureWidget?.viewModel;return[v?.content,v?.state]},
()=>this._setContentFromFeatureWidget()),J.watch(()=>this.viewModel?.featureViewModels,()=>this._featureMenuViewportScrollTop()),this._relatedRecordsWidget.on("close",()=>this.close()),this._relatedRecordsWidget.on("exit",()=>this._destroyRelatedRecordsFlowItemWidgets()),this._relatedRecordsWidget.on("open-related-feature",({feature:v})=>this._openRelatedFeature(v))])}loadDependencies(){return e.loadCalciteComponents({action:()=>new Promise((C,u)=>b(["../chunks/calcite-action"],C,u)),"action-bar":()=>
new Promise((C,u)=>b(["../chunks/calcite-action-bar"],C,u)),"action-group":()=>new Promise((C,u)=>b(["../chunks/calcite-action-group"],C,u)),button:()=>new Promise((C,u)=>b(["../chunks/calcite-button"],C,u)),flow:()=>new Promise((C,u)=>b(["../chunks/calcite-flow"],C,u)),"flow-item":()=>new Promise((C,u)=>b(["../chunks/calcite-flow-item"],C,u)),list:()=>new Promise((C,u)=>b(["../chunks/calcite-list"],C,u)),"list-item":()=>new Promise((C,u)=>b(["../chunks/calcite-list-item"],C,u)),"list-item-group":()=>
new Promise((C,u)=>b(["../chunks/calcite-list-item-group"],C,u)),loader:()=>new Promise((C,u)=>b(["../chunks/calcite-loader"],C,u))})}destroy(){this._destroyRelatedRecordsFlowItemWidgets();this._destroySelectedFeatureWidget();this._destroySpinner();this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver?.disconnect();this._relatedRecordsWidget?.destroy()}get _hideActionText(){if(!this.responsiveActionsEnabled)return!1;const C=this.view?.widthBreakpoint;return"xsmall"===C||"small"===
C||"medium"===C}get _featureNavigationVisible(){return this.viewModel.active&&1<this.viewModel.featureCount&&this.visibleElements.featureNavigation}get _isCollapsed(){return this._collapseEnabled&&this.collapsed}get _collapseEnabled(){return this.visibleElements.collapseButton&&!!this.title&&!!this.content}get content(){return this.viewModel.content}set content(C){this.viewModel.content=C}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(C){this.viewModel.featureMenuOpen=
C}get features(){return this.viewModel.features}set features(C){this.viewModel.features=C}get location(){return this.viewModel.location}set location(C){this.viewModel.location=C}get label(){return this.messages?.widgetLabel??""}set label(C){this._overrideIfSome("label",C)}get promises(){return this.viewModel.promises}set promises(C){this.viewModel.promises=C}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(C){this.viewModel.selectedFeatureIndex=
C}get selectedFeatureWidget(){const {_feature:C,headingLevel:u,_relatedRecordsFlowItems:v}=this,{selectedFeatureViewModel:B}=this.viewModel,Q={title:!1};if(!B)return null;C?(C.viewModel=B,C.visibleElements=Q):this._feature=new n({flowItems:v,headingLevel:u+1,viewModel:B,visibleElements:Q});return this._feature}get title(){return this.viewModel.title}set title(C){this.viewModel.title=C}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(C){this.viewModel.updateLocationEnabled=
C}get view(){return this.viewModel.view}set view(C){this.viewModel.view=C}get visible(){return this.viewModel.visible}set visible(C){this.viewModel.visible=C}blur(){const {active:C}=this.viewModel;C?this._rootFlowItemNode?.blur():H.getLogger(this).warn("Features can only be blurred when currently active.")}clear(){return this.viewModel.clear()}close(){this.viewModel.visible=!1}fetchFeatures(C,u){return this.viewModel.fetchFeatures(C,u)}focus(){const {active:C}=this.viewModel;C?this._setFocusOn():
H.getLogger(this).warn("Features can only be focused when currently active.")}next(){return this.viewModel.next()}open(C){this.removeHandles("selected-index");this.set({collapsed:C?.collapsed??!1});this.viewModel.open(C);this.addHandles(J.when(()=>!this.viewModel.waitingForResult,()=>this._addSelectedFeatureIndexHandle(),{once:!0}))}previous(){return this.viewModel.previous()}triggerAction(C){return this.viewModel.triggerAction(C)}render(){return G.tsx("div",{bind:this,class:this.classes(r.css.base,
f.globalCss.widget,f.globalCss.panel),onkeydown:this._onMainKeydown},this._renderHeader(),this._renderContentContainer())}_renderFeatureNavigation(){return[this._renderPagination(),this._renderFeatureMenuButton()]}_renderHeader(){return!this.featureMenuOpen&&this.featureNavigationTop&&this._featureNavigationVisible?G.tsx("div",{class:r.css.header,key:"header-actions"},this._renderFeatureNavigation()):null}_renderFooter(){return this.featureMenuOpen||this.featureNavigationTop||!this._featureNavigationVisible?
null:G.tsx("div",{class:r.css.footer,key:"footer-actions",slot:"footer"},this._renderFeatureNavigation())}_renderFeatureMenuButton(){const {messages:C,viewModel:u}=this,{featureCount:v,selectedFeatureIndex:B,pendingPromisesCount:Q}=u;return G.tsx("calcite-action",{appearance:"solid",bind:this,icon:"list",key:"feature-menu-button",label:C.selectFeature,loading:0<Q,onclick:this._openFeatureMenu,scale:"s",text:P.substitute(C.pageText,{index:S.formatNumber(B+1),total:S.formatNumber(v)}),textEnabled:!0,
title:C.selectFeature})}_renderPagination(){const {previous:C,next:u}=this.messagesCommon.pagination;return G.tsx("calcite-action-bar",{class:r.css.paginationActionBar,expandDisabled:!0,key:"pagination-action-bar",layout:"horizontal",overflowActionsDisabled:!0,scale:"s"},G.tsx("calcite-action-group",{scale:"s"},G.tsx("calcite-action",{appearance:"solid",class:r.css.paginationPrevious,icon:"chevron-left",iconFlipRtl:!0,label:C,onclick:this._previousFeature,scale:"s",text:C,title:C}),G.tsx("calcite-action",
{appearance:"solid",icon:"chevron-right",iconFlipRtl:!0,label:u,onclick:this._nextFeature,scale:"s",text:u,title:u})))}_renderFeatureMenuItem(C){const {selectedFeatureViewModel:u,featureViewModels:v}=this.viewModel,B=C===u,Q=v.indexOf(C);return G.tsx("calcite-list-item",{bind:this,"data-feature-index":Q,key:`feature-menu-item-${C.uid}`,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onmouseleave:this._removeActiveFeature,onmouseover:this._setActiveFeature,selected:B,onCalciteListItemSelect:this._selectFeature},
G.tsx("span",{innerHTML:C.title||this.messagesCommon.untitled,slot:"content"}))}_groupResultsByLayer(){const {featureViewModels:C}=this.viewModel,u=new Map;C.forEach(v=>{var B=v?.graphic;if(B){B=B.sourceLayer??B.layer;var Q=u.get(B)??[];u.set(B,[...Q,v])}});return u}_renderFeatureMenu(){const {featureViewModels:C}=this.viewModel,u=this._groupResultsByLayer();return C.length?G.tsx("calcite-list",{selectionAppearance:"icon",selectionMode:"single"},Array.from(u.keys()).map(v=>G.tsx("calcite-list-item-group",
{heading:v?.title??this.messagesCommon.untitled,key:v?.uid||"untitled"},u.get(v)?.map(B=>this._renderFeatureMenuItem(B))))):null}_renderHeaderAction(C,u){return C.visible?G.tsx("calcite-action",{active:"toggle"===C.type?C.value:!1,appearance:"solid",bind:this,"data-action-uid":C.uid,disabled:C.disabled,icon:C.icon||"",indicator:C.indicator,key:`header-action-${u}`,loading:C.active,onclick:this._triggerHeaderAction,scale:"m",slot:"header-actions-end",text:C.title||"",title:C.title||""}):null}_renderHeaderActions(){return this.headerActions.map((C,
u)=>this._renderHeaderAction(C,u)).toArray()}_renderContentFeature(){const {headingLevel:C,visibleElements:u,_isCollapsed:v,_collapseEnabled:B,featureNavigationTop:Q}=this,{title:T,active:X}=this.viewModel,ba=u.heading&&T?T:"";return G.tsx("calcite-flow-item",{afterCreate:this._storeRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,class:this.classes({[r.css.contentFeature]:!0,[r.css.flowItemCollapsed]:v}),closable:u.closeButton,closed:!X,collapsed:v,collapseDirection:Q?"down":"up",
collapsible:B,headingLevel:C,key:"root-flow-item",onCalciteFlowItemClose:this.close,onCalciteFlowItemToggle:this._handleCollapseToggle},ba?G.tsx(E.Heading,{class:this.classes(r.css.featuresHeading,f.globalCss.heading),innerHTML:ba,key:"header-content",level:this.headingLevel,slot:"header-content"}):null,this._renderHeaderActions(),this._renderActionBar(),v?null:G.tsx("div",{class:this.classes(r.css.container,r.css.contentContainer)},this._renderContent()),this._renderFooter())}_renderFeatureMenuContainer(){const {viewModel:C,
featureMenuOpen:u,messages:v,messagesCommon:B}=this,{active:Q,featureViewModels:T,pendingPromisesCount:X}=C;return u?G.tsx("calcite-flow-item",{afterCreate:this._storeFeatureMenuFlowItemNode,afterUpdate:this._focusFeatureMenuFlowItemNode,bind:this,closable:!1,closed:!Q,description:P.substitute(v.total,{total:T.length}),heading:v.selectFeature,key:"feature-menu",loading:C.waitingForContents,onCalciteFlowItemBack:this._handleFeatureMenuBack},0<X?G.tsx("calcite-loader",{class:r.css.loader,inline:!0,
key:"feature-menu-loader",label:B.loading,scale:"m",slot:"header-actions-end"}):null,G.tsx("div",{class:r.css.container},this._renderFeatureMenu()),G.tsx("div",{afterCreate:this._featureMenuIntersectionObserverCreated,bind:this,class:r.css.featureMenuObserver}),G.tsx("calcite-button",{appearance:"transparent",onclick:this._handleFeatureMenuBack,slot:"footer-actions",width:"full"},B.back)):null}_renderContentContainer(){return G.tsx("calcite-flow",{key:"content-container"},this._renderContentFeature(),
this._renderFeatureMenuContainer(),this._relatedRecordsWidget.render())}_getIconStyles(C){return{"background-image":C?`url(${C})`:""}}_getActionImage(C){var {selectedFeature:u}=this;u=u?.attributes;({image:C}=C);return C&&u?P.substitute(C,u):C??""}_getFallbackIcon(C){const {className:u,icon:v}=C;if(v)return null;C=this._getActionImage(C);const B={[r.css.icon]:!!u,[r.css.actionImage]:!!C};u&&(B[u]=!0);return C||u?G.tsx("span",{"aria-hidden":"true",class:this.classes(r.css.icon,B),key:"icon",styles:C?
this._getIconStyles(C):{}}):null}_renderActionBar(){return!this._isCollapsed&&this.visibleElements.actionBar&&this.viewModel.allActions?.length?G.tsx("calcite-action-bar",{expandDisabled:!0,expanded:!this._hideActionText,key:"header-action-bar",scale:"s",slot:"action-bar"},G.tsx("calcite-action-group",{overlayPositioning:"fixed",scale:"s"},this._renderActions())):null}_renderActions(){return this.viewModel.allActions.toArray().map(this._renderAction)}_renderContent(){const C=this.viewModel?.content;
return C?"string"===typeof C?G.tsx("div",{class:d.css.contentNode,innerHTML:C,key:C}):this.renderNodeContent(C):null}_setFocusOn(){this._focusOn=this.featureMenuOpen?"menu-flow-item":"root-flow-item";this.renderNow()}_handleCollapseToggle(){this.collapsed=!this.collapsed}async _openRelatedFeature(C){await C.viewModel.updateGeometry();C=C.graphic;var u=C?.geometry;null!=u&&null!=C&&(this._destroyRelatedRecordsFlowItemWidgets(),await this.viewModel.zoomTo({target:u}),u=a.getPointFromGeometry(u),this.open({features:[C],
location:null!=u?u:void 0}))}_focusRootFlowItemNode(){this._focusFlowItemNodeThrottled("root-flow-item")}_focusFeatureMenuFlowItemNode(){this._focusFlowItemNodeThrottled("menu-flow-item")}_storeRootFlowItemNode(C){this._rootFlowItemNode=C;this._focusFlowItemNodeThrottled("root-flow-item")}_storeFeatureMenuFlowItemNode(C){this._featureMenuViewportNode=C;this._focusFlowItemNodeThrottled("menu-flow-item")}_setActiveFeature(C){const {viewModel:u}=this;C=C.currentTarget["data-feature-index"];u.activeFeature=
u.features?.[C]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_selectFeature(C){C=C.currentTarget["data-feature-index"];isNaN(C)||(this.viewModel.selectedFeatureIndex=C);this._handleFeatureMenuBack()}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(C){this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver.observe(C);
this._featureMenuIntersectionObserverNode=C}_getActionIcon(C){if(C.icon)return C.icon;if(!C.image&&!C.className)return"question"}_getActionTitle(C){const {messages:u,selectedFeature:v,messagesCommon:B}=this,{id:Q}=C,T=v?.attributes,X=C.title??"";return(C="zoom-to-feature"===Q?P.substitute(X,{messages:u}):"remove-selected-feature"===Q?P.substitute(X,{messages:B}):"zoom-to-clustered-features"===Q?P.substitute(X,{messages:u}):"browse-clustered-features"===Q?P.substitute(X,{messages:u}):C.title)&&T?P.substitute(C,
T):C??""}_onMainKeydown(C){const u=z.eventKey(C);"ArrowLeft"===u&&(C.stopPropagation(),this._handleFeatureMenuBack(),this.previous());"ArrowRight"===u&&(C.stopPropagation(),this._handleFeatureMenuBack(),this.next())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&this._featureMenuViewportNode.scrollContentTo({top:0})}_setContentFromFeatureWidget(){const {selectedFeatureWidget:C}=this;C&&(this.viewModel.content=C)}_setTitleFromFeatureWidget(){const {selectedFeatureWidget:C,messagesCommon:u}=
this,v=C?.viewModel;C&&(this.viewModel.title="error"===v?.state?u?.errorMessage:v?.title||"")}_addSelectedFeatureIndexHandle(){const C=J.watch(()=>this.viewModel?.selectedFeatureIndex,(u,v)=>this._selectedFeatureIndexUpdated(u,v));this.addHandles(C,"selected-index")}_selectedFeatureIndexUpdated(C,u){const {featureCount:v}=this.viewModel;v&&C!==u&&-1!==C&&(this._destroyRelatedRecordsFlowItemWidgets(),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_triggerHeaderAction(C){C=
C.currentTarget;if(!C.disabled){var u=C.dataset.actionUid;(C=this.headerActions.find(({uid:v})=>v===u))&&!C.disabled&&("toggle"===C?.type&&(C.value=!C.value),this.emit("trigger-header-action",{action:C}))}}_triggerAction(C){C=C.currentTarget;if(!C.disabled){var u=C.dataset.actionUid,{allActions:v}=this.viewModel;C=v.findIndex(B=>B.uid===u);(v=v.at(C))&&"toggle"===v.type&&(v.value=!v.value);this.viewModel.triggerAction(C)}}_createSpinner(C){C&&(this._spinner=new q({view:C}),C.ui.add(this._spinner,
{key:"features-spinner",position:"manual",internal:!0}))}_wireUpView(C){this._destroySpinner();C&&this.visibleElements?.spinner&&this._createSpinner(C)}_hideSpinner(){const {_spinner:C}=this;C&&(C.location=null,C.hide())}_viewReadyChange(C,u){C?this._wireUpView(this.viewModel?.view):u&&this.viewModel.clear()}_viewChange(C,u){C&&u&&this.viewModel.clear()}_destroySelectedFeatureWidget(){const {_feature:C}=this;C&&(C.viewModel=null,!C.destroyed&&C.destroy());this._feature=null}_destroyRelatedRecordsFlowItemWidgets(){this._relatedRecordsFlowItems.removeAll().forEach(C=>
{"showAllEnabled"in C.viewModel&&(C.viewModel.showAllEnabled=!1);C.viewModel=null;C.destroy()})}_toggleScreenLocationEnabled(){const {viewModel:C}=this;C&&(C.screenLocationEnabled=C.active)}_displaySpinner(){const {_spinner:C}=this;if(C){var {location:u,waitingForResult:v}=this.viewModel;v&&u?C.show({location:u}):C.hide()}}_destroySpinner(){const {_spinner:C,view:u}=this;C&&(u?.ui?.remove(C,"features-spinner"),C.destroy(),this._spinner=null)}_spinnerEnabledChange(C){this._destroySpinner();C&&this._createSpinner(this.viewModel?.view)}};
m.__decorate([M.property()],t.prototype,"_focusOn",void 0);m.__decorate([M.property()],t.prototype,"_relatedRecordsFlowItems",void 0);m.__decorate([M.property()],t.prototype,"_hideActionText",null);m.__decorate([M.property()],t.prototype,"_featureNavigationVisible",null);m.__decorate([M.property()],t.prototype,"_isCollapsed",null);m.__decorate([M.property()],t.prototype,"_collapseEnabled",null);m.__decorate([M.property()],t.prototype,"collapsed",void 0);m.__decorate([M.property()],t.prototype,"content",
null);m.__decorate([M.property()],t.prototype,"icon",void 0);m.__decorate([M.property()],t.prototype,"featureMenuOpen",null);m.__decorate([M.property()],t.prototype,"featureNavigationTop",void 0);m.__decorate([M.property()],t.prototype,"features",null);m.__decorate([M.property({type:h.ActionsCollection})],t.prototype,"headerActions",void 0);m.__decorate([M.property()],t.prototype,"headingLevel",void 0);m.__decorate([M.property()],t.prototype,"location",null);m.__decorate([M.property()],t.prototype,
"label",null);m.__decorate([M.property(),L.messageBundle("esri/widgets/Features/t9n/Features")],t.prototype,"messages",void 0);m.__decorate([M.property(),L.messageBundle("esri/t9n/common")],t.prototype,"messagesCommon",void 0);m.__decorate([M.property()],t.prototype,"promises",null);m.__decorate([M.property()],t.prototype,"responsiveActionsEnabled",void 0);m.__decorate([M.property({readOnly:!0})],t.prototype,"selectedFeature",null);m.__decorate([M.property()],t.prototype,"selectedFeatureIndex",null);
m.__decorate([M.property({readOnly:!0})],t.prototype,"selectedFeatureWidget",null);m.__decorate([M.property()],t.prototype,"title",null);m.__decorate([M.property()],t.prototype,"updateLocationEnabled",null);m.__decorate([M.property()],t.prototype,"view",null);m.__decorate([M.property({type:N}),D.vmEvent(["triggerAction","trigger-action"])],t.prototype,"viewModel",void 0);m.__decorate([M.property({type:k,nonNullable:!0})],t.prototype,"visibleElements",void 0);m.__decorate([M.property()],t.prototype,
"visible",null);return t=m.__decorate([g.subclass("esri.widgets.Features")],t)})},"esri/core/throttle":function(){define(["exports"],function(b){b.throttle=function(m,t,y,z){let H=null,J=1E3;"number"===typeof t?(J=t,z=y):(H=t??null,J=y);let K=0,M;const F=()=>{K=0;m.apply(z,M)};t=(...A)=>{H&&H.apply(z,A);M=A;J?K||(K=setTimeout(F,J)):F()};t.remove=()=>{K&&(clearTimeout(K),K=0)};t.forceUpdate=()=>{K&&(clearTimeout(K),F())};t.hasPendingUpdates=()=>!!K;return t};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Feature":function(){define("require ../chunks/tslib.es6 ../intl ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureExpression ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureRelationship ./Feature/FeatureViewModel ./Feature/resources ./Feature/support/FeatureContentMixin ./support/componentsUtils ./support/globalCss ./support/Heading ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r,x,N,k,h,a,e,f,E){var w;const L={title:!0,content:!0,lastEditedInfo:!0};t=w=class extends r.FeatureContentMixin(F){constructor(D,G){super(D,G);this._contentWidgets=[];this.flowItems=null;this.headingLevel=2;this.messagesURIUtils=this.messagesCommon=this.messages=null;this.visibleElements={...L};this.viewModel=new d}initialize(){this.addHandles(y.watch(()=>this.viewModel?.contentViewModels,()=>this._setupContentWidgets(),y.initial))}loadDependencies(){return x.loadCalciteComponents({notice:()=>
new Promise((D,G)=>b(["../chunks/calcite-notice"],D,G))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(D){this.viewModel.graphic=D}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(D){this.viewModel.defaultPopupTemplateEnabled=D}get isTable(){return this.viewModel.isTable}get label(){return this.messages?.widgetLabel??""}set label(D){this._overrideIfSome("label",D)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(D){this.viewModel.spatialReference=
D}get title(){return this.viewModel.title}castVisibleElements(D){return{...L,...D}}get map(){return this.viewModel.map}set map(D){this.viewModel.map=D}get view(){return this.viewModel.view}set view(D){this.viewModel.view=D}setActiveMedia(D,G){return this.viewModel.setActiveMedia(D,G)}nextMedia(D){return this.viewModel.nextMedia(D)}previousMedia(D){return this.viewModel.previousMedia(D)}render(){var {state:D}=this.viewModel;D=f.tsx("div",{class:p.css.container,key:"container"},this._renderTitle(),
"error"===D?this._renderError():"loading"===D?this._renderLoading():this._renderContentContainer());return f.tsx("div",{class:this.classes(p.css.base,N.globalCss.widget)},D)}_renderError(){const {messagesCommon:D,messages:G,visibleElements:P}=this;return f.tsx("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},P.title?f.tsx("div",{key:"error-title",slot:"title"},D.errorMessage):null,f.tsx("div",{key:"error-message",slot:"message"},G.loadingError))}_renderLoading(){return f.tsx("div",
{class:p.css.loadingSpinnerContainer,key:"loading-container"},f.tsx("span",{class:this.classes(h.legacyIcon.loadingIndicator,N.globalCss.rotating,p.css.spinner)}))}_renderContentContainer(){const {visibleElements:D}=this;return D.content?f.tsx("div",{class:p.css.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const {visibleElements:D,title:G}=this;return D.title?f.tsx(k.Heading,{class:p.css.title,innerHTML:G,level:this.headingLevel}):null}_renderContent(){var D=this.viewModel.content;
return D?Array.isArray(D)?D.length?f.tsx("div",{class:p.css.contentNode,key:"content-content-elements"},D.map(this._renderContentElement,this)):null:"string"===typeof D?(D=this._contentWidgets[0],!D||D.destroyed?null:f.tsx("div",{class:this.classes(p.css.contentNode,p.css.contentNodeText),key:"content-content"},D.render())):this.renderNodeContent(D):null}_renderContentElement(D,G){const {visibleElements:P}=this;if("boolean"!==typeof P.content&&!P.content?.[D.type])return null;switch(D.type){case "attachments":return this._renderAttachments(G);
case "custom":return this._renderCustom(D,G);case "fields":return this._renderFields(G);case "media":return this._renderMedia(G);case "text":return this._renderText(D,G);case "expression":return this._renderExpression(G);case "relationship":return this._renderRelationship(G);default:return null}}_renderAttachments(D){const G=this._contentWidgets[D];if(!G||G.destroyed)return null;const {state:P,attachmentInfos:S}=G.viewModel;return"loading"===P||0<S.length?f.tsx("div",{class:this.classes(p.css.contentElement),
key:this._buildKey("attachments-element",D)},G.render()):null}_renderRelationship(D){const G=this._contentWidgets[D];return G&&!G.destroyed&&this.flowItems?f.tsx("div",{class:p.css.contentElement,key:this._buildKey("relationship-element",D)},G.render()):null}_renderExpression(D){const G=this._contentWidgets[D];return!G||G.destroyed?null:f.tsx("div",{class:p.css.contentElement,key:this._buildKey("expression-element",D)},G.render())}_renderCustom(D,G){({creator:D}=D);const P=this._contentWidgets[G];
return!P||P.destroyed?null:D?f.tsx("div",{class:p.css.contentElement,key:this._buildKey("custom-element",G)},P.render()):null}_renderFields(D){const G=this._contentWidgets[D];return!G||G.destroyed?null:f.tsx("div",{class:p.css.contentElement,key:this._buildKey("fields-element",D)},G.render())}_renderMedia(D){const G=this._contentWidgets[D];return!G||G.destroyed?null:f.tsx("div",{class:p.css.contentElement,key:this._buildKey("media-element",D)},G.render())}_renderLastEditInfo(){const {visibleElements:D,
messages:G}=this;var {lastEditInfo:P}=this.viewModel;if(!P||!D.lastEditedInfo)return null;const {date:S,user:C}=P;P=E.substitute("edit"===P.type?C?G.lastEditedByUser:G.lastEdited:C?G.lastCreatedByUser:G.lastCreated,{date:S,user:C});return f.tsx("div",{class:this.classes(p.css.lastEditedInfo,p.css.contentElement),key:"edit-info-element"},P)}_renderText(D,G){const P=this._contentWidgets[G];return!P||P.destroyed?null:D.text?f.tsx("div",{class:this.classes(p.css.contentElement,p.css.text),key:this._buildKey("text-element",
G)},P.render()):null}_buildKey(D,...G){const P=this.viewModel?.graphic?.uid||"0";G=G.join("-");return`${D}__${P}-${G}`}_destroyContentWidget(D){D&&(D.viewModel=null,!D.destroyed&&D.destroy())}_destroyContentWidgets(){this.removeHandles("relationship-handles");this._contentWidgets.forEach(D=>this._destroyContentWidget(D));this._contentWidgets=[]}_addFeatureRelationshipHandles(D){const {flowItems:G,visibleElements:P}=this;this.addHandles([y.on(()=>D,"select-record",({featureViewModel:S})=>{G&&(S.abilities=
{relationshipContent:!0},G.push(new w({flowItems:G,viewModel:S,visibleElements:P})))}),y.on(()=>D,"show-all-records",()=>{if(G){var {viewModel:S}=D;S.showAllEnabled=!0;S=new l({visibleElements:{title:!1,description:!1},viewModel:S});this._addFeatureRelationshipHandles(S);G.push(S)}})],"relationship-handles")}_setupContentWidgets(){this._destroyContentWidgets();const {headingLevel:D,visibleElements:G}=this;var P=this.viewModel?.content;const {contentViewModels:S}=this.viewModel;Array.isArray(P)?P.forEach((C,
u)=>{"attachments"===C.type&&(this._contentWidgets[u]=new A({displayType:C.displayType,headingLevel:G.title?D+1:D,viewModel:S[u]}));"fields"===C.type&&(this._contentWidgets[u]=new n({viewModel:S[u]}));"media"===C.type&&(this._contentWidgets[u]=new q({viewModel:S[u]}));"text"===C.type&&(this._contentWidgets[u]=new c({viewModel:S[u]}));"custom"===C.type&&(this._contentWidgets[u]=new c({viewModel:S[u]}));"expression"===C.type&&(this._contentWidgets[u]=new g({viewModel:S[u]}));"relationship"===C.type&&
(C=new l({viewModel:S[u]}),this._addFeatureRelationshipHandles(C),this._contentWidgets[u]=C)},this):(P=S[0])&&!P.destroyed&&(this._contentWidgets[0]=new c({viewModel:P}));this.scheduleRender()}};m.__decorate([z.property()],t.prototype,"graphic",null);m.__decorate([z.property()],t.prototype,"defaultPopupTemplateEnabled",null);m.__decorate([z.property()],t.prototype,"flowItems",void 0);m.__decorate([z.property()],t.prototype,"headingLevel",void 0);m.__decorate([z.property({readOnly:!0})],t.prototype,
"isTable",null);m.__decorate([z.property()],t.prototype,"label",null);m.__decorate([z.property(),e.messageBundle("esri/widgets/Feature/t9n/Feature")],t.prototype,"messages",void 0);m.__decorate([z.property(),e.messageBundle("esri/t9n/common")],t.prototype,"messagesCommon",void 0);m.__decorate([z.property(),e.messageBundle("esri/widgets/support/t9n/uriUtils")],t.prototype,"messagesURIUtils",void 0);m.__decorate([z.property()],t.prototype,"spatialReference",null);m.__decorate([z.property({readOnly:!0})],
t.prototype,"title",null);m.__decorate([z.property()],t.prototype,"visibleElements",void 0);m.__decorate([H.cast("visibleElements")],t.prototype,"castVisibleElements",null);m.__decorate([z.property()],t.prototype,"map",null);m.__decorate([z.property()],t.prototype,"view",null);m.__decorate([z.property({type:d})],t.prototype,"viewModel",void 0);return t=w=m.__decorate([M.subclass("esri.widgets.Feature")],t)})},"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g){y=class extends M{constructor(n,q){super(n,q);this._featureElementInfo=null;this.attachmentsWidget=new K;this.headingLevel=2;this.viewModel=new F}initialize(){this._featureElementInfo=new A;this.addHandles([m.watch(()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel],()=>this._setupFeatureElementInfo(),m.initial),m.watch(()=>this.viewModel,n=>this.attachmentsWidget.viewModel=n,m.initial)])}destroy(){this.attachmentsWidget.viewModel=null;this.attachmentsWidget.destroy();
this._featureElementInfo?.destroy()}get description(){return this.viewModel.description}set description(n){this.viewModel.description=n}get displayType(){return this.attachmentsWidget.displayType}set displayType(n){this.attachmentsWidget.displayType=n}get graphic(){return this.viewModel.graphic}set graphic(n){this.viewModel.graphic=n}get title(){return this.viewModel.title}set title(n){this.viewModel.title=n}render(){const {attachmentsWidget:n}=this;return g.tsx("div",{class:"esri-feature-attachments"},
this._featureElementInfo?.render(),n?.render())}_setupFeatureElementInfo(){const {description:n,title:q,headingLevel:l}=this;this._featureElementInfo?.set({description:n,title:q,headingLevel:l})}};b.__decorate([t.property({readOnly:!0})],y.prototype,"attachmentsWidget",void 0);b.__decorate([t.property()],y.prototype,"description",null);b.__decorate([t.property()],y.prototype,"displayType",null);b.__decorate([t.property()],y.prototype,"graphic",null);b.__decorate([t.property()],y.prototype,"headingLevel",
void 0);b.__decorate([t.property()],y.prototype,"title",null);b.__decorate([t.property({type:F})],y.prototype,"viewModel",void 0);return y=b.__decorate([J.subclass("esri.widgets.Feature.FeatureAttachments")],y)})},"esri/widgets/Attachments":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/componentsUtils ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r){const x={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},N=window.CSS;K=class extends A{constructor(k,h){super(k,h);this.displayType="auto";this.selectedFile=this.messagesUnits=this.messages=null;this.submitting=!1;this.viewModel=null;this.visibleElements={...x};this._supportsImageOrientation=N&&N.supports&&N.supports("image-orientation","from-image");this._updateAttachmentForm=
this._addAttachmentForm=null}normalizeCtorArgs(k){k?.viewModel||(k={viewModel:new c,...k});return k}initialize(){this.addHandles([y.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),y.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),y.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),y.initial)])}loadDependencies(){return n.loadCalciteComponents({icon:()=>new Promise((k,h)=>b(["../chunks/calcite-icon"],k,h))})}get capabilities(){return this.viewModel.capabilities}set capabilities(k){this.viewModel.capabilities=
k}get effectiveDisplayType(){const {displayType:k}=this;return k&&"auto"!==k?k:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(k){this.viewModel.graphic=k}get label(){return this.messages?.widgetLabel??""}set label(k){this._overrideIfSome("label",k)}castVisibleElements(k){return{...x,...k}}addAttachment(){const {_addAttachmentForm:k,viewModel:h}=this;this._set("submitting",!0);this._set("error",null);return h.addAttachment(k).then(a=>
{this._set("submitting",!1);this._set("error",null);h.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new t("attachments:add-attachment",this.messages.addErrorMessage,a));throw a;})}deleteAttachment(k){const {viewModel:h}=this;this._set("submitting",!0);this._set("error",null);return h.deleteAttachment(k).then(a=>{this._set("submitting",!1);this._set("error",null);h.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new t("attachments:delete-attachment",
this.messages.deleteErrorMessage,a));throw a;})}updateAttachment(){const {viewModel:k}=this,{_updateAttachmentForm:h}=this;this._set("submitting",!0);this._set("error",null);return k.updateAttachment(h).then(a=>{this._set("submitting",!1);this._set("error",null);k.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new t("attachments:update-attachment",this.messages.updateErrorMessage,a));throw a;})}addFile(){const k=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);
this.viewModel.mode="view";return k}updateFile(){const {viewModel:k}=this,h=k.updateFile(this.selectedFile,this._updateAttachmentForm,k.activeFileInfo);k.mode="view";return h}deleteFile(k){k=this.viewModel.deleteFile(k||this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return k}render(){const {submitting:k,viewModel:h}=this,{state:a}=h;return r.tsx("div",{class:this.classes("esri-attachments",q.globalCss.widget)},k?this._renderProgressBar():null,"loading"===a?this._renderLoading():this._renderAttachments(),
this._renderErrorMessage())}_renderErrorMessage(){const {error:k,visibleElements:h}=this;return k&&h.errorMessage?r.tsx("div",{class:"esri-attachments__error-message",key:"error-message"},k.message):null}_renderAttachments(){const {activeFileInfo:k,mode:h,activeAttachmentInfo:a}=this.viewModel;return"add"===h?this._renderAddForm():"edit"===h?this._renderDetailsForm(a||k):this._renderAttachmentContainer()}_renderLoading(){return r.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},
r.tsx("div",{class:"esri-attachments__loader"}))}_renderProgressBar(){return this.visibleElements.progressBar?r.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}_renderAddForm(){const {submitting:k,selectedFile:h}=this;var a=k||!h,e=this.visibleElements.cancelAddButton?r.tsx("button",{bind:this,class:this.classes(q.globalCss.button,q.globalCss.buttonTertiary,q.globalCss.buttonSmall,q.globalCss.buttonHalf,k&&q.globalCss.buttonDisabled),disabled:k,onclick:this._cancelForm,
type:"button"},this.messages.cancel):null;a=this.visibleElements.addSubmitButton?r.tsx("button",{class:this.classes(q.globalCss.button,q.globalCss.buttonSecondary,q.globalCss.buttonSmall,q.globalCss.buttonHalf,{[q.globalCss.buttonDisabled]:a}),disabled:a,type:"submit"},this.messages.add):null;const f=h?r.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},h.name):null;e=r.tsx("form",{afterCreate:d.storeNode,afterRemoved:d.discardNode,bind:this,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},
r.tsx("fieldset",{class:"esri-attachments__file-fieldset"},f,r.tsx("label",{class:this.classes("esri-attachments__file-label",q.globalCss.button,q.globalCss.buttonSecondary)},h?this.messages.changeFile:this.messages.selectFile,r.tsx("input",{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),a,e);return r.tsx("div",{class:"esri-attachments__form-node",key:"add-form-container"},e)}_renderDetailsForm(k){const {visibleElements:h,viewModel:a,
selectedFile:e,submitting:f}=this;var {capabilities:E}=a,w=f||!e;let L;if(e){var D=e.type;L=e.name;var G=e.size}else if(k&&"file"in k)D=k.file.type,L=k.file.name,G=k.file.size;else if(k&&"contentType"in k){D=k.contentType;L=k.name;G=k.size;var P=k.url}var S=E.editing&&E.operations?.delete&&h.deleteButton?r.tsx("button",{bind:this,class:this.classes(q.globalCss.button,q.globalCss.buttonSmall,q.globalCss.buttonTertiary,"esri-attachments__delete-button",{[q.globalCss.buttonDisabled]:f}),disabled:f,key:"delete-button",
onclick:u=>this._submitDeleteAttachment(u,k),type:"button"},this.messages.delete):void 0;w=E.editing&&E.operations?.update&&h.updateButton?r.tsx("button",{class:this.classes(q.globalCss.button,q.globalCss.buttonSmall,q.globalCss.buttonThird,{[q.globalCss.buttonDisabled]:w}),disabled:w,key:"update-button",type:"submit"},this.messages.update):void 0;const C=this.visibleElements.cancelUpdateButton?r.tsx("button",{bind:this,class:this.classes(q.globalCss.button,q.globalCss.buttonSmall,q.globalCss.buttonTertiary,
q.globalCss.buttonThird,{[q.globalCss.buttonDisabled]:f}),disabled:f,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0;E=E.editing&&E.operations?.update?r.tsx("fieldset",{class:"esri-attachments__file-fieldset",key:"file"},r.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},L),r.tsx("label",{class:this.classes("esri-attachments__file-label",q.globalCss.button,q.globalCss.buttonSecondary)},this.messages.changeFile,r.tsx("input",{bind:this,class:"esri-attachments__file-input",
name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0;G=r.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"size"},r.tsx("label",null,z.formatFileSize(this.messagesUnits,G??0)));D=r.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"content-type"},r.tsx("label",null,D));P=null!=P?r.tsx("a",{class:"esri-attachments__item-link",href:P,rel:"noreferrer",target:"_blank"},this._renderImageMask(k,400),r.tsx("div",{class:"esri-attachments__item-link-overlay"},
r.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},r.tsx("calcite-icon",{icon:"launch"})))):this._renderImageMask(k,400);S=r.tsx("form",{afterCreate:d.storeNode,afterRemoved:d.discardNode,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:u=>this._submitUpdateAttachment(u,k)},r.tsx("div",{class:"esri-attachments__metadata"},G,D),E,r.tsx("div",{class:"esri-attachments__actions"},S,C,w));return r.tsx("div",{class:"esri-attachments__form-node",key:"edit-form-container"},P,S)}_renderImageMask(k,
h){return k?"file"in k?this._renderGenericImageMask(k.file.name,k.file.type):this._renderImageMaskForAttachment(k,h):null}_renderGenericImageMask(k,h){var {supportsResizeAttachments:a}=this.viewModel;h=g.getIconPath(h);a={["esri-attachments__image--resizable"]:a};return r.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask"),key:h},r.tsx("img",{alt:k,class:this.classes(a,"esri-attachments__image"),src:h,title:k}))}_renderImageMaskForAttachment(k,h){var {supportsResizeAttachments:a}=
this.viewModel;if(!k)return null;const {contentType:e,name:f,url:E}=k;if(!a||!g.isSupportedImage(e))return this._renderGenericImageMask(f,e);k=(k=this._getCSSTransform(k))?{transform:k,"image-orientation":"none"}:{};h=`${E}${E?.includes("?")?"\x26":"?"}w=${h}`;a={["esri-attachments__image--resizable"]:a};return r.tsx("div",{class:this.classes("esri-attachments__item-mask"),key:h},r.tsx("img",{alt:f,class:this.classes(a,"esri-attachments__image"),src:h,styles:k,title:f}))}_renderFile(k){const {file:h}=
k;return r.tsx("li",{class:"esri-attachments__item",key:h},r.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button",key:"details-button",onclick:()=>this._startEditFile(k),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(k),r.tsx("label",{class:"esri-attachments__label"},r.tsx("span",{class:"esri-attachments__filename"},h.name||this.messages.noTitle),r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",
d.isRTL(this.container)?l.legacyIcon.left:l.legacyIcon.right)}))))}_renderAttachmentInfo({attachmentInfo:k,displayType:h}){const {viewModel:a,effectiveDisplayType:e}=this,{capabilities:f,supportsResizeAttachments:E}=a,{contentType:w,name:L,url:D}=k;h=this._renderImageMask(k,"list"===h?48:400);var G=f.editing?r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",d.isRTL(this.container)?l.legacyIcon.left:l.legacyIcon.right)}):null;G="preview"===e&&E&&g.isSupportedImage(w)?
null:r.tsx("label",{class:"esri-attachments__label"},r.tsx("span",{class:"esri-attachments__filename"},L||this.messages.noTitle),G);h=[h,G];h=f.editing?r.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button","data-attachment-info-id":k.id,key:"details-button",onclick:()=>this._startEditAttachment(k),title:this.messages.attachmentDetails,type:"button"},h):r.tsx("a",{class:"esri-attachments__item-button",href:D??void 0,key:"details-link",target:"_blank"},
h);return r.tsx("li",{class:"esri-attachments__item",key:k},h)}_renderAttachmentContainer(){const {effectiveDisplayType:k,viewModel:h,visibleElements:a}=this,{attachmentInfos:e,capabilities:f,fileInfos:E}=h;var w=!!e?.length;const L=!!E?.length,D={["esri-attachments__container--list"]:"preview"!==k,["esri-attachments__container--preview"]:"preview"===k},G=f.editing&&f.operations?.add&&a.addButton?r.tsx("button",{bind:this,class:this.classes(q.globalCss.button,q.globalCss.buttonTertiary,"esri-attachments__add-attachment-button"),
onclick:()=>this._startAddAttachment(),type:"button"},r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",l.legacyIcon.plus)}),this.messages.add):void 0,P=w?r.tsx("ul",{class:"esri-attachments__items",key:"attachments-list"},e.toArray().map(C=>this._renderAttachmentInfo({attachmentInfo:C,displayType:k}))):void 0,S=L?r.tsx("ul",{class:"esri-attachments__items",key:"file-list"},E.toArray().map(C=>this._renderFile(C))):void 0;w=L||w?void 0:r.tsx("div",{class:q.globalCss.empty},
this.messages.noAttachments);return r.tsx("div",{class:this.classes("esri-attachments__container",D),key:"attachments-container"},P,S,w,G)}_modeChanged(){this._set("error",null);this._set("selectedFile",null)}_handleFileInputChange(k){k=k.target.files?.item(0);this._set("selectedFile",k)}_submitDeleteAttachment(k,h){k.preventDefault();h&&("file"in h?this.deleteFile(h.file):h&&this.deleteAttachment(h))}_submitAddAttachment(k){k.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(k,
h){k.preventDefault();h&&"file"in h?this.updateFile():this.updateAttachment()}_startEditAttachment(k){const {viewModel:h}=this;h.activeFileInfo=null;h.activeAttachmentInfo=k;h.mode="edit"}_startEditFile(k){const {viewModel:h}=this;h.activeAttachmentInfo=null;h.activeFileInfo=k;h.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(k){k.preventDefault();this.viewModel.mode="view"}_getCSSTransform(k){({orientationInfo:k}=k);return!this._supportsImageOrientation&&k?[k.rotation?`rotate(${k.rotation}deg)`:
"",k.mirrored?"scaleX(-1)":""].join(" "):""}};m.__decorate([H.property()],K.prototype,"capabilities",null);m.__decorate([H.property()],K.prototype,"displayType",void 0);m.__decorate([H.property({readOnly:!0})],K.prototype,"effectiveDisplayType",null);m.__decorate([H.property()],K.prototype,"graphic",null);m.__decorate([H.property()],K.prototype,"label",null);m.__decorate([H.property(),p.messageBundle("esri/widgets/Attachments/t9n/Attachments")],K.prototype,"messages",void 0);m.__decorate([H.property(),
p.messageBundle("esri/core/t9n/Units")],K.prototype,"messagesUnits",void 0);m.__decorate([H.property({readOnly:!0})],K.prototype,"selectedFile",void 0);m.__decorate([H.property({readOnly:!0})],K.prototype,"submitting",void 0);m.__decorate([H.property({readOnly:!0})],K.prototype,"error",void 0);m.__decorate([H.property({type:c})],K.prototype,"viewModel",void 0);m.__decorate([H.property()],K.prototype,"visibleElements",void 0);m.__decorate([J.cast("visibleElements")],K.prototype,"castVisibleElements",
null);return K=m.__decorate([F.subclass("esri.widgets.Attachments")],K)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(b,m,t,y,z,H,J,K){function M(q,l,d){return q.units[l][d]}function F(q,l,d,p=2,r="abbr"){return`${K.formatNumber(l,{minimumFractionDigits:p,maximumFractionDigits:p,signDisplay:0<l?"never":"exceptZero"})} ${M(q,d,r)}`}function A(q,l,d,p=2,r="abbr"){return`${K.formatNumber(l,
{minimumFractionDigits:p,maximumFractionDigits:p,signDisplay:"exceptZero"})} ${M(q,d,r)}`}function c(q,l){const d=JSON.stringify(l);let p=g.get(d);p||(p=new Intl.NumberFormat("en-US",l),g.set(d,p));return/\-?\+?360/.test(p.format(q))?0:q}const g=new Map,n=["B","kB","MB","GB","TB"];b.formatAngleDegrees=function(q,l,d,p,r){r=r??2;q=t.cyclicalDegrees.normalize(z.convertRotationType(J.convertUnit(q,l,"degrees"),d,p),0,!0);r={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,minimumFractionDigits:r,
signDisplay:0<q?"never":"exceptZero"};q=c(q,r);return K.formatNumber(q,r)};b.formatDMS=function(q,l,d=2){q=J.convertUnit(q,l,"degrees");l=q-Math.floor(q);q-=l;l*=60;let p=l-Math.floor(l);l-=p;p*=60;return`${q.toFixed()}\u00b0 ${l.toFixed()}' ${p.toFixed(d)}"`};b.formatDecimal=F;b.formatFileSize=function(q,l){l=Math.round(l);let d=0===l?0:Math.floor(Math.log(l)/Math.log(m.ByteSizeUnit.KILOBYTES));d=y.clamp(d,0,n.length-1);l=K.formatNumber(l/m.ByteSizeUnit.KILOBYTES**d,{maximumFractionDigits:2});return H.replace(q.units.bytes[n[d]],
{fileSize:l})};b.formatImperialArea=function(q,l,d,p=2,r="abbr"){const x=J.adaptiveImperialAreaUnit(l,d);return F(q,J.convertUnit(l,d,x),x,p,r)};b.formatImperialLength=function(q,l,d,p=2,r="abbr"){const x=J.adaptiveImperialLengthUnit(l,d);return F(q,J.convertUnit(l,d,x),x,p,r)};b.formatImperialRelativeLength=function(q,l,d,p=2,r="abbr"){const x=J.adaptiveImperialLengthUnit(l,d);return A(q,J.convertUnit(l,d,x),x,p,r)};b.formatImperialRelativeVerticalLength=function(q,l,d,p=2,r="abbr"){const x=J.adaptiveImperialVerticalLengthUnit(l,
d);return A(q,J.convertUnit(l,d,x),x,p,r)};b.formatImperialVerticalLength=function(q,l,d,p=2,r="abbr"){const x=J.adaptiveImperialVerticalLengthUnit(l,d);return F(q,J.convertUnit(l,d,x),x,p,r)};b.formatMetricArea=function(q,l,d,p=2,r="abbr"){const x=J.adaptiveMetricAreaUnit(l,d);return F(q,J.convertUnit(l,d,x),x,p,r)};b.formatMetricLength=function(q,l,d,p=2,r="abbr"){const x=J.adaptiveMetricLengthUnit(l,d);return F(q,J.convertUnit(l,d,x),x,p,r)};b.formatMetricRelativeLength=function(q,l,d,p=2,r="abbr"){const x=
J.adaptiveMetricLengthUnit(l,d);return A(q,J.convertUnit(l,d,x),x,p,r)};b.formatMetricRelativeVerticalLength=function(q,l,d,p=2,r="abbr"){const x=J.adaptiveMetricVerticalLengthUnit(l,d);return A(q,J.convertUnit(l,d,x),x,p,r)};b.formatMetricVerticalLength=function(q,l,d,p=2,r="abbr"){const x=J.adaptiveMetricVerticalLengthUnit(l,d);return F(q,J.convertUnit(l,d,x),x,p,r)};b.formatRelativeAngleDegrees=function(q,l,d,p,r){d!==p&&(q=-q);r=r??2;d={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,
minimumFractionDigits:r,signDisplay:"exceptZero"};q=J.convertUnit(q,l,"degrees")%360;q=c(q,d);return K.formatNumber(q,d)};b.formatRelativeDecimal=A;b.unitName=M;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(b){b.ByteSizeUnit=void 0;var m=b.ByteSizeUnit||(b.ByteSizeUnit={});m[m.KILOBYTES=1024]="KILOBYTES";m[m.MEGABYTES=1048576]="MEGABYTES";m[m.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(b,m){function t(g,n){return{type:m.unitType(n),value:g,unit:n}}function y(g,n){return{type:m.unitType(n),value:g,unit:n}}function z(g,n){return{type:m.unitType(n),value:g,unit:n}}function H(g,n,q="arithmetic"){return{type:m.unitType(n),value:g,unit:n,rotationType:q}}function J(g,n){const q=K(g,n);return"angle"===g.type?H(q,n,g.rotationType):t(q,n)}function K(g,n){return m.convertUnit(g.value,g.unit,
n)}const M=y(0,"meters"),F=z(0,"square-meters"),A=H(0,"radians"),c=H(0,"degrees");b.convertRotationType=function(g,n,q){if(n===q)return g;switch(q){case "arithmetic":case "geographic":return-g+90}};b.createAngle=H;b.createArea=z;b.createLength=y;b.createQuantity=t;b.createVolume=function(g,n){return{type:m.unitType(n),value:g,unit:n}};b.isBaseUnit=function(g){return m.isBaseUnit(g.unit)};b.max=function(g,n){return null==g?n:null==n?g:g.value>m.convertUnit(n.value,n.unit,g.unit)?g:n};b.min=function(g,
n){return null==g?n:null==n?g:g.value<m.convertUnit(n.value,n.unit,g.unit)?g:n};b.scale=function(g,n){return null==g?null:{...g,value:g.value*n}};b.toBaseUnit=function(g){return J(g,m.baseUnitForUnit(g.unit))};b.toUnit=J;b.valueInUnit=K;b.zeroDegrees=c;b.zeroMeters=M;b.zeroRadians=A;b.zeroSquareMeters=F;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n){const q={editing:!1,operations:{add:!0,update:!0,delete:!0}},l=y.ofType(c);t=class extends t{constructor(d){super(d);this._attachmentLayer=this._getAttachmentsPromise=null;this.capabilities={...q};this.activeFileInfo=this.activeAttachmentInfo=null;this.attachmentInfos=new l;this.fileInfos=new y;this.graphic=null;this.mode="view";this.filesEnabled=!1;this.addHandles(H.watch(()=>this.graphic,()=>this._graphicChanged(),H.initial))}destroy(){this.graphic=this._attachmentLayer=
null}castCapabilities(d){return{...q,...d}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){var {graphic:d}=this;if(!d)return!1;d=d.layer||d.sourceLayer;return d?.loaded&&"capabilities"in d&&d.capabilities&&"operations"in d.capabilities&&"supportsResizeAttachments"in d.capabilities.operations&&d.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const {_attachmentLayer:d,attachmentInfos:p}=this;if(!d||
"function"!==typeof d.queryAttachments)throw new z("invalid-layer","getAttachments(): A valid layer is required.");const r=this._getObjectId();var x=new g({objectIds:[r],returnMetadata:!0});const N=[];this._getAttachmentsPromise=x=d.queryAttachments(x).then(k=>k[r]||N).catch(()=>N);this.notifyChange("state");x=await x;p.removeAll();x.length&&p.addMany(x);this._getAttachmentsPromise=null;this.notifyChange("state");return x}async addAttachment(d,p=this.graphic){const {_attachmentLayer:r,attachmentInfos:x,
capabilities:N}=this;if(!p)throw new z("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:p});if(!d)throw new z("invalid-attachment","addAttachment(): An attachment is required.",{attachment:d});if(!N.operations?.add)throw new z("invalid-capabilities","addAttachment(): add capabilities are required.");if(!r||"function"!==typeof r.addAttachment)throw new z("invalid-layer","addAttachment(): A valid layer is required.");d=await r.addAttachment(p,d).then(k=>this._queryAttachment(k.objectId,
p));x.add(d);return d}async deleteAttachment(d){const {_attachmentLayer:p,attachmentInfos:r,graphic:x,capabilities:N}=this;if(!d)throw new z("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:d});if(!N.operations?.delete)throw new z("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!p||"function"!==typeof p.deleteAttachments)throw new z("invalid-layer","deleteAttachment(): A valid layer is required.");if(!x)throw new z("invalid-graphic",
"deleteAttachment(): A graphic is required.");const k=await p.deleteAttachments(x,[d.id]).then(()=>d);r.remove(k);return k}async updateAttachment(d,p=this.activeAttachmentInfo){const {_attachmentLayer:r,attachmentInfos:x,graphic:N,capabilities:k}=this;if(!d)throw new z("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:d});if(!p)throw new z("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:p});if(!k.operations?.update)throw new z("invalid-capabilities",
"updateAttachment(): Update capabilities are required.");const h=x.indexOf(p);if(!r||"function"!==typeof r.updateAttachment)throw new z("invalid-layer","updateAttachment(): A valid layer is required.");if(!N)throw new z("invalid-graphic","updateAttachment(): A graphic is required.");d=await r.updateAttachment(N,p.id,d).then(a=>this._queryAttachment(a.objectId));x.splice(h,1,d);return d}async commitFiles(){await Promise.all(this.fileInfos.items.map(d=>this.addAttachment(d.form)));this.fileInfos.removeAll();
return this.getAttachments()}addFile(d,p){if(!d||!p)return null;d={file:d,form:p};this.fileInfos.add(d);return d}updateFile(d,p,r=this.activeFileInfo){if(!d||!p||!r)return null;r=this.fileInfos.indexOf(r);-1<r&&this.fileInfos.splice(r,1,{file:d,form:p});return this.fileInfos.items[r]}deleteFile(d){const p=this.fileInfos.find(r=>r.file===d);return p?(this.fileInfos.remove(p),p):null}async _queryAttachment(d,p){const {_attachmentLayer:r}=this;if(!d||!r?.queryAttachments)throw new z("invalid-attachment-id",
"Could not query attachment.");const x=this._getObjectId(p);d=new g({objectIds:[x],attachmentsWhere:`AttachmentId=${d}`,returnMetadata:!0});return r.queryAttachments(d).then(N=>N[x][0])}_getObjectId(d=this.graphic){return d?.getObjectId()??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){var {graphic:d}=this;this._attachmentLayer=(d=n.getSourceLayer(d))?"scene"===d.type&&null!=d.associatedLayer?d.associatedLayer:d:null}};b.__decorate([J.property()],
t.prototype,"capabilities",void 0);b.__decorate([K.cast("capabilities")],t.prototype,"castCapabilities",null);b.__decorate([J.property()],t.prototype,"activeAttachmentInfo",void 0);b.__decorate([J.property()],t.prototype,"activeFileInfo",void 0);b.__decorate([J.property({readOnly:!0,type:l})],t.prototype,"attachmentInfos",void 0);b.__decorate([J.property()],t.prototype,"fileInfos",void 0);b.__decorate([J.property({type:m})],t.prototype,"graphic",void 0);b.__decorate([J.property()],t.prototype,"mode",
void 0);b.__decorate([J.property({readOnly:!0})],t.prototype,"state",null);b.__decorate([J.property()],t.prototype,"filesEnabled",void 0);b.__decorate([J.property({readOnly:!0})],t.prototype,"supportsResizeAttachments",null);return t=b.__decorate([A.subclass("esri.widgets.Attachments.AttachmentsViewModel")],t)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),
function(b,m,t,y,z,H,J,K){var M;const F={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};m=M=class extends m.JSONSupport{constructor(A){super(A);this.url=this.size=this.parentObjectId=this.parentGlobalId=this.name=this.keywords=this.globalId=this.id=this.exifInfo=this.contentType=null}get orientationInfo(){var {exifInfo:A}=
this;A=K.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:A});return F[A]||null}clone(){return new M({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};b.__decorate([t.property({type:String})],m.prototype,"contentType",void 0);b.__decorate([t.property()],m.prototype,"exifInfo",void 0);b.__decorate([t.property({readOnly:!0})],
m.prototype,"orientationInfo",null);b.__decorate([t.property({type:y.Integer})],m.prototype,"id",void 0);b.__decorate([t.property({type:String})],m.prototype,"globalId",void 0);b.__decorate([t.property({type:String})],m.prototype,"keywords",void 0);b.__decorate([t.property({type:String})],m.prototype,"name",void 0);b.__decorate([t.property({json:{read:!1}})],m.prototype,"parentGlobalId",void 0);b.__decorate([t.property({json:{read:!1}})],m.prototype,"parentObjectId",void 0);b.__decorate([t.property({type:y.Integer})],
m.prototype,"size",void 0);b.__decorate([t.property({json:{read:!1}})],m.prototype,"url",void 0);return m=M=b.__decorate([J.subclass("esri.layers.support.AttachmentInfo")],m)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(b){function m(t){const {tagName:y,tags:z}=t;return z&&y?z.find(H=>H.name===y)?.value||null:null}b.getExifValue=function(t){const {exifInfo:y,exifName:z,tagName:H}=t;return y&&z&&H?(t=y.find(J=>J.name===z))?m({tagName:H,tags:t.tags}):null:null};Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../smartMapping/support/utils ../../../support/arcadeOnDemand ../../../time/timeZoneUtils".split(" "),function(b,m,t,y,z,H,J,K,M,F){function A(I){return I?X.test(I):!1}function c(I,O){if(!A(O)||!I)return null;const R=O.replace(X,"").toLowerCase();
let W=null;I.some(Z=>Z.name.toLowerCase()===R?(W=Z,!0):!1);return W}function g(I,O){return(O=n(O,I))?O.name:I}function n(I,O){return I&&"function"===typeof I.getField&&O?I.getField(O)??null:null}function q({formattedAttributes:I,template:O,fieldInfoMap:R}){return`${t.replace(t.replace(O,W=>`{${R.get(W.toLowerCase())?.fieldName||W}}`),I).replaceAll(B,"")}`.trim()}function l(I,O,R=!1){const W=O[I];"string"===typeof W&&(R=(R?encodeURIComponent(W):W).replaceAll(T,"%27"),O[I]=R)}function d(I,O=!1){const R=
{...I};Object.keys(R).forEach(W=>l(W,R,O));return R}function p(I,O){return I.replaceAll(Q,(R,W,Z)=>(R=n(O,Z))?`{${R.name}}`:W)}function r(I,O,R){return(I=p(I,R))?I.replaceAll(aa,(W,Z,ca)=>{Z=`${Z||ca}`.trim();return t.replace(W,d(O,Z&&"{"!==Z[0]||!1))}):I}function x(I){return null!=I&&"object"===typeof I&&"fieldsIndex"in I&&"geometryType"in I&&"getField"in I&&"load"in I&&"loaded"in I&&"objectIdField"in I&&"spatialReference"in I&&"type"in I&&("feature"===I.type||"scene"===I.type)&&"when"in I}function N(I){return null!=
I&&"object"===typeof I&&"createQuery"in I&&"queryFeatureCount"in I&&"queryObjectIds"in I&&"queryRelatedFeatures"in I&&"queryRelatedFeaturesCount"in I&&"relationships"in I}function k(I){return x(I)&&N(I)}function h(I,O){const {fieldInfos:R,fieldName:W,preventPlacesFormatting:Z,layer:ca,timeZone:fa}=O;O=e(R,W);var ha=n(ca,W);if(O&&!H.isRasterPixelValueField(W)){ha=ha?.type;const ia=O.format?.dateFormat;if("date"===ha||"date-only"===ha||"time-only"===ha||"timestamp-offset"===ha||ia)return K.formatAnyDate(I,
{format:ia,fieldType:ha,timeZoneOptions:{layerTimeZone:ca&&"preferredTimeZone"in ca?ca.preferredTimeZone:null,viewTimeZone:fa,datesInUnknownTimezone:ca&&"datesInUnknownTimezone"in ca?!!ca.datesInUnknownTimezone:!1}})}O=O?.format;if("string"===typeof I&&H.isRasterPixelValueField(W)&&O)return I=I.trim(),/\d{2}-\d{2}/.test(I)?I:I.includes(",")?a(I,",",", ",O):I.includes(";")?a(I,";","; ",O):I.includes(" ")?a(I," "," ",O):z.formatNumber(Number(I),z.convertNumberFormatToIntlOptions(O));"string"!==typeof I||
!O||null!=O.dateFormat||null==O.places&&null==O.digitSeparator||(ha=Number(I),isNaN(ha)||(I=ha));return"string"===typeof I||null==I||null==O?w(I):Z?z.formatNumber(I,{...z.convertNumberFormatToIntlOptions(O),minimumFractionDigits:0,maximumFractionDigits:20}):z.formatNumber(I,z.convertNumberFormatToIntlOptions(O))}function a(I,O,R,W){return I.trim().split(O).map(Z=>z.formatNumber(Number(Z),z.convertNumberFormatToIntlOptions(W))).join(R)}function e(I,O){if(I?.length&&O)return I.find(R=>R.fieldName?.toLowerCase()===
O.toLowerCase())}function f({fieldName:I,graphic:O,layer:R}){if(P(I)||!R||"function"!==typeof R.getFeatureType)return null;const {typeIdField:W}=R;return W&&I===W?(I=R.getFeatureType(O))?I.name:null:null}function E({fieldName:I,value:O,graphic:R,layer:W}){return P(I)||!W||"function"!==typeof W.getFieldDomain?null:(I=R&&W.getFieldDomain(I,{feature:R}))&&"coded-value"===I.type?I.getName(O):null}function w(I){return"string"===typeof I?I.replaceAll(ba,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):I}function L(I){const {value:O,
fieldName:R,fieldInfos:W,fieldInfoMap:Z,layer:ca,graphic:fa,timeZone:ha}=I;return null==O?"":(I=E({fieldName:R,value:O,graphic:fa,layer:ca}))||(I=f({fieldName:R,graphic:fa,layer:ca}))?I:Z.get(R.toLowerCase())?h(O,{fieldInfos:W||Array.from(Z.values()),fieldName:R,layer:ca,timeZone:ha}):(I=ca?.fieldsIndex?.get(R))&&(K.isAnyDateField(I)||H.isTimeOnlyField(I))?K.formatAnyDate(O,{fieldType:I.type,timeZoneOptions:{layerTimeZone:ca&&"preferredTimeZone"in ca?ca.preferredTimeZone:null,viewTimeZone:ha,datesInUnknownTimezone:ca&&
"datesInUnknownTimezone"in ca?!!ca.datesInUnknownTimezone:!1}}):w(O)}async function D(I,O){const {layer:R,graphic:W,outFields:Z,objectIds:ca,returnGeometry:fa,spatialReference:ha}=I;I=ca[0];if("number"!==typeof I&&"string"!==typeof I)return v.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",{layer:R,graphic:W,objectId:I,requiredFields:Z}),null;if(!J.getEffectiveLayerCapabilities(R)?.operations?.supportsQuery)return v.warn("The specified layer cannot be queried. The following fields will not be available.",
{layer:R,graphic:W,requiredFields:Z,returnGeometry:fa}),null;I=R.createQuery();I.objectIds=ca;I.outFields=Z?.length?Z:[R.objectIdField];I.returnGeometry=!!fa;I.returnZ=!!fa;I.returnM=!!fa;I.outSpatialReference=ha;return(await R.queryFeatures(I,O)).features[0]}async function G(I){if(!I.expressionInfos?.length)return!1;var O=await M.loadArcade();({arcadeUtils:{hasGeometryFunctions:O}}=O);return O(I)}function P(I=""){return I?I.includes("relationships/"):!1}function S({attributes:I,graphic:O,relatedInfo:R,
fieldInfos:W,fieldInfoMap:Z,layer:ca,timeZone:fa}){I&&O&&R&&Object.keys(O.attributes).forEach(ha=>{var ia=(ia={layerId:R.relation.id.toString(),fieldName:ha},`${"relationships/"}${ia.layerId}/${ia.fieldName}`);I[ia]=L({fieldName:ia,fieldInfos:W,fieldInfoMap:Z,layer:ca,value:O.attributes[ha],graphic:O,timeZone:fa})})}function C({attributes:I,relatedInfo:O,fieldInfoMap:R,fieldInfos:W,layer:Z,timeZone:ca}){I&&O&&(O.relatedFeatures?.forEach(fa=>S({attributes:I,graphic:fa,relatedInfo:O,fieldInfoMap:R,
fieldInfos:W,layer:Z,timeZone:ca})),O.relatedStatsFeatures?.forEach(fa=>S({attributes:I,graphic:fa,relatedInfo:O,fieldInfoMap:R,fieldInfos:W,layer:Z,timeZone:ca})))}function u(I,O,R){const W="scene"===O.type&&O.associatedLayer?O.associatedLayer.url:O.url;return I.filter(k).find(Z=>Z!==O&&Z.url===W&&Z.layerId===R.relatedTableId)}const v=m.getLogger("esri.widgets.Feature.support.featureUtils"),B=/href=(""|'')/gi,Q=/(\{([^\{\r\n]+)\})/g,T=/'/g,X=/^\s*expression\//i,ba=/(\n)/gi,da=/[\u00A0-\u9999<>&]/gim,
aa=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,ea=/^(?:mailto:|tel:)/,Y=y.convertDateFormatToIntlOptions("short-date-short-time"),U=I=>{if(!I)return!1;I=I.toUpperCase();return I.includes("CURRENT_TIMESTAMP")||I.includes("CURRENT_DATE")||I.includes("CURRENT_TIME")},V=({layer:I,method:O,query:R,definitionExpression:W})=>{I.capabilities?.query?.supportsCacheHint&&"attachments"!==O&&(I=null!=R.where?R.where:null,O=null!=R.geometry?R.geometry:null,U(W)||U(I)||"extent"===O?.type||"tile"===R.resultType||(R.cacheHint=
!0))};b.applyTextFormattingHTML=w;b.createfieldInfoMap=function(I,O){const R=new Map;if(!I)return R;I.forEach(W=>{const Z=g(W.fieldName,O);W.fieldName=Z;R.set(Z.toLowerCase(),W)});return R};b.findRelatedLayer=function(I,O,R){return I&&O&&R?u(I.allLayers,O,R)||u(I.allTables,O,R):null};b.fixTokens=p;b.formatAttributes=function({fieldInfos:I,attributes:O,layer:R,graphic:W,fieldInfoMap:Z,relatedInfos:ca,timeZone:fa}){const ha={};ca?.forEach(ia=>C({attributes:ha,relatedInfo:ia,fieldInfoMap:Z,fieldInfos:I,
layer:R,timeZone:fa}));O&&Object.keys(O).forEach(ia=>{ha[ia]=L({fieldName:ia,fieldInfos:I,fieldInfoMap:Z,layer:R,value:O[ia],graphic:W,timeZone:fa})});return ha};b.formatEditInfo=function(I,O,R,W){const {creatorField:Z,creationDateField:ca,editorField:fa,editDateField:ha}=I;if(O){I=F.getTimeZoneFormattingOptions(W&&"preferredTimeZone"in W?W.preferredTimeZone:null,W&&"datesInUnknownTimezone"in W?!!W.datesInUnknownTimezone:!1,R,Y,"date");I={...Y,...I};R=O[ha];if("number"===typeof R)return O=O[fa],{type:"edit",
date:y.formatDate(R,I),user:O};R=O[ca];return"number"===typeof R?(O=O[Z],{type:"create",date:y.formatDate(R,I),user:O}):null}};b.formatValueToFieldInfo=h;b.getAllFieldInfos=function(I){const O=[];if(!I)return O;const {fieldInfos:R,content:W}=I;R&&O.push(...R);if(!W||!Array.isArray(W))return O;W.forEach(Z=>{"fields"===Z.type&&(Z=Z?.fieldInfos)&&O.push(...Z)});return O};b.getFieldInfo=e;b.getFieldInfoLabel=function(I,O){return(O=c(O,I?.fieldName))?O.title||null:I?I.label||I.fieldName:null};b.getFixedFieldName=
g;b.getFixedFieldNames=function(I,O){return I&&I.map(R=>g(R,O))};b.getHighlightKeyForFeature=function(I){const O=I.getObjectId();return null!=O?`oid:${O}`:`uid:${I.uid}`};b.getSourceLayer=function(I){if(null!=I)return(I.sourceLayer||I.layer)??void 0};b.graphicCallback=async function(I,O){return"function"===typeof I?I(O):I};b.htmlEntities=function(I){return I.replaceAll(da,O=>`&#${O.charCodeAt(0)};`)};b.isExpressionField=A;b.isFeatureSupportedLayer=x;b.isGraphicForRelatableFeatureSupportedLayer=function(I){return!!I&&
"object"===typeof I&&"sourceLayer"in I&&k(I.sourceLayer)};b.isRelatableFeatureSupportedLayer=k;b.isRelatableLayer=N;b.isRelatedField=P;b.preLayerQueryCallback=({query:I,layer:O,method:R})=>{V({layer:O,method:R,query:I,definitionExpression:`${O.definitionExpression} ${O.serviceDefinitionExpression}`})};b.preRequestCallback=({queryPayload:I,layer:O,method:R})=>{V({layer:O,method:R,query:I,definitionExpression:`${O.definitionExpression} ${O.serviceDefinitionExpression}`})};b.querySourceLayer=D;b.queryUpdatedFeature=
async function({graphic:I,popupTemplate:O,layer:R,spatialReference:W},Z){if(R&&O&&("function"===typeof R.load&&await R.load(Z),I.attributes)){var ca=I.attributes[R.objectIdField];if(null!=ca){ca=[ca];var fa=await O.getRequiredFields(R.fieldsIndex),ha=H.featureHasFields(fa,I);fa=ha?[]:fa;O=O.returnGeometry||await G(O);if(!ha||O)if(R=await D({layer:R,graphic:I,outFields:fa,objectIds:ca,returnGeometry:O,spatialReference:W},Z))R.geometry&&(I.geometry=R.geometry),R.attributes&&(I.attributes={...I.attributes,
...R.attributes})}}};b.shouldOpenInNewTab=function(I=""){if(I)return!ea.test(I.trim().toLowerCase())};b.substituteAttributes=q;b.substituteFieldsInLinksAndAttributes=function({attributes:I,globalAttributes:O,layer:R,text:W,expressionAttributes:Z,fieldInfoMap:ca}){return W?q({formattedAttributes:O,template:r(W,{...O,...Z,...I},R),fieldInfoMap:ca}):""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(b,m,t,y,z,H){function J(n){return String(n).padStart(2,"0")}function K(n,q,l){if("date"===q||"number"===q){"number"===q&&(n=new Date(n));q=l?n.getFullYear():n.getUTCFullYear();const d=J((l?n.getMonth():n.getUTCMonth())+1),p=J(l?n.getDate():n.getUTCDate()),r=J(l?n.getHours():n.getUTCHours()),x=J(l?n.getMinutes():n.getUTCMinutes());n=J(l?n.getSeconds():n.getUTCSeconds());n=`TIMESTAMP'${q}-${d}-${p} ${r}:${x}:${n}'`}return n}function M(n,q){if(q instanceof Date)return"date";if("number"===typeof q)return"number";
if("string"===typeof q&&(n=n.getField(q),"\x3cnow\x3e"!==q.toLowerCase()&&t.isDateField(n)))return"field"}const F={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},A={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},c=new Set(["integer","small-integer"]);let g=null;b.castIntegerFieldToFloat=function(n){return`cast(${n} as float)`};b.dateTypes=["date","date-only","timestamp-offset"];
b.defaultBasemapGroups=F;b.fieldDelimiter=",";b.formatAnyDate=function(n,q){const {format:l,timeZoneOptions:d,fieldType:p}=q??{};let r;d&&({timeZone:x,timeZoneName:r}=H.getTimeZoneFormattingOptions(d.layerTimeZone,d.datesInUnknownTimezone,d.viewTimeZone,m.convertDateFormatToIntlOptions(l||"short-date-short-time"),p));if("string"===typeof n&&isNaN(Date.parse("time-only"===p?`1970-01-01T${n}Z`:n)))return n;switch(p){case "date-only":var x=m.convertDateFormatToIntlOptions(l||"short-date");return"string"===
typeof n?m.formatDateOnly(n,{...x}):m.formatDate(n,{...x,timeZone:H.utc});case "time-only":return x=m.convertDateFormatToIntlOptions(l||"short-time"),"string"===typeof n?m.formatTimeOnly(n,x):m.formatDate(n,{...x,timeZone:H.utc});case "timestamp-offset":if(!x&&"string"===typeof n&&(new Date(n)).toISOString()!==n)return n;x=(q=l||d?m.convertDateFormatToIntlOptions(l||"short-date-short-time"):void 0)?{...q,timeZone:x,timeZoneName:r}:void 0;return"string"===typeof n?m.formatTimestamp(n,x):m.formatDate(n,
x);default:return q=l||d?m.convertDateFormatToIntlOptions(l||"short-date-short-time"):void 0,m.formatDate("string"===typeof n?new Date(n):n,q?{...q,timeZone:x,timeZoneName:r}:void 0)}};b.getBasemapGroup=function(n,q=F){for(const l in q)if(q[l].includes(n))return l};b.getBasemapId=function(n,q,l=!0){let d=null;n&&("string"===typeof n?q.includes(n)&&(d=n):d=z.getWellKnownBasemapId(n));return l?d||"gray":d};b.getDateDiffSQL=function(n,q,l,d){const {hasQueryEngine:p}=n;l=K(l,M(n,l),p);n=K(q,M(n,q),p);
n=`(${l} - ${n})`;d=A[d];q="/";1>d&&(d=1/d,q="*");return{sqlExpression:1===d?n:`(${n} ${q} ${d})`,sqlWhere:null}};b.getDateType=M;b.getFieldsList=async function(n){const {field:q,field2:l,field3:d,normalizationField:p,valueExpression:r}=n;n=[];r&&(g||({arcadeUtils:n}=await y.loadArcade(),g=n),n=g.extractFieldNames(r));q&&n.push(q);l&&n.push(l);d&&n.push(d);p&&n.push(p);return n};b.getNormalizationType=function(n){let q=n.normalizationType;q||(n.normalizationField?q="field":null!=n.normalizationTotal&&
(q="percent-of-total"));return q??void 0};b.isAnyDateField=function(n){return t.isDateField(n)||t.isDateOnlyField(n)||t.isTimestampOffsetField(n)};b.isIntegerField=function(n,q){n=q&&n.getField(q);return!!n&&c.has(n.type)};b.unitValueInDays=A;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(b,m){b.getIconPath=function(t){const y=m.getAssetUrl("esri/themes/base/images/files/");
return t?"text/plain"===t?`${y}text-32.svg`:"application/pdf"===t?`${y}pdf-32.svg`:"text/csv"===t?`${y}csv-32.svg`:"application/gpx+xml"===t?`${y}gpx-32.svg`:"application/x-dwf"===t?`${y}cad-32.svg`:"application/postscript"===t||"application/json"===t||"text/xml"===t||"model/vrml"===t?`${y}code-32.svg`:"application/x-zip-compressed"===t||"application/x-7z-compressed"===t||"application/x-gzip"===t||"application/x-tar"===t||"application/x-gtar"===t||"application/x-bzip2"===t||"application/gzip"===t||
"application/x-compress"===t||"application/x-apple-diskimage"===t||"application/x-rar-compressed"===t||"application/zip"===t?`${y}zip-32.svg`:t.includes("image/")?`${y}image-32.svg`:t.includes("audio/")?`${y}sound-32.svg`:t.includes("video/")?`${y}video-32.svg`:t.includes("msexcel")||t.includes("ms-excel")||t.includes("spreadsheetml")?`${y}excel-32.svg`:t.includes("msword")||t.includes("ms-word")||t.includes("wordprocessingml")?`${y}word-32.svg`:t.includes("powerpoint")||t.includes("presentationml")?
`${y}report-32.svg`:`${y}generic-32.svg`:`${y}generic-32.svg`};b.isSupportedImage=function(t){t=t.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(b){b.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(b,m,t,y,z,H,J){t=class extends J{constructor(K){super(K);this.title=this.description=null}};b.__decorate([m.property()],t.prototype,"description",void 0);b.__decorate([m.property()],t.prototype,"title",void 0);return t=b.__decorate([H.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],t)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(b,m,t,y,z,H,J,K,M,F){t=class extends J{constructor(A,c){super(A,c);this.description=null;this.headingLevel=2;this.title=null}render(){return F.tsx("div",{class:"esri-feature-element-info"},this._renderTitle(),this._renderDescription())}_renderTitle(){const {title:A}=this;return A?F.tsx(K.Heading,{class:"esri-feature-element-info__title",level:this.headingLevel},A):null}_renderDescription(){const {description:A}=this;return A?F.tsx("div",{class:"esri-feature-element-info__description",key:"description"},
A):null}};b.__decorate([m.property()],t.prototype,"description",void 0);b.__decorate([m.property()],t.prototype,"headingLevel",void 0);b.__decorate([m.property()],t.prototype,"title",void 0);return t=b.__decorate([H.subclass("esri.widgets.Feature.support.FeatureElementInfo")],t)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(b,m,t,y,z){b.Heading=function({level:H,class:J,...K},M){H=m.clamp(Math.ceil(H),1,
6);return z.tsx(`h${H}`,{...K,"aria-level":String(H),class:y.classes(t.globalCss.heading,J),role:"heading"},M)};b.incrementHeadingLevel=function(H,J=1){return m.clamp(Math.ceil(H+J),1,6)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A){t=class extends J{constructor(c,g){super(c,g);this.viewModel=null;this._addTargetToAnchors=n=>{Array.from(n.querySelectorAll("a")).forEach(q=>{M.shouldOpenInNewTab(q.href)&&!q.hasAttribute("target")&&q.setAttribute("target","_blank")})}}get creator(){return this.viewModel?.creator}set creator(c){this.viewModel&&(this.viewModel.creator=c)}get graphic(){return this.viewModel?.graphic}set graphic(c){this.viewModel&&(this.viewModel.graphic=c)}render(){return A.tsx("div",
{class:"esri-feature-content"},"loading"===this.viewModel?.state?this._renderLoading():this._renderCreated())}_renderLoading(){return A.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},A.tsx("div",{class:"esri-feature-content__loader"}))}_renderCreated(){const c=this.viewModel?.created;return c?c instanceof HTMLElement?A.tsx("div",{afterCreate:this._attachToNode,bind:c,key:c}):F.isWidget(c)?A.tsx("div",{key:c},!c.destroyed&&c.render()):A.tsx("div",{afterCreate:this._addTargetToAnchors,
innerHTML:c,key:c}):null}_attachToNode(c){c.appendChild(this)}};b.__decorate([m.property()],t.prototype,"creator",null);b.__decorate([m.property()],t.prototype,"graphic",null);b.__decorate([m.property({type:K})],t.prototype,"viewModel",void 0);return t=b.__decorate([H.subclass("esri.widgets.Feature.FeatureContent")],t)})},"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),
function(b,m,t,y,z,H,J,K,M,F){t=class extends t{constructor(A){super(A);this.graphic=this.destroyer=this.creator=this.created=this._loadingPromise=null;this.addHandles(y.watch(()=>this.creator,c=>{this._destroyContent();this._createContent(c)},y.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const {created:A,graphic:c,destroyer:g}=this;A&&c&&(F.graphicCallback(g,{graphic:c}).catch(()=>null),this._set("created",null))}async _createContent(A){var c=
this.graphic;c&&A&&(this._loadingPromise=A=F.graphicCallback(A,{graphic:c}).catch(()=>null),this.notifyChange("state"),c=await A,A===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",c)))}};b.__decorate([z.property({readOnly:!0})],t.prototype,"created",void 0);b.__decorate([z.property()],t.prototype,"creator",void 0);b.__decorate([z.property()],t.prototype,"destroyer",void 0);b.__decorate([z.property({type:m})],t.prototype,"graphic",void 0);b.__decorate([z.property({readOnly:!0})],
t.prototype,"state",null);return t=b.__decorate([M.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],t)})},"esri/widgets/Feature/FeatureExpression":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent ./FeatureFields ./FeatureMedia ./FeatureExpression/FeatureExpressionViewModel ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/jsxFactory".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l){y=class extends K{constructor(d,p){super(d,p);this._contentWidget=null;this.viewModel=new c}initialize(){this.addHandles(m.watch(()=>this.viewModel?.contentElementViewModel,()=>this._setupExpressionWidget(),m.initial))}destroy(){this._destroyContentWidget()}render(){const {state:d}=this.viewModel;return l.tsx("div",{class:"esri-feature-expression"},"loading"===d?this._renderLoading():"disabled"===d?null:this._contentWidget?.render())}_renderLoading(){return l.tsx("div",
{class:"esri-feature__loading-container",key:"loading-container"},l.tsx("span",{class:this.classes(n.legacyIcon.loadingIndicator,g.globalCss.rotating,"esri-feature__loading-spinner")}))}_destroyContentWidget(){const {_contentWidget:d}=this;d&&(d.viewModel=null,d.destroy());this._contentWidget=null}_setupExpressionWidget(){const {contentElementViewModel:d,contentElement:p}=this.viewModel,r=p?.type;this._destroyContentWidget();this._contentWidget=d?"fields"===r?new F({viewModel:d}):"media"===r?new A({viewModel:d}):
"text"===r?new M({viewModel:d}):null:null;this.scheduleRender()}};b.__decorate([t.property({type:c})],y.prototype,"viewModel",void 0);return y=b.__decorate([J.subclass("esri.widgets.Feature.FeatureExpression")],y)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/globalCss ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q){y=class extends K{constructor(l,d){super(l,d);this._featureElementInfo=null;this.viewModel=new M;this.messagesURIUtils=this.messages=null}initialize(){this._featureElementInfo=new F;this.addHandles(m.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),m.initial))}destroy(){this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(l){this.viewModel.attributes=l}get description(){return this.viewModel.description}set description(l){this.viewModel.description=
l}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(l){this.viewModel.expressionInfos=l}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(l){this.viewModel.fieldInfos=l}get title(){return this.viewModel.title}set title(l){this.viewModel.title=l}render(){return q.tsx("div",{class:"esri-feature-fields"},this._featureElementInfo?.render(),this._renderFields())}_renderFieldInfo(l,d){var {attributes:p}=this.viewModel;const r=l.fieldName,x=l.label||r;p=p?null==
p[r]?"":p[r]:"";l=!(!l.format||!l.format.dateFormat);p="number"!==typeof p||l?c.autoLink(this.messagesURIUtils,p):this._forceLTR(p);l={["esri-feature-fields__field-data--date"]:l};return q.tsx("tr",{key:`fields-element-info-row-${r}-${d}`},q.tsx("th",{class:"esri-feature-fields__field-header",innerHTML:x,key:`fields-element-info-row-header-${r}-${d}`}),q.tsx("td",{class:this.classes("esri-feature-fields__field-data",l),innerHTML:p,key:`fields-element-info-row-data-${r}-${d}`}))}_renderFields(){const {formattedFieldInfos:l}=
this.viewModel;return l?.length?q.tsx("table",{class:A.globalCss.table,summary:this.messages.fieldsSummary},q.tsx("tbody",null,l.map((d,p)=>this._renderFieldInfo(d,p)))):null}_setupFeatureElementInfo(){const {description:l,title:d}=this;this._featureElementInfo?.set({description:l,title:d})}_forceLTR(l){return`&lrm;${l}`}};b.__decorate([t.property()],y.prototype,"attributes",null);b.__decorate([t.property()],y.prototype,"description",null);b.__decorate([t.property()],y.prototype,"expressionInfos",
null);b.__decorate([t.property()],y.prototype,"fieldInfos",null);b.__decorate([t.property()],y.prototype,"title",null);b.__decorate([t.property({type:M,nonNullable:!0})],y.prototype,"viewModel",void 0);b.__decorate([t.property(),n.messageBundle("esri/widgets/Feature/t9n/Feature")],y.prototype,"messages",void 0);b.__decorate([t.property(),n.messageBundle("esri/widgets/support/t9n/uriUtils")],y.prototype,"messagesURIUtils",void 0);return y=b.__decorate([J.subclass("esri.widgets.Feature.FeatureFields")],
y)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),function(b,m,t,y,z,H,J,K,M,F){m=class extends m{constructor(A){super(A);this.title=this.fieldInfos=
this.description=this.expressionInfos=this.attributes=null}get formattedFieldInfos(){const {expressionInfos:A,fieldInfos:c}=this,g=[];c?.forEach(n=>{if(!n.hasOwnProperty("visible")||n.visible)n=n.clone(),n.label=F.getFieldInfoLabel(n,A),g.push(n)});return g}};b.__decorate([t.property()],m.prototype,"attributes",void 0);b.__decorate([t.property({type:[K]})],m.prototype,"expressionInfos",void 0);b.__decorate([t.property()],m.prototype,"description",void 0);b.__decorate([t.property({type:[M]})],m.prototype,
"fieldInfos",void 0);b.__decorate([t.property({readOnly:!0})],m.prototype,"formattedFieldInfos",null);b.__decorate([t.property()],m.prototype,"title",void 0);return m=b.__decorate([J.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],m)})},"esri/widgets/support/uriUtils":function(){define(["exports","../../core/string"],function(b,m){function t(z){let H=null;y.some(J=>{J.pattern.test(z)&&(H=J);return!!H});return H}const y=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",
label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,
label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];b.autoLink=function(z,H){if("string"!==typeof H||!H)return H;const J=t(H);if(!J)return H;const K=H.match(J.pattern);z=m.replace(m.replace(J.label,{messages:z,hierPart:K&&K[2]}),{appName:J.appName});return H.replace(J.pattern,`<a${J.target?` target="${J.target}"`:""} href="$1"${"_blank"===
J.target?' rel\x3d"noreferrer"':""}>${z}</a>`)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/a11yUtils ../../core/events ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../renderers/support/utils ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../support/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../support/themeUtils ../../intl/substitute".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r,x,N,k){t=class extends g{constructor(h,a){super(h,a);this._featureElementInfo=this._refreshIntervalInfo=this._refreshTimer=null;this._chartRootMap=new WeakMap;this.viewModel=new n;this.messages=null;this._disposeChart=e=>{this._chartRootMap.get(e)?.dispose();this._chartRootMap.delete(e)};this._createChart=async e=>{const {destroyed:f,viewModel:E}=this;if(!f&&E&&e){var {createRoot:w}=await new Promise((L,D)=>b(["../support/chartUtilsAm5"],L,D));w=await w(e);
this._chartRootMap.set(e,w);this._renderChart({mediaInfo:E.activeMediaInfo,root:w})}}}initialize(){this._featureElementInfo=new q;this.addHandles([H.watch(()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex],()=>this._setupMediaRefreshTimer(),H.initial),H.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),H.initial)])}loadDependencies(){return d.loadCalciteComponents({icon:()=>new Promise((h,a)=>b(["../../chunks/calcite-icon"],h,
a))})}destroy(){this._clearMediaRefreshTimer();this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(h){this.viewModel.attributes=h}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(h){this.viewModel.activeMediaInfoIndex=h}get description(){return this.viewModel.description}set description(h){this.viewModel.description=h}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(h){this.viewModel.fieldInfoMap=
h}get layer(){return this.viewModel.layer}set layer(h){this.viewModel.layer=h}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(h){this.viewModel.mediaInfos=h}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(h){this.viewModel.popupTemplate=h}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(h){this.viewModel.relatedInfos=h}get title(){return this.viewModel.title}set title(h){this.viewModel.title=h}render(){return x.tsx("div",{bind:this,
class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this._renderMedia())}_renderMedia(){const {formattedMediaInfoCount:h,activeMediaInfoIndex:a}=this.viewModel,e=this._renderMediaText();return h?x.tsx("div",{class:"esri-feature-media__container",key:"media-element-container"},this._renderMediaInfo(),x.tsx("div",{class:"esri-feature-media__item-navigation"},e,1<h?x.tsx("div",{class:"esri-feature-media__pagination"},this._renderMediaPageButton("previous"),x.tsx("span",
{class:"esri-feature-media__pagination-text"},k.substitute(this.messages.pageText,{index:a+1,total:h})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){var {activeMediaInfo:h}=this.viewModel;if(!h)return null;const a=h&&h.title?x.tsx("div",{class:"esri-feature-media__item-title",innerHTML:h.title,key:"media-title"}):null;h=h&&h.caption?x.tsx("div",{class:"esri-feature-media__item-caption",innerHTML:h.caption,key:"media-caption"}):null;return a||h?x.tsx("div",{class:"esri-feature-media__item-text",
key:"media-text"},a,h):null}_renderImageMediaInfo(h){var {_refreshIntervalInfo:a}=this;const {activeMediaInfoIndex:e,formattedMediaInfoCount:f}=this.viewModel,{value:E,refreshInterval:w,altText:L,title:D,type:G}=h,{sourceURL:P,linkURL:S}=E;h=l.shouldOpenInNewTab(S??void 0)?"_blank":"_self";const C="_blank"===h?"noreferrer":"";a=w?a:null;a=x.tsx("img",{alt:L||D,key:`media-${G}-${e}-${f}-${a?a.timestamp:0}`,src:(a?a.sourceURL:P)??void 0});return(S?x.tsx("a",{href:S,rel:C,target:h,title:D},a):null)??
a}_renderChartMediaInfo(h){const {activeMediaInfoIndex:a,formattedMediaInfoCount:e}=this.viewModel;return x.tsx("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:"esri-feature-media__chart",key:`media-${h.type}-${a}-${e}`})}_renderMediaInfoType(){const {activeMediaInfo:h}=this.viewModel;return h?"image"===h.type?this._renderImageMediaInfo(h):h.type.includes("chart")?this._renderChartMediaInfo(h):null:null}_renderMediaInfo(){const {activeMediaInfo:h}=this.viewModel;
return h?x.tsx("div",{class:"esri-feature-media__item-container",key:"media-container"},x.tsx("div",{class:"esri-feature-media__item",key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(h){if(2>this.viewModel.formattedMediaInfoCount)return null;const a=(h="previous"===h)?this.messages.previous:this.messages.next;return x.tsx("button",{"aria-label":a,bind:this,class:"esri-feature-media__pagination-button",key:h?"media-previous":"media-next",onclick:h?this._previous:
this._next,tabIndex:0,title:a,type:"button"},x.tsx("calcite-icon",{class:"esri-feature-media__pagination-icon",icon:h?"chevron-left":"chevron-right",scale:"s"}))}_setupFeatureElementInfo(){const {description:h,title:a}=this;this._featureElementInfo?.set({description:h,title:a})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(this.viewModel){var {isAggregate:h,layer:a}=this.viewModel;return h&&a?.featureReduction&&"renderer"in a.featureReduction?a.featureReduction.renderer:
a?.renderer}}async _getSeriesColors(h){const {colorAm5:a}=await new Promise((f,E)=>b(["./FeatureMedia/chartCommon"],f,E)),e=new Map;h.forEach(f=>{f.color&&e.set(f,a(f.color.toCss(!0)))});return e}async _getRendererColors(){const {colorAm5:h}=await new Promise((E,w)=>b(["./FeatureMedia/chartCommon"],E,w)),a=new Map,e=this._getRenderer();if(!e)return a;const f=await c.getColorsFromRenderer(e);f.delete("default");if(!Array.from(f.values()).every(E=>1===E?.length))return a;Array.from(f.keys()).forEach(E=>
{const w=f.get(E)?.[0]?.toCss(!0);w&&a.set(E,h(w))});return a}_handleMediaKeyup(h){const a=z.eventKey(h);"ArrowLeft"===a&&(h.stopPropagation(),this.viewModel.previous());"ArrowRight"===a&&(h.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return this.viewModel?!!this.viewModel.abilities.chartAnimation&&!y.prefersReducedMotion():!1}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(h){const {root:a,
mediaInfo:e}=h,{value:f,type:E}=e,{ResponsiveThemeAm5:w,DarkThemeAm5:L,AnimatedThemeAm5:D,ColorSetAm5:G,ThemeAm5:P,esriChartColorSet:S}=await new Promise((T,X)=>b(["./FeatureMedia/chartCommon"],T,X));var C=P.new(a);C.rule("ColorSet").set("colors",S);C.rule("ColorSet").set("reuse",!0);C=[w.new(a),C];N.isDarkTheme()&&C.push(L.new(a));this._canAnimateChart()&&C.push(D.new(a));a.setThemes(C);const u=await this._getRendererColors(),v=await this._getSeriesColors(f.series),B=G.new(a,{}),Q=(C=v.get(f.series[0]))?
{lineSettings:{stroke:C}}:void 0;C=f.series.map((T,X)=>{X=v.get(T)||u.get(T.fieldName)||B.getIndex(X);return{category:T.tooltip,value:T.value,columnSettings:{fill:X,stroke:X},...Q}}).filter(T=>"pie-chart"===E?null!=T.value&&0<T.value:!0);"pie-chart"===E?this._createPieChart(h,C):this._createXYChart(h,C)}_getDirection(){return p.isRTL(this.container)?"rtl":"ltr"}_isInversed(){return!!p.isRTL(this.container)}async _customizeChartTooltip(h,a="horizontal"){const {colorAm5:e}=await new Promise((f,E)=>
b(["./FeatureMedia/chartCommon"],f,E));h.setAll({pointerOrientation:a});h.get("background")?.setAll({stroke:e("rgba(50, 50, 50, 1)")});h.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(h,a){var {TooltipAm5:e}=await new Promise((G,P)=>b(["./FeatureMedia/chartCommon"],G,P));const {PieChartAm5:f,PieSeriesAm5:E}=await new Promise((G,P)=>b(["./FeatureMedia/pieChart"],G,P)),{mediaInfo:w,root:L}=h;var {title:D}=w;h=L.container.children.push(f.new(L,
{ariaLabel:w?.altText||w?.title||"",focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5}));e=e.new(L,{labelText:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})"});D=h.series.push(E.new(L,{name:D,valueField:"value",categoryField:"category",tooltip:e}));D.ticks.template.set("forceHidden",!0);D.labels.template.set("forceHidden",!0);D.slices.template.states.create("active",{shiftRadius:5});this._customizeChartTooltip(e);D.slices.template.setAll({ariaLabel:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",
focusable:!0,templateField:"columnSettings"});D.data.setAll(a);D.appear(this._getChartSeriesAnimationMS());h.appear(this._getChartAnimationMS());h.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_getMinSeriesValue(h){let a=0;h.forEach(e=>a=Math.min(e.value,a));return a}async _createColumnChart(h,a,e){const {TooltipAm5:f,ScrollbarAm5:E}=await new Promise((T,X)=>b(["./FeatureMedia/chartCommon"],T,X)),{CategoryAxisAm5:w,AxisRendererXAm5:L,ValueAxisAm5:D,AxisRendererYAm5:G,ColumnSeriesAm5:P}=
await new Promise((T,X)=>b(["./FeatureMedia/xyChart"],T,X)),{mediaInfo:S,root:C}=a,{value:u,title:v}=S;h.setAll({wheelX:"panX",wheelY:"zoomX"});a=h.xAxes.push(w.new(C,{renderer:L.new(C,{inversed:this._isInversed()}),categoryField:"category"}));a.get("renderer").labels.template.setAll({forceHidden:!0});var B=h.yAxes.push(D.new(C,{renderer:G.new(C,{inside:!1}),min:this._getMinSeriesValue(u.series)}));B.get("renderer").labels.template.setAll({direction:this._getDirection()});const Q=f.new(C,{labelText:"{categoryX}"});
B=h.series.push(P.new(C,{name:v,xAxis:a,yAxis:B,valueYField:"value",categoryXField:"category",tooltip:Q}));this._customizeChartTooltip(Q);B.columns.template.setAll({ariaLabel:"{categoryX}",focusable:!0,templateField:"columnSettings"});15<u.series.length&&h.set("scrollbarX",E.new(C,{orientation:"horizontal"}));a.data.setAll(e);B.data.setAll(e);B.appear(this._getChartSeriesAnimationMS());h.appear(this._getChartAnimationMS())}async _createBarChart(h,a,e){const {TooltipAm5:f,ScrollbarAm5:E}=await new Promise((T,
X)=>b(["./FeatureMedia/chartCommon"],T,X)),{CategoryAxisAm5:w,AxisRendererXAm5:L,ValueAxisAm5:D,AxisRendererYAm5:G,ColumnSeriesAm5:P}=await new Promise((T,X)=>b(["./FeatureMedia/xyChart"],T,X)),{mediaInfo:S,root:C}=a,{value:u,title:v}=S;h.setAll({wheelX:"panY",wheelY:"zoomY"});a=h.yAxes.push(w.new(C,{renderer:G.new(C,{inversed:!0}),categoryField:"category"}));a.get("renderer").labels.template.setAll({forceHidden:!0});var B=h.xAxes.push(D.new(C,{renderer:L.new(C,{inside:!1,inversed:this._isInversed()}),
min:this._getMinSeriesValue(u.series)}));B.get("renderer").labels.template.setAll({direction:this._getDirection()});const Q=f.new(C,{labelText:"{categoryY}"});B=h.series.push(P.new(C,{name:v,xAxis:B,yAxis:a,valueXField:"value",categoryYField:"category",tooltip:Q}));this._customizeChartTooltip(Q,"vertical");B.columns.template.setAll({ariaLabel:"{categoryY}",focusable:!0,templateField:"columnSettings"});15<u.series.length&&h.set("scrollbarY",E.new(C,{orientation:"vertical"}));a.data.setAll(e);B.data.setAll(e);
B.appear(this._getChartSeriesAnimationMS());h.appear(this._getChartAnimationMS())}async _createLineChart(h,a,e){const {TooltipAm5:f,ScrollbarAm5:E}=await new Promise((X,ba)=>b(["./FeatureMedia/chartCommon"],X,ba)),{CategoryAxisAm5:w,AxisRendererXAm5:L,ValueAxisAm5:D,AxisRendererYAm5:G,LineSeriesAm5:P}=await new Promise((X,ba)=>b(["./FeatureMedia/xyChart"],X,ba)),{root:S,mediaInfo:C}=a,{value:u,title:v}=C;h.setAll({wheelX:"panX",wheelY:"zoomX"});a=h.xAxes.push(w.new(S,{renderer:L.new(S,{inversed:this._isInversed()}),
categoryField:"category"}));a.get("renderer").labels.template.setAll({forceHidden:!0});var B=h.yAxes.push(D.new(S,{renderer:G.new(S,{inside:!1}),min:this._getMinSeriesValue(u.series)}));B.get("renderer").labels.template.setAll({direction:this._getDirection()});const Q=e[0]?.lineSettings?.stroke,T=f.new(S,{getFillFromSprite:!Q,labelText:"{categoryX}"});Q&&T.get("background")?.setAll({fill:Q});B=h.series.push(P.new(S,{name:v,xAxis:a,yAxis:B,valueYField:"value",categoryXField:"category",tooltip:T}));
B.strokes.template.setAll({templateField:"lineSettings"});this._customizeChartTooltip(T,"vertical");15<u.series.length&&h.set("scrollbarX",E.new(S,{orientation:"horizontal"}));a.data.setAll(e);B.data.setAll(e);B.appear(this._getChartSeriesAnimationMS());h.appear(this._getChartAnimationMS())}async _createXYChart(h,a){const {XYChartAm5:e,XYCursorAm5:f}=await new Promise((G,P)=>b(["./FeatureMedia/xyChart"],G,P)),{root:E,mediaInfo:w}=h,{type:L}=w,D=E.container.children.push(e.new(E,{ariaLabel:w?.altText||
w?.title||"",focusable:!0,panX:!0,panY:!0}));D.set("cursor",f.new(E,{}));"column-chart"===L&&await this._createColumnChart(D,h,a);"bar-chart"===L&&await this._createBarChart(D,h,a);"line-chart"===L&&await this._createLineChart(D,h,a);D.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_clearMediaRefreshTimer(){const {_refreshTimer:h}=this;h&&(clearTimeout(h),this._refreshTimer=null)}_updateMediaInfoTimestamp(h){const a=Date.now();this._refreshIntervalInfo={timestamp:a,sourceURL:h&&
this._getImageSource(h,a)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const {activeMediaInfo:h}=this.viewModel;h&&"image"===h.type&&h.refreshInterval&&this._setRefreshTimeout(h)}_setRefreshTimeout(h){const {refreshInterval:a,value:e}=h;a&&(h=6E4*a,this._updateMediaInfoTimestamp(e.sourceURL),this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(e.sourceURL)},h))}_getImageSource(h,a){const e=h.includes("?")?"\x26":"?",[f,E=""]=h.split("#");return`${f}${e}timestamp=${a}${E?
"#":""}${E}`}};m.__decorate([J.property()],t.prototype,"_refreshIntervalInfo",void 0);m.__decorate([J.property()],t.prototype,"attributes",null);m.__decorate([J.property()],t.prototype,"activeMediaInfoIndex",null);m.__decorate([J.property()],t.prototype,"description",null);m.__decorate([J.property()],t.prototype,"fieldInfoMap",null);m.__decorate([J.property()],t.prototype,"layer",null);m.__decorate([J.property()],t.prototype,"mediaInfos",null);m.__decorate([J.property()],t.prototype,"popupTemplate",
null);m.__decorate([J.property()],t.prototype,"relatedInfos",null);m.__decorate([J.property()],t.prototype,"title",null);m.__decorate([J.property({type:n})],t.prototype,"viewModel",void 0);m.__decorate([J.property(),r.messageBundle("esri/widgets/Feature/t9n/Feature")],t.prototype,"messages",void 0);return t=m.__decorate([A.subclass("esri.widgets.Feature.FeatureMedia")],t)})},"esri/core/a11yUtils":function(){define(["exports"],function(b){b.prefersReducedMotion=()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches;
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(b,m,t,y,z,H,J,K,M,F,A,c){async function g(x,N,k){y.getOrCreateMapValue(x,
N,()=>[]).push(...k)}async function n(x,N,k){x=y.getOrCreateMapValue(x,N,()=>new Map);for(const h of k)x.set(h.value,h.color)}function q(x){let N=x.minValue,k=x.maxValue;const h=x.isFirstBreak?"":p.gt+" ";x="percent-of-total"===x.normalizationType?p.pct:"";N=null==N?"":J.format(N);k=null==k?"":J.format(k);return h+N+x+" "+p.ld+" "+k+x}function l(x,N){return"normalizationField"in x&&x.normalizationField?{type:"normalized-field",field:x.field,normalizationField:x.normalizationField}:"field"in x&&x.field?
{type:"field",field:x.field}:"valueExpression"in x&&x.valueExpression?{type:"expression",expression:x.valueExpression,title:x.valueExpressionTitle,returnType:N}:null}const d=t.getLogger("esri.renderers.support.utils"),p={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},r={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6};t=z.convertDateFormatToIntlOptions("short-date");b.calculateDateFormatInterval=function(x){x=x.map(e=>new Date(e));const N=x.length;let k=Infinity,
h=null;for(let e=0;e<N-1;e++){const f=x[e];let E=Infinity,w=null;for(let L=e+1;L<N;L++){var a=x[L];a=f.getFullYear()!==a.getFullYear()&&"year"||f.getMonth()!==a.getMonth()&&"month"||f.getDate()!==a.getDate()&&"day"||f.getHours()!==a.getHours()&&"hour"||f.getMinutes()!==a.getMinutes()&&"minute"||f.getSeconds()!==a.getSeconds()&&"second"||"millisecond";const D=r[a];D<E&&(E=D,w=a)}E<k&&(k=E,h=w)}return h};b.createClassBreakLabel=q;b.createColorStops=function(x){const {values:N,colors:k,labelIndexes:h,
isDate:a}=x;return N.map((e,f)=>{var E=null;if(!h||h.includes(f)){const w=a?z.formatDate(e):J.format(e);w&&(E="",0===f?E=p.lt+" ":f===N.length-1&&(E=p.gt+" "),E+=w)}return new K({value:e,color:k[f],label:E})})};b.createUniqueValueLabel=function(x){const {value:N,domain:k,fieldInfo:h,dateFormatOptions:a}=x;x=String(N);const e=k&&"codedValues"in k&&k.codedValues?k.getName(N):null;e?x=e:null!=N&&h&&(M.isAnyDateField(h)||H.isTimeOnlyField(h))?x=M.formatAnyDate(N,a??{fieldType:h.type}):"number"===typeof N&&
(x=J.format(N));return x};b.dateFormatIntervalOptions={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};b.getAttribute=l;b.getAttributes=function(x,N){const k=[];if("class-breaks"===x.type||"heatmap"===x.type)k.push(l(x,"number"));else if("unique-value"===x.type){var h=x.authoringInfo;if(h&&"relationship"===h.type){if(h.field1&&
h.field2){var a=h.field2.field;const e=h.field2.normalizationField;k.push(l({field:h.field1.field,normalizationField:h.field1.normalizationField}));k.push(l({field:a,normalizationField:e}))}}else a=x.uniqueValueInfos?.[0],h=null,a?.value&&(a=typeof a.value,"string"===a||"number"===a)&&(h=a),k.push(l(x,h)),[x.field2,x.field3].forEach(e=>e&&k.push({type:"field",field:e}))}else"attributes"in x&&x.attributes?.forEach(e=>k.push(l(e,"number")));(x=N?N(x):"visualVariables"in x?x.visualVariables:null)&&x.forEach(e=>
k.push(l(e,"number")));return m.unique(k.filter(m.isSome),(e,f)=>"field"===e.type&&"field"===f.type?e.field===f.field:"normalized-field"===e.type&&"normalized-field"===f.type?e.field===f.field&&e.normalizationField===f.normalizationField:"expression"===e.type&&"expression"===f.type?e.expression===f.expression:!1)};b.getColorsForRendererValues=async function(x){const N=new Map;if(!x)return N;if("unique-value"!==x.type||x.authoringInfo?.type)if("class-breaks"===x.type){var k=x.classBreakInfos.map(e=>
({value:e.minValue,color:F.getColorFromSymbol(e.symbol,null)})).reverse();const {field:h,valueExpression:a}=x;await n(N,h??a,k)}else"simple"===x.type&&await n(N,"default",[{value:"default",color:F.getColorFromSymbol(x.symbol,null)}]);else{k=(x.uniqueValueInfos??[]).map(L=>({value:L.value,color:F.getColorFromSymbol(L.symbol,null)}));const {field:h,field2:a,field3:e,valueExpression:f,fieldDelimiter:E}=x,w=[h,a,e].filter(Boolean).join(E||"");(w||f)&&await n(N,w||f,k)}"defaultSymbol"in x&&x.defaultSymbol&&
await n(N,"default",[{value:"default",color:F.getColorFromSymbol(x.defaultSymbol,null)}]);if("visualVariables"in x&&x.visualVariables){x=x.visualVariables.filter(h=>"color"===h.type);for(const h of x)x=await A.getRampStops(h)??[],await n(N,h.field||h.valueExpression,x)}return N};b.getColorsFromRenderer=async function(x){const N=new Map;if(!x)return N;if("visualVariables"in x&&x.visualVariables){var k=x.visualVariables.filter(a=>"color"===a.type);for(var h of k)k=(await A.getRampStops(h)??[]).map(a=>
a.color),await g(N,h.field||h.valueExpression,k)}if("heatmap"===x.type)h=c.getHeatmapRampStops(x).map(a=>a.color),await g(N,x.field||x.valueExpression,h);else if("pie-chart"===x.type){for(const a of x.attributes)await g(N,a.field||a.valueExpression,[a.color]);await g(N,"default",[x?.othersCategory?.color,F.getColorFromSymbol(x.backgroundFillSymbol,null)])}else if("dot-density"===x.type){for(const a of x.attributes)await g(N,a.field||a.valueExpression,[a.color]);await g(N,"default",[x.backgroundColor])}else if("unique-value"===
x.type)if("predominance"===x.authoringInfo?.type)for(const a of x.uniqueValueInfos??[])await g(N,a.value.toString(),[F.getColorFromSymbol(a.symbol,null)]);else{h=(x.uniqueValueInfos??[]).map(w=>F.getColorFromSymbol(w.symbol,null));const {field:a,field2:e,field3:f,valueExpression:E}=x;(a||E)&&await g(N,a||E,h);e&&await g(N,e,h);f&&await g(N,f,h)}else if("class-breaks"===x.type){h=x.classBreakInfos.map(f=>F.getColorFromSymbol(f.symbol,null));const {field:a,valueExpression:e}=x;await g(N,a??e,h)}else"simple"===
x.type&&await g(N,"default",[F.getColorFromSymbol(x.symbol,null)]);"defaultSymbol"in x&&x.defaultSymbol&&await g(N,"default",[F.getColorFromSymbol(x.defaultSymbol,null)]);N.forEach((a,e)=>{a=m.unique(a.filter(Boolean),(f,E)=>JSON.stringify(f)===JSON.stringify(E));N.set(e,a)});return N};b.setLabelsForClassBreaks=function(x){const N=x.classBreakInfos,k=x.normalizationType;let h=[];if(N?.length)if("standard-deviation"===x.classificationMethod)d.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");
else if(x.round){h.push(N[0].minValue);for(const a of N)h.push(a.maxValue);h=J.round(h);N.forEach((a,e)=>{a.label=q({minValue:0===e?h[0]:h[e],maxValue:h[e+1],isFirstBreak:0===e,normalizationType:k})})}else N.forEach((a,e)=>{a.label=q({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===e,normalizationType:k})})};b.timelineDateFormatOptions=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],
function(b,m,t){function y(A,c){return A-c}function z(A,c){let g;g=Number(A.toFixed(c));g<A?A=g+1/10**c:(A=g,g-=1/10**c);g=Number(g.toFixed(c));A=Number(A.toFixed(c));return[g,A]}function H(A,c,g,n,q){A=K(A,c,g,n);c=null==A.next||A.next<=q;return(null==A.previous||A.previous<=q)&&c||A.previous+A.next<=2*q}function J(A){A=String(A);var c=A.match(M);if(c&&c[1])return{integer:c[1].split("").length,fractional:c[3]?c[3].split("").length:0};if(A.toLowerCase().includes("e")&&(c=A.split("e"),A=c[0],c=c[1],
A&&c)){A=Number(A);c=Number(c);const g=0<c;g||(c=Math.abs(c));A=J(A);g?(A.integer+=c,A.fractional=c>A.fractional?0:A.fractional-c):(A.fractional+=c,A.integer=c>A.integer?1:A.integer-c);return A}return{integer:0,fractional:0}}function K(A,c,g,n){const q={previous:null,next:null};if(null!=g){const l=A-g;q.previous=Math.floor(Math.abs(100*(c-g-l)/l))}null!=n&&(A=n-A,q.next=Math.floor(Math.abs(100*(n-c-A)/A)));return q}const M=/^-?(\d+)(\.(\d+))?$/i,F={maximumFractionDigits:20};b.format=function(A){return t.formatNumber(A,
F)};b.numDigits=J;b.percentChange=K;b.round=function(A,c={}){A=A.slice(0);const {tolerance:g=2,strictBounds:n=!1,indexes:q=A.map((d,p)=>p)}=c;q.sort(y);for(c=0;c<q.length;c++){const d=q[c],p=A[d],r=0===d?null:A[d-1],x=d===A.length-1?null:A[d+1],N=J(p).fractional;if(N){let k=0,h=!1;for(var l=void 0;k<=N&&!h;)l=z(p,k),l=n&&0===c?l[1]:l[0],h=H(p,l,r,x,g),k++;h&&(A[d]=l)}}return A};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c){function g(a){a=a.symbolLayers;if(!a)return null;let e=null;a.forEach(f=>{"object"===f.type&&f.resource?.href||(e="water"===f.type?f.color:f.material?f.material.color:null)});return e?new t(e):null}function n(a,e){if(null==e||null==a)return a;a=a.toRgba();a[3]*=e;return new t(a)}function q(a,e,f){if(a=a.symbolLayers){var E=w=>{e=e??w??(null!=f?h:null);return n(e,f)};a.forEach(w=>{if("object"!==w.type||!w.resource?.href||e)if("water"===w.type)w.color=E(w.color);else{const L=
E(null!=w.material?w.material.color:null);null==w.material?w.material=new c.Symbol3DMaterial({color:L}):w.material.color=L;null!=f&&"outline"in w&&null!=w.outline?.color&&(w.outline.color=n(w.outline.color,f))}})}}async function l(a,e){(a=a.symbolLayers)&&await z.forEach(a,async f=>d(f,e))}async function d(a,e){switch(a.type){case "extrude":a.size="number"===typeof e[2]?e[2]:0;break;case "icon":case "line":case "text":e=p(e);null!=e&&(a.size=e);break;case "path":const f=x(e,K.ONES,[a.width,void 0,
a.height]);a.width=k(e[0],a.width,1,f);a.height=k(e[2],a.height,1,f);break;case "object":await r(a,e)}}function p(a){for(const e of a)if("number"===typeof e)return e;return null}async function r(a,e){const {resourceSize:f,symbolSize:E}=await N(a),w=x(e,f,E);a.width=k(e[0],E[0],f[0],w);a.depth=k(e[1],E[1],f[1],w);a.height=k(e[2],E[2],f[2],w)}function x(a,e,f){for(let E=0;3>E;E++){const w=a[E];switch(w){case "symbol-value":return a=f[E],null!=a?a/e[E]:1;case "proportional":break;default:if(w&&e[E])return w/
e[E]}}return 1}async function N(a){var {computeObjectLayerResourceSize:e}=await new Promise((G,P)=>b(["./symbolLayerUtils"],G,P));e=await e(a,10);const {width:f,height:E,depth:w}=a;a=[f,w,E];let L=1;for(var D=0;3>D;D++){const G=a[D];if(null!=G){L=G/e[D];break}}for(D=0;3>D;D++)null==a[D]&&(a[D]=e[D]*L);return{resourceSize:e,symbolSize:a}}function k(a,e,f,E){switch(a){case "proportional":return f*E;case "symbol-value":return null!=e?e:f;default:return a}}const h=new t("white");m.applyColorToSymbol=
function(a,e,f){if(a&&(e||null!=f))if(e&&(e=new t(e)),y.isSymbol3D(a))q(a,e,f);else if(y.isSymbol2D(a)){if(e=e??a.color)a.color=n(e,f);null!=f&&"outline"in a&&a.outline?.color&&(a.outline.color=n(a.outline.color,f))}};m.applyOpacityToColor=n;m.applyRotationToSymbol=function(a,e,f){a&&null!=e&&(y.isSymbol3D(a)?(a=a.symbolLayers)&&a.forEach(E=>{if(E&&"object"===E.type)switch(f){case "tilt":E.tilt=e;break;case "roll":E.roll=e;break;default:E.heading=e}}):!y.isSymbol2D(a)||"simple-marker"!==a.type&&"picture-marker"!==
a.type&&"text"!==a.type||(a.angle=e))};m.applySizesToSymbol=async function(a,e){if(a&&e){if(y.isSymbol3D(a))return l(a,e);if(y.isSymbol2D(a)&&(e=p(e),null!=e))switch(a.type){case "simple-marker":a.size=e;break;case "picture-marker":const f=a.width/a.height;1<f?(a.width=e,a.height=e*f):(a.width=e*f,a.height=e);break;case "simple-line":a.width=e;break;case "text":a.font.size=e}}};m.fetchWebStyleSymbol=async function(a,e){const f=await a.fetchSymbol(e);return f?f:a.fetchCIMSymbol(e)};m.getCSSFilterFromEffectList=
function(a){if(!a)return null;a=a.effects.filter(e=>"bloom"!==e.type).map(e=>e.toJSON());return M.effectFunctionsFromJSON(a)};m.getColorFromSymbol=function(a,e){if(!a)return null;let f=null;y.isSymbol3D(a)?f=g(a):y.isSymbol2D(a)&&(f="cim"===a.type?F.getCIMSymbolColor(a):a.color?new t(a.color):null);return f?n(f,e):null};m.getIconHref=function(a){return a.resource?.href??""};m.getSymbolOutlineSize=function(a){return a?y.isSymbol3D(a)?(a=(a=a.symbolLayers?.at(-1))&&"outline"in a?a?.outline?.size:void 0,
null!=a?a:0):J.px2pt(A.getStroke(a)?.width):0};m.isVolumetricSymbol=function(a){if(null==a||!("symbolLayers"in a)||null==a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(e=>"object"===e.type);case "line-3d":return a.symbolLayers.some(e=>"path"===e.type);case "polygon-3d":return a.symbolLayers.some(e=>"object"===e.type||"extrude"===e.type);default:return!1}};m.symbolHasExtrudeSymbolLayer=function(a){return null!=a&&"polygon-3d"===a.type&&a.symbolLayers.some(e=>"extrude"===
e.type)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(b,m,t){function y(c){c=t.toCIMSymbolJSON(c);if("CIMTextSymbol"===c?.type)return c.height??0;let g=0;if(c?.symbolLayers)for(const n of c.symbolLayers)t.isCIMMarker(n)&&null!=n.size&&n.size>g?g=n.size:t.isCIMStroke(n)&&null!=n.width&&n.width>g?g=n.width:t.isCIMFill(n);return g}function z(c,g,n,q){if(c)if("CIMTextSymbol"===
c.type)null!=c.height&&(c.height*=g);else{if(n&&c.effects)for(const l of c.effects)K(l,g);if(c.symbolLayers)for(const l of c.symbolLayers)switch(l.type){case "CIMPictureMarker":case "CIMVectorMarker":H(l,g,q);break;case "CIMPictureStroke":case "CIMSolidStroke":!q?.preserveOutlineWidth&&l.width&&(l.width*=g);break;case "CIMPictureFill":l.height&&(l.height*=g);l.offsetX&&(l.offsetX*=g);l.offsetY&&(l.offsetY*=g);break;case "CIMHatchFill":z(l.lineSymbol,g,!0,{...q,preserveOutlineWidth:!1}),l.offsetX&&
(l.offsetX*=g),l.offsetY&&(l.offsetY*=g),l.separation&&(l.separation*=g)}}}function H(c,g,n){if(c&&(c.markerPlacement&&J(c.markerPlacement,g),c.offsetX&&(c.offsetX*=g),c.offsetY&&(c.offsetY*=g),c.anchorPoint&&"Absolute"===c.anchorPointUnits&&(c.anchorPoint={x:c.anchorPoint.x*g,y:c.anchorPoint.y*g}),c.size=null!=c.size?c.size*g:0,"CIMVectorMarker"===c.type&&c.markerGraphics))for(const q of c.markerGraphics)c.scaleSymbolsProportionally||z(q.symbol,g,!0,n)}function J(c,g){t.isCIMMarkerStrokePlacement(c)&&
c.offset&&(c.offset*=g);switch(c.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":c.customEndingOffset&&(c.customEndingOffset*=g);c.offsetAlongLine&&(c.offsetAlongLine*=g);if(c.placementTemplate&&c.placementTemplate.length){var n=c.placementTemplate.map(q=>q*g);c.placementTemplate=n}break;case "CIMMarkerPlacementAlongLineVariableSize":c.maxRandomOffset&&(c.maxRandomOffset*=g);c.placementTemplate&&c.placementTemplate.length&&(n=c.placementTemplate.map(q=>
q*g),c.placementTemplate=n);break;case "CIMMarkerPlacementOnLine":c.startPointOffset&&(c.startPointOffset*=g);break;case "CIMMarkerPlacementAtExtremities":c.offsetAlongLine&&(c.offsetAlongLine*=g);break;case "CIMMarkerPlacementAtRatioPositions":c.beginPosition&&(c.beginPosition*=g);c.endPosition&&(c.endPosition*=g);break;case "CIMMarkerPlacementPolygonCenter":c.offsetX&&(c.offsetX*=g);c.offsetY&&(c.offsetY*=g);break;case "CIMMarkerPlacementInsidePolygon":c.offsetX&&(c.offsetX*=g),c.offsetY&&(c.offsetY*=
g),c.stepX&&(c.stepX*=g),c.stepY&&(c.stepY*=g)}}function K(c,g){switch(c.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":c.width&&(c.width*=g);break;case "CIMGeometricEffectBuffer":c.size&&(c.size*=g);break;case "CIMGeometricEffectCut":c.beginCut&&(c.beginCut*=g);c.endCut&&(c.endCut*=g);c.middleCut&&(c.middleCut*=g);break;case "CIMGeometricEffectDashes":c.customEndingOffset&&(c.customEndingOffset*=g);c.offsetAlongLine&&(c.offsetAlongLine*=g);if(c.dashTemplate&&c.dashTemplate.length){const n=
c.dashTemplate.map(q=>q*g);c.dashTemplate=n}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":c.length&&(c.length*=g);break;case "CIMGeometricEffectMove":c.offsetX&&(c.offsetX*=g);c.offsetY&&(c.offsetY*=g);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":c.offset&&(c.offset*=g);break;case "CIMGeometricEffectRegularPolygon":c.radius&&(c.radius*=g);break;case "CIMGeometricEffectTaperedPolygon":c.fromWidth&&(c.fromWidth*=
g);c.length&&(c.length*=g);c.toWidth&&(c.toWidth*=g);break;case "CIMGeometricEffectWave":c.amplitude&&(c.amplitude*=g),c.period&&(c.period*=g)}}function M(c,g){if(c){var n="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===c.type;if(n?.symbolLayers)for(const q of n.symbolLayers)if(!(q.colorLocked||c&&(t.isCIMStroke(q)||t.isCIMMarker(q)&&q.markerPlacement&&t.isCIMMarkerStrokePlacement(q.markerPlacement))))switch(q.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":q.tintColor&&
F(g,q.tintColor);break;case "CIMVectorMarker":q.markerGraphics?.forEach(l=>{M(l.symbol,g)});break;case "CIMSolidStroke":case "CIMSolidFill":F(g,q.color);break;case "CIMHatchFill":M(q.lineSymbol,g)}}}function F(c,g){for(const n of c)if(n.join(".")===g.join("."))return;c.push(g)}function A(c,g,n){if(c){var q="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===q?.type;if(q?.symbolLayers)for(const l of q.symbolLayers)if(!l.colorLocked){if(c)if(n){if({layersToColor:q}=n,(t.isCIMStroke(l)||t.isCIMMarker(l)&&
l.markerPlacement&&t.isCIMMarkerStrokePlacement(l.markerPlacement))&&"fill"===q||t.isCIMFill(l)&&"outline"===q)continue}else if(t.isCIMStroke(l)||t.isCIMMarker(l)&&l.markerPlacement&&t.isCIMMarkerStrokePlacement(l.markerPlacement))continue;q=g.toArray();switch(l.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":l.tintColor=q;break;case "CIMVectorMarker":l.markerGraphics?.forEach(d=>{A(d.symbol,g,n)});break;case "CIMSolidStroke":case "CIMSolidFill":l.color=q;break;case "CIMHatchFill":A(l.lineSymbol,
g,n)}}}}b.applyCIMSymbolColor=function(c,g,n){g instanceof m||(g=new m(g));(c=t.toCIMSymbolJSON(c))&&A(c,g,n)};b.applyCIMSymbolRotation=function(c,g,n=!1){c=t.toCIMSymbolJSON(c);n&&0!==g&&(g=360-g);if("CIMTextSymbol"===c?.type)c.angle=g;else if("CIMPointSymbol"===c?.type&&c.symbolLayers){n=g-(c.angle||0);for(const q of c.symbolLayers)if(t.isCIMMarker(q)){let l=q.rotation||0;l=q.rotateClockwise?l-n:l+n;q.rotation=l}c.angle=g}};b.getCIMSymbolColor=function(c){c=t.toCIMSymbolJSON(c);const g=[];M(c,g);
return g.length?new m(t.fromCIMColor(g[0])):null};b.getCIMSymbolRotation=function(c,g=!1){c=t.toCIMSymbolJSON(c);return"CIMTextSymbol"===c?.type||"CIMPointSymbol"===c?.type?(c=c.angle,null!=c&&0!==c&&g?360-c:c??0):0};b.getCIMSymbolSize=y;b.getCIMSymbolType=function(c){c=t.toCIMSymbolJSON(c);if(!c)return null;switch(c.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};b.scaleCIMMarker=H;b.scaleCIMSymbol=z;b.scaleCIMSymbolTo=function(c,g,n){if(c){var q=t.toCIMSymbolJSON(c);c=y(c);if(0===c){if(q)if("CIMTextSymbol"===q.type)q.height=g;else if(q.symbolLayers)for(const l of q.symbolLayers)switch(l.type){case "CIMPictureMarker":case "CIMVectorMarker":l.size=g;break;case "CIMPictureStroke":case "CIMSolidStroke":l.width=g}}else z(q,g/c,!1,n)}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/cim/utils":function(){define(["require","exports"],function(b,m){function t(c){return"function"===typeof c}function y(c){let g=c.length;for(;g--;)if(!" /-,\n".includes(c.charAt(g)))return!1;return!0}function z(c,g){const n=[];var q=0;let l=-1;do l=c.indexOf("[",q),l>=q&&(l>q&&(q=c.substr(q,l-q),n.push([q,null,y(q)])),q=l+1,l=c.indexOf("]",q),l>=q&&(l>q&&(q=c.substr(q,l-q),(q=g[q])&&n.push([null,q,!1])),q=l+1));while(-1!==l);q<c.length-1&&(c=c.substr(q),n.push([c,null,y(c)]));return n}
function H(c,g,n){let q="",l=null;for(const d of g){const [p,r,x]=d;if(p)x?l=p:(l&&(q+=l,l=null),q+=p);else if(g=c.attributes[r])l&&(q+=l,l=null),q+=g}return J(q,n)}function J(c,g){"string"!==typeof c&&(c=String(c));switch(g){case "LowerCase":return c.toLowerCase();case "Allcaps":return c.toUpperCase();default:return c}}function K(c){return c?{r:c[0],g:c[1],b:c[2],a:c[3]/255}:{r:0,g:0,b:0,a:0}}function M(c){if(!c)return null;switch(c.type){case "CIMPolygonSymbol":if(c.symbolLayers)for(const g of c.symbolLayers)if(c=
M(g),null!=c)return c;break;case "CIMTextSymbol":return M(c.symbol);case "CIMSolidFill":return c.color}}function F(c){if(c)switch(c.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(c=c.symbolLayers)for(const g of c)if(c=F(g),null!=c)return c;break;case "CIMTextSymbol":return F(c.symbol);case "CIMSolidStroke":return c.color}}function A(c){if(c)switch(c.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(c.symbolLayers)for(const g of c.symbolLayers)if(c=A(g),void 0!==c)return c;break;case "CIMTextSymbol":return A(c.symbol);
case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return c.width}}m.adjustTextCase=J;m.analyzeTextParts=z;m.assignTextValuesFromFeature=H;m.attributesToFields=function(c){return(c?Object.keys(c):[]).map(g=>({name:g,alias:g,type:"string"===typeof c[g]?"esriFieldTypeString":"esriFieldTypeDouble"}))};m.colorToArray=function(c){return[c.r,c.g,c.b,c.a]};m.createLabelOverrideFunction=function(c,g,n){const q=z(g,c);return l=>H(l,q,n)};m.evaluateValueOrFunction=function(c,g,n,q){return t(c)?
c(g,n,q):c};m.fromCIMColor=K;m.fromCIMFontDecoration=function(c){return c.underline?"underline":c.strikethrough?"line-through":"none"};m.fromCIMFontStyle=function(c){let g="normal",n="normal";c&&(c=c.toLowerCase(),c.includes("italic")?g="italic":c.includes("oblique")&&(g="oblique"),c.includes("bold")?n="bold":c.includes("light")&&(n="lighter"));return{style:g,weight:n}};m.fromCIMHorizontalAlignment=function(c){switch(c){default:return"left";case "Right":return"right";case "Center":return"center";
case "Justify":return"center"}};m.fromCIMVerticalAlignment=function(c){switch(c){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};m.getFillColor=M;m.getFontStyle=function(c){if(!c)return"normal";switch(c.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};m.getFontWeight=function(c){if(!c)return"normal";switch(c.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";
default:return"normal"}};m.getStrokeColor=F;m.getStrokeWidth=A;m.getTintColor=c=>c.tintColor?K(c.tintColor):{r:255,g:255,b:255,a:1};m.getValue=(c,g=0)=>null==c||isNaN(c)?g:c;m.importGeometryEngine=function(){return new Promise((c,g)=>b(["../../geometry/geometryEngineJSON"],c,g))};m.isCIMFill=function(c){return null!=c&&("CIMGradientFill"===c.type||"CIMHatchFill"===c.type||"CIMPictureFill"===c.type||"CIMSolidFill"===c.type||"CIMWaterFill"===c.type)};m.isCIMMarker=function(c){return"CIMVectorMarker"===
c.type||"CIMPictureMarker"===c.type||"CIMBarChartMarker"===c.type||"CIMCharacterMarker"===c.type||"CIMPieChartMarker"===c.type||"CIMStackedBarChartMarker"===c.type};m.isCIMMarkerStrokePlacement=function(c){return null!=c&&("CIMMarkerPlacementAlongLineRandomSize"===c.type||"CIMMarkerPlacementAlongLineSameSize"===c.type||"CIMMarkerPlacementAlongLineVariableSize"===c.type||"CIMMarkerPlacementAtExtremities"===c.type||"CIMMarkerPlacementAtMeasuredUnits"===c.type||"CIMMarkerPlacementAtRatioPositions"===
c.type||"CIMMarkerPlacementOnLine"===c.type||"CIMMarkerPlacementOnVertices"===c.type)};m.isCIMStroke=function(c){return"CIMGradientStroke"===c.type||"CIMPictureStroke"===c.type||"CIMSolidStroke"===c.type};m.isFeatureValueFn=t;m.isGeometryEngineRequired=c=>{if(!c)return!1;for(const g of c)switch(g.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};m.isSVGImage=c=>c.includes("data:image/svg+xml");m.mapCIMSymbolToGeometryType=function(c){if(!c)return null;
switch(c.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};m.resampleHermite=function(c,g,n,q,l,d,p=!0){const r=g/l;n/=d;const x=Math.ceil(r/2),N=Math.ceil(n/2);for(let a=0;a<d;a++)for(let e=0;e<l;e++){const f=4*(e+(p?d-a-1:a)*l);var k=0;let E=0,w=0,L=0,D=0,G=0,P=0;const S=(a+.5)*n;for(let C=Math.floor(a*n);C<(a+1)*n;C++){var h=Math.abs(S-(C+.5))/N;const u=
(e+.5)*r;h*=h;for(let v=Math.floor(e*r);v<(e+1)*r;v++){let B=Math.abs(u-(v+.5))/x;k=Math.sqrt(h+B*B);-1<=k&&1>=k&&(k=2*k*k*k-3*k*k+1,0<k&&(B=4*(v+C*g),P+=k*c[B+3],w+=k,255>c[B+3]&&(k=k*c[B+3]/250),L+=k*c[B],D+=k*c[B+1],G+=k*c[B+2],E+=k))}}q[f]=L/E;q[f+1]=D/E;q[f+2]=G/E;q[f+3]=P/w}};m.toCIMSymbolJSON=function(c){return c.data?.symbol??null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(b,m,t,y,z,H,J){function K(A){if(!A)return null;let c=null;switch(A.type){case "simple-fill":case "picture-fill":case "simple-marker":c=K(A.outline);break;case "simple-line":const g=H.pt2px(A.width);null!=A.style&&"none"!==A.style&&0!==g&&(c={color:A.color,style:F(A.style),width:g,cap:A.cap,join:"miter"===A.join?H.pt2px(A.miterLimit):A.join});break;default:c=null}return c}const M=new z.LRUCache(1E3),F=(()=>{const A={};return c=>{if(A[c])return A[c];const g=c.replaceAll("-","");return A[c]=
g}})();t=new t([128,128,128]);b.defaultThematicColor=t;b.dekebabifyLineStyle=F;b.getFill=function(A){const c=A.style;let g=null;if(A)switch(A.type){case "simple-marker":"cross"!==c&&"x"!==c&&(g=A.color);break;case "simple-fill":"solid"===c?g=A.color:"none"!==c&&(g={type:"pattern",x:0,y:0,src:m.getAssetUrl(`esri/symbols/patterns/${c}.png`),width:5,height:5});break;case "picture-fill":g={type:"pattern",src:A.url,width:H.pt2px(A.width)*A.xscale,height:H.pt2px(A.height)*A.yscale,x:H.pt2px(A.xoffset),
y:H.pt2px(A.yoffset)};break;case "text":g=A.color;break;case "cim":g=J.getCIMSymbolColor(A)}return g};b.getPatternUrlWithColor=function(A,c){const g=A+"-"+c;return void 0!==M.get(g)?Promise.resolve(M.get(g)):y(A,{responseType:"image"}).then(n=>{n=n.data;const q=n.naturalWidth,l=n.naturalHeight,d=document.createElement("canvas");d.width=q;d.height=l;const p=d.getContext("2d");p.fillStyle=c;p.fillRect(0,0,q,l);p.globalCompositeOperation="destination-in";p.drawImage(n,0,0);n=d.toDataURL();M.put(g,n);
return n})};b.getStroke=K;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(b,m,t,y){function z(F,A){const c=[],g=F.length-1;5===F.length?c.push(0,2,4):c.push(0,g);return F.map((n,q)=>c.includes(q)?y.createStopLabel(n,q,g,A):null)}async function H(F,A,c){c=new t(c??M);F=(await new Promise((g,n)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],
g,n))).getOpacity(A,F);null!=F&&(c.a=F);return c}function J(F,A){const {startIndex:c,endIndex:g,weight:n}=K(F,A);if(c===g)return A[c].color;F=t.blendColors(A[c].color,A[g].color,n);return new t(F)}function K(F,A){let c=0,g=A.length-1;A.some((n,q)=>{if(F<n.value)return g=q,!0;c=q;return!1});return{startIndex:c,endIndex:g,weight:(F-A[c].value)/(A[g].value-A[c].value)}}const M=new t([64,64,64]);m.getColorFromPointCloudStops=J;m.getRampStops=async function(F,A,c){let g=!1,n=[],q=[];if(F.stops){var l=
F.stops;n=l.map(p=>p.value);(g=l.some(p=>!!p.label))&&(q=l.map(p=>p.label))}l=n[n.length-1];if(null==n[0]&&null==l)return null;const d=g?null:z(n,c);return(await Promise.all(n.map(async(p,r)=>{const x="opacity"===F.type?await H(p,F,A):(await new Promise((N,k)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],N,k))).getColor(F,p);return{value:p,color:x,label:g?q[r]:d?.[r]??""}}))).reverse()};m.getRampStopsForPointCloud=function(F){let A=!1,c=[],g=[];c=F.map(l=>l.value);(A=F.some(l=>
!!l.label))&&(g=F.map(l=>l.label??""));const n=c[c.length-1];if(null==c[0]&&null==n)return null;const q=A?null:z(c);return c.map((l,d)=>{const p=J(l,F);return{value:l,color:p,label:A?g[d]:q?.[d]??""}}).reverse()};m.getStrectchRampStops=function(F,A){let c=[];if(F&&"multipart"===F.type)F.colorRamps.reverse().forEach((g,n)=>{0===n?c.push({value:A.max,color:new t(g.toColor),label:"high"}):c.push({value:null,color:new t(g.toColor),label:""});n===F.colorRamps.length-1?c.push({value:A.min,color:new t(g.fromColor),
label:"low"}):c.push({value:null,color:new t(g.fromColor),label:""})});else{let g,n;F&&"algorithmic"===F.type?(g=F.fromColor,n=F.toColor):(g=[0,0,0,1],n=[255,255,255,1]);c=[{value:A.max,color:new t(n),label:"high"},{value:A.min,color:new t(g),label:"low"}]}return c};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),
function(b,m,t,y,z,H){async function J(K){if(!("visualVariables"in K&&K.visualVariables))return null;K=K.visualVariables.find(A=>"color"===A.type);if(!K)return null;var M=null,F=null;if(K.stops){if(1===K.stops.length)return K.stops[0].color;M=K.stops[0].value;F=K.stops[K.stops.length-1].value}M=null!=M&&null!=F?M+(F-M)/2:0;({getColor:F}=await new Promise((A,c)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],A,c)));return F(K,M)??null}m.createStopLabel=function(K,M,F,A){let c=
"";0===M?c="\x3c ":M===F&&(c="\x3e ");K=A?z.formatAnyDate(K,A):y.format(K);return c+K};m.getMedianColor=J;m.getSymbolForFlowRenderer=async function(K,M){const F=K.trailCap,A=K.trailWidth||1;K=M||await J(K)||K.color;return new H({cap:F,color:K,width:A})};m.isRasterBandStatistics=function(K){return null!=K&&"object"===typeof K&&"min"in K&&"max"in K};m.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];m.specialCharsGreaterThan="\x3e";m.specialCharsLessThan="\x3c";Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(b,m){b.getHeatmapRampStops=function(t){if(!t.colorStops)return[];const y=[...t.colorStops].filter(H=>0<H.color?.a);let z=y.length-1;if(y&&y[0]){const H=y[z];H&&1!==H.ratio&&(y.push(new m({ratio:1,color:H.color})),z++)}return y.map((H,J)=>{let K="";0===J?K=t.legendOptions?.minLabel||"low":J===z&&(K=t.legendOptions?.maxLabel||"high");return{color:H.color,
label:K,ratio:H.ratio}}).reverse()};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/arrayUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A){const c={chartAnimation:!0};m=class extends m{constructor(g){super(g);this.abilities={...c};this.activeMediaInfoIndex=0;this.expressionAttributes=this.formattedAttributes=this.fieldInfoMap=this.description=this.attributes=null;this.isAggregate=!1;this.title=this.relatedInfos=this.popupTemplate=this.mediaInfos=this.layer=null}castAbilities(g){return{...c,...g}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||
[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(g){this._setContentElementMedia(g)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(g){const {formattedMediaInfoCount:n}=this;this.activeMediaInfoIndex=(g+n)%n}_pageContentElementMedia(g){const {activeMediaInfoIndex:n}=this;this._setContentElementMedia(n+g)}_formatMediaInfos(){const {mediaInfos:g,layer:n}=this,q=this.attributes??{},l=this.formattedAttributes??
{},d=this.expressionAttributes??{},p=this.fieldInfoMap??new Map;return g?.map(r=>{r=r?.clone();if(!r)return null;r.title=F.substituteFieldsInLinksAndAttributes({attributes:q,fieldInfoMap:p,globalAttributes:l,expressionAttributes:d,layer:n,text:r.title});r.caption=F.substituteFieldsInLinksAndAttributes({attributes:q,fieldInfoMap:p,globalAttributes:l,expressionAttributes:d,layer:n,text:r.caption});r.altText=F.substituteFieldsInLinksAndAttributes({attributes:q,fieldInfoMap:p,globalAttributes:l,expressionAttributes:d,
layer:n,text:r.altText});if("image"===r.type){var {value:x}=r;this._setImageValue({value:x,formattedAttributes:l,layer:n});return r.value.sourceURL?r:void 0}return"pie-chart"===r.type||"line-chart"===r.type||"column-chart"===r.type||"bar-chart"===r.type?({value:x}=r,this._setChartValue({value:x,chartType:r.type,attributes:q,formattedAttributes:l,layer:n,expressionAttributes:d}),r):null}).filter(t.isSome)??[]}_setImageValue(g){const n=this.fieldInfoMap??new Map,{value:q,formattedAttributes:l,layer:d}=
g,{linkURL:p,sourceURL:r}=q;r&&(g=F.fixTokens(r,d),q.sourceURL=F.substituteAttributes({formattedAttributes:l,template:g,fieldInfoMap:n}));p&&(g=F.fixTokens(p,d),q.linkURL=F.substituteAttributes({formattedAttributes:l,template:g,fieldInfoMap:n}))}_setChartValue(g){const {value:n,attributes:q,formattedAttributes:l,chartType:d,layer:p,expressionAttributes:r}=g,{popupTemplate:x,relatedInfos:N}=this,{fields:k,normalizeField:h}=n;n.fields=F.getFixedFieldNames(k,p);h&&(n.normalizeField=F.getFixedFieldName(h,
p));if(k.some(e=>!!(null!=l[e]||F.isRelatedField(e)&&N?.size))){var a=x?.fieldInfos??[];k.forEach((e,f)=>{f=n.colors?.[f];F.isRelatedField(e)?n.series=[...n.series,...this._getRelatedChartInfos({fieldInfos:a,fieldName:e,formattedAttributes:l,chartType:d,value:n,color:f})]:(e=this._getChartOption({value:n,attributes:q,chartType:d,formattedAttributes:l,expressionAttributes:r,fieldName:e,fieldInfos:a,color:f}),n.series.push(e))})}}_getRelatedChartInfos(g){const {fieldInfos:n,fieldName:q,formattedAttributes:l,
chartType:d,value:p,color:r}=g,x=[],N=A.getRelatedFieldInfo(q);g=N&&this.relatedInfos?.get(N.layerId.toString());if(!g)return x;const {relatedFeatures:k,relation:h}=g;if(!h||!k)return x;({cardinality:g}=h);k.forEach(a=>{const {attributes:e}=a;e&&Object.keys(e).forEach(f=>{f===N.fieldName&&x.push(this._getChartOption({value:p,attributes:e,formattedAttributes:l,fieldName:q,chartType:d,relatedFieldName:f,hasMultipleRelatedFeatures:1<k?.length,fieldInfos:n,color:r}))})});return"one-to-many"===g||"many-to-many"===
g?x:[x[0]]}_getTooltip({label:g,value:n,chartType:q}){return"pie-chart"===q?`${g}`:`${g}: ${n}`}_getChartOption(g){const {value:n,attributes:q,formattedAttributes:l,expressionAttributes:d,fieldName:p,relatedFieldName:r,fieldInfos:x,chartType:N,hasMultipleRelatedFeatures:k,color:h}=g;var a=this.layer,e=this.fieldInfoMap??new Map;const {normalizeField:f,tooltipField:E}=n;g=f?F.isRelatedField(f)?q[A.getRelatedFieldInfo(f).fieldName]:q[f]:null;var w=F.isExpressionField(p)&&d&&void 0!==d[p]?d[p]:r&&void 0!==
q[r]?q[r]:void 0!==q[p]?q[p]:l[p];g=new M({fieldName:p,color:h,value:void 0===w?null:w&&g?w/g:w});if(F.isRelatedField(p))return a=e.get(p.toLowerCase()),w=E&&e.get(E.toLowerCase()),e=a?.fieldName??p,w=k&&E?A.getRelatedFieldInfo(E).fieldName:w?.fieldName??E,g.tooltip=this._getTooltip({label:k&&w?q[w]:l[w]??a?.label??a?.fieldName??r,value:k&&r?q[r]:l[e],chartType:N}),g;e=F.getFieldInfo(x,p);a=F.getFixedFieldName(p,a);e=E&&void 0!==l[E]?l[E]:F.getFieldInfoLabel(e||new K({fieldName:a}),this.popupTemplate?.expressionInfos);
g.tooltip=this._getTooltip({label:e,value:l[a],chartType:N});return g}};b.__decorate([y.property()],m.prototype,"abilities",void 0);b.__decorate([z.cast("abilities")],m.prototype,"castAbilities",null);b.__decorate([y.property()],m.prototype,"activeMediaInfoIndex",void 0);b.__decorate([y.property({readOnly:!0})],m.prototype,"activeMediaInfo",null);b.__decorate([y.property()],m.prototype,"attributes",void 0);b.__decorate([y.property()],m.prototype,"description",void 0);b.__decorate([y.property()],m.prototype,
"fieldInfoMap",void 0);b.__decorate([y.property()],m.prototype,"formattedAttributes",void 0);b.__decorate([y.property()],m.prototype,"expressionAttributes",void 0);b.__decorate([y.property({readOnly:!0})],m.prototype,"formattedMediaInfos",null);b.__decorate([y.property()],m.prototype,"isAggregate",void 0);b.__decorate([y.property()],m.prototype,"layer",void 0);b.__decorate([y.property({readOnly:!0})],m.prototype,"formattedMediaInfoCount",null);b.__decorate([y.property()],m.prototype,"mediaInfos",
void 0);b.__decorate([y.property()],m.prototype,"popupTemplate",void 0);b.__decorate([y.property()],m.prototype,"relatedInfos",void 0);b.__decorate([y.property()],m.prototype,"title",void 0);return m=b.__decorate([J.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],m)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../request ../../../core/arrayUtils ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../core/has ../../../layers/support/source/DataLayerSource ../../../rest/query/executeQueryJSON ../../../config ../../../kernel ../../../core/urlUtils ../../../core/unitUtils ../../../geometry/ellipsoidUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/featureConversionUtils ../../../geometry/Extent ../../../geometry/Geometry ../../../geometry/Multipoint ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/Polyline ../../../geometry/support/normalizeUtils ../../../core/pbf ../../../rest/support/FeatureSet ../../../rest/support/Query ../../../rest/query/support/AttachmentInfo ../../../rest/support/AttachmentQuery ../../../geometry ../../../rest/support/RelationshipQuery ../../../rest/support/TopFeaturesQuery ../../../rest/support/StatisticDefinition ./featureUtils".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r,x,N,k,h,a,e,f,E,w,L,D,G,P,S,C){function u(U,V){if(!V.relationships)return null;let I=null;({relationships:V}=V);V.some(O=>O.id===parseInt(U,10)?(I=O,!0):!1);return I}function v({originRelationship:U,relationships:V,layerId:I}){let O=null;V&&V.some(R=>{`${R.relatedTableId}`===I&&R.id===U?.id&&(O=R);return!!O});return O}function B(U,V){V=V.toLowerCase();for(const I in U)if(I.toLowerCase()===V)return U[I];return null}function Q(U,V,I,O){const R=new G;R.outFields=
["*"];R.relationshipId="number"===typeof V.id?V.id:parseInt(V.id,10);R.objectIds=[U.attributes[I.objectIdField]];return I.queryRelatedFeatures?.(R,O)??Promise.resolve({})}function T(U,V,I){let O=0;const R=[];for(;O<V.length;)R.push(`${U} IN (${V.slice(O,I+O)})`),O+=I;return R.join(" OR ")}function X(U){return U?t.unique(U):void 0}function ba(U){return U?t.unique(U,(V,I)=>JSON.stringify(V.toJSON())===JSON.stringify(I.toJSON())):void 0}async function da(U,V,I,O){var R=I.layerId.toString();const {layerInfo:W,
relation:Z,relatedFields:ca,outStatistics:fa,url:ha,sourceSpatialReference:ia}=V;V=X(ca);const ja=ba(fa);if(!W||!Z)return null;R=v({originRelationship:Z,relationships:W.relationships,layerId:R});if(R?.relationshipTableId&&R.keyFieldInRelationshipTable){I=(await Q(U,R,I,O))[U.attributes[I.objectIdField]];if(!I)return null;const ka=I.features.map(la=>la.attributes[W.objectIdField]);if(ja?.length&&W.supportsStatistics)return O=new E,O.where=T(W.objectIdField,ka,1E3),O.outFields=V,O.outStatistics=ja,
O.sourceSpatialReference=ia,O={features:Promise.resolve(I),statsFeatures:F.executeQueryJSON(ha,O)},H.eachAlways(O)}return(I=R?.keyField)?(R=J.isNumericField(aa(W.fields,I)),U=B(U.attributes,Z.keyField),I=R?`${I}=${U}`:`${I}='${U}'`,U=F.executeQueryJSON(ha,new E({where:I,outFields:V,sourceSpatialReference:ia}),O),O=ja?.length&&W.supportsStatistics?F.executeQueryJSON(ha,new E({where:I,outFields:V,outStatistics:ja,sourceSpatialReference:ia}),O):null,V={features:U},O&&(V.statsFeatures=O),H.eachAlways(V)):
null}function aa(U,V){if(null!=U){V=V.toLowerCase();for(const I of U)if(I&&I.name.toLowerCase()===V)return I}return null}const ea=z.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),Y=new Map;b.createRelatedInfo=function(U,V){if(U=u(U,V))return{url:`${V.url}/${U.relatedTableId}`,sourceSpatialReference:V.spatialReference,relation:U,relatedFields:[],outStatistics:[]}};b.getDestinationRelation=v;b.getRelatedFieldInfo=function(U){if(!C.isRelatedField(U))return null;const [V,I]=U.split("/").slice(1);
return{layerId:V,fieldName:I}};b.getUniqueOutFields=X;b.getUniqueOutStatistics=ba;b.queryLayerInfos=function({relatedInfos:U,layer:V},I){const O={};U.forEach((R,W)=>{({relation:R}=R);if(!R)throw W=new y("relation-required","A relation is required on a layer to retrieve related records."),ea.error(W),W;({relatedTableId:R}=R);if("number"!==typeof R)throw W=new y("A related table ID is required on a layer to retrieve related records."),ea.error(W),W;R=`${V.url}/${R}`;const Z=Y.get(R),ca=Z??m(R,{query:{f:"json"},
signal:(void 0)?.signal});Z||Y.set(R,ca);O[W]=ca});return H.whenOrAbort(H.eachAlways(O),I)};b.queryRelatedFeatures=function({graphic:U,relatedInfos:V,layer:I},O){const R={};V.forEach((W,Z)=>{W.layerInfo&&(R[Z]=da(U,W,I,O))});return H.eachAlways(R)};b.setRelatedFeatures=function(U,V){if(V&&U){var {features:I,statsFeatures:O}=U;U=I?.value;V.relatedFeatures=U?U.features:[];U=O?.value;V.relatedStatsFeatures=U?U.features:[]}};b.updateRelatedInfo=function({relatedInfo:U,fieldName:V,fieldInfo:I}){U.relatedFields?.push(V);
I.statisticType&&(V=new S({statisticType:I.statisticType,onStatisticField:V,outStatisticFieldName:V}),U.outStatistics?.push(V))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureExpression/FeatureExpressionViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r,x,N,k,h){t=class extends t{constructor(a){super(a);this.view=this.interceptor=this.contentElementViewModel=this.contentElement=this.graphic=this.expressionInfo=this._abortController=null;this._cancelQuery=()=>{const {_abortController:e}=this;e&&e.abort();this._abortController=null};this._createVM=()=>{var e=this.contentElement?.type;this.contentElementViewModel?.destroy();e="fields"===e?new N:"media"===e?new k:"text"===e?new x:null;this._set("contentElementViewModel",
e)};this._compile=async()=>{this._cancelQuery();const e=new AbortController;this._abortController=e;await this._compileExpression();this._abortController===e&&(this._abortController=null)};this._compileThrottled=z.throttle(this._compile,1,this);this._compileExpression=async()=>{const {expressionInfo:e,graphic:f,interceptor:E,spatialReference:w,map:L,view:D,_abortController:G}=this;if(e&&f&&w&&L){var P=await h.loadArcadeUtils();if(G===this._abortController)if((P=await h.createCompiledExpression({arcadeUtils:P,
expressionInfo:e,graphic:f,interceptor:E,map:L,spatialReference:w,view:D}))&&"esri.arcade.Dictionary"===P.declaredClass){P=await P.castAsJsonAsync(G?.signal);var S=P?.type;P="media"===S?l.fromJSON(P):"text"===S?p.fromJSON(P):"fields"===S?q.fromJSON(P):null;this._set("contentElement",P)}else this._set("contentElement",null)}else this._set("contentElement",null)};this.addHandles([y.watch(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),y.initial),
y.watch(()=>[this.contentElement],()=>this._createVM(),y.initial)])}initialize(){this.addHandles(this._compileThrottled)}destroy(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(a){this._override("spatialReference",a)}get state(){const {_abortController:a,contentElement:e,contentElementViewModel:f}=this;return a?"loading":e||f?
"ready":"disabled"}get map(){return this.view?.map??null}set map(a){this._override("map",a)}};b.__decorate([H.property()],t.prototype,"_abortController",void 0);b.__decorate([H.property({type:r})],t.prototype,"expressionInfo",void 0);b.__decorate([H.property({type:m})],t.prototype,"graphic",void 0);b.__decorate([H.property({readOnly:!0})],t.prototype,"contentElement",void 0);b.__decorate([H.property({readOnly:!0})],t.prototype,"contentElementViewModel",void 0);b.__decorate([H.property()],t.prototype,
"interceptor",void 0);b.__decorate([H.property()],t.prototype,"spatialReference",null);b.__decorate([H.property({readOnly:!0})],t.prototype,"state",null);b.__decorate([H.property()],t.prototype,"map",null);b.__decorate([H.property()],t.prototype,"view",void 0);return t=b.__decorate([F.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],t)})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../core/Logger ../../../core/promiseUtils ../../../layers/FeatureLayer ./featureUtils".split(" "),
function(b,m,t,y,z,H){function J(q){return`<ul class="esri-widget__list">${q.map(l=>`<li>${"string"===typeof l?H.applyTextFormattingHTML(H.htmlEntities(l)):l}</li>`).join("")}</ul>`}function K(q){return`<table class="esri-widget__table">${q.keys().map(l=>{var d=q.field(l);d="string"===typeof d?H.applyTextFormattingHTML(H.htmlEntities(d)):d;return`<tr><th>${l}</th><td>${d}</td></tr>`}).join("")}</table>`}function M({aggregatedFeatures:q,arcadeUtils:l,featureSetVars:d,context:p,viewInfo:r,map:x,graphic:N,
interceptor:k}){d.forEach(h=>{h=h.toLowerCase();var a=r.sr;const e={map:x,spatialReference:a,interceptor:k};"$map"===h&&(p.vars[h]=l.convertMapToFeatureSetCollection(e));"$layer"===h&&(p.vars[h]=l.convertFeatureLayerToFeatureSet({layer:N.sourceLayer,spatialReference:a,interceptor:k}));"$datastore"===h&&(p.vars[h]=l.convertServiceUrlToWorkspace({url:N.sourceLayer.url,spatialReference:a,interceptor:k}));if("$aggregatedfeatures"===h){a=N.layer;const {fields:f,objectIdField:E,geometryType:w,spatialReference:L,
displayField:D}=a;a=new z({fields:f,objectIdField:E,geometryType:w,spatialReference:L,displayField:D,...("feature"===a.type?{templates:a.templates,typeIdField:a.typeIdField,types:a.types}:null),source:q});p.vars[h]=l.convertFeatureLayerToFeatureSet({layer:a,spatialReference:L,interceptor:k})}})}function F(){return new Promise((q,l)=>b(["../../../support/arcadeUtils"],q,l))}async function A({graphic:q,view:l}){const {isAggregate:d,layer:p}=q;if(!d||!p||"2d"!==l?.type)return[];l=await l.whenLayerView(p);
if(!("createQuery"in l&&"queryFeatures"in l))return[];const r=l.createQuery();q=q.getObjectId();r.aggregateIds=null!=q?[q]:[];({features:q}=await l.queryFeatures(r));return q}async function c({expressionInfo:q,arcadeUtils:l,interceptor:d,spatialReference:p,map:r,graphic:x,view:N}){if(!q?.expression)return null;const k=l.createSyntaxTree(q.expression),h=g.filter(e=>l.hasVariable(k,e)),[a]=await Promise.all([A({graphic:x,view:N}),l.loadScriptDependencies(k,!0,h)]);p=l.getViewInfo({spatialReference:p});
N=l.createExecContext(x,p,N?.timeZone);N.interceptor=d;N.useAsync=!0;M({aggregatedFeatures:a,arcadeUtils:l,featureSetVars:h,context:N,viewInfo:p,map:r,graphic:x,interceptor:d});d=l.createFunction(k,N);return l.executeAsyncFunction(d,N).catch(e=>n.error("arcade-execution-error",{error:e,graphic:x,expressionInfo:q}))}const g=["$datastore","$map","$layer","$aggregatedfeatures"],n=t.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");m.createCompiledExpression=c;m.createCompiledExpressions=async function({expressionInfos:q,
spatialReference:l,graphic:d,interceptor:p,map:r,view:x}){if(!q?.length)return{};const N=await F(),k={};for(const h of q)k[`expression/${h.name}`]=c({expressionInfo:h,arcadeUtils:N,interceptor:p,spatialReference:l,map:r,graphic:d,view:x});q=await y.eachAlways(k);l={};for(const h in q)d=q[h].value,d="string"===typeof d?H.applyTextFormattingHTML(H.htmlEntities(d)):Array.isArray(d)?J(d):"esri.arcade.Dictionary"===d?.declaredClass?K(d):d,l[h]=d;return l};m.loadArcadeUtils=F;Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Feature/FeatureRelationship":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureRelationship/FeatureRelationshipViewModel ./support/FeatureElementInfo ../support/componentsUtils ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r,x,N){const k={title:!0,description:!0};t=class extends c{constructor(h,a){super(h,a);this._relatedFeatureIntersectionObserverNode=this._featureElementInfo=null;this._relatedFeatureIntersectionObserver=new IntersectionObserver(([e])=>{e?.isIntersecting&&this._increaseFeaturePage()},{root:window.document});this.headingLevel=2;this.viewModel=new g;this.messagesCommon=this.messages=null;this.visibleElements={...k};this._increaseFeaturePage=()=>{const {state:e,
showAllEnabled:f,relatedFeatures:E,featuresPerPage:w,featurePage:L}=this.viewModel;"ready"===e&&f&&E.length>=w*L&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new n;this.addHandles([H.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),H.initial),H.watch(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),H.on(()=>this.viewModel.relatedFeatureViewModels,
"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return q.loadCalciteComponents({icon:()=>new Promise((h,a)=>b(["../../chunks/calcite-icon"],h,a)),list:()=>new Promise((h,a)=>b(["../../chunks/calcite-list"],h,a)),"list-item":()=>new Promise((h,a)=>b(["../../chunks/calcite-list-item"],h,a)),notice:()=>new Promise((h,a)=>b(["../../chunks/calcite-notice"],h,a))})}destroy(){this._unobserveRelatedFeatureObserver();this._featureElementInfo=y.destroyMaybe(this._featureElementInfo)}get displayShowAllButton(){const {showAllEnabled:h,
featureCount:a,displayCount:e,state:f}=this.viewModel;return!h&&!!a&&"ready"===f&&(a>e||0===e)}get displayListItems(){return this.displayShowAllButton||0<this.viewModel.relatedFeatureViewModels.length}get description(){return this.viewModel.description}set description(h){this.viewModel.description=h}get featureCountDescription(){const {messages:h}=this,{featureCount:a}=this.viewModel;return N.substitute(h?.numberRecords,{number:a})}get title(){return this.viewModel.title}set title(h){this.viewModel.title=
h}castVisibleElements(h){return{...k,...h}}render(){const {state:h}=this.viewModel;return x.tsx("div",{class:this.classes("esri-feature-relationship",l.globalCss.widget)},this._featureElementInfo?.render(),"loading"===h?this._renderLoading():"disabled"===h?this._renderRelationshipNotFound():this._renderRelatedFeatures())}_renderStickyLoading(){return"querying"===this.viewModel.state?x.tsx("div",{class:"esri-feature__sticky-loading-container",key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return x.tsx("span",
{class:this.classes(d.legacyIcon.loadingIndicator,l.globalCss.rotating,"esri-feature__loading-spinner")})}_renderLoading(){return x.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return x.tsx("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const h=p.isRTL(this.container)?"chevron-left":"chevron-right";return x.tsx("calcite-icon",{icon:h,scale:"s",slot:"content-end"})}_renderRelatedFeature(h){const {itemDescriptionFieldName:a}=
this.viewModel,e=h.title;h.description=a&&h.formattedAttributes?.global[a];return x.tsx("calcite-list-item",{class:this.classes("esri-feature-relationship__list-item",{["esri-feature-relationship__list-item--hidden"]:"loading"===h.state}),description:h.description??"",key:h.uid,label:e,onCalciteListItemSelect:()=>this.emit("select-record",{featureViewModel:h})},this._renderChevronIconNode())}_renderShowAllListItem(){return this.displayShowAllButton?x.tsx("calcite-list-item",{description:this.featureCountDescription,
key:"show-all-item",label:this.messages?.showAll,onCalciteListItemSelect:()=>this.emit("show-all-records")},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){return x.tsx("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},x.tsx("div",{slot:"message"},this.messages?.noRelatedFeatures))}_renderFeatureObserver(){return x.tsx("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:"esri-feature__feature-observer",
key:"feature-observer"})}_renderList(){const {relatedFeatureViewModels:h}=this.viewModel;return x.tsx("calcite-list",null,h.toArray().map(a=>this._renderRelatedFeature(a)),this._renderShowAllListItem())}_renderRelatedFeatures(){const {displayListItems:h}=this,{state:a}=this.viewModel;return x.tsx("div",{class:this.classes("esri-feature-relationship__list",{["esri-feature-relationship__list--querying"]:"querying"===a}),key:"list-container"},h?this._renderList():"ready"===a?this._renderNoRelatedFeaturesMessage():
null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){return x.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},x.tsx("div",{slot:"message"},this.messages?.relationshipNotFound))}_setupRelatedFeatureViewModels(){const {relatedFeatureViewModels:h}=this.viewModel;this.removeHandles("related-feature-viewmodels");h?.forEach(a=>{this.addHandles(H.watch(()=>[a.title,a.state],()=>this.scheduleRender(),
H.initial),"related-feature-viewmodels")});this.scheduleRender()}_setupFeatureElementInfo(){const {headingLevel:h,visibleElements:a}=this,e=a.description&&this.description,f=a.title&&this.title;this._featureElementInfo?.set({description:e,title:f,headingLevel:h})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const {state:h,showAllEnabled:a}=this.viewModel;await z.after(0);this._relatedFeatureIntersectionObserverNode&&"ready"===h&&a&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(h){this._relatedFeatureIntersectionObserverNode=
h}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};m.__decorate([J.property()],t.prototype,"_relatedFeatureIntersectionObserverNode",void 0);m.__decorate([J.property({readOnly:!0})],t.prototype,"displayShowAllButton",null);m.__decorate([J.property({readOnly:!0})],t.prototype,"displayListItems",null);m.__decorate([J.property()],t.prototype,"description",null);m.__decorate([J.property({readOnly:!0})],
t.prototype,"featureCountDescription",null);m.__decorate([J.property()],t.prototype,"headingLevel",void 0);m.__decorate([J.property()],t.prototype,"title",null);m.__decorate([J.property({type:g})],t.prototype,"viewModel",void 0);m.__decorate([J.property(),r.messageBundle("esri/widgets/Feature/t9n/Feature")],t.prototype,"messages",void 0);m.__decorate([J.property(),r.messageBundle("esri/t9n/common")],t.prototype,"messagesCommon",void 0);m.__decorate([J.property()],t.prototype,"visibleElements",void 0);
m.__decorate([K.cast("visibleElements")],t.prototype,"castVisibleElements",null);return t=m.__decorate([A.subclass("esri.widgets.Feature.FeatureRelationship")],t)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l){t=class extends z.ClonableMixin(J.IdentifiableMixin(t)){constructor(d){super(d);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.featuresPerPage=10;this.orderByFields=this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.relationshipId=null;this.showAllEnabled=!1;this.title=null;this._cancelQuery=()=>{const {_queryAbortController:p}=this;p&&p.abort();this._queryAbortController=
null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:p}=this;p&&p.abort();this._queryFeatureCountAbortController=null};this._cancelQueryPage=()=>{const {_queryPageAbortController:p}=this;p&&p.abort();this._queryPageAbortController=null};this._queryController=async()=>{this._cancelQuery();const p=new AbortController;this._queryAbortController=p;await K.ignoreAbortErrors(this._query());this._queryAbortController===p&&(this._queryAbortController=null)};this._queryFeatureCountController=
async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const p=new AbortController;this._queryFeatureCountAbortController=p;await K.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===p&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryPageController=async()=>{const p=new AbortController;this._queryPageAbortController=p;await K.ignoreAbortErrors(this._queryPage());this._queryPageAbortController===p&&(this._queryPageAbortController=null)};
this._queryDebounced=K.debounce(this._queryController,100);this._queryFeatureCountDebounced=K.debounce(this._queryFeatureCountController,100);this._queryPageDebounced=K.debounce(this._queryPageController,100);this._query=async()=>{const {_queryAbortController:p,relatedFeatures:r}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,r.removeAll(),this.destroyed||r.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:p?.signal}))))};this.addHandles([M.watch(()=>
[this.displayCount,this.graphic,this.layer,this.layer?.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount],()=>this._queryDebounced(),M.initial),M.watch(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),M.watch(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.removeAll();
this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()}set featurePage(d){const {featuresPerPage:p,featureCount:r}=this;this._set("featurePage",Math.min(Math.max(d,1),Math.ceil(r/p)||1))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const {orderByFields:d,relatedLayer:p}=this;return d&&p?.loaded?d.map(r=>{const x=r.clone();x.field=q.getFixedFieldName(r.field,p);return x}):d??[]}get supportsCacheHint(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}get canLoad(){return!!this.map&&
"number"===typeof this.relationshipId&&"number"===typeof this.objectId}get canQuery(){const d=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&"number"===typeof this.relationshipId&&"number"===typeof this.objectId&&!!d?.supportsCount&&!!d?.supportsPagination}get itemDescriptionFieldName(){return this.orderByFieldsFixedCasing[0]?.field||null}set displayCount(d){this._set("displayCount",Math.min(Math.max(d,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){return(this.objectIdField&&
this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get relatedFeatures(){return this._get("relatedFeatures")||new H}get relatedLayer(){const {layer:d,map:p,relationship:r}=this;return d?.loaded&&p&&r?q.findRelatedLayer(p,d,r)??null:null}get relationship(){const {relationshipId:d,layer:p}=this;return"number"===typeof d?p?.relationships?.find(({id:r})=>r===d)??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||
new H}get state(){const {_queryAbortController:d,_queryFeatureCountAbortController:p,_queryPageAbortController:r,canQuery:x,_loaded:N,canLoad:k}=this;return p||k&&!N?"loading":d||r?"querying":x?"ready":"disabled"}getRelatedFeatureByObjectId(d){return this.relatedFeatures.find(p=>p.getObjectId()===d)}_destroyRelatedFeatureViewModels(){this.relatedFeatureViewModels?.forEach(d=>!d.destroyed&&d.destroy());this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){const {layer:d,relatedLayer:p,
relationshipId:r,objectId:x,_queryFeatureCountAbortController:N,canQuery:k,supportsCacheHint:h}=this;await d?.load();await p?.load();if(k&&d&&p){var a=p.createQuery();a=new n({cacheHint:h,relationshipId:r,returnGeometry:!1,objectIds:[x],where:a.where??void 0});a=await d.queryRelatedFeaturesCount(a,{signal:N?.signal});this._set("featureCount",a[x]||0)}else this._set("featureCount",0)}_sliceFeatures(d){const {showAllEnabled:p,displayCount:r}=this;return p?d:r?d.slice(0,r):[]}async _queryPage(){const {relatedFeatures:d,
featurePage:p,showAllEnabled:r,_queryPageAbortController:x,featureCount:N}=this;!r||2>p||!N||d.addMany(await this._queryRelatedFeatures({signal:x?.signal}))}async _queryRelatedFeatures(d){const {orderByFieldsFixedCasing:p,showAllEnabled:r,featuresPerPage:x,displayCount:N,layer:k,relationshipId:h,featurePage:a,featureCount:e,relatedLayer:f,supportsCacheHint:E}=this,{canQuery:w,objectId:L}=this;if(!w||!k||!f)return[];var D=r?((a-1)*x+e)%e:0;const G=r?x:N;var P=f.objectIdField;P=[...p.map(u=>u.field),
...l.getFieldsInTitleAndDesc(f),P].filter(y.isSome);const S=p.map(u=>`${u.field} ${u.order}`),C=f.createQuery();D=new n({orderByFields:S,start:D,num:G,outFields:P,cacheHint:E,relationshipId:h,returnGeometry:!1,objectIds:[L],where:C.where??void 0});d=(await k.queryRelatedFeatures(D,{signal:d?.signal}))[L]?.features||[];d.forEach(u=>{u.sourceLayer=f;u.layer=f});return d}};b.__decorate([F.property()],t.prototype,"_loaded",void 0);b.__decorate([F.property()],t.prototype,"_queryAbortController",void 0);
b.__decorate([F.property()],t.prototype,"_queryPageAbortController",void 0);b.__decorate([F.property()],t.prototype,"_queryFeatureCountAbortController",void 0);b.__decorate([F.property({value:1})],t.prototype,"featurePage",null);b.__decorate([F.property()],t.prototype,"featuresPerPage",void 0);b.__decorate([F.property({readOnly:!0})],t.prototype,"orderByFieldsFixedCasing",null);b.__decorate([F.property({readOnly:!0})],t.prototype,"supportsCacheHint",null);b.__decorate([F.property({readOnly:!0})],
t.prototype,"canLoad",null);b.__decorate([F.property({readOnly:!0})],t.prototype,"canQuery",null);b.__decorate([F.property()],t.prototype,"description",void 0);b.__decorate([F.property({readOnly:!0})],t.prototype,"itemDescriptionFieldName",null);b.__decorate([F.property({value:3})],t.prototype,"displayCount",null);b.__decorate([F.property({type:m})],t.prototype,"graphic",void 0);b.__decorate([F.property()],t.prototype,"layer",void 0);b.__decorate([F.property()],t.prototype,"map",void 0);b.__decorate([F.property({readOnly:!0})],
t.prototype,"objectId",null);b.__decorate([F.property({readOnly:!0})],t.prototype,"objectIdField",null);b.__decorate([F.property()],t.prototype,"orderByFields",void 0);b.__decorate([F.property({readOnly:!0})],t.prototype,"relatedFeatures",null);b.__decorate([F.property({readOnly:!0})],t.prototype,"relatedLayer",null);b.__decorate([F.property({readOnly:!0})],t.prototype,"relationship",null);b.__decorate([F.property()],t.prototype,"featureCount",void 0);b.__decorate([F.property({readOnly:!0})],t.prototype,
"relatedFeatureViewModels",null);b.__decorate([F.property()],t.prototype,"relationshipId",void 0);b.__decorate([F.property()],t.prototype,"showAllEnabled",void 0);b.__decorate([F.property()],t.prototype,"state",null);b.__decorate([F.property()],t.prototype,"title",void 0);b.__decorate([F.property()],t.prototype,"getRelatedFeatureByObjectId",null);return t=b.__decorate([g.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],t)})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/string ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../smartMapping/support/utils ../support/dateUtils ../../intl/substitute".split(" "),
function(b,m,t,y,z,H,J,K,M,F){function A(e){const {fields:f,values:E}=e,w=e.timeZone??void 0;e=f.map((L,D)=>{let G=E[D];L.domain&&"coded-value"===L.domain.type&&(D=L.domain.codedValues.find(P=>P.code===G),D?.name&&(G=D.name));if(K.isAnyDateField(L)||J.isTimeOnlyField(L))G=M.getLabelForDateFieldValue(L,G,{timeZone:w,...M.getIntlOptionsForField(L)});return[L.name,G]});return Object.fromEntries(e)}function c(e,f){return z.replace(z.replace(e,E=>`{${E.toLowerCase()}}`),Object.fromEntries(Object.entries(f).map(([E,
w])=>[E.toLowerCase(),w])))}function g(e){return 1E7<=e||-1E7>=e}const n=e=>"field"===e?.type,q=e=>"relationship"===e?.type,l=e=>"field"===e.type,d=e=>e.reduce((f,E)=>"group"===E?.type?[...f,...E.inputs]:[...f,E],[]),p=(e,f)=>null!=e&&e.input?.type===f,r={typeFieldName:null,types:[]};b.LengthValidationError=void 0;(b.LengthValidationError||(b.LengthValidationError={})).TOO_SHORT="length-validation-error::too-short";const x={type:"number"},N={type:"number",intlOptions:{notation:"scientific"}},k={day:"2-digit",
month:"2-digit",year:"numeric"},h={hour:"numeric",minute:"numeric",second:"numeric"},a={...k,...h};b.capabilitiesAllowEditType=(e,f)=>{if(!e)return!0;({operations:e}=e);switch(f){case "INSERT":return e.supportsAdd;case "UPDATE":case "DELETE":return e.supportsUpdate;default:return!0}};b.flattenFieldInputs=e=>d(e).filter(n);b.flattenInputs=d;b.flattenRelationshipInputs=e=>d(e).filter(q);b.formTemplateHasInvalidFields=function(e){return"formTemplate"in e&&e.formTemplate?(e.formTemplate.elements?.filter(l)??
[]).some(({fieldName:f})=>!e.fieldsIndex.get(f)):!1};b.getComputedAttributes=A;b.getErrorMessageForFieldInput=(e,f,E)=>{const {dataType:w,error:L,minLength:D,value:G,required:P}=e;if(!f||!L)return null;if(P&&null===G)return f.validationErrors.cannotBeNull;if(L===H.DomainValidationError.VALUE_OUT_OF_RANGE||L===J.NumericRangeValidationError.OUT_OF_RANGE){const {field:S,range:C}=e;e={type:"date",intlOptions:{...("time-only"===S.type?h:"date-only"===S.type?k:a),timeZone:E??void 0}};return F.substitute(f.validationErrors.outsideRange,
C,{format:{max:"date"===w?e:null!=C.max&&g(C.max)?N:x,min:"date"===w?e:null!=C.min&&g(C.min)?N:x}})}return L===H.DomainValidationError.INVALID_CODED_VALUE?f.validationErrors.invalidCodedValue:L===J.TypeValidationError.INVALID_TYPE?f.validationErrors.invalidType:L===b.LengthValidationError.TOO_SHORT?F.substitute(f.validationErrors.tooShort,{min:D}):null};b.getFieldsInTitleAndDesc=e=>{const f=[];if(e.formTemplate){const {description:E,title:w}=e.formTemplate;e.fields?.forEach(L=>{const D=w&&z.templateHasKey(w,
L.name),G=E&&z.templateHasKey(E,L.name);(D||G)&&f.push(L.name)})}return f};b.getIconForFeature=e=>{if(e){var f=e.layer;f=f&&"geometryType"in f?f.geometryType:void 0;e=e.geometry?.type;return"polyline"===e||"polyline"===f?"line":e||f||"table"}};b.getNormalizedFeatureTypeInfo=e=>e?"subtype-sublayer"===e.type?{typeFieldName:e.parent?.subtypeField,types:e.parent?.subtypes??[]}:"types"in e&&e.types?{typeFieldName:e.typeIdField,types:e.types.map(({id:f,name:E,domains:w})=>({code:f,name:E,domains:w}))}:
r:r;b.isFieldElement=l;b.isFieldElementWithInputType=p;b.isFieldElementWithShowNoValueOptionInput=e=>null!=e&&(p(e,"combo-box")||p(e,"radio-buttons"));b.isFieldElementWithTextInput=e=>null!=e&&(p(e,"text-box")||p(e,"text-area"));b.isFieldInput=n;b.isGroupElement=e=>"group"===e.type;b.isGroupInput=e=>"group"===e?.type;b.isInputInGroupInput=e=>"group"!==e?.type&&null!=e.group;b.isNumberFieldInput=({domain:e,inputType:f="text-box",dataType:E})=>"number"===E&&"text-box"===f&&(!e||"coded-value"!==e.type);
b.isRelationshipElement=e=>"relationship"===e.type;b.isRelationshipInput=q;b.isTemplateItemGroup=e=>"items"in e;b.parseFormTemplateString=function(e){const {attributes:f,fieldsIndex:E,label:w,timeZone:L}=e;if(!f||"object"!==typeof f)return w;var D=Object.keys(f).filter(G=>z.templateHasKey(w,G));e=D.map(G=>f[G]);D=D.map(G=>E.get(G)).filter(t.isSome);return c(w,A({values:e,fields:D,timeZone:L}))};b.substituteFieldTemplatesInString=c;b.valueIsInvalidSwitchValue=function(e,f){return null==e||f.onValue!==
e&&f.offValue!==e};b.valueIsValidContingentValue=function(e,f){switch(f.objectType){case "any":return!0;case "null":return null==e;case "code":return e===f.codedValue?.code;case "range":return null!=e&&null!=f.minValue&&null!=f.maxValue&&+e>=f.minValue&&+e<=f.maxValue;default:return y.neverReached(f.objectType),!1}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/arrayUtils ../../core/Identifiable ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../popup/content/TextContent ../../time/timeZoneUtils ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureExpression/FeatureExpressionViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./FeatureRelationship/FeatureRelationshipViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r,x,N,k,h,a,e){var f;const E={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};y=f=class extends H.IdentifiableMixin(y){constructor(w){super(w);this._featureAbortController=this._error=null;this._graphicChangedThrottled=F.throttle(this._graphicChanged,1,this);this._graphicExpressionAttributes=this._expressionAttributes=null;this.abilities={...E};this.content=
null;this.contentViewModels=[];this.description=null;this.defaultPopupTemplateEnabled=!1;this.lastEditInfo=this.formattedAttributes=null;this.relatedInfos=new Map;this.title="";this.view=null;this._isAllowedContentType=L=>{const {abilities:D}=this;return"attachments"===L.type&&!!D.attachmentsContent||"custom"===L.type&&!!D.customContent||"fields"===L.type&&!!D.fieldsContent||"media"===L.type&&!!D.mediaContent||"text"===L.type&&!!D.textContent||"expression"===L.type&&!!D.expressionContent||"relationship"===
L.type&&!!D.relationshipContent};this.addHandles(M.watch(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),M.initial))}initialize(){this.addHandles(this._graphicChangedThrottled)}destroy(){this._clear();this._cancelFeatureQuery();this.graphic=this._error=null;this._destroyContentViewModels();this.relatedInfos.clear()}get _effectivePopupTemplate(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return a.createfieldInfoMap(a.getAllFieldInfos(this._effectivePopupTemplate),
this._sourceLayer)}get _sourceLayer(){return a.getSourceLayer(this.graphic)}castAbilities(w){return{...E,...w}}get isTable(){return this._sourceLayer?.isTable||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(w){this._set("graphic",w?w.clone():null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(w){this._override("spatialReference",w)}get map(){return this.view?.map||null}set map(w){this._override("map",
w)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(w,L){w=this.contentViewModels[w];w instanceof N&&w.setActiveMedia(L)}nextMedia(w){w=this.contentViewModels[w];w instanceof N&&w.next()}previousMedia(w){w=this.contentViewModels[w];w instanceof N&&w.previous()}async updateGeometry(){const {graphic:w,spatialReference:L,_sourceLayer:D}=this;await D?.load();var G=D?.objectIdField;G&&w&&D&&(G=w?.attributes?.[G],null!=G&&(G=[G],!w.geometry&&(G=(await a.querySourceLayer({layer:D,
graphic:w,outFields:[],objectIds:G,returnGeometry:!0,spatialReference:L}))?.geometry)))&&(w.geometry=G)}_clear(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery();this._error=null;this._clear();const {graphic:w}=this;if(w){var L=new AbortController;this._featureAbortController=L;try{await this._queryFeature({signal:L.signal})}catch(D){K.isAbortError(D)||(this._error=D,J.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",
{error:D,graphic:w,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===L&&(this._featureAbortController=null)}}_cancelFeatureQuery(){const {_featureAbortController:w}=this;w&&w.abort();this._featureAbortController=null}_compileContentElement(w,L){if("attachments"===w.type)return this._compileAttachments(w,L);if("custom"===w.type)return this._compileCustom(w,L);if("fields"===w.type)return this._compileFields(w,L);if("media"===w.type)return this._compileMedia(w,L);if("text"===
w.type)return this._compileText(w,L);if("expression"===w.type)return this._compileExpression(w,L);if("relationship"===w.type)return this._compileRelationship(w,L)}_compileContent(w){this._destroyContentViewModels();if(this.graphic)return Array.isArray(w)?w.filter(this._isAllowedContentType).map((L,D)=>this._compileContentElement(L,D)).filter(z.isSome):"string"===typeof w?this._compileText(new q({text:w}),0).text:w}_destroyContentViewModels(){this.removeHandles("relationship-view-models");this.removeHandles("content-view-models");
this.contentViewModels.forEach(w=>w&&!w.destroyed&&w.destroy());this._set("contentViewModels",[])}_matchesFeature(w,L){w=w?.graphic?.getObjectId();L=L?.getObjectId();return null!=w&&null!=L&&w===L}_setRelatedFeaturesViewModels({relatedFeatureViewModels:w,relatedFeatures:L,map:D}){const {view:G,spatialReference:P}=this;L?.filter(Boolean).forEach(S=>{w.find(C=>this._matchesFeature(C,S))||w.add(new f({abilities:{relationshipContent:!1},map:D,view:G,spatialReference:P,graphic:S}))});w.forEach(S=>{L?.find(C=>
this._matchesFeature(S,C))||w.remove(S)})}_setExpressionContentVM(w,L){const D=this.formattedAttributes,{contentElement:G,contentElementViewModel:P}=w;w=G?.type;P&&w&&("fields"===w&&(this._createFieldsFormattedAttributes({contentElement:G,contentElementIndex:L,formattedAttributes:D}),P.set(this._createFieldsVMParams(G,L))),"media"===w&&(this._createMediaFormattedAttributes({contentElement:G,contentElementIndex:L,formattedAttributes:D}),P.set(this._createMediaVMParams(G,L))),"text"===w&&P.set(this._createTextVMParams(G)))}_compileRelationship(w,
L){const {displayCount:D,orderByFields:G,relationshipId:P,title:S,description:C}=w,{_sourceLayer:u,graphic:v,map:B}=this;if(a.isRelatableFeatureSupportedLayer(u)){var Q=new k({displayCount:D,graphic:v,orderByFields:G,relationshipId:P,layer:u,map:B,...this._compileTitleAndDesc({title:S,description:C})});this.contentViewModels[L]=Q;this.addHandles(M.on(()=>Q.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(Q)),"relationship-view-models");return w}}_compileExpression(w,L){const {expressionInfo:D}=
w,{graphic:G,map:P,spatialReference:S,view:C}=this,u=new r({expressionInfo:D,graphic:G,interceptor:f.interceptor,map:P,spatialReference:S,view:C});this.contentViewModels[L]=u;this.addHandles(M.watch(()=>u.contentElementViewModel,()=>this._setExpressionContentVM(u,L),M.initial),"content-view-models");return w}_compileAttachments(w,L){const {graphic:D}=this,{description:G,title:P}=w;this.contentViewModels[L]=new d({graphic:D,...this._compileTitleAndDesc({title:P,description:G})});return w}_compileCustom(w,
L){const {graphic:D}=this,{creator:G,destroyer:P}=w;this.contentViewModels[L]=new p({graphic:D,creator:G,destroyer:P});return w}_compileTitleAndDesc({title:w,description:L}){const {_fieldInfoMap:D,_sourceLayer:G,graphic:P,formattedAttributes:S}=this,C=P?.attributes,u=this._expressionAttributes,v=S.global;return{title:a.substituteFieldsInLinksAndAttributes({attributes:C,fieldInfoMap:D,globalAttributes:v,expressionAttributes:u,layer:G,text:w}),description:a.substituteFieldsInLinksAndAttributes({attributes:C,
fieldInfoMap:D,globalAttributes:v,expressionAttributes:u,layer:G,text:L})}}_createFieldsVMParams(w,L){const D=this._effectivePopupTemplate,G=this.formattedAttributes,P={...G?.global,...G?.content[L]};L=(w?.fieldInfos||D?.fieldInfos)?.filter(({fieldName:u})=>a.isExpressionField(u)||a.isRelatedField(u)||P.hasOwnProperty(u));const {description:S,title:C}=w;return{attributes:P,expressionInfos:D?.expressionInfos,fieldInfos:L,...this._compileTitleAndDesc({title:C,description:S})}}_compileFields(w,L){const D=
w.clone();w=new x(this._createFieldsVMParams(w,L));this.contentViewModels[L]=w;D.fieldInfos=w.formattedFieldInfos.slice(0);return D}_createMediaVMParams(w,L){const {abilities:D,graphic:G,_fieldInfoMap:P,_effectivePopupTemplate:S,relatedInfos:C,_sourceLayer:u,_expressionAttributes:v}=this,B=this.formattedAttributes,Q=G?.attributes??{},{description:T,mediaInfos:X,title:ba}=w;return{abilities:{chartAnimation:D.chartAnimation},activeMediaInfoIndex:w.activeMediaInfoIndex||0,attributes:Q,isAggregate:G?.isAggregate,
layer:u,fieldInfoMap:P,formattedAttributes:{...B?.global,...B?.content[L]},expressionAttributes:v,mediaInfos:X,popupTemplate:S,relatedInfos:C,...this._compileTitleAndDesc({title:ba,description:T})}}_compileMedia(w,L){const D=w.clone();w=new N(this._createMediaVMParams(w,L));D.mediaInfos=w.formattedMediaInfos.slice(0);this.contentViewModels[L]=w;return D}_createTextVMParams(w){const {graphic:L,_fieldInfoMap:D,_sourceLayer:G,_expressionAttributes:P}=this;w&&w.text&&(w.text=a.substituteFieldsInLinksAndAttributes({attributes:L?.attributes??
{},fieldInfoMap:D,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:P,layer:G,text:w.text}));return{graphic:L,creator:w.text}}_compileText(w,L){w=w.clone();this.contentViewModels[L]=new p(this._createTextVMParams(w));return w}_compileLastEditInfo(){const {_effectivePopupTemplate:w,_sourceLayer:L,graphic:D,view:G}=this;if(w){var {lastEditInfoEnabled:P}=w,S=L?.editFieldsInfo;if(P&&S)return a.formatEditInfo(S,D?.attributes,G?.timeZone??l.system,L)}}_compileTitle(w){const {_fieldInfoMap:L,
_sourceLayer:D,graphic:G,_expressionAttributes:P}=this;return a.substituteFieldsInLinksAndAttributes({attributes:G?.attributes??{},fieldInfoMap:L,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:P,layer:D,text:w})}async _getTitle(){const {_effectivePopupTemplate:w,graphic:L}=this;return L?a.graphicCallback(w?.title,{graphic:L}):null}async _getContent(){const {_effectivePopupTemplate:w,graphic:L}=this;return L?a.graphicCallback(w?.content,{graphic:L}):null}async _queryFeature(w){const {_featureAbortController:L,
_sourceLayer:D,graphic:G,_effectivePopupTemplate:P}=this,S=this.map,C=this.view,u=this.spatialReference;if(L===this._featureAbortController&&G){await a.queryUpdatedFeature({graphic:G,popupTemplate:P,layer:D,spatialReference:u},w);var {content:{value:v},title:{value:B}}=await K.eachAlways({content:this._getContent(),title:this._getTitle()});({expressionAttributes:{value:w}}=await K.eachAlways({checkForRelatedFeatures:this._checkForRelatedFeatures(w),expressionAttributes:h.createCompiledExpressions({expressionInfos:P?.expressionInfos,
spatialReference:u,graphic:G,map:S,interceptor:f.interceptor,view:C})}));L===this._featureAbortController&&G&&(this._expressionAttributes=w,this._graphicExpressionAttributes={...G.attributes,...w},this._set("formattedAttributes",this._createFormattedAttributes(v)),this._set("title",this._compileTitle(B)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(v)||null))}}_createMediaFormattedAttributes({contentElement:w,contentElementIndex:L,formattedAttributes:D}){const {_effectivePopupTemplate:G,
graphic:P,relatedInfos:S,_sourceLayer:C,_fieldInfoMap:u,_graphicExpressionAttributes:v}=this;D.content[L]=a.formatAttributes({fieldInfos:G?.fieldInfos,graphic:P,attributes:{...v,...w.attributes},layer:C,fieldInfoMap:u,relatedInfos:S,timeZone:this.view?.timeZone??l.system})}_createFieldsFormattedAttributes({contentElement:w,contentElementIndex:L,formattedAttributes:D}){if(w.fieldInfos){const {graphic:G,relatedInfos:P,_sourceLayer:S,_fieldInfoMap:C,_graphicExpressionAttributes:u}=this;D.content[L]=
a.formatAttributes({fieldInfos:w.fieldInfos,graphic:G,attributes:{...u,...w.attributes},layer:S,fieldInfoMap:C,relatedInfos:P,timeZone:this.view?.timeZone??l.system})}}_createFormattedAttributes(w){const {_effectivePopupTemplate:L,graphic:D,relatedInfos:G,_sourceLayer:P,_fieldInfoMap:S,_graphicExpressionAttributes:C}=this,u={global:a.formatAttributes({fieldInfos:L?.fieldInfos,graphic:D,attributes:C,layer:P,fieldInfoMap:S,relatedInfos:G,timeZone:this.view?.timeZone??l.system}),content:[]};Array.isArray(w)&&
w.forEach((v,B)=>{"fields"===v.type&&this._createFieldsFormattedAttributes({contentElement:v,contentElementIndex:B,formattedAttributes:u});"media"===v.type&&this._createMediaFormattedAttributes({contentElement:v,contentElementIndex:B,formattedAttributes:u})});return u}_checkForRelatedFeatures(w){const {graphic:L,_effectivePopupTemplate:D}=this;return this._queryRelatedInfos(L,a.getAllFieldInfos(D),w)}async _queryRelatedInfos(w,L,D){const {relatedInfos:G,_sourceLayer:P}=this;G.clear();const S=null!=
P?.associatedLayer?await P?.associatedLayer.load(D):P;if(S&&w&&L.filter(v=>v&&a.isRelatedField(v.fieldName))?.length){L.forEach(v=>this._configureRelatedInfo(v,S));var C=await e.queryLayerInfos({relatedInfos:G,layer:S},D);Object.keys(C).forEach(v=>{const B=G.get(v.toString());v=C[v]?.value;B&&v&&(B.layerInfo=v.data)});var u=await e.queryRelatedFeatures({graphic:w,relatedInfos:G,layer:S},D);Object.keys(u).forEach(v=>{e.setRelatedFeatures(u[v]?.value,G.get(v.toString()))})}}_configureRelatedInfo(w,
L){const {relatedInfos:D}=this,G=e.getRelatedFieldInfo(w.fieldName);if(G){var {layerId:P,fieldName:S}=G;P&&(L=D.get(P.toString())||e.createRelatedInfo(P,L))&&(e.updateRelatedInfo({relatedInfo:L,fieldName:S,fieldInfo:w}),this.relatedInfos.set(P,L))}}};y.interceptor=new t.FeatureSetQueryInterceptor(a.preLayerQueryCallback,a.preRequestCallback);b.__decorate([A.property()],y.prototype,"_error",void 0);b.__decorate([A.property()],y.prototype,"_featureAbortController",void 0);b.__decorate([A.property({readOnly:!0})],
y.prototype,"_effectivePopupTemplate",null);b.__decorate([A.property({readOnly:!0})],y.prototype,"_fieldInfoMap",null);b.__decorate([A.property({readOnly:!0})],y.prototype,"_sourceLayer",null);b.__decorate([A.property()],y.prototype,"abilities",void 0);b.__decorate([c.cast("abilities")],y.prototype,"castAbilities",null);b.__decorate([A.property({readOnly:!0})],y.prototype,"content",void 0);b.__decorate([A.property({readOnly:!0})],y.prototype,"contentViewModels",void 0);b.__decorate([A.property()],
y.prototype,"description",void 0);b.__decorate([A.property({type:Boolean})],y.prototype,"defaultPopupTemplateEnabled",void 0);b.__decorate([A.property({readOnly:!0})],y.prototype,"isTable",null);b.__decorate([A.property({readOnly:!0})],y.prototype,"state",null);b.__decorate([A.property({readOnly:!0})],y.prototype,"formattedAttributes",void 0);b.__decorate([A.property({type:m,value:null})],y.prototype,"graphic",null);b.__decorate([A.property({readOnly:!0})],y.prototype,"lastEditInfo",void 0);b.__decorate([A.property({readOnly:!0})],
y.prototype,"relatedInfos",void 0);b.__decorate([A.property()],y.prototype,"spatialReference",null);b.__decorate([A.property({readOnly:!0})],y.prototype,"title",void 0);b.__decorate([A.property()],y.prototype,"map",null);b.__decorate([A.property({readOnly:!0})],y.prototype,"waitingForContent",null);b.__decorate([A.property()],y.prototype,"view",void 0);return y=f=b.__decorate([n.subclass("esri.widgets.FeatureViewModel")],y)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports"],
function(b){class m{constructor(t,y){this.preLayerQueryCallback=t;this.preRequestCallback=y;this.preLayerQueryCallback||(this.preLayerQueryCallback=z=>{});this.preRequestCallback||(this.preLayerQueryCallback=z=>{})}}b.FeatureSetQueryInterceptor=m;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/resources":function(){define(["exports"],function(b){b.css={base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",
btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentNodeText:"esri-feature__content-node--text",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",
spinner:"esri-feature__loading-spinner"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../resources ../../support/widget ../../support/jsxFactory".split(" "),function(b,m,t,y,z,H,J,K,M,F,A){b.FeatureContentMixin=
c=>{c=class extends c{constructor(){super(...arguments);this.renderNodeContent=g=>F.isWidget(g)&&!g.destroyed?A.tsx("div",{class:M.css.contentNode,key:g},g.render()):g instanceof HTMLElement?A.tsx("div",{afterCreate:this._attachToNode,bind:g,class:M.css.contentNode,key:g}):F.hasDomNode(g)?A.tsx("div",{afterCreate:this._attachToNode,bind:g.domNode,class:M.css.contentNode,key:g}):null}_attachToNode(g){g.appendChild(this)}};return c=m.__decorate([K.subclass("esri.widgets.Feature.ContentMixin")],c)};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Spinner":function(){define("../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),function(b,m,t,y,z,H,J,K,M,F,A,c){z=class extends M{constructor(g,n){super(g,n);this._animationDelay=
500;this._animationPromise=null;this.viewModel=new F}initialize(){this.addHandles(t.watch(()=>this.visible,g=>this._visibleChange(g)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(g){this.viewModel.location=g}get view(){return this.viewModel.view}set view(g){this.viewModel.view=g}get visible(){return this.viewModel.visible}set visible(g){this.viewModel.visible=g}show(g){const {location:n,promise:q}=g??{};n&&(this.viewModel.location=n);this.visible=
!0;g=()=>this.hide();q&&q.catch(()=>{}).then(g)}hide(){this.visible=!1}render(){var {visible:g}=this,{screenLocation:n}=this.viewModel;n=!!n;g={["esri-spinner--start"]:g&&n,["esri-spinner--finish"]:!g&&n};n=this._getPositionStyles();return c.tsx("div",{class:this.classes("esri-spinner",g),styles:n})}_visibleChange(g){if(g)this.viewModel.screenLocationEnabled=!0;else{var n=m.after(this._animationDelay);this._animationPromise=n;n.catch(()=>{}).then(()=>{this._animationPromise===n&&(this.viewModel.screenLocationEnabled=
!1,this._animationPromise=null)})}}_getPositionStyles(){const {screenLocation:g,view:n}=this.viewModel;if(null==n||null==g)return{};const {padding:q}=n;return{left:`${g.x-q.left}px`,top:`${g.y-q.top}px`}}};b.__decorate([y.property()],z.prototype,"location",null);b.__decorate([y.property()],z.prototype,"view",null);b.__decorate([y.property({type:F})],z.prototype,"viewModel",void 0);b.__decorate([y.property()],z.prototype,"visible",null);return z=b.__decorate([K.subclass("esri.widgets.Spinner")],z)})},
"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),function(b,m,t,y,z,H,J){t=class extends J{constructor(K){super(K);this.visible=!1}};b.__decorate([m.property()],t.prototype,"visible",void 0);return t=b.__decorate([H.subclass("esri.widgets.CompassViewModel")],
t)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/tslib.es6 ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(b,m,t,y,z,H,J,K){m=class extends m.EventedAccessor{constructor(M){super(M);this.location=null;this.screenLocationEnabled=!1;this.view=null;this.addHandles([t.when(()=>{const F=
this.screenLocationEnabled?this.view:null;return F?[F.size,"3d"===F.type?F.camera:F.viewpoint]:null},()=>this.notifyChange("screenLocation")),t.watch(()=>this.screenLocation,(F,A)=>{null!=F&&null!=A&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const {location:M,view:F,screenLocationEnabled:A}=this;return A&&null!=M&&null!=F&&F.ready?F.toScreen(M):null}};b.__decorate([y.property()],m.prototype,"location",void 0);b.__decorate([y.property()],m.prototype,"screenLocation",
null);b.__decorate([y.property()],m.prototype,"screenLocationEnabled",void 0);b.__decorate([y.property()],m.prototype,"view",void 0);return m=b.__decorate([K.subclass("esri.widgets.support.AnchorElementViewModel")],m)})},"esri/widgets/Features/css":function(){define(["exports"],function(b){b.css={icon:"esri-features__icon",actionImage:"esri-features__action-image",base:"esri-features",container:"esri-features__container",contentContainer:"esri-features__content-container",contentFeature:"esri-features__content-feature",
flowItemCollapsed:"esri-features__flow-item--collapsed",header:"esri-features__header",footer:"esri-features__footer",featureMenuObserver:"esri-features__feature-menu-observer",actionExit:"esri-features__action--exit",loader:"esri-features__loader",featuresHeading:"esri-features__heading",paginationActionBar:"esri-features__pagination-action-bar",paginationPrevious:"esri-features__pagination-previous",paginationNext:"esri-features__pagination-next"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Features/FeaturesRelatedRecords":function(){define("require ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./css ../support/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),function(b,m,t,y,z,H,J,K,M,F,A,c,g){y=class extends K{constructor(n,q){super(n,q);this.messages=null;
this.closed=!1;this.closable=!0;this._handleOpenRelatedFeature=l=>{this.emit("open-related-feature",{feature:l})}}loadDependencies(){return F.loadCalciteComponents({action:()=>new Promise((n,q)=>b(["../../chunks/calcite-action"],n,q)),"flow-item":()=>new Promise((n,q)=>b(["../../chunks/calcite-flow-item"],n,q))})}render(){var {flowItems:n}=this;n=n?.toArray();return g.tsx(g.tsxFragment,null,n?.map(q=>this._renderRelatedRecordsFlowItem(q)))}_handleCloseClick(){this.emit("close")}_handleExitClick(){this.emit("exit")}_handleRelatedRecordsBackClick(){const n=
this.flowItems?.pop();n&&("showAllEnabled"in n.viewModel&&(n.viewModel.showAllEnabled=!1),n&&(n.viewModel=null,n.destroy()))}_renderRelatedRecordsFlowItem(n){const {messages:q,closable:l,closed:d}=this,p="graphic"in n&&!n.isTable;return g.tsx("calcite-flow-item",{bind:this,closable:l,closed:d,description:this._getRelatedRecordsFlowItemDescription(n),heading:n.title??"",key:`flow-item-${n.viewModel.uid}`,onCalciteFlowItemBack:this._handleRelatedRecordsBackClick,onCalciteFlowItemClose:this._handleCloseClick},
g.tsx("calcite-action",{appearance:"transparent",bind:this,class:M.css.actionExit,icon:"move-up",key:"exit-related-records-action",label:q.exitRelatedRecords,onclick:this._handleExitClick,scale:"m",slot:"header-actions-start",text:q.exitRelatedRecords,title:q.exitRelatedRecords}),p?g.tsx("calcite-action",{appearance:"transparent",bind:this,icon:"zoom-to-object",key:"open-related-feature-action",label:q.selectFeature,onclick:()=>this._handleOpenRelatedFeature(n),scale:"m",slot:"header-actions-end",
text:q.selectFeature,title:q.selectFeature}):null,g.tsx("div",{class:M.css.container},n.render()))}_getRelatedRecordsFlowItemDescription(n){return"featureCountDescription"in n?n.featureCountDescription:n.viewModel.description??""}};m.__decorate([t.property()],y.prototype,"flowItems",void 0);m.__decorate([t.property(),c.messageBundle("esri/widgets/Features/t9n/Features")],y.prototype,"messages",void 0);m.__decorate([t.property()],y.prototype,"closed",void 0);m.__decorate([t.property()],y.prototype,
"closable",void 0);return y=m.__decorate([J.subclass("esri.widgets.Features.FeaturesRelatedRecords")],y)})},"esri/widgets/Features/FeaturesViewModel":function(){define("../../chunks/tslib.es6 ../../geometry ../../Graphic ../../symbols ../../core/arrayUtils ../../core/Error ../../core/Logger ../../core/ReactiveSet ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/support/webMercatorUtils ../../layers/Layer ../../layers/LayerConstants ../../symbols/support/symbolUtils ../../views/support/layerViewUtils ../Feature/FeatureViewModel ../Popup/actions ../Popup/actionUtils ../support/AnchorElementViewModel ../support/GoTo ../../symbols/SimpleFillSymbol ../../geometry/Point".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r,x,N,k,h,a,e){m=class extends h.GoToMixin(k){constructor(f){super(f);this._pendingPromises=new K;this._selectedClusterFeature=this._highlightActiveFeaturePromise=this._highlightSelectedFeaturePromise=this._fetchFeaturesController=null;this.actions=new x.ActionsCollection;this.activeFeature=null;this.autoCloseEnabled=!1;this.autoOpenEnabled=!0;this.browseClusterEnabled=!1;this.content=null;this.defaultPopupTemplateEnabled=!1;this.featurePage=null;this.featuresPerPage=
20;this.featureMenuOpen=!1;this.featureViewModelAbilities=null;this.featureViewModels=[];this.includeDefaultActions=this.highlightEnabled=!0;this.selectedClusterBoundaryFeature=new t({symbol:new a({outline:{width:1.5,color:"cyan"},style:"none"})});this.title=null;this.updateLocationEnabled=!1;this.view=null;this.visible=!1;this.zoomFactor=4;this.zoomToLocation=null}initialize(){this.addHandles([this.on("view-change",()=>this._autoClose()),M.watch(()=>[this.highlightEnabled,this.selectedFeature,this.visible,
this.view],()=>this._highlightSelectedFeature()),M.watch(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),M.watch(()=>this.view?.animation?.state,f=>this._animationStateChange(f)),M.watch(()=>this.location,f=>this._locationChange(f)),M.watch(()=>this.selectedFeature,f=>this._selectedFeatureChange(f)),M.watch(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),M.watch(()=>[this.featurePage,
this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),M.watch(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",f=>N.triggerAction({event:f,viewModel:this,view:this.view})),M.when(()=>!this.waitingForResult,()=>this._waitingForResultChange(),M.sync),M.watch(()=>[this.features,this.view?.map,this.view?.spatialReference],()=>this._updateFeatureVMs()),M.watch(()=>this.view?.scale,()=>
this._viewScaleChange()),M.when(()=>!this.visible,()=>this.browseClusterEnabled=!1),M.watch(()=>this.browseClusterEnabled,f=>f?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures();this._pendingPromises.clear();this.browseClusterEnabled=!1;this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const f=this._get("allActions")||new x.ActionsCollection;f.removeAll();const {actions:E,defaultActions:w,defaultPopupTemplateEnabled:L,
includeDefaultActions:D,selectedFeature:G}=this,P=D?w.concat(E):E,S=G&&("function"===typeof G.getEffectivePopupTemplate&&G.getEffectivePopupTemplate(L)||G.popupTemplate),C=S?.actions;(S?.overwriteActions?C:C?.concat(P)??P)?.filter(Boolean).forEach(u=>f.add(u));return f}get defaultActions(){const f=this._get("defaultActions")||new x.ActionsCollection;f.removeAll();f.addMany(N.isClusterFeature(this.selectedFeature)?[x.zoomToClusteredFeatures.clone(),x.browseClusteredFeatures.clone()]:[x.zoomToFeature.clone()]);
return f}get featureCount(){return this.features.length}set features(f){f=f||[];this._set("features",f);const {pendingPromisesCount:E,promiseCount:w,selectedFeatureIndex:L}=this,D=w&&f.length;D&&E&&-1===L?this.selectedFeatureIndex=0:D&&-1!==L||(this.selectedFeatureIndex=f.length?0:-1)}set location(f){let E=f;const w=this.view?.spatialReference?.isWebMercator;f?.spatialReference?.isWGS84&&w&&(E=n.geographicToWebMercator(f));this._set("location",E)}get pendingPromisesCount(){return this._pendingPromises.size}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||
[]}set promises(f){this._pendingPromises.clear();this.features=[];Array.isArray(f)&&f.length?(this._set("promises",f),f=f.slice(0),f.forEach(E=>{this._pendingPromises.add(E);E.then(w=>{this._pendingPromises.has(E)&&this._updateFeatures(w);this._updatePendingPromises(E)},()=>this._updatePendingPromises(E))})):this._set("promises",[])}get selectedFeature(){const {features:f,selectedFeatureIndex:E}=this;return-1===E?null:f[E]||null}get selectedFeatureIndex(){const f=this._get("selectedFeatureIndex");
return"number"===typeof f?f:-1}set selectedFeatureIndex(f){const {featureCount:E}=this;f=isNaN(f)||-1>f||!E?-1:(f+E)%E;this.activeFeature=null;this._set("selectedFeatureIndex",f)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.view?.ready?"ready":"disabled"}get waitingForContents(){return this.featureViewModels.some(f=>f.waitingForContent)}get waitingForResult(){return!(!(this._fetchFeaturesController||0<this.pendingPromisesCount)||
0!==this.featureCount)}centerAtLocation(){const {view:f}=this,E=N.getSelectedTarget(this);return E&&f?this.callGoTo({target:{target:E,scale:f.scale}}):Promise.reject(new H("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:E,view:f}))}zoomTo(f){return this.callGoTo(f)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(f,E){const {view:w}=this;if(!w||!f)throw new H("fetch-features:invalid-screenpoint-or-view",
"Cannot fetch features without a screenPoint and view.",{screenPoint:f,view:w});return w.fetchPopupFeatures(f,{event:E?.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:E?.signal})}open(f){f={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...f,visible:!0};var {fetchFeatures:E}=f;delete f.fetchFeatures;E&&this._setFetchFeaturesPromises(f.location);E=["actionsMenuOpen","collapsed"];for(const w of E)delete f[w];this.set(f)}triggerAction(f){(f=this.allActions.at(f))&&!f.disabled&&
this.emit("trigger-action",{action:f})}next(){this.selectedFeatureIndex++;return this}previous(){this.selectedFeatureIndex--;return this}disableClusterBrowsing(){N.removeClusteredFeaturesForBrowsing(this);this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const {view:f,selectedFeature:E}=this;"2d"!==f?.type?J.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",E):N.isClusterFeature(E)?(await N.displayClusterExtent(this),await N.browseAggregateFeatures(this)):
J.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",E)}handleViewClick(f){this.autoOpenEnabled&&this._fetchFeaturesAndOpen(f)}_animationStateChange(f){this.zoomToLocation||(x.zoomToFeature.disabled="waiting-for-target"===f)}_clearBrowsedClusterGraphics(){const f=[this.selectedClusterBoundaryFeature,this._selectedClusterFeature].filter(z.isSome);this.view?.graphics?.removeMany(f);this._selectedClusterFeature=null;this.selectedClusterBoundaryFeature.geometry=
null}_viewScaleChange(){N.isClusterFeature(this.selectedFeature)?(this.visible=this.browseClusterEnabled=!1,this.clear()):this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}_locationChange(f){const {selectedFeature:E,updateLocationEnabled:w}=this;w&&f&&(!E||E.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=1<this.featureCount?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=
1<this.featureCount?1:null}_setGraphicOnFeatureViewModels(){const {features:f,featureCount:E,featurePage:w,featuresPerPage:L,featureViewModels:D}=this;if(null!==w){var G=((w-1)*L+E)%E;D.slice(G,G+L).forEach((P,S)=>{P&&(P.graphic??(P.graphic=f[G+S]))})}}async _selectedFeatureChange(f){const {location:E,updateLocationEnabled:w,view:L}=this;f&&L&&(this.browseClusterEnabled?(this._selectedClusterFeature&&(L.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),N.isClusterFeature(f)||
(f.symbol=await d.getDisplayedSymbol(f),this._selectedClusterFeature=f,L.graphics.add(this._selectedClusterFeature))):!w&&E||!f.geometry?w&&!f.geometry&&(await this.centerAtLocation(),f=L.center?.clone())&&(this.location=f):this.location=N.getPointFromGeometry(f.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}async _setFetchFeaturesPromises(f){const {clientOnlyGraphics:E,promisesPerLayerView:w}=await this._fetchFeaturesWithController(this._getScreenPoint(f||
this.location));f=Promise.resolve(E);const L=w.map(D=>D.promise);this.promises=[f,...L]}_destroyFeatureVMs(){this.featureViewModels.forEach(f=>f&&!f.destroyed&&f.destroy());this._set("featureViewModels",[])}_updateFeatureVMs(){const {selectedFeature:f,features:E,featureViewModels:w,view:L}=this;N.isClusterFeature(f)||(this.browseClusterEnabled=!1);this._destroyFeatureVMs();if(E?.length){var D=w.slice(0),G=[];E.forEach((P,S)=>{if(P){var C=null;D.some((u,v)=>{u&&u.graphic===P&&(C=u,D.splice(v,1));return!!C});
if(C)G[S]=C;else{const u=new r({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:L?.spatialReference,graphic:P===f?P:null,map:L?.map,view:L});G[S]=u}}});D.forEach(P=>P&&!P.destroyed&&P.destroy());this._set("featureViewModels",G)}}_getScreenPoint(f){const {view:E}=this;return E&&f&&"function"===typeof E.toScreen?E.toScreen(f):null}_cancelFetchingFeatures(){const f=this._fetchFeaturesController;f&&f.abort();this._fetchFeaturesController=
null}_fetchFeaturesWithController(f,E){this._cancelFetchingFeatures();const w=new AbortController,{signal:L}=w;this._fetchFeaturesController=w;f=this.fetchFeatures(f,{signal:L,event:E});f.catch(()=>{}).then(()=>{this._fetchFeaturesController=null});return f}async _fetchFeaturesAndOpen(f){const {screenPoint:E,mapPoint:w}=f,{view:L}=this,{clientOnlyGraphics:D,promisesPerLayerView:G,location:P}=await this._fetchFeaturesWithController(E,f);f=[Promise.resolve(D),...G.map(S=>S.promise)];L?.popup&&"open"in
L.popup&&L.popup.open({location:P||w,promises:f})}_updatePendingPromises(f){f&&this._pendingPromises.has(f)&&this._pendingPromises.delete(f)}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}async _getLayerView(f,E){await f.when();return f.whenLayerView(E)}_getHighlightLayer(f){const {layer:E,sourceLayer:w}=f;return w&&"layer"in w&&w.layer?w.layer:"map-notes"===w?.type||"subtype-group"===w?.type?w:E}_getHighlightTarget(f,E){E="imagery"===E.type?void 0:"objectIdField"in E?E.objectIdField||l.fallbackObjectIDAttribute:
null;const w=f.attributes;return w&&E&&w[E]||f}_mapIncludesLayer(f){return!!this.view?.map?.allLayers?.includes(f)}async _highlightActiveFeature(){this.removeHandles("highlight-active-feature");const {highlightEnabled:f,view:E,activeFeature:w,visible:L}=this;if(w&&E&&f&&L){var D=this._getHighlightLayer(w);if(D&&D instanceof q&&this._mapIncludesLayer(D)){var G=this._getLayerView(E,D);this._highlightActiveFeaturePromise=G;var P=await G;P&&p.highlightsSupported(P)&&this._highlightActiveFeaturePromise===
G&&this.activeFeature&&this.highlightEnabled&&(D=P.highlight(this._getHighlightTarget(w,D)),this.addHandles(D,"highlight-active-feature"))}}}async _highlightSelectedFeature(){this.removeHandles("highlight-selected-feature");const {selectedFeature:f,highlightEnabled:E,view:w,visible:L}=this;if(f&&w&&E&&L){var D=this._getHighlightLayer(f);if(D&&D instanceof q&&this._mapIncludesLayer(D)){var G=this._getLayerView(w,D);this._highlightSelectedFeaturePromise=G;var P=await G;P&&p.highlightsSupported(P)&&
this._highlightSelectedFeaturePromise===G&&this.selectedFeature&&this.highlightEnabled&&this.visible&&(D=P.highlight(this._getHighlightTarget(f,D)),this.addHandles(D,"highlight-selected-feature"))}}}_updateFeatures(f){const {features:E}=this;f?.length&&(E.length?(f=f.filter(w=>!E.includes(w)),this.features=E.concat(f)):this.features=f)}};b.__decorate([F.property()],m.prototype,"_fetchFeaturesController",void 0);b.__decorate([F.property({type:x.ActionsCollection})],m.prototype,"actions",void 0);b.__decorate([F.property({readOnly:!0})],
m.prototype,"active",null);b.__decorate([F.property()],m.prototype,"activeFeature",void 0);b.__decorate([F.property({readOnly:!0})],m.prototype,"allActions",null);b.__decorate([F.property()],m.prototype,"autoCloseEnabled",void 0);b.__decorate([F.property()],m.prototype,"autoOpenEnabled",void 0);b.__decorate([F.property()],m.prototype,"browseClusterEnabled",void 0);b.__decorate([F.property()],m.prototype,"content",void 0);b.__decorate([F.property({type:x.ActionsCollection,readOnly:!0})],m.prototype,
"defaultActions",null);b.__decorate([F.property({type:Boolean})],m.prototype,"defaultPopupTemplateEnabled",void 0);b.__decorate([F.property({readOnly:!0})],m.prototype,"featureCount",null);b.__decorate([F.property()],m.prototype,"featurePage",void 0);b.__decorate([F.property({value:[]})],m.prototype,"features",null);b.__decorate([F.property()],m.prototype,"featuresPerPage",void 0);b.__decorate([F.property()],m.prototype,"featureMenuOpen",void 0);b.__decorate([F.property()],m.prototype,"featureViewModelAbilities",
void 0);b.__decorate([F.property({readOnly:!0})],m.prototype,"featureViewModels",void 0);b.__decorate([F.property()],m.prototype,"highlightEnabled",void 0);b.__decorate([F.property()],m.prototype,"includeDefaultActions",void 0);b.__decorate([F.property({type:e})],m.prototype,"location",null);b.__decorate([F.property({readOnly:!0})],m.prototype,"pendingPromisesCount",null);b.__decorate([F.property({readOnly:!0})],m.prototype,"promiseCount",null);b.__decorate([F.property()],m.prototype,"promises",null);
b.__decorate([F.property({readOnly:!0})],m.prototype,"selectedClusterBoundaryFeature",void 0);b.__decorate([F.property({value:null,readOnly:!0})],m.prototype,"selectedFeature",null);b.__decorate([F.property({value:-1})],m.prototype,"selectedFeatureIndex",null);b.__decorate([F.property({readOnly:!0})],m.prototype,"selectedFeatureViewModel",null);b.__decorate([F.property({readOnly:!0})],m.prototype,"state",null);b.__decorate([F.property()],m.prototype,"title",void 0);b.__decorate([F.property()],m.prototype,
"updateLocationEnabled",void 0);b.__decorate([F.property()],m.prototype,"view",void 0);b.__decorate([F.property()],m.prototype,"visible",void 0);b.__decorate([F.property({readOnly:!0})],m.prototype,"waitingForContents",null);b.__decorate([F.property({readOnly:!0})],m.prototype,"waitingForResult",null);b.__decorate([F.property()],m.prototype,"zoomFactor",void 0);b.__decorate([F.property()],m.prototype,"zoomToLocation",void 0);b.__decorate([F.property()],m.prototype,"centerAtLocation",null);return m=
b.__decorate([g.subclass("esri.widgets.Features.FeaturesViewModel")],m)})},"esri/core/ReactiveSet":function(){define(["./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(b,m){class t{constructor(){this._set=new Set;this._observable=new m.SimpleObservable}get size(){b.trackAccess(this._observable);return this._set.size}add(y){const z=this._set.size;this._set.add(y);this._set.size!==z&&this._observable.notify();return this}clear(){0<this._set.size&&(this._set.clear(),
this._observable.notify())}delete(y){(y=this._set.delete(y))&&this._observable.notify();return y}entries(){b.trackAccess(this._observable);return this._set.entries()}forEach(y,z){b.trackAccess(this._observable);this._set.forEach((H,J)=>y.call(z,H,J,this),z)}has(y){b.trackAccess(this._observable);return this._set.has(y)}keys(){b.trackAccess(this._observable);return this._set.keys()}values(){b.trackAccess(this._observable);return this._set.values()}[Symbol.iterator](){b.trackAccess(this._observable);
return this._set[Symbol.iterator]()}get [Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}return t})},"esri/layers/LayerConstants":function(){define(["exports"],function(b){b.fallbackObjectIDAttribute="OBJECTID";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(b,m,t,y,z,H,J,K,M,F){function A(l,d){if(d&&(l.style.filter=K.getCSSFilterFromEffectList(d),d=d.effects))for(const p of d)if("drop-shadow"===p?.type){0>p.offsetX?l.style.marginLeft=`${Math.abs(p.offsetX)}px`:l.style.marginRight=`${p.offsetX}px`;break}}async function c(l,d){switch(l.type){case "web-style":var {previewWebStyleSymbol:p}=await new Promise((r,x)=>b(["./previewWebStyleSymbol"],r,x));return p(l,c,d);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:p}=
await new Promise((r,x)=>b(["./previewSymbol3D"],r,x)),p(l,d);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:p}=await new Promise((r,x)=>b(["./previewSymbol2D"],r,x)),p(l,d);case "cim":return{previewCIMSymbol:p}=await new Promise((r,x)=>b(["./previewCIMSymbol"],r,x)),p(l,d)}}function g(l){return l&&"opacity"in l?l.opacity*g(l.parent):1}let n=null;const q=[255,255,255];m.getDisplayedColor=async function(l,d){if(l){var p=
l.layer,r=l.sourceLayer,x=g(p??r);if(null!=l.symbol&&(null==d||!0!==d.ignoreGraphicSymbol))return l="web-style"===l.symbol.type?await K.fetchWebStyleSymbol(l.symbol,d):l.symbol.clone(),K.getColorFromSymbol(l,x);if(r=(p=d?.renderer||(p&&"renderer"in p?p.renderer:void 0)||(r&&"renderer"in r?r.renderer:void 0))&&"getSymbolAsync"in p?await p.getSymbolAsync(l,d):void 0){r="web-style"===r.type?await K.fetchWebStyleSymbol(r,d):r.clone();r=K.getColorFromSymbol(r,x);if(!(p&&"visualVariables"in p)||"visualVariables"in
p&&!p.visualVariables||"visualVariables"in p&&!p.visualVariables?.length)return r;"arcadeRequiredForVisualVariables"in p&&p.arcadeRequiredForVisualVariables&&null==d?.arcade&&(d={...d},d.arcade=await y.loadArcade());var {getColor:N,getOpacity:k}=await new Promise((f,E)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],f,E)),h=[],a=[];for(var e of p.visualVariables)switch(e.type){case "color":h.push(e);break;case "opacity":a.push(e)}e=(e=0<h.length?h[h.length-1]:null)?N(e,l,d):r;l=
(p=0<a.length?a[a.length-1]:null)?k(p,l,d):null;null!=x&&(l=null!=l?l*x:x);return e?K.applyOpacityToColor(e,l):null}}};m.getDisplayedSymbol=async function(l,d){if(l){var p=l.sourceLayer,r=(null!=d&&(d.useSourceLayer??!1)?p:l.layer)??p;p=g(r);if(null!=l.symbol&&(null==d||!0!==d.ignoreGraphicSymbol))return l="web-style"===l.symbol.type?await K.fetchWebStyleSymbol(l.symbol,{...d,cache:null!=d?d.webStyleCache:null}):l.symbol.clone(),K.applyColorToSymbol(l,null,p),l;var x=(null!=d?d.renderer:null)??(r&&
"renderer"in r?r.renderer:null);if(r=x&&"getSymbolAsync"in x?await x.getSymbolAsync(l,d):null){r="web-style"===r.type?await r.fetchSymbol({...d,cache:null!=d?d.webStyleCache:null}):r.clone();if(!(x&&"visualVariables"in x&&x.visualVariables?.length))return K.applyColorToSymbol(r,null,p),r;"arcadeRequiredForVisualVariables"in x&&x.arcadeRequiredForVisualVariables&&null==d?.arcade&&(d={...d},d.arcade=await y.loadArcade());var {getColor:N,getOpacity:k,getAllSizes:h,getRotationAngle:a}=await new Promise((D,
G)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],D,G)),e=[],f=[],E=[],w=[];for(var L of x.visualVariables)switch(L.type){case "color":e.push(L);break;case "opacity":f.push(L);break;case "rotation":w.push(L);break;case "size":L.target||E.push(L)}L=(L=!!e.length&&e[e.length-1])?N(L,l,d):null;f=(f=!!f.length&&f[f.length-1])?k(f,l,d):null;null!=p&&(f=null!=f?f*p:p);K.applyColorToSymbol(r,L,f);E.length&&(p=h(E,l,d),await K.applySizesToSymbol(r,p));for(const D of w)K.applyRotationToSymbol(r,
a(D,l,d),D.axis);return r}}};m.renderColorRampPreviewHTML=function(l,d={}){var p="horizontal"===d.align;const r=d.width??(p?75:24),x=d.height??(p?24:75);var N=d.gradient??!0,k=window.devicePixelRatio,h=r*k,a=x*k;k=document.createElement("canvas");k.width=h;k.height=a;k.ariaLabel=d.ariaLabel??null;k.style.width=`${r}px`;k.style.height=`${x}px`;const e=k.getContext("2d");var f=p?h:0;const E=p?0:a;if(N){const w=e.createLinearGradient(0,0,f,E);p=l.length;const L=1===p?0:1/(p-1);l.forEach((D,G)=>w.addColorStop(G*
L,D.toString()));e.fillStyle=w;e.fillRect(0,0,h,a)}else{h=p?h/l.length:h;a=p?a:a/l.length;f=N=0;for(const w of l)e.fillStyle=w.toString(),e.fillRect(N,f,h,a),N=p?N+h:0,f=p?0:f+a}l=document.createElement("div");l.style.width=`${r}px`;l.style.height=`${x}px`;A(l,d?.effectList);l.appendChild(k);return l};m.renderDotDensityPreviewHTML=function(l,d,p){const {backgroundColor:r,outline:x,dotSize:N}=l;var k=p?.swatchSize||H.SymbolSizeDefaults.size;const h=Math.round(k*k/N**2*.8),a=window.devicePixelRatio;
l=document.createElement("canvas");const e=k*a;l.width=e;l.height=e;l.style.width=`${l.width/a}px`;l.style.height=`${l.height/a}px`;const f=l.getContext("2d");r&&(f.fillStyle=r.toCss(!0),f.fillRect(0,0,e,e),f.fill());f.fillStyle=d?.toCss(!0)??"";if(n&&n.length/2===h)for(d=0;d<2*h;d+=2)f.fillRect(n[d],n[d+1],N*a,N*a),f.fill();else for(n=[],d=0;d<2*h;d+=2){const E=Math.floor(Math.random()*(e-0+1)),w=Math.floor(Math.random()*(e-0+1));n.push(E,w);f.fillRect(E,w,N*a,N*a);f.fill()}x&&(x.color&&(f.strokeStyle=
x.color.toCss(!0)),f.lineWidth=x.width,f.strokeRect(0,0,e,e));k=new Image(k,k);k.src=l.toDataURL();k.ariaLabel=p?.ariaLabel??null;k.alt=p?.ariaLabel??"";return k};m.renderPieChartPreviewHTML=function(l,d={}){const p=d.radius||40;var r=2*Math.PI*p,x=l.length;const N=r/x,k=[],h=z.getStroke(d.outline);null!=h?.width&&(h.width*=2);(h||d.backgroundColor)&&k.push({shape:{type:"circle",cx:p,cy:p,r:p},fill:d.backgroundColor,stroke:h,offset:[0,0]});const a=d.values,e=a&&a.length===x&&100===a.reduce((E,w)=>
E+w,0),f=[0];for(let E=0;E<x;E++){let w=null;e&&(w=a[E]*r/100,f.push(w+f[E]));k.push({shape:{type:"circle",cx:p,cy:p,r:p/2},fill:[0,0,0,0],stroke:{width:p,dashArray:`${(w??N)/2} ${r}`,dashoffset:`-${e?f[E]/2:N/2*E}`,color:l[E]},offset:[0,0]})}x=null;l=2*p+(h?.width||0);if(r=d.holePercentage)h&&k.push({shape:{type:"circle",cx:p,cy:p,r:p*r},fill:null,stroke:h,offset:[0,0]}),x=l/2,x=[[{shape:{type:"circle",cx:x,cy:x,r:x},fill:q,stroke:h?{...h,color:q}:null,offset:[0,0]},{shape:{type:"circle",cx:x,cy:x,
r:p*r},fill:[0,0,0],stroke:null,offset:[0,0]}]];return J.renderSymbol([k],[l,l],{effectView:d.effectList,ignoreStrokeWidth:!0,masking:x,rotation:-90,ariaLabel:d.ariaLabel})};m.renderPreviewHTML=c;m.renderRelationshipRampPreviewHTML=function(l,d={}){const p=l?.authoringInfo;if("relationship"!==p?.type||!p?.numClasses||!l.uniqueValueInfos)return null;const {focus:r,numClasses:x}=p,N=F.getRelationshipRampElement({focus:r,numClasses:x,infos:l.uniqueValueInfos});l=d?.node||document.createElement("div");
J.renderOnce(l,()=>M.renderRelationshipRamp(N,d.id||"relationship",{opacity:d.opacity||1,effectList:d.effectList,ariaLabel:d.ariaLabel}));return l};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(b,m){function t(y,z){return Math.round(Math.min(Math.max(y+191.25*z,0),255))}b.SymbolSizeDefaults=void 0;(function(y){y[y.size=22]="size";y[y.lineWidth=50]="lineWidth";y[y.maxSize=120]="maxSize";y[y.maxOutlineSize=
80]="maxOutlineSize";y[y.tallSymbolWidth=20]="tallSymbolWidth"})(b.SymbolSizeDefaults||(b.SymbolSizeDefaults={}));b.adjustColorBrightness=function(y,z){if(null==y)return new m;if("type"in y&&("linear"===y.type||"pattern"===y.type))return y;y=new m(y);return new m([t(y.r,z),t(y.g,z),t(y.b,z),y.a])};b.adjustColorComponentBrightness=t;b.getConeShapes=function(y,z){let H=z?b.SymbolSizeDefaults.tallSymbolWidth:y;z=z?4:6;H=H<=b.SymbolSizeDefaults.size?H-.5*z:H-z;z=.15*H;const J=H;y-=z;return[{type:"ellipse",
cx:.5*H,cy:y,rx:.5*H,ry:z},{type:"path",path:[{command:"M",values:[.5*J,0]},{command:"L",values:[J,y]},{command:"L",values:[0,y]},{command:"Z",values:[]}]}]};b.getCubeShapes=function(y,z){let H=z?b.SymbolSizeDefaults.tallSymbolWidth:y;var J=z?4:6;J=H=H<=b.SymbolSizeDefaults.size?H-.5*J:H-J;z=z?.35*H:.5*H;return[{type:"path",path:[{command:"M",values:[.5*J,0]},{command:"L",values:[J,.5*z]},{command:"L",values:[.5*J,z]},{command:"L",values:[0,.5*z]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[0,.5*z]},{command:"L",values:[.5*J,z]},{command:"L",values:[.5*J,y]},{command:"L",values:[0,y-.5*z]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*J,z]},{command:"L",values:[.5*J,y]},{command:"L",values:[J,y-.5*z]},{command:"L",values:[J,.5*z]},{command:"Z",values:[]}]}]};b.getCylinderShapes=function(y,z){var H=z?b.SymbolSizeDefaults.tallSymbolWidth:y;z=z?4:6;H=H<=b.SymbolSizeDefaults.size?H-.5*z:H-z;z=.5*H;const J=.15*H;y-=J;return[{type:"ellipse",cx:.5*H,cy:y,rx:z,
ry:J},{type:"path",path:[{command:"M",values:[0,J]},{command:"L",values:[0,y]},{command:"L",values:[H,y]},{command:"L",values:[H,J]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*H,cy:J,rx:z,ry:J}]};b.getDiamondShapes=function(y){var z=y;z=z<b.SymbolSizeDefaults.size?z-2:z-4;const H=Math.floor(y/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*z,0]},{command:"L",values:[z,.5*y-H]},{command:"L",values:[.45*z-H,.5*y+H]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*
z,0]},{command:"L",values:[.45*z-H,.5*y+H]},{command:"L",values:[0,.5*y-H]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*y-H]},{command:"L",values:[.45*z-H,.5*y+H]},{command:"L",values:[.45*z,y]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*z,y]},{command:"L",values:[z,.5*y-H]},{command:"L",values:[.45*z-H,.5*y+H]},{command:"Z",values:[]}]}]};b.getExtrudeSymbolShapes=function(y){const z=b.SymbolSizeDefaults.size;y*=.5;return[{type:"path",path:[{command:"M",
values:[0,.35*z]},{command:"L",values:[.3*z,.7*z]},{command:"L",values:[.3*z,.7*z+y]},{command:"L",values:[0,.7*z+y-.35*z]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*z,.7*z]},{command:"L",values:[.3*z,.7*z+y]},{command:"L",values:[z,y]},{command:"L",values:[z,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*z,0]},{command:"L",values:[z,0]},{command:"L",values:[.3*z,.7*z]},{command:"L",values:[0,.35*z]},{command:"Z",values:[]}]}]};b.getInvertedConeShapes=
function(y){let z=y;z=z<b.SymbolSizeDefaults.size?z-3:z-6;const H=.15*z,J=z;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[J,0]},{command:"L",values:[.5*J,y-H]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*z,cy:0,rx:.5*z,ry:H}]};b.getPathSymbolShapes=function(y,z,H){var J=b.SymbolSizeDefaults.size;let K=J,M=J;1>y?K*=.75:1<y&&(M*=1.25);y=J;z&&H&&(K=M=y=J=0);return[{type:"path",path:[{command:"M",values:[y,0]},{command:"L",values:[H?y:.875*y,0]},{command:"L",values:[H?
K-.5*y:0,M-.5*J]},{command:"L",values:[K-.5*y,M-.5*J]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[y,0]},{command:"L",values:[y,z?0:.125*J]},{command:"L",values:[K-.5*y,z?M-.5*J:J]},{command:"L",values:[K-.5*y,M-.5*J]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[K-.5*y,M-.5*J]},{command:"L",values:[H?K-.5*y:0,M-.5*J]},{command:"L",values:[H?K-.5*y:0,z?M-.5*J:J]},{command:"L",values:[K-.5*y,z?M-.5*J:J]},{command:"Z",values:[]}]}]};b.getTetrahedronShapes=
function(y){var z=y;z=z<b.SymbolSizeDefaults.size?z-1:z-2;return[{type:"path",path:[{command:"M",values:[.45*y,0]},{command:"L",values:[y,z]},{command:"L",values:[.45*y,.6*z]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*y,0]},{command:"L",values:[.45*y,.6*z]},{command:"L",values:[0,z]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,z]},{command:"L",values:[.45*y,.6*z]},{command:"L",values:[y,z]},{command:"Z",values:[]}]}]};b.getWaterSymbolShapes=function(){return[{type:"path",
path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
b.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(b,m,t,y,z,H,J,K,M,F){function A(n,q){g.append(n,q);g.detach(q)}function c(n,q,l){return n?t(n,{responseType:"image"}).then(d=>{d=d.data;const p=d.width,r=
d.height,x=p/r;let N=q;l&&(N=Math.min(N,Math.max(p,r)));return{image:d,width:1>=x?Math.ceil(N*x):N,height:1>=x?N:Math.ceil(N/x)}}):Promise.reject(new z("renderUtils: imageDataSize","href not provided."))}const g=K.createProjector();b.renderOnce=A;b.renderSymbol=function(n,q,l){const d=Math.ceil(q[0]),p=Math.ceil(q[1]);if(!n.some(r=>!!r.length))return null;q=l?.node||document.createElement("div");null!=l.opacity&&(q.style.opacity=l.opacity.toString());null!=l.effectView&&(q.style.filter=F.getCSSFilterFromEffectList(l.effectView));
A(q,()=>M.renderSVG(n,d,p,l));return q};b.tintImageWithColor=function(n,q,l,d,p){return c(n,q,p).then(r=>{const x=r.width??q,N=r.height??q;var k;if(k=r.image)k=l&&"ignore"!==d?"multiply"===d&&255===l.r&&255===l.g&&255===l.b&&1===l.a?!1:!0:!1;if(k){var h=r.image.width,a=r.image.height;H("edge")&&/\.svg$/i.test(n)&&(--h,--a);k=Math.ceil(x);var e=Math.ceil(N);var f=document.createElement("canvas");f.width=k;f.height=e;f.style.width=k+"px";f.style.height=e+"px";f=f.getContext("2d");f.clearRect(0,0,k,
e);k=f;k.drawImage(r.image,0,0,h,a,0,0,x,N);e=k.getImageData(0,0,x,N);f=[l.r/255,l.g/255,l.b/255,l.a];const w=y.toHSV(l);for(let L=0;L<e.data.length;L+=4){r=e.data;h=L;a=f;var E=w;switch(d){case "multiply":r[h]*=a[0];r[h+1]*=a[1];r[h+2]*=a[2];r[h+3]*=a[3];break;default:const D=y.toHSV({r:r[h],g:r[h+1],b:r[h+2]});D.h=E.h;D.s=E.s;D.v=D.v/100*E.v;E=y.toRGB(D);r[h]=E.r;r[h+1]=E.g;r[h+2]=E.b;r[h+3]*=a[3]}}k.putImageData(e,0,0);n=k.canvas.toDataURL("image/png")}else k=m.id?.findCredential(n),k?.token&&
(r=n.includes("?")?"\x26":"?",n=`${n}${r}token=${k.token}`);return{url:n,width:x,height:N}}).catch(()=>({url:n,width:q,height:q}))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports","../Color","../chunks/vec4","../chunks/vec4f64"],function(b,m,t,y){function z(d,p){const r=[];let x,N;if(d[0].length!==p.length)throw Error("dimensions do not match");const k=d.length,h=d[0].length;let a=0;for(x=0;x<k;x++){for(N=a=0;N<h;N++)a+=d[x][N]*p[N];
r.push(a)}return r}function H(d){d=[d.r/255,d.g/255,d.b/255].map(p=>.04045>=p?p/12.92:((p+.055)/1.055)**2.4);d=z(q,d);return{x:100*d[0],y:100*d[1],z:100*d[2]}}function J(d){d=z(l,[d.x/100,d.y/100,d.z/100]).map(p=>Math.min(1,Math.max(.0031308>=p?12.92*p:1.055*p**(1/2.4)-.055,0)));return{r:Math.round(255*d[0]),g:Math.round(255*d[1]),b:Math.round(255*d[2])}}function K(d){d=[d.x/95.047,d.y/100,d.z/108.883].map(p=>p>(6/29)**3?p**(1/3):1/3*(29/6)**2*p+4/29);return{l:116*d[1]-16,a:500*(d[0]-d[1]),b:200*
(d[1]-d[2])}}function M(d){const p=d.l;d=[(p+16)/116+d.a/500,(p+16)/116,(p+16)/116-d.b/200].map(r=>r>6/29?r**3:3*(6/29)**2*(r-4/29));return{x:95.047*d[0],y:100*d[1],z:108.883*d[2]}}function F(d){if("r"in d&&"g"in d&&"b"in d)return d;if("l"in d&&"c"in d&&"h"in d){var p=d.c,r=d.h;return J(M({l:d.l,a:p*Math.cos(r),b:p*Math.sin(r)}))}if("l"in d&&"a"in d&&"b"in d)return J(M(d));if("x"in d&&"y"in d&&"z"in d)return J(d);if("h"in d&&"s"in d&&"v"in d){r=(d.h+360)%360/60;p=d.v/100*255;d=d.s/100*p;const x=d*
(1-Math.abs(r%2-1));switch(Math.floor(r)){case 0:r={r:d,g:x,b:0};break;case 1:r={r:x,g:d,b:0};break;case 2:r={r:0,g:d,b:x};break;case 3:r={r:0,g:x,b:d};break;case 4:r={r:x,g:0,b:d};break;case 5:case 6:r={r:d,g:0,b:x};break;default:r={r:0,g:0,b:0}}r.r=Math.round(r.r+p-d);r.g=Math.round(r.g+p-d);r.b=Math.round(r.b+p-d);return r}return d}function A(d){if("h"in d&&"s"in d&&"v"in d)return d;var p=F(d);d=p.r;const r=p.g,x=p.b;p=Math.max(d,r,x);const N=p-Math.min(d,r,x);d=0===N?0:p===d?(r-x)/N%6:p===r?(x-
d)/N+2:(d-r)/N+4;0>d&&(d+=6);return{h:60*d,s:100*(0===N?0:N/p),v:100/255*p}}function c(d){return"l"in d&&"a"in d&&"b"in d?d:K(H(F(d)))}function g(d){let {r:p,g:r,b:x,a:N}=d;1>N&&(p=Math.round(N*p+255*(1-N)),r=Math.round(N*r+255*(1-N)),x=Math.round(N*x+255*(1-N)));return new m({r:p,g:r,b:x})}function n(d,p){const {r,g:x,b:N}=p?.ignoreAlpha?d:g(d);return.2126*r+.7152*x+.0722*N}const q=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],l=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,
-.204,1.057]];b.BrightnessThreshold=void 0;(function(d){d[d.Low=160]="Low";d[d.High=225]="High"})(b.BrightnessThreshold||(b.BrightnessThreshold={}));b.colorEquals=function(d,p){return d===p||null!=d&&d.equals(p)};b.colorVectorEquals=function(d,p){return d===p||null!=d&&null!=p&&t.equals(d,p)};b.colorVectorToColorAndOpacity=function(d){return y.fromValues(d[0],d[1],d[2],3<d.length?d[3]:1)};b.darken=function(d,p){var r=c(d);r.l*=1-p;p=F(r);r=d.clone();r.setColor(p);r.a=d.a;return r};b.desaturate=function(d,
p){var r=A(d);r.s*=p;p=F(r);r=d.clone();r.setColor(p);r.a=d.a;return r};b.getColorLuminance=n;b.getColorTheme=function(d){return g(d).isBright?"light":"dark"};b.getContrast=function(d,p=b.BrightnessThreshold.High){return n(d,{ignoreAlpha:!0})>p?new m([0,0,0,d.a]):new m([255,255,255,d.a])};b.multiplyOpacity=function(d,p){d=d.clone();d.a*=p;return d};b.multiplyOpacityToUnitRGBA=function(d,p){d=m.toUnitRGBA(d);d[3]*=p;return d};b.toHSV=A;b.toLAB=c;b.toLCH=function(d){if(!("l"in d&&"c"in d&&"h"in d)){var p=
K(H(F(d)));d=p.l;var r=p.a;const x=p.b;p=Math.sqrt(r*r+x*x);r=Math.atan2(x,r);r=0<r?r:r+2*Math.PI;d={l:d,c:p,h:r}}return d};b.toRGB=F;b.unitRGBAFromColor=function(d){return m.toUnitRGBA(d)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(b,m,t,y,z,H,J,K){function M(u,
v){u*=S/180;return Math.abs(v*Math.sin(u))+Math.abs(v*Math.cos(u))}function F(u){return u.map(v=>`${v.command} ${v.values.join(" ")}`).join(" ").trim()}function A(u,v,B,Q){if(u){if("circle"===u.type)return K.tsx("circle",{cx:u.cx,cy:u.cy,fill:v,"fill-rule":"evenodd",r:u.r,stroke:B.color,"stroke-dasharray":B.dashArray,"stroke-dashoffset":B.dashOffset,"stroke-linecap":B.cap,"stroke-linejoin":B.join,"stroke-miterlimit":"4","stroke-width":B.width});if("ellipse"===u.type)return K.tsx("ellipse",{cx:u.cx,
cy:u.cy,fill:v,"fill-rule":"evenodd",rx:u.rx,ry:u.ry,stroke:B.color,"stroke-dasharray":B.dashArray,"stroke-linecap":B.cap,"stroke-linejoin":B.join,"stroke-miterlimit":"4","stroke-width":B.width});if("rect"===u.type)return K.tsx("rect",{fill:v,"fill-rule":"evenodd",height:u.height,stroke:B.color,"stroke-dasharray":B.dashArray,"stroke-linecap":B.cap,"stroke-linejoin":B.join,"stroke-miterlimit":"4","stroke-width":B.width,width:u.width,x:u.x,y:u.y});if("image"===u.type)return K.tsx("image",{height:u.height,
href:u.src,preserveAspectRatio:"none",width:u.width,x:u.x,y:u.y});if("path"===u.type)return u="string"!==typeof u.path?F(u.path):u.path,K.tsx("path",{d:u,fill:v,"fill-rule":"evenodd",stroke:B.color,"stroke-dasharray":B.dashArray,"stroke-linecap":B.cap,"stroke-linejoin":B.join,"stroke-miterlimit":"4","stroke-width":B.width});if("text"===u.type)return y.assertIsSome(Q),K.tsx("text",{"dominant-baseline":Q.dominantBaseline,fill:v,"fill-rule":"evenodd","font-family":Q.font.family,"font-size":Q.font.size,
"font-style":Q.font.style,"font-variant":Q.font.variant,"font-weight":Q.font.weight,kerning:Q.kerning,rotate:Q.rotate,stroke:B.color,"stroke-dasharray":B.dashArray,"stroke-linecap":B.cap,"stroke-linejoin":B.join,"stroke-miterlimit":"4","stroke-width":B.width,"text-anchor":Q.align,"text-decoration":Q.decoration,"text-rendering":E,x:u.x,y:u.y},u.text)}return null}function c(u){const v={fill:"none",pattern:null,linearGradient:null};if(u)if("type"in u&&"pattern"===u.type){var B=`patternId-${++e}`;v.fill=
`url(#${B})`;v.pattern={id:B,x:u.x,y:u.y,width:u.width,height:u.height,image:{x:0,y:0,width:u.width,height:u.height,href:u.src}}}else"type"in u&&"linear"===u.type?(B=`linearGradientId-${++f}`,v.fill=`url(#${B})`,v.linearGradient={id:B,x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,stops:u.colors.map(Q=>({offset:Q.offset,color:Q.color&&(new m(Q.color)).toString()}))}):u&&(u=new m(u),v.fill=u.toString());return v}function g(u){const v={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(u&&
(null!=u.width&&(v.width=u.width),u.cap&&(v.cap=u.cap),u.join&&(v.join=u.join.toString()),u.color&&(v.color=(new m(u.color)).toString()),u.dashArray&&(v.dashArray=u.dashArray),u.dashArray&&(v.dashOffset=u.dashoffset),u.style)){let B=null;u.style in P&&(B=P[u.style]);if(Array.isArray(B)){B=B.slice(0);const Q=u.width??0;for(let T=0;T<B.length;++T)B[T]*=Q;if("butt"!==u.cap){for(u=0;u<B.length;u+=2)B[u]-=Q,1>B[u]&&(B[u]=1);for(u=1;u<B.length;u+=2)B[u]+=Q}B=B.join(",")}v.dashArray=B}return v}function n(u,
v){const B={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(u){const Q=u.alignBaseline;B.align=u.align;B.dominantBaseline="baseline"===Q?"auto":"top"===Q?"text-top":"bottom"===Q?"hanging":Q;B.decoration=u.decoration;B.kerning=u.kerning?"auto":"0";B.rotate=u.rotated?"90":"0";y.assertIsSome(v);B.font.style=v.style||"normal";B.font.variant=v.variant||"normal";B.font.weight=v.weight||"normal";B.font.size=v.size&&v.size.toString()||
"10pt";B.font.family=v.family||"serif"}return B}function q(u){const {pattern:v,linearGradient:B}=u;return v?K.tsx("pattern",{height:v.height,id:v.id,patternUnits:"userSpaceOnUse",width:v.width,x:v.x,y:v.y},K.tsx("image",{height:v.image.height,href:v.image.href,width:v.image.width,x:v.image.x,y:v.image.y})):B?(u=B.stops.map((Q,T)=>K.tsx("stop",{key:`${T}-stop`,offset:Q.offset,"stop-color":Q.color})),K.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:B.id,x1:B.x1,x2:B.x2,y1:B.y1,y2:B.y2},u)):
null}function l(u,v){if(!u||0===u.length)return null;const B=[];for(const Q of u){const {shape:T,fill:X,stroke:ba,font:da}=Q;u=c(X);const aa=g(ba),ea="text"===T.type?n(T,da):null;(u=A(T,u.fill,aa,ea))&&B.push(u)}return K.tsx("mask",{id:v,maskUnits:"userSpaceOnUse"},K.tsx("g",null,B))}function d(u,v,B,Q,T){H.scale(u,H.identity(u),[v,B]);u[4]=u[4]*v-Q*v+Q;u[5]=u[5]*B-T*B+T;return u}function p(u,v){if(D&&"left"in D){null!=D.left&&D.left>u&&(D.left=u);if(null==D.right||D.right<u)D.right=u;if(null==D.top||
D.top>v)D.top=v;if(null==D.bottom||D.bottom<v)D.bottom=v}else D={left:u,bottom:v,right:u,top:v}}function r(u){const v=u.args,B=v.length;switch(u.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(u=0;u<B;u+=2)p(v[u],v[u+1]);G.x=v[B-2];G.y=v[B-1];break;case "H":for(u=0;u<B;++u)p(v[u],G.y);G.x=v[B-1];break;case "V":for(u=0;u<B;++u)p(G.x,v[u]);G.y=v[B-1];break;case "m":u=0;"x"in G||(p(G.x=v[0],G.y=v[1]),u=2);for(;u<B;u+=2)p(G.x+=v[u],G.y+=v[u+1]);break;case "l":case "t":for(u=0;u<B;u+=
2)p(G.x+=v[u],G.y+=v[u+1]);break;case "h":for(u=0;u<B;++u)p(G.x+=v[u],G.y);break;case "v":for(u=0;u<B;++u)p(G.x,G.y+=v[u]);break;case "c":for(u=0;u<B;u+=6)p(G.x+v[u],G.y+v[u+1]),p(G.x+v[u+2],G.y+v[u+3]),p(G.x+=v[u+4],G.y+=v[u+5]);break;case "s":case "q":for(u=0;u<B;u+=4)p(G.x+v[u],G.y+v[u+1]),p(G.x+=v[u+2],G.y+=v[u+3]);break;case "A":for(u=0;u<B;u+=7)p(v[u+5],v[u+6]);G.x=v[B-2];G.y=v[B-1];break;case "a":for(u=0;u<B;u+=7)p(G.x+=v[u+5],G.y+=v[u+6])}}function x(u,v,B){const Q=w[u.toLowerCase()];"number"===
typeof Q&&(Q?v.length>=Q&&(u={action:u,args:v.slice(0,v.length-v.length%Q)},B.push(u),r(u)):(u={action:u,args:[]},B.push(u),r(u)))}function N(u){const v={x:0,y:0,width:0,height:0};if("circle"===u.type)v.x=u.cx-u.r,v.y=u.cy-u.r,v.width=2*u.r,v.height=2*u.r;else if("ellipse"===u.type)v.x=u.cx-u.rx,v.y=u.cy-u.ry,v.width=2*u.rx,v.height=2*u.ry;else if("image"===u.type||"rect"===u.type)v.x=u.x,v.y=u.y,v.width=u.width,v.height=u.height;else if("path"===u.type){{const T=("string"!==typeof u.path?F(u.path):
u.path).match(L),X=[];D={};G={};if(T){u="";var B=[],Q=T.length;for(let ba=0;ba<Q;++ba){const da=T[ba],aa=parseFloat(da);isNaN(aa)?(u&&x(u,B,X),B=[],u=da):B.push(aa)}x(u,B,X);u={x:0,y:0,width:0,height:0};D&&"left"in D&&(u.x=D.left,u.y=D.top,u.width=D.right-D.left,u.height=D.bottom-D.top)}else u=null}v.x=u.x;v.y=u.y;v.width=u.width;v.height=u.height}return v}function k(u){const v={x:0,y:0,width:0,height:0};let B=null,Q=Number.NEGATIVE_INFINITY,T=Number.NEGATIVE_INFINITY;for(const X of u)B?(B.x=Math.min(B.x,
X.x),B.y=Math.min(B.y,X.y),Q=Math.max(Q,X.x+X.width),T=Math.max(T,X.y+X.height)):(B=v,B.x=X.x,B.y=X.y,Q=X.x+X.width,T=X.y+X.height);B&&(B.width=Q-B.x,B.height=T-B.y);return B}function h(u,v,B,Q,T,X,ba,da,aa){var ea=(ba&&X?M(X,v):v)/2,Y=(ba&&X?M(X,B):B)/2;if(aa){var U=aa[0];aa=aa[1];ea=(ba&&X?M(X,U):U)/2;Y=(ba&&X?M(X,aa):aa)/2}U=u.width+Q;var V=u.height+Q;aa=z.create();ba=z.create();var I=!1;if(T&&0!==U&&0!==V){T=v!==B?v/B:U/V;I=v>B?v:B;let O=1,R=1;isNaN(I)||(1<T?(O=I/U,R=I/T/V):(R=I/V,O=I*T/U));H.multiply(ba,
ba,d(aa,O,R,ea,Y));I=!0}T=u.x+(U-Q)/2;u=u.y+(V-Q)/2;Q=H.multiply;ea-=T;Y-=u;ea=H.translate(aa,H.identity(aa),[ea,Y]);Q.call(H,ba,ba,ea);!I&&(U>v||V>B)&&(ea=U/v>V/B,v=(ea?v:B)/(ea?U:V),H.multiply(ba,ba,d(aa,v,v,T,u)));X&&(v=H.multiply,B=X%360*Math.PI/180,H.rotate(aa,H.identity(aa),B),X=Math.cos(B),B=Math.sin(B),U=aa[4],V=aa[5],aa[4]=U*X-V*B+u*B-T*X+T,aa[5]=V*X+U*B-T*B-u*X+u,v.call(H,ba,ba,aa));da&&(X=H.multiply,v=da[0],da=da[1],da=H.translate(aa,H.identity(aa),[v,da]),X.call(H,ba,ba,da));return`matrix(${ba[0]},${ba[1]},${ba[2]},${ba[3]},${ba[4]},${ba[5]})`}
function a(u,v,B){u=u?.effects.find(da=>"bloom"===da.type);if(!u)return null;const {strength:Q,radius:T}=u;u=0<Q?T:0;const X=(Q+u)*v,ba=4*Q+1;return K.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${B}`,width:"300%",x:"-100%",y:"-100%"},K.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(Q+.5*u)*5**(v/100)*(.4+v/100),result:"dilate"}),K.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:X/25}),K.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:X/
50}),K.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},K.tsx("feFuncR",{slope:ba,type:"linear"}),K.tsx("feFuncG",{slope:ba,type:"linear"}),K.tsx("feFuncB",{slope:ba,type:"linear"})),K.tsx("feMerge",null,K.tsx("feMergeNode",{in:"intensityBlur"}),K.tsx("feMergeNode",{in:"intensityBrightness"}),K.tsx("feGaussianBlur",{stdDeviation:Q/10})))}let e=0,f=0;J=t("android");const E=t("chrome")||J&&4<=J?"auto":"optimizeLegibility",w={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},L=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;
let D={},G={};const P={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},S=Math.PI;let C=1;b.computeBBox=k;b.generateFillAttributes=c;b.generateStrokeAttributes=g;b.generateTextAttributes=n;b.getBoundingBox=N;b.getTransformMatrix=h;b.renderDef=q;b.renderSVG=function(u,v,B,Q={}){const T=[],X=[],ba=++C,da=a(Q.effectView,v,ba);var aa=null;da&&(aa=Q.effectView?.effects.find(I=>
"bloom"===I.type),aa=(aa.strength?aa.strength+aa.radius/2:0)/3,aa=[Math.max(v+v*aa,10),Math.max(B+B*aa,10)]);for(let I=0;I<u.length;I++){var ea=u[I];const O=[];var Y=[],U=0,V=0;let R=0;for(const W of ea){const {shape:Z,fill:ca,stroke:fa,font:ha,offset:ia}=W;Q.ignoreStrokeWidth||"text"===Z.type||(U+=fa?.width||0);ea=c(ca);const ja=g(fa),ka="text"===Z.type?n(Z,ha):null;T.push(q(ea));O.push(A(Z,ea.fill,ja,ka));Y.push(N(Z));ia&&(V+=ia[0],R+=ia[1])}Y=k(Y);U=h(Y,v,B,U,Q.scale??!1,Q.rotation,Q.useRotationSize??
!1,[V,R],aa);V=null;Q.masking&&(V=`mask-${I}`,T.push(l(Q.masking[I],V)),V=`url(#${V})`);X.push(V?K.tsx("g",{mask:V},K.tsx("g",{transform:U},O)):K.tsx("g",{transform:U},O))}Q.useRotationSize&&Q.rotation&&(v=M(Q.rotation,v),B=M(Q.rotation,B));da&&(y.assertIsSome(aa),v=aa[0],B=aa[1]);return K.tsx("svg",{"aria-labelledby":Q.ariaLabel,focusable:!1,height:B,role:"img",style:"display: block;",width:v,xmlns:"http://www.w3.org/2000/svg"},da,K.tsx("defs",null,T),da?K.tsx("g",{filter:`url(#bloom${ba})`},X):
X)};b.renderShape=A;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat2df32":function(){define(["exports"],function(b){function m(){const M=new Float32Array(6);M[0]=1;M[3]=1;return M}function t(M){const F=new Float32Array(6);F[0]=M[0];F[1]=M[1];F[2]=M[2];F[3]=M[3];F[4]=M[4];F[5]=M[5];return F}function y(M,F,A,c,g,n){const q=new Float32Array(6);q[0]=M;q[1]=F;q[2]=A;q[3]=c;q[4]=g;q[5]=n;return q}function z(M,F){return new Float32Array(M,F,6)}function H(M,F,A,c){const g=
F[c];F=F[c+1];M[c]=A[0]*g+A[2]*F+A[4];M[c+1]=A[1]*g+A[3]*F+A[5]}function J(M,F,A,c=0,g=0,n=2){for(g=g||F.length/n;c<g;c++)H(M,F,A,c*n)}const K=Object.freeze(Object.defineProperty({__proto__:null,clone:t,create:m,createView:z,fromValues:y,transform:H,transformMany:J},Symbol.toStringTag,{value:"Module"}));b.clone=t;b.create=m;b.createView=z;b.fromValues=y;b.mat2df32=K;b.transform=H;b.transformMany=J})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(b,m){function t(a,e){a[0]=e[0];
a[1]=e[1];a[2]=e[2];a[3]=e[3];a[4]=e[4];a[5]=e[5];return a}function y(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a}function z(a,e,f,E,w,L,D){a[0]=e;a[1]=f;a[2]=E;a[3]=w;a[4]=L;a[5]=D;return a}function H(a,e){const f=e[0],E=e[1],w=e[2],L=e[3],D=e[4];e=e[5];let G=f*L-E*w;if(!G)return null;G=1/G;a[0]=L*G;a[1]=-E*G;a[2]=-w*G;a[3]=f*G;a[4]=(w*e-L*D)*G;a[5]=(E*D-f*e)*G;return a}function J(a){return a[0]*a[3]-a[1]*a[2]}function K(a,e,f){const E=e[0],w=e[1],L=e[2],D=e[3],G=e[4];e=e[5];const P=f[0],
S=f[1],C=f[2],u=f[3],v=f[4];f=f[5];a[0]=E*P+L*S;a[1]=w*P+D*S;a[2]=E*C+L*u;a[3]=w*C+D*u;a[4]=E*v+L*f+G;a[5]=w*v+D*f+e;return a}function M(a,e,f){const E=e[0],w=e[1],L=e[2],D=e[3],G=e[4];e=e[5];const P=Math.sin(f);f=Math.cos(f);a[0]=E*f+L*P;a[1]=w*f+D*P;a[2]=E*-P+L*f;a[3]=w*-P+D*f;a[4]=G;a[5]=e;return a}function F(a,e,f){const E=e[1],w=e[2],L=e[3],D=e[4],G=e[5],P=f[0];f=f[1];a[0]=e[0]*P;a[1]=E*P;a[2]=w*f;a[3]=L*f;a[4]=D;a[5]=G;return a}function A(a,e,f){const E=e[0],w=e[1],L=e[2],D=e[3],G=e[4];e=e[5];
const P=f[0];f=f[1];a[0]=E;a[1]=w;a[2]=L;a[3]=D;a[4]=E*P+L*f+G;a[5]=w*P+D*f+e;return a}function c(a,e){const f=Math.sin(e);e=Math.cos(e);a[0]=e;a[1]=f;a[2]=-f;a[3]=e;a[4]=0;a[5]=0;return a}function g(a,e){a[0]=e[0];a[1]=0;a[2]=0;a[3]=e[1];a[4]=0;a[5]=0;return a}function n(a,e){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=e[0];a[5]=e[1];return a}function q(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"}function l(a){return Math.sqrt(a[0]**2+a[1]**2+a[2]**2+a[3]**2+a[4]**2+a[5]**2+
1)}function d(a,e,f){a[0]=e[0]+f[0];a[1]=e[1]+f[1];a[2]=e[2]+f[2];a[3]=e[3]+f[3];a[4]=e[4]+f[4];a[5]=e[5]+f[5];return a}function p(a,e,f){a[0]=e[0]-f[0];a[1]=e[1]-f[1];a[2]=e[2]-f[2];a[3]=e[3]-f[3];a[4]=e[4]-f[4];a[5]=e[5]-f[5];return a}function r(a,e,f){a[0]=e[0]*f;a[1]=e[1]*f;a[2]=e[2]*f;a[3]=e[3]*f;a[4]=e[4]*f;a[5]=e[5]*f;return a}function x(a,e,f,E){a[0]=e[0]+f[0]*E;a[1]=e[1]+f[1]*E;a[2]=e[2]+f[2]*E;a[3]=e[3]+f[3]*E;a[4]=e[4]+f[4]*E;a[5]=e[5]+f[5]*E;return a}function N(a,e){return a[0]===e[0]&&
a[1]===e[1]&&a[2]===e[2]&&a[3]===e[3]&&a[4]===e[4]&&a[5]===e[5]}function k(a,e){const f=a[0],E=a[1],w=a[2],L=a[3],D=a[4];a=a[5];const G=e[0],P=e[1],S=e[2],C=e[3],u=e[4];e=e[5];const v=m.getEpsilon();return Math.abs(f-G)<=v*Math.max(1,Math.abs(f),Math.abs(G))&&Math.abs(E-P)<=v*Math.max(1,Math.abs(E),Math.abs(P))&&Math.abs(w-S)<=v*Math.max(1,Math.abs(w),Math.abs(S))&&Math.abs(L-C)<=v*Math.max(1,Math.abs(L),Math.abs(C))&&Math.abs(D-u)<=v*Math.max(1,Math.abs(D),Math.abs(u))&&Math.abs(a-e)<=v*Math.max(1,
Math.abs(a),Math.abs(e))}const h=Object.freeze(Object.defineProperty({__proto__:null,add:d,copy:t,determinant:J,equals:k,exactEquals:N,frob:l,fromRotation:c,fromScaling:g,fromTranslation:n,identity:y,invert:H,mul:K,multiply:K,multiplyScalar:r,multiplyScalarAndAdd:x,rotate:M,scale:F,set:z,str:q,sub:p,subtract:p,translate:A},Symbol.toStringTag,{value:"Module"}));b.add=d;b.copy=t;b.determinant=J;b.equals=k;b.exactEquals=N;b.frob=l;b.fromRotation=c;b.fromScaling=g;b.fromTranslation=n;b.identity=y;b.invert=
H;b.mat2d=h;b.mul=K;b.multiply=K;b.multiplyScalar=r;b.multiplyScalarAndAdd=x;b.rotate=M;b.scale=F;b.set=z;b.str=q;b.sub=p;b.subtract=p;b.translate=A})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(b,m,t,y,z){function H(M,F,A){const c=`${A}_arrowStart`;A=`${A}_arrowEnd`;M="left"===M;const g={markerStart:null,markerEnd:null};
switch(F){case "HL":M?g.markerStart=`url(#${A})`:g.markerEnd=`url(#${c})`;break;case "LL":g.markerStart=`url(#${A})`;break;case "LH":M?g.markerEnd=`url(#${c})`:g.markerStart=`url(#${A})`;break;default:g.markerEnd=`url(#${c})`}return g}function J(M,F,A={}){const {focus:c,numClasses:g,colors:n,rotation:q}=M,{opacity:l,effectList:d,ariaLabel:p}=A;M=A.size??60;A=!!c;const r=Math.sqrt(M**2+M**2)+(A?0:5),x=[],N=[];var k=[],h=(M||75)/g;for(var a=0;a<g;a++){var e=a*h;for(var f=0;f<g;f++){var E=f*h,w=m.generateFillAttributes(n[a][f]);
const L=m.generateStrokeAttributes(null);E={type:"rect",x:E,y:e,width:h,height:h};const D=m.renderDef(w);D&&x.push(D);(w=m.renderShape(E,w.fill,L,null))&&N.push(w);k.push(m.getBoundingBox(E))}}h=null;A||(h="margin: -15px -15px -18px -15px");a=H("left",c,F);e=H("right",c,F);f=m.computeBBox(k);k=m.getTransformMatrix(f,r,r,0,!1,q,!1);f=m.getTransformMatrix(f,r,r,0,!1,A?-45:null,!1);w={filter:t.getCSSFilterFromEffectList(d)??void 0,opacity:null==l?"":`${l}`};return z.tsx("div",{class:A?K.diamondMidColRamp:
K.squareTableCell,styles:w},z.tsx("svg",{"aria-labelledBy":p,focusable:!1,height:r,role:"image",style:h,width:r,xmlns:"http://www.w3.org/2000/svg"},z.tsx("defs",null,z.tsx("marker",{id:`${F}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},z.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),z.tsx("marker",{id:`${F}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",
refY:"5"},z.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),x),z.tsx("g",{transform:k},N),z.tsx("g",{transform:f},z.tsx("line",{fill:"none","marker-end":a.markerEnd,"marker-start":a.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:M-15,y2:15}),z.tsx("line",{fill:"none","marker-end":e.markerEnd,"marker-start":e.markerStart,stroke:"#555555","stroke-width":"1",x1:15,x2:M-15,y1:M+10,y2:M+10}))))}const K={diamondContainer:"esri-relationship-ramp--diamond__container",
diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",
squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};b.renderRelationshipRamp=function(M,F,A={}){const {focus:c,labels:g}=M,n=!!c;M=J(M,F,A);F={justifyContent:"center"};
A=y.isRTL();return n?z.tsx("div",{class:K.diamondContainer,styles:F},z.tsx("div",{class:K.diamondLeftCol},A?g.right:g.left),z.tsx("div",{class:K.diamondMidCol},z.tsx("div",{class:K.diamondMidColLabel},g.top),M,z.tsx("div",{class:K.diamondMidColLabel},g.bottom)),z.tsx("div",{class:K.diamondRightCol},A?g.left:g.right)):z.tsx("div",{class:K.squareTable},z.tsx("div",{class:K.squareTableRow},z.tsx("div",{class:y.classes(K.squareTableCell,K.squareTableLabel,K.squareTableLabelRightBottom)},A?g.top:g.left),
z.tsx("div",{class:K.squareTableCell}),z.tsx("div",{class:y.classes(K.squareTableCell,K.squareTableLabel,K.squareTableLabelLeftBottom)},A?g.left:g.top)),z.tsx("div",{class:K.squareTableRow},z.tsx("div",{class:K.squareTableCell}),M,z.tsx("div",{class:K.squareTableCell})),z.tsx("div",{class:K.squareTableRow},z.tsx("div",{class:y.classes(K.squareTableCell,K.squareTableLabel,K.squareTableLabelRightTop)},A?g.right:g.bottom),z.tsx("div",{class:K.squareTableCell}),z.tsx("div",{class:y.classes(K.squareTableCell,
K.squareTableLabel,K.squareTableLabelLeftTop)},A?g.bottom:g.right)))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(b,m,t,y){function z(F){if(F){var {type:A}=F;return A.includes("3d")?y.getSymbolLayerFill(F.symbolLayers.at(0)):"simple-line"===A||"simple-marker"===F.type&&("x"===F.style||"cross"===
F.style)?(F=t.getStroke(F))&&F.color:t.getFill(F)}}function H(F,A){const c=A.HH.label,g=A.LL.label,n=A.HL.label;A=A.LH.label;switch(F){case "HH":return{top:c,bottom:g,left:n,right:A};case "HL":return{top:n,bottom:A,left:g,right:c};case "LL":return{top:g,bottom:c,left:A,right:n};case "LH":return{top:A,bottom:n,left:c,right:g};default:return{top:c,bottom:g,left:n,right:A}}}function J(F){let A=K[F];F&&null==A&&(A=K.HH);return A||0}const K={HH:315,HL:45,LL:135,LH:225},M={2:[["HL","HH"],["LL","LH"]],3:[["HL",
"HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};b.getRelationshipRampColors2D=function(F,A){const c=[],g=F.length**.5;F=m.clone(F);var n=(A||"HH").split("");A=n[0];for(n="H"===n[1];F.length;){const q=[];for(;q.length<g;)q.push(F.shift());n&&q.reverse();c.push(q)}"L"===A&&c.reverse();return c};b.getRelationshipRampElement=function(F){const {focus:A,infos:c,numClasses:g}=F;var n=M[g];const q={};
c.forEach(l=>{q[l.value]={label:l.label,fill:z(l.symbol)}});F=[];for(let l=0;l<g;l++){const d=[];for(let p=0;p<g;p++)d.push(q[n[l][p]].fill);F.push(d)}n=H(A,q);return{type:"relationship-ramp",numClasses:g,focus:A,colors:F,labels:n,rotation:J(A)}};b.getRotationAngleForFocus=J;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(b,m,t,y,z,H,J,K,M,F,A,c,g,n){function q(v){const B=v.outline;var Q=null!=v.material?v.material.color:null;Q=null!=Q?Q.toHex():null;if(null==B||"pattern"in B&&null!=B.pattern&&"style"===B.pattern.type&&"none"===B.pattern.style)return"fill"===v.type&&"#ffffff"===Q?{color:"#bdc3c7",width:.75}:null;v=J.pt2px(B.size)||0;return{color:"rgba("+(null!=B.color?B.color.toRgba():"255,255,255,1")+")",width:Math.min(v,S),style:"pattern"in B&&null!=B.pattern&&"style"===B.pattern.type?K.dekebabifyLineStyle(B.pattern.style):
null,join:"butt",cap:"patternCap"in B?B.patternCap:"butt"}}async function l(v,B){if(v.thumbnail?.url)return v.thumbnail.url;if("icon"===B.type&&B?.resource?.href)return g.getIconHref(B);B=m.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return v.styleOrigin&&(v.styleOrigin.styleName||v.styleOrigin.styleUrl)&&(v=await n.resolveWebStyleSymbol(v.styleOrigin,{portal:v.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in v&&v.thumbnail?.url?v.thumbnail.url:B}function d(v,B=1){const Q=
v.a;v=t.toHSV(v);const {r:T,g:X,b:ba}=t.toRGB({h:v.h,s:v.s/B,v:100-(100-v.v)/B});return[T,X,ba,Q]}function p(v){return"water"===v.type?null==v.color?null:v.color:null==v.material?.color?null:v.material.color}function r(v,B=0){var Q=p(v);if(!Q){if("fill"===v.type)return null;B=A.adjustColorComponentBrightness(K.defaultThematicColor.r,B);return[B,B,B,100]}v=Q.toRgba();for(Q=0;3>Q;Q++)v[Q]=A.adjustColorComponentBrightness(v[Q],B);return v}async function x(v,B){v=v.style;return"none"===v?null:{type:"pattern",
x:0,y:0,src:await K.getPatternUrlWithColor(m.getAssetUrl(`esri/symbols/patterns/${v}.png`),B.toCss(!0)),width:5,height:5}}function N(v){return v.outline?q(v):{color:"rgba(0, 0, 0, 1)",width:1.5}}function k(v,B){v=p(v);if(!v)return null;let Q;Q="rgba("+(A.adjustColorComponentBrightness(v.r,B)+",");Q+=A.adjustColorComponentBrightness(v.g,B)+",";Q+=A.adjustColorComponentBrightness(v.b,B)+",";return Q+v.a+");"}function h(v,B){B=k(v,B);if(!B)return{};if("pattern"in v&&null!=v.pattern&&"style"===v.pattern.type&&
"none"===v.pattern.style)return null;const Q=Math.min(v.size?J.pt2px(v.size):.75,S);return{color:B,width:Q,style:"pattern"in v&&null!=v.pattern&&"style"===v.pattern.type?K.dekebabifyLineStyle(v.pattern.style):null,cap:"cap"in v?v.cap:null,join:"join"in v?"miter"===v.join?J.pt2px(2):v.join:null}}function a(v,B,Q){Q=null!=Q?.75*Q:0;return{type:"linear",x1:Q?.25*Q:0,y1:Q?.5*Q:0,x2:Q||4,y2:Q?.5*Q:4,colors:[{color:v,offset:0},{color:B,offset:1}]}}function e(v){const B=v.depth,Q=v.height;v=v.width;return 0!==
v&&0!==B&&0!==Q&&v===B&&null!=v&&null!=Q&&v<Q}function f(v,B,Q){const T=[];if(!v)return T;switch(v.type){case "icon":switch(v.resource&&v.resource.primitive||M.defaultPrimitive){case "circle":T.push({shape:{type:"circle",cx:0,cy:0,r:.5*B},fill:r(v,0),stroke:q(v)});break;case "square":T.push({shape:{type:"path",path:[{command:"M",values:[0,B]},{command:"L",values:[0,0]},{command:"L",values:[B,0]},{command:"L",values:[B,B]},{command:"Z",values:[]}]},fill:r(v,0),stroke:q(v)});break;case "triangle":T.push({shape:{type:"path",
path:[{command:"M",values:[0,B]},{command:"L",values:[.5*B,0]},{command:"L",values:[B,B]},{command:"Z",values:[]}]},fill:r(v,0),stroke:q(v)});break;case "cross":T.push({shape:{type:"path",path:[{command:"M",values:[.5*B,0]},{command:"L",values:[.5*B,B]},{command:"M",values:[0,.5*B]},{command:"L",values:[B,.5*B]}]},stroke:N(v)});break;case "x":T.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[B,B]},{command:"M",values:[B,0]},{command:"L",values:[0,B]}]},stroke:N(v)});
break;case "kite":T.push({shape:{type:"path",path:[{command:"M",values:[0,.5*B]},{command:"L",values:[.5*B,0]},{command:"L",values:[B,.5*B]},{command:"L",values:[.5*B,B]},{command:"Z",values:[]}]},fill:r(v,0),stroke:q(v)})}break;case "object":switch(v.resource&&v.resource.primitive||F.defaultPrimitive){case "cone":var X=r(v,0);v=r(v,-.6);v=a(X,v,Q?u:B);B=A.getConeShapes(B,Q);T.push({shape:B[0],fill:v},{shape:B[1],fill:v});break;case "inverted-cone":Q=r(v,0);v=r(v,-.6);v=a(Q,v,B);B=A.getInvertedConeShapes(B);
T.push({shape:B[0],fill:v},{shape:B[1],fill:Q});break;case "cube":B=A.getCubeShapes(B,Q);T.push({shape:B[0],fill:r(v,0)},{shape:B[1],fill:r(v,-.3)},{shape:B[2],fill:r(v,-.5)});break;case "cylinder":X=r(v,0);const ba=r(v,-.6);X=a(X,ba,Q?u:B);B=A.getCylinderShapes(B,Q);T.push({shape:B[0],fill:X},{shape:B[1],fill:X},{shape:B[2],fill:r(v,0)});break;case "diamond":B=A.getDiamondShapes(B);T.push({shape:B[0],fill:r(v,-.3)},{shape:B[1],fill:r(v,0)},{shape:B[2],fill:r(v,-.3)},{shape:B[3],fill:r(v,-.7)});break;
case "sphere":Q=r(v,0);v=r(v,-.6);v=a(Q,v);v.x1=0;v.y1=0;v.x2=.25*B;v.y2=.25*B;T.push({shape:{type:"circle",cx:0,cy:0,r:.5*B},fill:v});break;case "tetrahedron":B=A.getTetrahedronShapes(B),T.push({shape:B[0],fill:r(v,-.3)},{shape:B[1],fill:r(v,0)},{shape:B[2],fill:r(v,-.6)})}}return T}function E(v){return(v="number"===typeof v?.size?v?.size:null)?J.pt2px(v):null}async function w(v,B){const Q=E(B),T=B?.maxSize?J.pt2px(B.maxSize):null,X=B?.disableUpsampling??!1,ba=v.symbolLayers,da=[];let aa=0,ea=0;
const Y=ba.at(-1);let U;Y&&"icon"===Y.type&&(U=Y.size&&J.pt2px(Y.size));ba.forEach(I=>{if("icon"===I.type||"object"===I.type){var O="icon"===I.type?I.size&&J.pt2px(I.size):0,R=Q||O?Math.ceil(Math.min(Q||O,T||P)):G;if(I?.resource?.href){var W=l(v,I).then(Z=>{const ca=I?.material?.color;var fa="icon"===I.type?"multiply":"tint";return c.tintImageWithColor(Z,R,ca,fa,X)}).then(Z=>{const ca=Z.width,fa=Z.height;aa=Math.max(aa,ca);ea=Math.max(ea,fa);return[{shape:{type:"image",x:0,y:0,width:ca,height:fa,
src:Z.url},fill:null,stroke:null}]});da.push(W)}else W=R,"icon"===I.type&&U&&Q&&(W=O/U*R),O="tall"===B?.symbolConfig||B?.symbolConfig?.isTall||("object"===I.type?e(I):!1),aa=Math.max(aa,O?u:W),ea=Math.max(ea,W),da.push(Promise.resolve(f(I,W,O)))}});const V=[];(await Promise.allSettled(da)).forEach(I=>{"fulfilled"===I.status?V.push(I.value):I.reason&&H.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",I.reason)});return c.renderSymbol(V,[aa,ea],{node:B?.node,
scale:!1,opacity:B?.opacity,ariaLabel:B?.ariaLabel})}function L(v,B){const Q=v.symbolLayers,T=[];v=g.isVolumetricSymbol(v);const X=E(B),ba=(B?.maxSize?J.pt2px(B.maxSize):null)||S;let da=0,aa=0,ea;Q.forEach((Y,U)=>{if(Y&&("line"===Y.type||"path"===Y.type)){var V=[];switch(Y.type){case "line":var I=h(Y,0);if(null==I)break;var O=I?.width||0;0===U&&(ea=O);Y=Math.min(X||O,ba);U=0===U?Y:X?O/ea*Y:Y;O=U>C/2?2*U:C;aa=Math.max(aa,U);da=Math.max(da,O);I.width=U;V.push({shape:{type:"path",path:[{command:"M",
values:[0,.5*aa]},{command:"L",values:[da,.5*aa]}]},stroke:I});break;case "path":I=Math.min(X||G,ba);U=r(Y,0);O=r(Y,-.2);var R=k(Y,-.4);R=R?{color:R,width:1}:{};if("quad"===Y.profile){const W=Y.width;Y=Y.height;Y=A.getPathSymbolShapes(W&&Y?W/Y:1,0===Y,0===W);R={...R,join:"bevel"};V.push({shape:Y[0],fill:O,stroke:R},{shape:Y[1],fill:O,stroke:R},{shape:Y[2],fill:U,stroke:R})}else V.push({shape:A.shapes.pathSymbol3DLayer[0],fill:O,stroke:R},{shape:A.shapes.pathSymbol3DLayer[1],fill:U,stroke:R});da=aa=
Math.max(aa,I)}T.push(V)}});return Promise.resolve(c.renderSymbol(T,[da,aa],{node:B?.node,scale:v,opacity:B?.opacity,ariaLabel:B?.ariaLabel}))}async function D(v,B){const Q="mesh-3d"===v.type;v=v.symbolLayers;var T=E(B);const X=B?.maxSize?J.pt2px(B.maxSize):null;T=T||G;const ba=[];let da=0,aa=0;var ea=!1;for(let O=0;O<v.length;O++){var Y=v.at(O);const R=[];if(!Q||"fill"===Y.type){switch(Y.type){case "fill":ea=Math.min(T,X||P);da=Math.max(da,ea);aa=Math.max(aa,ea);ea=!0;if(Q){var U=A.shapes.meshSymbol3DFill,
V=k(Y,-.4);V=V?{color:V,width:1,join:"round"}:{};R.push({shape:U[0],fill:r(Y,0),stroke:V},{shape:U[1],fill:r(Y,-.2),stroke:V},{shape:U[2],fill:r(Y,-.6),stroke:V})}else{U=r(Y,0);V="pattern"in Y?Y.pattern:null;var I=q(Y);Y=p(Y);null!=V&&"style"===V.type&&"solid"!==V.style&&Y&&(U=await x(V,Y));R.push({shape:A.shapes.fill[0],fill:U,stroke:I})}break;case "line":Y=h(Y,0);if(null==Y)break;Y={stroke:Y,shape:A.shapes.fill[0]};da=Math.max(da,G);aa=Math.max(aa,G);R.push(Y);break;case "extrude":U={join:"round",
width:1,...h(Y,-.4)};V=r(Y,0);Y=r(Y,-.2);I=Math.min(T,X||P);const W=A.getExtrudeSymbolShapes(I);U.width=1;R.push({shape:W[0],fill:Y,stroke:U},{shape:W[1],fill:Y,stroke:U},{shape:W[2],fill:V,stroke:U});Y=.7*G+.5*I;da=Math.max(da,G);aa=Math.max(aa,Y);break;case "water":ea=p(Y),Y=d(ea),U=d(ea,2),V=d(ea,3),I=A.getWaterSymbolShapes(),ea=!0,R.push({shape:I[0],fill:Y},{shape:I[1],fill:U},{shape:I[2],fill:V}),Y=Math.min(T,X||P),da=Math.max(da,Y),aa=Math.max(aa,Y)}ba.push(R)}}return c.renderSymbol(ba,[da,
aa],{node:B?.node,scale:ea,opacity:B?.opacity,ariaLabel:B?.ariaLabel})}const G=A.SymbolSizeDefaults.size,P=A.SymbolSizeDefaults.maxSize,S=A.SymbolSizeDefaults.maxOutlineSize,C=A.SymbolSizeDefaults.lineWidth,u=A.SymbolSizeDefaults.tallSymbolWidth;b.getPatternDescriptor=x;b.getSizeFromOptions=E;b.getSymbolLayerFill=r;b.previewSymbol3D=function(v,B){if(0===v.symbolLayers.length)return Promise.reject(new z("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(v.type){case "point-3d":return w(v,
B);case "line-3d":return L(v,B);case "polygon-3d":case "mesh-3d":return D(v,B)}return Promise.reject(new z("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),function(b,
m,t,y,z,H,J,K,M,F,A){function c(q,l){return l.items.find(d=>d.name===q)}function g(q,l,d,p,r,x){const N=null!=d?.portal?d.portal:H.getDefault(),k={portal:N,url:z.urlToObject(q.baseUrl),origin:"portal-item"},h=c(l,q.data);if(!h)return Promise.reject(new y("symbolstyleutils:symbol-name-not-found",`The symbol name '${l}' could not be found`,{symbolName:l}));r=J.fromJSON(r(h,p),k);let a=h.thumbnail?.href??null;const e=h.thumbnail?.imageData;t.isDevEnvironment()&&(r=t.adjustStaticAGOUrl(r)??"",a=t.adjustStaticAGOUrl(a));
const f={portal:N,url:z.urlToObject(z.removeFile(r)),origin:"portal-item"};return F.requestJSON(r,x).then(E=>{E="cimRef"===p?F.makeCIMSymbolRef(E.data):E.data;if((E=K.fromJSON(E,f))&&m.isSymbol3D(E)){if(a){const w=J.fromJSON(a,k);E.thumbnail=new A.Thumbnail({url:w})}else e&&(E.thumbnail=new A.Thumbnail({url:`data:image/png;base64,${e}`}));q.styleUrl?E.styleOrigin=new M({portal:d.portal,styleUrl:q.styleUrl,name:l}):q.styleName&&(E.styleOrigin=new M({portal:d.portal,styleName:q.styleName,name:l}))}return E})}
function n(q,l,d){const p=F.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,q),r=null!=l.portal?l.portal:H.getDefault();return F.requestJSON(p,d).then(x=>{x=F.makeCIMSymbolRef(x.data);return K.fromJSON(x,{portal:r,url:z.urlToObject(z.removeFile(p)),origin:"portal-item"})})}b.fetchSymbolFromStyle=g;b.getStyleItemFromStyle=c;b.resolveWebStyleSymbol=function(q,l,d,p){const r=q.name;return null==r?Promise.reject(new y("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
q.styleName&&"Esri2DPointSymbolsStyle"===q.styleName?n(r,l,p):F.fetchStyle(q,l,p).then(x=>g(x,r,l,d,F.symbolUrlFromStyleItem,p))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(b){const m=/^devext.arcgis.com$/,t=/^qaext.arcgis.com$/,y=/^[\w-]*\.mapsdevext.arcgis.com$/,z=/^[\w-]*\.mapsqa.arcgis.com$/,H=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,m,t,/^jsapps.esri.com$/,y,z];b.adjustStaticAGOUrl=function(J,K){return J?
(K=K||globalThis.location.hostname)?null!=K.match(m)||null!=K.match(y)?J.replace("static.arcgis.com","staticdev.arcgis.com"):null!=K.match(t)||null!=K.match(z)?J.replace("static.arcgis.com","staticqa.arcgis.com"):J:J:J};b.devHostnames=H;b.isDevEnvironment=function(J){J=J||globalThis.location.hostname;return H.some(K=>null!=J?.match(K))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/layerViewUtils":function(){define(["exports"],function(b){b.extractSafeScaleBounds=
function(m){m=m.effectiveScaleRange;return{minScale:m?.minScale??0,maxScale:m?.maxScale??0}};b.highlightsSupported=function(m){return m&&"function"===typeof m.highlight};b.isScaleRangeActive=function(m,t){return null!=m&&0<m||null!=t&&0<t};b.isSelectableLayerView2D=function(m){return null!=m&&"object"===typeof m&&"createQuery"in m&&"queryFeatures"in m&&"layer"in m&&"view"in m};b.occludeesSupported=function(m){return m&&"function"===typeof m.maskOccludee};b.scaleBoundsPredicate=function(m,t,y){return null==
m||m>y&&(0===t||m<t)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/actions":function(){define("exports ../../core/Collection ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionToggle ../support/legacyIcon".split(" "),function(b,m,t,y,z,H){m=m.ofType({key:"type",defaultKeyValue:"button",base:t,typeMap:{button:y,toggle:z}});t=new y({icon:"magnifying-glass-plus",id:"zoom-to-feature",title:"{messages.zoom}",className:H.legacyIcon.zoomInMagnifyingGlass});
const J=new y({icon:"trash",id:"remove-selected-feature",title:"{messages.remove}",className:H.legacyIcon.trash});y=new y({icon:"magnifying-glass-plus",id:"zoom-to-clustered-features",title:"{messages.zoom}",className:H.legacyIcon.zoomInMagnifyingGlass});z=new z({icon:"table",id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:H.legacyIcon.table,value:!1});H=[t,J,z,y];b.ActionsCollection=m;b.all=H;b.browseClusteredFeatures=z;b.removeSelectedFeature=J;b.zoomToClusteredFeatures=
y;b.zoomToFeature=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/actionUtils":function(){define(["exports","../../core/Error","../../core/Logger","../../core/promiseUtils","./actions"],function(b,m,t,y,z){function H(g){const {selectedFeature:n,location:q,view:l}=g;return l?n??q??null:null}function J(g){return!!g&&g.isAggregate&&"cluster"===g.sourceLayer?.featureReduction?.type}async function K(g,n){if("3d"!==n?.type||!g||"esri.Graphic"!==g.declaredClass)return!0;
if((n=n.getViewForGraphic(g))&&"whenGraphicBounds"in n){let q=null;try{q=await n.whenGraphicBounds(g,{useViewElevation:!0})}catch(l){}return!q||!q.boundingBox||q.boundingBox[0]===q.boundingBox[3]&&q.boundingBox[1]===q.boundingBox[4]&&q.boundingBox[2]===q.boundingBox[5]}return!0}async function M(g){const {location:n,selectedFeature:q,view:l,zoomFactor:d}=g,p=H(g);if(!l||!p)throw g=new m("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:p,view:l}),c.error(g),
g;const r=l.scale/d,x=g.selectedFeature?.geometry??n,N=null!=x&&"point"===x.type&&await K(q,l);z.zoomToFeature.active=!0;z.zoomToFeature.disabled=!0;try{await g.zoomTo({target:{target:p,scale:N?r:void 0}})}catch(k){const h=new m("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:q});c.error(h)}finally{z.zoomToFeature.active=!1,z.zoomToFeature.disabled=!1,g.zoomToLocation=null,N&&(g.location=x)}}async function F(g){const {selectedFeature:n,view:q}=g;if("2d"!==q?.type)throw g=
new m("zoomToCluster:invalid-view","View must be 2d MapView.",{view:q}),c.error(g),g;if(!n||!J(n))throw g=new m("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:n}),c.error(g),g;const [l,d]=await A(q,n);z.zoomToClusteredFeatures.active=!0;z.zoomToClusteredFeatures.disabled=!0;const {extent:p}=await l.queryExtent(d);await g.zoomTo({target:p});z.zoomToClusteredFeatures.active=!1;z.zoomToClusteredFeatures.disabled=!1}async function A(g,
n){g=await g.whenLayerView(n.sourceLayer);const q=g.createQuery();n=n.getObjectId();q.aggregateIds=null!=n?[n]:[];return[g,q]}const c=t.getLogger("esri.widgets.Popup.PopupViewModel");b.browseAggregateFeatures=async function(g){const {selectedFeature:n,view:q}=g;if(q&&n){var [l,d]=await A(q,n);z.browseClusteredFeatures.active=!0;z.browseClusteredFeatures.disabled=!0;var {features:p}=await l.queryFeatures(d);z.browseClusteredFeatures.active=!1;z.browseClusteredFeatures.disabled=!1;z.browseClusteredFeatures.value=
!0;g?.open({features:[n].concat(p),featureMenuOpen:!0})}};b.displayClusterExtent=async function(g){const {view:n,selectedFeature:q}=g;if(n&&q){var [l,d]=await A(n,q),{extent:p}=await l.queryExtent(d);g.selectedClusterBoundaryFeature.geometry=p;n.graphics.add(g.selectedClusterBoundaryFeature)}};b.getPointFromGeometry=function(g){if(null==g)return null;switch(g.type){case "point":return g;case "extent":return g.center;case "polygon":return g.centroid;case "multipoint":case "polyline":return g.extent?.center;
default:return null}};b.getSelectedTarget=H;b.isClusterFeature=J;b.removeClusteredFeaturesForBrowsing=function(g){z.browseClusteredFeatures.value=!1;const n=g.features.filter(q=>J(q));n.length&&(g.features=n)};b.triggerAction=g=>{const {event:n,view:q,viewModel:l}=g;({action:g}=n);if(!g)return Promise.reject(new m("trigger-action:missing-arguments","Event has no action"));const {disabled:d,id:p}=g;if(!p)return Promise.reject(new m("trigger-action:invalid-action","action.id is missing"));if(d)return Promise.reject(new m("trigger-action:invalid-action",
"Action is disabled"));if(p===z.zoomToFeature.id)return M(l).catch(y.throwIfNotAbortError);if(p===z.zoomToClusteredFeatures.id)return F(l);if(p===z.browseClusteredFeatures.id)return l.browseClusterEnabled=!l.browseClusterEnabled,l.featureMenuOpen=l.browseClusterEnabled,Promise.resolve();if(p===z.removeSelectedFeature.id){l.visible=!1;({selectedFeature:g}=l);if(!g)return Promise.reject(new m(`trigger-action:${z.removeSelectedFeature.id}`,"selectedFeature is required",{selectedFeature:g}));const {sourceLayer:r}=
g;r?r.remove(g):q?.graphics.remove(g)}return Promise.resolve()};b.zoomToClusterExtent=F;b.zoomToLocation=M;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/GoTo":function(){define("exports ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(b,m,t,y,z,H,J,K){b.GoToMixin=M=>{M=class extends M{constructor(...F){super(...F);
this.view=this.goToOverride=null}callGoTo(F){const {view:A}=this;t.assertIsSome(A);return this.goToOverride?this.goToOverride(A,F):A.goTo(F.target,F.options)}};m.__decorate([y.property()],M.prototype,"goToOverride",void 0);m.__decorate([y.property()],M.prototype,"view",void 0);return M=m.__decorate([K.subclass("esri.widgets.support.GoTo")],M)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Features/FeaturesVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,m,t,y,z,H,J){m=class extends m{constructor(){super(...arguments);this.closeButton=this.actionBar=!0;this.collapseButton=!1;this.spinner=this.heading=this.featureNavigation=!0}};b.__decorate([t.property({type:Boolean,nonNullable:!0})],m.prototype,"actionBar",void 0);b.__decorate([t.property({type:Boolean,nonNullable:!0})],m.prototype,"closeButton",void 0);b.__decorate([t.property({type:Boolean,nonNullable:!0})],m.prototype,"collapseButton",void 0);b.__decorate([t.property({type:Boolean,
nonNullable:!0})],m.prototype,"featureNavigation",void 0);b.__decorate([t.property({type:Boolean,nonNullable:!0})],m.prototype,"heading",void 0);b.__decorate([t.property({type:Boolean,nonNullable:!0})],m.prototype,"spinner",void 0);return m=b.__decorate([J.subclass("esri.widgets.Features.FeaturesVisibleElements")],m)})},"esri/widgets/Popup/css":function(){define(["exports"],function(b){b.css={base:"esri-popup",main:"esri-popup__main-container",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",
isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",
alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/PopupViewModel":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/Error ../../core/accessorSupport/decorators/subclass ../Features/FeaturesViewModel".split(" "),
function(b,m,t,y,z,H,J,K){m=class extends K{constructor(M){super(M)}};return m=b.__decorate([J.subclass("esri.widgets.Popup.PopupViewModel")],m)})},"esri/widgets/Popup/PopupVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(b,m,t,y,z,H,J){m=class extends m{constructor(){super(...arguments);
this.featureNavigation=this.closeButton=!0}};b.__decorate([t.property({type:Boolean,nonNullable:!0})],m.prototype,"closeButton",void 0);b.__decorate([t.property({type:Boolean,nonNullable:!0})],m.prototype,"featureNavigation",void 0);return m=b.__decorate([J.subclass("esri.widgets.Features.PopupVisibleElements")],m)})},"*noref":1}});
define("../chunks/tslib.es6 ../core/deprecate ../core/Logger ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../support/actions/ActionButton ./Features ./Widget ./Popup/css ./Popup/PopupViewModel ./Popup/PopupVisibleElements ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),function(b,
m,t,y,z,H,J,K,M,F,A,c,g,n,q,l,d,p,r,x){const N={buttonEnabled:!0,position:"auto",breakpoint:{width:544}};H=class extends c{constructor(k,h){super(k,h);this._dockAction=new F({id:"popup-dock-action"});this._featuresWidget=new A({responsiveActionsEnabled:!0});this._mainContainerNode=this._containerNode=null;this._pointerOffsetInPx=16;this.alignment="auto";this.collapsed=!1;this.collapseEnabled=!0;this.dockEnabled=!1;this.headingLevel=2;this.maxInlineActions=3;this.messages=null;this.spinnerEnabled=
!0;this.viewModel=new n;this.visibleElements=new q}initialize(){this.addHandles([y.watch(()=>[this.viewModel?.view?.widthBreakpoint,this.dockEnabled],()=>this._handleDockIcon(),{initial:!0}),y.watch(()=>[this.dockEnabled,this.messages?.undock,this.messages?.dock],()=>this._handleDockEnabled(),{initial:!0}),y.watch(()=>this.dockOptions,k=>{const {_dockAction:h}=this,a=this._featuresWidget.headerActions;a.remove(h);k.buttonEnabled&&a.add(h)},{initial:!0}),y.watch(()=>this.viewModel?.screenLocation,
()=>this._positionContainer()),y.watch(()=>[this.viewModel?.active,this.dockEnabled],()=>this._toggleScreenLocationEnabled()),y.watch(()=>[this.viewModel?.screenLocation,this.viewModel?.view?.padding,this.viewModel?.view?.size,this.viewModel?.active,this.viewModel?.location,this.alignment],()=>this.reposition()),y.watch(()=>this.viewModel?.view?.size,(k,h)=>this._updateDockEnabledForViewSize(k,h)),y.watch(()=>this.viewModel?.view,(k,h)=>this._viewChange(k,h)),y.watch(()=>this.viewModel?.view?.ready,
(k,h)=>this._viewReadyChange(k??!1,h??!1)),y.watch(()=>this.viewModel,()=>this._featuresWidget.viewModel=this.viewModel,{initial:!0}),y.watch(()=>this._featureNavigationTop,k=>this._featuresWidget.featureNavigationTop=k,{initial:!0}),y.watch(()=>this.headingLevel,k=>this._featuresWidget.headingLevel=k,{initial:!0}),y.watch(()=>this.collapseEnabled,k=>this._featuresWidget.visibleElements.collapseButton=k,{initial:!0}),y.watch(()=>this.collapsed,k=>this._featuresWidget.collapsed=k,{initial:!0}),y.watch(()=>
this.visibleElements.closeButton,k=>this._featuresWidget.visibleElements.closeButton=!!k,{initial:!0}),y.watch(()=>this.spinnerEnabled,k=>this._featuresWidget.visibleElements.spinner=k,{initial:!0}),y.watch(()=>this.visibleElements.featureNavigation,k=>this._featuresWidget.visibleElements.featureNavigation=!!k,{initial:!0}),y.on(()=>this._featuresWidget,"trigger-header-action",k=>{k.action===this._dockAction&&(this.dockEnabled=!this.dockEnabled)})])}destroy(){this._dockAction.destroy();this._featuresWidget?.destroy()}get _featureNavigationTop(){const {currentAlignment:k,
currentDockPosition:h}=this;return"bottom-left"===k||"bottom-center"===k||"bottom-right"===k||"top-left"===h||"top-center"===h||"top-right"===h}get actions(){return this.viewModel.actions}set actions(k){this.viewModel.actions=k}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(k){this.viewModel.autoCloseEnabled=k}get autoOpenEnabled(){m.deprecatedProperty(t.getLogger(this),"autoOpenEnabled",{replacement:"MapView/SceneView.popupEnabled",version:"4.27"});return this.viewModel.autoOpenEnabled}set autoOpenEnabled(k){m.deprecatedProperty(t.getLogger(this),
"autoOpenEnabled",{replacement:"MapView/SceneView.popupEnabled",version:"4.27"});this.viewModel.autoOpenEnabled=k}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(k){this.viewModel.defaultPopupTemplateEnabled=k}get content(){return this.viewModel.content}set content(k){this.viewModel.content=k}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||
N}set dockOptions(k){var h={...N};const a=this.viewModel?.view?.breakpoints;var e={};a&&(e.width=a.xsmall,e.height=a.xsmall);k={...h,...k};h={...h.breakpoint,...e};({breakpoint:e}=k);"object"===typeof e?k.breakpoint={...h,...e}:e&&(k.breakpoint=h);this._set("dockOptions",k);this._setCurrentDockPosition();this.reposition()}get featureCount(){return this.viewModel.featureCount}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(k){this.viewModel.featureMenuOpen=k}get features(){return this.viewModel.features}set features(k){this.viewModel.features=
k}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(k){this.viewModel.goToOverride=k}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(k){this.viewModel.highlightEnabled=k}get location(){return this.viewModel.location}set location(k){this.viewModel.location=k}get label(){return this.messages?.widgetLabel??""}set label(k){this._overrideIfSome("label",k)}get promises(){return this.viewModel.promises}set promises(k){this.viewModel.promises=k}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(k){this.viewModel.selectedFeatureIndex=
k}get selectedFeatureWidget(){return this._featuresWidget.selectedFeatureWidget}get title(){return this.viewModel.title}set title(k){this.viewModel.title=k}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(k){this.viewModel.updateLocationEnabled=k}get view(){return this.viewModel.view}set view(k){this.viewModel.view=k}get visible(){return this.viewModel.visible}set visible(k){this.viewModel.visible=k}blur(){const {active:k}=this.viewModel;k||t.getLogger(this).warn("Popup can only be blurred when currently active.");
this._featuresWidget.blur()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(k,h){return this.viewModel.fetchFeatures(k,h)}focus(){const {active:k}=this.viewModel;k||t.getLogger(this).warn("Popup can only be focused when currently active.");this.renderNow();this._featuresWidget.focus()}next(){return this.viewModel.next()}open(k){this.set({collapsed:k?!!k.collapsed:!1,featureMenuOpen:k?!!k.featureMenuOpen:!1});this.viewModel.open(k);this._shouldFocus(k)}previous(){return this.viewModel.previous()}reposition(){this.renderNow();
this._positionContainer();this._setCurrentAlignment()}triggerAction(k){return this.viewModel.triggerAction(k)}render(){const {dockEnabled:k,currentAlignment:h,currentDockPosition:a}=this,{active:e}=this.viewModel,f=this.selectedFeature?.layer?.title,E=this.selectedFeature?.layer?.id;return x.tsx("div",{afterCreate:this._positionContainer,afterUpdate:this._positionContainer,bind:this,class:this.classes(g.css.base,{[g.css.alignTopCenter]:"top-center"===h,[g.css.alignBottomCenter]:"bottom-center"===
h,[g.css.alignTopLeft]:"top-left"===h,[g.css.alignBottomLeft]:"bottom-left"===h,[g.css.alignTopRight]:"top-right"===h,[g.css.alignBottomRight]:"bottom-right"===h,[g.css.isDocked]:e&&k,[g.css.shadow]:e&&!k,[g.css.isDockedTopLeft]:"top-left"===a,[g.css.isDockedTopCenter]:"top-center"===a,[g.css.isDockedTopRight]:"top-right"===a,[g.css.isDockedBottomLeft]:"bottom-left"===a,[g.css.isDockedBottomCenter]:"bottom-center"===a,[g.css.isDockedBottomRight]:"bottom-right"===a}),"data-layer-id":E,"data-layer-title":f,
role:"presentation"},e?[this._renderMainContainer(),this._renderPointer()]:null)}_renderPointer(){return this.dockEnabled?null:x.tsx("div",{class:g.css.pointer,key:"popup-pointer",role:"presentation"},x.tsx("div",{class:this.classes(g.css.pointerDirection,g.css.shadow)}))}_renderMainContainer(){const {dockEnabled:k}=this;return x.tsx("div",{afterCreate:this._setMainContainerNode,afterUpdate:this._setMainContainerNode,bind:this,class:this.classes(g.css.main,l.globalCss.widget,{[g.css.shadow]:k})},
this._featuresWidget.render())}async _shouldFocus(k){k?.shouldFocus&&(await y.whenOnce(()=>!0===this.viewModel?.active),this.focus())}_isOutsideView(k){const {popupHeight:h,popupWidth:a,screenLocation:e,side:f,view:E}=k;if(isNaN(a)||isNaN(h)||!E||!e)return!1;k=E.padding;return"right"===f&&e.x+a/2>E.width-k.right||"left"===f&&e.x-a/2<k.left||"top"===f&&e.y-h<k.top||"bottom"===f&&e.y+h>E.height-k.bottom?!0:!1}_calculateAutoAlignment(k){if("auto"!==k)return k;const {_pointerOffsetInPx:h,_containerNode:a,
_mainContainerNode:e,viewModel:f}=this,{screenLocation:E,view:w}=f;if(null==E||!w||!a)return"top-center";var L=(k=e?window.getComputedStyle(e,null):null)?parseInt(k.getPropertyValue("max-height").replaceAll(/[^-\d\.]/g,""),10):0,D=k?parseInt(k.getPropertyValue("height").replaceAll(/[^-\d\.]/g,""),10):0;const {height:G,width:P}=a.getBoundingClientRect();k=P+h;const S=Math.max(G,L,D)+h;L=this._isOutsideView({popupHeight:S,popupWidth:k,screenLocation:E,side:"right",view:w});D=this._isOutsideView({popupHeight:S,
popupWidth:k,screenLocation:E,side:"left",view:w});const C=this._isOutsideView({popupHeight:S,popupWidth:k,screenLocation:E,side:"top",view:w});k=this._isOutsideView({popupHeight:S,popupWidth:k,screenLocation:E,side:"bottom",view:w});return D?C?"bottom-right":"top-right":L?C?"bottom-left":"top-left":C?k?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(k){return"function"===typeof k?k.call(this):k}_getCurrentAlignment(){const {alignment:k,dockEnabled:h}=this;return h||!this.viewModel.active?
null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(k)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(k){const h=["left","right"];d.isRTL(this.container)&&h.reverse();return k?.replace(/leading/gi,h[0]).replaceAll(/trailing/gi,h[1])}_callDockPosition(k){return"function"===typeof k?k.call(this):k}_getDockPosition(){return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(this.dockOptions?.position)))}_getCurrentDockPosition(){return this.dockEnabled&&
this.viewModel.active?this._getDockPosition():null}_calculateAutoDockPosition(k){if("auto"!==k)return k;var h=this.viewModel?.view;k=d.isRTL(this.container)?"top-left":"top-right";if(!h)return k;var a=h.padding||{left:0,right:0,top:0,bottom:0};a=h.width-a.left-a.right;({breakpoints:h}=h);return h&&a<=h.xsmall?"bottom-center":k}_getDockIcon(){const k=this._getDockPosition();if(this.dockEnabled)return"minimize";switch(k){case "top-left":case "bottom-left":return"dock-left";case "top-center":return"maximize";
case "bottom-center":return"dock-bottom";default:return"dock-right"}}_handleDockIcon(){this._dockAction.icon=this._getDockIcon()}_handleDockEnabled(){this._dockAction.title=this.dockEnabled?this.messages?.undock:this.messages?.dock}_setMainContainerNode(k){this._mainContainerNode=k}_positionContainer(k=this._containerNode){k&&(this._containerNode=k);if(this._containerNode){({screenLocation:k}=this.viewModel);var {width:h}=this._containerNode.getBoundingClientRect();(k=this._calculatePositionStyle(k,
h))&&Object.assign(this._containerNode.style,k)}}_calculateFullWidth(k){const {currentAlignment:h,_pointerOffsetInPx:a}=this;return"top-left"===h||"bottom-left"===h||"top-right"===h||"bottom-right"===h?k+a:k}_calculateAlignmentPosition(k,h,a,e){const {currentAlignment:f,_pointerOffsetInPx:E}=this;if(a){var {padding:w}=a;e/=2;var L=a.height-h;a=a.width-k;if("bottom-center"===f)return{top:h+E-w.top,left:k-e-w.left};if("top-left"===f)return{bottom:L+E-w.bottom,right:a+E-w.right};if("bottom-left"===f)return{top:h+
E-w.top,right:a+E-w.right};if("top-right"===f)return{bottom:L+E-w.bottom,left:k+E-w.left};if("bottom-right"===f)return{top:h+E-w.top,left:k+E-w.left};if("top-center"===f)return{bottom:L+E-w.bottom,left:k-e-w.left}}}_calculatePositionStyle(k,h){const {dockEnabled:a,view:e}=this;if(e){if(a)return{left:"",top:"",right:"",bottom:""};if(null!=k&&h&&(h=this._calculateFullWidth(h),k=this._calculateAlignmentPosition(k.x,k.y,e,h)))return{top:void 0!==k.top?`${k.top}px`:"auto",left:void 0!==k.left?`${k.left}px`:
"auto",bottom:void 0!==k.bottom?`${k.bottom}px`:"auto",right:void 0!==k.right?`${k.right}px`:"auto"}}}_viewChange(k,h){k&&h&&(this.close(),this.clear())}_viewReadyChange(k,h){k?this._wireUpView():h&&(this.close(),this.clear())}_wireUpView(){this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(k,h,a){const [e,f]=k,[E,w]=h,{width:L=0,height:D=0}=a??{};return e<=L&&E>L||e>L&&E<=L||f<=D&&w>D||f>D&&w<=D}_updateDockEnabledForViewSize(k,h){if(k&&h){var a=this.viewModel?.view?.padding||
{left:0,right:0,top:0,bottom:0},e=a.left+a.right,f=a.top+a.bottom;a=[];var E=[];a[0]=k[0]-e;a[1]=k[1]-f;E[0]=h[0]-e;E[1]=h[1]-f;({dockOptions:k}=this);this._dockingThresholdCrossed(a,E,k.breakpoint)&&this._setDockEnabledForViewSize(k);this._setCurrentDockPosition()}}_toggleScreenLocationEnabled(){const {dockEnabled:k,viewModel:h}=this;h&&(h.screenLocationEnabled=h.active&&!k)}_shouldDockAtCurrentViewSize(k){k=k.breakpoint;var h=this.viewModel?.view?.ui;if(!h)return!1;const {width:a,height:e}=h;if(isNaN(a)||
isNaN(e)||!k)return!1;h=k.hasOwnProperty("width")&&a<=(k.width??0);k=k.hasOwnProperty("height")&&e<=(k.height??0);return h||k}_setDockEnabledForViewSize(k){k.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(k))}};b.__decorate([z.property({readOnly:!0})],H.prototype,"_featureNavigationTop",null);b.__decorate([z.property()],H.prototype,"actions",null);b.__decorate([z.property()],H.prototype,"alignment",void 0);b.__decorate([z.property()],H.prototype,"autoCloseEnabled",null);b.__decorate([z.property()],
H.prototype,"autoOpenEnabled",null);b.__decorate([z.property()],H.prototype,"defaultPopupTemplateEnabled",null);b.__decorate([z.property()],H.prototype,"content",null);b.__decorate([z.property()],H.prototype,"collapsed",void 0);b.__decorate([z.property()],H.prototype,"collapseEnabled",void 0);b.__decorate([z.property({readOnly:!0})],H.prototype,"currentAlignment",null);b.__decorate([z.property({readOnly:!0})],H.prototype,"currentDockPosition",null);b.__decorate([z.property()],H.prototype,"dockOptions",
null);b.__decorate([z.property()],H.prototype,"dockEnabled",void 0);b.__decorate([z.property({readOnly:!0})],H.prototype,"featureCount",null);b.__decorate([z.property()],H.prototype,"featureMenuOpen",null);b.__decorate([z.property()],H.prototype,"features",null);b.__decorate([z.property()],H.prototype,"goToOverride",null);b.__decorate([z.property()],H.prototype,"headingLevel",void 0);b.__decorate([z.property()],H.prototype,"highlightEnabled",null);b.__decorate([z.property()],H.prototype,"location",
null);b.__decorate([z.property()],H.prototype,"label",null);b.__decorate([z.property()],H.prototype,"maxInlineActions",void 0);b.__decorate([z.property(),p.messageBundle("esri/widgets/Popup/t9n/Popup")],H.prototype,"messages",void 0);b.__decorate([z.property()],H.prototype,"promises",null);b.__decorate([z.property({readOnly:!0})],H.prototype,"selectedFeature",null);b.__decorate([z.property()],H.prototype,"selectedFeatureIndex",null);b.__decorate([z.property({readOnly:!0})],H.prototype,"selectedFeatureWidget",
null);b.__decorate([z.property()],H.prototype,"spinnerEnabled",void 0);b.__decorate([z.property()],H.prototype,"title",null);b.__decorate([z.property()],H.prototype,"updateLocationEnabled",null);b.__decorate([z.property()],H.prototype,"view",null);b.__decorate([z.property({type:n}),r.vmEvent(["triggerAction","trigger-action"])],H.prototype,"viewModel",void 0);b.__decorate([z.property()],H.prototype,"visible",null);b.__decorate([z.property({type:q,nonNullable:!0})],H.prototype,"visibleElements",void 0);
return H=b.__decorate([M.subclass("esri.widgets.Popup")],H)});