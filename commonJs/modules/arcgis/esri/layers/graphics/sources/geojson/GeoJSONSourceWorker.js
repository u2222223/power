// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(d,e,B,z,M,n,f,v,g,p){function w(x,G){return x?G?4:3:G?3:2}function I(x,G,K,W){if(x){if(K)return G&&W?D:Va;if(G&&W)return h}else if(G&&W)return Va;return Sa}function E({scale:x,
translate:G},K){return Math.round((K-G[0])/x[0])}function t({scale:x,translate:G},K){return Math.round((G[1]-K)/x[1])}function q({scale:x,translate:G},K,W){return K*x[W]+G[W]}function a(x){x=x.coords;return{x:x[0],y:x[1]}}function r(x,G){x.coords[0]=G.x;x.coords[1]=G.y;return x}function y(x){x=x.coords;return{x:x[0],y:x[1],z:x[2]}}function F(x,G){x.coords[0]=G.x;x.coords[1]=G.y;x.coords[2]=G.z;return x}function S(x){x=x.coords;return{x:x[0],y:x[1],m:x[2]}}function b(x,G){x.coords[0]=G.x;x.coords[1]=
G.y;x.coords[2]=G.m;return x}function A(x){x=x.coords;return{x:x[0],y:x[1],z:x[2],m:x[3]}}function R(x,G){x.coords[0]=G.x;x.coords[1]=G.y;x.coords[2]=G.z;x.coords[3]=G.m;return x}function H(x,G){return x&&G?R:x?F:G?b:r}function Q(x,G,K,W,Z){K=H(K,W);for(const {geometry:ba,attributes:da}of G)G=null!=ba?K(new p,ba):null,x.push(new v.OptimizedFeature(G,da,null,Z?da[Z]:void 0));return x}function N(x,G,K,W){for(const {geometry:Z,attributes:ba}of G)x.push({attributes:ba,geometry:null!=Z?T(Z,K,W):null});
return x}function T(x,G,K){if(null==x)return null;const W=w(G,K),Z=[];for(let ba=0;ba<x.coords.length;ba+=W){const da=[];for(let ia=0;ia<W;ia++)da.push(x.coords[ba+ia]);Z.push(da)}return G?K?{points:Z,hasZ:G,hasM:K}:{points:Z,hasZ:G}:K?{points:Z,hasM:K}:{points:Z}}function l(x,G,K,W,Z){K=w(K,W);for(const {geometry:ba,attributes:da}of G)G=null!=ba?O(new p,ba,K):null,x.push(new v.OptimizedFeature(G,da,null,Z?da[Z]:void 0));return x}function O(x,G,K=w(G.hasZ,G.hasM)){x.lengths[0]=G.points.length;const W=
x.coords;let Z=0;for(const ba of G.points)for(G=0;G<K;G++)W[Z++]=ba[G];return x}function m(x,G,K){if(!x)return null;const W=w(G,K),{coords:Z,lengths:ba}=x;x=[];let da=0;for(const ia of ba){const ka=[];for(let ra=0;ra<ia;ra++){const oa=[];for(let qa=0;qa<W;qa++)oa.push(Z[da++]);ka.push(oa)}x.push(ka)}return G?K?{paths:x,hasZ:G,hasM:K}:{paths:x,hasZ:G}:K?{paths:x,hasM:K}:{paths:x}}function u(x,G,K,W,Z){K=w(K,W);for(const {geometry:ba,attributes:da}of G)G=null!=ba?J(new p,ba,K):null,x.push(new v.OptimizedFeature(G,
da,null,Z?da[Z]:void 0));return x}function J(x,G,K=w(G.hasZ,G.hasM)){const {lengths:W,coords:Z}=x;let ba=0;for(const da of G.paths){for(const ia of da)for(G=0;G<K;G++)Z[ba++]=ia[G];W.push(da.length)}return x}function L(x,G,K){if(!x)return null;const W=w(G,K),{coords:Z,lengths:ba}=x;x=[];let da=0;for(const ia of ba){const ka=[];for(let ra=0;ra<ia;ra++){const oa=[];for(let qa=0;qa<W;qa++)oa.push(Z[da++]);ka.push(oa)}x.push(ka)}return G?K?{rings:x,hasZ:G,hasM:K}:{rings:x,hasZ:G}:K?{rings:x,hasM:K}:{rings:x}}
function U(x,G,K,W,Z){for(const {geometry:ba,centroid:da,attributes:ia}of G){G=null!=ba?Y(new p,ba,K,W):null;const ka=Z?ia[Z]:void 0;null!=da?x.push(new v.OptimizedFeature(G,ia,r(new p,da),ka)):x.push(new v.OptimizedFeature(G,ia,null,ka))}return x}function Y(x,G,K=G.hasZ,W=G.hasM){return ea(x,G.rings,K,W)}function ea(x,G,K,W){K=w(K,W);const {lengths:Z,coords:ba}=x;W=0;Da(x);for(const da of G){for(const ia of da)for(G=0;G<K;G++)ba[W++]=ia[G];Z.push(da.length)}return x}function la(x,G,K,W,Z,ba){Ia(x);
if(!K){for(const da of G)x.push(new v.OptimizedFeature(null,da.attributes,null,ba?da.attributes[ba]:void 0));return x}switch(K){case "esriGeometryPoint":return Q(x,G,W,Z,ba);case "esriGeometryMultipoint":return l(x,G,W,Z,ba);case "esriGeometryPolyline":return u(x,G,W,Z,ba);case "esriGeometryPolygon":return U(x,G,W,Z,ba);default:Pa.error("convertToFeatureSet:unknown-geometry",new e(`Unable to parse unknown geometry type '${K}'`)),Ia(x)}return x}function na(x,G,K,W){x=x&&("coords"in x?x:x.geometry);
if(null==x)return null;switch(G){case "esriGeometryPoint":return G=a,K&&W?G=A:K?G=y:W&&(G=S),G(x);case "esriGeometryMultipoint":return T(x,K,W);case "esriGeometryPolyline":return m(x,K,W);case "esriGeometryPolygon":return L(x,K,W);default:return Pa.error("convertToGeometry:unknown-geometry",new e(`Unable to parse unknown geometry type '${G}'`)),null}}function ta(x,G,K,W,Z){Ia(x);if(null==K){for(const da of G)x.push({attributes:da.attributes});return x}switch(K){case "esriGeometryPoint":K=a;W&&Z?K=
A:W?K=y:Z&&(K=S);for(var ba of G){const {geometry:da,attributes:ia}=ba;W=null!=da?K(da):null;x.push({attributes:ia,geometry:W})}break;case "esriGeometryMultipoint":return N(x,G,W,Z);case "esriGeometryPolyline":for(const {geometry:da,attributes:ia}of G)x.push({attributes:ia,geometry:null!=da?m(da,W,Z):null});break;case "esriGeometryPolygon":for(const {geometry:da,attributes:ia,centroid:ka}of G)ba=null!=da?L(da,W,Z):null,null!=ka?(G=a(ka),x.push({attributes:ia,centroid:G,geometry:ba})):x.push({attributes:ia,
geometry:ba});break;default:Pa.error("convertToFeatureSet:unknown-geometry",new e(`Unable to parse unknown geometry type '${K}'`))}return x}function ua(x,G,K,W,Z,ba,da=K,ia=W){Da(x);if(!G?.coords.length)return null;Z=Na[Z];const {coords:ka,lengths:ra}=G;G=w(K,W);const oa=w(K&&da,W&&ia);K=I(K,W,da,ia);if(!ra.length)return K(x.coords,ka,0,0,E(ba,ka[0]),t(ba,ka[1])),Da(x,G,0),x;let qa,Ca=0,wa,Ba=0;for(const Aa of ra){if(Aa<Z)continue;let ya=0;wa=Ba;ia=W=E(ba,ka[Ca]);qa=da=t(ba,ka[Ca+1]);K(x.coords,ka,
wa,Ca,ia,qa);ya++;Ca+=G;wa+=oa;for(let Ha=1;Ha<Aa;Ha++,Ca+=G)if(ia=E(ba,ka[Ca]),qa=t(ba,ka[Ca+1]),ia!==W||qa!==da)K(x.coords,ka,wa,Ca,ia-W,qa-da),wa+=oa,ya++,W=ia,da=qa;ya>=Z&&(x.lengths.push(ya),Ba=wa)}Ia(x.coords,Ba);return x.coords.length?x:null}function sa(x,G,K,W,Z,ba,da){let ia=W,ka=0;for(let oa=ba+K;oa<da;oa+=K){var ra=G[oa];const qa=G[oa+1],Ca=G[da],wa=G[da+1];let Ba=G[ba],Aa=G[ba+1],ya=Ca-Ba,Ha=wa-Aa;if(0!==ya||0!==Ha){const Qa=((ra-Ba)*ya+(qa-Aa)*Ha)/(ya*ya+Ha*Ha);1<Qa?(Ba=Ca,Aa=wa):0<Qa&&
(Ba+=ya*Qa,Aa+=Ha*Qa)}ya=ra-Ba;Ha=qa-Aa;ra=ya*ya+Ha*Ha;ra>ia&&(ka=oa,ia=ra)}ia>W&&(ka-ba>K&&sa(x,G,K,W,Z,ba,ka),Z(x,G,x.length,ka,G[ka],G[ka+1]),da-ka>K&&sa(x,G,K,W,Z,ka,da))}function va(x,G,K,W,Z){const {coords:ba,lengths:da}=G;K=w(K,W);if(!ba.length)return x!==G&&Da(x),x;z.assertIsSome(Z);const {originPosition:ia,scale:ka,translate:ra}=Z;Z=ha;Z.originPosition=ia;W=Z.scale;W[0]=ka[0]??1;W[1]=-(ka[1]??1);W[2]=ka[2]??1;W[3]=ka[3]??1;var oa=Z.translate;oa[0]=ra[0]??0;oa[1]=ra[1]??0;oa[2]=ra[2]??0;oa[3]=
ra[3]??0;if(!da.length){for(W=0;W<K;++W)x.coords[W]=q(Z,ba[W],W);x!==G&&Da(x,K,0);return x}oa=0;for(let Ca=0;Ca<da.length;Ca++){const wa=da[Ca];x.lengths[Ca]=wa;for(var qa=0;qa<K;++qa)x.coords[oa+qa]=q(Z,ba[oa+qa],qa);qa=x.coords[oa];let Ba=x.coords[oa+1];oa+=K;for(let Aa=1;Aa<wa;Aa++,oa+=K){qa+=ba[oa]*W[0];Ba+=ba[oa+1]*W[1];x.coords[oa]=qa;x.coords[oa+1]=Ba;for(let ya=2;ya<K;++ya)x.coords[oa+ya]=q(Z,ba[oa+ya],ya)}}x!==G&&Da(x,ba.length,da.length);return x}function xa(x,G,K,W){let Z=0,ba=x[W*G],da=
x[W*(G+1)];for(let ia=1;ia<K;ia++){const ka=ba+x[W*(G+ia)],ra=da+x[W*(G+ia)+1],oa=(ka-ba)*(ra+da);ba=ka;da=ra;Z+=oa}return.5*Z}function Da(x,G=0,K=0){Ia(x.lengths,K);Ia(x.coords,G)}function Ia(x,G=0){x.length!==G&&(x.length=G)}const Pa=B.getLogger("esri.layers.graphics.featureConversionUtils"),Na={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},Sa=(x,G,K,W,Z,ba)=>{x[K]=Z;x[K+1]=ba},Va=(x,G,K,W,Z,ba)=>{x[K]=Z;x[K+1]=ba;x[K+2]=G[W+2]},
h=(x,G,K,W,Z,ba)=>{x[K]=Z;x[K+1]=ba;x[K+2]=G[W+3]},D=(x,G,K,W,Z,ba)=>{x[K]=Z;x[K+1]=ba;x[K+2]=G[W+2];x[K+3]=G[W+3]},X=[],aa=[],ha={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};d.convertFromFeature=function(x,G,K,W,Z){X[0]=x;[x]=la(aa,X,G,K,W,Z);Ia(X);Ia(aa);return x};d.convertFromFeatureSet=function(x,G){const K=new g,{hasM:W,hasZ:Z,features:ba,objectIdFieldName:da,spatialReference:ia,geometryType:ka,exceededTransferLimit:ra,transform:oa,fields:qa}=x;qa&&(K.fields=qa);K.geometryType=
ka??null;K.objectIdFieldName=da??G??null;K.spatialReference=ia??null;if(!K.objectIdFieldName)return Pa.error(new e("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),K;ba&&la(K.features,ba,ka,Z,W,K.objectIdFieldName);ra&&(K.exceededTransferLimit=ra);W&&(K.hasM=W);Z&&(K.hasZ=Z);oa&&(K.transform=oa);return K};d.convertFromFeatures=la;d.convertFromGeometry=function(x,G,K){if(null==x)return null;const W=new p;"hasZ"in x&&null==G&&(G=x.hasZ);"hasM"in x&&null==K&&(K=x.hasM);
if(f.isPoint(x))return H(null!=G?G:null!=x.z,null!=K?K:null!=x.m)(W,x);if(f.isPolygon(x))return Y(W,x,G,K);if(f.isPolyline(x))return J(W,x,w(G,K));if(f.isMultipoint(x))return O(W,x,w(G,K));Pa.error("convertFromGeometry:unknown-geometry",new e(`Unable to parse unknown geometry type '${x}'`))};d.convertFromGraphics=function(x,G,K,W,Z,ba){const da=x.length;switch(K){case "esriGeometryPoint":Q(x,G,W,Z,ba);break;case "esriGeometryMultipoint":l(x,G,W,Z,ba);break;case "esriGeometryPolyline":u(x,G,W,Z,ba);
break;case "esriGeometryPolygon":U(x,G,W,Z,ba);break;default:Pa.error("convertToFeatureSet:unknown-geometry",new e(`Unable to parse unknown geometry type '${K}'`))}for(W=0;W<G.length;W++)x[W+da].geometryType=K,x[W+da].insertAfter=G[W].insertAfter,x[W+da].groupId=G[W].groupId;return x};d.convertFromMultipoint=O;d.convertFromMultipointFeatures=l;d.convertFromNestedArray=ea;d.convertFromPoint=function(x,G,K=H(null!=G.z,null!=G.m)){return K(x,G)};d.convertFromPointFeatures=Q;d.convertFromPolygon=Y;d.convertFromPolyline=
J;d.convertFromPolylineFeatures=u;d.convertToFeature=function(x,G,K,W){aa[0]=x;ta(X,aa,G,K,W);x=X[0];Ia(X);Ia(aa);return x};d.convertToFeatureSet=function(x){const {objectIdFieldName:G,spatialReference:K,transform:W,fields:Z,hasM:ba,hasZ:da,features:ia,geometryType:ka,exceededTransferLimit:ra,uniqueIdField:oa,queryGeometry:qa,queryGeometryType:Ca}=x;x=ta([],ia,ka,da,ba);const wa=na(qa,Ca,!1,!1);x={features:x,fields:Z,geometryType:ka,objectIdFieldName:G,spatialReference:K,uniqueIdField:oa,queryGeometry:wa};
W&&(x.transform=W);ra&&(x.exceededTransferLimit=ra);ba&&(x.hasM=ba);da&&(x.hasZ=da);return x};d.convertToFeatures=ta;d.convertToGeometry=na;d.convertToMultipoint=T;d.convertToMultipointFeatures=N;d.convertToPoint=function(x,G,K){return x?G?K?A(x):y(x):K?S(x):a(x):null};d.convertToPolygon=L;d.convertToPolyline=m;d.deltaDecodeGeometry=function(x,G){if(null==x)return null;const K=x.clone(),W=x.coords;x=x.lengths;let Z=0;for(let ia=0;ia<x.length;ia++){const ka=x[ia];var ba=W[G*Z],da=W[G*Z+1];for(let ra=
1;ra<ka;ra++)ba+=W[G*(Z+ra)],da+=W[G*(Z+ra)+1],K.coords[G*(Z+ra)]=ba,K.coords[G*(Z+ra)+1]=da;Z+=ka}return K};d.deltaEncodeGeometry=function(x,G){const K=x.clone(),W=x.coords;x=x.lengths;let Z=0;for(let da=0;da<x.length;da++){const ia=x[da];let ka=W[G*Z];var ba=W[G*Z+1];for(let ra=1;ra<ia;ra++){const oa=W[G*(Z+ra)],qa=W[G*(Z+ra)+1];ba=qa-ba;K.coords[G*(Z+ra)]=oa-ka;K.coords[G*(Z+ra)+1]=ba;ka=oa;ba=qa}Z+=ia}return K};d.generalizeOptimizedGeometry=function(x,G,K,W,Z,ba,da=K,ia=W){Da(x);if(!G?.coords.length)return null;
Z=Na[Z];const {coords:ka,lengths:ra}=G;G=w(K,W);const oa=w(K&&da,W&&ia);K=I(K,W,da,ia);if(!ra.length)return K(x.coords,ka,0,0,ka[0],ka[1]),Da(x,G,0),x;W=0;ba*=ba;for(const qa of ra){if(qa<Z){W+=qa*G;continue}da=x.coords.length/oa;ia=W;const Ca=W+(qa-1)*G;K(x.coords,ka,x.coords.length,ia,ka[ia],ka[ia+1]);sa(x.coords,ka,G,ba,K,ia,Ca);K(x.coords,ka,x.coords.length,Ca,ka[Ca],ka[Ca+1]);ia=x.coords.length/oa-da;ia>=Z?x.lengths.push(ia):Ia(x.coords,da*oa);W+=qa*G}return x.coords.length?x:null};d.getBoundsOptimizedGeometry=
function(x,G,K,W){if(!G?.coords?.length)return null;K=w(K,W);let Z=W=Number.POSITIVE_INFINITY,ba=Number.NEGATIVE_INFINITY,da=Number.NEGATIVE_INFINITY;if(G&&G.coords){G=G.coords;for(let ia=0;ia<G.length;ia+=K){const ka=G[ia],ra=G[ia+1];W=Math.min(W,ka);ba=Math.max(ba,ka);Z=Math.min(Z,ra);da=Math.max(da,ra)}}M.is(x)?M.fromRectValues(x,W,Z,ba,da):n.fromValues(W,Z,ba,da,x);return x};d.getQuantizedArea=function(x,G){const {coords:K,lengths:W}=x;let Z=x=0;for(let ba=0;ba<W.length;ba++){const da=W[ba];Z+=
xa(K,x,da,G);x+=da}return Math.abs(Z)};d.getQuantizedBoundsOptimizedGeometry=function(x,G,K,W){K=w(K,W);const {lengths:Z,coords:ba}=G;W=G=Number.POSITIVE_INFINITY;let da=Number.NEGATIVE_INFINITY,ia=Number.NEGATIVE_INFINITY,ka=0;for(const ra of Z){let oa=ba[ka],qa=ba[ka+1];G=Math.min(oa,G);W=Math.min(qa,W);da=Math.max(oa,da);ia=Math.max(qa,ia);ka+=K;for(let Ca=1;Ca<ra;Ca++,ka+=K){const wa=ba[ka],Ba=ba[ka+1];oa+=wa;qa+=Ba;0>wa&&(G=Math.min(G,oa));0<wa&&(da=Math.max(da,oa));0>Ba?W=Math.min(W,qa):0<Ba&&
(ia=Math.max(ia,qa))}}x[0]=G;x[1]=W;x[2]=da;x[3]=ia;return x};d.getSignedQuantizedRingArea=xa;d.quantizeOptimizedFeatureSet=function(x,G){const {geometryType:K,features:W,hasM:Z,hasZ:ba}=G;if(!x)return G;for(let da=0;da<W.length;da++){const ia=W[da],ka=ia.weakClone();ka.geometry=new p;ua(ka.geometry,ia.geometry,Z,ba,K,x);ia.centroid&&(ka.centroid=new p,ua(ka.centroid,ia.centroid,Z,ba,"esriGeometryPoint",x));W[da]=ka}G.transform=x;return G};d.quantizeOptimizedGeometry=ua;d.quantizeX=E;d.quantizeY=
t;d.removeCollinearVectices=function(x,G,K,W,Z){if(!G?.coords?.length)return null;K=Na[K];const {coords:ba,lengths:da}=G;G=I(W,Z,W,Z);W=w(W,Z);let ia=Z=0,ka=0,ra=0;for(const Ca of da){ia=ra;G(x.coords,ba,ia,Z,ba[Z],ba[Z+1]);Z+=W;var oa=ba[Z];let wa=ba[Z+1],Ba=oa,Aa=wa;var qa=wa/oa;ia+=W;G(x.coords,ba,ia,Z,Ba,Aa);Z+=W;for(let ya=2;ya<Ca;ya++){oa=ba[Z];wa=ba[Z+1];const Ha=wa/oa,Qa=qa===Ha||!isFinite(qa)&&!isFinite(Ha);qa=Qa&&isFinite(Ha)?0<=qa&&0<=Ha||0>=qa&&0>=Ha:0<=Aa&&0<=wa||0>=Aa&&0>=wa;Qa&&qa?
(Ba+=oa,Aa+=wa):(Ba=oa,Aa=wa,ia+=W);G(x.coords,ba,ia,Z,Ba,Aa);Z+=W;qa=Ha}ia+=W;oa=(ia-ra)/W;oa>=K&&(x.lengths[ka]=oa,ra=ia,ka++)}x.coords.length>ra&&(x.coords.length=ra);x.lengths.length>ka&&(x.lengths.length=ka);return x.coords.length&&x.lengths.length?x:null};d.removeZMValues=function(x,G,K,W,Z,ba){Da(x);x.lengths.push(...G.lengths);if(K===Z&&W===ba)for(var da=0;da<G.coords.length;da++)x.coords.push(G.coords[da]);else for(da=w(K,W),K=I(K,W,Z,ba),G=G.coords,W=0;W<G.length;W+=da)K(x.coords,G,x.coords.length,
W,G[W],G[W+1]);return x};d.unquantizeOptimizedFeatureSet=function(x){const {transform:G,features:K,hasM:W,hasZ:Z}=x;if(!G)return x;for(const ba of K)null!=ba.geometry&&va(ba.geometry,ba.geometry,W,Z,G),null!=ba.centroid&&va(ba.centroid,ba.centroid,W,Z,G);x.transform=null;return x};d.unquantizeOptimizedGeometry=va;d.unquantizeValue=q;d.unquantizeX=function(x,G){return q(x,G,0)};d.unquantizeY=function(x,G){return q(x,-G,1)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports",
"../Extent","./aaBoundingRect"],function(d,e,B){function z(q=E){return[q[0],q[1],q[2],q[3],q[4],q[5]]}function M(q,a,r,y,F,S,b=z()){b[0]=q;b[1]=a;b[2]=r;b[3]=y;b[4]=F;b[5]=S;return b}function n(q){return q[0]>=q[3]?0:q[3]-q[0]}function f(q){return q[1]>=q[4]?0:q[4]-q[1]}function v(q){return q[2]>=q[5]?0:q[5]-q[2]}function g(q,a){return Math.max(a[0],q[0])<=Math.min(a[3],q[3])&&Math.max(a[1],q[1])<=Math.min(a[4],q[4])&&Math.max(a[2],q[2])<=Math.min(a[5],q[5])}function p(q,a){q[0]=a[0];q[1]=a[1];q[2]=
a[2];q[3]=a[3];q[4]=a[4];q[5]=a[5];return q}function w(q){return 6===q.length}const I=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],E=[0,0,0,0,0,0],t=z();d.allFinite=function(q){for(let a=0;6>a;a++)if(!isFinite(q[a]))return!1;return!0};d.center=function(q,a=[0,0,0]){a[0]=q[0]+n(q)/2;a[1]=q[1]+f(q)/2;a[2]=q[2]+v(q)/2;return a};d.contains=function(q,a){return a[0]>=q[0]&&a[1]>=q[1]&&a[2]>=q[2]&&a[3]<=q[3]&&a[4]<=q[4]&&a[5]<=q[5]};d.containsPoint=function(q,a){return a[0]>=q[0]&&a[1]>=q[1]&&
a[2]>=q[2]&&a[0]<=q[3]&&a[1]<=q[4]&&a[2]<=q[5]};d.containsPointWithMargin=function(q,a,r){return a[0]>=q[0]-r&&a[1]>=q[1]-r&&a[2]>=q[2]-r&&a[0]<=q[3]+r&&a[1]<=q[4]+r&&a[2]<=q[5]+r};d.create=z;d.depth=f;d.diameter=function(q){const a=n(q),r=v(q);q=f(q);return Math.sqrt(a*a+r*r+q*q)};d.empty=function(q){return q?p(q,I):z(I)};d.equals=function(q,a,r){if(null==q||null==a)return q===a;if(!w(q)||!w(a))return!1;if(r)for(let y=0;y<q.length;y++){if(!r(q[y],a[y]))return!1}else for(r=0;r<q.length;r++)if(q[r]!==
a[r])return!1;return!0};d.expandWithAABB=function(q,a){q[0]=Math.min(q[0],a[0]);q[1]=Math.min(q[1],a[1]);q[2]=Math.min(q[2],a[2]);q[3]=Math.max(q[3],a[3]);q[4]=Math.max(q[4],a[4]);q[5]=Math.max(q[5],a[5])};d.expandWithBuffer=function(q,a,r=0,y=a.length/3){let F=q[0],S=q[1],b=q[2],A=q[3],R=q[4],H=q[5];for(let Q=0;Q<y;Q++)F=Math.min(F,a[r+3*Q]),S=Math.min(S,a[r+3*Q+1]),b=Math.min(b,a[r+3*Q+2]),A=Math.max(A,a[r+3*Q]),R=Math.max(R,a[r+3*Q+1]),H=Math.max(H,a[r+3*Q+2]);q[0]=F;q[1]=S;q[2]=b;q[3]=A;q[4]=
R;q[5]=H};d.expandWithNestedArray=function(q,a,r){const y=a.length;let F=q[0],S=q[1],b=q[2],A=q[3],R=q[4],H=q[5];if(r)for(r=0;r<y;r++){var Q=a[r];F=Math.min(F,Q[0]);S=Math.min(S,Q[1]);b=Math.min(b,Q[2]);A=Math.max(A,Q[0]);R=Math.max(R,Q[1]);H=Math.max(H,Q[2])}else for(r=0;r<y;r++)Q=a[r],F=Math.min(F,Q[0]),S=Math.min(S,Q[1]),A=Math.max(A,Q[0]),R=Math.max(R,Q[1]);q[0]=F;q[1]=S;q[2]=b;q[3]=A;q[4]=R;q[5]=H};d.expandWithOffset=function(q,a,r,y){q[0]=Math.min(q[0],q[0]+a);q[3]=Math.max(q[3],q[3]+a);q[1]=
Math.min(q[1],q[1]+r);q[4]=Math.max(q[4],q[4]+r);q[2]=Math.min(q[2],q[2]+y);q[5]=Math.max(q[5],q[5]+y)};d.expandWithRect=function(q,a){q[0]=Math.min(q[0],a[0]);q[1]=Math.min(q[1],a[1]);q[3]=Math.max(q[3],a[2]);q[4]=Math.max(q[4],a[3])};d.expandWithVec3=function(q,a){q[0]=Math.min(q[0],a[0]);q[1]=Math.min(q[1],a[1]);q[2]=Math.min(q[2],a[2]);q[3]=Math.max(q[3],a[0]);q[4]=Math.max(q[4],a[1]);q[5]=Math.max(q[5],a[2])};d.fromExtent=function(q,a=z()){a[0]=q.xmin;a[1]=q.ymin;a[2]=q.hasZ?q.zmin:-Infinity;
a[3]=q.xmax;a[4]=q.ymax;a[5]=q.hasZ?q.zmax:Infinity;return a};d.fromMinMax=function(q,a,r=z()){r[0]=q[0];r[1]=q[1];r[2]=q[2];r[3]=a[0];r[4]=a[1];r[5]=a[2];return r};d.fromRect=function(q,a){q[0]=a[0];q[1]=a[1];q[2]=Number.NEGATIVE_INFINITY;q[3]=a[2];q[4]=a[3];q[5]=Number.POSITIVE_INFINITY;return q};d.fromRectValues=function(q,a,r,y,F){q[0]=a;q[1]=r;q[2]=Number.NEGATIVE_INFINITY;q[3]=y;q[4]=F;q[5]=Number.POSITIVE_INFINITY;return q};d.fromValues=M;d.getMax=function(q,a){a[0]=q[3];a[1]=q[4];a[2]=q[5];
return a};d.getMin=function(q,a){a[0]=q[0];a[1]=q[1];a[2]=q[2];return a};d.height=v;d.intersects=g;d.intersectsClippingArea=function(q,a){return null==a?!0:g(q,a)};d.is=w;d.isPoint=function(q){return 0===n(q)&&0===f(q)&&0===v(q)};d.maximumDimension=function(q){return Math.max(n(q),v(q),f(q))};d.negativeInfinity=I;d.offset=function(q,a,r,y,F=q){F[0]=q[0]+a;F[1]=q[1]+r;F[2]=q[2]+y;F[3]=q[3]+a;F[4]=q[4]+r;F[5]=q[5]+y;return F};d.positiveInfinity=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];
d.scale=function(q,a,r=q){const y=q[0]+n(q)/2,F=q[1]+f(q)/2,S=q[2]+v(q)/2;r[0]=y+(q[0]-y)*a;r[1]=F+(q[1]-F)*a;r[2]=S+(q[2]-S)*a;r[3]=y+(q[3]-y)*a;r[4]=F+(q[4]-F)*a;r[5]=S+(q[5]-S)*a;return r};d.set=p;d.setMax=function(q,a,r=q){r[3]=a[0];r[4]=a[1];r[5]=a[2];r!==q&&(r[0]=q[0],r[1]=q[1],r[2]=q[2]);return q};d.setMin=function(q,a,r=q){r[0]=a[0];r[1]=a[1];r[2]=a[2];r!==q&&(r[3]=q[3],r[4]=q[4],r[5]=q[5]);return r};d.size=function(q,a=[0,0,0]){a[0]=n(q);a[1]=f(q);a[2]=v(q);return a};d.toExtent=function(q,
a){return isFinite(q[2])||isFinite(q[5])?new e({xmin:q[0],xmax:q[3],ymin:q[1],ymax:q[4],zmin:q[2],zmax:q[5],spatialReference:a}):new e({xmin:q[0],xmax:q[3],ymin:q[1],ymax:q[4],spatialReference:a})};d.toRect=function(q,a){a||(a=B.create());a[0]=q[0];a[1]=q[1];a[2]=q[3];a[3]=q[4];return a};d.width=n;d.wrap=function(q,a,r,y,F,S){return M(q,a,r,y,F,S,t)};d.zero=E;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports"],function(d){class e{constructor(z=
null,M={},n,f){this.geometry=z;this.attributes=M;this.centroid=n;this.objectId=f;this.geohashY=this.geohashX=this.displayId=0}weakClone(){const z=new e(this.geometry,this.attributes,this.centroid,this.objectId);z.displayId=this.displayId;z.geohashX=this.geohashX;z.geohashY=this.geohashY;return z}}class B extends e{}d.OptimizedFeature=e;d.OptimizedFeatureWithGeometry=B;d.hasGeometry=function(z){return!!z.geometry?.coords?.length};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class d{constructor(){this.spatialReference=
this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}weakClone(){const e=new d;e.objectIdFieldName=this.objectIdFieldName;e.globalIdFieldName=this.globalIdFieldName;e.geohashFieldName=this.geohashFieldName;e.geometryProperties=this.geometryProperties;e.geometryType=this.geometryType;
e.spatialReference=this.spatialReference;e.hasZ=this.hasZ;e.hasM=this.hasM;e.features=this.features;e.fields=this.fields;e.transform=this.transform;e.exceededTransferLimit=this.exceededTransferLimit;e.uniqueIdField=this.uniqueIdField;e.queryGeometry=this.queryGeometry;e.queryGeometryType=this.queryGeometryType;return e}}return d})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class d{constructor(e=[],B=[],z=!1){this.lengths=e??[];this.coords=B??[];this.hasIndeterminateRingOrder=
z}static fromRect(e){const [B,z,M,n]=e;e=M-B;const f=n-z;return new d([5],[B,z,e,0,0,f,-e,0,0,-f])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((e,B)=>e+B)}forEachVertex(e){let B=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let z=0;z<this.lengths.length;z++){const M=this.lengths[z];for(let n=0;n<M;n++)e(this.coords[2*(n+B)],this.coords[2*(n+B)+1]);B+=M}}clone(e){return e?(e.set(this.coords),new d(this.lengths.slice(),
e,this.hasIndeterminateRingOrder)):new d(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}return d})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),function(d,e,B,z,M,n,f,v,g,p){const w=M.create();
class I{constructor(E){this.geometryInfo=E;this._boundsStore=new v.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new B;this.featureAdapter=p.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let E=0;this._featuresById.forEach(t=>
{null!=t.geometry&&t.geometry.coords&&(E+=t.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:E/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(E){if(null==this.fullBounds)return null;const [t,q,a,r]=this.fullBounds;return{xmin:t,ymin:q,xmax:a,ymax:r,spatialReference:g.cleanFromGeometryEngine(E)}}add(E){this._add(E);this._emitChanged()}addMany(E){for(const t of E)this._add(t);this._emitChanged()}upsertMany(E){E=E.map(t=>this._upsert(t));this._emitChanged();return E.filter(d.isSome)}clear(){this._featuresById.clear();
this._boundsStore.clear();this._emitChanged()}removeById(E){E=this._featuresById.get(E);if(!E)return null;this._remove(E);this._emitChanged();return E}removeManyById(E){this._boundsStore.invalidateIndex();for(const t of E)(E=this._featuresById.get(t))&&this._remove(E);this._emitChanged()}forEachBounds(E,t){for(const q of E)(E=this._boundsStore.get(q.objectId))&&t(M.fromRect(w,E))}getFeature(E){return this._featuresById.get(E)}has(E){return this._featuresById.has(E)}forEach(E){this._featuresById.forEach(t=>
E(t))}forEachInBounds(E,t){this._boundsStore.forEachInBounds(E,q=>{t(this._featuresById.get(q))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex();this._markedIds.clear()}sweep(){let E=!1;this._featuresById.forEach((t,q)=>{this._markedIds.has(q)||(E=!0,this._remove(t))});this._markedIds.clear();E&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(E){if(E){var t=E.objectId;if(null==t)z.getLogger("esri.layers.graphics.data.FeatureStore").error(new e("featurestore:invalid-feature",
"feature id is missing",{feature:E}));else{var q=this._featuresById.get(t);this._markedIds.add(t);if(q){E.displayId=q.displayId;var a=this._boundsStore.get(t);this._boundsStore.delete(t)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(E);E.geometry?.coords?.length?(a=f.getBoundsOptimizedGeometry(null!=a?a:n.create(),E.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=a&&this._boundsStore.set(t,a)):this._boundsStore.set(t,null);this._featuresById.set(t,E)}}}_upsert(E){const t=E?.objectId;
if(null==t)return z.getLogger("esri.layers.graphics.data.FeatureStore").error(new e("featurestore:invalid-feature","feature id is missing",{feature:E})),null;const q=this._featuresById.get(t);if(!q)return this._add(E),E;this._markedIds.add(t);const {geometry:a,attributes:r}=E;for(const y in r)q.attributes[y]=r[y];a&&(q.geometry=a,this._boundsStore.set(t,f.getBoundsOptimizedGeometry(n.create(),a,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return q}_remove(E){if(null!=this.onFeatureRemove)this.onFeatureRemove(E);
const t=E.objectId;this._markedIds.delete(t);this._boundsStore.delete(t);this._featuresById.delete(t);return E}}return I})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],function(d,e,B,z){function M(v,g,p){n.minX=g[0];n.minY=g[1];n.maxX=g[2];n.maxY=g[3];v.search(n,p)}const n={minX:0,minY:0,maxX:0,maxY:0};class f{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=new B.PooledRBush(9,e("esri-csp-restrictions")?v=>({minX:v[0],minY:v[1],maxX:v[2],maxY:v[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const v=Array(this._idByBounds.size);let g=0;this._idByBounds.forEach((p,w)=>{v[g++]=w});this._indexInvalid=!1;this._index.clear();this._index.load(v)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(v=>this._idByBounds.has(v))))),this._boundsToLoad.length=
0)}}get fullBounds(){if(!this._boundsById.size)return null;const v=z.empty();for(const g of this._boundsById.values())g&&(v[0]=Math.min(g[0],v[0]),v[1]=Math.min(g[1],v[1]),v[2]=Math.max(g[2],v[2]),v[3]=Math.max(g[3],v[3]));return v}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(v){const g=this._boundsById.get(v);this._boundsById.delete(v);g&&(this._idByBounds.delete(g),this._indexInvalid||
this._index.remove(g))}forEachInBounds(v,g){this._loadIndex();M(this._index,v,p=>g(this._idByBounds.get(p)))}get(v){return this._boundsById.get(v)}has(v){return this._boundsById.has(v)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(v,g){if(!this._indexInvalid){const p=this._boundsById.get(v);p&&(this._index.remove(p),this._idByBounds.delete(p))}this._boundsById.set(v,g);g&&(this._idByBounds.set(g,v),this._indexInvalid||(this._boundsToLoad.push(g),5E4<
this._boundsToLoad.length&&this._loadIndex()))}}d.BoundsStore=f;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../PooledArray","../../../chunks/quickselect"],function(d,e,B,z){function M(H,Q){n(H,0,H.children.length,Q,H)}function n(H,Q,N,T,l){l||(l=new A([]));l.minX=Infinity;l.minY=Infinity;l.maxX=-Infinity;l.maxY=-Infinity;for(let O=Q,m;O<N;O++)m=H.children[O],f(l,H.leaf?T(m):m);return l}function f(H,
Q){H.minX=Math.min(H.minX,Q.minX);H.minY=Math.min(H.minY,Q.minY);H.maxX=Math.max(H.maxX,Q.maxX);H.maxY=Math.max(H.maxY,Q.maxY)}function v(H,Q){return H.minX-Q.minX}function g(H,Q){return H.minY-Q.minY}function p(H){return(H.maxX-H.minX)*(H.maxY-H.minY)}function w(H){return H.maxX-H.minX+(H.maxY-H.minY)}function I(H,Q){return H.minX<=Q.minX&&H.minY<=Q.minY&&Q.maxX<=H.maxX&&Q.maxY<=H.maxY}function E(H,Q){return Q.minX<=H.maxX&&Q.minY<=H.maxY&&Q.maxX>=H.minX&&Q.maxY>=H.minY}function t(H,Q,N,T,l){for(Q=
[Q,N];Q.length;){N=Q.pop();const O=Q.pop();if(N-O<=T)continue;const m=O+Math.ceil((N-O)/T/2)*T;z.quickselect(H,m,O,N,l);Q.push(O,m,m,N)}}class q{constructor(H=9,Q){this._compareMinX=v;this._compareMinY=g;this._toBBox=N=>N;this._maxEntries=Math.max(4,H||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));Q&&("function"===typeof Q?this._toBBox=Q:this._initFormat(Q));this.clear()}destroy(){this.clear();a.prune();r.prune();y.prune();F.prune()}all(H){this._all(this._data,H)}search(H,Q){let N=
this._data;const T=this._toBBox;if(E(H,N))for(a.clear();N;){for(let l=0,O=N.children.length;l<O;l++){const m=N.children[l],u=N.leaf?T(m):m;E(H,u)&&(N.leaf?Q(m):I(H,u)?this._all(m,Q):a.push(m))}N=a.pop()}}collides(H){let Q=this._data;const N=this._toBBox;if(!E(H,Q))return!1;for(a.clear();Q;){for(let T=0,l=Q.children.length;T<l;T++){const O=Q.children[T],m=Q.leaf?N(O):O;if(E(H,m)){if(Q.leaf||I(H,m))return!0;a.push(O)}}Q=a.pop()}return!1}load(H){if(!H.length)return this;if(H.length<this._minEntries){for(let Q=
0,N=H.length;Q<N;Q++)this.insert(H[Q]);return this}H=this._build(H.slice(0,H.length),0,H.length-1,0);if(this._data.children.length)if(this._data.height===H.height)this._splitRoot(this._data,H);else{if(this._data.height<H.height){const Q=this._data;this._data=H;H=Q}this._insert(H,this._data.height-H.height-1,!0)}else this._data=H;return this}insert(H){H&&this._insert(H,this._data.height-1);return this}clear(){this._data=new A([]);return this}remove(H){if(!H)return this;let Q=this._data,N=null,T=0,
l=!1,O;const m=this._toBBox(H);y.clear();for(F.clear();Q||0<y.length;){Q||(Q=y.pop(),N=y.data[y.length-1],T=F.pop()??0,l=!0);if(Q.leaf&&(O=e.indexOf(Q.children,H,Q.children.length,Q.indexHint),-1!==O)){Q.children.splice(O,1);y.push(Q);this._condense(y);break}l||Q.leaf||!I(Q,m)?N?(T++,Q=N.children[T],l=!1):Q=null:(y.push(Q),F.push(T),T=0,N=Q,Q=Q.children[0])}return this}toJSON(){return this._data}fromJSON(H){this._data=H;return this}_all(H,Q){for(r.clear();H;){if(!0===H.leaf)for(const N of H.children)Q(N);
else r.pushArray(H.children);H=r.pop()??null}}_build(H,Q,N,T){var l=N-Q+1,O=this._maxEntries;if(l<=O)return H=new A(H.slice(Q,N+1)),M(H,this._toBBox),H;T||(T=Math.ceil(Math.log(l)/Math.log(O)),O=Math.ceil(l/O**(T-1)));const m=new R([]);m.height=T;l=Math.ceil(l/O);O=l*Math.ceil(Math.sqrt(O));for(t(H,Q,N,O,this._compareMinX);Q<=N;Q+=O){const u=Math.min(Q+O-1,N);t(H,Q,u,l,this._compareMinY);for(let J=Q;J<=u;J+=l)m.children.push(this._build(H,J,Math.min(J+l-1,u),T-1))}M(m,this._toBBox);return m}_chooseSubtree(H,
Q,N,T){for(;;){T.push(Q);if(!0===Q.leaf||T.length-1===N)break;let l=Infinity,O=Infinity,m=void 0;for(let u=0,J=Q.children.length;u<J;u++){const L=Q.children[u],U=p(L),Y=(Math.max(L.maxX,H.maxX)-Math.min(L.minX,H.minX))*(Math.max(L.maxY,H.maxY)-Math.min(L.minY,H.minY))-U;Y<O?(O=Y,l=U<l?U:l,m=L):Y===O&&U<l&&(l=U,m=L)}Q=m||Q.children[0]}return Q}_insert(H,Q,N){var T=this._toBBox;N=N?H:T(H);y.clear();T=this._chooseSubtree(N,this._data,Q,y);T.children.push(H);for(f(T,N);0<=Q;)if(y.data[Q].children.length>
this._maxEntries)this._split(y,Q),Q--;else break;this._adjustParentBBoxes(N,y,Q)}_split(H,Q){const N=H.data[Q];var T=N.children.length;const l=this._minEntries;this._chooseSplitAxis(N,l,T);(T=this._chooseSplitIndex(N,l,T))?(T=N.children.splice(T,N.children.length-T),T=N.leaf?new A(T):new R(T),T.height=N.height,M(N,this._toBBox),M(T,this._toBBox),Q?H.data[Q-1].children.push(T):this._splitRoot(N,T)):console.log("  Error: assertion failed at PooledRBush._split: no valid split index")}_splitRoot(H,Q){this._data=
new R([H,Q]);this._data.height=H.height+1;M(this._data,this._toBBox)}_chooseSplitIndex(H,Q,N){let T,l,O=void 0;T=l=Infinity;for(let u=Q;u<=N-Q;u++){var m=n(H,0,u,this._toBBox);const J=n(H,u,N,this._toBBox),L=Math.max(0,Math.min(m.maxX,J.maxX)-Math.max(m.minX,J.minX))*Math.max(0,Math.min(m.maxY,J.maxY)-Math.max(m.minY,J.minY));m=p(m)+p(J);L<T?(T=L,O=u,l=m<l?m:l):L===T&&m<l&&(l=m,O=u)}return O}_chooseSplitAxis(H,Q,N){const T=H.leaf?this._compareMinX:v,l=H.leaf?this._compareMinY:g,O=this._allDistMargin(H,
Q,N,T);Q=this._allDistMargin(H,Q,N,l);O<Q&&H.children.sort(T)}_allDistMargin(H,Q,N,T){H.children.sort(T);T=this._toBBox;var l=n(H,0,Q,T);const O=n(H,N-Q,N,T);let m=w(l)+w(O);for(let u=Q;u<N-Q;u++){const J=H.children[u];f(l,H.leaf?T(J):J);m+=w(l)}for(N=N-Q-1;N>=Q;N--)l=H.children[N],f(O,H.leaf?T(l):l),m+=w(O);return m}_adjustParentBBoxes(H,Q,N){for(;0<=N;N--)f(Q.data[N],H)}_condense(H){for(let Q=H.length-1;0<=Q;Q--){const N=H.data[Q];if(0===N.children.length)if(0<Q){const T=H.data[Q-1],l=T.children;
l.splice(e.indexOf(l,N,l.length,T.indexHint),1)}else this.clear();else M(N,this._toBBox)}}_initFormat(H){const Q=["return a"," - b",";"];this._compareMinX=new Function("a","b",Q.join(H[0]));this._compareMinY=new Function("a","b",Q.join(H[1]));this._toBBox=new Function("a","return {minX: a"+H[0]+", minY: a"+H[1]+", maxX: a"+H[2]+", maxY: a"+H[3]+"};")}}const a=new B,r=new B,y=new B,F=new B({deallocator:void 0});class S{constructor(){this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity}}class b extends S{constructor(){super(...arguments);
this.height=1;this.indexHint=new e.PositionHint}}class A extends b{constructor(H){super();this.children=H;this.leaf=!0}}class R extends b{constructor(H){super();this.children=H;this.leaf=!1}}d.BBox=S;d.PooledRBush=q;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports","./_commonjsHelpers"],function(d,e){var B={exports:{}};B.exports;(function(z){(function(M){M=M();void 0!==M&&(z.exports=M)})(function(){function M(v,g,p,w,I){for(;w>p;){if(600<
w-p){var E=w-p+1,t=g-p+1,q=Math.log(E),a=.5*Math.exp(2*q/3);q=.5*Math.sqrt(q*a*(E-a)/E)*(0>t-E/2?-1:1);M(v,g,Math.max(p,Math.floor(g-t*a/E+q)),Math.min(w,Math.floor(g+(E-t)*a/E+q)),I)}E=v[g];t=p;a=w;n(v,p,g);for(0<I(v[w],E)&&n(v,p,w);t<a;){n(v,t,a);t++;for(a--;0>I(v[t],E);)t++;for(;0<I(v[a],E);)a--}0===I(v[p],E)?n(v,p,a):(a++,n(v,a,w));a<=g&&(p=a+1);g<=a&&(w=a-1)}}function n(v,g,p){var w=v[g];v[g]=v[p];v[p]=w}function f(v,g){return v<g?-1:v>g?1:0}return function(v,g,p,w,I){M(v,g,p||0,w||v.length-
1,I||f)}})})(B);e=e.getDefaultExportFromCjs(B.exports);d.quickselect=e})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports","../featureConversionUtils","../OptimizedGeometry"],function(d,e,B){const z=new B,M=new B,n=new B,f={esriGeometryPoint:e.convertToPoint,esriGeometryPolyline:e.convertToPolyline,esriGeometryPolygon:e.convertToPolygon,esriGeometryMultipoint:e.convertToMultipoint},v=(g,p)=>"_geVersion"!==g?p:void 0;d.cleanFromGeometryEngine=function(g){return g&&"_geVersion"in
g?JSON.parse(JSON.stringify(g,v)):g};d.getGeometry=function(g,p,w,I,E,t,q=p,a=w){const r=p&&q,y=w&&a;I=null!=I?"coords"in I?I:I.geometry:null;if(null==I)return null;if(E)return p=e.generalizeOptimizedGeometry(M,I,p,w,g,E,q,a),t&&(p=e.quantizeOptimizedGeometry(n,p,r,y,g,t)),f[g]?.(p,r,y)??null;if(t)return t=e.quantizeOptimizedGeometry(n,I,p,w,g,t,q,a),f[g]?.(t,r,y)??null;e.removeZMValues(z,I,p,w,q,a);return f[g]?.(z,r,y)??null};d.transformCentroid=function(g,p,w,I=g.hasZ,E=g.hasM){if(null==p)return null;
const t=g.hasZ&&I,q=g.hasM&&E;return w?(g=e.quantizeOptimizedGeometry(n,p,g.hasZ,g.hasM,"esriGeometryPoint",w,I,E),e.convertToPoint(g,t,q)):e.convertToPoint(p,t,q)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(d,e,B,z){d.optimizedFeatureQueryEngineAdapter={getObjectId(M){return M.objectId},getAttributes(M){return M.attributes},
getAttribute(M,n){return M.attributes[n]},cloneWithGeometry(M,n){return new B.OptimizedFeature(n,M.attributes,null,M.objectId)},getGeometry(M){return M.geometry},getCentroid(M,n){null==M.centroid&&(M.centroid=e.getCentroidOptimizedGeometry(new z,M.geometry,n.hasZ,n.hasM));return M.centroid}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(d){function e(z,M,n,f,v,g,p=1){g=v?g?4:3:g?3:2;let w=n,I=n+g,E=0,t=0,q=n=
0,a=0;for(let r=0,y=f-1;r<y;r++,w+=g,I+=g){f=M[w];const F=M[w+1],S=M[w+2],b=M[I],A=M[I+1],R=M[I+2];let H=f*A-b*F;q+=H;E+=(f+b)*H;t+=(F+A)*H;v&&(H=f*R-b*S,n+=(S+R)*H,a+=H);f<z[0]&&(z[0]=f);f>z[1]&&(z[1]=f);F<z[2]&&(z[2]=F);F>z[3]&&(z[3]=F);v&&(S<z[4]&&(z[4]=S),S>z[5]&&(z[5]=S))}0<q*p&&(q*=-1);0<a*p&&(a*=-1);if(!q)return null;z=[E,t,.5*q];v&&(z[3]=n,z[4]=.5*a);return z}function B(z,M,n,f,v){v=f?v?4:3:v?3:2;let g=M,p=M+v,w=0,I=0,E=0,t=0;for(let y=0,F=n-1;y<F;y++,g+=v,p+=v){var q=z[g];const S=z[g+1],
b=z[g+2],A=z[p],R=z[p+1],H=z[p+2];if(f){var a=A-q;var r=R-S;const Q=H-b;a=Math.sqrt(a*a+r*r+Q*Q)}else a=A-q,r=R-S,a=Math.sqrt(a*a+r*r);a&&(w+=a,f?(q=[q+.5*(A-q),S+.5*(R-S),b+.5*(H-b)],I+=a*q[0],E+=a*q[1],t+=a*q[2]):(q=[q+.5*(A-q),S+.5*(R-S)],I+=a*q[0],E+=a*q[1]))}return 0<w?f?[I/w,E/w,t/w]:[I/w,E/w]:0<n?f?[z[M],z[M+1],z[M+2]]:[z[M],z[M+1]]:null}d.getCentroidOptimizedGeometry=function(z,M,n,f,v){if(!M?.lengths.length)return null;const g="upperLeft"===v?.originPosition?-1:1;z.lengths.length&&(z.lengths.length=
0);z.coords.length&&(z.coords.length=0);v=z.coords;const p=[],w=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:I,coords:E}=M,t=n?f?4:3:f?3:2;let q=0;for(var a of I){const r=e(w,E,q,a,n,f,g);r&&p.push(r);q+=a*t}p.sort((r,y)=>{let F=g*r[2]-g*y[2];0===F&&n&&(F=r[4]-y[4]);return F});p.length&&
(a=6*p[0][2],v[0]=p[0][0]/a,v[1]=p[0][1]/a,n&&(a=6*p[0][4],v[2]=0!==a?p[0][3]/a:0),v[0]<w[0]||v[0]>w[1]||v[1]<w[2]||v[1]>w[3]||n&&(v[2]<w[4]||v[2]>w[5]))&&(v.length=0);if(!v.length)if(M=M.lengths[0]?B(E,0,I[0],n,f):null)v[0]=M[0],v[1]=M[1],n&&2<M.length&&(v[2]=M[2]);else return null;return z};d.lineCentroid=B;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(d,e,B,z,M,n,f){function v(a,r){if(!r)return null;if("x"in r){var y={x:0,y:0};[y.x,y.y]=a(r.x,r.y,w);null!=r.z&&(y.z=r.z);null!=r.m&&(y.m=r.m);return y}return"xmin"in r?(y={xmin:0,ymin:0,xmax:0,ymax:0},[y.xmin,y.ymin]=a(r.xmin,r.ymin,w),[y.xmax,y.ymax]=a(r.xmax,r.ymax,w),r.hasZ&&(y.zmin=r.zmin,y.zmax=r.zmax,y.hasZ=!0),r.hasM&&(y.mmin=r.mmin,y.mmax=r.mmax,y.hasM=!0),y):"rings"in r?{rings:g(r.rings,a),hasM:r.hasM,hasZ:r.hasZ}:"paths"in r?{paths:g(r.paths,a),hasM:r.hasM,hasZ:r.hasZ}:"points"in
r?{points:p(r.points,a),hasM:r.hasM,hasZ:r.hasZ}:null}function g(a,r){const y=[];for(const F of a)y.push(p(F,r));return y}function p(a,r){const y=[];for(const F of a)a=r(F[0],F[1],[0,0]),y.push(a),2<F.length&&a.push(F[2]),3<F.length&&a.push(F[3]);return y}const w=[0,0],I=v.bind(null,f.lngLatToXY),E=v.bind(null,f.xyToLngLat);class t{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(a,r,y,F){if(!a?.length||!r||!y||n.equals(r,y))return a;a={geometries:a,inSpatialReference:r,
outSpatialReference:y,geographicTransformation:F,resolve:B.createResolver()};this._jobs.push(a);this._timer??(this._timer=setTimeout(this._process,10));return a.resolve.promise}_process(){this._timer=null;const a=this._jobs.shift();if(a){var {geometries:r,inSpatialReference:y,outSpatialReference:F,resolve:S,geographicTransformation:b}=a;f.canProject(y,F)?n.isWebMercator(F)?S(r.map(I)):S(r.map(E)):S(z.projectMany(M.jsonAdapter,r,y,F,b,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,
10))}}}const q=new t;d.checkProjectionSupport=async function(a,r){a&&r&&(a=Array.isArray(a)?a.map(y=>null!=y.geometry?y.geometry.spatialReference:null).filter(e.isSome):[a],await z.initializeProjection(a.map(y=>({source:y,dest:r}))))};d.project=function(a,r,y,F){if(!a)return a;y||(y=r,r=a.spatialReference);return n.isValid(r)&&n.isValid(y)&&!n.equals(r,y)?f.canProject(r,y)?(a=n.isWebMercator(y)?I(a):E(a),a.spatialReference=y,a):z.projectMany(M.jsonAdapter,[a],r,y,null,F)[0]:a};d.projectMany=function(a,
r,y,F){return q.push(a,r,y,F)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(d){class e{constructor(f,v,g){this.x=f;this.y=v;this.spatialReference=g;this.m=this.z=void 0}}class B{constructor(f,v,g,p){this.rings=f;this.spatialReference=v;this.hasM=this.hasZ=void 0;g&&(this.hasZ=g);p&&(this.hasM=p)}}class z{constructor(f,v,g,p){this.paths=f;this.spatialReference=v;this.hasM=this.hasZ=void 0;g&&(this.hasZ=
g);p&&(this.hasM=p)}}class M{constructor(f,v,g,p){this.points=f;this.spatialReference=v;this.hasM=this.hasZ=void 0;g&&(this.hasZ=g);p&&(this.hasM=p)}}class n{constructor(f,v,g,p,w){this.xmin=f;this.ymin=v;this.xmax=g;this.ymax=p;this.spatialReference=w;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}d.jsonAdapter={convertToGEGeometry:function(f,v){return null==v?null:f.convertJSONToGeometry(v)},exportPoint:function(f,v,g){g=new e(f.getPointX(v),f.getPointY(v),g);const p=f.hasZ(v),w=f.hasM(v);p&&(g.z=
f.getPointZ(v));w&&(g.m=f.getPointM(v));return g},exportPolygon:function(f,v,g){return new B(f.exportPaths(v),g,f.hasZ(v),f.hasM(v))},exportPolyline:function(f,v,g){return new z(f.exportPaths(v),g,f.hasZ(v),f.hasM(v))},exportMultipoint:function(f,v,g){return new M(f.exportPoints(v),g,f.hasZ(v),f.hasM(v))},exportExtent:function(f,v,g){var p=f.hasZ(v);const w=f.hasM(v);g=new n(f.getXMin(v),f.getYMin(v),f.getXMax(v),f.getYMax(v),g);p&&(p=f.getZExtent(v),g.zmin=p.vmin,g.zmax=p.vmax);w&&(f=f.getMExtent(v),
g.mmin=f.vmin,g.mmax=f.vmax);return g}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w,I,E,t,q,a,r,y,F,S,b,A,R,H,Q,N,T,l){class O{constructor(L,U=null,Y,ea,la){this.attributes=L;this.geometry=Y;this.centroid=ea;this.filterFlags=la;this.groupId=-1;this.displayId=U}}const m=new f.MemCacheStorage(2E6);let u=0;class J{constructor(L){this._changeHandle=this._geometryQueryCache=null;this.capabilities={query:b.queryCapabilities};this.geometryType=L.geometryType;this.hasM=!!L.hasM;this.hasZ=!!L.hasZ;this.objectIdField=L.objectIdField;this.spatialReference=L.spatialReference;
this.definitionExpression=L.definitionExpression;this.featureStore=L.featureStore;this.aggregateAdapter=L.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=L.timeInfo;L.cacheSpatialQueries&&(this._geometryQueryCache=new f.MemCache(u++ +"$$",m));this.fieldsIndex=z.isSerializable(L.fieldsIndex)?L.fieldsIndex:T.fromJSON(L.fieldsIndex);this.availableFields=null==L.availableFields?new Set(this.fieldsIndex.fields.map(U=>U.name)):new Set(L.availableFields.map(U=>
this.fieldsIndex.get(U)?.name).filter(U=>null!=U));L.scheduler&&L.priority&&(this._frameTask=L.scheduler.registerTask(L.priority))}destroy(){this._frameTask=n.removeMaybe(this._frameTask);this.clearCache();n.destroyMaybe(this._geometryQueryCache);this._changeHandle=n.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._geometryQueryCache?.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(L,
U){try{return(await this._executeQuery(L,{},U)).createQueryResponse()}catch(Y){if(Y!==R.queryEngineEmptyResult)throw Y;return(new A.QueryEngineResult([],L,this)).createQueryResponse()}}async executeQueryForCount(L={},U){try{return(await this._executeQuery(L,{returnGeometry:!1,returnCentroid:!1,outSR:null},U)).createQueryResponseForCount()}catch(Y){if(Y!==R.queryEngineEmptyResult)throw Y;return 0}}async executeQueryForExtent(L,U){const Y=L.outSR;try{const ea=await this._executeQuery(L,{returnGeometry:!0,
returnCentroid:!1,outSR:null},U),la=ea.size;if(!la)return{count:0,extent:null};const na=await this._getBounds(ea.items,ea.spatialReference,Y||this.spatialReference);return{count:la,extent:na}}catch(ea){if(ea===R.queryEngineEmptyResult)return{count:0,extent:null};throw ea;}}async executeQueryForIds(L,U){return this.executeQueryForIdSet(L,U).then(Y=>Array.from(Y))}async executeQueryForIdSet(L,U){try{const Y=await this._executeQuery(L,{returnGeometry:!0,returnCentroid:!1,outSR:null},U),ea=Y.items,la=
new Set;await this._reschedule(()=>{for(const na of ea)la.add(Y.featureAdapter.getObjectId(na))},U);return la}catch(Y){if(Y===R.queryEngineEmptyResult)return new Set;throw Y;}}async executeQueryForSnapping(L,U){const {point:Y,distance:ea,returnEdge:la,vertexMode:na}=L;if(!la&&"none"===na)return{candidates:[]};let ta=M.clone(L.query);ta=await this._schedule(()=>R.normalizeQueryLike(ta,this.definitionExpression,this.spatialReference),U);ta=await this._reschedule(()=>H.validateQuery(ta,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),U);const ua=!a.equals(Y.spatialReference,this.spatialReference);ua&&await S.checkProjectionSupport(Y.spatialReference,this.spatialReference);var sa="number"===typeof ea?ea:ea.x,va="number"===typeof ea?ea:ea.y;sa={xmin:Y.x-sa,xmax:Y.x+sa,ymin:Y.y-va,ymax:Y.y+va,spatialReference:Y.spatialReference};sa=ua?S.project(sa,this.spatialReference):sa;if(!sa)return{candidates:[]};va=(await q.normalizeCentralMeridian(t.fromJSON(Y),
null,{signal:U}))[0];const xa=(await q.normalizeCentralMeridian(t.fromJSON(sa),null,{signal:U}))[0];if(null==va||null==xa)return{candidates:[]};const Da=new A.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(xa.toJSON())),U),ta,this);await this._reschedule(()=>this._executeObjectIdsQuery(Da),U);await this._reschedule(()=>this._executeTimeQuery(Da),U);await this._reschedule(()=>this._executeAttributesQuery(Da),U);await this._reschedule(()=>this._executeGeometryQueryForSnapping(Da,
U),U);va=va.toJSON();va=ua?S.project(va,this.spatialReference):va;return Da.createSnappingResponse({...L,point:va,distance:ua?Math.max(sa.xmax-sa.xmin,sa.ymax-sa.ymin)/2:ea},Y.spatialReference)}async executeQueryForLatestObservations(L,U){if(!this.timeInfo?.trackIdField)throw new B("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:L,timeInfo:this.timeInfo});try{const Y=await this._executeQuery(L,{},U);await this._reschedule(()=>this._filterLatest(Y),U);return Y.createQueryResponse()}catch(Y){if(Y!==
R.queryEngineEmptyResult)throw Y;return(new A.QueryEngineResult([],L,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(L={},U,Y){const {field:ea,normalizationField:la,valueExpression:na}=U;return(await this._executeQueryForStatistics(L,{field:ea,normalizationField:la,valueExpression:na},Y)).createSummaryStatisticsResponse(U)}async executeQueryForUniqueValues(L={},U,Y){const {field:ea,field2:la,field3:na,valueExpression:ta}=U;return(await this._executeQueryForStatistics(L,{field:ea,
field2:la,field3:na,valueExpression:ta},Y)).createUniqueValuesResponse(U)}async executeQueryForClassBreaks(L={},U,Y){const {field:ea,normalizationField:la,valueExpression:na}=U;return(await this._executeQueryForStatistics(L,{field:ea,normalizationField:la,valueExpression:na},Y)).createClassBreaksResponse(U)}async executeQueryForHistogram(L={},U,Y){const {field:ea,normalizationField:la,valueExpression:na}=U;return(await this._executeQueryForStatistics(L,{field:ea,normalizationField:la,valueExpression:na},
Y)).createHistogramResponse(U)}async fetchRecomputedExtents(L){this._timeExtentPromise||(this._timeExtentPromise=N.getTimeExtent(this.timeInfo,this.featureStore));const [U,Y]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);v.throwIfAborted(L);return{fullExtent:U,timeExtent:Y}}async _getBounds(L,U,Y){const ea=w.set(w.create(),w.negativeInfinity);await this.featureStore.forEachBounds(L,la=>w.expandWithAABB(ea,la));L={xmin:ea[0],ymin:ea[1],xmax:ea[3],ymax:ea[4],spatialReference:F.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(ea[2])&&isFinite(ea[5])&&(L.zmin=ea[2],L.zmax=ea[5]);U=S.project(L,U,Y);U.spatialReference=F.cleanFromGeometryEngine(Y);0===U.xmax-U.xmin&&(Y=g.getMetersPerUnitForSR(U.spatialReference),U.xmin-=Y,U.xmax+=Y);0===U.ymax-U.ymin&&(Y=g.getMetersPerUnitForSR(U.spatialReference),U.ymin-=Y,U.ymax+=Y);this.hasZ&&null!=U.zmin&&null!=U.zmax&&0===U.zmax-U.zmin&&(Y=g.getMetersPerUnitForSR(U.spatialReference),U.zmin-=Y,U.zmax+=Y);return U}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise=
"getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(L=>this._getBounds(L,this.spatialReference,this.spatialReference)));return this._fullExtentPromise}async _schedule(L,U){return null!=this._frameTask?this._frameTask.schedule(L,U):L(l.noBudget)}async _reschedule(L,U){return null!=this._frameTask?this._frameTask.reschedule(L,U):L(l.noBudget)}async _getAllFeaturesQueryEngineResult(L){return new A.QueryEngineResult(await this._getAllFeatures(),
L,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const Y=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(ea=>Y.push(ea))})().then(()=>Y)}const L=this._allFeaturesPromise,U=await L;return L===this._allFeaturesPromise?U.slice():this._getAllFeatures()}async _executeQuery(L,U,Y){L=M.clone(L);L=await this._schedule(()=>R.normalizeQuery(L,this.definitionExpression,this.spatialReference),Y);L=await this._reschedule(()=>H.validateQuery(L,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Y);L={...L,...U};const ea=await this._reschedule(()=>this._executeSceneFilterQuery(L,Y),Y),la=await this._reschedule(()=>this._executeGeometryQuery(L,ea,Y),Y);await this._reschedule(()=>this._executeAggregateIdsQuery(la),Y);await this._reschedule(()=>this._executeObjectIdsQuery(la),Y);await this._reschedule(()=>this._executeTimeQuery(la),Y);await this._reschedule(()=>this._executeAttributesQuery(la),
Y);return la}async _executeSceneFilterQuery(L,U){if(null==L.sceneFilter)return null;const {outSR:Y,returnGeometry:ea,returnCentroid:la}=L;var na=this.featureStore.featureSpatialReference,ta=L.sceneFilter.geometry;const ua=null==na||a.equals(na,ta.spatialReference)?ta:S.project(ta,na);if(!ua)return null;na=ea||la;na=a.isValid(Y)&&!a.equals(this.spatialReference,Y)&&na?async Da=>this._project(Da,Y):Da=>Da;const sa=this.featureAdapter;ta=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(ua)),
U);if("disjoint"===L.sceneFilter.spatialRelationship){if(!ta.length)return null;const Da=new Set;for(var va of ta)Da.add(sa.getObjectId(va));const Ia=await this._reschedule(()=>this._getAllFeatures(),U);va=await this._reschedule(async()=>{const Pa=await Q.getSpatialQueryOperator("esriSpatialRelDisjoint",ua,this.geometryType,this.hasZ,this.hasM),Na=await this._runSpatialFilter(Ia,Sa=>!Da.has(sa.getObjectId(Sa))||Pa(sa.getGeometry(Sa)),U);return new A.QueryEngineResult(Na,L,this)},U);return na(va)}if(!ta.length)return new A.QueryEngineResult([],
L,this);if(this._canExecuteSinglePass(ua,L))return na(new A.QueryEngineResult(ta,L,this));const xa=await Q.getSpatialQueryOperator("esriSpatialRelContains",ua,this.geometryType,this.hasZ,this.hasM);va=await this._runSpatialFilter(ta,Da=>xa(sa.getGeometry(Da)),U);return na(new A.QueryEngineResult(va,L,this))}async _executeGeometryQuery(L,U,Y){if(null!=U&&0===U.items.length)return U;L=null!=U?U.query:L;const {geometry:ea,outSR:la,spatialRel:na,returnGeometry:ta,returnCentroid:ua}=L;var sa=this.featureStore.featureSpatialReference;
const va=!ea||null==sa||a.equals(sa,ea.spatialReference)?ea:S.project(ea,sa),xa=ta||ua,Da=a.isValid(la)&&!a.equals(this.spatialReference,la),Ia=this._geometryQueryCache&&null==U?Da&&xa?JSON.stringify({originalFilterGeometry:ea,spatialRelationship:na,outSpatialReference:la}):JSON.stringify({originalFilterGeometry:ea,spatialRelationship:na}):null;sa=Ia?this._geometryQueryCache.get(Ia):null;if(null!=sa)return new A.QueryEngineResult(sa,L,this);sa=async h=>{Da&&xa&&await this._project(h,la);Ia&&this._geometryQueryCache.put(Ia,
h.items,h.items.length+1);return h};if(!va)return sa(null!=U?U:await this._getAllFeaturesQueryEngineResult(L));const Pa=this.featureAdapter;let Na=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(ea)),Y);if("esriSpatialRelDisjoint"===na){if(!Na.length)return sa(null!=U?U:await this._getAllFeaturesQueryEngineResult(L));const h=new Set;for(var Sa of Na)h.add(Pa.getObjectId(Sa));const D=null!=U?U.items:await this._reschedule(()=>this._getAllFeatures(),Y);Sa=await this._reschedule(async()=>
{const X=await Q.getSpatialQueryOperator(na,va,this.geometryType,this.hasZ,this.hasM),aa=await this._runSpatialFilter(D,ha=>!h.has(Pa.getObjectId(ha))||X(Pa.getGeometry(ha)),Y);return new A.QueryEngineResult(aa,L,this)},Y);return sa(Sa)}if(null!=U){const h=new e.PositionHint;Na=Na.filter(D=>0<=e.indexOf(U.items,D,U.items.length,h))}if(!Na.length)return sa=new A.QueryEngineResult([],L,this),Ia&&this._geometryQueryCache.put(Ia,sa.items,1),sa;if(this._canExecuteSinglePass(va,L))return sa(new A.QueryEngineResult(Na,
L,this));const Va=await Q.getSpatialQueryOperator(na,va,this.geometryType,this.hasZ,this.hasM);Sa=await this._runSpatialFilter(Na,h=>Va(Pa.getGeometry(h)),Y);return sa(new A.QueryEngineResult(Sa,L,this))}async _executeGeometryQueryForSnapping(L,U){const {query:Y}=L,{spatialRel:ea}=Y;if(L?.items?.length&&Y.geometry&&ea){var la=await Q.getSpatialQueryOperator(ea,Y.geometry,this.geometryType,this.hasZ,this.hasM);U=await this._runSpatialFilter(L.items,na=>la(na.geometry),U);L.items=U}}_executeAggregateIdsQuery(L){if(0!==
L.items.length&&L.query.aggregateIds?.length&&null!=this.aggregateAdapter){var U=new Set;for(const ea of L.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(ea).forEach(la=>U.add(la));var Y=this.featureAdapter.getObjectId;L.items=L.items.filter(ea=>U.has(Y(ea)))}}_executeObjectIdsQuery(L){if(0!==L.items.length&&L.query.objectIds?.length){var U=new Set(L.query.objectIds),Y=this.featureAdapter.getObjectId;L.items=L.items.filter(ea=>U.has(Y(ea)))}}_executeTimeQuery(L){if(0!==L.items.length){var U=
N.getTimeOperator(this.timeInfo,L.query.timeExtent,this.featureAdapter);null!=U&&(L.items=L.items.filter(U))}}_executeAttributesQuery(L){if(0!==L.items.length){var U=y.getWhereClause(L.query.where,this.fieldsIndex);if(U){if(!U.isStandardized)throw new TypeError("Where clause is not standardized");L.items=L.items.filter(Y=>U.testFeature(Y,this.featureAdapter))}}}async _runSpatialFilter(L,U,Y){if(!U)return L;if(null==this._frameTask)return L.filter(ta=>U(ta));let ea=0;const la=[],na=async ta=>{for(;ea<
L.length;){const ua=L[ea++];U(ua)&&(la.push(ua),ta.madeProgress());ta.done&&await this._reschedule(sa=>na(sa),Y)}};return this._reschedule(ta=>na(ta),Y).then(()=>la)}_filterLatest(L){const {trackIdField:U,startTimeField:Y,endTimeField:ea}=this.timeInfo,la=ea||Y,na=new Map,ta=this.featureAdapter.getAttribute;for(const ua of L.items){const sa=ta(ua,U),va=ta(ua,la),xa=na.get(sa);(!xa||va>ta(xa,la))&&na.set(sa,ua)}L.items=Array.from(na.values())}_canExecuteSinglePass(L,U){({spatialRel:U}=U);return Q.canQueryWithRBush(L)&&
("esriSpatialRelEnvelopeIntersects"===U||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===U||"esriSpatialRelContains"===U))}async _project(L,U){if(!U||a.equals(this.spatialReference,U))return L;const Y=this.featureAdapter;let ea=void 0;try{const la=await this._getFullExtent();ea=p.getTransformation(this.spatialReference,U,la)}catch{}U=await S.projectMany(L.items.map(la=>F.getGeometry(this.geometryType,this.hasZ,this.hasM,Y.getGeometry(la))),this.spatialReference,U,ea);L.items=
U.map((la,na)=>Y.cloneWithGeometry(L.items[na],r.convertFromGeometry(la,this.hasZ,this.hasM)));return L}_getQueryBBoxes(L){if(Q.canQueryWithRBush(L)){if(t.isExtent(L))return[I.fromValues(Math.min(L.xmin,L.xmax),Math.min(L.ymin,L.ymax),Math.max(L.xmin,L.xmax),Math.max(L.ymin,L.ymax))];if(t.isPolygon(L))return L.rings.map(U=>I.fromValues(Math.min(U[0][0],U[2][0]),Math.min(U[0][1],U[2][1]),Math.max(U[0][0],U[2][0]),Math.max(U[0][1],U[2][1])))}return[E.getBoundsXY(I.create(),L)]}async _searchFeatures(L){const U=
new Set;await Promise.all(L.map(Y=>this.featureStore.forEachInBounds(Y,ea=>U.add(ea))));L=Array.from(U.values());U.clear();return L}async _executeQueryForStatistics(L,U,Y){L=M.clone(L);try{L=await this._schedule(()=>R.normalizeQuery(L,this.definitionExpression,this.spatialReference),Y);L=await this._reschedule(()=>H.validateStatisticsQuery(L,U,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Y);const ea=await this._reschedule(()=>
this._executeSceneFilterQuery(L,Y),Y),la=await this._reschedule(()=>this._executeGeometryQuery(L,ea,Y),Y);await this._reschedule(()=>this._executeAggregateIdsQuery(la),Y);await this._reschedule(()=>this._executeObjectIdsQuery(la),Y);await this._reschedule(()=>this._executeTimeQuery(la),Y);await this._reschedule(()=>this._executeAttributesQuery(la),Y);return la}catch(ea){if(ea!==R.queryEngineEmptyResult)throw ea;return new A.QueryEngineResult([],L,this)}}}d.Feature=O;d.QueryEngine=J;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","./PooledArray"],function(d,e){d.RemoveMode=void 0;(function(n){n[n.ALL=0]="ALL";n[n.SOME=1]="SOME"})(d.RemoveMode||(d.RemoveMode={}));class B{constructor(n,f,v){this.name=n;this._storage=f;this.id=`${M++}:`;this.maxSize=this.size=0;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);v&&(this._storage.registerRemoveFunc(this.id,v),this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&
this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get sizeAll(){return this._storage.size}resetHitRate(){this._hit=this._miss=0}put(n,f,v,g=0){this._storage.put(this,n,f,v,g)}get(n){n=this._storage.get(this,n);void 0===n?++this._miss:++this._hit;return n}peek(n){return this._storage.peek(this,n)}pop(n){n=this._storage.pop(this,n);void 0===n?++this._miss:++this._hit;return n}updateSize(n,f,v){this._storage.updateSize(this,
n,f,v)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class z{get size(){return this._size}constructor(n=10485760){this._maxSize=n;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new e;this._users=new e}destroy(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null}register(n){this._users.push(n)}deregister(n){this._users.removeUnordered(n)}registerRemoveFunc(n,
f){this._removeFuncs.push([n,f])}deregisterRemoveFunc(n){this._removeFuncs.filterInPlace(f=>f[0]!==n)}get maxSize(){return this._maxSize}set maxSize(n){this._maxSize=Math.max(n,0);this._checkSizeLimits()}put(n,f,v,g,p){f=n.id+f;const w=this._db.get(f);w&&(this._size-=w.size,n.size-=w.size,this._db.delete(f),w.entry!==v&&this._notifyRemove(f,w.entry,d.RemoveMode.ALL));g>this._maxSize?this._notifyRemove(f,v,d.RemoveMode.ALL):void 0===v?console.warn("Refusing to cache undefined entry "):!g||0>g?(console.warn(`Refusing to cache entry with size ${g} for key ${f}`),
this._notifyRemove(f,v,d.RemoveMode.ALL)):(p=1+Math.max(p,-3)- -3,this._db.set(f,{entry:v,size:g,lifetime:p,lives:p}),this._size+=g,n.size+=g,this._checkSizeLimits())}updateSize(n,f,v,g){f=n.id+f;const p=this._db.get(f);if(p&&p.entry===v){this._size-=p.size;for(n.size-=p.size;g>this._maxSize;)if(g=this._notifyRemove(f,v,d.RemoveMode.SOME),!(null!=g&&0<g)){this._db.delete(f);return}p.size=g;this._size+=g;n.size+=g;this._checkSizeLimits()}}pop(n,f){f=n.id+f;const v=this._db.get(f);if(v)return this._size-=
v.size,n.size-=v.size,this._db.delete(f),++this._hit,v.entry;++this._miss}get(n,f){f=n.id+f;n=this._db.get(f);if(void 0===n)++this._miss;else return this._db.delete(f),n.lives=n.lifetime,this._db.set(f,n),++this._hit,n.entry}peek(n,f){(n=this._db.get(n.id+f))?++this._hit:++this._miss;return n?.entry}get performanceInfo(){const n={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},f={},v=
[];this._db.forEach((w,I)=>{const E=w.lifetime;v[E]=(v[E]||0)+w.size;this._users.forAll(t=>{const {id:q,name:a}=t;I.startsWith(q)&&(f[a]=(f[a]||0)+w.size)})});const g={};this._users.forAll(w=>{const I=w.name;"hitRate"in w&&"number"===typeof w.hitRate&&!isNaN(w.hitRate)&&0<w.hitRate?(f[I]=f[I]||0,g[I]=Math.round(100*w.hitRate)+"%"):g[I]="0%"});var p=Object.keys(f);p.sort((w,I)=>f[I]-f[w]);p.forEach(w=>n[w]=Math.round(f[w]/2**20)+"MB / "+g[w]);for(p=v.length-1;0<=p;--p){const w=v[p];w&&(n["Priority "+
(p+-3-1)]=Math.round(w/this._size*100)+"%")}return n}resetStats(){this._hit=this._miss=0;this._users.forAll(n=>n.resetHitRate())}clear(n){const f=n.id;this._db.forEach((v,g)=>{g.startsWith(f)&&(this._size-=v.size,this._db.delete(g),this._notifyRemove(g,v.entry,d.RemoveMode.ALL))});n.size=0}clearAll(){this._db.forEach((n,f)=>this._notifyRemove(f,n.entry,d.RemoveMode.ALL));this._users.forEach(n=>n.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(n,
f,v){let g;this._removeFuncs.some(p=>n.startsWith(p[0])?(p=p[1](f,v),"number"===typeof p&&(g=p),!0):!1);return g}_checkSizeLimits(){if(this._size>this._maxSize)for(const [n,f]of this._db)if(this._purgeItem(n,f),this._size<=.9*this.maxSize)return;this._users.forEach(n=>{if(0<n.maxSize&&n.size>n.maxSize)for(const [f,v]of this._db)if(f.startsWith(n.id)&&(this._purgeItem(f,v,n),n.size<=.9*n.maxSize))break})}_purgeItem(n,f,v=this._users.find(g=>n.startsWith(g.id))){this._db.delete(n);if(1>=f.lives){this._size-=
f.size;v&&(v.size-=f.size);const g=this._notifyRemove(n,f.entry,d.RemoveMode.SOME);null!=g&&0<g&&(this._size+=g,v&&(v.size+=g),f.lives=f.lifetime,f.size=g,this._db.set(n,f))}else--f.lives,this._db.set(n,f)}}let M=0;d.MemCache=B;d.MemCacheStorage=z;d.minPriority=-3;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w){function I(F){const S=[];let b=0,A=0;for(let R=0;R<F.length;R++){const H=F[R];let Q=null;for(let N=0;N<H.length;N++)Q=H[N],S.push(Q),0===N?A=b=Q[0]:(b=Math.min(b,Q[0]),A=Math.max(A,Q[0]));Q&&S.push([(b+A)/2,0])}return S}function E(F,S){if(!(F instanceof n||F instanceof M))throw y.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new B("straightLineDensify: the input geometry is neither polyline nor polygon");var b=f.getGeometryParts(F);
const A=[];for(const H of b){b=[];A.push(b);b.push([H[0][0],H[0][1]]);for(let Q=0;Q<H.length-1;Q++){const N=H[Q][0],T=H[Q][1],l=H[Q+1][0],O=H[Q+1][1];var R=Math.sqrt((l-N)*(l-N)+(O-T)*(O-T));const m=(O-T)/R,u=(l-N)/R,J=R/S;if(1<J){for(let L=1;L<=J-1;L++){const U=L*S;b.push([u*U+N,m*U+T])}R=(R+Math.floor(J-1)*S)/2;b.push([u*R+N,m*R+T])}b.push([l,O])}}return"polygon"===F.type?new M({rings:A,spatialReference:F.spatialReference}):new n({paths:A,spatialReference:F.spatialReference})}function t(F,S,b){S&&
(F=E(F,1E6),F=g.webMercatorToGeographic(F,!0));b&&(F=f.updatePolyGeometry(F,b));return F}function q(F,S,b){if(Array.isArray(F)){var A=F[0];A>S?(b=f.offsetMagnitude(A,S),F[0]=A+-2*b*S):A<b&&(S=f.offsetMagnitude(A,b),F[0]=A+-2*S*b)}else A=F.x,A>S?(b=f.offsetMagnitude(A,S),F=F.clone().offset(-2*b*S,0)):A<b&&(S=f.offsetMagnitude(A,b),F=F.clone().offset(-2*S*b,0));return F}function a(F,S){let b=-1;for(let A=0;A<S.cutIndexes.length;A++){const R=S.cutIndexes[A],H=S.geometries[A],Q=f.getGeometryParts(H);
for(let N=0;N<Q.length;N++){const T=Q[N];T.some(l=>{if(180>l[0])return!0;l=0;for(var O=0;O<T.length;O++){var m=T[O][0];l=m>l?m:l}l=Number(l.toFixed(9));l=-360*f.offsetMagnitude(l,180);for(O=0;O<T.length;O++)m=H.getPoint(N,O),H.setPoint(N,O,m.clone().offset(l,0));return!0})}if(R===b)if("polygon"===F[0].type)for(const N of f.getGeometryParts(H))F[R]=F[R].addRing(N);else{if("polyline"===F[0].type)for(const N of f.getGeometryParts(H))F[R]=F[R].addPath(N)}else b=R,F[R]=H}return F}async function r(F,S,
b){if(!Array.isArray(F))return r([F],S);S&&"string"!==typeof S&&y.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");var A="string"===typeof S?S:S?.url??e.geometryServiceUrl;let R,H,Q;let N=0;var T=[];S=[];for(var l of F)if(null==l)S.push(l);else{if(!O){var O=l.spatialReference;var m=v.getInfo(O);var u=(R=O.isWebMercator)?102100:4326;H=f.cutParams[u].maxX;Q=f.cutParams[u].minX;var J=f.cutParams[u].plus180Line;u=f.cutParams[u].minus180Line}if(m)if("mesh"===
l.type)S.push(l);else if("point"===l.type)S.push(q(l.clone(),H,Q));else if("multipoint"===l.type){var L=l.clone();L.points=L.points.map(U=>q(U,H,Q));S.push(L)}else if("extent"===l.type)L=l.clone()._normalize(!1,!1,m),S.push(L.rings?new M(L):L);else if(l.extent){L=l.extent;const U=2*f.offsetMagnitude(L.xmin,Q)*H;let Y=0===U?l.clone():f.updatePolyGeometry(l.clone(),U);L.offset(U,0);L.intersects(J)&&L.xmax!==H?(N=L.xmax>N?L.xmax:N,Y=t(Y,R),T.push(Y),S.push("cut")):L.intersects(u)&&L.xmin!==Q?(N=2*L.xmax*
H>N?2*L.xmax*H:N,Y=t(Y,R,360),T.push(Y),S.push("cut")):S.push(Y)}else S.push(l.clone());else S.push(l)}O=f.offsetMagnitude(N,H);m=-90;J=O;for(l=new n;0<O;)u=-180+360*O,l.addPath([[u,m],[u,-1*m]]),m*=-1,O--;if(0<T.length&&0<J){O=await p.cut(A,T,l,b);O=a(T,O);m=[];T=[];for(J=0;J<S.length;J++)l=S[J],"cut"!==l?T.push(l):(l=O.shift(),u=F[J],null!=u&&"polygon"===u.type&&u.rings&&1<u.rings.length&&l.rings.length>=u.rings.length?(m.push(l),T.push("simplify")):T.push(R?g.geographicToWebMercator(l):l));if(!m.length)return T;
S=await w.simplify(A,m,b);F=[];for(b=0;b<T.length;b++)A=T[b],"simplify"!==A?F.push(A):F.push(R?g.geographicToWebMercator(S.shift()):S.shift());return F}F=[];for(b=0;b<S.length;b++)A=S[b],"cut"!==A?F.push(A):(A=T.shift(),F.push(!0===R?g.geographicToWebMercator(A):A));return F}const y=z.getLogger("esri.geometry.support.normalizeUtils");d.getClosestDenormalizedXToReference=function(F,S,b){b=v.getInfo(b);if(null==b)return F;const [A,R]=b.valid;b=2*R;let H=0,Q=0;S>R?H=Math.ceil(Math.abs(S-R)/b):S<A&&(H=
-Math.ceil(Math.abs(S-A)/b));F>R?Q=Math.ceil(Math.abs(F-R)/b):F<A&&(Q=-Math.ceil(Math.abs(F-A)/b));F+=(H-Q)*b;S=F-S;S>R?F-=b:S<A&&(F+=b);return F};d.getDenormalizedExtent=function(F){if(!F)return null;const S=F.extent;if(!S)return null;var b=F.spatialReference&&v.getInfo(F.spatialReference);if(!b)return S;const [A,R]=b.valid;({width:b}=S);let {xmin:H,xmax:Q}=S;[H,Q]=[Q,H];if("extent"===F.type||0===b||b<=R||b>2*R||H<A||Q>R)return S;let N;switch(F.type){case "polygon":if(1<F.rings.length)N=I(F.rings);
else return S;break;case "polyline":if(1<F.paths.length)N=I(F.paths);else return S;break;case "multipoint":N=F.points}F=S.clone();for(let T=0;T<N.length;T++){let l=N[T][0];0>l?(l+=R,Q=Math.max(l,Q)):(l-=R,H=Math.min(l,H))}F.xmin=H;F.xmax=Q;return F.width<b?(F.xmin-=R,F.xmax-=R,F):S};d.normalizeCentralMeridian=r;d.normalizeMapX=function(F,S){if(S=v.getInfo(S)){const [b,A]=S.valid;S=A-b;if(F<b)for(;F<b;)F+=S;if(F>A)for(;F>A;)F-=S}return F};d.straightLineDensify=E;Object.defineProperty(d,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(d,e,B,z){function M(n){return z.isPolygon(n)?n.rings:n.paths}e={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new e({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:B.WebMercator}),minus180Line:new e({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],
[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:B.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new e({paths:[[[180,-180],[180,180]]],spatialReference:B.WGS84}),minus180Line:new e({paths:[[[-180,-180],[-180,180]]],spatialReference:B.WGS84})}};d.cutParams=e;d.getGeometryParts=M;d.offsetMagnitude=function(n,f){return Math.ceil((n-f)/(2*f))};d.updatePolyGeometry=function(n,f){const v=M(n);for(const g of v)for(const p of g)p[0]+=f;return n};Object.defineProperty(d,Symbol.toStringTag,
{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),function(d,e,B,z,M,n){d.cut=async function(f,v,g,p){f=n.parseUrl(f);const w=v[0].spatialReference;v={...p,responseType:"json",query:{...f.query,f:"json",sr:M.srToRESTValue(w),target:JSON.stringify({geometryType:z.getJsonType(v[0]),geometries:v}),cutter:JSON.stringify(g)}};v=await B(f.path+"/cut",
v);const {cutIndexes:I,geometries:E=[]}=v.data;return{cutIndexes:I,geometries:E.map(t=>{t=z.fromJSON(t);t.spatialReference=w;return t})}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),function(d,e,B,z,M,n){function f(v,g,p){const w={};for(const E in v)if("declaredClass"!==E){var I=v[E];if(null!=I&&"function"!==typeof I)if(Array.isArray(I)){w[E]=[];for(let t=
0;t<I.length;t++)w[E][t]=f(I[t])}else"object"===typeof I?I.toJSON?(I=I.toJSON(p?.[E]),w[E]=g?I:JSON.stringify(I)):w[E]=g?I:JSON.stringify(I):w[E]=I}return w}d.asValidOptions=function(v,g){return g?{...g,query:{...(v??{}),...g.query}}:{query:v}};d.encode=f;d.getToken=function(v,g){return v?n.supportsApiKey(v)&&(g||e.apiKey)?g||e.apiKey:B.id?.findCredential(v)?.token:null};d.parseUrl=function(v){return"string"===typeof v?M.urlToObject(v):z.clone(v)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(d,e,B,z,M,n){d.simplify=async function(f,v,g){const p="string"===typeof f?B.urlToObject(f):f;f=v[0].spatialReference;const w=z.getJsonType(v[0]);v={...g,query:{...p.query,f:"json",sr:M.srToRESTValue(f),geometries:JSON.stringify(n.encodeGeometries(v))}};({data:v}=await e(p.path+"/simplify",v));return n.decodeGeometries(v.geometries,
w,f)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(d,e){d.decodeGeometries=function(B,z,M){const n=e.getGeometryType(z);return B.map(f=>{f=n.fromJSON(f);f.spatialReference=M;return f})};d.encodeGeometries=function(B){return{geometryType:e.getJsonType(B[0]),geometries:B.map(z=>z.toJSON())}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports",
"../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(d,e,B,z){function M(E,t,q={}){const a=n(t,E);if(!a)throw q=p.getError(t,E),new e("unsupported-query","invalid SQL expression",{expression:t,error:q});E=q.expressionName||"expression";if(q.validateStandardized&&!a.isStandardized)throw new e("unsupported-query",`${E} is not standard`,{expression:t});if(q.validateAggregate&&!a.isAggregate)throw new e("unsupported-query",`${E} does not contain a valid aggregate function`,
{expression:t});return a.fieldNames}function n(E,t){return E?p.get(E,t):null}function f(E){return/\((.*?)\)/.test(E)?E:E.split(" as ")[0]}function v(E,t,q,a={}){const r=new Map;var y=a.allowedFieldTypes??I;for(const F of q)if("*"!==F)if(E.get(F))g(r,E,t,y,F);else try{const S=f(F),b=M(E,S,{validateStandardized:!0});for(const A of b)g(r,E,t,y,A)}catch(S){r.set(F,{type:"expression-error",expression:F,error:S})}if(r.size)throw new e("unsupported-query",`${a.expressionName??"expression"} contains invalid or missing fields`,
{errors:Array.from(r.values()),query:a.query});}function g(E,t,q,a,r){"*"!==r&&((t=t.get(r))?q.has(t.name)?!1===a?.has(t.type)&&E.set(r,{type:"invalid-type",fieldName:t.name,fieldType:z.kebabDict.fromJSON(t.type),allowedFieldTypes:Array.from(a,y=>z.kebabDict.fromJSON(y))}):E.set(r,{type:"missing-field",fieldName:t.name}):E.set(r,{type:"invalid-field",fieldName:r}))}const p=new B.WhereClauseCache(50,500);B=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));
const w=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),I=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...B,...w]);d.allDateAndTimeFieldTypes=w;d.getAliasFromFieldName=function(E){return E.split(" as ")[1]};d.getExpressionFromFieldName=f;d.getWhereClause=n;d.numericFieldTypes=B;d.validateFields=v;d.validateHaving=function(E,t,q,a,r){if(!q)return!0;const y=M(E,q,{validateAggregate:!0,expressionName:"having clause"});
v(E,t,y,{expressionName:"having clause",query:r});if(!n(q,E)?.getExpressions().every(F=>{const {aggregateType:S,field:b}=F,A=E.get(b)?.name;return a.some(R=>{const {onStatisticField:H,statisticType:Q}=R;return E.get(H)?.name===A&&Q.toLowerCase().trim()===S})}))throw new e("unsupported-query","expressions in having clause should also exist in outStatistics",{having:q});return!0};d.validateWhere=function(E,t,q,a){if(!q)return!0;q=M(E,q,{validateStandardized:!0,expressionName:"where clause"});v(E,t,
q,{expressionName:"where clause",query:a});return!0};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../LRUCache","./WhereClause"],function(d,e,B){class z{constructor(M,n){this._cache=new e.LRUCache(M);this._invalidCache=new e.LRUCache(n)}get(M,n){const f=`${n.uid}:${M}`,v=this._cache.get(f);if(v)return v;if(null!=this._invalidCache.get(f))return null;try{const g=B.WhereClause.create(M,n);this._cache.put(f,g);return g}catch(g){return this._invalidCache.put(f,
g),null}}getError(M,n){return this._invalidCache.get(`${n.uid}:${M}`)??null}}d.WhereClauseCache=z;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(d,e){class B{constructor(z,M){this._storage=new e.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=z;this._storage.register(this);M&&this._storage.registerRemoveFunc("",M)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(z,M,
n=1){this._storage.put(this,z,M,n,1)}pop(z){return this._storage.pop(this,z)}get(z){return this._storage.get(this,z)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(z){this._storage.maxSize=z}resetHitRate(){}}d.LRUCache=B;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../../arcade/featureset/support/errorsupport ../has ./AggregateFunctions ./DateOnly ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w,I,E,t,q){function a(l){return Array.isArray(l)?l:[l]}function r(l){return null!==l?!0!==l:null}function y(l,O){return null!=l&&null!=O?!0===l&&!0===O:!1===l||!1===O?!1:null}function F(l,O){return null!=l&&null!=O?!0===l||!0===O:!0===l||!0===O?!0:null}function S(l,O){if(null==l)return null;let m=!1;for(const u of O)if(null==u)m=null;else if(l===u){m=!0;break}return m}function b(l,O,m){if(null==l)return null;let u="",J=N.Normal;for(let L=0;L<O.length;L++){const U=O.charAt(L);
switch(J){case N.Normal:U===m?J=N.Escaped:u="-[]/{}()*+?.\\^$|".includes(U)?u+("\\"+U):"%"===U?u+".*":"_"===U?u+".":u+U;break;case N.Escaped:u="-[]/{}()*+?.\\^$|".includes(U)?u+("\\"+U):u+U,J=N.Normal}}return(new RegExp("^"+u+"$","m")).test(l)}function A(l,O,m,u){l=u.getAttribute(l,O);O=m?.get(O);return null==l||"esriFieldTypeDate"!==O?.type&&"date"!==O?.type?null==l||"esriFieldTypeDateOnly"!==O?.type&&"date-only"!==O?.type?null==l||"esriFieldTypeTimeOnly"!==O?.type&&"time-only"!==O?.type?null==l||
"esriFieldTypeTimestampOffset"!==O?.type&&"timestamp-offset"!==O?.type?l:new w.SqlTimeStampOffset(l):E.TimeOnly.fromReader(l):n.DateOnly.fromReader(l):g.convertToExecutingTimeZone(new Date(l),m?.getLuxonTimeZone(O.name)??q.FixedOffsetZone.utcInstance)}const R=new Set(["current_timestamp","current_date","current_time"]);class H{static makeBool(l){return!0===l}static featureValue(l,O,m,u){return A(l,O,m,u)}static equalsNull(l){return null===l}static applyLike(l,O,m){return b(l,O,m)}static ensureArray(l){return a(l)}static applyIn(l,
O){return S(l,O)}static currentDate(l){return n.DateOnly.fromNow(l)}static makeSqlInterval(l,O,m){return p.SqlInterval.createFromValueAndQualifer(l,O,m)}static convertInterval(l){return l instanceof p.SqlInterval?l.valueInMilliseconds():l}static currentTimestamp(l){return g.convertToExecutingTimeZone(new Date,l)}static compare(l,O,m,u){return v.sqlCompare(O,m,l)}static calculate(l,O,m,u){return f.sqlCalculateFunction(l,O,m,u)}static evaluateTime(l){return g.parseTime(l)}static evaluateTimestamp(l,
O,m){return g.parseTimestamp(l,O,m)}static evaluateDate(l,O){return g.parseDate(l,O)}static evaluateFunction(l,O,m){return I.evaluateFunction(l,O,m)}static lookup(l,O){l=O[l];return void 0===l?null:l}static between(l,O,m){return null==l||null==O[0]||null==O[1]?null:v.sqlCompare(l,O[0],"\x3e\x3d")&&v.sqlCompare(l,O[1],"\x3c\x3d")}static notbetween(l,O,m){return null==l||null==O[0]||null==O[1]?null:v.sqlCompare(l,O[0],"\x3c")||v.sqlCompare(l,O[1],"\x3e")}static ternaryNot(l){return r(l)}static ternaryAnd(l,
O){return y(l,O)}static ternaryOr(l,O){return F(l,O)}}class Q{constructor(l,O,m="UTC"){this.fieldsIndex=O;this.timeZone=m;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=t.WhereGrammar.parse(l);const {isStandardized:u,isAggregate:J,referencedFieldNames:L}=this._extractExpressionInfo(O);this._referencedFieldNames=L;this.isStandardized=u;this.isAggregate=J}static convertValueToStorageFormat(l,O=null){if(null===O)return g.isDate(l)?l.getTime():g.isDateTime(l)?l.toMillis():g.isTimestampOffset(l)?
l.toStorageFormat():g.isTimeOnly(l)?l.toStorageString():g.isDateOnly(l)?l.toStorageFormat():l;switch(O){case "date":if(g.isDate(l))return l.getTime();if(g.isDateTime(l))return l.toMillis();if(g.isTimestampOffset(l))return l.toMilliseconds();if(g.isDateOnly(l))return l.toNumber();break;case "date-only":if(g.isDate(l))return n.DateOnly.fromDateJS(l).toString();if(g.isTimestampOffset(l))return n.DateOnly.fromSqlTimeStampOffset(l).toString();if(g.isDateTime(l))return n.DateOnly.fromDateTime(l).toString();
break;case "time-only":if(g.isDate(l))return E.TimeOnly.fromDateJS(l).toStorageString();if(g.isDateTime(l))return E.TimeOnly.fromDateTime(l).toStorageString();if(g.isTimestampOffset(l))return E.TimeOnly.fromSqlTimeStampOffset(l).toStorageString();if(g.isTimeOnly(l))return l.toStorageString();break;case "timestamp-offset":if(g.isDate(l))return w.SqlTimeStampOffset.fromJSDate(l).toStorageFormat();if(g.isDateTime(l))return w.SqlTimeStampOffset.fromDateTime(l).toStorageFormat();if(g.isTimestampOffset(l))return l.toStorageFormat()}return l}static create(l,
O,m="UTC"){return new Q(l,O,m)}get fieldNames(){return this._referencedFieldNames}testSet(l,O=T){return!!this._evaluateNode(this.parseTree,null,O,l)}calculateValue(l,O=T){l=this._evaluateNode(this.parseTree,l,O,null);return l instanceof p.SqlInterval?l.valueInMilliseconds()/864E5:l}calculateValueCompiled(l,O=T){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(l,this.parameters,O,this.fieldsIndex,this.timeZone);if(z("esri-csp-restrictions"))return this.calculateValue(l,
O);this._compileMe();return this.parseTree._compiledVersion(l,this.parameters,O,this.fieldsIndex,this.timeZone)}testFeature(l,O=T){return!!this._evaluateNode(this.parseTree,l,O,null)}testFeatureCompiled(l,O=T){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(l,this.parameters,O,this.fieldsIndex,this.timeZone);if(z("esri-csp-restrictions"))return this.testFeature(l,O);this._compileMe();return!!this.parseTree._compiledVersion(l,this.parameters,O,this.fieldsIndex,this.timeZone)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,l=>{"current-time"===l.type?this._hasDateFunctions=!0:"function"===l.type&&(this._hasDateFunctions=this._hasDateFunctions||R.has(l.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const l=new Set;this._visitAll(this.parseTree,O=>{"function"===O.type&&l.add(O.name.toLowerCase())});return Array.from(l)}getExpressions(){const l=new Map;this._visitAll(this.parseTree,O=>{if("function"===
O.type){const m=O.name.toLowerCase();O=O.args.value[0];if("column-reference"===O.type){O=O.column;const u=`${m}-${O}`;l.has(u)||l.set(u,{aggregateType:m,field:O})}}});return[...l.values()]}getVariables(){const l=new Set;this._visitAll(this.parseTree,O=>{"parameter"===O.type&&l.add(O.value.toLowerCase())});return Array.from(l)}_compileMe(){const l="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone",l)).bind(H)}_extractExpressionInfo(l){const O=[],m=new Set;let u=!0,J=!1;this._visitAll(this.parseTree,L=>{switch(L.type){case "column-reference":var U=l?.get(L.column);let Y;U?U=Y=U.name??"":(Y=L.column,U=Y.toLowerCase());m.has(U)||(m.add(U),O.push(Y));L.column=Y;break;case "function":const {name:ea,args:la}=L;L=la.value.length;u&&(u=I.isStandardized(ea,L));!1===J&&(J=M.isAggregate(ea,L))}});return{referencedFieldNames:Array.from(O),isStandardized:u,isAggregate:J}}_visitAll(l,
O){if(null!=l)switch(O(l),l.type){case "when-clause":this._visitAll(l.operand,O);this._visitAll(l.value,O);break;case "case-expression":for(const m of l.clauses)this._visitAll(m,O);"simple"===l.format&&this._visitAll(l.operand,O);null!==l.else&&this._visitAll(l.else,O);break;case "expression-list":for(const m of l.value)this._visitAll(m,O);break;case "unary-expression":this._visitAll(l.expr,O);break;case "binary-expression":this._visitAll(l.left,O);this._visitAll(l.right,O);break;case "function":this._visitAll(l.args,
O)}}evaluateNodeToJavaScript(l){switch(l.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(l.value)+", "+JSON.stringify(l.qualifier)+","+JSON.stringify(l.op)+")";case "case-expression":var O="";if("simple"===l.format){var m=this.evaluateNodeToJavaScript(l.operand);O="( ";for(let u=0;u<l.clauses.length;u++)O+=" (this.compare('\x3d',"+m+","+this.evaluateNodeToJavaScript(l.clauses[u].operand)+") ? ("+this.evaluateNodeToJavaScript(l.clauses[u].value)+") : "}else for(O=
"( ",m=0;m<l.clauses.length;m++)O+=" this.makeBool("+this.evaluateNodeToJavaScript(l.clauses[m].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(l.clauses[m].value)+") : ";O=null!==l.else?O+this.evaluateNodeToJavaScript(l.else):O+"null";return O+" )";case "parameter":return"this.lookup("+JSON.stringify(l.value.toLowerCase())+",lookups)";case "expression-list":O="[";for(m of l.value)"["!==O&&(O+=","),O+=this.evaluateNodeToJavaScript(m);return O+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(l.expr)+")";case "binary-expression":switch(l.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+" )";case "IS":if("null"!==l.right.type)throw new B.SqlError(B.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(l.left)+")";case "ISNOT":if("null"!==
l.right.type)throw new B.SqlError(B.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(l.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(l.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(l.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(l.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(l.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(l.left)+
","+this.evaluateNodeToJavaScript(l.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+","+JSON.stringify(l.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+","+JSON.stringify(l.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(l.operator)+","+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(l.operator)+","+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+", timeZone)"}throw new B.SqlError(B.SqlErrorCodes.UnsupportedOperator,{operator:l.operator});
case "null":case "boolean":case "string":case "number":return JSON.stringify(l.value);case "time":return"this.evaluateTime(JSON.stringify(node.value))";case "date":return"this.evaluateDate(JSON.stringify(node.value), 'unknown')";case "timestamp":return"this.evaluateTimestamp(JSON.stringify(node.value), 'unknown')";case "current-time":return"date"===l.mode?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(l.column)+
",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(l.name)+","+this.evaluateNodeToJavaScript(l.args)+", timeZone)"}throw new B.SqlError(B.SqlErrorCodes.UnsupportedSyntax,{node:l.type});}_evaluateNode(l,O,m,u){switch(l.type){case "interval":return m=this._evaluateNode(l.value,O,m,u),p.SqlInterval.createFromValueAndQualifer(m,l.qualifier,l.op);case "case-expression":if("simple"===l.format){var J=this._evaluateNode(l.operand,O,m,u);for(var L=0;L<l.clauses.length;L++)if(v.sqlCompare(J,
this._evaluateNode(l.clauses[L].operand,O,m,u),"\x3d",this.timeZone))return this._evaluateNode(l.clauses[L].value,O,m,u)}else for(J=0;J<l.clauses.length;J++)if(!0===this._evaluateNode(l.clauses[J].operand,O,m,u))return this._evaluateNode(l.clauses[J].value,O,m,u);return null!==l.else?this._evaluateNode(l.else,O,m,u):null;case "parameter":return l=this.parameters[l.value.toLowerCase()],g.isDate(l)?q.DateTime.fromJSDate(l):l instanceof e.ArcadeDate?l.toDateTime():l;case "expression-list":J=[];for(var U of l.value)J.push(this._evaluateNode(U,
O,m,u));return J;case "unary-expression":return r(this._evaluateNode(l.expr,O,m,u));case "binary-expression":switch(l.operator){case "AND":return y(this._evaluateNode(l.left,O,m,u),this._evaluateNode(l.right,O,m,u));case "OR":return F(this._evaluateNode(l.left,O,m,u),this._evaluateNode(l.right,O,m,u));case "IS":if("null"!==l.right.type)throw new B.SqlError(B.SqlErrorCodes.UnsupportedIsRhs);return null===this._evaluateNode(l.left,O,m,u);case "ISNOT":if("null"!==l.right.type)throw new B.SqlError(B.SqlErrorCodes.UnsupportedIsRhs);
return null!==this._evaluateNode(l.left,O,m,u);case "IN":return J=a(this._evaluateNode(l.right,O,m,u)),S(this._evaluateNode(l.left,O,m,u),J);case "NOT IN":return J=a(this._evaluateNode(l.right,O,m,u)),r(S(this._evaluateNode(l.left,O,m,u),J));case "BETWEEN":return J=this._evaluateNode(l.left,O,m,u),l=this._evaluateNode(l.right,O,m,u),null==J||null==l[0]||null==l[1]?null:v.sqlCompare(J,l[0],"\x3e\x3d",this.timeZone)&&v.sqlCompare(J,l[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return J=this._evaluateNode(l.left,
O,m,u),l=this._evaluateNode(l.right,O,m,u),null==J||null==l[0]||null==l[1]?null:v.sqlCompare(J,l[0],"\x3c",this.timeZone)||v.sqlCompare(J,l[1],"\x3e",this.timeZone);case "LIKE":return b(this._evaluateNode(l.left,O,m,u),this._evaluateNode(l.right,O,m,u),l.escape);case "NOT LIKE":return r(b(this._evaluateNode(l.left,O,m,u),this._evaluateNode(l.right,O,m,u),l.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return v.sqlCompare(this._evaluateNode(l.left,O,m,
u),this._evaluateNode(l.right,O,m,u),l.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return f.sqlCalculateFunction(l.operator,this._evaluateNode(l.left,O,m,u),this._evaluateNode(l.right,O,m,u),this.timeZone)}case "null":case "boolean":case "string":case "number":return l.value;case "date":return l.parsedValue??(l.parsedValue=g.parseDate(l.value,"unknown")),l.parsedValue;case "timestamp":return l.parsedValue??(l.parsedValue=g.parseTimestamp(l.value,"unknown")),l.parsedValue;
case "time":return g.parseTime(l.value);case "current-time":return"date"===l.mode?n.DateOnly.fromNow(this.timeZone):g.convertToExecutingTimeZone(new Date,this.timeZone);case "column-reference":return A(O,l.column,this.fieldsIndex,m);case "data-type":return l.value;case "function":if(this.isAggregate&&M.isAggregate(l.name,l.args.value.length)){O=[];for(J of l.args?.value||[]){U=[];for(L of u||[])U.push(this._evaluateNode(J,L,m,null));O.push(U)}return M.aggregateFunction(l.name,O)}m=this._evaluateNode(l.args,
O,m,u);return I.evaluateFunction(l.name,m,this.timeZone)}throw new B.SqlError(B.SqlErrorCodes.UnsupportedSyntax,{node:l.type});}}var N;(function(l){l[l.Normal=0]="Normal";l[l.Escaped=1]="Escaped"})(N||(N={}));const T={getAttribute(l,O){return(l&&"object"===typeof l.attributes?l.attributes:l)[O]}};d.WhereClause=Q;d.defaultAttributeAdapter=T;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone",
"../chunks/datetime"],function(d,e,B,z){function M(p,w,I){return p<w?p-w:p>I?p-I:0}function n(p,w=!0){if(p instanceof z.Zone)return p;if("system"===p.toLowerCase())return"system";if("utc"===p.toLowerCase())return"UTC";if("unknown"===p.toLowerCase())return B.UnknownTimeZone.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(p)){const I=z.FixedOffsetZone.parseSpecifier("UTC"+(p.startsWith("+")||p.startsWith("-")?"":"+")+p);if(I)return I}p=z.IANAZone.create(p);if(!p.isValid){if(w)throw new v(d.ArcadeDateErrorCodes.TimeZoneNotRecognized);
return null}return p}d.ArcadeDateErrorCodes=void 0;(d.ArcadeDateErrorCodes||(d.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const f={[d.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class v extends Error{constructor(p,w){super(e.replace(f[p],w));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,v)}}class g{constructor(p){this._date=p;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(p=
0,w=1,I=1,E=0,t=0,q=0,a=0,r){if(isNaN(p)||isNaN(w)||isNaN(I)||isNaN(E)||isNaN(t)||isNaN(q)||isNaN(a))return null;const y=z.DateTime.local(p,w).daysInMonth;p=z.DateTime.fromObject({day:1>I?1:I>y?y:I,year:p,month:1>w?1:12<w?12:w,hour:0>E?0:23<E?23:E,minute:0>t?0:59<t?59:t,second:0>q?0:59<q?59:q,millisecond:0>a?0:999<a?999:a},{zone:n(r)});p=p.plus({months:M(w,1,12),days:M(I,1,y),hours:M(E,0,23),minutes:M(t,0,59),seconds:M(q,0,59),milliseconds:M(a,0,999)});return new g(p)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}static arcadeDateAndZoneToArcadeDate(p,w){w=n(w);return p.isUnknownTimeZone||w===B.UnknownTimeZone.instance?g.fromParts(p.year,p.monthJS+1,p.day,p.hour,p.minute,p.second,p.millisecond,w):new g(p._date.setZone(w))}static dateJSToArcadeDate(p){return new g(z.DateTime.fromJSDate(p,{zone:"system"}))}static dateJSAndZoneToArcadeDate(p,w="system"){w=n(w);return new g(z.DateTime.fromJSDate(p,{zone:w}))}static unknownEpochToArcadeDate(p){return new g(z.DateTime.fromMillis(p,{zone:B.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(p){return new g(z.DateTime.fromMillis(p.getTime(),
{zone:B.UnknownTimeZone.instance}))}static epochToArcadeDate(p,w="system"){w=n(w);return new g(z.DateTime.fromMillis(p,{zone:w}))}static dateTimeToArcadeDate(p){return new g(p)}clone(){return new g(this._date)}changeTimeZone(p){p=n(p);return g.dateTimeToArcadeDate(this._date.setZone(p))}static dateTimeAndZoneToArcadeDate(p,w){w=n(w);return p.zone===B.UnknownTimeZone.instance||w===B.UnknownTimeZone.instance?g.fromParts(p.year,p.month,p.day,p.hour,p.minute,p.second,p.millisecond,w):new g(p.setZone(w))}static nowToArcadeDate(p){p=
n(p);return new g(z.DateTime.fromJSDate(new Date,{zone:p}))}static nowUTCToArcadeDate(){return new g(z.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===g.systemTimeZoneCanonicalName}equals(p){return this.isSystem&&p.isSystem?this.toNumber()===p.toNumber():this.isUnknownTimeZone!==p.isUnknownTimeZone?!1:this._date.equals(p._date)}get isUnknownTimeZone(){return this._date.zone===B.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let p=
this._date.weekday;6<p&&(p=0);return p}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";
const p=this.zone;return"fixed"===p.type?0===p.fixed?"UTC":p.formatOffset(0,"short"):p.name}stringify(){return JSON.stringify(this.toJSDate())}plus(p){return new g(this._date.plus(p))}diff(p,w="milliseconds"){return this._date.diff(p._date,w)[w]}toISODate(){return this._date.toISODate()}toISOString(p){return p?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(p,w){return this._date.toISOTime({suppressMilliseconds:p,
includeOffset:w&&!this.isUnknownTimeZone})}toFormat(p,w){this.isUnknownTimeZone&&(p=p.replaceAll("Z",""));return this._date.toFormat(p,w)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new g(this._date.toUTC())}toLocal(){return new g(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(p){if(!p)return null;
p=z.DateTime.fromISO(p,{setZone:!0});return new g(p)}}d.ArcadeDate=g;d.ArcadeDateError=v;d.ArcadeDateErrorMessages=f;d.createDateTimeZone=n;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(d,e){function B(M){return M instanceof e.Zone?M===z.instance?!0:!1:"unknown"===M?.toString().toLowerCase()?!0:!1}class z{}z.instance=new e.IANAZone("Etc/UTC");d.UnknownTimeZone=z;d.adoptTimeZone=function(M,
n){return e.DateTime.fromObject({day:M.day,year:M.year,month:M.month,hour:M.hour,minute:M.minute,second:M.second,millisecond:M.millisecond},{zone:n})};d.isUnknownTimeZone=B;d.substituteUnknownTimezone=function(M){return B(M)?z.instance:M};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../core/string"],function(d,e){d.SqlErrorCodes=void 0;(function(f){f.InvalidFunctionParameters="InvalidFunctionParameters";
f.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";f.UnsupportedSqlFunction="UnsupportedSqlFunction";f.UnsupportedOperator="UnsupportedOperator";f.UnsupportedSyntax="UnsupportedSyntax";f.UnsupportedIsRhs="UnsupportedIsRhs";f.UnsupportedIsLhs="UnsupportedIsLhs";f.InvalidDataType="InvalidDataType";f.CannotCastValue="CannotCastValue";f.FunctionNotRecognized="FunctionNotRecognized";f.InvalidTime="InvalidTime";f.InvalidParameterCount="InvalidParameterCount";f.InvalidTimeStamp="InvalidTimeStamp";
f.InvalidDate="InvalidDate";f.InvalidOperator="InvalidOperator";f.IllegalInterval="IllegalInterval";f.YearMonthIntervals="YearMonthIntervals";f.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";f.MissingStatisticParameters="MissingStatisticParameters"})(d.SqlErrorCodes||(d.SqlErrorCodes={}));const B={[d.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[d.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[d.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",
[d.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[d.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[d.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[d.SqlErrorCodes.InvalidDate]:"Invalid date encountered",
[d.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[d.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[d.SqlErrorCodes.IllegalInterval]:"Illegal interval",[d.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[d.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[d.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[d.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[d.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",
[d.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class z extends Error{constructor(f,v){super(e.replace(B[f],v));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,z)}}d.FeatureSetErrorCodes=void 0;(function(f){f.NeverReach="NeverReach";f.NotImplemented="NotImplemented";f.Cancelled="Cancelled";f.InvalidStatResponse="InvalidStatResponse";f.InvalidRequest="InvalidRequest";f.RequestFailed="RequestFailed";
f.MissingFeatures="MissingFeatures";f.AggregationFieldNotFound="AggregationFieldNotFound";f.DataElementsNotFound="DataElementsNotFound"})(d.FeatureSetErrorCodes||(d.FeatureSetErrorCodes={}));const M={[d.FeatureSetErrorCodes.Cancelled]:"Cancelled",[d.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[d.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[d.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",[d.FeatureSetErrorCodes.MissingFeatures]:"Missing features",
[d.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[d.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",[d.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[d.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};class n extends Error{constructor(f,v){super(e.replace(M[f],v));this.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&Error.captureStackTrace(this,n)}}d.FeatureSetError=
n;d.FeatureSetErrorMessages=M;d.SqlError=z;d.SqlErrorMessages=B;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(d,e,B,z,M,n){function f(w){if(null===w)return null;let I=0,E=0;for(let t=0;t<w.length;t++){const q=w[t];if(null!==q){if("number"!==typeof q)throw new e.SqlError(e.SqlErrorCodes.InvalidValueForAggregateFunction);
E++;I+=q}}return 0===E?null:I/w.length}function v(w,I){if(null===w)return null;let E=null,t=null;for(const q of w)w=q,w=q instanceof B.DateOnly?q.toNumber():q instanceof M.TimeOnly?q.toNumber():q instanceof n.DateTime?q.toMillis():q instanceof z.SqlTimeStampOffset?q.toMilliseconds():q,null===E?(E=q,t=w):"max"===I&&null!==t&&null!==w&&t<=w?(E=q,t=w):"min"===I&&null!==t&&null!==w&&t>=w&&(E=q,t=w);return E}function g(w){if(null===w)return null;w=w.filter(t=>null!==t);if(0===w.length)return null;const I=
f(w);if(null===I)return null;let E=0;for(const t of w){if("number"!==typeof t)throw new e.SqlError(e.SqlErrorCodes.InvalidValueForAggregateFunction);E+=(I-t)**2}return E/(w.length-1)}const p={min:{minParams:1,maxParams:1,evaluate:w=>v(w[0],"min")},max:{minParams:1,maxParams:1,evaluate:w=>v(w[0],"max")},avg:{minParams:1,maxParams:1,evaluate:w=>f(w[0])},sum:{minParams:1,maxParams:1,evaluate:w=>{w=w[0];if(null===w)w=null;else{var I=0;for(let E=0;E<w.length;E++){const t=w[E];if(null!==t){if("number"!==
typeof t)throw new e.SqlError(e.SqlErrorCodes.InvalidValueForAggregateFunction);I+=t}}w=I}return w}},stddev:{minParams:1,maxParams:1,evaluate:w=>{w=w[0];null===w?w=null:(w=g(w),w=null===w?null:Math.sqrt(w));return w}},count:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:w[0].length},var:{minParams:1,maxParams:1,evaluate:w=>g(w[0])}};d.aggregateFunction=function(w,I){const E=p[w.toLowerCase()];if(null==E)throw new e.SqlError(e.SqlErrorCodes.FunctionNotRecognized);if(I.length<E.minParams||I.length>
E.maxParams)throw new e.SqlError(e.SqlErrorCodes.InvalidParameterCount,{name:w.toUpperCase()});return E.evaluate(I)};d.isAggregate=function(w,I){w=p[w.toLowerCase()];return null!=w&&I>=w.minParams&&I<=w.maxParams};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports","../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(d,e,B,z){function M(f){f=f.replaceAll(/LTS|LT|LL?L?L?|l{1,4}/g,"[$\x26]");let v="";const g=
/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const p of f.match(g)||[])switch(p){case "D":v+="d";break;case "DD":v+="dd";break;case "DDD":v+="o";break;case "d":v+="c";break;case "ddd":v+="ccc";break;case "dddd":v+="cccc";break;case "M":v+="L";break;case "MM":v+="LL";break;case "MMM":v+="LLL";break;case "MMMM":v+="LLLL";break;case "YY":v+="yy";
break;case "Y":case "YYYY":v+="yyyy";break;case "Q":v+="q";break;case "X":case "x":v+=p;break;default:v=2<=p.length&&"["===p.slice(0,1)&&"]"===p.slice(-1)?v+`'${p.slice(1,-1)}'`:v+`'${p}'`}return v}class n{constructor(f,v,g){this._year=f;this._month=v;this._day=g;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(f){return f instanceof
n&&f.day===this.day&&f.month===this.month&&f.year===this.year}clone(){return new n(this._year,this._month,this._day)}toDateTime(f){return z.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:e.createDateTimeZone(f)})}toDateTimeLuxon(f){return z.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:e.createDateTimeZone(f)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(f=
null){if(null===f||""===f)return this.toString();f=M(f);if(!f)return"";const v=this.toDateTime("unknown");return e.ArcadeDate.dateTimeToArcadeDate(v).toFormat(f,{locale:B.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const f=this.toDateTime("unknown");return e.ArcadeDate.dateTimeToArcadeDate(f)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd")}toSQLValue(){return this.toFormat("yyyy-LL-dd")}toSQLWithKeyword(){return"date '"+
this.toFormat("yyyy-LL-dd")+"'"}plus(f,v){return n.fromDateTime(this.toUTCDateTime().plus({[f]:v}))}toUTCDateTime(){return z.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(f,v){switch(v.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(f.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===v?this.toUTCDateTime().diff(f.toUTCDateTime(),
"months").months:this.toUTCDateTime().diff(f.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(f.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(f.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(f.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(f){f=z.DateTime.fromMillis(f,{zone:z.FixedOffsetZone.utcInstance});return f.isValid?n.fromParts(f.year,f.month,f.day):null}static fromSeconds(f){f=z.DateTime.fromSeconds(f,{zone:z.FixedOffsetZone.utcInstance});return f.isValid?n.fromParts(f.year,f.month,f.day):null}static fromReader(f){if(!f)return null;f=f.split("-");return 3!==f.length?null:new n(parseInt(f[0],10),parseInt(f[1],
10),parseInt(f[2],10))}static fromParts(f,v,g){f=new n(f,v,g);return!1===f.isValid?null:f}static fromDateJS(f){return n.fromParts(f.getFullYear(),f.getMonth()+1,f.getDay())}static fromDateTime(f){return n.fromParts(f.year,f.month,f.day)}static fromSqlTimeStampOffset(f){return this.fromDateTime(f.toDateTime())}static fromString(f,v=null){if(""===f||null===f)return null;var g=[];if(v)(v=M(v))&&g.push(v);else if(null===v||""===v)return f=z.DateTime.fromISO(f,{setZone:!0}),f.isValid?n.fromParts(f.year,
f.month,f.day):null;for(const p of g)if(g=z.DateTime.fromFormat(f,v??p),g.isValid)return new n(g.year,g.month,g.day);return null}static fromNow(f="system"){f=z.DateTime.fromJSDate(new Date).setZone(e.createDateTimeZone(f));return new n(f.year,f.month,f.day)}}d.DateOnly=n;d.standardiseDateOnlyFormat=M;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports","../../chunks/datetime"],function(d,e){function B(M){return Number.isNaN(M)||
0===M?M:Math.trunc(M)}class z{constructor(M){this._timeStampOffset=M;this._date=null}toDateTime(){this._date??(this._date=e.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return B(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return B(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return z.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(M){return new z(e.DateTime.fromJSDate(M).toISO({includeOffset:!0}))}static fromDateTime(M){return new z(M.toISO({includeOffset:!0}))}static fromParts(M,
n,f=0,v=0,g=0,p=0,w=0,I=!1,E=0,t=0){M=`${M.toString().padStart(4,"0")}-${n.toString().padStart(2,"0")}-${f.toString().padStart(2,"0")}`;n="";10>p&&(n="0");v=`${v.toString().padStart(2,"0")}:${g.toString().padStart(2,"0")}:${n+p.toString()}`;0!==w&&(v+="."+w.toString().padStart(3,"0"));w=`${I?"-":"+"}${E.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;return new z(M+"T"+v+w)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let M=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});M&&(M=M.replace(".000",""));return M}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(M){M=this.toDateTime().plus(M);return z.fromDateTime(M)}}d.SqlTimeStampOffset=z;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(d,e,B,z){function M(f){if(!f)return"";const v=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let g="";for(const p of f.match(v)||
[])switch(p){case "SSS":g+=p;break;case "A":case "a":g+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":g+=p;break;default:g+=`'${p}'`}return g}class n{constructor(f,v,g,p){this._hour=f;this._minute=v;this._second=g;this._millisecond=p;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(f){return f instanceof n&&f.hour===
this.hour&&f.minute===this.minute&&f.second===this.second&&f.millisecond===this.millisecond}clone(){return new n(this.hour,this.minute,this.second,this.millisecond)}isValid(){return e.isInteger(this.hour)&&e.isInteger(this.minute)&&e.isInteger(this.second)&&e.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(f=null){return null===f||""===f?this.toString():(f=M(f))?z.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(f,{locale:B.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(f,v,g,p){f=new n(f,v,g,p);return f.isValid()?f:null}static fromReader(f){if(!f)return null;f=f.split(":");return 3!==f.length?null:new n(parseInt(f[0],10),parseInt(f[1],10),parseInt(f[2],
10),0)}static fromMilliseconds(f){return 864E5<f||0>f?null:new n(Math.floor(f/36E5%24),Math.floor(f/6E4%60),Math.floor(f/1E3%60),Math.floor(f%1E3))}static fromDateJS(f){return new n(f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds())}static fromDateTime(f){return new n(f.hour,f.minute,f.second,f.millisecond)}static fromSqlTimeStampOffset(f){return this.fromDateTime(f.toDateTime())}static fromString(f,v=null){if(""===f||null===f)return null;const g=[];if(v)(v=M(v))&&g.push(v);else if(null===
v||""===v)g.push("HH:mm:ss"),g.push("HH:mm:ss.SSS"),g.push("hh:mm:ss a"),g.push("hh:mm:ss.SSS a"),g.push("HH:mm"),g.push("hh:mm a"),g.push("H:mm"),g.push("h:mm a"),g.push("H:mm:ss"),g.push("h:mm:ss a"),g.push("H:mm:ss.SSS"),g.push("h:mm:ss.SSS a");for(const p of g)if(v=z.DateTime.fromFormat(f,p),v.isValid)return new n(v.hour,v.minute,v.second,v.millisecond);return null}plus(f,v){switch(f){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return n.fromDateTime(this.toUTCDateTime().plus({[f]:v}))}return null}toUTCDateTime(){return z.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(f,v){switch(v.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(f.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===v?this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(f.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(f.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(f.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(f.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds}}}d.TimeOnly=n;d.standardiseTimeFormat=M;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(d,e){d.cloneGeometry=function(B){if(null==B)return null;const z=B.clone();void 0!==B.cache._geVersion&&(z.cache._geVersion=B.cache._geVersion);return z};d.convertLinearUnitsToCode=function(B){if(null==B)return null;if("number"===typeof B)return B;B=B.toLowerCase();B=B.replaceAll(/\s/g,"");B=B.replaceAll("-","");switch(B){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};d.convertSquareUnitsToCode=
function(B){if(null==B)return null;if("number"===typeof B)return B;B=B.toLowerCase();B=B.replaceAll(/\s/g,"");B=B.replaceAll("-","");switch(B){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};d.isInteger=function(B){return"number"===typeof B&&isFinite(B)&&Math.floor(B)===B};d.sameGeomType=function(B,z){return B===z||"point"===B&&"esriGeometryPoint"===z||"polyline"===B&&"esriGeometryPolyline"===
z||"polygon"===B&&"esriGeometryPolygon"===z||"extent"===B&&"esriGeometryEnvelope"===z||"multipoint"===B&&"esriGeometryMultipoint"===z||"point"===z&&"esriGeometryPoint"===B||"polyline"===z&&"esriGeometryPolyline"===B||"polygon"===z&&"esriGeometryPolygon"===B||"extent"===z&&"esriGeometryEnvelope"===B||"multipoint"===z&&"esriGeometryMultipoint"===B?!0:!1};d.shapeExtent=function(B){if(null==B)return null;switch(B.type){case "polygon":case "multipoint":case "polyline":return B.extent;case "point":return new e({xmin:B.x,
ymin:B.y,xmax:B.x,ymax:B.y,spatialReference:B.spatialReference});case "extent":return B}return null};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","../../arcade/featureset/support/errorsupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(d,e,B,z,M){function n(x,G,K){switch(K){case "+":return x+G;case "-":return x-G;case "*":return x*G;case "/":return x/G}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function f(x,G,K){switch(K){case "+":return G.plus({milliseconds:x.valueInMilliseconds()});case "-":return x.valueInMilliseconds()-G.toMillis()}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function v(x,G,K){switch(K){case "+":return G.plus("milliseconds",x.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function g(x,G,K){switch(K){case "+":return G.plus("milliseconds",x.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function p(x,
G,K){switch(K){case "+":return x.plus("milliseconds",G.valueInMilliseconds());case "-":return x.plus("milliseconds",-1*G.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function w(x,G,K){switch(K){case "+":return G.addMilliseconds(x.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function I(x,G,K){switch(K){case "+":return z.SqlInterval.createFromMilliseconds(x.valueInMilliseconds()+G.valueInMilliseconds());case "-":return z.SqlInterval.createFromMilliseconds(x.valueInMilliseconds()-
G.valueInMilliseconds());case "*":return z.SqlInterval.createFromMilliseconds(x.valueInMilliseconds()*G.valueInMilliseconds());case "/":return z.SqlInterval.createFromMilliseconds(x.valueInMilliseconds()/G.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function E(x,G,K){switch(K){case "+":return z.SqlInterval.createFromMilliseconds(x.valueInMilliseconds()+G);case "-":return z.SqlInterval.createFromMilliseconds(x.valueInMilliseconds()-G);case "*":return z.SqlInterval.createFromMilliseconds(x.valueInMilliseconds()*
G);case "/":return z.SqlInterval.createFromMilliseconds(x.valueInMilliseconds()/G)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function t(x,G,K){switch(K){case "+":return z.SqlInterval.createFromMilliseconds(x+G.valueInMilliseconds());case "-":return z.SqlInterval.createFromMilliseconds(x-G.valueInMilliseconds());case "*":return z.SqlInterval.createFromMilliseconds(x*G.valueInMilliseconds());case "/":return z.SqlInterval.createFromMilliseconds(x/G.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function q(x,G,K){switch(K){case "+":return x.plus("milliseconds",G.valueInMilliseconds());case "-":return x.plus("milliseconds",-1*G.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function a(x,G,K){switch(K){case "+":return x.plus({milliseconds:G.valueInMilliseconds()});case "-":return x.minus({milliseconds:G.valueInMilliseconds()})}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function r(x,G,K){switch(K){case "+":return x.addMilliseconds(G.valueInMilliseconds());
case "-":return x.addMilliseconds(-1*G.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function y(x,G,K){G*=864E5;switch(K){case "+":return x.plus({milliseconds:G});case "-":return x.minus({milliseconds:G})}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function F(x,G,K){G*=864E5;switch(K){case "+":return x.plus("milliseconds",G);case "-":return x.plus("milliseconds",-1*G)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function S(x,G,K){G*=864E5;switch(K){case "+":return x.plus("milliseconds",
G);case "-":return x.plus("milliseconds",-1*G)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function b(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function A(x,G,K){G*=864E5;switch(K){case "+":return x.addMilliseconds(G);case "-":return x.addMilliseconds(-1*G)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function R(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function H(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Q(x,
G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function N(x,G,K){G=parseFloat(G);if(isNaN(G))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);return n(x,G,K)}function T(x,G,K){x=parseFloat(x);if(isNaN(x))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);return n(x,G,K)}function l(x,G,K){switch(K){case "+":return x+G}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function O(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function m(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function u(x,G,K){switch(K){case "-":return x.toDateTimeLuxon(G.zone).diff(G).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function J(x,G,K){switch(K){case "-":return x.toDateTimeLuxon(G.toDateTime().zone).diff(G.toDateTime()).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function L(x,G,K){switch(K){case "-":return x.toDateTimeLuxon("UTC").diff(G.toDateTimeLuxon("UTC")).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function U(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function Y(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function ea(x,G,K){switch(K){case "-":return x.toDateTime().diff(G.toDateTimeLuxon(x.toDateTime().zone)).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function la(x,G,K){switch(K){case "-":return x.toDateTime().diff(G).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function na(x,G,K){switch(K){case "-":return x.toDateTime().diff(G.toDateTime()).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function ta(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function ua(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function sa(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function va(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function xa(x,G,K){switch(K){case "-":return x.diff(G).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Da(x,G,K){switch(K){case "-":return x.diff(G.toDateTimeLuxon(x.zone)).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function Ia(x,G,K){switch(K){case "-":return x.diff(G.toDateTime()).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Pa(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Na(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Sa(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Va(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function h(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function D(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function X(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function aa(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function ha(x,G,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}d.calculateDateOnlyAndDateOnly=L;d.calculateDateOnlyAndDateTime=u;d.calculateDateOnlyAndNumber=F;d.calculateDateOnlyAndSqlInterval=q;d.calculateDateOnlyAndString=Na;d.calculateDateOnlyAndTimeOnly=U;d.calculateDateOnlyAndTimestamp=
J;d.calculateDateTimeAndDateOnly=Da;d.calculateDateTimeAndDateTime=xa;d.calculateDateTimeAndNumber=y;d.calculateDateTimeAndSqlInterval=a;d.calculateDateTimeAndString=Va;d.calculateDateTimeAndTimeOnly=Pa;d.calculateDateTimeAndTimestamp=Ia;d.calculateNumberAndDateOnly=Q;d.calculateNumberAndDateTime=b;d.calculateNumberAndNumber=n;d.calculateNumberAndSqlInterval=t;d.calculateNumberAndString=N;d.calculateNumberAndTimeOnly=H;d.calculateNumberAndTimestamp=R;d.calculateSqlIntervalAndDateOnly=g;d.calculateSqlIntervalAndDateTime=
f;d.calculateSqlIntervalAndNumber=E;d.calculateSqlIntervalAndSqlInterval=I;d.calculateSqlIntervalAndString=O;d.calculateSqlIntervalAndTimeOnly=v;d.calculateSqlIntervalAndTimestamp=w;d.calculateStringAndDateOnly=X;d.calculateStringAndDateTime=aa;d.calculateStringAndNumber=T;d.calculateStringAndSqlInterval=m;d.calculateStringAndString=l;d.calculateStringAndTimeOnly=D;d.calculateStringAndTimestamp=ha;d.calculateTimeOnlyAndDateOnly=ua;d.calculateTimeOnlyAndDateTime=ta;d.calculateTimeOnlyAndNumber=S;d.calculateTimeOnlyAndSqlInterval=
p;d.calculateTimeOnlyAndString=Sa;d.calculateTimeOnlyAndTimeOnly=va;d.calculateTimeOnlyAndTimestamp=sa;d.calculateTimestampAndDateOnly=ea;d.calculateTimestampAndDateTime=la;d.calculateTimestampAndNumber=A;d.calculateTimestampAndSqlInterval=r;d.calculateTimestampAndString=h;d.calculateTimestampAndTimeOnly=Y;d.calculateTimestampAndTimestamp=na;d.sqlCalculateFunction=function(x,G,K,W){if("||"===x)return M.evaluateFunction("concat",[G,K],W);if(null===G||null===K)return null;if(B.isNumber(G)){if(B.isNumber(K))return n(G,
K,x);if(B.isSqlInterval(K))return t(G,K,x);if(B.isTimeOnly(K))return H();if(B.isDateOnly(K))return Q();if(B.isTimestampOffset(K))return R();if(B.isDateTime(K))return b();if(B.isString(K))return N(G,K,x)}else if(B.isDateOnly(G)){if(B.isNumber(K))return F(G,K,x);if(B.isSqlInterval(K))return q(G,K,x);if(B.isTimeOnly(K))return U();if(B.isDateOnly(K))return L(G,K,x);if(B.isTimestampOffset(K))return J(G,K,x);if(B.isDateTime(K))return u(G,K,x);if(B.isString(K))return Na()}else if(B.isTimeOnly(G)){if(B.isNumber(K))return S(G,
K,x);if(B.isSqlInterval(K))return p(G,K,x);if(B.isTimeOnly(K))return va();if(B.isDateOnly(K))return ua();if(B.isTimestampOffset(K))return sa();if(B.isDateTime(K))return ta();if(B.isString(K))return Sa()}else if(B.isSqlInterval(G)){if(B.isNumber(K))return E(G,K,x);if(B.isSqlInterval(K))return I(G,K,x);if(B.isTimeOnly(K))return v(G,K,x);if(B.isDateOnly(K))return g(G,K,x);if(B.isTimestampOffset(K))return w(G,K,x);if(B.isDateTime(K))return f(G,K,x);if(B.isString(K))return O()}else if(B.isDateTime(G)){if(B.isNumber(K))return y(G,
K,x);if(B.isSqlInterval(K))return a(G,K,x);if(B.isTimeOnly(K))return Pa();if(B.isDateOnly(K))return Da(G,K,x);if(B.isTimestampOffset(K))return Ia(G,K,x);if(B.isDateTime(K))return xa(G,K,x);if(B.isString(K))return Va()}else if(B.isTimestampOffset(G)){if(B.isNumber(K))return A(G,K,x);if(B.isSqlInterval(K))return r(G,K,x);if(B.isTimeOnly(K))return Y();if(B.isDateOnly(K))return ea(G,K,x);if(B.isTimestampOffset(K))return na(G,K,x);if(B.isDateTime(K))return la(G,K,x);if(B.isString(K))return h()}else if(B.isString(G)){if(B.isNumber(K))return T(G,
K,x);if(B.isSqlInterval(K))return m();if(B.isTimeOnly(K))return D();if(B.isDateOnly(K))return X();if(B.isTimestampOffset(K))return ha();if(B.isDateTime(K))return aa();if(B.isString(K))return l(G,K,x)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(d,e,B,z,M,n,f,v){function g(y,F,S){S=t.exec(y);if(null!==S){const [,b,A,R,H,Q,N,T]=S;y=v.DateTime.fromObject({year:parseInt(b,10),month:parseInt(A,10),day:parseInt(R,10),hour:parseInt(H,10),minute:parseInt(Q,10),second:parseInt(N,10),millisecond:T?parseInt(T.replace(".",""),10):0},{zone:f.substituteUnknownTimezone(F)});if(!1===y.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);return y}S=q.exec(y);if(null!==S){const [,b,A,R,H,Q,N,T,l,O,m]=S;y=M.SqlTimeStampOffset.fromParts(parseInt(b,
10),parseInt(A,10),parseInt(R,10),parseInt(H,10),parseInt(Q,10),parseInt(N,10),T?parseInt(T.replace(".",""),10):0,"-"===l,parseInt(O,10),parseInt(m,10));if(!1===y.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);return y}S=a.exec(y);if(null!==S){const [,b,A,R,H,Q,N,T,l]=S;y=M.SqlTimeStampOffset.fromParts(parseInt(b,10),parseInt(A,10),parseInt(R,10),parseInt(H,10),parseInt(Q,10),0,0,"-"===N,parseInt(T,10),parseInt(l,10));if(!1===y.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);
return y}S=r.exec(y);if(null!==S){const [,b,A,R,H,Q]=S;y=v.DateTime.fromObject({year:parseInt(b,10),month:parseInt(A,10),day:parseInt(R,10),hour:parseInt(H,10),minute:parseInt(Q,10),second:0},{zone:f.substituteUnknownTimezone(F)});if(!1===y.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);return y}S=E.exec(y);if(null!==S){const [,b,A,R]=S;y=v.DateTime.fromObject({year:parseInt(b,10),month:parseInt(A,10),day:parseInt(R,10),hour:0,minute:0,second:0},{zone:f.substituteUnknownTimezone(F)});
if(!1===y.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);return y}throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);}const p=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,w=/^(\d{1,2}):(\d{1,2})$/,I=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,E=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,t=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,a=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,
r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;d.convertToExecutingTimeZone=function(y,F){if(F instanceof v.Zone)return F===f.UnknownTimeZone.instance?v.DateTime.fromMillis(y.getTime(),{zone:f.UnknownTimeZone.instance}):v.DateTime.fromJSDate(y,{zone:F});switch(F){case "system":case "local":case null:return v.DateTime.fromJSDate(y);default:return"unknown"===F?.toLowerCase()?v.DateTime.fromMillis(y.getTime(),{zone:f.UnknownTimeZone.instance}):v.DateTime.fromJSDate(y,{zone:F})}};d.isDate=function(y){return y instanceof
Date};d.isDateOnly=function(y){return y instanceof B.DateOnly};d.isDateTime=function(y){return y instanceof v.DateTime};d.isNumber=function(y){return"number"===typeof y};d.isSqlInterval=function(y){return y instanceof z.SqlInterval};d.isString=function(y){return"string"===typeof y||y instanceof String};d.isTimeOnly=function(y){return y instanceof n.TimeOnly};d.isTimestampOffset=function(y){return y instanceof M.SqlTimeStampOffset};d.parseDate=function(y,F){const S=E.exec(y);if(null===S)try{return g(y,
F)}catch{throw new e.SqlError(e.SqlErrorCodes.InvalidDate);}const [,b,A,R]=S;y=B.DateOnly.fromParts(parseInt(b,10),parseInt(A,10),parseInt(R,10));if(null===y)throw new e.SqlError(e.SqlErrorCodes.InvalidDate);return y};d.parseTime=function(y){let F=p.exec(y);if(null!==F){const [,S,b,A]=F;y=n.TimeOnly.fromParts(parseInt(S,10),parseInt(b,10),parseInt(A,10),0);if(null!==y)return y;throw new e.SqlError(e.SqlErrorCodes.InvalidTime);}F=w.exec(y);if(null!==F){const [,S,b]=F;y=n.TimeOnly.fromParts(parseInt(S,
10),parseInt(b,10),0,0);if(null!==y)return y;throw new e.SqlError(e.SqlErrorCodes.InvalidTime);}F=I.exec(y);if(null!==F){const [,S,b,A,R]=F;y=n.TimeOnly.fromParts(parseInt(S,10),parseInt(b,10),parseInt(A,10),parseInt(R,10));if(null!==y)return y}throw new e.SqlError(e.SqlErrorCodes.InvalidTime);};d.parseTimestamp=g;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","../../arcade/featureset/support/errorsupport"],function(d,e){class B{constructor(){this.op=
"+";this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(z){if(null!==z.precision||null!==z.secondary)throw new e.SqlError(e.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(z,M){M.includes(".")?(M=M.split("."),z.second=parseFloat(M[0]),z.millis=parseInt(M[1],10)):z.second=parseFloat(M)}static createFromMilliseconds(z){const M=new B;M.second=z/1E3;return M}static createFromValueAndQualifer(z,M,n){let f=null;const v=new B;v.op="-"===
n?"-":"+";if("interval-period"===M.type){B._fixDefaults(M);n=RegExp("^[0-9]{1,}$");if("year"===M.period||"month"===M.period)throw new e.SqlError(e.SqlErrorCodes.YearMonthIntervals);if("second"===M.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(z))B._parseSecondsComponent(v,z);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);else if(n.test(z))v[M.period]=parseFloat(z);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);}else{B._fixDefaults(M.start);B._fixDefaults(M.end);if("year"===
M.start.period||"month"===M.start.period||"year"===M.end.period||"month"===M.end.period)throw new e.SqlError(e.SqlErrorCodes.YearMonthIntervals);switch(M.start.period){case "day":switch(M.end.period){case "hour":f=RegExp("^[0-9]{1,} [0-9]{1,}$");if(f.test(z))v[M.start.period]=parseFloat(z.split(" ")[0]),v[M.end.period]=parseFloat(z.split(" ")[1]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;case "minute":f=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(f.test(z))v[M.start.period]=
parseFloat(z.split(" ")[0]),z=z.split(" ")[1].split(":"),v.hour=parseFloat(z[0]),v.minute=parseFloat(z[1]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;case "second":f=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(f.test(z))v[M.start.period]=parseFloat(z.split(" ")[0]),z=z.split(" ")[1].split(":"),v.hour=parseFloat(z[0]),v.minute=parseFloat(z[1]),B._parseSecondsComponent(v,z[2]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;default:throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(M.end.period){case "minute":f=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(f.test(z))v.hour=parseFloat(z.split(":")[0]),v.minute=parseFloat(z.split(":")[1]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;case "second":f=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(f.test(z))z=z.split(":"),v.hour=parseFloat(z[0]),v.minute=parseFloat(z[1]),B._parseSecondsComponent(v,z[2]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;default:throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(M.end.period){case "second":f=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(f.test(z))z=z.split(":"),v.minute=parseFloat(z[0]),B._parseSecondsComponent(v,z[1]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;default:throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);}break;default:throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);}}return v}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}d.SqlInterval=B;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ../string ./DateOnly ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(d,e,B,z,M,n,f,v){function g(a){return"string"===typeof a||a instanceof String}function p(a){return n.isDate(a)||n.isDateOnly(a)||
n.isDateTime(a)||n.isTimeOnly(a)||n.isTimestampOffset(a)?!1:!0}function w(a){return n.isDateOnly(a)||n.isTimeOnly(a)?a.toString():n.isTimestampOffset(a)?a.toSQLValue():n.isDateTime(a)?0===a.millisecond?a.toFormat("yyyy-LL-dd HH:mm:ss"):a.toSQL({includeOffset:!1}):n.isDate(a)?w(v.DateTime.fromJSDate(a)):a.toString()}function I(a){if(n.isDate(a))return z.DateOnly.fromDateJS(a);if(n.isDateTime(a))return z.DateOnly.fromParts(a.year,a.month,a.day);if(n.isDateOnly(a))return a;if(n.isTimeOnly(a))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);
if(n.isTimestampOffset(a)&&null===z.DateOnly.fromParts(a.year,a.month,a.day))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);if(g(a)&&(a=z.DateOnly.fromReader(a),null!==a&&a.isValid))return a;throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);}function E(a,r,y){if(n.isDate(a))return n.convertToExecutingTimeZone(a,r);if(n.isDateTime(a))return a;if(n.isDateOnly(a))return a.toDateTimeLuxon("unknown");if(n.isTimeOnly(a))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);if(n.isTimestampOffset(a))return a;
if(g(a))return n.parseTimestamp(a,"unknown",y);throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);}function t(a){if(n.isDate(a))return f.TimeOnly.fromDateJS(a);if(n.isDateTime(a))return f.TimeOnly.fromDateTime(a);if(n.isDateOnly(a))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);if(n.isTimeOnly(a))return a;if(n.isTimestampOffset(a))return f.TimeOnly.fromSqlTimeStampOffset(a);if(g(a))return n.parseTime(a);throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);}const q={extract:{minParams:2,
maxParams:2,evaluate:([a,r])=>{if(null==r)return null;if(n.isDate(r))switch(a.toUpperCase()){case "SECOND":return r.getSeconds();case "MINUTE":return r.getMinutes();case "HOUR":return r.getHours();case "DAY":return r.getDate();case "MONTH":return r.getMonth()+1;case "YEAR":return r.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(n.isDateTime(r))switch(a.toUpperCase()){case "SECOND":return r.second;case "MINUTE":return r.minute;case "HOUR":return r.hour;case "DAY":return r.day;
case "MONTH":return r.month;case "YEAR":return r.year}else if(n.isDateOnly(r))switch(a.toUpperCase()){case "DAY":return r.day;case "MONTH":return r.month;case "YEAR":return r.year}else if(n.isTimeOnly(r))switch(a.toUpperCase()){case "SECOND":return r.second;case "MINUTE":return r.minute;case "HOUR":return r.hour}else if(n.isTimestampOffset(r))switch(a.toUpperCase()){case "SECOND":return r.second;case "MINUTE":return r.minute;case "HOUR":return r.hour;case "DAY":return r.day;case "MONTH":return r.month;
case "YEAR":return r.year;case "TIMEZONE_HOUR":return r.timezoneOffsetHour;case "TIMEZONE_MINUTE":return r.timezoneOffsetMinutes}throw new e.SqlError(e.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:a=>{if(2===a.length){const [r,y]=a;return null==r||null==y?null:r.toString().substring(y-1)}if(3===a.length){const [r,y,F]=a;return null==r||null==y||null==F?null:0>=F?"":r.toString().substring(y-1,y+F-1)}}},position:{minParams:2,maxParams:2,
evaluate:([a,r])=>null==a||null==r?null:r.indexOf(a)+1},trim:{minParams:2,maxParams:3,evaluate:a=>{var r=3===a.length,y=r?a[1]:" ";r=r?a[2]:a[1];if(null==y||null==r)return null;y=`(${B.escapeRegExpString(y)})`;switch(a[0]){case "BOTH":return r.replaceAll(new RegExp(`^${y}*|${y}*$`,"g"),"");case "LEADING":return r.replaceAll(new RegExp(`^${y}*`,"g"),"");case "TRAILING":return r.replaceAll(new RegExp(`${y}*$`,"g"),"")}throw new e.SqlError(e.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.abs(a[0])},ceiling:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.ceil(a[0])},floor:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.floor(a[0])},log:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])},log10:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sin(a[0])},cos:{minParams:1,maxParams:1,evaluate:a=>
null==a[0]?null:Math.cos(a[0])},tan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.tan(a[0])},asin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.asin(a[0])},acos:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.acos(a[0])},atan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.atan(a[0])},sign:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:0<a[0]?1:0>a[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]**a[1]},mod:{minParams:2,
maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]%a[1]},round:{minParams:1,maxParams:2,evaluate:a=>{const r=a[0];a=2===a.length?10**a[1]:1;return null==r?null:Math.round(r*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:a=>null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))},char_length:{minParams:1,maxParams:1,evaluate:a=>g(a[0])?a[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:a=>{let r="";for(let y=0;y<a.length;y++){if(null==a[y])return null;
r+=a[y].toString()}return r}},lower:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:a=>{for(const r of a)if(null!==r)return r;return null}},cosh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.cosh(a[0])},sinh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sinh(a[0])},tanh:{minParams:1,maxParams:1,evaluate:a=>
null==a[0]?null:Math.tanh(a[0])},nullif:{minParams:2,maxParams:2,evaluate:(a,r)=>M.sqlCompare(a[0],a[1],"\x3d")?null:a[0]},cast:{minParams:2,maxParams:2,evaluate:(a,r)=>{const y=a[0];a=a[1];if(null===y)return null;switch(a.type){case "integer":if(!p(y))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);r=parseInt(y,10);if(isNaN(r))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);return r;case "smallint":if(!p(y))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);r=parseInt(y,10);if(isNaN(r))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);
if(32767<r||-32767>r)throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);return r;case "float":case "real":if(!p(y))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);r=parseFloat(y);if(isNaN(r))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);return r;case "time":return t(y);case "date":return I(y);case "timestamp":return E(y,r,!0===a.withtimezone);case "varchar":r=w(y);if(r.length>a.size)throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);return r;default:throw new e.SqlError(e.SqlErrorCodes.InvalidDataType);
}}}};d.evaluateFunction=function(a,r,y){const F=q[a.toLowerCase()];if(null==F)throw new e.SqlError(e.SqlErrorCodes.FunctionNotRecognized);if(r.length<F.minParams||r.length>F.maxParams)throw new e.SqlError(e.SqlErrorCodes.InvalidParameterCount,{name:a.toUpperCase()});return F.evaluate(r,y)};d.isStandardized=function(a,r){a=q[a.toLowerCase()];return null!=a&&r>=a.minParams&&r<=a.maxParams};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(d,e,B,z,M,n){function f(a){return B.isDateTime(a)||B.isTimestampOffset(a)?!0:!1}function v(a){return B.isDateTime(a)||B.isDateOnly(a)||B.isTimestampOffset(a)||B.isTimeOnly(a)?!0:!1}function g(a){if(B.isDateTime(a))return a.toMillis();if(B.isDateOnly(a))return a.toNumber();if(B.isTimestampOffset(a))return a.toMilliseconds();throw new e.SqlError(e.SqlErrorCodes.InvalidDataType);}function p(a,r,y){switch(y){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<
r;case "\x3e\x3d":return a>=r;case "\x3c\x3d":return a<=r}}function w(a,r,y){const F=parseFloat(r);if(!isNaN(F))return p(a,F,y);a=a.toString();switch(y){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<r;case "\x3e\x3d":return a>=r;case "\x3c\x3d":return a<=r}}function I(a,r,y){const F=parseFloat(a);if(!isNaN(F))return p(F,r,y);r=r.toString();switch(y){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<
r;case "\x3e\x3d":return a>=r;case "\x3c\x3d":return a<=r}}function E(a,r,y){switch(y){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<r;case "\x3e\x3d":return a>=r;case "\x3c\x3d":return a<=r}}function t(a,r,y){a instanceof z.SqlTimeStampOffset&&(a=a.toDateTime());r instanceof z.SqlTimeStampOffset&&(r=r.toDateTime());a=q(a);r=q(r);switch(y){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<r;case "\x3e\x3d":return a>=
r;case "\x3c\x3d":return a<=r}}function q(a){return 321408E5*a.year+26784E5*a.month+864E5*a.day+36E5*a.hour+6E4*a.minute+1E3*a.second+a.millisecond}d.dateValueInMilliseconds=g;d.isDateOrTimeValue=v;d.isDateTimeComparableValue=f;d.sqlCompare=function(a,r,y,F){if(null==a||null==r)return null;if(B.isNumber(a)){if(B.isNumber(r))return p(a,r,y);if(B.isString(r))return w(a,r,y);if(v(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isDateOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}else if(B.isString(a)){if(B.isNumber(r))return I(a,r,y);if(B.isString(r))return E(a,r,y);if(B.isDateTime(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isDateOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isTimeOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isTimestampOffset(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}else if(B.isDateTime(a)){if(f(r)){if(a instanceof n.DateTime&&M.isUnknownTimeZone(a.zone)){if(r instanceof n.DateTime&&
!1===M.isUnknownTimeZone(r.zone)||r instanceof z.SqlTimeStampOffset)return t(a,r,y)}else if(r instanceof n.DateTime&&M.isUnknownTimeZone(r.zone)&&(a instanceof n.DateTime&&!1===M.isUnknownTimeZone(a.zone)||a instanceof z.SqlTimeStampOffset))return t(a,r,y);return p(g(a),g(r),y)}if(B.isString(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isDateOnly(r))return r=r.toDateTimeLuxon(a.zone),a=a.startOf("day"),p(a.toMillis(),r.toMillis(),y);if(B.isTimeOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
if(B.isNumber(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}else if(B.isDateOnly(a)){if(B.isTimestampOffset(r))return a=a.toDateTimeLuxon(r.toDateTime().zone),r=r.startOfDay(),p(a.toMillis(),r.toMilliseconds(),y);if(B.isDateTime(r))return a=a.toDateTimeLuxon(r.zone),r=r.startOf("day"),p(a.toMillis(),r.toMillis(),y);if(B.isString(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isDateOnly(r))return p(a.toNumber(),r.toNumber(),y);if(B.isTimeOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
if(B.isNumber(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}else if(B.isTimeOnly(a)){if(B.isTimeOnly(r))return p(a.toNumber(),r.toNumber(),y);if(B.isString(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isNumber(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isDateOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(f(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}else if(B.isTimestampOffset(a)){if(f(r))return r instanceof n.DateTime&&
M.isUnknownTimeZone(r.zone)?t(a,r,y):p(g(a),g(r),y);if(B.isString(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isDateOnly(r))return r=r.toDateTimeLuxon(a.toDateTime().zone),a=a.startOfDay(),p(a.toMilliseconds(),r.toMillis(),y);if(B.isTimeOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(B.isNumber(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}switch(y){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<r;case "\x3e\x3d":return a>=
r;case "\x3c\x3d":return a<=r}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(d,e){var B={exports:{}};B.exports;(function(n){(function(f,v){n.exports&&(n.exports=v())})(e.commonjsGlobal,function(){function f(g,p,w,I){g=Error.call(this,g);Object.setPrototypeOf&&Object.setPrototypeOf(g,f.prototype);g.expected=p;g.found=w;g.location=I;g.name="SyntaxError";return g}function v(g,p,w){w=
w||" ";if(g.length>p)return g;p-=g.length;w+=w.repeat(p);return g+w.slice(0,p)}(function(g,p){function w(){this.constructor=g}w.prototype=p.prototype;g.prototype=new w})(f,Error);f.prototype.format=function(g){var p="Error: "+this.message;if(this.location){var w=null,I;for(I=0;I<g.length;I++)if(g[I].source===this.location.source){w=g[I].text.split(/\r\n|\n|\r/g);break}g=this.location.start;I=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(g):g;var E=
this.location.source+":"+I.line+":"+I.column;if(w){var t=this.location.end,q=v("",I.line.toString().length," ");w=w[g.line-1];t=(g.line===t.line?t.column:w.length+1)-g.column||1;p+="\n --\x3e "+E+"\n"+q+" |\n"+I.line+" | "+w+"\n"+q+" | "+v("",g.column-1," ")+v("",t,"^")}else p+="\n at "+E}return p};f.buildMessage=function(g,p){function w(a){return a.charCodeAt(0).toString(16).toUpperCase()}function I(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,
"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(r){return"\\x0"+w(r)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(r){return"\\x"+w(r)})}function E(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(r){return"\\x0"+w(r)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(r){return"\\x"+w(r)})}function t(a){return q[a.type](a)}var q={literal:function(a){return'"'+
I(a.text)+'"'},class:function(a){var r=a.parts.map(function(y){return Array.isArray(y)?E(y[0])+"-"+E(y[1]):E(y)});return"["+(a.inverted?"^":"")+r.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){a=a.map(t);var r,y;a.sort();if(0<a.length){for(y=r=1;r<a.length;r++)a[r-1]!==a[r]&&(a[y]=a[r],y++);a.length=y}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,
-1).join(", ")+", or "+a[a.length-1]}}(g)+" but "+(p?'"'+I(p)+'"':"end of input")+" found."};return{SyntaxError:f,parse:function(g,p){function w(C,P){P=void 0!==P?P:q(ma,k);throw new f(C,null,null,P);}function I(C,P){return{type:"literal",text:C,ignoreCase:P}}function E(C,P,V){return{type:"class",parts:C,inverted:P,ignoreCase:V}}function t(C){var P=Zb[C],V;if(!P){for(V=C-1;!Zb[V];)V--;P=Zb[V];for(P={line:P.line,column:P.column};V<C;)10===g.charCodeAt(V)?(P.line++,P.column=1):P.column++,V++;Zb[C]=
P}return P}function q(C,P,V){var ca=t(C),pa=t(P);C={source:Mb,start:{offset:C,line:ca.line,column:ca.column},end:{offset:P,line:pa.line,column:pa.column}};V&&Mb&&"function"===typeof Mb.offset&&(C.start=Mb.offset(C.start),C.end=Mb.offset(C.end));return C}function a(C){k<eb||(k>eb&&(eb=k,zc=[]),zc.push(C))}function r(){var C=k;ja();var P=F();P!==c?(ja(),ma=C,C=P):(k=C,C=c);return C}function y(){var C=k;var P=F();if(P!==c){var V=[];var ca=k;var pa=ja();var za=Wa();if(za!==c){var Ea=ja();var Fa=F();Fa!==
c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)}else k=ca,ca=c;for(;ca!==c;)V.push(ca),ca=k,pa=ja(),za=Wa(),za!==c?(Ea=ja(),Fa=F(),Fa!==c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)):(k=ca,ca=c);ma=C;C={type:"expression-list"};P=[P];for(ca=0;ca<V.length;ca++)P.push(V[ca][3]);C.value=P}else k=C,C=c;return C}function F(){var C=k;var P=S();if(P!==c){var V=[];var ca=k;var pa=ja();var za=K();if(za!==c){var Ea=ja();var Fa=S();Fa!==c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)}else k=ca,ca=c;for(;ca!==c;)V.push(ca),ca=k,pa=ja(),za=K(),za!==
c?(Ea=ja(),Fa=S(),Fa!==c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)):(k=ca,ca=c);ma=C;C=nb(P,V)}else k=C,C=c;return C}function S(){var C=k;var P=b();if(P!==c){var V=[];var ca=k;var pa=ja();var za=G();if(za!==c){var Ea=ja();var Fa=b();Fa!==c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)}else k=ca,ca=c;for(;ca!==c;)V.push(ca),ca=k,pa=ja(),za=G(),za!==c?(Ea=ja(),Fa=b(),Fa!==c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)):(k=ca,ca=c);ma=C;C=nb(P,V)}else k=C,C=c;return C}function b(){var C=k;var P=x();if(P===c){P=k;if(33===g.charCodeAt(k)){var V=
Nd;k++}else V=c,0===fa&&a(Od);if(V!==c){var ca=k;fa++;if(61===g.charCodeAt(k)){var pa=Sc;k++}else pa=c,0===fa&&a(Tc);fa--;pa===c?ca=void 0:(k=ca,ca=c);ca!==c?P=V=[V,ca]:(k=P,P=c)}else k=P,P=c}P!==c?(V=ja(),ca=b(),ca!==c?(ma=C,C={type:"unary-expression",operator:"NOT",expr:ca}):(k=C,C=c)):(k=C,C=c);if(C===c){P=k;C=Q();if(C!==c){ja();V=k;ca=[];pa=k;var za=ja();var Ea=A();if(Ea!==c){var Fa=ja();var ob=Q();ob!==c?pa=za=[za,Ea,Fa,ob]:(k=pa,pa=c)}else k=pa,pa=c;if(pa!==c)for(;pa!==c;)ca.push(pa),pa=k,za=
ja(),Ea=A(),Ea!==c?(Fa=ja(),ob=Q(),ob!==c?pa=za=[za,Ea,Fa,ob]:(k=pa,pa=c)):(k=pa,pa=c);else ca=c;ca!==c&&(ma=V,ca={type:"arithmetic",tail:ca});V=ca;V===c&&(V=k,ca=H(),ca!==c?(ja(),pa=Ja(),pa!==c?(ja(),pa=y(),pa!==c?(ja(),za=Ka(),za!==c?(ma=V,V={op:ca,right:pa}):(k=V,V=c)):(k=V,V=c)):(k=V,V=c)):(k=V,V=c),V===c&&(V=k,ca=H(),ca!==c?(ja(),pa=Ja(),pa!==c?(ja(),pa=Ka(),pa!==c?(ma=V,V={op:ca,right:{type:"expression-list",value:[]}}):(k=V,V=c)):(k=V,V=c)):(k=V,V=c),V===c&&(V=k,ca=H(),ca!==c?(ja(),pa=ea(),
pa!==c?(ma=V,V={op:ca,right:pa}):(k=V,V=c)):(k=V,V=c))),V===c&&(V=k,za=x(),za!==c?(ja(),ca=W(),ca!==c?(ja(),pa=Q(),pa!==c?(ja(),Ea=G(),Ea!==c?(ja(),za=Q(),za!==c?(ma=V,V={op:"NOT"+ca,right:{type:"expression-list",value:[pa,za]}}):(k=V,V=c)):(k=V,V=c)):(k=V,V=c)):(k=V,V=c)):(k=V,V=c),V===c&&(V=k,za=W(),za!==c?(ja(),ca=Q(),ca!==c?(ja(),pa=G(),pa!==c?(ja(),Ea=Q(),Ea!==c?(ma=V,V={op:za,right:{type:"expression-list",value:[ca,Ea]}}):(k=V,V=c)):(k=V,V=c)):(k=V,V=c)):(k=V,V=c)),V===c&&(V=k,ca=aa(),ca!==
c?(ja(),pa=x(),pa!==c?(ja(),pa=Q(),pa!==c?(ma=V,V={op:ca+"NOT",right:pa}):(k=V,V=c)):(k=V,V=c)):(k=V,V=c),V===c&&(V=k,ca=aa(),ca!==c?(ja(),pa=Q(),pa!==c?(ma=V,V={op:ca,right:pa}):(k=V,V=c)):(k=V,V=c)),V===c&&(V=k,ca=R(),ca!==c?(ja(),pa=va(),pa!==c?(ja(),za=k,g.substr(k,6).toLowerCase()===Pd?(Ea=g.substr(k,6),k+=6):(Ea=c,0===fa&&a(Qd)),Ea!==c?(Ea=k,fa++,Fa=J(),fa--,Fa===c?Ea=void 0:(k=Ea,Ea=c),Ea!==c?(ma=za,za="ESCAPE"):(k=za,za=c)):(k=za,za=c),za!==c?(ja(),za=xa(),za!==c?(ma=V,V={op:ca,right:pa,escape:za.value}):
(k=V,V=c)):(k=V,V=c)):(k=V,V=c)):(k=V,V=c),V===c&&(V=k,ca=R(),ca!==c?(ja(),pa=va(),pa!==c?(ma=V,V={op:ca,right:pa,escape:""}):(k=V,V=c)):(k=V,V=c))))));V===c&&(V=null);ma=P;P=V;""==P||void 0==P||null==P?P=C:(V=null,P=V="arithmetic"==P.type?nb(C,P.tail):Nb(P.op,C,P.right,P.escape))}else k=P,P=c;C=P}return C}function A(){if(g.substr(k,2)===Uc){var C=Uc;k+=2}else C=c,0===fa&&a(Rd);C===c&&(62===g.charCodeAt(k)?(C=Sd,k++):(C=c,0===fa&&a(Td)),C===c&&(g.substr(k,2)===Vc?(C=Vc,k+=2):(C=c,0===fa&&a(Ud)),C===
c&&(g.substr(k,2)===Wc?(C=Wc,k+=2):(C=c,0===fa&&a(Vd)),C===c&&(60===g.charCodeAt(k)?(C=Wd,k++):(C=c,0===fa&&a(Xd)),C===c&&(61===g.charCodeAt(k)?(C=Sc,k++):(C=c,0===fa&&a(Tc)),C===c&&(g.substr(k,2)===Xc?(C=Xc,k+=2):(C=c,0===fa&&a(Yd))))))));return C}function R(){var C;var P=C=k;var V=x();if(V!==c){var ca=ja();var pa=ha();pa!==c?P=V=[V,ca,pa]:(k=P,P=c)}else k=P,P=c;P!==c&&(ma=C,P=P[0]+" "+P[2]);C=P;C===c&&(C=ha());return C}function H(){var C;var P=C=k;var V=x();if(V!==c){var ca=ja();var pa=X();pa!==
c?P=V=[V,ca,pa]:(k=P,P=c)}else k=P,P=c;P!==c&&(ma=C,P=P[0]+" "+P[2]);C=P;C===c&&(C=X());return C}function Q(){var C=k;var P=T();if(P!==c){var V=[];var ca=k;var pa=ja();var za=N();if(za!==c){var Ea=ja();var Fa=T();Fa!==c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)}else k=ca,ca=c;for(;ca!==c;)V.push(ca),ca=k,pa=ja(),za=N(),za!==c?(Ea=ja(),Fa=T(),Fa!==c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)):(k=ca,ca=c);ma=C;C=nb(P,V)}else k=C,C=c;return C}function N(){if(43===g.charCodeAt(k)){var C=Ac;k++}else C=c,0===fa&&a(Bc);C===
c&&(45===g.charCodeAt(k)?(C=Cc,k++):(C=c,0===fa&&a(Dc)),C===c&&(g.substr(k,2)===Yc?(C=Yc,k+=2):(C=c,0===fa&&a(Zd))));return C}function T(){var C=k;var P=O();if(P!==c){var V=[];var ca=k;var pa=ja();var za=l();if(za!==c){var Ea=ja();var Fa=O();Fa!==c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)}else k=ca,ca=c;for(;ca!==c;)V.push(ca),ca=k,pa=ja(),za=l(),za!==c?(Ea=ja(),Fa=O(),Fa!==c?ca=pa=[pa,za,Ea,Fa]:(k=ca,ca=c)):(k=ca,ca=c);ma=C;C=nb(P,V)}else k=C,C=c;return C}function l(){if(42===g.charCodeAt(k)){var C=$d;k++}else C=
c,0===fa&&a(ae);C===c&&(47===g.charCodeAt(k)?(C=be,k++):(C=c,0===fa&&a(ce)));return C}function O(){var C=xa();if(C===c){var P=k;var V=k;var ca=Na();if(ca!==c){var pa=Sa();if(pa!==c){var za=Va();za!==c?(ma=V,V=parseFloat(ca+pa+za)):(k=V,V=c)}else k=V,V=c}else k=V,V=c;V===c&&(V=k,ca=Na(),ca!==c?(pa=Sa(),pa!==c?(ma=V,V=parseFloat(ca+pa)):(k=V,V=c)):(k=V,V=c),V===c&&(V=k,ca=Na(),ca!==c?(pa=Va(),pa!==c?(ma=V,V=parseFloat(ca+pa)):(k=V,V=c)):(k=V,V=c),V===c&&(V=k,ca=Na(),ca!==c&&(ma=V,ca=parseFloat(ca)),
V=ca)));var Ea=V;if(Ea!==c){var Fa=k;fa++;var ob=u();fa--;ob===c?Fa=void 0:(k=Fa,Fa=c);Fa!==c?(ma=P,P={type:"number",value:Ea}):(k=P,P=c)}else k=P,P=c;C=P;if(C===c){var pb=k;var Jb=k;if(g.substr(k,4).toLowerCase()===de){var $b=g.substr(k,4);k+=4}else $b=c,0===fa&&a(ee);if($b!==c){var Ob=k;fa++;var fe=J();fa--;fe===c?Ob=void 0:(k=Ob,Ob=c);Ob!==c?Jb=$b=[$b,Ob]:(k=Jb,Jb=c)}else k=Jb,Jb=c;var qb=Jb;qb!==c&&(ma=pb,qb={type:"boolean",value:!0});pb=qb;if(pb===c){pb=k;var Kb=k;if(g.substr(k,5).toLowerCase()===
ge){var ac=g.substr(k,5);k+=5}else ac=c,0===fa&&a(he);if(ac!==c){var Pb=k;fa++;var ie=J();fa--;ie===c?Pb=void 0:(k=Pb,Pb=c);Pb!==c?Kb=ac=[ac,Pb]:(k=Kb,Kb=c)}else k=Kb,Kb=c;qb=Kb;qb!==c&&(ma=pb,qb={type:"boolean",value:!1});pb=qb}C=pb;if(C===c){var je=k;var Lb=k;if(g.substr(k,4).toLowerCase()===ke){var bc=g.substr(k,4);k+=4}else bc=c,0===fa&&a(le);if(bc!==c){var Qb=k;fa++;var me=J();fa--;me===c?Qb=void 0:(k=Qb,Qb=c);Qb!==c?Lb=bc=[bc,Qb]:(k=Lb,Lb=c)}else k=Lb,Lb=c;var Ec=Lb;Ec!==c&&(ma=je,Ec={type:"null",
value:null});C=Ec;if(C===c){var rb=k;if(ia()!==c){ja();var cc=va();cc!==c?(ma=rb,"string"===cc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(cc.value)&&w("Date literal is invalid"),rb={type:"date",
value:cc.value}):(k=rb,rb=c)}else k=rb,rb=c;C=rb;if(C===c){var sb=k;if(da()!==c){ja();var dc=va();dc!==c?(ma=sb,"string"===dc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(dc.value)&&w("Timestamp literal is invalid"),
sb={type:"timestamp",value:dc.value}):(k=sb,sb=c)}else k=sb,sb=c;C=sb;if(C===c){var Ta=k;var Fc=ra();if(Fc!==c){ja();if(45===g.charCodeAt(k)){var hb=Cc;k++}else hb=c,0===fa&&a(Dc);hb===c&&(43===g.charCodeAt(k)?(hb=Ac,k++):(hb=c,0===fa&&a(Bc)));if(hb!==c){ja();var Rb=va();if(Rb!==c){ja();var Zc=na();Zc!==c?(ma=Ta,Ta={type:"interval",value:Rb,qualifier:Zc,op:hb}):(k=Ta,Ta=c)}else k=Ta,Ta=c}else k=Ta,Ta=c}else k=Ta,Ta=c;Ta===c&&(Ta=k,Fc=ra(),Fc!==c?(ja(),hb=va(),hb!==c?(ja(),Rb=na(),Rb!==c?(ma=Ta,Ta=
{type:"interval",value:hb,qualifier:Rb,op:""}):(k=Ta,Ta=c)):(k=Ta,Ta=c)):(k=Ta,Ta=c));C=Ta;if(C===c){var tb=k;if(ka()!==c){ja();var ec=va();ec!==c?(ma=tb,"string"===ec.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(ec.value)&&w("Time literal is invalid"),tb={type:"time",value:ec.value}):(k=tb,tb=c)}else k=tb,tb=c;C=tb}}}}}}}var La=C;if(La===c){var Za=k;var ub=k;if(g.substr(k,7).toLowerCase()===ne){var $c=g.substr(k,7);k+=7}else $c=
c,0===fa&&a(oe);if($c!==c){var fc=k;fa++;var pe=J();fa--;pe===c?fc=void 0:(k=fc,fc=c);fc!==c?(ma=ub,ub="EXTRACT"):(k=ub,ub=c)}else k=ub,ub=c;if(ub!==c){ja();var qe=Ja();if(qe!==c){ja();var $a=oa();if($a===c&&($a=qa(),$a===c&&($a=Ca(),$a===c&&($a=wa(),$a===c&&($a=Ba(),$a===c&&($a=Aa(),$a===c)))))){var vb=k;if(g.substr(k,13).toLowerCase()===re){var ad=g.substr(k,13);k+=13}else ad=c,0===fa&&a(se);if(ad!==c){var gc=k;fa++;var te=J();fa--;te===c?gc=void 0:(k=gc,gc=c);gc!==c?(ma=vb,vb="TIMEZONE_HOUR"):
(k=vb,vb=c)}else k=vb,vb=c;$a=vb;if($a===c){var wb=k;if(g.substr(k,15).toLowerCase()===ue){var bd=g.substr(k,15);k+=15}else bd=c,0===fa&&a(ve);if(bd!==c){var hc=k;fa++;var we=J();fa--;we===c?hc=void 0:(k=hc,hc=c);hc!==c?(ma=wb,wb="TIMEZONE_MINUTE"):(k=wb,wb=c)}else k=wb,wb=c;$a=wb}}var cd=$a;if(cd!==c){ja();var xe=Z();if(xe!==c){ja();var dd=F();if(dd!==c){ja();var ye=Ka();ye!==c?(ma=Za,Za={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:cd},dd]}}):(k=Za,Za=
c)}else k=Za,Za=c}else k=Za,Za=c}else k=Za,Za=c}else k=Za,Za=c}else k=Za,Za=c;La=Za;if(La===c){var ab=k;var xb=k;if(g.substr(k,9).toLowerCase()===ze){var ed=g.substr(k,9);k+=9}else ed=c,0===fa&&a(Ae);if(ed!==c){var ic=k;fa++;var Be=J();fa--;Be===c?ic=void 0:(k=ic,ic=c);ic!==c?(ma=xb,xb="SUBSTRING"):(k=xb,xb=c)}else k=xb,xb=c;if(xb!==c){ja();var Ce=Ja();if(Ce!==c){ja();var Gc=F();if(Gc!==c){ja();var De=Z();if(De!==c){ja();var Hc=F();if(Hc!==c){ja();var ib=k;var yb=k;if(g.substr(k,3).toLowerCase()===
Ee){var fd=g.substr(k,3);k+=3}else fd=c,0===fa&&a(Fe);if(fd!==c){var jc=k;fa++;var Ge=J();fa--;Ge===c?jc=void 0:(k=jc,jc=c);jc!==c?(ma=yb,yb="FOR"):(k=yb,yb=c)}else k=yb,yb=c;var Sb=yb;if(Sb!==c){var He=ja();var gd=F();if(gd!==c){var Ie=ja();ib=Sb=[Sb,He,gd,Ie]}else k=ib,ib=c}else k=ib,ib=c;ib===c&&(ib=null);Sb=Ka();Sb!==c?(ma=ab,ab={type:"function",name:"substring",args:{type:"expression-list",value:ib?[Gc,Hc,ib[2]]:[Gc,Hc]}}):(k=ab,ab=c)}else k=ab,ab=c}else k=ab,ab=c}else k=ab,ab=c}else k=ab,ab=
c}else k=ab,ab=c;La=ab;if(La===c){var Oa=k;var Ic=ba();if(Ic!==c){ja();var Jc=Ja();if(Jc!==c){ja();var jb=la();jb===c&&(jb=null);ja();var Tb=F();if(Tb!==c){ja();var Kc=Z();if(Kc!==c){ja();var hd=F();if(hd!==c){ja();var Je=Ka();Je!==c?(ma=Oa,Oa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Tb,hd]}}):(k=Oa,Oa=c)}else k=Oa,Oa=c}else k=Oa,Oa=c}else k=Oa,Oa=c}else k=Oa,Oa=c}else k=Oa,Oa=c;Oa===c&&(Oa=k,Ic=ba(),Ic!==c?(ja(),Jc=Ja(),Jc!==c?(ja(),
jb=la(),jb===c&&(jb=null),ja(),Tb=F(),Tb!==c?(ja(),Kc=Ka(),Kc!==c?(ma=Oa,Oa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Tb]}}):(k=Oa,Oa=c)):(k=Oa,Oa=c)):(k=Oa,Oa=c)):(k=Oa,Oa=c));La=Oa;if(La===c){var bb=k;var zb=k;if(g.substr(k,8).toLowerCase()===Ke){var id=g.substr(k,8);k+=8}else id=c,0===fa&&a(Le);if(id!==c){var kc=k;fa++;var Me=J();fa--;Me===c?kc=void 0:(k=kc,kc=c);kc!==c?(ma=zb,zb="POSITION"):(k=zb,zb=c)}else k=zb,zb=c;if(zb!==c){ja();
var Ne=Ja();if(Ne!==c){ja();var jd=F();if(jd!==c){ja();var Oe=X();if(Oe!==c){ja();var kd=F();if(kd!==c){ja();var Pe=Ka();Pe!==c?(ma=bb,bb={type:"function",name:"position",args:{type:"expression-list",value:[jd,kd]}}):(k=bb,bb=c)}else k=bb,bb=c}else k=bb,bb=c}else k=bb,bb=c}else k=bb,bb=c}else k=bb,bb=c;La=bb;if(La===c){var cb=k;var Ab=k;if(g.substr(k,4).toLowerCase()===Qe){var ld=g.substr(k,4);k+=4}else ld=c,0===fa&&a(Re);if(ld!==c){var lc=k;fa++;var Se=J();fa--;Se===c?lc=void 0:(k=lc,lc=c);lc!==
c?(ma=Ab,Ab="CAST"):(k=Ab,Ab=c)}else k=Ab,Ab=c;if(Ab!==c){ja();var Te=Ja();if(Te!==c){ja();var md=F();if(md!==c){ja();var Bb=k;if(g.substr(k,2).toLowerCase()===Ue){var nd=g.substr(k,2);k+=2}else nd=c,0===fa&&a(Ve);if(nd!==c){var mc=k;fa++;var We=J();fa--;We===c?mc=void 0:(k=mc,mc=c);mc!==c?(ma=Bb,Bb="AS"):(k=Bb,Bb=c)}else k=Bb,Bb=c;var Xe=Bb;if(Xe!==c){ja();var Ga=k;var Cb=k;if(g.substr(k,7).toLowerCase()===Ye){var od=g.substr(k,7);k+=7}else od=c,0===fa&&a(Ze);if(od!==c){var nc=k;fa++;var $e=J();
fa--;$e===c?nc=void 0:(k=nc,nc=c);nc!==c?(ma=Cb,Cb="INTEGER"):(k=Cb,Cb=c)}else k=Cb,Cb=c;var Ma=Cb;Ma!==c&&(ma=Ga,Ma={type:"data-type",value:{type:"integer"}});Ga=Ma;if(Ga===c){Ga=k;var Db=k;if(g.substr(k,8).toLowerCase()===af){var pd=g.substr(k,8);k+=8}else pd=c,0===fa&&a(bf);if(pd!==c){var oc=k;fa++;var cf=J();fa--;cf===c?oc=void 0:(k=oc,oc=c);oc!==c?(ma=Db,Db="SMALLINT"):(k=Db,Db=c)}else k=Db,Db=c;Ma=Db;Ma!==c&&(ma=Ga,Ma={type:"data-type",value:{type:"smallint"}});Ga=Ma;if(Ga===c){Ga=k;var Eb=
k;if(g.substr(k,5).toLowerCase()===df){var qd=g.substr(k,5);k+=5}else qd=c,0===fa&&a(ef);if(qd!==c){var pc=k;fa++;var ff=J();fa--;ff===c?pc=void 0:(k=pc,pc=c);pc!==c?(ma=Eb,Eb="FLOAT"):(k=Eb,Eb=c)}else k=Eb,Eb=c;Ma=Eb;Ma!==c&&(ma=Ga,Ma={type:"data-type",value:{type:"float"}});Ga=Ma;if(Ga===c){Ga=k;var Fb=k;if(g.substr(k,4).toLowerCase()===gf){var rd=g.substr(k,4);k+=4}else rd=c,0===fa&&a(hf);if(rd!==c){var qc=k;fa++;var jf=J();fa--;jf===c?qc=void 0:(k=qc,qc=c);qc!==c?(ma=Fb,Fb="REAL"):(k=Fb,Fb=c)}else k=
Fb,Fb=c;Ma=Fb;Ma!==c&&(ma=Ga,Ma={type:"data-type",value:{type:"real"}});Ga=Ma;if(Ga===c&&(Ga=k,Ma=ia(),Ma!==c&&(ma=Ga,Ma={type:"data-type",value:{type:"date"}}),Ga=Ma,Ga===c&&(Ga=k,Ma=da(),Ma!==c&&(ma=Ga,Ma={type:"data-type",value:{type:"timestamp"}}),Ga=Ma,Ga===c&&(Ga=k,Ma=ka(),Ma!==c&&(ma=Ga,Ma={type:"data-type",value:{type:"time"}}),Ga=Ma,Ga===c)))){Ga=k;var Gb=k;if(g.substr(k,7).toLowerCase()===kf){var sd=g.substr(k,7);k+=7}else sd=c,0===fa&&a(lf);if(sd!==c){var rc=k;fa++;var mf=J();fa--;mf===
c?rc=void 0:(k=rc,rc=c);rc!==c?(ma=Gb,Gb="VARCHAR"):(k=Gb,Gb=c)}else k=Gb,Gb=c;Ma=Gb;if(Ma!==c){ja();var nf=Ja();if(nf!==c){ja();var td=h();if(td!==c){ja();var of=Ka();of!==c?(ma=Ga,Ga={type:"data-type",value:{type:"varchar",size:parseInt(td)}}):(k=Ga,Ga=c)}else k=Ga,Ga=c}else k=Ga,Ga=c}else k=Ga,Ga=c}}}}var ud=Ga;if(ud!==c){ja();var pf=Ka();pf!==c?(ma=cb,cb={type:"function",name:"cast",args:{type:"expression-list",value:[md,ud]}}):(k=cb,cb=c)}else k=cb,cb=c}else k=cb,cb=c}else k=cb,cb=c}else k=cb,
cb=c}else k=cb,cb=c;La=cb;if(La===c){var kb=k;var db=k;var Ub=m();Ub!==c&&(ma=db);db=Ub;if(db===c)if(db=k,96===g.charCodeAt(k)?(Ub=vd,k++):(Ub=c,0===fa&&a(wd)),Ub!==c){var sc=[];if(xd.test(g.charAt(k))){var lb=g.charAt(k);k++}else lb=c,0===fa&&a(yd);if(lb!==c)for(;lb!==c;)sc.push(lb),xd.test(g.charAt(k))?(lb=g.charAt(k),k++):(lb=c,0===fa&&a(yd));else sc=c;sc!==c?(96===g.charCodeAt(k)?(lb=vd,k++):(lb=c,0===fa&&a(wd)),lb!==c?(ma=db,db=sc.join("")):(k=db,db=c)):(k=db,db=c)}else k=db,db=c;var zd=db;if(zd!==
c){ja();var qf=Ja();if(qf!==c){ja();var tc=y();tc===c&&(tc=null);ja();var rf=Ka();rf!==c?(ma=kb,kb={type:"function",name:zd,args:tc?tc:{type:"expression-list",value:[]}}):(k=kb,kb=c)}else k=kb,kb=c}else k=kb,kb=c;La=kb;if(La===c){var fb;var Ua=k;var Lc=ya();if(Lc!==c){ja();var Vb=F();if(Vb!==c){ja();var Wb=[];for(fb=Ia();fb!==c;)Wb.push(fb),fb=Ia();fb=ja();var uc=Ha();uc!==c?(ma=Ua,Ua={type:"case-expression",format:"simple",operand:Vb,clauses:Wb,else:null}):(k=Ua,Ua=c)}else k=Ua,Ua=c}else k=Ua,Ua=
c;if(Ua===c)if(Ua=k,Lc=ya(),Lc!==c)if(ja(),Vb=F(),Vb!==c){ja();Wb=[];for(fb=Ia();fb!==c;)Wb.push(fb),fb=Ia();fb=ja();uc=Pa();if(uc!==c){ja();var sf=Ha();sf!==c?(ma=Ua,Ua={type:"case-expression",format:"simple",operand:Vb,clauses:Wb,else:uc.value}):(k=Ua,Ua=c)}else k=Ua,Ua=c}else k=Ua,Ua=c;else k=Ua,Ua=c;var Mc=Ua;if(Mc===c){var gb;var Xa=k;var Nc=ya();if(Nc!==c){ja();var Xb=[];for(gb=Da();gb!==c;)Xb.push(gb),gb=Da();gb=ja();var vc=Ha();vc!==c?(ma=Xa,Xa={type:"case-expression",format:"searched",clauses:Xb,
else:null}):(k=Xa,Xa=c)}else k=Xa,Xa=c;if(Xa===c)if(Xa=k,Nc=ya(),Nc!==c){ja();Xb=[];for(gb=Da();gb!==c;)Xb.push(gb),gb=Da();gb=ja();vc=Pa();if(vc!==c){ja();var tf=Ha();tf!==c?(ma=Xa,Xa={type:"case-expression",format:"searched",clauses:Xb,else:vc.value}):(k=Xa,Xa=c)}else k=Xa,Xa=c}else k=Xa,Xa=c;Mc=Xa}La=Mc;if(La===c){var Hb=k;var uf=k;var wc;var Yb=k;var Ad=u();if(Ad!==c){var Bd=[];for(wc=L();wc!==c;)Bd.push(wc),wc=L();ma=Yb;Yb=Ad+Bd.join("")}else k=Yb,Yb=c;var Cd=Yb;Cd!==c&&(ma=uf);var mb=Cd;if(mb!==
c){ma=Hb;var Oc=mb;mb=/^CURRENT_DATE$/i.test(Oc)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Oc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:Oc}}Hb=mb;if(Hb===c){Hb=k;var Ib=k;if(Y()!==c){var xc;var vf=k;var Pc=[];for(xc=U();xc!==c;)Pc.push(xc),xc=U();ma=vf;var wf=Pc=Pc.join("");var xf=Y();xf!==c?(ma=Ib,Ib=wf):(k=Ib,Ib=c)}else k=Ib,Ib=c;mb=Ib;mb!==c&&(ma=Hb,mb={type:"column-reference",table:"",column:mb,delimited:!0});Hb=mb}La=Hb;if(La===c&&(La=
ea(),La===c)){La=k;var yf=Ja();if(yf!==c){ja();var Qc=F();if(Qc!==c){ja();var zf=Ka();zf!==c?(ma=La,Qc.paren=!0,La=Qc):(k=La,La=c)}else k=La,La=c}else k=La,La=c}}}}}}}}}return La}function m(){var C;var P=k;var V=u();if(V!==c){var ca=[];for(C=J();C!==c;)ca.push(C),C=J();ma=P;P=V+ca.join("")}else k=P,P=c;return P}function u(){if(Af.test(g.charAt(k))){var C=g.charAt(k);k++}else C=c,0===fa&&a(Bf);return C}function J(){if(Cf.test(g.charAt(k))){var C=g.charAt(k);k++}else C=c,0===fa&&a(Df);return C}function L(){if(Dd.test(g.charAt(k))){var C=
g.charAt(k);k++}else C=c,0===fa&&a(Ed);return C}function U(){if(Dd.test(g.charAt(k))){var C=g.charAt(k);k++}else C=c,0===fa&&a(Ed);if(C===c)if(C=k,Y()!==c){var P=Y();P!==c?(ma=C,C='"'):(k=C,C=c)}else k=C,C=c;return C}function Y(){if(Ef.test(g.charAt(k))){var C=g.charAt(k);k++}else C=c,0===fa&&a(Ff);return C}function ea(){var C;var P=C=k;if(64===g.charCodeAt(k)){var V=Gf;k++}else V=c,0===fa&&a(Hf);if(V!==c){var ca=m();ca!==c?P=V=[V,ca]:(k=P,P=c)}else k=P,P=c;P!==c&&(ma=C,P={type:"parameter",value:P[1]});
return P}function la(){var C=k;if(g.substr(k,7).toLowerCase()===If){var P=g.substr(k,7);k+=7}else P=c,0===fa&&a(Jf);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="LEADING"):(k=C,C=c)}else k=C,C=c;C===c&&(C=k,g.substr(k,8).toLowerCase()===Kf?(P=g.substr(k,8),k+=8):(P=c,0===fa&&a(Lf)),P!==c?(P=k,fa++,V=J(),fa--,V===c?P=void 0:(k=P,P=c),P!==c?(ma=C,C="TRAILING"):(k=C,C=c)):(k=C,C=c),C===c&&(C=k,g.substr(k,4).toLowerCase()===Mf?(P=g.substr(k,4),k+=4):(P=c,0===fa&&a(Nf)),P!==
c?(P=k,fa++,V=J(),fa--,V===c?P=void 0:(k=P,P=c),P!==c?(ma=C,C="BOTH"):(k=C,C=c)):(k=C,C=c)));return C}function na(){var C=k;var P=k;var V=ta();if(V!==c){ja();var ca=Ja();if(ca!==c)if(ja(),ca=sa(),ca!==c){ja();var pa=Ka();pa!==c?(ma=P,P={type:"interval-period",period:V.value,precision:ca,secondary:null}):(k=P,P=c)}else k=P,P=c;else k=P,P=c}else k=P,P=c;P===c&&(P=k,V=ta(),V!==c&&(ma=P,V={type:"interval-period",period:V.value,precision:null,secondary:null}),P=V);if(P!==c)if(ja(),V=k,g.substr(k,2).toLowerCase()===
Of?(ca=g.substr(k,2),k+=2):(ca=c,0===fa&&a(Pf)),ca!==c?(ca=k,fa++,pa=J(),fa--,pa===c?ca=void 0:(k=ca,ca=c),ca!==c?(ma=V,V="TO"):(k=V,V=c)):(k=V,V=c),V!==c){ja();V=k;ca=ta();ca!==c&&(ma=V,ca={type:"interval-period",period:ca.value,precision:null,secondary:null});V=ca;if(V===c){V=k;ca=Aa();if(ca!==c)if(ja(),ca=Ja(),ca!==c)if(ja(),ca=sa(),ca!==c)if(ja(),pa=Wa(),pa!==c)if(ja(),pa=ua(),pa!==c){ja();var za=Ka();za!==c?(ma=V,V={type:"interval-period",period:"second",precision:ca,secondary:pa}):(k=V,V=c)}else k=
V,V=c;else k=V,V=c;else k=V,V=c;else k=V,V=c;else k=V,V=c;V===c&&(V=k,ca=Aa(),ca!==c?(ja(),ca=Ja(),ca!==c?(ja(),ca=sa(),ca!==c?(ja(),pa=Ka(),pa!==c?(ma=V,V={type:"interval-period",period:"second",precision:ca,secondary:null}):(k=V,V=c)):(k=V,V=c)):(k=V,V=c)):(k=V,V=c),V===c&&(V=k,ca=Aa(),ca!==c&&(ma=V,ca={type:"interval-period",period:"second",precision:null,secondary:null}),V=ca))}V!==c?(ma=C,C={type:"interval-qualifier",start:P,end:V}):(k=C,C=c)}else k=C,C=c;else k=C,C=c;C===c&&(C=k,V=ta(),V!==
c?(ja(),P=Ja(),P!==c?(ja(),P=ua(),P!==c?(ja(),ca=Ka(),ca!==c?(ma=C,C={type:"interval-period",period:V.value,precision:P,secondary:null}):(k=C,C=c)):(k=C,C=c)):(k=C,C=c)):(k=C,C=c),C===c&&(C=k,V=ta(),V!==c&&(ma=C,V={type:"interval-period",period:V.value,precision:null,secondary:null}),C=V,C===c&&(C=k,V=Aa(),V!==c?(ja(),P=Ja(),P!==c?(ja(),P=sa(),P!==c?(ja(),ca=Wa(),ca!==c?(ja(),V=ua(),V!==c?(ja(),ca=Ka(),ca!==c?(ma=C,C={type:"interval-period",period:"second",precision:P,secondary:V}):(k=C,C=c)):(k=
C,C=c)):(k=C,C=c)):(k=C,C=c)):(k=C,C=c)):(k=C,C=c),C===c&&(C=k,V=Aa(),V!==c?(ja(),P=Ja(),P!==c?(ja(),P=ua(),P!==c?(ja(),ca=Ka(),ca!==c?(ma=C,C={type:"interval-period",period:"second",precision:P,secondary:null}):(k=C,C=c)):(k=C,C=c)):(k=C,C=c)):(k=C,C=c),C===c&&(C=k,V=Aa(),V!==c&&(ma=C,V={type:"interval-period",period:"second",precision:null,secondary:null}),C=V)))));return C}function ta(){var C=k;var P=Ca();P!==c&&(ma=C,P={type:"string",value:"day"});C=P;C===c&&(C=k,P=wa(),P!==c&&(ma=C,P={type:"string",
value:"hour"}),C=P,C===c&&(C=k,P=Ba(),P!==c&&(ma=C,P={type:"string",value:"minute"}),C=P,C===c&&(C=k,P=qa(),P!==c&&(ma=C,P={type:"string",value:"month"}),C=P,C===c&&(C=k,P=oa(),P!==c&&(ma=C,P={type:"string",value:"year"}),C=P))));return C}function ua(){var C=k;var P=h();P!==c&&(ma=C,P=parseFloat(P));return P}function sa(){var C=k;var P=h();P!==c&&(ma=C,P=parseFloat(P));return P}function va(){var C=xa();C===c&&(C=ea());return C}function xa(){var C=k;if(39===g.charCodeAt(k)){var P=Fd;k++}else P=c,0===
fa&&a(Gd);P===c&&(g.substr(k,2)===Hd?(P=Hd,k+=2):(P=c,0===fa&&a(Qf)));if(P!==c){P=[];var V=k;if(g.substr(k,2)===yc){var ca=yc;k+=2}else ca=c,0===fa&&a(Id);ca!==c&&(ma=V,ca="'");V=ca;V===c&&(Jd.test(g.charAt(k))?(V=g.charAt(k),k++):(V=c,0===fa&&a(Kd)));for(;V!==c;)P.push(V),V=k,g.substr(k,2)===yc?(ca=yc,k+=2):(ca=c,0===fa&&a(Id)),ca!==c&&(ma=V,ca="'"),V=ca,V===c&&(Jd.test(g.charAt(k))?(V=g.charAt(k),k++):(V=c,0===fa&&a(Kd)));39===g.charCodeAt(k)?(V=Fd,k++):(V=c,0===fa&&a(Gd));V!==c?(ma=C,C={type:"string",
value:P.join("")}):(k=C,C=c)}else k=C,C=c;return C}function Da(){var C=k;if(Qa()!==c){ja();var P=F();if(P!==c){ja();var V=Ya();V!==c?(ja(),V=F(),V!==c?(ma=C,C={type:"when-clause",operand:P,value:V}):(k=C,C=c)):(k=C,C=c)}else k=C,C=c}else k=C,C=c;return C}function Ia(){var C=k;if(Qa()!==c){ja();var P=F();if(P!==c){ja();var V=Ya();V!==c?(ja(),V=F(),V!==c?(ma=C,C={type:"when-clause",operand:P,value:V}):(k=C,C=c)):(k=C,C=c)}else k=C,C=c}else k=C,C=c;return C}function Pa(){var C=k;var P=k;if(g.substr(k,
4).toLowerCase()===Rf){var V=g.substr(k,4);k+=4}else V=c,0===fa&&a(Sf);if(V!==c){V=k;fa++;var ca=J();fa--;ca===c?V=void 0:(k=V,V=c);V!==c?(ma=P,P="ELSE"):(k=P,P=c)}else k=P,P=c;P!==c?(ja(),P=F(),P!==c?(ma=C,C={type:"else-clause",value:P}):(k=C,C=c)):(k=C,C=c);return C}function Na(){var C=h();if(C===c){C=k;if(45===g.charCodeAt(k)){var P=Cc;k++}else P=c,0===fa&&a(Dc);P===c&&(43===g.charCodeAt(k)?(P=Ac,k++):(P=c,0===fa&&a(Bc)));if(P!==c){var V=h();V!==c?(ma=C,C=P[0]+V):(k=C,C=c)}else k=C,C=c}return C}
function Sa(){var C=k;if(46===g.charCodeAt(k)){var P=Tf;k++}else P=c,0===fa&&a(Uf);P!==c?(P=h(),P===c&&(P=null),ma=C,C="."+(null!=P?P:"")):(k=C,C=c);return C}function Va(){var C;var P=C=k;if(Vf.test(g.charAt(k))){var V=g.charAt(k);k++}else V=c,0===fa&&a(Wf);V!==c?(Xf.test(g.charAt(k))?(V=g.charAt(k),k++):(V=c,0===fa&&a(Yf)),V===c&&(V=null),ma=P,P="e"+(null===V?"":V)):(k=P,P=c);P!==c?(V=h(),V!==c?(ma=C,C=P+V):(k=C,C=c)):(k=C,C=c);return C}function h(){var C=k;var P=[];var V=D();if(V!==c)for(;V!==c;)P.push(V),
V=D();else P=c;P!==c&&(ma=C,P=P.join(""));return P}function D(){if(Zf.test(g.charAt(k))){var C=g.charAt(k);k++}else C=c,0===fa&&a($f);return C}function X(){var C=k;if(g.substr(k,2).toLowerCase()===ag){var P=g.substr(k,2);k+=2}else P=c,0===fa&&a(bg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="IN"):(k=C,C=c)}else k=C,C=c;return C}function aa(){var C=k;if(g.substr(k,2).toLowerCase()===cg){var P=g.substr(k,2);k+=2}else P=c,0===fa&&a(dg);if(P!==c){P=k;fa++;var V=J();fa--;
V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="IS"):(k=C,C=c)}else k=C,C=c;return C}function ha(){var C=k;if(g.substr(k,4).toLowerCase()===eg){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(fg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="LIKE"):(k=C,C=c)}else k=C,C=c;return C}function x(){var C=k;if(g.substr(k,3).toLowerCase()===gg){var P=g.substr(k,3);k+=3}else P=c,0===fa&&a(hg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="NOT"):(k=C,C=c)}else k=C,
C=c;return C}function G(){var C=k;if(g.substr(k,3).toLowerCase()===ig){var P=g.substr(k,3);k+=3}else P=c,0===fa&&a(jg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="AND"):(k=C,C=c)}else k=C,C=c;return C}function K(){var C=k;if(g.substr(k,2).toLowerCase()===kg){var P=g.substr(k,2);k+=2}else P=c,0===fa&&a(lg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="OR"):(k=C,C=c)}else k=C,C=c;return C}function W(){var C=k;if(g.substr(k,7).toLowerCase()===
mg){var P=g.substr(k,7);k+=7}else P=c,0===fa&&a(ng);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="BETWEEN"):(k=C,C=c)}else k=C,C=c;return C}function Z(){var C=k;if(g.substr(k,4).toLowerCase()===og){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(pg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="FROM"):(k=C,C=c)}else k=C,C=c;return C}function ba(){var C=k;if(g.substr(k,4).toLowerCase()===qg){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(rg);if(P!==
c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="TRIM"):(k=C,C=c)}else k=C,C=c;return C}function da(){var C=k;if(g.substr(k,9).toLowerCase()===sg){var P=g.substr(k,9);k+=9}else P=c,0===fa&&a(tg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="TIMESTAMP"):(k=C,C=c)}else k=C,C=c;return C}function ia(){var C=k;if(g.substr(k,4).toLowerCase()===ug){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(vg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==
c?(ma=C,C="DATE"):(k=C,C=c)}else k=C,C=c;return C}function ka(){var C=k;if(g.substr(k,4).toLowerCase()===wg){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(xg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="TIME"):(k=C,C=c)}else k=C,C=c;return C}function ra(){var C=k;if(g.substr(k,8).toLowerCase()===yg){var P=g.substr(k,8);k+=8}else P=c,0===fa&&a(zg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="INTERVAL"):(k=C,C=c)}else k=C,C=c;return C}function oa(){var C=
k;if(g.substr(k,4).toLowerCase()===Ag){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(Bg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="YEAR"):(k=C,C=c)}else k=C,C=c;return C}function qa(){var C=k;if(g.substr(k,5).toLowerCase()===Cg){var P=g.substr(k,5);k+=5}else P=c,0===fa&&a(Dg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="MONTH"):(k=C,C=c)}else k=C,C=c;return C}function Ca(){var C=k;if(g.substr(k,3).toLowerCase()===Eg){var P=g.substr(k,3);k+=
3}else P=c,0===fa&&a(Fg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="DAY"):(k=C,C=c)}else k=C,C=c;return C}function wa(){var C=k;if(g.substr(k,4).toLowerCase()===Gg){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(Hg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="HOUR"):(k=C,C=c)}else k=C,C=c;return C}function Ba(){var C=k;if(g.substr(k,6).toLowerCase()===Ig){var P=g.substr(k,6);k+=6}else P=c,0===fa&&a(Jg);if(P!==c){P=k;fa++;var V=J();fa--;V===
c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="MINUTE"):(k=C,C=c)}else k=C,C=c;return C}function Aa(){var C=k;if(g.substr(k,6).toLowerCase()===Kg){var P=g.substr(k,6);k+=6}else P=c,0===fa&&a(Lg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="SECOND"):(k=C,C=c)}else k=C,C=c;return C}function ya(){var C=k;if(g.substr(k,4).toLowerCase()===Mg){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(Ng);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="CASE"):(k=C,C=c)}else k=
C,C=c;return C}function Ha(){var C=k;if(g.substr(k,3).toLowerCase()===Og){var P=g.substr(k,3);k+=3}else P=c,0===fa&&a(Pg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="END"):(k=C,C=c)}else k=C,C=c;return C}function Qa(){var C=k;if(g.substr(k,4).toLowerCase()===Qg){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(Rg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="WHEN"):(k=C,C=c)}else k=C,C=c;return C}function Ya(){var C=k;if(g.substr(k,4).toLowerCase()===
Sg){var P=g.substr(k,4);k+=4}else P=c,0===fa&&a(Tg);if(P!==c){P=k;fa++;var V=J();fa--;V===c?P=void 0:(k=P,P=c);P!==c?(ma=C,C="THEN"):(k=C,C=c)}else k=C,C=c;return C}function Wa(){if(44===g.charCodeAt(k)){var C=Ug;k++}else C=c,0===fa&&a(Vg);return C}function Ja(){if(40===g.charCodeAt(k)){var C=Wg;k++}else C=c,0===fa&&a(Xg);return C}function Ka(){if(41===g.charCodeAt(k)){var C=Yg;k++}else C=c,0===fa&&a(Zg);return C}function ja(){var C;var P=[];for(C=Ra();C!==c;)P.push(C),C=Ra();return P}function Ra(){if($g.test(g.charAt(k))){var C=
g.charAt(k);k++}else C=c,0===fa&&a(ah);return C}function Nb(C,P,V,ca){C={type:"binary-expression",operator:C,left:P,right:V};void 0!==ca&&(C.escape=ca);return C}function nb(C,P){for(var V=0;V<P.length;V++)C=Nb(P[V][1],C,P[V][3]);return C}p=void 0!==p?p:{};var c={},Mb=p.grammarSource,Ld={start:r},Md=r,Nd="!",Sc="\x3d",Uc="\x3e\x3d",Sd="\x3e",Vc="\x3c\x3d",Wc="\x3c\x3e",Wd="\x3c",Xc="!\x3d",Ac="+",Cc="-",Yc="||",$d="*",be="/",Gf="@",Fd="'",Hd="N'",yc="''",Tf=".",ke="null",de="true",ge="false",ag="in",
cg="is",eg="like",Pd="escape",gg="not",ig="and",kg="or",mg="between",og="from",Ee="for",ze="substring",ne="extract",qg="trim",Ke="position",sg="timestamp",ug="date",wg="time",If="leading",Kf="trailing",Mf="both",Qe="cast",Ue="as",Ye="integer",af="smallint",df="float",gf="real",kf="varchar",Of="to",yg="interval",Ag="year",re="timezone_hour",ue="timezone_minute",Cg="month",Eg="day",Gg="hour",Ig="minute",Kg="second",Mg="case",Og="end",Qg="when",Sg="then",Rf="else",Ug=",",Wg="(",Yg=")",vd="`",Af=/^[A-Za-z_\x80-\uFFFF]/,
Cf=/^[A-Za-z0-9_]/,Dd=/^[A-Za-z0-9_.\x80-\uFFFF]/,Ef=/^["]/,Jd=/^[^']/,Zf=/^[0-9]/,Vf=/^[eE]/,Xf=/^[+\-]/,$g=/^[ \t\n\r]/,xd=/^[^`]/,Od=I("!",!1),Tc=I("\x3d",!1),Rd=I("\x3e\x3d",!1),Td=I("\x3e",!1),Ud=I("\x3c\x3d",!1),Vd=I("\x3c\x3e",!1),Xd=I("\x3c",!1),Yd=I("!\x3d",!1),Bc=I("+",!1),Dc=I("-",!1),Zd=I("||",!1),ae=I("*",!1),ce=I("/",!1),Bf=E([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Df=E([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ed=E([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],
!1,!1),Ff=E(['"'],!1,!1),Hf=I("@",!1),Gd=I("'",!1),Qf=I("N'",!1),Id=I("''",!1),Kd=E(["'"],!0,!1),Uf=I(".",!1),$f=E([["0","9"]],!1,!1),Wf=E(["e","E"],!1,!1),Yf=E(["+","-"],!1,!1),le=I("NULL",!0),ee=I("TRUE",!0),he=I("FALSE",!0),bg=I("IN",!0),dg=I("IS",!0),fg=I("LIKE",!0),Qd=I("ESCAPE",!0),hg=I("NOT",!0),jg=I("AND",!0),lg=I("OR",!0),ng=I("BETWEEN",!0),pg=I("FROM",!0),Fe=I("FOR",!0),Ae=I("SUBSTRING",!0),oe=I("EXTRACT",!0),rg=I("TRIM",!0),Le=I("POSITION",!0),tg=I("TIMESTAMP",!0),vg=I("DATE",!0),xg=I("TIME",
!0),Jf=I("LEADING",!0),Lf=I("TRAILING",!0),Nf=I("BOTH",!0),Re=I("CAST",!0),Ve=I("AS",!0),Ze=I("INTEGER",!0),bf=I("SMALLINT",!0),ef=I("FLOAT",!0),hf=I("REAL",!0),lf=I("VARCHAR",!0),Pf=I("TO",!0),zg=I("INTERVAL",!0),Bg=I("YEAR",!0),se=I("TIMEZONE_HOUR",!0),ve=I("TIMEZONE_MINUTE",!0),Dg=I("MONTH",!0),Fg=I("DAY",!0),Hg=I("HOUR",!0),Jg=I("MINUTE",!0),Lg=I("SECOND",!0),Ng=I("CASE",!0),Pg=I("END",!0),Rg=I("WHEN",!0),Tg=I("THEN",!0),Sf=I("ELSE",!0),Vg=I(",",!1),Xg=I("(",!1),Zg=I(")",!1),ah=E([" ","\t","\n",
"\r"],!1,!1),wd=I("`",!1),yd=E(["`"],!0,!1),k=0,ma=0,Zb=[{line:1,column:1}],eb=0,zc=[],fa=0;if("startRule"in p){if(!(p.startRule in Ld))throw Error("Can't start parsing from rule \""+p.startRule+'".');Md=Ld[p.startRule]}var Rc=Md();if(Rc!==c&&k===g.length)return Rc;Rc!==c&&k<g.length&&a({type:"end"});throw function(C,P,V){return new f(f.buildMessage(C,P),C,P,V)}(zc,eb<g.length?g.charAt(eb):null,eb<g.length?q(eb,eb+1):q(eb,eb));}}})})(B);var z=B.exports;class M{static parse(n){return z.parse(n)}}d.WhereGrammar=
M;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(d,e){e=new e.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});d.kebabDict=e;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(d){d.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,
centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,
supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w,I,E){function t(y,F,S,b){const A=b.x-S.x;b=b.y-S.y;F=Math.min(1,Math.max(0,((F.x-S.x)*A+(F.y-S.y)*b)/(A*A+b*b)));y.x=S.x+A*F;y.y=S.y+b*F}function q(y,F){return y?F?4:3:F?3:2}class a{constructor(y,F,S){this.items=y;this.query=F;this.geometryType=S.geometryType;this.hasM=S.hasM;this.hasZ=S.hasZ;this.fieldsIndex=S.fieldsIndex;this.objectIdField=S.objectIdField;this.spatialReference=S.spatialReference;this.featureAdapter=S.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const y=
new v(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return y.countDistinctValues(this.items);const {groupByFieldsForStatistics:F,having:S,outStatistics:b}=this.query;if(!F?.length)return 1;const A=new Map,R=new Map,H=new Set;for(const T of b){var {statisticType:Q}=T;Q="exceedslimit"!==Q?T.onStatisticField:void 0;if(!R.has(Q)){var N=[];for(const l of F){const O=this._getAttributeValues(y,l,A);N.push(O)}R.set(Q,this._calculateUniqueValues(N,y.returnDistinctValues))}Q=
R.get(Q);for(const l in Q){const {data:O,items:m}=Q[l];N=O.join(",");S&&!y.validateItems(m,S)||H.add(N)}}return H.size}async createQueryResponse(){let y;y=this.query.outStatistics?this.query.outStatistics.some(F=>"exceedslimit"===F.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const F=this.query.geometry;f.isValid(this.query.outSR)&&!f.equals(F.spatialReference,
this.query.outSR)?y.queryGeometry=g.cleanFromGeometryEngine({spatialReference:this.query.outSR,...p.project(F,F.spatialReference,this.query.outSR)}):y.queryGeometry=g.cleanFromGeometryEngine({spatialReference:this.query.outSR,...F})}return y}createSnappingResponse(y,F){const S=this.featureAdapter,b=q(this.hasZ,this.hasM),{point:A,mode:R}=y,H="number"===typeof y.distance?y.distance:y.distance.x,Q="number"===typeof y.distance?y.distance:y.distance.y,N={candidates:[]},T="esriGeometryPolygon"===this.geometryType;
F=this._getPointCreator(R,this.spatialReference,F);const l=new r(null,0),O=new r(null,0),m={x:0,y:0,z:0};for(const la of this.items){var u=S.getGeometry(la);if(null==u)continue;const {coords:na,lengths:ta}=u;l.coords=na;O.coords=na;if(y.returnEdge){u=0;for(var J=0;J<ta.length;J++){var L=ta[J];for(var U=0;U<L;U++,u+=b){var Y=l;Y.coordsIndex=u;if(U!==L-1){const ua=O;ua.coordsIndex=u+b;const sa=m;t(m,A,Y,ua);var ea=(A.x-sa.x)/H;const va=(A.y-sa.y)/Q;ea=ea*ea+va*va;1>=ea&&N.candidates.push(w.makeEdgeCandidate(S.getObjectId(la),
F(sa),Math.sqrt(ea),F(Y),F(ua)))}}}}if("none"!==y.vertexMode)if(u=T?na.length-b:na.length,"all"===y.vertexMode)for(J=0;J<u;J+=b)L=l,L.coordsIndex=J,U=(A.x-L.x)/H,Y=(A.y-L.y)/Q,U=U*U+Y*Y,1>=U&&N.candidates.push(w.makeVertexCandidate(S.getObjectId(la),F(L),Math.sqrt(U)));else if("ends"===y.vertexMode){u=[0];T||u.push(na.length-b);for(const ua of u)u=l,u.coordsIndex=ua,J=(A.x-u.x)/H,L=(A.y-u.y)/Q,J=J*J+L*L,1>=J&&N.candidates.push(w.makeVertexCandidate(S.getObjectId(la),F(u),Math.sqrt(J)))}}N.candidates.sort((la,
na)=>la.distance-na.distance);return N}_getPointCreator(y,F,S){const b=null==S||f.equals(F,S)?R=>R:R=>p.project(R,F,S),{hasZ:A}=this;return"3d"===y?A?({x:R,y:H,z:Q})=>b({x:R,y:H,z:Q}):({x:R,y:H})=>b({x:R,y:H,z:0}):({x:R,y:H})=>b({x:R,y:H})}async createSummaryStatisticsResponse(y){const {field:F,valueExpression:S,normalizationField:b,normalizationType:A,normalizationTotal:R,minValue:H,maxValue:Q,scale:N,timeZone:T}=y;var l=this.fieldsIndex.get(F);y=I.isDateField(l)||I.isDateOnlyField(l)||I.isTimestampOffsetField(l);
const O=await this._getDataValues({field:F,valueExpression:S,normalizationField:b,normalizationType:A,normalizationTotal:R,scale:N,timeZone:T}),m=E.isNullCountSupported({normalizationType:A,normalizationField:b,minValue:H,maxValue:Q}),u={value:.5,fieldType:l?.type};l=I.isStringField(l)?E.calculateStringStatistics({values:O,supportsNullCount:m,percentileParams:u}):E.calculateStatistics({values:O,minValue:H,maxValue:Q,useSampleStdDev:!A,supportsNullCount:m,percentileParams:u});return E.processSummaryStatisticsResult(l,
y)}async createUniqueValuesResponse(y){const {field:F,valueExpression:S,domains:b,returnAllCodedValues:A,scale:R,timeZone:H}=y;var Q=await this._getDataValues({field:F,field2:y.field2,field3:y.field3,fieldDelimiter:y.fieldDelimiter,valueExpression:S,scale:R,timeZone:H},!1);Q=E.calculateUniqueValuesCount(Q);return E.createUVResult(Q,b,A,y.fieldDelimiter)}async createClassBreaksResponse(y){const {field:F,valueExpression:S,normalizationField:b,normalizationType:A,normalizationTotal:R,classificationMethod:H,
standardDeviationInterval:Q,minValue:N,maxValue:T,numClasses:l,scale:O,timeZone:m}=y;y=await this._getDataValues({field:F,valueExpression:S,normalizationField:b,normalizationType:A,normalizationTotal:R,scale:O,timeZone:m});y=E.calculateClassBreaks(y,{field:F,normalizationField:b,normalizationType:A,normalizationTotal:R,classificationMethod:H,standardDeviationInterval:Q,minValue:N,maxValue:T,numClasses:l});return E.resolveCBResult(y,H)}async createHistogramResponse(y){const {field:F,valueExpression:S,
normalizationField:b,normalizationType:A,normalizationTotal:R,classificationMethod:H,standardDeviationInterval:Q,minValue:N,maxValue:T,numBins:l,scale:O,timeZone:m}=y;y=await this._getDataValues({field:F,valueExpression:S,normalizationField:b,normalizationType:A,normalizationTotal:R,scale:O,timeZone:m});return E.calculateHistogram(y,{field:F,normalizationField:b,normalizationType:A,normalizationTotal:R,classificationMethod:H,standardDeviationInterval:Q,minValue:N,maxValue:T,numBins:l})}_sortFeatures(y,
F,S){if(1<y.length&&F?.length)for(const b of F.reverse()){F=b.split(" ");const A=F[0],R=this.fieldsIndex.get(A);F=F[1]?"desc"===F[1].toLowerCase():!1;const H=E.getAttributeComparator(R?.type,F);y.sort((Q,N)=>{Q=S(Q,A,R);N=S(N,A,R);return H(Q,N)})}}_createFeatureQueryResponse(y){const F=this.items,{geometryType:S,hasM:b,hasZ:A,objectIdField:R,spatialReference:H}=this,{outFields:Q,outSR:N,quantizationParameters:T,resultRecordCount:l,resultOffset:O,returnZ:m,returnM:u}=y,J=null!=l?F.length>(O||0)+l:
!1,L=Q&&(Q.includes("*")?[...this.fieldsIndex.fields]:Q.map(U=>this.fieldsIndex.get(U)));return{exceededTransferLimit:J,features:this._createFeatures(y,F),fields:L,geometryType:S,hasM:b&&u,hasZ:A&&m,objectIdFieldName:R,spatialReference:g.cleanFromGeometryEngine(N||H),transform:T&&n.toQuantizationTransform(T)||null}}_createFeatures(y,F){const S=new v(y,this.featureAdapter,this.fieldsIndex),{hasM:b,hasZ:A}=this,{orderByFields:R,quantizationParameters:H,returnGeometry:Q,returnCentroid:N,maxAllowableOffset:T,
resultOffset:l,resultRecordCount:O,returnZ:m=!1,returnM:u=!1}=y,J=A&&m,L=b&&u;y=[];var U=0;F=[...F];this._sortFeatures(F,R,(la,na,ta)=>S.getFieldValue(la,na,ta));if(this.geometryType&&(Q||N)){var Y=n.toQuantizationTransform(H)??void 0;if(Q&&!N)for(var ea of F)y[U++]={attributes:S.getAttributes(ea),geometry:g.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(ea),T,Y,J,L)};else if(!Q&&N)for(const la of F)y[U++]={attributes:S.getAttributes(la),centroid:g.transformCentroid(this,
this.featureAdapter.getCentroid(la,this),Y)};else for(const la of F)y[U++]={attributes:S.getAttributes(la),centroid:g.transformCentroid(this,this.featureAdapter.getCentroid(la,this),Y),geometry:g.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(la),T,Y,J,L)}}else for(Y of F)(ea=S.getAttributes(Y))&&(y[U++]={attributes:ea});U=l||0;null!=O&&(y=y.slice(U,Math.min(y.length,U+O)));return y}_createExceedsLimitQueryResponse(y){var F=!1;let S=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY;
F=Number.POSITIVE_INFINITY;for(const A of y.outStatistics??[])if("exceedslimit"===A.statisticType){S=null!=A.maxPointCount?A.maxPointCount:Number.POSITIVE_INFINITY;b=null!=A.maxRecordCount?A.maxRecordCount:Number.POSITIVE_INFINITY;F=null!=A.maxVertexCount?A.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)F=this.items.length>S;else if(this.items.length>b)F=!0;else{y=q(this.hasZ,this.hasM);const A=this.featureAdapter;F=this.items.reduce((R,H)=>{H=A.getGeometry(H);
return R+(null!=H&&H.coords.length||0)},0)/y>F}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(F)}}]}}async _createStatisticsQueryResponse(y){var F={attributes:{}};const S=[],b=new Map,A=new Map,R=new Map,H=new Map,Q=new v(y,this.featureAdapter,this.fieldsIndex);var N=y.outStatistics;const {groupByFieldsForStatistics:T,having:l,orderByFields:O,resultRecordCount:m}=
y;y=T?.length;const u=!!y,J=u?T[0]:null,L=u&&!this.fieldsIndex.get(J);for(const na of N??[]){const {outStatisticFieldName:ta,statisticType:ua}=na;N=na;const sa="exceedslimit"!==ua?na.onStatisticField:void 0,va="percentile_disc"===ua||"percentile_cont"===ua;var U="EnvelopeAggregate"===ua||"CentroidAggregate"===ua||"ConvexHullAggregate"===ua;const xa=u&&1===y&&(sa===J||L)&&"count"===ua;if(u){if(!R.has(sa)){var Y=[];for(const Da of T){var ea=this._getAttributeValues(Q,Da,b);Y.push(ea)}R.set(sa,this._calculateUniqueValues(Y,
U?!1:Q.returnDistinctValues))}Y=R.get(sa);if(!Y)continue;ea=Object.keys(Y);for(const Da of ea){const {count:Ia,data:Pa,items:Na,itemPositions:Sa}=Y[Da];ea=Pa.join(",");if(!l||Q.validateItems(Na,l)){const Va=H.get(ea)||{attributes:{}};if(U){Va.aggregateGeometries||(Va.aggregateGeometries={});const {aggregateGeometries:D,outStatisticFieldName:X}=await this._getAggregateGeometry(N,Na);Va.aggregateGeometries[X]=D}else{var la=null;if(xa)la=Ia;else{const D=this._getAttributeValues(Q,sa,b);la=Sa.map(X=>
D[X]);la=va&&"statisticParameters"in N?this._getPercentileValue(N,la):this._getStatisticValue(N,la,null,Q.returnDistinctValues)}Va.attributes[ta]=la}let h=0;T.forEach((D,X)=>Va.attributes[this.fieldsIndex.get(D)?D:`EXPR_${++h}`]=Pa[X]);H.set(ea,Va)}}}else if(U){F.aggregateGeometries||(F.aggregateGeometries={});const {aggregateGeometries:Da,outStatisticFieldName:Ia}=await this._getAggregateGeometry(N,this.items);F.aggregateGeometries[Ia]=Da}else U=this._getAttributeValues(Q,sa,b),F.attributes[ta]=
va&&"statisticParameters"in N?this._getPercentileValue(N,U):this._getStatisticValue(N,U,A,Q.returnDistinctValues);N="min"!==ua&&"max"!==ua||!I.isStringField(this.fieldsIndex.get(sa))&&!this._isAnyDateField(sa)?null:this.fieldsIndex.get(sa)?.type;S.push({name:ta,alias:ta,type:N||"esriFieldTypeDouble"})}F=u?Array.from(H.values()):[F];this._sortFeatures(F,O,(na,ta)=>na.attributes[ta]);m&&(F.length=Math.min(m,F.length));return{fields:S,features:F}}_isAnyDateField(y){y=this.fieldsIndex.get(y);return I.isDateField(y)||
I.isDateOnlyField(y)||I.isTimestampOffsetField(y)||I.isTimeOnlyField(y)}async _getAggregateGeometry(y,F){const {convexHull:S,union:b}=await new Promise((m,u)=>d(["../../../geometry/geometryEngineJSON"],m,u)),{statisticType:A,outStatisticFieldName:R}=y,{featureAdapter:H,spatialReference:Q,geometryType:N,hasZ:T,hasM:l}=this;F=F.map(m=>g.getGeometry(N,T,l,H.getGeometry(m)));const O=S(Q,F,!0)[0];y={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===A?(F=O?M.getPolygonExtent(O):
M.getGeometryExtent(b(Q,F)),y.aggregateGeometries={...F,spatialReference:Q},y.outStatisticFieldName=R||"extent"):"CentroidAggregate"===A?(F=O?z.polygonCentroid(O):z.extentCentroid(M.getGeometryExtent(b(Q,F))),y.aggregateGeometries={x:F[0],y:F[1],spatialReference:Q},y.outStatisticFieldName=R||"centroid"):"ConvexHullAggregate"===A&&(y.aggregateGeometries=O,y.outStatisticFieldName=R||"convexHull");return y}_getStatisticValue(y,F,S,b){const {onStatisticField:A,statisticType:R}=y;y=null;y=S?.has(A)?S.get(A):
I.isStringField(this.fieldsIndex.get(A))||this._isAnyDateField(A)?E.calculateStringStatistics({values:F,returnDistinct:b}):E.calculateStatistics({values:b?[...(new Set(F))]:F,minValue:null,maxValue:null,useSampleStdDev:!0});S&&S.set(A,y);return y["var"===R?"variance":R]}_getPercentileValue(y,F){const {onStatisticField:S,statisticParameters:b,statisticType:A}=y,{value:R,orderBy:H}=b;y=this.fieldsIndex.get(S);return E.calculatePercentile(F,{value:R,orderBy:H,fieldType:y?.type,isDiscrete:"percentile_disc"===
A})}_getAttributeValues(y,F,S){if(S.has(F))return S.get(F);const b=this.fieldsIndex.get(F),A=this.items.map(R=>y.getFieldValue(R,F,b));S.set(F,A);return A}_calculateUniqueValues(y,F){const S={},b=this.items,A=b.length;for(let R=0;R<A;R++){const H=b[R],Q=[];for(const T of y)Q.push(T[R]);const N=Q.join(",");null==S[N]?S[N]={count:1,data:Q,items:[H],itemPositions:[R]}:(F||S[N].count++,S[N].items.push(H),S[N].itemPositions.push(R))}return S}async _getDataValues(y,F=!0){const S=new v(this.query,this.featureAdapter,
this.fieldsIndex),{valueExpression:b,scale:A,timeZone:R}=y;return b?S.getExpressionValues(this.items,b,{viewingMode:"map",scale:A,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},R):S.getDataValues(this.items,B.clone(y),F)}}class r{constructor(y,F){this.coords=y;this.coordsIndex=F}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}e.QueryEngineResult=
a;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(d,e){function B({scale:N,translate:T},l){return Math.round((l-T[0])/N[0])}function z({scale:N,translate:T},l){return Math.round((T[1]-l)/N[1])}function M(N,T,l){const O=[];let m,u,J,L;for(let U=0;U<l.length;U++){const Y=l[U];if(0<U){if(J=B(N,Y[0]),L=z(N,Y[1]),J!==m||L!==u)O.push(T(Y,J-m,L-u)),m=J,u=L}else m=B(N,Y[0]),u=z(N,Y[1]),O.push(T(Y,
m,u))}return 0<O.length?O:null}function n(N,T,l,O){return M(N,l?O?Q:H:O?H:R,T)}function f(N,T,l,O){const m=[];l=l?O?Q:H:O?H:R;for(O=0;O<T.length;O++){const u=M(N,l,T[O]);u&&3<=u.length&&m.push(u)}return m.length?m:null}function v(N,T,l,O){const m=[];l=l?O?Q:H:O?H:R;for(O=0;O<T.length;O++){const u=M(N,l,T[O]);u&&2<=u.length&&m.push(u)}return m.length?m:null}function g({scale:N,translate:T},l){return l*N[0]+T[0]}function p({scale:N,translate:T},l){return T[1]-l*N[1]}function w(N,T,l){const O=Array(l.length);
if(!l.length)return O;const [m,u]=N.scale;let J=g(N,l[0][0]);N=p(N,l[0][1]);O[0]=T(l[0],J,N);for(let L=1;L<l.length;L++){const U=l[L];J+=U[0]*m;N-=U[1]*u;O[L]=T(U,J,N)}return O}function I(N,T,l){const O=Array(l.length);for(let m=0;m<l.length;m++)O[m]=w(N,T,l[m]);return O}function E(N,T,l,O){return w(N,l?O?Q:H:O?H:R,T)}function t(N,T,l,O){return I(N,l?O?Q:H:O?H:R,T)}function q(N,T,l,O){return I(N,l?O?Q:H:O?H:R,T)}function a(N,T,l){let [O,m]=l[0],u=Math.min(O,T[0]),J=Math.min(m,T[1]),L=Math.max(O,T[2]);
T=Math.max(m,T[3]);for(let U=1;U<l.length;U++){const [Y,ea]=l[U];O+=Y;m+=ea;0>Y&&(u=Math.min(u,O));0<Y&&(L=Math.max(L,O));0>ea?J=Math.min(J,m):0<ea&&(T=Math.max(T,m))}N[0]=u;N[1]=J;N[2]=L;N[3]=T;return N}function r(N,T){if(!T.length)return null;N[0]=N[1]=Number.POSITIVE_INFINITY;N[2]=N[3]=Number.NEGATIVE_INFINITY;for(let l=0;l<T.length;l++)a(N,N,T[l]);return N}function y(N,T,l,O,m){T.xmin=B(N,l.xmin);T.ymin=z(N,l.ymin);T.xmax=B(N,l.xmax);T.ymax=z(N,l.ymax);T!==l&&(O&&(T.zmin=l.zmin,T.zmax=l.zmax),
m&&(T.mmin=l.mmin,T.mmax=l.mmax));return T}function F(N,T,l,O,m){T.points=n(N,l.points,O,m)??[];return T}function S(N,T,l,O,m){T.x=B(N,l.x);T.y=z(N,l.y);T!==l&&(O&&(T.z=l.z),m&&(T.m=l.m));return T}function b(N,T,l,O,m){N=f(N,l.rings,O,m);if(!N)return null;T.rings=N;return T}function A(N,T,l,O,m){N=v(N,l.paths,O,m);if(!N)return null;T.paths=N;return T}const R=(N,T,l)=>[T,l],H=(N,T,l)=>[T,l,N[2]],Q=(N,T,l)=>[T,l,N[2],N[3]];d.equals=function(N,T){if(N===T||null==N&&null==T)return!0;if(null==N||null==
T)return!1;let l,O,m,u;N&&"upperLeft"===N.originPosition?(l=N.translate[0],O=N.translate[1],N=N.scale[0]):(l=null!=N.extent?N.extent.xmin:0,O=null!=N.extent?N.extent.ymax:0,N=N.tolerance);T&&"upperLeft"===T.originPosition?(m=T.translate[0],u=T.translate[1],T=T.scale[0]):(m=null!=T.extent?T.extent.xmin:0,u=null!=T.extent?T.extent.ymax:0,T=T.tolerance);return l===m&&O===u&&N===T};d.getQuantizedBoundsCoordsArray=a;d.getQuantizedBoundsCoordsArrayArray=r;d.getQuantizedBoundsPaths=function(N){return r([0,
0,0,0],N)};d.getQuantizedBoundsPoints=function(N){const T=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return a(T,T,N)};d.getQuantizedBoundsRings=function(N){return r([0,0,0,0],N)};d.quantizeBounds=function(N,T,l){T[0]=B(N,l[0]);T[3]=z(N,l[1]);T[2]=B(N,l[2]);T[1]=z(N,l[3]);return T};d.quantizeExtent=y;d.quantizeGeometry=function(N,T){return N&&T?e.isPoint(T)?S(N,{},T,!1,!1):e.isPolyline(T)?A(N,{},T,!1,!1):e.isPolygon(T)?b(N,{},T,!1,!1):e.isMultipoint(T)?
F(N,{},T,!1,!1):e.isExtent(T)?y(N,{},T,!1,!1):null:null};d.quantizeMultipoint=F;d.quantizePaths=v;d.quantizePoint=S;d.quantizePoints=n;d.quantizePolygon=b;d.quantizePolyline=A;d.quantizeRings=f;d.quantizeX=B;d.quantizeY=z;d.toQuantizationTransform=function(N){return N?{originPosition:"upper-left"===N.originPosition?"upperLeft":"lower-left"===N.originPosition?"lowerLeft":N.originPosition,scale:N.tolerance?[N.tolerance,N.tolerance]:[1,1],translate:null!=N.extent?[N.extent.xmin,N.extent.ymax]:[0,0]}:
null};d.unquantizeBounds=function(N,T,l){return l?(T[0]=g(N,l[0]),T[1]=p(N,l[3]),T[2]=g(N,l[2]),T[3]=p(N,l[1]),T):[g(N,T[0]),p(N,T[3]),g(N,T[2]),p(N,T[1])]};d.unquantizeCoordsArray=w;d.unquantizeCoordsArrayArray=I;d.unquantizeExtent=function(N,T,l,O,m){T.xmin=g(N,l.xmin);T.ymin=p(N,l.ymin);T.xmax=g(N,l.xmax);T.ymax=p(N,l.ymax);T!==l&&(O&&(T.zmin=l.zmin,T.zmax=l.zmax),m&&(T.mmin=l.mmin,T.mmax=l.mmax));return T};d.unquantizeMultipoint=function(N,T,l,O,m){null!=l&&(T.points=E(N,l.points,O,m));return T};
d.unquantizePaths=t;d.unquantizePoint=function(N,T,l,O,m){if(null==l)return T;T.x=g(N,l.x);T.y=p(N,l.y);T!==l&&(O&&(T.z=l.z),m&&(T.m=l.m));return T};d.unquantizePoints=E;d.unquantizePolygon=function(N,T,l,O,m){null!=l&&(T.rings=q(N,l.rings,O,m));return T};d.unquantizePolyline=function(N,T,l,O,m){null!=l&&(T.paths=t(N,l.paths,O,m));return T};d.unquantizeRings=q;d.unquantizeX=g;d.unquantizeY=p;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(d,e,B,z,M,n){class f{constructor(v,g,p){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=v.returnDistinctValues??!1;this.fieldsIndex=p;this.featureAdapter=g;if((g=v.outFields)&&!g.includes("*")){this.outFields=g;v=0;for(const I of g){var w=d.getExpressionFromFieldName(I);w=(g=this.fieldsIndex.get(w))?null:d.getWhereClause(w,p);g=g?g.name:d.getAliasFromFieldName(I)||`FIELD_EXP_${v++}`;this._fieldDataCache.set(I,{alias:g,clause:w})}}}countDistinctValues(v){if(!this.returnDistinctValues)return v.length;
v.forEach(g=>this.getAttributes(g));return this._returnDistinctMap.size}getAttributes(v){v=this._processAttributesForOutFields(v);return this._processAttributesForDistinctValues(v)}getFieldValue(v,g,p){const w=p?p.name:g;let I=null;this._fieldDataCache.has(w)?I=this._fieldDataCache.get(w)?.clause:p||(I=d.getWhereClause(g,this.fieldsIndex),this._fieldDataCache.set(w,{alias:w,clause:I}));return p?this.featureAdapter.getAttribute(v,w):I?.calculateValue(v,this.featureAdapter)}getDataValues(v,g,p=!0){const w=
g.normalizationType,I=g.normalizationTotal,E=this.fieldsIndex.get(g.field),t=B.isDateOnlyField(E)||B.isTimestampOffsetField(E),q=B.isTimeOnlyField(E);return v.map(a=>{let r=g.field&&this.getFieldValue(a,g.field,this.fieldsIndex.get(g.field));g.field2?(r=`${M.processNullValue(r)}${g.fieldDelimiter}${M.processNullValue(this.getFieldValue(a,g.field2,this.fieldsIndex.get(g.field2)))}`,g.field3&&(r=`${r}${g.fieldDelimiter}${M.processNullValue(this.getFieldValue(a,g.field3,this.fieldsIndex.get(g.field3)))}`)):
"string"===typeof r&&p&&(t?r=r?(new Date(r)).getTime():null:q&&(r=r?z.timeOnlyToMilliseconds(r):null));w&&Number.isFinite(r)&&(a="field"===w&&g.normalizationField?this.getFieldValue(a,g.normalizationField,this.fieldsIndex.get(g.normalizationField)):null,r=M.getNormalizedValue(r,w,a,I));return r})}async getExpressionValues(v,g,p,w,I){const {arcadeUtils:E}=await n.loadArcade(),t=E.hasGeometryOperations(g);t&&await E.enableGeometryOperations();const q=E.createFunction(g),a=E.getViewInfo(p),r={fields:this.fieldsIndex.fields};
return v.map(y=>{y={attributes:this.featureAdapter.getAttributes(y),layer:r,geometry:t?{...e.getGeometry(w.geometryType,w.hasZ,w.hasM,this.featureAdapter.getGeometry(y)),spatialReference:p?.spatialReference}:null};y=E.createExecContext(y,a,I);return E.executeFunction(q,y)})}validateItem(v,g){this._fieldDataCache.has(g)||this._fieldDataCache.set(g,{alias:g,clause:d.getWhereClause(g,this.fieldsIndex)});return this._fieldDataCache.get(g)?.clause?.testFeature(v,this.featureAdapter)??!1}validateItems(v,
g){this._fieldDataCache.has(g)||this._fieldDataCache.set(g,{alias:g,clause:d.getWhereClause(g,this.fieldsIndex)});return this._fieldDataCache.get(g)?.clause?.testSet(v,this.featureAdapter)??!1}_processAttributesForOutFields(v){const g=this.outFields;if(!g?.length)return this.featureAdapter.getAttributes(v);const p={};for(const w of g){const {alias:I,clause:E}=this._fieldDataCache.get(w);p[I]=E?E.calculateValue(v,this.featureAdapter):this.featureAdapter.getAttribute(v,I)}return p}_processAttributesForDistinctValues(v){if(null==
v||!this.returnDistinctValues)return v;var g=this.outFields,p=[];if(g)for(const I of g){var {alias:w}=this._fieldDataCache.get(I);p.push(v[w])}else for(w in v)p.push(v[w]);g=`${(g||["*"]).join(",")}=${p.join(",")}`;p=this._returnDistinctMap.get(g)||0;this._returnDistinctMap.set(g,++p);return 1<p?null:v}}return f})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w,I,E,t){function q(b){b=S.exec(b);if(!b)return null;const {hh:A,mm:R,ss:H,ms:Q}=b.groups;return Number(A)*M.millisecondsPerTimeUnit.hours+Number(R)*M.millisecondsPerTimeUnit.minutes+Number(H)*M.millisecondsPerTimeUnit.seconds+Number(Q||0)}function a(b,A){b=null!=b?b:"";null!=A&&A&&(b=b?"("+b+") AND ("+A+")":A);return b}function r(b){const A=b.layer;return b.fields.filter(R=>!A.getField(R))}function y(b){const A=b.layer;return b.fields.filter(R=>{R=A.getFieldUsageInfo(R);
return!R||!R.supportsStatistics})}let F=null;const S=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;d.calculateHeatmapStats=function(b,A=18,R,H,Q,N){const T=new Float64Array(Q*N);A=Math.round(z.pt2px(A));let l=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY;var m=0;let u=0,J=0,L=0;R=p.createValueFunction(H,R);for(const {geometry:Y,attributes:ea}of b){const {x:la,y:na}=Y;b=Math.max(0,la-A);m=Math.max(0,na-A);H=Math.min(N,na+A);const ta=Math.min(Q,la+A),
ua=+R(ea);for(let sa=m;sa<H;sa++)for(let va=b;va<ta;va++){m=sa*Q+va;const xa=p.evaluateDensityKernel(va-la,sa-na,A);var U=T[m];m=T[m]+=xa*ua;U=m-U;u+=U;J+=U*U;m<l&&(l=m);m>O&&(O=m);L++}}return L?{mean:u/L,stdDev:Math.sqrt((J-u*u/L)/L),min:l,max:O,mid:(O-l)/2,count:L}:{mean:0,stddev:0,min:0,max:0,mid:0,count:0}};d.getDataValues=async function(b,A,R=!0){if(!A)return[];const {field:H,field2:Q,field3:N,fieldDelimiter:T,fieldInfos:l,timeZone:O}=b;var m=H&&l?.find(sa=>sa.name.toLowerCase()===H.toLowerCase());
const u=m?g.isTimeOnlyField(m):!1,J=m?w.isAnyDateField(m):!1,L=b.valueExpression,U=b.normalizationType,Y=b.normalizationField,ea=b.normalizationTotal,la=[];m=b.viewInfoParams;let na=null,ta=null;if(L){if(!F){const {arcadeUtils:sa}=await E.loadArcade();F=sa}F.hasGeometryOperations(L)&&await F.enableGeometryOperations();na=F.createFunction(L);ta=m?F.getViewInfo({viewingMode:m.viewingMode,scale:m.scale,spatialReference:new n(m.spatialReference)}):null}b=b.fieldInfos;const ua=A[0]&&"declaredClass"in A[0]&&
"esri.Graphic"===A[0].declaredClass||!b?null:{fields:b};A.forEach(sa=>{var va=sa.attributes;if(L){var xa=F.createExecContext(ua?{...sa,layer:ua}:sa,ta,O);xa=F.executeFunction(na,xa)}else va&&(xa=va[H],Q?(xa=`${I.processNullValue(xa)}${T}${I.processNullValue(va[Q])}`,N&&(xa=`${xa}${T}${I.processNullValue(va[N])}`)):"string"===typeof xa&&R&&(J?xa=xa?(new Date(xa)).getTime():null:u&&(xa=xa?q(xa):null)));U&&"number"===typeof xa&&isFinite(xa)&&(va=va&&parseFloat(va[Y]),xa=I.getNormalizedValue(xa,U,va,
ea));la.push(xa)});return la};d.getRangeExpr=function(b,A,R){A=null!=A?b+" \x3e\x3d "+A:"";b=null!=R?b+" \x3c\x3d "+R:"";R="";return(R=A&&b?a(A,b):A||b)?"("+R+")":""};d.getSQLFilterForNormalization=function(b){const A=b.field,R=b.normalizationType;b=b.normalizationField;let H;if("field"===R)H="(NOT "+b+" \x3d 0)";else if("log"===R||"natural-log"===R||"square-root"===R)H=`(${A} > 0)`;return H};d.getSumOfAttributesExpr=function(b,A,R){const H=[],Q=[],N=[],T=[],l=[];b.forEach((u,J)=>{const L=u.field?
"field":"expression",U=u.field||u.valueExpression;u.field?(l.push(U),Q.push(`var ${L}${J} = Number($feature["${U}"]);`)):(H.push(`function getValueForExpr${J}() {\n  ${U} \n}`),Q.push(`var ${L}${J} = Number(getValueForExpr${J}());`));R||N.push(`${L}${J} = IIf(${L}${J} < 0, 0, ${L}${J});`);T.push(`${L}${J}`)});b="return sum;";const O=H.length?null:l.reduce((u,J)=>`${u} + ${J}`);let m=null;A||R?A?R||(b="return IIf(sum \x3e\x3d 0, sum, null);",O&&(m=`(( ${O} ) >= 0)`)):(b="return IIf(sum !\x3d 0, sum, null);",
O&&(m=`(( ${O} ) <> 0)`)):(b="return IIf(sum \x3e 0, sum, null);",O&&(m=`(( ${O} ) > 0)`));return{valueExpression:[H.length?H.join("\n"):"",Q.join("\n"),N.join("\n"),`var sum = ${T.join(" + ")};`,b].filter(Boolean).join("\n\n"),sqlExpression:O,sqlWhere:m}};d.mergeWhereClauses=a;d.quantizeFeatures=function(b,A,R,H){const Q=v.isWrappable(R)?v.getInfo(R):null,N=Q?Math.round((Q.valid[1]-Q.valid[0])/A.scale[0]):null;return b.map(T=>{const l=new t(T.geometry);f.quantizePoint(A,l,l,l.hasZ,l.hasM);if(Q){var O=
N??0,m=H[0];0>l.x?l.x+=O:l.x>m&&(l.x-=O)}T.geometry=l;return T})};d.timeOnlyToMilliseconds=q;d.verifyBasicFieldValidity=function(b,A,R){const H=r({layer:b,fields:A});if(H.length)return new B(R,"Unknown fields: "+H.join(", ")+". You can only use fields defined in the layer schema");b=y({layer:b,fields:A});if(b.length)return new B(R,"Unsupported fields: "+b.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};d.verifyFieldType=function(b,
A,R,H){let Q;A?A.name!==b.objectIdField&&H.includes(A.type)||(Q=new B(R,"'field' should be one of these types: "+H.join(","))):Q=new B(R,"'field' is not defined in the layer schema");return Q};d.verifyFilterValidty=function(b,A){if(b&&"intersects"!==b.spatialRelationship)return new B(A,"Only 'intersects' spatialRelationship is supported for featureFilter")};d.verifyNumericField=function(b,A,R){let H;A?A.name!==b.objectIdField&&g.isNumericField(A)||(H=new B(R,"'field' should be one of these numeric types: "+
g.numericTypes.join(","))):H=new B(R,"'field' is not defined in the layer schema");return H};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(d){function e(z){return z?72*z/96:0}const B=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;d.castRenderScreenPointArray=function(z){return z};d.castRenderScreenPointArray3=function(z){return z};d.castScreenPointArray=function(z){return z};d.createRenderScreenPoint=function(z=0,M=0){return{x:z,
y:M}};d.createRenderScreenPointArray=function(z=0,M=0){return[z,M]};d.createRenderScreenPointArray3=function(z=0,M=0,n=0){return[z,M,n]};d.createScreenPoint=function(z=0,M=0){return{x:z,y:M}};d.createScreenPointArray=function(z=0,M=0){return[z,M]};d.pt2px=function(z){return z?z/72*96:0};d.px2pt=e;d.screenPointArrayToObject=function(z,M){return M?(M.x=z[0],M.y=z[1],M):{x:z[0],y:z[1]}};d.screenPointObjectToArray=function(z,M){return M?(M[0]=z.x,M[1]=z.y,2<M.length&&(M[2]=0),M):[z.x,z.y]};d.toPt=function(z){if("string"===
typeof z){var M=z.match(B);if(M){var n=Number(M[1]);M=M[3]&&M[3].toLowerCase();z="-"===z.charAt(0);n="px"===M?e(n):n;return z?-n:n}console.warn("screenUtils.toPt: input not recognized!");return null}return z};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports","../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(d,e,B,z){function M(v,g,p){return 0===v?0:v*f[g]/f[p]}function n(v){switch(v){case "milliseconds":return"millisecond";
case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const f={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8};d.convertTime=M;d.isValidDate=function(v){return v instanceof Date&&!isNaN(v.getTime())};d.makeUTCTime=function(v,g,p="milliseconds"){g=new Date(M(g,p,"milliseconds"));
g.setUTCFullYear(v.getUTCFullYear(),v.getUTCMonth(),v.getUTCDate());return g};d.mergeTimeExtents=function(v,g){return v&&g?v.intersection(g):v||g};d.millisecondsPerTimeUnit=f;d.offsetDate=function(v,g,p,w=B.system){w=new z.IANAZone(e.resolveTimeZone(w));v=z.DateTime.fromJSDate(v,{zone:w});w="decades"===p||"centuries"===p?"year":n(p);"decades"===p&&(g*=10);"centuries"===p&&(g*=100);return v.plus({[w]:g}).toJSDate()};d.offsetDateUTC=function(v,g,p="milliseconds"){v=v.getTime();g=M(g,p,"milliseconds");
return new Date(v+g)};d.resetUTCDate=function(v,g){v=new Date(v.getTime());v.setUTCFullYear(g.getFullYear(),g.getMonth(),g.getDate());return v};d.timeSinceUTCMidnight=function(v,g="milliseconds"){const p=M(v.getUTCHours(),"hours","milliseconds"),w=M(v.getUTCMinutes(),"minutes","milliseconds"),I=M(v.getUTCSeconds(),"seconds","milliseconds");v=v.getUTCMilliseconds();return M(p+w+I+v,"milliseconds",g)};d.truncateDate=function(v,g,p=B.system){p=new z.IANAZone(e.resolveTimeZone(p));v=z.DateTime.fromJSDate(v,
{zone:p});if("decades"===g||"centuries"===g)return v=v.startOf("year"),{year:p}=v,v.set({year:p-p%("decades"===g?10:100)}).toJSDate();g=n(g);return v.startOf(g).toJSDate()};d.truncateLocalTime=function(v){const g=new Date(0);g.setHours(0);g.setMinutes(0);g.setSeconds(0);g.setMilliseconds(0);g.setFullYear(v.getUTCFullYear(),v.getUTCMonth(),v.getUTCDate());return g};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils",
"../../core/screenUtils","../../chunks/vec4","../../chunks/vec4f64"],function(d,e,B,z,M){function n(p,w,I,E){let {color:t,ratio:q}=w,{color:a,ratio:r}=I;r===q&&(1===r?q-=1E-6:r+=1E-6);w=e.clamp((E-q)/(r-q),0,1);z.lerp(p,t.toArray(),a.toArray(),w)}function f(p,w,I,E,t){p=new Uint32Array(p*p);w="buffer"in w?w:new Float64Array(w);I="buffer"in I?new Uint32Array(I.buffer):new Uint32Array((new Uint8Array(I)).buffer);t=I.length/(t-E);for(let q=0;q<w.length;q++)p[q]=I[e.clamp(Math.floor((w[q]-E)*t),0,I.length-
1)];return p.buffer}function v(p,w,I){p=Math.sqrt(p**2+w**2)/I;return 1<p?0:3/(Math.PI*I**2)*(1-p**2)**2}function g(p,w){return null!=p?"string"===typeof w?I=>-1*+I.readAttribute(p):I=>+I.readAttribute(p)+w:I=>1}d.calculateHeatmapIntensityInfoReaders=function(p,w,I,E){const {radius:t,fieldOffset:q,field:a}=w;w=Math.round(B.pt2px(t));const r=new Float64Array(I*E);let y=Number.NEGATIVE_INFINITY;const F=g(a,q),S=new Set;for(const H of p)for(p=H.getCursor();p.next();){var b=p.getObjectId();if(S.has(b))continue;
S.add(b);b=p.readLegacyPointGeometry();if(-128>b.x||b.x>=I+128||-128>b.y||b.y>E+128)continue;const Q=+F(p),N=Math.max(0,Math.round(b.x)-w);var A=Math.max(0,Math.round(b.y)-w);const T=Math.min(E,Math.round(b.y)+w),l=Math.min(I,Math.round(b.x)+w);for(;A<T;A++)for(let O=N;O<l;O++){var R=A*I+O;const m=v(b.x-O,b.y-A,w);R=r[R]+=m*Q;R>y&&(y=R)}}return{matrix:r.buffer,max:y}};d.createHeatmapImageData=f;d.createValueFunction=function(p,w){return"function"===typeof p?p:p?"string"===typeof w?I=>-1*+I[p]:I=>
+I[p]+w:()=>1};d.createValueFunctionCursor=g;d.drawHeatmap=function(p,w,I,E,t,q){p.canvas.width=p.canvas.height=w;p.clearRect(0,0,w,w);const a=p.getImageData(0,0,w,w);I&&E&&a.data.set(new Uint8ClampedArray(f(w,I,E,t,q)));p.putImageData(a,0,0)};d.evaluateDensityKernel=v;d.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(p){return B.px2pt(2.4*p)};d.generateGradient=function(p){const w=new Uint8ClampedArray(2048);p=p.filter(({ratio:a})=>0<=a&&1>=a).sort((a,r)=>a.ratio-r.ratio).map(({color:a,ratio:r})=>
({color:a,ratio:Math.max(r,.001)}));if(1>p.length)return w;let I=p[0],E=p[0],t=1;const q=M.create();for(let a=0;512>a;a++){const r=(a+.5)/512;for(;r>E.ratio&&t<p.length;)I=E,E=p[t++];n(q,I,E,r);w.set(q,4*a)}return w};d.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(p){return B.pt2px(p)/2.4};d.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(d,e,B,z,M,n){function f(t){return String(t).padStart(2,"0")}function v(t,q,a){if("date"===q||"number"===q){"number"===q&&(t=new Date(t));q=a?t.getFullYear():t.getUTCFullYear();const r=f((a?t.getMonth():t.getUTCMonth())+1),y=f(a?t.getDate():t.getUTCDate()),F=f(a?t.getHours():t.getUTCHours()),S=f(a?t.getMinutes():t.getUTCMinutes());t=f(a?t.getSeconds():t.getUTCSeconds());t=`TIMESTAMP'${q}-${r}-${y} ${F}:${S}:${t}'`}return t}function g(t,q){if(q instanceof Date)return"date";if("number"===typeof q)return"number";
if("string"===typeof q&&(t=t.getField(q),"\x3cnow\x3e"!==q.toLowerCase()&&B.isDateField(t)))return"field"}const p={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},w={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},I=new Set(["integer","small-integer"]);let E=null;d.castIntegerFieldToFloat=function(t){return`cast(${t} as float)`};d.dateTypes=["date","date-only","timestamp-offset"];
d.defaultBasemapGroups=p;d.fieldDelimiter=",";d.formatAnyDate=function(t,q){const {format:a,timeZoneOptions:r,fieldType:y}=q??{};let F;r&&({timeZone:S,timeZoneName:F}=n.getTimeZoneFormattingOptions(r.layerTimeZone,r.datesInUnknownTimezone,r.viewTimeZone,e.convertDateFormatToIntlOptions(a||"short-date-short-time"),y));if("string"===typeof t&&isNaN(Date.parse("time-only"===y?`1970-01-01T${t}Z`:t)))return t;switch(y){case "date-only":var S=e.convertDateFormatToIntlOptions(a||"short-date");return"string"===
typeof t?e.formatDateOnly(t,{...S}):e.formatDate(t,{...S,timeZone:n.utc});case "time-only":return S=e.convertDateFormatToIntlOptions(a||"short-time"),"string"===typeof t?e.formatTimeOnly(t,S):e.formatDate(t,{...S,timeZone:n.utc});case "timestamp-offset":if(!S&&"string"===typeof t&&(new Date(t)).toISOString()!==t)return t;S=(q=a||r?e.convertDateFormatToIntlOptions(a||"short-date-short-time"):void 0)?{...q,timeZone:S,timeZoneName:F}:void 0;return"string"===typeof t?e.formatTimestamp(t,S):e.formatDate(t,
S);default:return q=a||r?e.convertDateFormatToIntlOptions(a||"short-date-short-time"):void 0,e.formatDate("string"===typeof t?new Date(t):t,q?{...q,timeZone:S,timeZoneName:F}:void 0)}};d.getBasemapGroup=function(t,q=p){for(const a in q)if(q[a].includes(t))return a};d.getBasemapId=function(t,q,a=!0){let r=null;t&&("string"===typeof t?q.includes(t)&&(r=t):r=M.getWellKnownBasemapId(t));return a?r||"gray":r};d.getDateDiffSQL=function(t,q,a,r){const {hasQueryEngine:y}=t;a=v(a,g(t,a),y);t=v(q,g(t,q),y);
t=`(${a} - ${t})`;r=w[r];q="/";1>r&&(r=1/r,q="*");return{sqlExpression:1===r?t:`(${t} ${q} ${r})`,sqlWhere:null}};d.getDateType=g;d.getFieldsList=async function(t){const {field:q,field2:a,field3:r,normalizationField:y,valueExpression:F}=t;t=[];F&&(E||({arcadeUtils:t}=await z.loadArcade(),E=t),t=E.extractFieldNames(F));q&&t.push(q);a&&t.push(a);r&&t.push(r);y&&t.push(y);return t};d.getNormalizationType=function(t){let q=t.normalizationType;q||(t.normalizationField?q="field":null!=t.normalizationTotal&&
(q="percent-of-total"));return q??void 0};d.isAnyDateField=function(t){return B.isDateField(t)||B.isDateOnlyField(t)||B.isTimestampOffsetField(t)};d.isIntegerField=function(t,q){t=q&&t.getField(q);return!!t&&I.has(t.type)};d.unitValueInDays=w;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(d,e,B,z,M,n,f,v,g,p){function w(m,u){let J;if("string"===typeof m){const L=m in p.esriBasemapDefinitions,U=!L&&m.includes("/");if(!L&&!U)return u=Object.entries(p.esriBasemapDefinitions).filter(([,Y])=>B.apiKey&&!Y.classic||!B.apiKey&&(Y.classic||Y.is3d)).map(([Y])=>`"${Y}"`).sort().join(", "),T.warn(`Unable to find basemap definition for: ${m}. Try one of these: ${u}`),null;u&&(J=u[m]);J||(J=L?e.fromId(m):new e({style:{id:m}}),u&&(u[m]=J))}else J=v.ensureType(e,m);J?.destroyed&&(T.warn("The provided basemap is already destroyed",
{basemap:J}),J=null);return J}function I(m){if(l)return l(m);let u=null;m=a(m);const J=!m?.baseLayers.length;for(const U in p.esriBasemapDefinitions){var L=S(p.esriBasemapDefinitions[U]);L=A(m,L,{mustMatchReferences:J});if("equal"===L){u=U;break}"base-layers-equal"===L&&(u=U)}return u}function E(m,u){const J=new z;m.forEach(L=>{const U=u.find(Y=>"scene"!==Y.type&&H(y(L),y(Y)))||L;J.includes(U)?J.push(L):J.push(U)});return J}function t(m){if(q(m.url))return!0;if("vector-tile"===m.type)for(const u in m.sourceNameToSource)if(q(m.sourceNameToSource[u]?.sourceUrl))return!0;
return!1}function q(m){if(!m)return!1;m=new f.Url(f.makeAbsolute(m));return!!m.authority&&O.test(m.authority)}function a(m){return m?!m.loaded&&m.resourceInfo?S(m.resourceInfo.data):{baseLayers:r(m.baseLayers),referenceLayers:r(m.referenceLayers)}:null}function r(m){return(z.isCollection(m)?m.toArray():m).map(y)}function y(m){return{type:m.type,effect:"effect"in m?m.effect:void 0,url:Q("urlTemplate"in m&&m.urlTemplate||m.url||"styleUrl"in m&&m.styleUrl||""),minScale:"minScale"in m&&null!=m.minScale?
m.minScale:0,maxScale:"maxScale"in m&&null!=m.maxScale?m.maxScale:0,opacity:null!=m.opacity?m.opacity:1,visible:null!=m.visible?!!m.visible:!0,sublayers:"map-image"!==m.type&&"wms"!==m.type||null==m.sublayers?void 0:m.sublayers?.map(u=>({id:u.id,visible:u.visible})),activeLayerId:"wmts"===m.type?m.activeLayer?.id:void 0}}function F(m){return m.isReference||"ArcGISSceneServiceLayer"===m.layerType}function S(m){return m?{baseLayers:b((m.baseMapLayers??[]).filter(u=>!F(u))),referenceLayers:b((m.baseMapLayers??
[]).filter(u=>F(u)))}:null}function b(m){return m.map(u=>{let J;switch(u.layerType){case "VectorTileLayer":J="vector-tile";break;case "ArcGISTiledMapServiceLayer":J="tile";break;case "ArcGISSceneServiceLayer":J="scene";break;default:J="unknown"}return{type:J,effect:u.effect,url:Q(u.templateUrl||u.urlTemplate||u.styleUrl||u.url),minScale:u.minScale??0,maxScale:u.maxScale??0,opacity:u.opacity??1,visible:null!=u.visibility?!!u.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function A(m,u,J){return null!=
m!==(null!=u)?"not-equal":m&&u?R(m.baseLayers,u.baseLayers)?R(m.referenceLayers,u.referenceLayers)?"equal":J.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function R(m,u){if(m.length!==u.length)return!1;for(let J=0;J<m.length;J++)if(!H(m[J],u[J]))return!1;return!0}function H(m,u){if(m.type!==u.type||m.url!==u.url||m.minScale!==u.minScale||m.maxScale!==u.maxScale||m.visible!==u.visible||m.opacity!==u.opacity||!g.effectEquals(m.effect,u.effect))return!1;if(null!=m.activeLayerId||
null!=u.activeLayerId)return m.activeLayerId===u.activeLayerId;if(null!=m.sublayers||null!=u.sublayers){if(null==m.sublayers||null==u.sublayers||m.sublayers.length!==u.sublayers.length)return!1;for(let J=0;J<m.sublayers.length;J++){const L=m.sublayers.at(J),U=u.sublayers.at(J);if(L?.id!==U?.id||L?.visible!==U?.visible)return!1}}return!0}function Q(m){return m?f.normalize(m).replace(/^\s*https?:/i,"").toLowerCase():""}function N(m){return"portalItem"in m?m.portalItem?.thumbnailUrl:void 0}const T=M.getLogger("esri.support.basemapUtils");
let l;const O=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;d.clonePreservingTiledLayers=function(m,u=null){m=w(m);if(!m)return null;m=m.clone();u&&(m.baseLayers=E(m.baseLayers,u.baseLayers),m.referenceLayers=E(m.referenceLayers,u.referenceLayers));return m};d.contentEquals=function(m,u){if(m===u||null!=m?.portalItem?.id&&m.portalItem.id===u?.portalItem?.id)return!0;m=a(m);u=a(u);return"equal"===A(m,u,{mustMatchReferences:!0})};d.createCache=function(){return{}};d.destroyCache=function(m){for(const u in m)n.destroyMaybe(m[u]),
delete m[u]};d.ensureType=w;d.findSpatialReference=function(m,u){if(null==u||null==m)return{spatialReference:null,updating:!1};if("not-loaded"===u.loadStatus)return u.load(),{spatialReference:null,updating:!0};if(u.spatialReference)return{spatialReference:u.spatialReference,updating:!1};if(0===u.baseLayers.length)return{spatialReference:null,updating:!1};u=u.baseLayers.at(0);switch(u.loadStatus){case "not-loaded":u.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,
updating:!1}}u=(("supportedSpatialReferences"in u?u.supportedSpatialReferences:null)||["tileInfo"in u?u.tileInfo?.spatialReference:u.spatialReference]).filter(Boolean);const J=m.spatialReference;return J?{spatialReference:u.find(L=>J.equals(L))??u[0]??null,updating:!1}:{spatialReference:u[0],updating:!1}};d.getBasemapThumbnailUrl=function(m){if(!m)return null;var {thumbnailUrl:u}=m;return u?u:(u=I(m))?p.esriBasemapDefinitions[u].thumbnailUrl:n.mappedFind(m.baseLayers,N)};d.getWellKnownBasemapId=I;
d.hasDeveloperBasemapLayer=function(m){return!!m?.baseLayers.concat(m.referenceLayers).some(t)};d.isBasemap3D=function(m){return"Web Scene"===m.portalItem?.type};d.isBasemapInBeta=function(m){return!!m?.portalItem?.tags?.some(u=>"beta"===u.toLowerCase())};d.isBasemapLayer=function(m,u){return m.basemap?.referenceLayers?.some(J=>J.uid===u)||m.basemap?.baseLayers?.some(J=>J.uid===u)};d.isDeveloperBasemapLayer=t;d.overrideGetWellKnownBasemapId=function(m){l=m};Object.defineProperty(d,Symbol.toStringTag,
{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w,I,E,t,q,a,r,y,F,S,b,A,R){var H;let Q=0;n=H=class extends n.JSONSupportMixin(v){constructor(l){super(l);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+Q++;this.baseLayers=new z;this.referenceLayers=new z;const O=m=>{m.parent&&m.parent!==this&&"remove"in m.parent&&m.parent.remove(m);m.parent=this;"elevation"===m.type&&p.getLogger(this).error(`Layer '${m.title}, id:${m.id}' of type '${m.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",m=>O(m.item)),this.referenceLayers.on("after-add",m=>O(m.item)),this.baseLayers.on("after-remove",m=>{m.item.parent=null}),this.referenceLayers.on("after-remove",m=>{m.item.parent=null})])}initialize(){this.when().catch(l=>{p.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,l)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var l=this.baseLayers.toArray();for(const O of l)O.destroy();
l=this.referenceLayers.toArray();for(const O of l)O.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=w.destroyMaybe(this.portalItem)}normalizeCtorArgs(l){l&&"resourceInfo"in l&&(this._set("resourceInfo",l.resourceInfo),l={...l},delete l.resourceInfo);return l}set baseLayers(l){this._set("baseLayers",M.referenceSetter(l,this._get("baseLayers")))}_writeBaseLayers(l,O,m){const u=[];l&&(m={...m,layerContainerType:"basemap"},this.baseLayers.forEach(J=>{J=R.getLayerJSON(J,
m.webmap?m.webmap.getLayerJSONFromResourceInfo(J):null,m);null!=J&&u.push(J)}),this.referenceLayers.forEach(J=>{const L=R.getLayerJSON(J,m.webmap?m.webmap.getLayerJSONFromResourceInfo(J):null,m);null!=L&&("scene"!==J.type&&(L.isReference=!0),u.push(L))}));O.baseMapLayers=u}set referenceLayers(l){this._set("referenceLayers",M.referenceSetter(l,this._get("referenceLayers")))}writeTitle(l,O){O.title=l||"Basemap"}load(l){this.addResolvingPromise(this._loadFromSource(l));return Promise.resolve(this)}loadAll(){return g.loadAll(this,
l=>{l(this.baseLayers,this.referenceLayers)})}clone(){const l={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(O=>f.isClonable(O)?O.clone():O),referenceLayers:this.referenceLayers.map(O=>f.isClonable(O)?O.clone():O)};this.loaded&&(l.loadStatus="loaded");return(new H({resourceInfo:this.resourceInfo})).set(l)}read(l,O){this.resourceInfo||this._set("resourceInfo",{data:l,context:O});super.read(l,O)}write(l,O){l=l||{};O?.origin||(O={origin:"web-map",...O});super.write(l,
O);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(l.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(m=>{m=f.clone(m);m.url&&E.isProtocolRelative(m.url)&&(m.url=`https:${m.url}`);m.templateUrl&&E.isProtocolRelative(m.templateUrl)&&(m.templateUrl=`https:${m.templateUrl}`);return m}));return l}async _loadFromSource(l){const {resourceInfo:O,portalItem:m,style:u}=this;I.throwIfAborted(l);const J=[];O?(J.push(this._loadLayersFromJSON(O.data,O.context?O.context.url:null,l)),O.data.id&&!O.data.title&&
J.push(b.getBasemapTitle(O.data.id).then(L=>{L&&this.read({title:L},O.context)}))):m?J.push(this._loadFromItem(m,l)):u&&J.push(this._loadFromStylesService(u,l));await Promise.all(J)}async _loadLayersFromJSON(l,O,m){const u=this.resourceInfo?.context,J=this.portalItem?.portal||u?.portal||null,L=T[u?.origin||""]??"web-map",{populateOperationalLayers:U}=await new Promise((ea,la)=>d(["./layers/support/layersCreator"],ea,la)),Y=[];I.throwIfAborted(m);if(l.baseMapLayers&&Array.isArray(l.baseMapLayers)){O=
{context:{...u,origin:L,url:O,portal:J,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const ea=la=>"web-scene"===L&&"ArcGISSceneServiceLayer"===la.layerType||la.isReference;m=U(this.baseLayers,l.baseMapLayers.filter(la=>!ea(la)),O);Y.push(m);l=U(this.referenceLayers,l.baseMapLayers.filter(ea),O);Y.push(l)}await Promise.allSettled(Y)}async _loadFromItem(l,O){const m=await (await l.load(O)).fetchData("json",O),u=E.urlToObject(l.itemUrl??"");this._set("resourceInfo",{data:m.baseMap??
{},context:{origin:N[l.type||""]??"web-map",portal:l.portal||F.getDefault(),url:u}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:m.spatialReference},this.resourceInfo.context);this.read({title:l.title,thumbnailUrl:l.thumbnailUrl},{origin:"portal-item",portal:l.portal||F.getDefault(),url:u});return this._loadLayersFromJSON(this.resourceInfo.data,u,O)}async _loadFromStylesService(l,O){var m=`${l.serviceUrl}/${l.id}`;l=(await B(m,{query:{language:l.getLanguageParamValue()},
signal:O?.signal})).data;if(l.baseMap&&Array.isArray(l.baseMap.baseMapLayers))for(const u of l.baseMap.baseMapLayers)if(!u.customParameters&&u.styleUrl?.includes("?")){const J=E.urlToObject(u.styleUrl);J.query&&(u.styleUrl=J.path,u.customParameters=J.query)}m=E.urlToObject(m);this._set("resourceInfo",{data:l.baseMap??{},context:{origin:"web-map",url:m}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:l.spatialReference},this.resourceInfo.context);return this._loadLayersFromJSON(this.resourceInfo.data,
m,O)}static fromId(l){return(l=b.esriBasemapDefinitions[l])?l.itemId?new H({portalItem:{id:l.itemId,portal:{url:"https://www.arcgis.com"}}}):H.fromJSON(l,{origin:l.is3d?"web-scene":"web-map"}):null}};e.__decorate([t.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(l,O,m,u){this._writeBaseLayers(l,O,u)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:z}},writer(l,O,m,u){this._writeBaseLayers(l,O,u)}}}}}})],n.prototype,"baseLayers",null);e.__decorate([t.property({type:String,
json:{origins:{"web-scene":{write:!0}}}})],n.prototype,"id",void 0);e.__decorate([t.property({type:S})],n.prototype,"portalItem",void 0);e.__decorate([t.property()],n.prototype,"referenceLayers",null);e.__decorate([t.property({readOnly:!0})],n.prototype,"resourceInfo",void 0);e.__decorate([t.property({type:y})],n.prototype,"spatialReference",void 0);e.__decorate([t.property({type:A})],n.prototype,"style",void 0);e.__decorate([t.property()],n.prototype,"thumbnailUrl",void 0);e.__decorate([t.property({type:String,
json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],n.prototype,"title",void 0);e.__decorate([r.writer("title")],n.prototype,"writeTitle",null);n=H=e.__decorate([a.subclass("esri.Basemap")],n);const N={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},T={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return n})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(d,e){d.castForReferenceSetter=function(B){return B};d.referenceSetter=
function(B,z,M=e){z||(z=new M);if(z===B)return z;z.removeAll();B&&(Array.isArray(B)||"items"in B&&Array.isArray(B.items))?z.addMany(B):B&&z.add(B);return z};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(d,e,B,z,M,n,f,v){const g=p=>{p=class extends p{constructor(...w){super(...w);
this.loadError=this._loadController=null;this.loadStatus="not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(I=>{const E=this.load.bind(this);this.load=t=>{const q=new Promise((a,r)=>{const y=M.onAbortOrThrow(t,r);this.destroyed&&r(new e("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(a,r).finally(()=>{y&&y.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");
const a=this._loadController=new AbortController;E({signal:a.signal})}I();return q}}));this.when(()=>{this._set("loadStatus","loaded");this._loadController=null},I=>{this._set("loadStatus","failed");this._set("loadError",I);this._loadController=null})}destroy(){this._loadController&&(this._loadController=B.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;
this._set("loadError",new e("load:cancelled","Cancelled"));this._loadController?.abort();this._promiseProps.abort();return this}};d.__decorate([f.property({readOnly:!0})],p.prototype,"loaded",null);d.__decorate([f.property({readOnly:!0})],p.prototype,"loadError",void 0);d.__decorate([f.property({clonable:!1})],p.prototype,"loadStatus",void 0);d.__decorate([f.property({type:[n],readOnly:!0})],p.prototype,"loadWarnings",null);return p=d.__decorate([v.subclass("esri.core.Loadable")],p)};z=class extends g(z.EsriPromise){};
z=d.__decorate([v.subclass("esri.core.Loadable")],z);(function(p){p.LoadableMixin=g;p.isLoadable=function(w){return!(!w||!w.load)}})(z||(z={}));return z})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(d,e,B,z,M){var n;(function(g){g[g.PENDING=0]="PENDING";g[g.RESOLVED=1]="RESOLVED";g[g.REJECTED=2]="REJECTED"})(n||(n={}));class f{constructor(){this._resolver=z.createResolver();this._status=n.PENDING;
this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=n.RESOLVED;this._cleanUp()},()=>{this._status=n.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(g){this._resolvingPromises.push(g);this._tryResolve()}isResolved(){return this._status===n.RESOLVED}isRejected(){return this._status===n.REJECTED}isFulfilled(){return this._status!==n.PENDING}abort(){this._resolver.reject(z.createAbortError())}_cleanUp(){this._resolvingPromises=
this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var g=z.createResolver(),p=[...this._resolvingPromises,g.promise],w=this._allPromise=Promise.all(p);w.then(()=>{this.isFulfilled()||this._allPromise!==w||this._resolver.resolve()},I=>{this.isFulfilled()||this._allPromise!==w||z.isAbortError(I)||this._resolver.reject(I)});g.resolve()}}}const v=g=>{g=class extends g{constructor(...p){super(...p);this._promiseProps=new f;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(p,
w){return this._promiseProps.promise.then(()=>this).then(p,w)}catch(p){return this.when(null,p)}addResolvingPromise(p){p&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in p?p.when():p)}};return g=e.__decorate([M.subclass("esri.core.Promise")],g)};d.EsriPromise=class extends v(B){};d.EsriPromise=e.__decorate([M.subclass("esri.core.Promise")],d.EsriPromise);d.EsriPromiseMixin=v;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(d,e,B,z){async function M(n,f){const v=[],g=(...w)=>{for(const I of w)null!=I&&(Array.isArray(I)?g(...I):B.isCollection(I)?I.forEach(E=>g(E)):z.isLoadable(I)&&v.push(I))};f(g);let p=null;await e.map(v,async w=>{w=await e.result("loadAll"in w&&"function"===typeof w.loadAll?w.loadAll():w.load());!1!==w.ok||p||(p=w)});if(p)throw p.error;return n}d.loadAll=async function(n,f){await n.load();return M(n,f)};d.loadAllChildren=M;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w,I,E,t,q,a,r,y,F,S,b,A,R,H){function Q(u){const J=z.id;return()=>{const L=u.deref();L&&J.findCredential(L.restUrl)&&L.signIn().catch(()=>{})}}const N=u=>Object.freeze(Object.defineProperty({__proto__:null,default:u},Symbol.toStringTag,{value:"Module"}));var T;let l;const O={PortalGroup:()=>Promise.resolve({default:S}),PortalItem:()=>new Promise((u,J)=>d(["./PortalItem"],L=>u(N(L)),J)),PortalUser:()=>Promise.resolve({default:R})};f=T=class extends f.JSONSupportMixin(v){constructor(u){super(u);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.galleryTemplatesGroupQuery=
this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.customBaseUrl=this.culture=this.created=null;this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=null;this.isReadOnly=this.isPortal=!1;this.rotatorPanels=this.region=this.portalProperties=
this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=B.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(u){return"string"===typeof u?{url:u}:u}destroy(){m.unregister(this);
this.defaultBasemap=g.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=g.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=g.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=g.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(u){if(u)for(const J of u)B.request.trustedServers.includes(J)||B.request.trustedServers.push(J);return u}readDefaultBasemap(u){return this._readBasemap(u)}readDefaultDevBasemap(u){return this._readBasemap(u)}readDefaultVectorBasemap(u){return this._readBasemap(u)}get extraQuery(){const u=
!this.user?.orgId||this.canSearchPublic;return this.id&&!u?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let u=this.url;if(u){const J=u.indexOf("/sharing");u=0<J?u.substring(0,J):this.url.replace(/\/+$/,"");u+="/sharing/rest"}return u}get thumbnailUrl(){const u=this.restUrl,J=this.thumbnail;return u&&J?this._normalizeSSL(u+"/portals/self/resources/"+J):null}readUrlKey(u){return u?u.toLowerCase():
u}readUser(u){let J=null;u&&(J=R.fromJSON(u),J.portal=this);return J}load(u){const J=(new Promise((L,U)=>d(["../Basemap"],Y=>L(N(Y)),U))).then(({default:L})=>{p.throwIfAborted(u);l=L}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,u)).then(L=>{if(z.id){const U=z.id;this.credential=U.findCredential(this.restUrl);this.credential||this.authMode!==T.AUTH_MODE_AUTO||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=U.on("credential-create",Q(new WeakRef(this))),
m.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=L;this.read(L)});this.addResolvingPromise(J);return Promise.resolve(this)}async createElevationLayers(){await this.load();const u=this._getHelperService("defaultElevationLayers"),J=(await new Promise((L,U)=>d(["../layers/ElevationLayer"],Y=>L(N(Y)),U))).default;return u?u.map(L=>new J({id:L.id,url:L.url})):[]}async fetchBasemaps(u,J){const L=await this._fetchBasemaps(u,J);!0===J?.include3d&&!1!==this.use3dBasemaps&&(u=await this._fetchBasemaps3D(u,
J),L.unshift(...u));return L}fetchCategorySchema(u){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",u).then(J=>J.categorySchema):p.isAborted(u)?Promise.reject(p.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(u){const J=this.featuredGroups,L=new b;L.num=100;L.sortField="title";if(J&&J.length){const U=[];for(const Y of J)U.push(`(title:"${Y.title}" AND owner:${Y.owner})`);L.query=U.join(" OR ");return this.queryGroups(L,u).then(Y=>Y.results)}return p.isAborted(u)?
Promise.reject(p.createAbortError()):Promise.resolve([])}fetchRegions(u){const J=this.user?.culture||this.culture||y.getLocale();return this.request(this.restUrl+"/portals/regions",{...u,query:{culture:J}})}fetchSettings(u){const J=this.user?.culture||this.culture||y.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...u,query:{culture:J}})}static getDefault(){return F.ensureDefaultPortalInstance(()=>new T)}queryGroups(u,J){return this.queryPortal("/community/groups",u,"PortalGroup",
J)}queryItems(u,J){return this.queryPortal("/search",u,"PortalItem",J)}queryUsers(u,J){u.sortField||(u.sortField="username");return this.queryPortal("/community/users",u,"PortalUser",J)}fetchSelf(u=this.authMode,J=!1,L){const U=this.restUrl+"/portals/self";u={authMode:u,query:{culture:y.getLocale().toLowerCase()},...L};"auto"===u.authMode&&(u.authMode="no-prompt");J&&(u.query.default=!0);return this.request(U,u)}queryPortal(u,J,L,U){const Y=I.ensureType(b,J),ea=la=>this.request(this.restUrl+u,{...Y.toRequestOptions(this),
...U}).then(na=>{const ta=Y.clone();ta.start=na.nextStart;return new A({nextQueryParams:ta,queryParams:Y,total:na.total,results:T._resultsToTypedArray(la,{portal:this},na,U)})}).then(na=>Promise.all(na.results.map(ta=>"function"===typeof ta.when?ta.when():na)).then(()=>na,ta=>{p.throwIfAbortError(ta);return na}));return L&&O[L]?O[L]().then(({default:la})=>{p.throwIfAborted(U);return ea(la)}):ea()}signIn(){if(this.authMode===T.AUTH_MODE_ANONYMOUS)return Promise.reject(new n("portal:invalid-auth-mode",
`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const u=J=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return J||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=J;return this.fetchSelf("immediate")});if(this.user&&this.credential===J)return null;this.credential=J;return this.fetchSelf("immediate")}).then(L=>
{L&&(this.sourceJSON=L,this.read(L))});return z.id?z.id.getCredential(this.restUrl).then(J=>u(J)):u(this.credential)}normalizeUrl(u){const J=this.credential?.token;return this._normalizeSSL(J?u+(u.includes("?")?"\x26":"?")+"token\x3d"+J:u)}requestToTypedArray(u,J,L){return this.request(u,J).then(U=>{const Y=T._resultsToTypedArray(L,{portal:this},U);return Promise.all(Y.map(ea=>"function"===typeof ea.when?ea.when():U)).then(()=>Y,()=>Y)})}request(u,J={}){const L={f:"json",...J.query},{authMode:U=this.authMode===
T.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:Y=null,cacheBust:ea=!1,method:la="auto",responseType:na="json",signal:ta}=J;J={authMode:U,body:Y,cacheBust:ea,method:la,query:L,responseType:na,timeout:0,signal:ta};return M(this._normalizeSSL(u),J).then(ua=>ua.data)}toJSON(){throw new n("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(u){if(!u)return null;if(u.declaredClass)throw Error("JSON object is already hydrated");return new T({sourceJSON:u})}_getHelperService(u){const J=
this.helperServices&&this.helperServices[u];if(!J)throw new n("portal:service-not-found",`The \`helperServices\` do not include an entry named "${u}"`);return J}async _fetchBasemaps(u,J){const L=new b;L.query=u||(B.apiKey&&H.supportsApiKey(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);L.disableExtraQuery=!0;u=await this.queryGroups(L,J);if(!u.total)return[];u=u.results[0];L.num=100;L.query='type:"Web Map" -type:"Web Application"';
L.sortField=u.sortField||"name";L.sortOrder=u.sortOrder||"desc";J=await u.queryItems(L,J);return J.total?J.results.filter(U=>"Web Map"===U.type).map(U=>new l({portalItem:U})):[]}async _fetchBasemaps3D(u,J){u=u||this.basemapGalleryGroupQuery3D;if(!u)return[];u=new b({query:u,disableExtraQuery:!0});var L=await this.queryGroups(u,J);if(!L.total)return[];L=L.results[0];u.num=100;u.query='type:"Web Scene"';u.sortField=L.sortField||"name";u.sortOrder=L.sortOrder||"desc";J=await L.queryItems(u,J);return J.total?
J.results.filter(U=>"Web Scene"===U.type).map(U=>new l({portalItem:U})):[]}_normalizeSSL(u){return u.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(u){return u?(u=l.fromJSON(u),u.portalItem={portal:this},u):null}static _resultsToTypedArray(u,J,L,U){let Y=[];if(L){const ea=null!=U?U.signal:null;Y=L.listings||L.notifications||L.userInvitations||L.tags||L.items||L.groups||L.comments||L.provisions||L.results||L.relatedItems||L;if(u||J)Y=Y.map(la=>{la=Object.assign(u?u.fromJSON(la):
la,J);"function"===typeof la.load&&la.load(ea);return la})}else Y=[];return Y}};f.AUTH_MODE_ANONYMOUS="anonymous";f.AUTH_MODE_AUTO="auto";f.AUTH_MODE_IMMEDIATE="immediate";e.__decorate([w.property()],f.prototype,"access",void 0);e.__decorate([w.property()],f.prototype,"allSSL",void 0);e.__decorate([w.property()],f.prototype,"authMode",void 0);e.__decorate([w.property()],f.prototype,"authorizedCrossOriginDomains",void 0);e.__decorate([q.reader("authorizedCrossOriginDomains")],f.prototype,"readAuthorizedCrossOriginDomains",
null);e.__decorate([w.property()],f.prototype,"basemapGalleryGroupQuery",void 0);e.__decorate([w.property({json:{name:"3DBasemapGalleryGroupQuery"}})],f.prototype,"basemapGalleryGroupQuery3D",void 0);e.__decorate([w.property()],f.prototype,"bingKey",void 0);e.__decorate([w.property()],f.prototype,"canListApps",void 0);e.__decorate([w.property()],f.prototype,"canListData",void 0);e.__decorate([w.property()],f.prototype,"canListPreProvisionedItems",void 0);e.__decorate([w.property()],f.prototype,"canProvisionDirectPurchase",
void 0);e.__decorate([w.property()],f.prototype,"canSearchPublic",void 0);e.__decorate([w.property()],f.prototype,"canShareBingPublic",void 0);e.__decorate([w.property()],f.prototype,"canSharePublic",void 0);e.__decorate([w.property()],f.prototype,"canSignInArcGIS",void 0);e.__decorate([w.property()],f.prototype,"canSignInIDP",void 0);e.__decorate([w.property()],f.prototype,"colorSetsGroupQuery",void 0);e.__decorate([w.property()],f.prototype,"commentsEnabled",void 0);e.__decorate([w.property({type:Date})],
f.prototype,"created",void 0);e.__decorate([w.property()],f.prototype,"credential",void 0);e.__decorate([w.property()],f.prototype,"culture",void 0);e.__decorate([w.property()],f.prototype,"currentVersion",void 0);e.__decorate([w.property()],f.prototype,"customBaseUrl",void 0);e.__decorate([w.property()],f.prototype,"defaultBasemap",void 0);e.__decorate([q.reader("defaultBasemap")],f.prototype,"readDefaultBasemap",null);e.__decorate([w.property()],f.prototype,"defaultDevBasemap",void 0);e.__decorate([q.reader("defaultDevBasemap")],
f.prototype,"readDefaultDevBasemap",null);e.__decorate([w.property({type:r})],f.prototype,"defaultExtent",void 0);e.__decorate([w.property()],f.prototype,"defaultVectorBasemap",void 0);e.__decorate([q.reader("defaultVectorBasemap")],f.prototype,"readDefaultVectorBasemap",null);e.__decorate([w.property()],f.prototype,"description",void 0);e.__decorate([w.property()],f.prototype,"devBasemapGalleryGroupQuery",void 0);e.__decorate([w.property()],f.prototype,"eueiEnabled",void 0);e.__decorate([w.property({readOnly:!0})],
f.prototype,"extraQuery",null);e.__decorate([w.property()],f.prototype,"featuredGroups",void 0);e.__decorate([w.property()],f.prototype,"featuredItemsGroupQuery",void 0);e.__decorate([w.property()],f.prototype,"galleryTemplatesGroupQuery",void 0);e.__decorate([w.property()],f.prototype,"livingAtlasGroupQuery",void 0);e.__decorate([w.property()],f.prototype,"hasCategorySchema",void 0);e.__decorate([w.property()],f.prototype,"helpBase",void 0);e.__decorate([w.property()],f.prototype,"helperServices",
void 0);e.__decorate([w.property()],f.prototype,"helpMap",void 0);e.__decorate([w.property()],f.prototype,"homePageFeaturedContent",void 0);e.__decorate([w.property()],f.prototype,"homePageFeaturedContentCount",void 0);e.__decorate([w.property()],f.prototype,"httpPort",void 0);e.__decorate([w.property()],f.prototype,"httpsPort",void 0);e.__decorate([w.property()],f.prototype,"id",void 0);e.__decorate([w.property()],f.prototype,"ipCntryCode",void 0);e.__decorate([w.property({readOnly:!0})],f.prototype,
"isOrganization",null);e.__decorate([w.property()],f.prototype,"isPortal",void 0);e.__decorate([w.property()],f.prototype,"isReadOnly",void 0);e.__decorate([w.property({readOnly:!0})],f.prototype,"itemPageUrl",null);e.__decorate([w.property()],f.prototype,"layerTemplatesGroupQuery",void 0);e.__decorate([w.property()],f.prototype,"maxTokenExpirationMinutes",void 0);e.__decorate([w.property({type:Date})],f.prototype,"modified",void 0);e.__decorate([w.property()],f.prototype,"name",void 0);e.__decorate([w.property()],
f.prototype,"portalHostname",void 0);e.__decorate([w.property()],f.prototype,"portalMode",void 0);e.__decorate([w.property()],f.prototype,"portalProperties",void 0);e.__decorate([w.property()],f.prototype,"region",void 0);e.__decorate([w.property({readOnly:!0})],f.prototype,"restUrl",null);e.__decorate([w.property()],f.prototype,"rotatorPanels",void 0);e.__decorate([w.property()],f.prototype,"showHomePageDescription",void 0);e.__decorate([w.property()],f.prototype,"sourceJSON",void 0);e.__decorate([w.property()],
f.prototype,"staticImagesUrl",void 0);e.__decorate([w.property({json:{name:"2DStylesGroupQuery"}})],f.prototype,"stylesGroupQuery2d",void 0);e.__decorate([w.property({json:{name:"stylesGroupQuery"}})],f.prototype,"stylesGroupQuery3d",void 0);e.__decorate([w.property()],f.prototype,"supportsHostedServices",void 0);e.__decorate([w.property()],f.prototype,"symbolSetsGroupQuery",void 0);e.__decorate([w.property()],f.prototype,"templatesGroupQuery",void 0);e.__decorate([w.property()],f.prototype,"thumbnail",
void 0);e.__decorate([w.property({readOnly:!0})],f.prototype,"thumbnailUrl",null);e.__decorate([w.property()],f.prototype,"units",void 0);e.__decorate([w.property()],f.prototype,"url",void 0);e.__decorate([w.property()],f.prototype,"urlKey",void 0);e.__decorate([q.reader("urlKey")],f.prototype,"readUrlKey",null);e.__decorate([w.property()],f.prototype,"user",void 0);e.__decorate([q.reader("user")],f.prototype,"readUser",null);e.__decorate([w.property()],f.prototype,"use3dBasemaps",void 0);e.__decorate([w.property()],
f.prototype,"useStandardizedQuery",void 0);e.__decorate([w.property()],f.prototype,"useVectorBasemaps",void 0);e.__decorate([w.property()],f.prototype,"vectorBasemapGalleryGroupQuery",void 0);e=f=T=e.__decorate([a.subclass("esri.portal.Portal")],f);const m=new FinalizationRegistry(u=>{u.remove()});return e})},"esri/portal/portalDefault":function(){define(["exports"],function(d){let e;d.clearDefaultPortalInstance=function(){e=void 0};d.ensureDefaultPortalInstance=function(B){if(!e||e.destroyed)e=B();
return e};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),function(d,e,B,z,M,n,f,v,g){var p;B=p=class extends B.JSONSupport{constructor(w){super(w);this.id=this.description=this.created=this.access=null;
this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const w=this.url,I=this.thumbnail;return w&&I&&this.portal?this.portal?.normalizeUrl(`${w}/info/${I}?f=json`):null}get url(){const w=this.portal?.restUrl;return w?w+"/community/groups/"+this.id:null}fetchCategorySchema(w){return this.portal.request(this.url+"/categorySchema",w).then(I=>{I=I.categorySchema||[];return I.some(E=>"contentCategorySetsGroupQuery.LivingAtlas"===
E.source)?this._fetchCategorySchemaSet("LivingAtlas",w):I})}fetchMembers(w){return this.portal.request(this.url+"/users",w)}getThumbnailUrl(w){let I=this.thumbnailUrl;I&&w&&(I+=`&w=${w}`);return I}toJSON(){throw new e("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(w){if(!w)return null;if(w.declaredClass)throw Error("JSON object is already hydrated");const I=new p;I.sourceJSON=w;I.read(w);return I}queryItems(w,I){w=M.ensureType(g,w);const E=this.portal;
if(5<parseFloat(E.currentVersion))return w=w||new g,E.queryPortal(`/content/groups/${this.id}/search`,w,"PortalItem",I);w=w?w.clone():new g;w.query="group:"+this.id+(w.query?" "+w.query:"");return E.queryItems(w,I)}_fetchCategorySchemaSet(w,I){const E=this.portal;return E.fetchSelf(E.authMode,!0,I).then(t=>{if(t=t.contentCategorySetsGroupQuery){const q=new g;q.disableExtraQuery=!0;q.num=1;q.query=t;return E.queryGroups(q,I)}throw new e("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");
}).then(t=>{if(t.total){t=t.results[0];const q=new g;q.num=1;q.query=`typekeywords:"${w}"`;return t.queryItems(q,I)}throw new e("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(t=>t.total?t.results[0].fetchData("json",I).then(q=>{q=q?.categorySchema;return q?.length?q:[]}):[])}};d.__decorate([z.property()],B.prototype,"access",void 0);d.__decorate([z.property({type:Date})],B.prototype,"created",void 0);d.__decorate([z.property()],B.prototype,"description",
void 0);d.__decorate([z.property()],B.prototype,"id",void 0);d.__decorate([z.property()],B.prototype,"isInvitationOnly",void 0);d.__decorate([z.property({type:Date})],B.prototype,"modified",void 0);d.__decorate([z.property()],B.prototype,"owner",void 0);d.__decorate([z.property()],B.prototype,"portal",void 0);d.__decorate([z.property()],B.prototype,"snippet",void 0);d.__decorate([z.property()],B.prototype,"sortField",void 0);d.__decorate([z.property()],B.prototype,"sortOrder",void 0);d.__decorate([z.property()],
B.prototype,"sourceJSON",void 0);d.__decorate([z.property()],B.prototype,"tags",void 0);d.__decorate([z.property()],B.prototype,"thumbnail",void 0);d.__decorate([z.property({readOnly:!0})],B.prototype,"thumbnailUrl",null);d.__decorate([z.property()],B.prototype,"title",void 0);d.__decorate([z.property({readOnly:!0})],B.prototype,"url",null);return B=p=d.__decorate([v.subclass("esri.portal.PortalGroup")],B)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(d,e,B,z,M,n,f,v,g,p){var w;const I=new B.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});e=w=class extends e{constructor(E){super(E);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(E){"asc"!==E&&"desc"!==E||this._set("sortOrder",E)}clone(){return new w({categories:this.categories?z.clone(this.categories):
null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(E,t){let q=[];this.categories&&(q=this.categories.map(y=>Array.isArray(y)?JSON.stringify(y):y));let a="";if(this.extent){var r=p.project(this.extent,g.WGS84);null!=r&&(a=`${r.xmin},${r.ymin},${r.xmax},${r.ymax}`)}r=this.query;!this.disableExtraQuery&&E.extraQuery&&(r="("+r+")"+
E.extraQuery);E={categories:q,bbox:a,q:r,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(E.sortField=this.sortField.split(",").map(y=>I.toJSON(y.trim())).join(","),E.sortOrder=this.sortOrder);return{query:{...t,...E}}}};d.__decorate([M.property()],e.prototype,"categories",void 0);d.__decorate([M.property()],e.prototype,"disableExtraQuery",void 0);d.__decorate([M.property({type:v})],e.prototype,"extent",void 0);d.__decorate([M.property()],e.prototype,
"filter",void 0);d.__decorate([M.property()],e.prototype,"num",void 0);d.__decorate([M.property()],e.prototype,"query",void 0);d.__decorate([M.property()],e.prototype,"sortField",void 0);d.__decorate([M.property()],e.prototype,"sortOrder",null);d.__decorate([M.property()],e.prototype,"start",void 0);return e=w=d.__decorate([f.subclass("esri.portal.PortalQueryParams")],e)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(d,e,B,z,M,n,f){e=class extends e{constructor(v){super(v);this.total=this.results=this.queryParams=this.nextQueryParams=null}};d.__decorate([B.property()],e.prototype,"nextQueryParams",void 0);d.__decorate([B.property()],e.prototype,"queryParams",void 0);d.__decorate([B.property()],e.prototype,"results",void 0);d.__decorate([B.property()],e.prototype,"total",void 0);return e=d.__decorate([f.subclass("esri.portal.PortalQueryResult")],e)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w){var I;z=I=class extends z.JSONSupport{constructor(...E){super(...E);this.userType=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const E=this.url,t=this.thumbnail;return E&&t?this.portal.normalizeUrl(`${E}/info/${t}?f=json`):null}get userContentUrl(){const E=this.portal?.restUrl;
return E?`${E}/content/users/${this.username}`:null}get url(){const E=this.portal?.restUrl;return E?`${E}/community/users/${this.username}`:null}addItem(E){const t=E&&E.item;var q=E?.data;E=E?.folder;const a={method:"post"};t&&(a.query=t.createPostQuery(),null!=q&&("string"===typeof q?a.query.text=q:"object"===typeof q&&(a.query.text=JSON.stringify(q))));q=this.userContentUrl;E&&(q+="/"+("string"===typeof E?E:E.id));return this.portal.request(q+"/addItem",a).then(r=>{t.id=r.id;t.portal=this.portal;
return t.loaded?t.reload():t.load()})}deleteItem(E){let t=this.userContentUrl;E.ownerFolder&&(t+="/"+E.ownerFolder);return this.portal.request(t+`/items/${E.id}/delete`,{method:"post"}).then(()=>{E.id=null;E.portal=null})}deleteItems(E){const t=this.userContentUrl+"/deleteItems";var q=E.map(a=>a.id);return q.length?(q={method:"post",query:{items:q.join(",")}},this.portal.request(t,q).then(()=>{E.forEach(a=>{a.id=null;a.portal=null})})):Promise.resolve(void 0)}fetchFolders(){return this.portal.request(this.userContentUrl??
"",{query:{num:1}}).then(E=>E&&E.folders?E.folders.map(t=>{t=p.fromJSON(t);t.portal=this.portal;return t}):[])}fetchGroups(){return this.portal.request(this.url??"").then(E=>E&&E.groups?E.groups.map(t=>{t=w.fromJSON(t);t.portal=this.portal;return t}):[])}fetchItems(E){const t=E??{};let q=this.userContentUrl??"";t.folder&&(q+="/"+t.folder.id);let a;return(new Promise((r,y)=>d(["./PortalItem"],F=>r(Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}))),
y))).then(({default:r})=>{a=r;return this.portal.request(q,{query:{folders:!1,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"}})}).then(r=>{let y;return r?.items?(y=r.items.map(F=>{F=a.fromJSON(F);F.portal=this.portal;return F}),Promise.all(y.map(F=>F.load())).catch(F=>F).then(()=>({items:y,nextStart:r.nextStart,total:r.total}))):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal.request(this.url+"/tags").then(E=>E.tags)}getThumbnailUrl(E){let t=
this.thumbnailUrl;t&&E&&(t+=`&w=${E}`);return t}queryFavorites(E){return this.favGroupId?(this._favGroup||(this._favGroup=new w({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(E)):Promise.reject(new B("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new B("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(E){if(!E)return null;if(E.declaredClass)throw Error("JSON object is already hydrated");
const t=new I;t.sourceJSON=E;t.read(E);return t}};e.__decorate([M.property()],z.prototype,"access",void 0);e.__decorate([M.property({type:Date})],z.prototype,"created",void 0);e.__decorate([M.property()],z.prototype,"culture",void 0);e.__decorate([M.property()],z.prototype,"description",void 0);e.__decorate([M.property()],z.prototype,"email",void 0);e.__decorate([M.property()],z.prototype,"favGroupId",void 0);e.__decorate([M.property()],z.prototype,"fullName",void 0);e.__decorate([M.property({type:Date})],
z.prototype,"modified",void 0);e.__decorate([M.property()],z.prototype,"orgId",void 0);e.__decorate([M.property()],z.prototype,"portal",void 0);e.__decorate([M.property()],z.prototype,"preferredView",void 0);e.__decorate([M.property()],z.prototype,"privileges",void 0);e.__decorate([M.property()],z.prototype,"region",void 0);e.__decorate([M.property()],z.prototype,"role",void 0);e.__decorate([M.property()],z.prototype,"roleId",void 0);e.__decorate([M.property()],z.prototype,"sourceJSON",void 0);e.__decorate([M.property()],
z.prototype,"thumbnail",void 0);e.__decorate([M.property({readOnly:!0})],z.prototype,"thumbnailUrl",null);e.__decorate([M.property()],z.prototype,"units",void 0);e.__decorate([M.property({readOnly:!0})],z.prototype,"userContentUrl",null);e.__decorate([M.property({readOnly:!0})],z.prototype,"url",null);e.__decorate([M.property()],z.prototype,"username",void 0);e.__decorate([M.property()],z.prototype,"userType",void 0);return z=I=e.__decorate([g.subclass("esri.portal.PortalUser")],z)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(d,e,B,z,M,n,f,v){B=class extends B.JSONSupport{constructor(g){super(g);this.username=this.title=this.portal=this.id=this.created=null}get url(){const g=this.portal?.restUrl;return g?`${g}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new e("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};d.__decorate([z.property({type:Date})],B.prototype,"created",void 0);d.__decorate([z.property()],B.prototype,"id",void 0);d.__decorate([z.property()],B.prototype,
"portal",void 0);d.__decorate([z.property()],B.prototype,"title",void 0);d.__decorate([z.property({readOnly:!0})],B.prototype,"url",null);d.__decorate([z.property()],B.prototype,"username",void 0);return B=d.__decorate([v.subclass("esri.portal.PortalFolder")],B)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../kernel ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w,I,E,t,q,a,r){var y;const F=new Set("Map Service;Feature Service;Feature Collection;Scene Service;Image Service;Stream Service;Vector Tile Service;GeoJson;CSV;KML;WFS;WMTS;WMS;Feed".split(";")),S=new Set(["KML","GeoJson","CSV"]);n=y=class extends n.JSONSupportMixin(v){static from(b){return w.ensureClass(y,b)}constructor(b){super(b);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.categories=this.avgRating=this.applicationProxies=
this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const b=this.type,A=this.typeKeywords||[];let R=b;"Feature Service"===b||"Feature Collection"===
b?R=A.includes("Table")?"Table":A.includes("Route Layer")?"Route Layer":A.includes("Markup")?"Markup":"Feature Layer":"Image Service"===b?R=A.includes("Elevation 3D Layer")?"Elevation Layer":A.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===b?R="Scene Layer":"Video Service"===b?R="Video Layer":"Scene Package"===b?R="Scene Layer Package":"Stream Service"===b?R="Feature Layer":"Geoprocessing Service"===b?R=A.includes("Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===
b?R="Locator":"Geoenrichment Service"===b?R="GeoEnrichment Service":"Microsoft Powerpoint"===b?R="Microsoft PowerPoint":"GeoJson"===b?R="GeoJSON":"Globe Service"===b?R="Globe Layer":"Vector Tile Service"===b?R="Tile Layer":"netCDF"===b?R="NetCDF":"Map Service"===b?R=A.includes("Spatiotemporal")||!A.includes("Hosted Service")&&!A.includes("Tiled")||A.includes("Relational")?"Map Image Layer":"Tile Layer":b&&b.toLowerCase().includes("add in")?R=b.replaceAll(/(add in)/gi,"Add-In"):"datastore catalog service"===
b?R="Big Data File Share":"Compact Tile Package"===b?R="Tile Package (tpkx)":"OGCFeatureServer"===b?R="OGC Feature Layer":"web mapping application"===b&&A.includes("configurableApp")?R="Instant App":"Insights Page"===b?R="Insights Report":"Excalibur Imagery Project"===b&&(R="Excalibur Project");return R}readExtent(b){return b&&b.length?new t(b[0][0],b[0][1],b[1][0],b[1][1]):null}get iconUrl(){var b=this.type?.toLowerCase()||"";const A=this.typeKeywords||[];var R=!1;let H=!1,Q=!1,N=!1,T=!1,l=!1;R=
!1;0<b.indexOf("service")||"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b?(R=A.includes("Hosted Service"),"feature service"===b||"feature collection"===b||"kml"===b||"wfs"===b?(H=A.includes("Table"),Q=A.includes("Route Layer"),N=A.includes("Markup"),T=A.includes("Spatiotemporal"),l=A.includes("UtilityNetwork"),b=T&&H?"spatiotemporaltable":H?"table":Q?"routelayer":N?"markup":T?"spatiotemporal":R?"featureshosted":l?"utilitynetwork":"features"):b="map service"===b||"wms"===b||
"wmts"===b?R||A.includes("Tiled")||"wmts"===b?"maptiles":"mapimages":"scene service"===b?A.includes("Line")?"sceneweblayerline":A.includes("3DObject")?"sceneweblayermultipatch":A.includes("Point")?"sceneweblayerpoint":A.includes("IntegratedMesh")?"sceneweblayermesh":A.includes("PointCloud")?"sceneweblayerpointcloud":A.includes("Polygon")?"sceneweblayerpolygon":A.includes("Building")?"sceneweblayerbuilding":A.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===b?A.includes("Elevation 3D Layer")?
"elevationlayer":A.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===b?"streamlayer":"video service"===b?A.includes("Live Stream")?"livestreamvideolayer":"videolayer":"vector tile service"===b?"vectortile":"datastore catalog service"===b?"datastorecollection":"geocoding service"===b?"geocodeservice":"geoprocessing service"===b?A.includes("Web Tool")?"tool":"layers":"geodata service"===b?"geodataservice":"3dtiles service"===b?"3dtileslayer":"layers"):b="web map"===b||"cityengine web scene"===
b?"maps":"web scene"===b?A.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===b&&A.includes("configurableApp")?"instantapps":"web mapping application"===b||"mobile application"===b||"application"===b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===b||"published map"===b||"scene document"===b||"globe document"===b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||
"project template"===b||"pro map"===b||"layout"===b||"layer"===b&&A.includes("ArcGIS Pro")||"explorer map"===b&&A.indexOf("Explorer Document")?"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===b||"netcdf"===b||"administrative report"===b?"datafiles":"explorer add in"===b||"desktop add in"===b||"windows viewer add in"===b||"windows viewer configuration"===b?"appsgray":"360 vr experience"===b?"360vr":"arcgis pro add in"===b||"arcgis pro configuration"===
b?"addindesktop":"rule package"===b||"file geodatabase"===b||"sqlite geodatabase"===b||"csv collection"===b||"kml collection"===b||"windows mobile package"===b||"map template"===b||"desktop application template"===b||"gml"===b||"arcpad package"===b||"code sample"===b||"document link"===b||"earth configuration"===b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===b||"explorer map"===b&&A.includes("Explorer Mapping Application")||A.includes("Document")?
"datafilesgray":"network analysis service"===b||"geoprocessing service"===b||"geodata service"===b||"geometry service"===b||"geoprocessing package"===b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===b?"toolsgray":"layer"===b||"layer package"===b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"3dtiles package"===b?"3dtileslayerpackage":"mobile scene package"===b?"mobilescenepackage":"tile package"===b||"compact tile package"===b?"tilepackage":
"task file"===b?"taskfile":"report template"===b?"report-template":"statistical data collection"===b?"statisticaldatacollection":"insights workbook"===b?"workbook":"insights model"===b?"insightsmodel":"insights page"===b?"insightspage":"insights theme"===b?"insightstheme":"hub initiative"===b?"hubinitiative":"hubpage"===b?"hubpage":"hub event"===b?"hubevent":"hub site application"===b?"hubsite":"hub project"===b?"hubproject":"relational database connection"===b?"relationaldatabaseconnection":"big data file share"===
b?"datastorecollection":"image collection"===b?"imagecollection":"style"===b?"style":"desktop style"===b?"desktopstyle":"dashboard"===b?"dashboard":"raster function template"===b?"rasterprocessingtemplate":"vector tile package"===b?"vectortilepackage":"ortho mapping project"===b?"orthomappingproject":"ortho mapping template"===b?"orthomappingtemplate":"solution"===b?"solutions":"geopackage"===b?"geopackage":"deep learning package"===b?"deeplearningpackage":"real time analytic"===b?"realtimeanalytics":
"big data analytic"===b?"bigdataanalytics":"feed"===b?"feed":"excalibur imagery project"===b?"excaliburimageryproject":"notebook"===b?"notebook":"storymap"===b?"storymap":"survey123 add in"===b?"survey123addin":"mission"===b?"mission":"mission report"===b?"missionreport":"mission template"===b?"missiontemplate":"quickcapture project"===b?"quickcaptureproject":"pro report"===b?"proreport":"pro report template"===b?"proreporttemplate":"urban model"===b?"urbanmodel":"web experience"===b?"experiencebuilder":
"web experience template"===b?"webexperiencetemplate":"experience builder widget"===b?"experiencebuilderwidget":"experience builder widget package"===b?"experiencebuilderwidgetpackage":"workflow"===b?"workflow":"insights script"===b?"insightsscript":"kernel gateway connection"===b?"kernelgatewayconnection":"hub initiative template"===b?"hubinitiativetemplate":"storymap theme"===b?"storymaptheme":"knowledge graph"===b?"knowledgegraph":"knowledge studio project"===b?"knowledgestudio":"native application"===
b?"nativeapp":"native application installer"===b?"nativeappinstaller":"link chart"===b?"linkchart":"investigation"===b?"investigation":"ogcfeatureserver"===b?"features":"pro project"===b?"proproject":"insights workbook package"===b?"insightsworkbookpackage":"apache parquet"===b?"apacheparquet":"notebook code snippets"===b||"notebook code snippet library"===b?"notebookcodesnippets":"suitability model"===b?"suitabilitymodel":"esri classifier definition"===b?"classifierdefinition":"esri classification schema"===
b?"classificationschema":"insights data engineering workbook"===b?"dataengineeringworkbook":"insights data engineering model"===b?"dataengineeringmodel":"deep learning studio project"===b?"deeplearningproject":"discussion"===b?"discussion":"allsource project"===b?"allsourceproject":"api key"===b?"apikey":"data pipeline"===b?"datapipelines":"group layer"===b?(R=A.includes("Map"))?"layergroup2d":"layergroup":"media layer"===b?"onlinemedialayer":"form"===b?A.includes("Survey123")?"survey":"datafilesgray":
"maps";return b?B.getAssetUrl("esri/images/portal/"+b+"16.png"):null}get isLayer(){return null!=this.type&&F.has(this.type)}get itemCdnUrl(){let b=this.itemUrl;b&&z.id&&!z.id.findCredential(b)&&(b=z.id._normalizeAGOLorgDomain(b),b=b.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),b=b.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),b=b.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return b}get itemPageUrl(){const b=this.portal?.itemPageUrl;
return b&&this.id?`${b}?id=${this.id}`:null}get itemUrl(){const b=this.portal?.restUrl;return b&&this.id?`${b}/content/items/${this.id}`:null}get thumbnailUrl(){const b=this.itemUrl,A=this.thumbnail;return b&&A?this.portal?.normalizeUrl(`${b}/info/${A}?f=json`)??null:null}get userItemUrl(){const b=this.portal?.restUrl;if(!b)return null;const A=this.owner||this.portal?.user?.username;return A?`${b}/content/users/${this.ownerFolder?`${A}/${this.ownerFolder}`:A}/items/${this.id}`:null}load(b){const A=
this.portal??(this.portal=q.getDefault()),R=A.load(b).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?A.request(this.itemUrl,{signal:null!=b?b.signal:null,query:{token:this.apiKey}}):{}).then(H=>{this.sourceJSON=H;this.read(H)});this.addResolvingPromise(R);return Promise.resolve(this)}async addRating(b){const A={method:"post",query:{}};b instanceof r&&(b=b.rating);null==b||isNaN(b)||"number"!==typeof b||(A.query.rating=b);if(!this.portal)return null;await this.portal.request(this.itemUrl+
"/addRating",A);return new r({rating:b,created:new Date})}clone(){var b={access:this.access,accessInformation:this.accessInformation,applicationProxies:f.clone(this.applicationProxies),avgRating:this.avgRating,categories:f.clone(this.categories),created:f.clone(this.created),culture:this.culture,description:this.description,extent:f.clone(this.extent),groupCategories:f.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:f.clone(this.modified),
name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:f.clone(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:f.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:f.clone(this.typeKeywords),url:this.url};this.loaded&&(b.loadStatus="loaded");b=(new y({sourceJSON:this.sourceJSON})).set(b);
b._set("isOrgItem",this.isOrgItem);return b}createPostQuery(){const b=this.toJSON();for(var A of["tags","typeKeywords","categories"])b[A]=b[A]?.join(", ");({extent:A}=b);A&&(b.extent=JSON.stringify(A));return b}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(b="json",A){return this.portal.request(this.itemUrl+"/data",{responseType:b,...A,query:{token:this.apiKey}})}async fetchRating(b){b=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},
...b});return null!=b.rating?(b.created=new Date(b.created),new r(b)):null}fetchRelatedItems(b,A){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...b,token:this.apiKey},...A},y)}getThumbnailUrl(b){let A=this.thumbnailUrl;A&&b&&(A+=`&w=${b}`);return A}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(b=>{this.sourceJSON=b;this.read(b);return this})}update(b){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>
{const A=b?.data,R={method:"post"};R.query=this.createPostQuery();for(const H in R.query)null===R.query[H]&&(R.query[H]="");R.query.clearEmptyFields=!0;null!=A&&("string"===typeof A?R.query.text=A:"object"===typeof A&&(R.query.text=JSON.stringify(A)));return this.portal.request(`${this.userItemUrl}/update`,R).then(()=>this.reload())}):Promise.reject(new M("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(b){if(!this.id)throw new M("portal:item-does-not-exist",
"The item does not exist yet");await this.load();const {portal:A,itemUrl:R}=this;await A.signIn();const {copyResources:H,folder:Q,tags:N,title:T}=b||{};b={method:"post",query:{copyPrivateResources:"all"===H,folder:"string"===typeof Q?Q:Q?.id,includeResources:!!H,tags:N?.join(","),title:T}};({itemId:b}=await A.request(`${R}/copy`,b));return new y({id:b,portal:A})}updateThumbnail(b){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const A=b.thumbnail,R=b.filename,H={method:"post"};
if("string"===typeof A)g.isDataProtocol(A)?H.query={data:A}:H.query={url:g.makeAbsolute(A)},null!=R&&(H.query.filename=R);else{const Q=new FormData;null!=R?Q.append("file",A,R):Q.append("file",A);H.body=Q}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,H).then(()=>this.reload())}):Promise.reject(new M("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(b={},A){const {fetchResources:R}=await new Promise((H,Q)=>d(["./support/resourceUtils"],
H,Q));return R(this,b,A)}async addResource(b,A,R){const {addOrUpdateResource:H}=await new Promise((Q,N)=>d(["./support/resourceUtils"],Q,N));b.portalItem=this;return H(b,"add",A,R)}async removeResource(b,A){const {removeResource:R}=await new Promise((H,Q)=>d(["./support/resourceUtils"],H,Q));if(b.portalItem&&b.portalItem.itemUrl!==this.itemUrl)throw new M("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return R(this,b,A)}async removeAllResources(b){const {removeAllResources:A}=
await new Promise((R,H)=>d(["./support/resourceUtils"],R,H));return A(this,b)}resourceFromPath(b){return new a({portalItem:this,path:b})}toJSON(){var b=this.extent;b={accessInformation:this.accessInformation,categories:f.clone(this.categories),created:this.created?.getTime(),description:this.description,extent:b&&[[b.xmin,b.ymin],[b.xmax,b.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,
snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:f.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:f.clone(this.typeKeywords),url:this.url};return f.fixJson(b)}static fromJSON(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");return new y({sourceJSON:b})}_getPostQuery(){const b=this.toJSON();for(const A in b)"tags"===A&&null!==b[A]&&(b[A]=b[A].join(", ")),"typeKeywords"===A&&null!==
b[A]&&(b[A]=b[A].join(", ")),"extent"===A&&b[A]&&(b[A]=JSON.stringify(b[A]));return b}};e.__decorate([p.property({type:["private","shared","org","public"]})],n.prototype,"access",void 0);e.__decorate([p.property()],n.prototype,"accessInformation",void 0);e.__decorate([p.property({type:String})],n.prototype,"apiKey",void 0);e.__decorate([p.property({json:{read:{source:"appProxies"}}})],n.prototype,"applicationProxies",void 0);e.__decorate([p.property()],n.prototype,"avgRating",void 0);e.__decorate([p.property()],
n.prototype,"categories",void 0);e.__decorate([p.property({type:Date})],n.prototype,"created",void 0);e.__decorate([p.property()],n.prototype,"culture",void 0);e.__decorate([p.property()],n.prototype,"description",void 0);e.__decorate([p.property({readOnly:!0})],n.prototype,"displayName",null);e.__decorate([p.property({type:t})],n.prototype,"extent",void 0);e.__decorate([I.reader("extent")],n.prototype,"readExtent",null);e.__decorate([p.property()],n.prototype,"groupCategories",void 0);e.__decorate([p.property({readOnly:!0})],
n.prototype,"iconUrl",null);e.__decorate([p.property()],n.prototype,"id",void 0);e.__decorate([p.property({readOnly:!0})],n.prototype,"isLayer",null);e.__decorate([p.property({type:Boolean,readOnly:!0})],n.prototype,"isOrgItem",void 0);e.__decorate([p.property()],n.prototype,"itemControl",void 0);e.__decorate([p.property({readOnly:!0})],n.prototype,"itemPageUrl",null);e.__decorate([p.property({readOnly:!0})],n.prototype,"itemUrl",null);e.__decorate([p.property()],n.prototype,"licenseInfo",void 0);
e.__decorate([p.property({type:Date})],n.prototype,"modified",void 0);e.__decorate([p.property()],n.prototype,"name",void 0);e.__decorate([p.property()],n.prototype,"numComments",void 0);e.__decorate([p.property()],n.prototype,"numRatings",void 0);e.__decorate([p.property()],n.prototype,"numViews",void 0);e.__decorate([p.property()],n.prototype,"owner",void 0);e.__decorate([p.property()],n.prototype,"ownerFolder",void 0);e.__decorate([p.property({type:q})],n.prototype,"portal",void 0);e.__decorate([p.property()],
n.prototype,"screenshots",void 0);e.__decorate([p.property()],n.prototype,"size",void 0);e.__decorate([p.property()],n.prototype,"snippet",void 0);e.__decorate([p.property()],n.prototype,"sourceJSON",void 0);e.__decorate([p.property({type:String})],n.prototype,"sourceUrl",void 0);e.__decorate([p.property({type:String})],n.prototype,"spatialReference",void 0);e.__decorate([p.property()],n.prototype,"tags",void 0);e.__decorate([p.property()],n.prototype,"thumbnail",void 0);e.__decorate([p.property({readOnly:!0})],
n.prototype,"thumbnailUrl",null);e.__decorate([p.property()],n.prototype,"title",void 0);e.__decorate([p.property()],n.prototype,"type",void 0);e.__decorate([p.property()],n.prototype,"typeKeywords",void 0);e.__decorate([p.property({type:String,json:{read(b,A){S.has(A.type)&&(A=this.portal?.restUrl,b||(b=A&&this.id?`${A}/content/items/${this.id}/data`:null));return b}}})],n.prototype,"url",void 0);e.__decorate([p.property({readOnly:!0})],n.prototype,"userItemUrl",null);return n=y=e.__decorate([E.subclass("esri.portal.PortalItem")],
n)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),function(d,e,B,z,M,n,f,v,g,p,w){B=class extends B{constructor(I){super(I);this.portalItem=null}normalizeCtorArgs(I){return I?.portalItem&&I.path?{...I,path:this._normalizePath(I.path,
I.portalItem)}:I}set path(I){null!=I&&n.isAbsolute(I)?M.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",I)}_castPath(I){return this._normalizePath(I,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?
`./resources/${this.path}`:null}fetch(I="json",E){const t=this.cdnUrl;if(null==t)throw new z("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(t,{responseType:I,query:{token:this.portalItem.apiKey},signal:E?.signal})}async update(I,E){const {addOrUpdateResource:t}=await new Promise((q,a)=>d(["./support/resourceUtils"],q,a));return t(this,"update",I,E)}hasPath(){return null!=this.path}_normalizePath(I,E){if(null==I)return I;
I=I.replace(/^\/+/,"");null!=E&&n.isAbsolute(I)&&(I=n.makeRelative(I,E.itemUrl));return I?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}};e.__decorate([f.property()],B.prototype,"portalItem",void 0);e.__decorate([f.property({type:String,value:null})],B.prototype,"path",null);e.__decorate([v.cast("path")],B.prototype,"_castPath",null);e.__decorate([f.property({type:String,readOnly:!0})],B.prototype,"url",null);e.__decorate([f.property({type:String,readOnly:!0})],B.prototype,"cdnUrl",null);
e.__decorate([f.property({type:String,readOnly:!0})],B.prototype,"itemRelativeUrl",null);return B=e.__decorate([w.subclass("esri.portal.PortalItemResource")],B)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),function(d,e,B,z,M,n,f){e=class extends e{constructor(v){super(v);this.rating=this.created=
null}};d.__decorate([B.property()],e.prototype,"created",void 0);d.__decorate([B.property()],e.prototype,"rating",void 0);return e=d.__decorate([f.subclass("esri.portal.PortalRating")],e)})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(d,e,B){d.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",
styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],
id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,
opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",
layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,
opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",
title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},
"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",
layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",
is3d:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",
layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},
"arcgis-imagery-standard":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",
isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/dark-gray.jpg")},
title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",
baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",
baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",
title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",
title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",
title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,
title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};d.getBasemapTitle=async function(z){if(z){var M=z.includes("-vector")?z.slice(0,z.indexOf("-vector")):
z.includes("-3d")?z.slice(0,z.indexOf("-3d")):z,n=await B.fetchMessageBundle("esri/t9n/basemaps");return n[z]||n[M]}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(d,e,B,z,M,n,f,v){const g=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
e=class extends e{constructor(p){super(p);this.language=this.id=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps"}getLanguageParamValue(){if(this.language)return this.language;var p=v.getLocale().toLowerCase();switch(p){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}p=v.getLanguage(p);return"pt"===p?"pt-BR":p&&g.has(p)?p:"global"}};d.__decorate([B.property()],e.prototype,
"id",void 0);d.__decorate([B.property()],e.prototype,"language",void 0);d.__decorate([B.property()],e.prototype,"serviceUrl",void 0);return e=d.__decorate([f.subclass("esri.support.BasemapStyle")],e)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),function(d,e,B,z,M,n){function f(p,w){"maxScale"in p&&(w.maxScale=M.numberToJSON(p.maxScale)??
void 0);"minScale"in p&&(w.minScale=M.numberToJSON(p.minScale)??void 0)}const v=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),g=new Set("csv feature geo-rss geojson group imagery imagery-tile kml map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));d.disableRestrictedWriting=function(p){v.add(p);g.add(p)};d.enableRestrictedWriting=
function(p){v.delete(p);g.delete(p)};d.getLayerJSON=function(p,w,I){if(!p.persistenceEnabled)return null;if(!("write"in p&&p.write))return I?.messages&&I.messages.push(new e("layer:unsupported",`Layers (${p.title}, ${p.id}) of type '${p.declaredClass}' cannot be persisted`,{layer:p})),null;if(n.isFeatureCollectionLayer(p)&&!p.isTable)w=p.resourceInfo;else{if(I.restrictedWebMapWriting){var E="basemap"===I.layerContainerType?v:"operational-layers"===I.layerContainerType?g:null;E=null!=E?E.has(p.type)&&
!n.isFeatureCollectionLayer(p):!0}else E=!0;if(E)return w={},p.write(w,I)?w:null}if(null!=w){w=B.clone(w);if(I=w)n.isFeatureCollectionLayer(p)?(E=z.getDeepValue("featureCollection.layers",I)?.[0]?.layerDefinition)&&f(p,E):"group"!==p.type&&f(p,I);if(I&&(I.id=p.id,"blendMode"in p&&(I.blendMode=p.blendMode,"normal"===I.blendMode&&delete I.blendMode),I.opacity=M.numberToJSON(p.opacity)??void 0,I.title=p.title||"Layer",I.visibility=p.visible,"legendEnabled"in p&&"wmts"!==p.type))if(n.isFeatureCollectionLayer(p)){if(I=
I.featureCollection)I.showLegend=p.legendEnabled}else I.showLegend=p.legendEnabled}return w};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(d,e,B){function z(n){return"scene"===n?.type}function M(n){n=n?.type;return"imagery-tile"===n||"tile"===n||"open-street-map"===n||"vector-tile"===n||"web-tile"===n||"wmts"===n}d.getEffectiveEditingEnabled=function(n){a:if("editingEnabled"in n)switch(n.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var f=
!0;break a;default:f=!1}else f=!1;return f?"effectiveEditingEnabled"in n?n.effectiveEditingEnabled:n.editingEnabled:!1};d.getEffectiveLayerCapabilities=function(n){a:if("capabilities"in n)switch(n.type){case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":case "wfs":var f=!0;break a;default:f=!1}else f=!1;return f?"effectiveCapabilities"in n?n.effectiveCapabilities:
n.capabilities:null};d.getOwningPortalUrl=async function(n,f){var v=e.id?.findServerInfo(n);if(null!=v?.currentVersion)return v.owningSystemUrl||null;v=n.toLowerCase().indexOf("/rest/services");if(-1===v)return null;n=`${n.substring(0,v)}/rest/info`;({data:f}=await B(n,{query:{f:"json"},responseType:"json",signal:null!=f?f.signal:null}));return f?.owningSystemUrl||null};d.getTileMaxtrixSetFromActiveLayer=function(n){if(n.activeLayer){const f=n.activeLayer.tileMatrixSet;if(f)return f;if(n=n.activeLayer.tileMatrixSets)return n}return null};
d.isBaseLayer=function(n){return null!=n?.parent&&"declaredClass"in n.parent&&"esri.Basemap"===n.parent.declaredClass&&n.parent.baseLayers.includes(n)};d.isBasemap3DSupportedLayer=function(n){return M(n)||z(n)};d.isBasemapSupportedTiledLayer=M;d.isFeatureCollectionLayer=function(n){return"feature"===n?.type&&!n.url&&"memory"===n.source?.type};d.isFeatureLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"feature"===n.type};d.isFeatureServiceLayer=function(n){return"feature"===n?.type&&
"feature-layer"===n.source?.type};d.isGraphicsLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"graphics"===n.type};d.isGroupLayer=function(n){return null!=n&&"type"in n&&"group"===n.type};d.isImageryTileLayer=function(n){return"imagery-tile"===n?.type};d.isKnowledgeGraphLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"knowledge-graph"===n.type&&"layers"in n};d.isLayerWithFeatureLayerSource=function(n){return("feature"===n?.type||"subtype-group"===n?.type)&&"feature-layer"===
n.source?.type};d.isMapNotesLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"map-notes"===n.type&&"sublayers"in n};d.isSceneLayer=z;d.isSceneServiceLayer=function(n){n=n?.type;return"building-scene"===n||"integrated-mesh"===n||"point-cloud"===n||"scene"===n};d.isSubtypeGroupLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"subtype-group"===n.type&&"sublayers"in n};d.isTable=function(n){return null!=n&&"object"===typeof n&&"isTable"in n&&!!n.isTable};d.isTiledLayer=
function(n){n=n?.type;return"base-tile"===n||"tile"===n||"elevation"===n||"imagery-tile"===n||"base-elevation"===n||"open-street-map"===n||"wcs"===n||"web-tile"===n||"wmts"===n||"vector-tile"===n};d.isVoxelLayer=function(n){return"voxel"===n?.type};d.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};d.serializeLayerDefinitions=function(n){const f=/[:;]/,v=[];let g=!1;if(n&&(n.forEach((p,
w)=>{v.push([w,p]);!g&&f.test(p)&&(g=!0)}),0<v.length)){if(g){const p={};v.forEach(w=>{p[w[0]]=w[1]});n=JSON.stringify(p)}else{const p=[];v.forEach(w=>{p.push(w[0]+":"+w[1])});n=p.join(";")}return n}return null};d.serializeTimeOptions=function(n){if(n){var f=[];n.forEach((v,g)=>{f.push('"'+g+'":'+JSON.stringify(v))});if(f.length)return"{"+f.join(",")+"}"}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(d,
e){d.canInterpolateEffects=function(B,z){const M=B.length>z.length?B:z;return(B.length>z.length?z:B).every((n,f)=>n.type===M[f].type)};d.effectEquals=function(B,z){B=JSON.stringify(B??null);z=JSON.stringify(z??null);return B===z};d.isEffectFunctions=function(B){return(B=B[0])?"type"in B:!1};d.normalizeEffects=function(B,z){const M=B.length>z.length?B:z;B=B.length>z.length?z:B;for(z=B.length;z<M.length;z++)B.push(e.createEffectWithInitialValues(M[z]))};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../chunks/mat4f32","./colorMatrixFunctions"],function(d,e,B,z,M){function n(t,q,a){return t+(q-t)*a}function f(t){return Math.round(1E3*B.px2pt(t))/1E3}class v{constructor(t,q,a){this.strength=t;this.radius=q;this.threshold=a;this.type="bloom"}interpolate(t,q,a){this.strength=n(t.strength,q.strength,a);this.radius=n(t.radius,q.radius,a);this.threshold=n(t.threshold,q.threshold,a)}clone(){return new v(this.strength,
this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:f(this.radius),strength:this.strength,threshold:this.threshold}}}class g{constructor(t){this.radius=t;this.type="blur"}interpolate(t,q,a){this.radius=Math.round(n(t.radius,q.radius,a))}clone(){return new g(this.radius)}toJSON(){return{type:"blur",radius:f(this.radius)}}}class p{constructor(t,q){this.type=t;this.amount=q;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||
this._updateMatrix();return this._colorMatrix}interpolate(t,q,a){this.amount=n(t.amount,q.amount,a);this._updateMatrix()}clone(){return new p(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||z.create();switch(this.type){case "brightness":this._colorMatrix=M.brightness(t,this.amount);break;case "contrast":this._colorMatrix=M.contrast(t,this.amount);break;case "grayscale":this._colorMatrix=M.grayscale(t,this.amount);break;case "invert":this._colorMatrix=
M.invert(t,this.amount);break;case "saturate":this._colorMatrix=M.saturate(t,this.amount);break;case "sepia":this._colorMatrix=M.sepia(t,this.amount)}}}class w{constructor(t,q,a,r){this.offsetX=t;this.offsetY=q;this.blurRadius=a;this.color=r;this.type="drop-shadow"}interpolate(t,q,a){this.offsetX=n(t.offsetX,q.offsetX,a);this.offsetY=n(t.offsetY,q.offsetY,a);this.blurRadius=n(t.blurRadius,q.blurRadius,a);this.color[0]=Math.round(n(t.color[0],q.color[0],a));this.color[1]=Math.round(n(t.color[1],q.color[1],
a));this.color[2]=Math.round(n(t.color[2],q.color[2],a));this.color[3]=n(t.color[3],q.color[3],a)}clone(){return new w(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];t[3]*=255;return{type:"drop-shadow",xoffset:f(this.offsetX),yoffset:f(this.offsetY),blurRadius:f(this.blurRadius),color:t}}}class I{constructor(t){this.angle=t;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(t,q,a){this.angle=
n(t.angle,q.angle,a);this._updateMatrix()}clone(){return new I(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||z.create();this._colorMatrix=M.rotateHue(t,this.angle)}}class E{constructor(t){this.amount=t;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(t,q,a){this.amount=n(t.amount,q.amount,a)}clone(){return new E(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}d.BloomEffect=v;d.BlurEffect=g;d.ColorMatrixEffect=
p;d.DropShadowEffect=w;d.HueRotateEffect=I;d.OpacityEffect=E;d.createEffectWithInitialValues=function(t){switch(t.type){case "grayscale":case "sepia":case "invert":return new p(t.type,0);case "saturate":case "brightness":case "contrast":return new p(t.type,1);case "opacity":return new E(1);case "hue-rotate":return new I(0);case "blur":return new g(0);case "drop-shadow":return new w(0,0,0,[...e.getNamedColor("transparent")]);case "bloom":return new v(0,0,1)}};Object.defineProperty(d,Symbol.toStringTag,
{value:"Module"})})},"esri/chunks/mat4f32":function(){define(["exports"],function(d){function e(){const v=new Float32Array(16);v[0]=1;v[5]=1;v[10]=1;v[15]=1;return v}function B(v){const g=new Float32Array(16);g[0]=v[0];g[1]=v[1];g[2]=v[2];g[3]=v[3];g[4]=v[4];g[5]=v[5];g[6]=v[6];g[7]=v[7];g[8]=v[8];g[9]=v[9];g[10]=v[10];g[11]=v[11];g[12]=v[12];g[13]=v[13];g[14]=v[14];g[15]=v[15];return g}function z(v,g,p,w,I,E,t,q,a,r,y,F,S,b,A,R){const H=new Float32Array(16);H[0]=v;H[1]=g;H[2]=p;H[3]=w;H[4]=I;H[5]=
E;H[6]=t;H[7]=q;H[8]=a;H[9]=r;H[10]=y;H[11]=F;H[12]=S;H[13]=b;H[14]=A;H[15]=R;return H}function M(v,g){return new Float32Array(v,g,16)}const n=e(),f=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:n,clone:B,create:e,createView:M,fromValues:z},Symbol.toStringTag,{value:"Module"}));d.IDENTITY=n;d.clone=B;d.create=e;d.createView=M;d.fromValues=z;d.mat4f32=f})},"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../chunks/mat4"],function(d,e){d.brightness=(B,z)=>{B=
e.set(B,z,0,0,0,0,z,0,0,0,0,z,0,0,0,0,1);return e.transpose(B,B)};d.contrast=(B,z)=>{B=e.set(B,z,0,0,.5-.5*z,0,z,0,.5-.5*z,0,0,z,.5-.5*z,0,0,0,1);return e.transpose(B,B)};d.grayscale=(B,z)=>{z=1-z;B=e.set(B,.2126+.7874*z,.7152-.7152*z,.0722-.0722*z,0,.2126-.2126*z,.7152+.2848*z,.0722-.0722*z,0,.2126-.2126*z,.7152-.7152*z,.0722+.9278*z,0,0,0,0,1);return e.transpose(B,B)};d.invert=(B,z)=>{const M=1-2*z;B=e.set(B,M,0,0,z,0,M,0,z,0,0,M,z,0,0,0,1);return e.transpose(B,B)};d.rotateHue=(B,z)=>{const M=Math.sin(z*
Math.PI/180);z=Math.cos(z*Math.PI/180);B=e.set(B,.213+.787*z-.213*M,.715-.715*z-.715*M,.072-.072*z+.928*M,0,.213-.213*z+.143*M,.715+.285*z+.14*M,.072-.072*z-.283*M,0,.213-.213*z-.787*M,.715-.715*z+.715*M,.072+.928*z+.072*M,0,0,0,0,1);return e.transpose(B,B)};d.saturate=(B,z)=>{B=e.set(B,.213+.787*z,.715-.715*z,.072-.072*z,0,.213-.213*z,.715+.285*z,.072-.072*z,0,.213-.213*z,.715-.715*z,.072+.928*z,0,0,0,0,1);return e.transpose(B,B)};d.sepia=(B,z)=>{z=1-z;B=e.set(B,.393+.607*z,.769-.769*z,.189-.189*
z,0,.349-.349*z,.686+.314*z,.168-.168*z,0,.272-.272*z,.534-.534*z,.131+.869*z,0,0,0,0,1);return e.transpose(B,B)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(d,e,B){function z(h,D){h[0]=D[0];h[1]=D[1];h[2]=D[2];h[3]=D[3];h[4]=D[4];h[5]=D[5];h[6]=D[6];h[7]=D[7];h[8]=D[8];h[9]=D[9];h[10]=D[10];h[11]=D[11];h[12]=D[12];h[13]=D[13];h[14]=D[14];h[15]=D[15];return h}function M(h,D,X,aa,ha,x,G,K,W,Z,ba,da,
ia,ka,ra,oa,qa){h[0]=D;h[1]=X;h[2]=aa;h[3]=ha;h[4]=x;h[5]=G;h[6]=K;h[7]=W;h[8]=Z;h[9]=ba;h[10]=da;h[11]=ia;h[12]=ka;h[13]=ra;h[14]=oa;h[15]=qa;return h}function n(h){h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function f(h,D){if(h===D){const X=D[1],aa=D[2],ha=D[3],x=D[6],G=D[7],K=D[11];h[1]=D[4];h[2]=D[8];h[3]=D[12];h[4]=X;h[6]=D[9];h[7]=D[13];h[8]=aa;h[9]=x;h[11]=D[14];h[12]=ha;h[13]=G;h[14]=K}else h[0]=D[0],h[1]=
D[4],h[2]=D[8],h[3]=D[12],h[4]=D[1],h[5]=D[5],h[6]=D[9],h[7]=D[13],h[8]=D[2],h[9]=D[6],h[10]=D[10],h[11]=D[14],h[12]=D[3],h[13]=D[7],h[14]=D[11],h[15]=D[15];return h}function v(h,D){g(h,D)||n(h);return h}function g(h,D){const X=D[0],aa=D[1],ha=D[2],x=D[3],G=D[4],K=D[5],W=D[6],Z=D[7],ba=D[8],da=D[9],ia=D[10],ka=D[11],ra=D[12],oa=D[13],qa=D[14];D=D[15];const Ca=X*K-aa*G,wa=X*W-ha*G,Ba=X*Z-x*G,Aa=aa*W-ha*K,ya=aa*Z-x*K,Ha=ha*Z-x*W,Qa=ba*oa-da*ra,Ya=ba*qa-ia*ra,Wa=ba*D-ka*ra,Ja=da*qa-ia*oa,Ka=da*D-ka*
oa,ja=ia*D-ka*qa;let Ra=Ca*ja-wa*Ka+Ba*Ja+Aa*Wa-ya*Ya+Ha*Qa;if(!Ra)return null;Ra=1/Ra;h[0]=(K*ja-W*Ka+Z*Ja)*Ra;h[1]=(ha*Ka-aa*ja-x*Ja)*Ra;h[2]=(oa*Ha-qa*ya+D*Aa)*Ra;h[3]=(ia*ya-da*Ha-ka*Aa)*Ra;h[4]=(W*Wa-G*ja-Z*Ya)*Ra;h[5]=(X*ja-ha*Wa+x*Ya)*Ra;h[6]=(qa*Ba-ra*Ha-D*wa)*Ra;h[7]=(ba*Ha-ia*Ba+ka*wa)*Ra;h[8]=(G*Ka-K*Wa+Z*Qa)*Ra;h[9]=(aa*Wa-X*Ka-x*Qa)*Ra;h[10]=(ra*ya-oa*Ba+D*Ca)*Ra;h[11]=(da*Ba-ba*ya-ka*Ca)*Ra;h[12]=(K*Ya-G*Ja-W*Qa)*Ra;h[13]=(X*Ja-aa*Ya+ha*Qa)*Ra;h[14]=(oa*wa-ra*Aa-qa*Ca)*Ra;h[15]=(ba*
Aa-da*wa+ia*Ca)*Ra;return h}function p(h,D){const X=D[0],aa=D[1],ha=D[2],x=D[3],G=D[4],K=D[5],W=D[6],Z=D[7],ba=D[8],da=D[9],ia=D[10],ka=D[11],ra=D[12],oa=D[13],qa=D[14];D=D[15];h[0]=K*(ia*D-ka*qa)-da*(W*D-Z*qa)+oa*(W*ka-Z*ia);h[1]=-(aa*(ia*D-ka*qa)-da*(ha*D-x*qa)+oa*(ha*ka-x*ia));h[2]=aa*(W*D-Z*qa)-K*(ha*D-x*qa)+oa*(ha*Z-x*W);h[3]=-(aa*(W*ka-Z*ia)-K*(ha*ka-x*ia)+da*(ha*Z-x*W));h[4]=-(G*(ia*D-ka*qa)-ba*(W*D-Z*qa)+ra*(W*ka-Z*ia));h[5]=X*(ia*D-ka*qa)-ba*(ha*D-x*qa)+ra*(ha*ka-x*ia);h[6]=-(X*(W*D-Z*qa)-
G*(ha*D-x*qa)+ra*(ha*Z-x*W));h[7]=X*(W*ka-Z*ia)-G*(ha*ka-x*ia)+ba*(ha*Z-x*W);h[8]=G*(da*D-ka*oa)-ba*(K*D-Z*oa)+ra*(K*ka-Z*da);h[9]=-(X*(da*D-ka*oa)-ba*(aa*D-x*oa)+ra*(aa*ka-x*da));h[10]=X*(K*D-Z*oa)-G*(aa*D-x*oa)+ra*(aa*Z-x*K);h[11]=-(X*(K*ka-Z*da)-G*(aa*ka-x*da)+ba*(aa*Z-x*K));h[12]=-(G*(da*qa-ia*oa)-ba*(K*qa-W*oa)+ra*(K*ia-W*da));h[13]=X*(da*qa-ia*oa)-ba*(aa*qa-ha*oa)+ra*(aa*ia-ha*da);h[14]=-(X*(K*qa-W*oa)-G*(aa*qa-ha*oa)+ra*(aa*W-ha*K));h[15]=X*(K*ia-W*da)-G*(aa*ia-ha*da)+ba*(aa*W-ha*K);return h}
function w(h){const D=h[0],X=h[1],aa=h[2],ha=h[3],x=h[4],G=h[5],K=h[6],W=h[7],Z=h[8],ba=h[9],da=h[10],ia=h[11],ka=h[12],ra=h[13],oa=h[14];h=h[15];return(D*G-X*x)*(da*h-ia*oa)-(D*K-aa*x)*(ba*h-ia*ra)+(D*W-ha*x)*(ba*oa-da*ra)+(X*K-aa*G)*(Z*h-ia*ka)-(X*W-ha*G)*(Z*oa-da*ka)+(aa*W-ha*K)*(Z*ra-ba*ka)}function I(h,D,X){const aa=D[0],ha=D[1],x=D[2],G=D[3],K=D[4],W=D[5],Z=D[6],ba=D[7],da=D[8],ia=D[9],ka=D[10],ra=D[11],oa=D[12],qa=D[13],Ca=D[14];D=D[15];let wa=X[0],Ba=X[1],Aa=X[2],ya=X[3];h[0]=wa*aa+Ba*K+Aa*
da+ya*oa;h[1]=wa*ha+Ba*W+Aa*ia+ya*qa;h[2]=wa*x+Ba*Z+Aa*ka+ya*Ca;h[3]=wa*G+Ba*ba+Aa*ra+ya*D;wa=X[4];Ba=X[5];Aa=X[6];ya=X[7];h[4]=wa*aa+Ba*K+Aa*da+ya*oa;h[5]=wa*ha+Ba*W+Aa*ia+ya*qa;h[6]=wa*x+Ba*Z+Aa*ka+ya*Ca;h[7]=wa*G+Ba*ba+Aa*ra+ya*D;wa=X[8];Ba=X[9];Aa=X[10];ya=X[11];h[8]=wa*aa+Ba*K+Aa*da+ya*oa;h[9]=wa*ha+Ba*W+Aa*ia+ya*qa;h[10]=wa*x+Ba*Z+Aa*ka+ya*Ca;h[11]=wa*G+Ba*ba+Aa*ra+ya*D;wa=X[12];Ba=X[13];Aa=X[14];ya=X[15];h[12]=wa*aa+Ba*K+Aa*da+ya*oa;h[13]=wa*ha+Ba*W+Aa*ia+ya*qa;h[14]=wa*x+Ba*Z+Aa*ka+ya*Ca;
h[15]=wa*G+Ba*ba+Aa*ra+ya*D;return h}function E(h,D,X){const aa=X[0],ha=X[1];X=X[2];if(D===h)h[12]=D[0]*aa+D[4]*ha+D[8]*X+D[12],h[13]=D[1]*aa+D[5]*ha+D[9]*X+D[13],h[14]=D[2]*aa+D[6]*ha+D[10]*X+D[14],h[15]=D[3]*aa+D[7]*ha+D[11]*X+D[15];else{const x=D[0],G=D[1],K=D[2],W=D[3],Z=D[4],ba=D[5],da=D[6],ia=D[7],ka=D[8],ra=D[9],oa=D[10],qa=D[11];h[0]=x;h[1]=G;h[2]=K;h[3]=W;h[4]=Z;h[5]=ba;h[6]=da;h[7]=ia;h[8]=ka;h[9]=ra;h[10]=oa;h[11]=qa;h[12]=x*aa+Z*ha+ka*X+D[12];h[13]=G*aa+ba*ha+ra*X+D[13];h[14]=K*aa+da*
ha+oa*X+D[14];h[15]=W*aa+ia*ha+qa*X+D[15]}return h}function t(h,D,X){const aa=X[0],ha=X[1];X=X[2];h[0]=D[0]*aa;h[1]=D[1]*aa;h[2]=D[2]*aa;h[3]=D[3]*aa;h[4]=D[4]*ha;h[5]=D[5]*ha;h[6]=D[6]*ha;h[7]=D[7]*ha;h[8]=D[8]*X;h[9]=D[9]*X;h[10]=D[10]*X;h[11]=D[11]*X;h[12]=D[12];h[13]=D[13];h[14]=D[14];h[15]=D[15];return h}function q(h,D,X,aa){let ha=aa[0],x=aa[1];aa=aa[2];let G=Math.sqrt(ha*ha+x*x+aa*aa);var K=void 0,W=void 0;let Z=void 0,ba=void 0,da=void 0,ia=void 0,ka=void 0,ra=void 0,oa=void 0,qa=void 0,Ca=
void 0,wa=void 0,Ba=void 0,Aa=void 0,ya=void 0,Ha=void 0,Qa=void 0,Ya=void 0,Wa=void 0,Ja=void 0,Ka=void 0,ja=void 0;W=K=void 0;if(G<B.getEpsilon())return null;G=1/G;ha*=G;x*=G;aa*=G;K=Math.sin(X);W=Math.cos(X);Z=1-W;ba=D[0];da=D[1];ia=D[2];ka=D[3];ra=D[4];oa=D[5];qa=D[6];Ca=D[7];wa=D[8];Ba=D[9];Aa=D[10];ya=D[11];Ha=ha*ha*Z+W;Qa=x*ha*Z+aa*K;Ya=aa*ha*Z-x*K;Wa=ha*x*Z-aa*K;Ja=x*x*Z+W;Ka=aa*x*Z+ha*K;ja=ha*aa*Z+x*K;K=x*aa*Z-ha*K;W=aa*aa*Z+W;h[0]=ba*Ha+ra*Qa+wa*Ya;h[1]=da*Ha+oa*Qa+Ba*Ya;h[2]=ia*Ha+qa*Qa+
Aa*Ya;h[3]=ka*Ha+Ca*Qa+ya*Ya;h[4]=ba*Wa+ra*Ja+wa*Ka;h[5]=da*Wa+oa*Ja+Ba*Ka;h[6]=ia*Wa+qa*Ja+Aa*Ka;h[7]=ka*Wa+Ca*Ja+ya*Ka;h[8]=ba*ja+ra*K+wa*W;h[9]=da*ja+oa*K+Ba*W;h[10]=ia*ja+qa*K+Aa*W;h[11]=ka*ja+Ca*K+ya*W;D!==h&&(h[12]=D[12],h[13]=D[13],h[14]=D[14],h[15]=D[15]);return h}function a(h,D,X){const aa=Math.sin(X);X=Math.cos(X);const ha=D[4],x=D[5],G=D[6],K=D[7],W=D[8],Z=D[9],ba=D[10],da=D[11];D!==h&&(h[0]=D[0],h[1]=D[1],h[2]=D[2],h[3]=D[3],h[12]=D[12],h[13]=D[13],h[14]=D[14],h[15]=D[15]);h[4]=ha*X+W*
aa;h[5]=x*X+Z*aa;h[6]=G*X+ba*aa;h[7]=K*X+da*aa;h[8]=W*X-ha*aa;h[9]=Z*X-x*aa;h[10]=ba*X-G*aa;h[11]=da*X-K*aa;return h}function r(h,D,X){const aa=Math.sin(X);X=Math.cos(X);const ha=D[0],x=D[1],G=D[2],K=D[3],W=D[8],Z=D[9],ba=D[10],da=D[11];D!==h&&(h[4]=D[4],h[5]=D[5],h[6]=D[6],h[7]=D[7],h[12]=D[12],h[13]=D[13],h[14]=D[14],h[15]=D[15]);h[0]=ha*X-W*aa;h[1]=x*X-Z*aa;h[2]=G*X-ba*aa;h[3]=K*X-da*aa;h[8]=ha*aa+W*X;h[9]=x*aa+Z*X;h[10]=G*aa+ba*X;h[11]=K*aa+da*X;return h}function y(h,D,X){const aa=Math.sin(X);
X=Math.cos(X);const ha=D[0],x=D[1],G=D[2],K=D[3],W=D[4],Z=D[5],ba=D[6],da=D[7];D!==h&&(h[8]=D[8],h[9]=D[9],h[10]=D[10],h[11]=D[11],h[12]=D[12],h[13]=D[13],h[14]=D[14],h[15]=D[15]);h[0]=ha*X+W*aa;h[1]=x*X+Z*aa;h[2]=G*X+ba*aa;h[3]=K*X+da*aa;h[4]=W*X-ha*aa;h[5]=Z*X-x*aa;h[6]=ba*X-G*aa;h[7]=da*X-K*aa;return h}function F(h,D){h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=D[0];h[13]=D[1];h[14]=D[2];h[15]=1;return h}function S(h,D){h[0]=D[0];h[1]=0;h[2]=0;h[3]=
0;h[4]=0;h[5]=D[1];h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=D[2];h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function b(h,D,X){if(0===D)return n(h);let aa=X[0],ha=X[1];X=X[2];let x=Math.sqrt(aa*aa+ha*ha+X*X),G=void 0,K=void 0,W=void 0;if(x<B.getEpsilon())return null;x=1/x;aa*=x;ha*=x;X*=x;G=Math.sin(D);K=Math.cos(D);W=1-K;h[0]=aa*aa*W+K;h[1]=ha*aa*W+X*G;h[2]=X*aa*W-ha*G;h[3]=0;h[4]=aa*ha*W-X*G;h[5]=ha*ha*W+K;h[6]=X*ha*W+aa*G;h[7]=0;h[8]=aa*X*W+ha*G;h[9]=ha*X*W-aa*G;h[10]=X*X*W+K;h[11]=0;h[12]=0;h[13]=
0;h[14]=0;h[15]=1;return h}function A(h,D){const X=Math.sin(D);D=Math.cos(D);h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=D;h[6]=X;h[7]=0;h[8]=0;h[9]=-X;h[10]=D;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function R(h,D){const X=Math.sin(D);D=Math.cos(D);h[0]=D;h[1]=0;h[2]=-X;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=X;h[9]=0;h[10]=D;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function H(h,D){const X=Math.sin(D);D=Math.cos(D);h[0]=D;h[1]=X;h[2]=0;h[3]=0;h[4]=-X;h[5]=D;h[6]=0;h[7]=0;h[8]=0;h[9]=
0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function Q(h,D,X){var aa=D[0],ha=D[1],x=D[2],G=D[3],K=aa+aa,W=ha+ha;const Z=x+x;D=aa*K;const ba=aa*W;aa*=Z;const da=ha*W;ha*=Z;x*=Z;K*=G;W*=G;G*=Z;h[0]=1-(da+x);h[1]=ba+G;h[2]=aa-W;h[3]=0;h[4]=ba-G;h[5]=1-(D+x);h[6]=ha+K;h[7]=0;h[8]=aa+W;h[9]=ha-K;h[10]=1-(D+da);h[11]=0;h[12]=X[0];h[13]=X[1];h[14]=X[2];h[15]=1;return h}function N(h,D){const X=Va,aa=-D[0],ha=-D[1],x=-D[2],G=D[3],K=D[4],W=D[5],Z=D[6],ba=D[7],da=aa*aa+ha*ha+x*x+G*G;0<da?(X[0]=
2*(K*G+ba*aa+W*x-Z*ha)/da,X[1]=2*(W*G+ba*ha+Z*aa-K*x)/da,X[2]=2*(Z*G+ba*x+K*ha-W*aa)/da):(X[0]=2*(K*G+ba*aa+W*x-Z*ha),X[1]=2*(W*G+ba*ha+Z*aa-K*x),X[2]=2*(Z*G+ba*x+K*ha-W*aa));Q(h,D,X);return h}function T(h,D){h[0]=D[12];h[1]=D[13];h[2]=D[14];return h}function l(h,D){const X=D[0],aa=D[1],ha=D[2],x=D[4],G=D[5],K=D[6],W=D[8],Z=D[9];D=D[10];h[0]=Math.sqrt(X*X+aa*aa+ha*ha);h[1]=Math.sqrt(x*x+G*G+K*K);h[2]=Math.sqrt(W*W+Z*Z+D*D);return h}function O(h,D){const X=D[0]+D[5]+D[10];let aa=0;0<X?(aa=2*Math.sqrt(X+
1),h[3]=.25*aa,h[0]=(D[6]-D[9])/aa,h[1]=(D[8]-D[2])/aa,h[2]=(D[1]-D[4])/aa):D[0]>D[5]&&D[0]>D[10]?(aa=2*Math.sqrt(1+D[0]-D[5]-D[10]),h[3]=(D[6]-D[9])/aa,h[0]=.25*aa,h[1]=(D[1]+D[4])/aa,h[2]=(D[8]+D[2])/aa):D[5]>D[10]?(aa=2*Math.sqrt(1+D[5]-D[0]-D[10]),h[3]=(D[8]-D[2])/aa,h[0]=(D[1]+D[4])/aa,h[1]=.25*aa,h[2]=(D[6]+D[9])/aa):(aa=2*Math.sqrt(1+D[10]-D[0]-D[5]),h[3]=(D[1]-D[4])/aa,h[0]=(D[8]+D[2])/aa,h[1]=(D[6]+D[9])/aa,h[2]=.25*aa);return h}function m(h,D,X,aa){var ha=D[0],x=D[1],G=D[2],K=D[3],W=ha+
ha,Z=x+x,ba=G+G;D=ha*W;const da=ha*Z;ha*=ba;const ia=x*Z;x*=ba;G*=ba;W*=K;Z*=K;K*=ba;ba=aa[0];const ka=aa[1];aa=aa[2];h[0]=(1-(ia+G))*ba;h[1]=(da+K)*ba;h[2]=(ha-Z)*ba;h[3]=0;h[4]=(da-K)*ka;h[5]=(1-(D+G))*ka;h[6]=(x+W)*ka;h[7]=0;h[8]=(ha+Z)*aa;h[9]=(x-W)*aa;h[10]=(1-(D+ia))*aa;h[11]=0;h[12]=X[0];h[13]=X[1];h[14]=X[2];h[15]=1;return h}function u(h,D,X,aa,ha){var x=D[0],G=D[1],K=D[2],W=D[3],Z=x+x,ba=G+G,da=K+K;D=x*Z;var ia=x*ba,ka=x*da;x=G*ba;G*=da;var ra=K*da;K=W*Z;ba*=W;const oa=W*da;var qa=aa[0],
Ca=aa[1];da=aa[2];aa=ha[0];W=ha[1];ha=ha[2];Z=(1-(x+ra))*qa;const wa=(ia+oa)*qa;qa*=ka-ba;ia=(ia-oa)*Ca;ra=(1-(D+ra))*Ca;Ca*=G+K;ka=(ka+ba)*da;G=(G-K)*da;D=(1-(D+x))*da;h[0]=Z;h[1]=wa;h[2]=qa;h[3]=0;h[4]=ia;h[5]=ra;h[6]=Ca;h[7]=0;h[8]=ka;h[9]=G;h[10]=D;h[11]=0;h[12]=X[0]+aa-(Z*aa+ia*W+ka*ha);h[13]=X[1]+W-(wa*aa+ra*W+G*ha);h[14]=X[2]+ha-(qa*aa+Ca*W+D*ha);h[15]=1;return h}function J(h,D){var X=D[0],aa=D[1],ha=D[2];D=D[3];var x=X+X,G=aa+aa;const K=ha+ha;X*=x;const W=aa*x;aa*=G;const Z=ha*x,ba=ha*G;ha*=
K;x*=D;G*=D;D*=K;h[0]=1-aa-ha;h[1]=W+D;h[2]=Z-G;h[3]=0;h[4]=W-D;h[5]=1-X-ha;h[6]=ba+x;h[7]=0;h[8]=Z+G;h[9]=ba-x;h[10]=1-X-aa;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function L(h,D,X,aa,ha,x,G){const K=1/(X-D),W=1/(ha-aa),Z=1/(x-G);h[0]=2*x*K;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*x*W;h[6]=0;h[7]=0;h[8]=(X+D)*K;h[9]=(ha+aa)*W;h[10]=(G+x)*Z;h[11]=-1;h[12]=0;h[13]=0;h[14]=G*x*2*Z;h[15]=0;return h}function U(h,D,X,aa,ha){D=1/Math.tan(D/2);let x=void 0;h[0]=D/X;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=D;
h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[11]=-1;h[12]=0;h[13]=0;h[15]=0;null!=ha&&Infinity!==ha?(x=1/(aa-ha),h[10]=(ha+aa)*x,h[14]=2*ha*aa*x):(h[10]=-1,h[14]=-2*aa);return h}function Y(h,D,X,aa){const ha=Math.tan(D.upDegrees*Math.PI/180),x=Math.tan(D.downDegrees*Math.PI/180),G=Math.tan(D.leftDegrees*Math.PI/180);D=Math.tan(D.rightDegrees*Math.PI/180);const K=2/(G+D),W=2/(ha+x);h[0]=K;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=W;h[6]=0;h[7]=0;h[8]=-((G-D)*K*.5);h[9]=(ha-x)*W*.5;h[10]=aa/(X-aa);h[11]=-1;h[12]=0;h[13]=0;
h[14]=aa*X/(X-aa);h[15]=0;return h}function ea(h,D,X,aa,ha,x,G){const K=1/(D-X),W=1/(aa-ha),Z=1/(x-G);h[0]=-2*K;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=-2*W;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*Z;h[11]=0;h[12]=(D+X)*K;h[13]=(ha+aa)*W;h[14]=(G+x)*Z;h[15]=1;return h}function la(h,D,X,aa){const ha=D[0],x=D[1];D=D[2];let G=ha-X[0],K=x-X[1];X=D-X[2];var W=B.getEpsilon();if(Math.abs(G)<W&&Math.abs(K)<W&&Math.abs(X)<W)n(h);else{var Z=1/Math.sqrt(G*G+K*K+X*X);G*=Z;K*=Z;X*=Z;Z=aa[0];var ba=aa[1];W=aa[2];aa=ba*X-W*
K;W=W*G-Z*X;ba=Z*K-ba*G;(Z=Math.sqrt(aa*aa+W*W+ba*ba))?(Z=1/Z,aa*=Z,W*=Z,ba*=Z):ba=W=aa=0;var da=K*ba-X*W,ia=X*aa-G*ba,ka=G*W-K*aa;(Z=Math.sqrt(da*da+ia*ia+ka*ka))?(Z=1/Z,da*=Z,ia*=Z,ka*=Z):ka=ia=da=0;h[0]=aa;h[1]=da;h[2]=G;h[3]=0;h[4]=W;h[5]=ia;h[6]=K;h[7]=0;h[8]=ba;h[9]=ka;h[10]=X;h[11]=0;h[12]=-(aa*ha+W*x+ba*D);h[13]=-(da*ha+ia*x+ka*D);h[14]=-(G*ha+K*x+X*D);h[15]=1}}function na(h,D,X,aa){const ha=D[0],x=D[1];D=D[2];var G=aa[0];const K=aa[1];var W=aa[2];aa=ha-X[0];let Z=x-X[1];X=D-X[2];let ba=aa*
aa+Z*Z+X*X;0<ba&&(ba=1/Math.sqrt(ba),aa*=ba,Z*=ba,X*=ba);let da=K*X-W*Z;W=W*aa-G*X;G=G*Z-K*aa;ba=da*da+W*W+G*G;0<ba&&(ba=1/Math.sqrt(ba),da*=ba,W*=ba,G*=ba);h[0]=da;h[1]=W;h[2]=G;h[3]=0;h[4]=Z*G-X*W;h[5]=X*da-aa*G;h[6]=aa*W-Z*da;h[7]=0;h[8]=aa;h[9]=Z;h[10]=X;h[11]=0;h[12]=ha;h[13]=x;h[14]=D;h[15]=1;return h}function ta(h){return"mat4("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+", "+h[9]+", "+h[10]+", "+h[11]+", "+h[12]+", "+h[13]+", "+h[14]+", "+h[15]+")"}
function ua(h){return Math.sqrt(h[0]**2+h[1]**2+h[2]**2+h[3]**2+h[4]**2+h[5]**2+h[6]**2+h[7]**2+h[8]**2+h[9]**2+h[10]**2+h[11]**2+h[12]**2+h[13]**2+h[14]**2+h[15]**2)}function sa(h,D,X){h[0]=D[0]+X[0];h[1]=D[1]+X[1];h[2]=D[2]+X[2];h[3]=D[3]+X[3];h[4]=D[4]+X[4];h[5]=D[5]+X[5];h[6]=D[6]+X[6];h[7]=D[7]+X[7];h[8]=D[8]+X[8];h[9]=D[9]+X[9];h[10]=D[10]+X[10];h[11]=D[11]+X[11];h[12]=D[12]+X[12];h[13]=D[13]+X[13];h[14]=D[14]+X[14];h[15]=D[15]+X[15];return h}function va(h,D,X){h[0]=D[0]-X[0];h[1]=D[1]-X[1];
h[2]=D[2]-X[2];h[3]=D[3]-X[3];h[4]=D[4]-X[4];h[5]=D[5]-X[5];h[6]=D[6]-X[6];h[7]=D[7]-X[7];h[8]=D[8]-X[8];h[9]=D[9]-X[9];h[10]=D[10]-X[10];h[11]=D[11]-X[11];h[12]=D[12]-X[12];h[13]=D[13]-X[13];h[14]=D[14]-X[14];h[15]=D[15]-X[15];return h}function xa(h,D,X){h[0]=D[0]*X;h[1]=D[1]*X;h[2]=D[2]*X;h[3]=D[3]*X;h[4]=D[4]*X;h[5]=D[5]*X;h[6]=D[6]*X;h[7]=D[7]*X;h[8]=D[8]*X;h[9]=D[9]*X;h[10]=D[10]*X;h[11]=D[11]*X;h[12]=D[12]*X;h[13]=D[13]*X;h[14]=D[14]*X;h[15]=D[15]*X;return h}function Da(h,D,X,aa){h[0]=D[0]+
X[0]*aa;h[1]=D[1]+X[1]*aa;h[2]=D[2]+X[2]*aa;h[3]=D[3]+X[3]*aa;h[4]=D[4]+X[4]*aa;h[5]=D[5]+X[5]*aa;h[6]=D[6]+X[6]*aa;h[7]=D[7]+X[7]*aa;h[8]=D[8]+X[8]*aa;h[9]=D[9]+X[9]*aa;h[10]=D[10]+X[10]*aa;h[11]=D[11]+X[11]*aa;h[12]=D[12]+X[12]*aa;h[13]=D[13]+X[13]*aa;h[14]=D[14]+X[14]*aa;h[15]=D[15]+X[15]*aa;return h}function Ia(h,D){return h[0]===D[0]&&h[1]===D[1]&&h[2]===D[2]&&h[3]===D[3]&&h[4]===D[4]&&h[5]===D[5]&&h[6]===D[6]&&h[7]===D[7]&&h[8]===D[8]&&h[9]===D[9]&&h[10]===D[10]&&h[11]===D[11]&&h[12]===D[12]&&
h[13]===D[13]&&h[14]===D[14]&&h[15]===D[15]}function Pa(h,D){if(h===D)return!0;const X=h[0],aa=h[1],ha=h[2],x=h[3],G=h[4],K=h[5],W=h[6],Z=h[7],ba=h[8],da=h[9],ia=h[10],ka=h[11],ra=h[12],oa=h[13],qa=h[14];h=h[15];const Ca=D[0],wa=D[1],Ba=D[2],Aa=D[3],ya=D[4],Ha=D[5],Qa=D[6],Ya=D[7],Wa=D[8],Ja=D[9],Ka=D[10],ja=D[11],Ra=D[12],Nb=D[13],nb=D[14];D=D[15];const c=B.getEpsilon();return Math.abs(X-Ca)<=c*Math.max(1,Math.abs(X),Math.abs(Ca))&&Math.abs(aa-wa)<=c*Math.max(1,Math.abs(aa),Math.abs(wa))&&Math.abs(ha-
Ba)<=c*Math.max(1,Math.abs(ha),Math.abs(Ba))&&Math.abs(x-Aa)<=c*Math.max(1,Math.abs(x),Math.abs(Aa))&&Math.abs(G-ya)<=c*Math.max(1,Math.abs(G),Math.abs(ya))&&Math.abs(K-Ha)<=c*Math.max(1,Math.abs(K),Math.abs(Ha))&&Math.abs(W-Qa)<=c*Math.max(1,Math.abs(W),Math.abs(Qa))&&Math.abs(Z-Ya)<=c*Math.max(1,Math.abs(Z),Math.abs(Ya))&&Math.abs(ba-Wa)<=c*Math.max(1,Math.abs(ba),Math.abs(Wa))&&Math.abs(da-Ja)<=c*Math.max(1,Math.abs(da),Math.abs(Ja))&&Math.abs(ia-Ka)<=c*Math.max(1,Math.abs(ia),Math.abs(Ka))&&Math.abs(ka-
ja)<=c*Math.max(1,Math.abs(ka),Math.abs(ja))&&Math.abs(ra-Ra)<=c*Math.max(1,Math.abs(ra),Math.abs(Ra))&&Math.abs(oa-Nb)<=c*Math.max(1,Math.abs(oa),Math.abs(Nb))&&Math.abs(qa-nb)<=c*Math.max(1,Math.abs(qa),Math.abs(nb))&&Math.abs(h-D)<=c*Math.max(1,Math.abs(h),Math.abs(D))}function Na(h){const D=B.getEpsilon(),X=h[0],aa=h[1],ha=h[2],x=h[4],G=h[5],K=h[6],W=h[8],Z=h[9];h=h[10];return Math.abs(1-(X*X+x*x+W*W))<=D&&Math.abs(1-(aa*aa+G*G+Z*Z))<=D&&Math.abs(1-(ha*ha+K*K+h*h))<=D}function Sa(h){return 1===
h[0]&&0===h[1]&&0===h[2]&&0===h[4]&&1===h[5]&&0===h[6]&&0===h[8]&&0===h[9]&&1===h[10]}const Va=e.create();e=Object.freeze(Object.defineProperty({__proto__:null,add:sa,adjoint:p,copy:z,determinant:w,equals:Pa,exactEquals:Ia,frob:ua,fromQuat:J,fromQuat2:N,fromRotation:b,fromRotationTranslation:Q,fromRotationTranslationScale:m,fromRotationTranslationScaleOrigin:u,fromScaling:S,fromTranslation:F,fromXRotation:A,fromYRotation:R,fromZRotation:H,frustum:L,getRotation:O,getScaling:l,getTranslation:T,hasIdentityRotation:Sa,
identity:n,invert:g,invertOrIdentity:v,isOrthoNormal:Na,lookAt:la,mul:I,multiply:I,multiplyScalar:xa,multiplyScalarAndAdd:Da,ortho:ea,perspective:U,perspectiveFromFieldOfView:Y,rotate:q,rotateX:a,rotateY:r,rotateZ:y,scale:t,set:M,str:ta,sub:va,subtract:va,targetTo:na,translate:E,transpose:f},Symbol.toStringTag,{value:"Module"}));d.add=sa;d.adjoint=p;d.copy=z;d.determinant=w;d.equals=Pa;d.exactEquals=Ia;d.frob=ua;d.fromQuat=J;d.fromQuat2=N;d.fromRotation=b;d.fromRotationTranslation=Q;d.fromRotationTranslationScale=
m;d.fromRotationTranslationScaleOrigin=u;d.fromScaling=S;d.fromTranslation=F;d.fromXRotation=A;d.fromYRotation=R;d.fromZRotation=H;d.frustum=L;d.getRotation=O;d.getScaling=l;d.getTranslation=T;d.hasIdentityRotation=Sa;d.identity=n;d.invert=g;d.invertOrIdentity=v;d.isOrthoNormal=Na;d.lookAt=la;d.mat4=e;d.mul=I;d.multiply=I;d.multiplyScalar=xa;d.multiplyScalarAndAdd=Da;d.ortho=ea;d.perspective=U;d.perspectiveFromFieldOfView=Y;d.rotate=q;d.rotateX=a;d.rotateY=r;d.rotateZ=y;d.scale=t;d.set=M;d.str=ta;
d.sub=va;d.subtract=va;d.targetTo=na;d.translate=E;d.transpose=f})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(d,e,B){function z(m){return null==m||"string"===typeof m&&!m?"\x3cNull\x3e":m}function M(m){const u=null!=m.minValue||null!=m.maxValue,J=!!m.sqlExpression&&m.supportsSQLExpression;return!(null!=m.normalizationField||null!=m.normalizationType)&&!u&&!J}function n(m){const {values:u,useSampleStdDev:J,
supportsNullCount:L}=m;var U=Number.POSITIVE_INFINITY;let Y=Number.NEGATIVE_INFINITY,ea=null,la=null;var na=null;let ta=null,ua=0;const sa=null==m.minValue?-Infinity:m.minValue,va=null==m.maxValue?Infinity:m.maxValue;for(const xa of u)Number.isFinite(xa)?xa>=sa&&xa<=va&&(ea=null===ea?xa:ea+xa,U=Math.min(U,xa),Y=Math.max(Y,xa),ua++):"string"===typeof xa&&ua++;if(ua&&null!=ea){la=ea/ua;na=0;for(const xa of u)Number.isFinite(xa)&&xa>=sa&&xa<=va&&(na+=(xa-la)**2);ta=J?1<ua?na/(ua-1):0:0<ua?na/ua:0;na=
Math.sqrt(ta)}else Y=U=null;U={avg:la,count:ua,max:Y,min:U,stddev:na,sum:ea,variance:ta};L&&(U.nullcount=u.length-ua);m.percentileParams&&(U.median=f(u,m.percentileParams));return U}function f(m,u){const {fieldType:J,value:L,orderBy:U,isDiscrete:Y}=u,ea=v(J,"desc"===U);m=[...m].filter(ua=>null!=ua).sort((ua,sa)=>ea(ua,sa));if(0===m.length)return null;if(0>=L)return m[0];if(1<=L)return m[m.length-1];var la=(m.length-1)*L,na=Math.floor(la);u=na+1;la%=1;na=m[na];const ta=m[u];return u>=m.length||Y||
"string"===typeof na||"string"===typeof ta?na:na*(1-la)+ta*la}function v(m,u){if(m){if(F.has(m))return u?l:O;if(S.has(m))return g(u,!1);if("esriFieldTypeTimestampOffset"===m)return u?Q:H;const Y=g(u,!0);if("esriFieldTypeString"===m)return Y;if("esriFieldTypeGUID"===m||"esriFieldTypeGlobalID"===m)return(ea,la)=>Y(p(ea),p(la))}const J=u?1:-1,L=u?l:O,U=g(u,!0);return(Y,ea)=>"number"===typeof Y&&"number"===typeof ea?L(Y,ea):"string"===typeof Y&&"string"===typeof ea?U(Y,ea):J}function g(m,u){if(!u)return m?
T:N;const J=m?A:R;return m?(L,U)=>{const Y=J(L,U);if(null!=Y)return Y;L=L.toUpperCase();U=U.toUpperCase();return L>U?-1:L<U?1:0}:(L,U)=>{const Y=J(L,U);if(null!=Y)return Y;L=L.toUpperCase();U=U.toUpperCase();return L<U?-1:L>U?1:0}}function p(m){return m.substr(24,12)+m.substr(19,4)+m.substr(16,2)+m.substr(14,2)+m.substr(11,2)+m.substr(9,2)+m.substr(6,2)+m.substr(4,2)+m.substr(2,2)+m.substr(0,2)}function w(m){return"coded-value"!==m?.type?[]:m.codedValues.map(u=>u.code)}function I(m,u){const J=t({field:u.field,
normalizationType:u.normalizationType,normalizationField:u.normalizationField,classificationMethod:u.classificationMethod,standardDeviationInterval:u.standardDeviationInterval,breakCount:u.numClasses||5});m=E(m,u.minValue,u.maxValue);return B.createGenerateRendererClassBreaks({definition:J,values:m,normalizationTotal:u.normalizationTotal})}function E(m,u,J){const L=null==u?-Infinity:u,U=null==J?Infinity:J;return m.filter(Y=>Number.isFinite(Y)&&Y>=L&&Y<=U)}function t(m){const {breakCount:u,field:J,
normalizationField:L,normalizationType:U}=m,Y=m.classificationMethod||"equal-interval";return new e({breakCount:u,classificationField:J,classificationMethod:Y,normalizationField:"field"===U?L:void 0,normalizationType:U,standardDeviationInterval:"standard-deviation"===Y?m.standardDeviationInterval||1:void 0})}function q(m,u){const {field:J,classificationMethod:L,standardDeviationInterval:U,normalizationType:Y,normalizationField:ea,normalizationTotal:la,minValue:na,maxValue:ta}=u,ua=u.numBins||10;let sa=
u=null,va=null;L&&"equal-interval"!==L||Y?({classBreaks:m}=I(m,{field:J,normalizationType:Y,normalizationField:ea,normalizationTotal:la,classificationMethod:L,standardDeviationInterval:U,minValue:na,maxValue:ta,numClasses:ua}),u=m[0].minValue,sa=m[m.length-1].maxValue,va=m.map(xa=>[xa.minValue,xa.maxValue])):(null!=na&&null!=ta?(u=na,sa=ta):(m=n({values:m,minValue:na,maxValue:ta,useSampleStdDev:!Y,supportsNullCount:M({normalizationType:Y,normalizationField:ea,minValue:na,maxValue:ta})}),u=m.min??
null,sa=m.max??null),va=r(u??0,sa??0,ua));return{min:u,max:sa,intervals:va}}function a(m,u){let J=-1;for(let L=m.length-1;0<=L;L--)if(u>=m[L][0]){J=L;break}return J}function r(m,u,J){const L=(u-m)/J,U=[];let Y;for(let ea=1;ea<=J;ea++)Y=m+L,Y=Number(Y.toFixed(16)),U.push([m,ea===J?u:Y]),m=Y;return U}const y=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,F=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),
S=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),b="min max avg stddev count sum variance nullcount median".split(" "),A=(m,u)=>null==m?null==u?0:1:null==u?-1:null,R=(m,u)=>null==m?null==u?0:-1:null==u?1:null,H=(m,u)=>R(m,u)??(m===u?0:(new Date(m)).getTime()-(new Date(u)).getTime()),Q=(m,u)=>A(m,u)??(m===u?0:(new Date(u)).getTime()-(new Date(m)).getTime()),N=(m,u)=>R(m,u)??(m===u?0:m<u?-1:1),T=(m,u)=>A(m,u)??(m===u?0:m<u?1:-1),l=(m,u)=>A(m,u)??u-m,O=(m,u)=>R(m,u)??m-u;d.calculateClassBreaks=
I;d.calculateHistogram=function(m,u){var J=q(m,u);if(null==J.min&&null==J.max)return{bins:[],minValue:J.min,maxValue:J.max,normalizationTotal:u.normalizationTotal};const L=J.intervals,U=J.min??0;J=J.max??0;const Y=L.map((ea,la)=>({minValue:L[la][0],maxValue:L[la][1],count:0}));for(const ea of m)null!=ea&&ea>=U&&ea<=J&&(m=a(L,ea),-1<m&&Y[m].count++);return{bins:Y,minValue:U,maxValue:J,normalizationTotal:u.normalizationTotal}};d.calculatePercentile=f;d.calculateStatistics=n;d.calculateStringStatistics=
function(m){const u=m.returnDistinct?[...(new Set(m.values))]:m.values;var J=u.filter(U=>null!=U).sort();const L=J.length;J={count:L,min:J[0],max:J[L-1]};m.supportsNullCount&&(J.nullcount=u.length-L);m.percentileParams&&(J.median=f(u,m.percentileParams));return J};d.calculateUniqueValuesCount=function(m){const u={};for(let J of m){if(null==J||"string"===typeof J&&""===J.trim())J=null;null==u[J]?u[J]={count:1,data:J}:u[J].count++}return{count:u}};d.createClassBreaksDefinition=t;d.createUVResult=function(m,
u,J,L){m=m.count;const U=[];if(J&&u){J=[];var Y=w(u[0]);for(const ea of Y)if(u[1]){Y=w(u[1]);for(const la of Y)if(u[2]){Y=w(u[2]);for(const na of Y)J.push(`${z(ea)}${L}${z(la)}${L}${z(na)}`)}else J.push(`${z(ea)}${L}${z(la)}`)}else J.push(ea);for(const ea of J)m.hasOwnProperty(ea)||(m[ea]={data:ea,count:0})}for(const ea in m)u=m[ea],U.push({value:u.data,count:u.count,label:u.label});return{uniqueValueInfos:U}};d.getAttributeComparator=v;d.getEqualIntervalBins=r;d.getNormalizedValue=function(m,u,J,
L){let U=null;switch(u){case "log":0!==m&&(U=Math.log(m)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(L)&&0!==L&&(U=m/L*100);break;case "field":Number.isFinite(J)&&0!==J&&(U=m/J);break;case "natural-log":0<m&&(U=Math.log(m));break;case "square-root":0<m&&(U=m**.5)}return U};d.isNullCountSupported=M;d.processNullValue=z;d.processSummaryStatisticsResult=function(m,u){let J;for(J in m)b.includes(J)&&(Number.isFinite(m[J])||(m[J]=null));if(!u)return m;["avg","stddev","variance"].forEach(L=>
{null!=m[L]&&(m[L]=Math.ceil(m[L]??0))});return m};d.resolveCBResult=function(m,u){let J=m.classBreaks;const L=J[0]?.minValue,U=J[J.length-1]?.maxValue,Y="standard-deviation"===u;J=J.map(ea=>{const la=ea.label;ea={minValue:ea.minValue,maxValue:ea.maxValue,label:la};if(Y&&la){const na=la.match(y)?.map(ta=>+ta.trim())??[];2===na.length?(ea.minStdDev=na[0],ea.maxStdDev=na[1],0>na[0]&&0<na[1]&&(ea.hasAvg=!0)):1===na.length&&(la.includes("\x3c")?(ea.minStdDev=null,ea.maxStdDev=na[0]):la.includes("\x3e")&&
(ea.minStdDev=na[0],ea.maxStdDev=null))}return ea});return{minValue:L,maxValue:U,classBreakInfos:J,normalizationTotal:m.normalizationTotal}};d.statisticTypes=b;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,e,B,z,M,n,f,v,g){M=new e.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});e=new e.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});B=class extends B.JSONSupport{constructor(p){super(p);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(p){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",p)}set definedInterval(p){"defined-interval"===this.classificationMethod&&this._set("definedInterval",p)}};d.__decorate([v.enumeration({classBreaksDef:"class-breaks-definition"})],B.prototype,"type",void 0);d.__decorate([z.property({json:{write:!0}})],B.prototype,
"breakCount",void 0);d.__decorate([z.property({json:{write:!0}})],B.prototype,"classificationField",void 0);d.__decorate([z.property({type:String,json:{read:M.read,write:M.write}})],B.prototype,"classificationMethod",void 0);d.__decorate([z.property({json:{write:!0}})],B.prototype,"normalizationField",void 0);d.__decorate([z.property({json:{read:e.read,write:e.write}})],B.prototype,"normalizationType",void 0);d.__decorate([z.property({value:null,json:{write:!0}})],B.prototype,"standardDeviationInterval",
null);d.__decorate([z.property({value:null,json:{write:!0}})],B.prototype,"definedInterval",null);return B=d.__decorate([g.subclass("esri.rest.support.ClassBreaksDefinition")],B)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(d,e,B){d.enumeration=function(z,M={}){z=z instanceof e.JSONMap?z:new e.JSONMap(z,M);z={type:M?.ignoreUnknown??!0?z.apiValues:String,json:{type:z.jsonValues,read:M?.readOnly?!1:{reader:z.read},write:{writer:z.write}}};
void 0!==M?.readOnly&&(z.readOnly=!!M.readOnly);void 0!==M?.default&&(z.json.default=M.default);void 0!==M?.name&&(z.json.name=M.name);void 0!==M?.nonNullable&&(z.nonNullable=M.nonNullable);return B.property(z)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(d,e){function B(E){var t=E.definition;const {classificationMethod:q,normalizationType:a,definedInterval:r}=t;t=t.breakCount??
1;const y=[];var F=E.values;if(0===F.length)return[];F=F.sort((Q,N)=>Q-N);var S=F[0],b=F[F.length-1];if("equal-interval"===q)if(F.length>=t){F=(b-S)/t;E=S;for(var A=1;A<t;A++){var R=Number((S+A*F).toFixed(6));y.push({minValue:E,maxValue:R,label:z(E,R,a)});E=R}y.push({minValue:E,maxValue:b,label:z(E,b,a)})}else F.forEach(Q=>{y.push({minValue:Q,maxValue:Q,label:z(Q,Q,a)})});else if("natural-breaks"===q){F=M(F);E=n(F.uniqueValues,E.valueFrequency||F.valueFrequency,t);for(A=1;A<t;A++)F.uniqueValues.length>
A&&(R=Number(F.uniqueValues[E[A]].toFixed(6)),y.push({minValue:S,maxValue:R,label:z(S,R,a)}),S=R);y.push({minValue:S,maxValue:b,label:z(S,b,a)})}else if("quantile"===q)if(F.length>=t&&S!==b){E=Math.ceil(F.length/t);A=0;for(R=1;R<t;R++){var H=E+A-1;H>F.length&&(H=F.length-1);0>H&&(H=0);y.push({minValue:S,maxValue:F[H],label:z(S,F[H],a)});S=F[H];A+=E;E=Math.ceil((F.length-A)/(t-R))}y.push({minValue:S,maxValue:b,label:z(S,b,a)})}else for(t=-1,b=0;b<F.length;b++)S=F[b],S!==t&&(t=S,y.push({minValue:t,
maxValue:S,label:z(t,S,a)}),t=S);else if("standard-deviation"===q)if(E=g(F),A=p(F,E),0===A)y.push({minValue:F[0],maxValue:F[0],label:z(F[0],F[0],a)});else{F=v(S,b,t,E,A)*A;A=0;for(R=t;1<=R;R--)H=Number((E-(R-.5)*F).toFixed(6)),y.push({minValue:S,maxValue:H,label:z(S,H,a)}),S=H,A++;R=Number((E+.5*F).toFixed(6));y.push({minValue:S,maxValue:R,label:z(S,R,a)});S=R;A++;for(H=1;H<=t;H++)R=A===2*t?b:Number((E+(H+.5)*F).toFixed(6)),y.push({minValue:S,maxValue:R,label:z(S,R,a)}),S=R,A++}else if("defined-interval"===
q){if(!r)return y;t=F[0];b=F[F.length-1];F=Math.ceil((b-t)/r);S=t;for(E=1;E<F;E++)A=Number((t+E*r).toFixed(6)),y.push({minValue:S,maxValue:A,label:z(S,A,a)}),S=A;y.push({minValue:S,maxValue:b,label:z(S,b,a)})}return y}function z(E,t,q){let a=null;return a=E===t?q&&"percent-of-total"===q?E+"%":E.toString():q&&"percent-of-total"===q?E+"% - "+t+"%":E+" - "+t}function M(E){const t=[],q=[];let a=Number.MIN_VALUE,r=1,y=-1;for(let F=0;F<E.length;F++){const S=E[F];S===a?(r++,q[y]=r):null!==S&&(t.push(S),
a=S,r=1,q.push(r),y++)}return{uniqueValues:t,valueFrequency:q}}function n(E,t,q){var a=E.length;const r=[];q>a&&(q=a);for(var y=0;y<q;y++)r.push(Math.round(y*a/q-1));r.push(a-1);y=f(r,E,t,q);a=y.mean;y=y.sdcm;var F=q,S=0,b=0;let A=0,R=0,H=!0;for(let N=0;2>N&&H;N++){0===N&&(H=!1);for(var Q=0;Q<F-1;Q++)for(;r[Q+1]+1!==r[Q+2];)if(r[Q+1]+=1,S=w(Q,r,E,t),A=S.sbMean,S=S.sbSdcm,b=w(Q+1,r,E,t),R=b.sbMean,b=b.sbSdcm,S+b<y[Q]+y[Q+1])y[Q]=S,y[Q+1]=b,a[Q]=A,a[Q+1]=R,H=!0;else{--r[Q+1];break}for(Q=F-1;0<Q;Q--)for(;r[Q]!==
r[Q-1]+1;)if(--r[Q],S=w(Q-1,r,E,t),A=S.sbMean,S=S.sbSdcm,b=w(Q,r,E,t),R=b.sbMean,b=b.sbSdcm,S+b<y[Q-1]+y[Q])y[Q-1]=S,y[Q]=b,a[Q-1]=A,a[Q]=R,H=!0;else{r[Q]+=1;break}}H&&(y=f(r,E,t,q));return r}function f(E,t,q,a){let r=[];var y=[],F=[];let S=0;const b=[],A=[];for(var R=0;R<a;R++){var H=w(R,E,t,q);b.push(H.sbMean);A.push(H.sbSdcm);S+=A[R]}H=S;for(R=!0;R||S<H;){R=!1;r=[];for(y=0;y<a;y++)r.push(E[y]);for(F=0;F<a;F++)for(H=E[F]+1;H<=E[F+1];H++)if(y=t[H],0<F&&H!==E[F+1]&&Math.abs(y-b[F])>Math.abs(y-b[F-
1]))E[F]=H;else if(F<a-1&&E[F]!==H-1&&Math.abs(y-b[F])>Math.abs(y-b[F+1])){E[F+1]=H-1;break}H=S;S=0;y=[];F=[];for(let Q=0;Q<a;Q++){y.push(b[Q]);F.push(A[Q]);const N=w(Q,E,t,q);b[Q]=N.sbMean;A[Q]=N.sbSdcm;S+=A[Q]}}if(S>H){for(t=0;t<a;t++)E[t]=r[t],b[t]=y[t],A[t]=F[t];S=H}return{mean:b,sdcm:A}}function v(E,t,q,a,r){E=Math.max(a-E,t-a)/r/q;return 1<=E?1:.5<=E?.5:.25}function g(E){let t=0;for(let q=0;q<E.length;q++)t+=E[q];return t/=E.length}function p(E,t){let q=0;for(let a=0;a<E.length;a++){const r=
E[a];q+=(r-t)*(r-t)}q/=E.length;return Math.sqrt(q)}function w(E,t,q,a){var r=0,y=0;for(var F=t[E]+1;F<=t[E+1];F++){const S=a[F];r+=q[F]*S;y+=S}0>=y&&I.warn("Exception in Natural Breaks calculation");r/=y;y=0;for(F=t[E]+1;F<=t[E+1];F++)y+=a[F]*(q[F]-r)**2;return{sbMean:r,sbSdcm:y}}const I=e.getLogger("esri.rest.support.generateRendererUtils");d.createGenerateRendererClassBreaks=function(E){const {normalizationTotal:t}=E;return{classBreaks:B(E),normalizationTotal:t}};d.createGenerateRendererUniqueValues=
function(E){E=M(E);const t=[],q=E.uniqueValues.length;for(let a=0;a<q;a++){const r=E.uniqueValues[a];t.push({value:r,count:E.valueFrequency[a],label:r.toString()})}return{uniqueValues:t}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(d){d.makeEdgeCandidate=function(e,B,z,M,n,f=!1){return{objectId:e,target:B,distance:z,type:"edge",start:M,end:n,draped:f}};d.makeVertexCandidate=function(e,B,z){return{objectId:e,
target:B,distance:z,type:"vertex"}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(d,e,B,z,M,n,f,v,g,p){async function w(r,y,F){if(!r)return null;
var {where:S}=r;r.where=S=S?.trim();if(!S||/^1 *= *1$/.test(S)||y&&y===S)r.where=null;if(!r.geometry)return r;y=await E(r);r.distance=0;r.units=null;"esriSpatialRelEnvelopeIntersects"===r.spatialRel&&({spatialReference:S}=r.geometry,y=n.getGeometryExtent(y),y.spatialReference=S);if(y){await p.checkProjectionSupport(y.spatialReference,F);S=y.spatialReference;y=I(y,F)&&f.isExtent(y)?{spatialReference:S,rings:[[[y.xmin,y.ymin],[y.xmin,y.ymax],[y.xmax,y.ymax],[y.xmax,y.ymin],[y.xmin,y.ymin]]]}:y;S=(await v.normalizeCentralMeridian(f.fromJSON(y)))[0];
if(null==S)throw a;const b="quantizationParameters"in r&&r.quantizationParameters?.tolerance||"maxAllowableOffset"in r&&r.maxAllowableOffset||0;y=b&&I(y,F)?{densificationStep:8*b}:void 0;S=S.toJSON();y=p.project(S,S.spatialReference,F,y);if(!y)throw a;y.spatialReference=F;r.geometry=y}return r}function I(r,y){if(!r)return!1;const F=r.spatialReference;return(f.isExtent(r)||f.isPolygon(r)||f.isPolyline(r))&&!g.equals(F,y)&&!M.canProjectWithoutEngine(F,y)}async function E(r){const {distance:y,units:F}=
r,S=r.geometry;if(null==y||"vertexAttributes"in S)return S;var b=S.spatialReference;r=F?q.fromJSON(F):z.getUnitString(b);b=b&&(g.isGeographic(b)||g.isWebMercator(b))?S:await p.checkProjectionSupport(b,g.WGS84).then(()=>p.project(S,g.WGS84));return(await t())(b.spatialReference,b,y,r)}async function t(){return(await new Promise((r,y)=>d(["../../../geometry/geometryEngineJSON"],r,y))).geodesicBuffer}const q=new B.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",
esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),a=Object.freeze({});e.normalizeQuery=async function(r,y,F){const {outFields:S,orderByFields:b,groupByFieldsForStatistics:A,outStatistics:R}=r;if(S)for(var H=0;H<S.length;H++)S[H]=S[H].trim();if(b)for(H=0;H<b.length;H++)b[H]=b[H].trim();if(A)for(H=0;H<A.length;H++)A[H]=A[H].trim();if(R)for(H=0;H<R.length;H++)R[H].onStatisticField&&(R[H].onStatisticField=R[H].onStatisticField.trim());
r.geometry&&!r.outSR&&(r.outSR=r.geometry.spatialReference);return w(r,y,F)};e.normalizeQueryLike=w;e.queryEngineEmptyResult=a;e.unitsKebabDict=q;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(d,e,B,z,M,n){function f(I,E,t){const {outFields:q,orderByFields:a,returnDistinctValues:r,
outStatistics:y}=t,F=y?y.map(S=>S.outStatisticFieldName&&S.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(a&&0<a.length){const S=a.map(b=>{const A=b.toLowerCase();return A.includes(" asc")?A.split(" asc")[0]:A.includes(" desc")?A.split(" desc")[0]:b}).filter(b=>!F.includes(b));B.validateFields(I,E,S,{expressionName:"orderByFields",query:t})}if(q&&0<q.length)B.validateFields(I,E,q,{expressionName:"outFields",query:t});else if(r)throw new e("unsupported-query","outFields should be specified for returnDistinctValues",
{query:t});B.validateWhere(I,E,t.where,t)}function v(I,E,t){const {outStatistics:q,groupByFieldsForStatistics:a,having:r}=t;var y=a?.length,F=q?.length;if(r){if(!y||!F)throw new e("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});B.validateHaving(I,E,r,q,t)}if(F&&p(q)){F=q.map(S=>S.onStatisticField).filter(Boolean);B.validateFields(I,E,F,{expressionName:"onStatisticFields",query:t});y&&B.validateFields(I,E,a,{expressionName:"groupByFieldsForStatistics",
query:t});for(const S of q){const {onStatisticField:b,statisticType:A}=S;if(("percentile_disc"===A||"percentile_cont"===A)&&"statisticParameters"in S){if({statisticParameters:y}=S,!y)throw new e("unsupported-query","statisticParameters should be set for percentile type",{definition:S,query:t});}else I.get(b)&&"count"!==A&&"min"!==A&&"max"!==A&&B.validateFields(I,E,[b],{expressionName:`outStatistics with '${A}' statistic type`,allowedFieldTypes:w,query:t})}}}async function g(I,E,t,q){var a=[];t.valueExpression&&
({arcadeUtils:a}=await n.loadArcade(),a=a.extractFieldNames(t.valueExpression));t.field&&a.push(t.field);t.field2&&a.push(t.field2);t.field3&&a.push(t.field3);t.normalizationField&&a.push(t.normalizationField);if(!a.length&&!t.valueExpression)throw new e("unsupported-query","field or valueExpression is required",{params:t});B.validateFields(I,E,a,{expressionName:"statistics",query:q})}function p(I){return null!=I&&I.every(E=>"exceedslimit"!==E.statisticType)}const w=new Set([...B.numericFieldTypes,
...B.allDateAndTimeFieldTypes]);d.validateQuery=async function(I,{fieldsIndex:E,geometryType:t,spatialReference:q,availableFields:a}){if(0>(I.distance??0)||null!=I.geometryPrecision||I.multipatchOption&&"xyFootprint"!==I.multipatchOption||I.pixelSize||I.relationParam||I.text)throw new e("unsupported-query","Unsupported query options",{query:I});f(E,a,I);v(E,a,I);return Promise.all([M.checkSpatialQuerySupport(I,t,q),z.checkProjectionSupport(q,I.outSR)]).then(()=>I)};d.validateStatisticsQuery=async function(I,
E,{fieldsIndex:t,geometryType:q,spatialReference:a,availableFields:r}){if(0>(I.distance??0)||null!=I.geometryPrecision||I.multipatchOption||I.pixelSize||I.relationParam||I.text||I.outStatistics||I.groupByFieldsForStatistics||I.having||I.orderByFields)throw new e("unsupported-query","Unsupported query options",{query:I});f(t,r,I);return Promise.all([g(t,r,E,I),M.checkSpatialQuerySupport(I,q,a),z.checkProjectionSupport(a,I.outSR)]).then(()=>I)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(d,e,B,z,M,n,f,v,g,p,w,I){function E(){return new Promise((y,F)=>d(["../../../geometry/geometryEngineJSON"],y,F))}const t={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var q={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},a={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},r={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};e.canQueryWithRBush=function(y){if(n.isExtent(y))return!0;if(n.isPolygon(y)){for(const F of y.rings)if(5!==F.length||F[0][0]!==F[1][0]||F[0][0]!==F[4][0]||F[2][0]!==F[3][0]||F[0][1]!==F[3][1]||F[0][1]!==
F[4][1]||F[1][1]!==F[2][1])return!1;return!0}return!1};e.checkSpatialQuerySupport=async function(y,F,S){const {spatialRel:b,geometry:A}=y;if(A){if(null==b||!0!==q[b])throw new B("unsupported-query","Unsupported query spatial relationship",{query:y});if(f.isValid(A.spatialReference)&&f.isValid(S)){if(null==A||!0!==a[n.getJsonType(A)])throw new B("unsupported-query","Unsupported query geometry type",{query:y});if(null==F||!0!==r[F])throw new B("unsupported-query","Unsupported layer geometry type",{query:y});
if(y.outSR)return I.checkProjectionSupport(y.geometry?.spatialReference,y.outSR)}}};e.getSpatialQueryOperator=function(y,F,S,b,A){if(n.isPolygon(F)&&"esriGeometryPoint"===S&&("esriSpatialRelIntersects"===y||"esriSpatialRelContains"===y)){const R=g.convertFromPolygon(new p,F,!1,!1);return Promise.resolve(H=>v.polygonContainsPoint(R,!1,!1,H))}if(n.isPolygon(F)&&"esriGeometryMultipoint"===S){const R=g.convertFromPolygon(new p,F,!1,!1);if("esriSpatialRelContains"===y)return Promise.resolve(H=>v.polygonContainsMultipoint(R,
!1,!1,H,b,A))}if(n.isExtent(F)&&"esriGeometryPoint"===S&&("esriSpatialRelIntersects"===y||"esriSpatialRelContains"===y))return Promise.resolve(R=>z.extentContainsPoint(F,w.getGeometry(S,b,A,R)));if(n.isExtent(F)&&"esriGeometryMultipoint"===S&&"esriSpatialRelContains"===y)return Promise.resolve(R=>z.extentContainsMultipoint(F,w.getGeometry(S,b,A,R)));if(n.isExtent(F)&&"esriSpatialRelIntersects"===y){const R=M.getExtentIntersector(S);return Promise.resolve(H=>R(F,w.getGeometry(S,b,A,H)))}return E().then(R=>
{const H=R[t[y]].bind(null,F.spatialReference,F);return Q=>H(w.getGeometry(S,b,A,Q))})};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(d,e){d.extentIntersectsExtent=e.extentIntersectsExtent;d.extentIntersectsMultipoint=e.extentIntersectsMultipoint;d.extentIntersectsPoint=e.extentIntersectsPoint;d.extentIntersectsPolygon=e.extentIntersectsPolygon;d.extentIntersectsPolyline=e.extentIntersectsPolyline;
d.extentIntersectsRings=e.extentIntersectsRings;d.getFeatureExtentIntersector=e.getFeatureExtentIntersector;d.isSelfIntersecting=e.isSelfIntersecting;d.segmentIntersects=e.segmentIntersects;d.getExtentIntersector=function(B){return"mesh"===B?e.extentIntersectsExtent:e.getFeatureExtentIntersector(B)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(d){function e(B,z,M,n,f){if(!B)return!1;z=z?M?4:3:M?3:2;const {coords:v,
lengths:g}=B;M=!1;B=0;for(const w of g){var p=B;for(let I=B,E=B+w*z;I<E;I+=z){p=I+z;p===E&&(p=B);const t=v[I],q=v[I+1],a=v[p];p=v[p+1];(q<f&&p>=f||p<f&&q>=f)&&t+(f-q)/(p-q)*(a-t)<n&&(M=!M)}B+=w*z}return M}d.polygonContainsCoords=e;d.polygonContainsMultipoint=function(B,z,M,n,f,v){f=f?v?4:3:v?3:2;const {coords:g,lengths:p}=n;if(!p)return!1;for(let w=0,I=0;w<p.length;w++,I+=f)if(!e(B,z,M,g[I],g[I+1]))return!1;return!0};d.polygonContainsPoint=function(B,z,M,n){return e(B,z,M,n.coords[0],n.coords[1])};
Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(d){function e(M,n,f,v,g){if(null!=v&&null!=g)return p=>{const w=M(p,n);p=M(p,f);return(null==w||w<=g)&&(null==p||p>=v)};if(null!=v)return p=>{p=M(p,f);return null==p||p>=v};if(null!=g)return p=>{p=M(p,n);return null==p||p<=g}}function B(M,n,f,v){if(null!=f&&null!=v&&f===v)return g=>M(g,n)===f;if(null!=f&&null!=v)return g=>{g=M(g,n);return null!=g&&g>=f&&g<=
v};if(null!=f)return g=>{g=M(g,n);return null!=g&&g>=f};if(null!=v)return g=>{g=M(g,n);return null!=g&&g<=v}}function z(){return()=>!1}d.getTimeExtent=async function(M,n){if(!M)return null;const f=n.featureAdapter,{startTimeField:v,endTimeField:g}=M;let p=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY;if(v&&g)await n.forEach(I=>{const E=f.getAttribute(I,v);I=f.getAttribute(I,g);null==E||isNaN(E)||(p=Math.min(p,E));null==I||isNaN(I)||(w=Math.max(w,I))});else{const I=v||g;await n.forEach(E=>{E=
f.getAttribute(E,I);null==E||isNaN(E)||(p=Math.min(p,E),w=Math.max(w,E))})}return{start:p,end:w}};d.getTimeOperator=function(M,n,f){if(!n||!M)return null;const {startTimeField:v,endTimeField:g}=M;if(!v&&!g)return null;const {start:p,end:w}=n;if(null===p&&null===w)return null;if(void 0===p&&void 0===w)return z();M=f.getAttributeAsTimestamp?.bind(f)??f.getAttribute.bind(f);return v&&g?e(M,v,g,p,w):B(M,v||g,p,w)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(d,e,B,z,M,n,f,v){function g(t){return t.trim().toLowerCase()}function p(t){const q=new Map;if(!t.fields)return q;const a=!0===t.datesInUnknownTimezone,{timeInfo:r,editFieldsInfo:y}=t;var F=(r?"startField"in r?r.startField:r.startTimeField:"")??"";const S=(r?"endField"in r?r.endField:r.endTimeField:"")??"",b="dateFieldsTimeZone"in t?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?f.fromTimeReference(t.dateFieldsTimeReference):null,A=y?"timeZone"in y?y.timeZone??b:y.dateFieldsTimeReference?
f.fromTimeReference(y.dateFieldsTimeReference):b??f.utc:null,R=r?"timeZone"in r?r.timeZone??b:r.timeReference?f.fromTimeReference(r.timeReference):b:null;F=new Map([[g(y?.creationDateField??""),A],[g(y?.editDateField??""),A],[g(F),R],[g(S),R]]);for(const {name:H,type:Q}of t.fields)E.has(Q)?q.set(H,f.unknown):"date"!==Q&&"esriFieldTypeDate"!==Q?q.set(H,null):a?q.set(H,f.unknown):(t=F.get(g(H??""))??b,q.set(H,t));return q}const w=new Map;class I{static fromJSON(t){return new I(t.fields,t.timeZoneByFieldName)}static fromLayer(t){return new I(t.fields??
[],p(t))}static fromLayerJSON(t){return new I(t.fields??[],p(t))}constructor(t=[],q){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=t||[];this._timeZoneByFieldName=q?new Map(q):null;t=[];for(const a of this.fields){q=a?.name;const r=n.normalizeFieldName(q)?.toLowerCase()??"";if(q&&r){const y=g(q);this._fieldsMap.set(q,a);this._fieldsMap.set(y,a);this._normalizedFieldsMap.set(r,
a);t.push(`${y}:${a.type}:${this._timeZoneByFieldName?.get(q)}`);n.isDateField(a)?(this.dateFields.push(a),this._dateFieldsSet.add(a)):n.isNumericField(a)&&(this._numericFieldsSet.add(a),this.numericFields.push(a));n.isObjectIDField(a)||n.isGlobalIDField(a)||(a.editable=null==a.editable||!!a.editable,a.nullable=null==a.nullable||!!a.nullable)}}t.sort();this.uid=t.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)n.isObjectIDField(t)||n.isGlobalIDField(t)||
t.nullable||void 0!==n.getFieldDefaultValue(t)||this._requiredFields.push(t)}return this._requiredFields}equals(t){return this.uid===t?.uid}has(t){return null!=this.get(t)}get(t){if(t){var q=this._fieldsMap.get(t);if(q)return q;(q=this._fieldsMap.get(g(t))??this._normalizedFieldsMap.get(n.normalizeFieldName(t)?.toLowerCase()??""))&&this._fieldsMap.set(t,q);return q}}getTimeZone(t){t=this.get(t&&"string"!==typeof t?t.name:t);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):
"date"===t.type||"esriFieldTypeDate"===t.type?(B.getLogger("esri.layers.support.FieldsIndex").error(new d("getTimeZone:no-timezone-information",`no time zone information for field '${t.name}'`)),f.utc):E.has(t.type)?f.unknown:null:null}getLuxonTimeZone(t){const q=this.getTimeZone(t);return q?q===f.unknown?M.UnknownTimeZone.instance:q===f.utc?v.FixedOffsetZone.utcInstance:z.getOrCreateMapValue(w,q,()=>v.IANAZone.create(q)):null}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isTimeOnlyField(t){return n.isTimeOnlyField(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){return this.get(t)?.name??
void 0}toJSON(){return{fields:this.fields.map(t=>e.isSerializable(t)?t.toJSON():t),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const E=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return I})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState".split(" "),
function(d,e,B,z,M,n,f,v,g,p,w,I,E,t){function q(N){return a.has(N)?a.get(N):"number"===typeof N?N:1}d.Task=void 0;(function(N){N[N.YIELD=1]="YIELD"})(d.Task||(d.Task={}));d.TaskPriority=void 0;(function(N){N.RESOURCE_CONTROLLER_IMMEDIATE="immediate";N.RESOURCE_CONTROLLER="schedule";N.SLIDE="slide";N.STREAM_DATA_LOADER="stream loader";N.ELEVATION_QUERY="elevation query";N.TERRAIN_SURFACE="terrain";N.SURFACE_GEOMETRY_UPDATES="surface geometry updates";N.LOD_RENDERER="LoD renderer";N.GRAPHICS_CORE=
"Graphics3D";N.I3S_CONTROLLER="I3S";N.POINT_CLOUD_LAYER="point cloud";N.FEATURE_TILE_FETCHER="feature fetcher";N.OVERLAY="overlay";N.STAGE="stage";N.GRAPHICS_DECONFLICTOR="graphics deconflictor";N.FILTER_VISIBILITY="Graphics3D filter visibility";N.SCALE_VISIBILITY="Graphics3D scale visibility";N.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";N.POINT_OF_INTEREST_FREQUENT="POI frequent";N.POINT_OF_INTEREST_INFREQUENT="POI infrequent";N.LABELER="labeler";N.FEATURE_QUERY_ENGINE="feature query";N.FEATURE_TILE_TREE=
"feature tile tree";N.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";N.ELEVATION_ALIGNMENT="elevation alignment";N.TEXT_TEXTURE_ATLAS="text texture atlas";N.TEXTURE_UNLOAD="texture unload";N.LINE_OF_SIGHT_TOOL="line of sight tool";N.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";N.ELEVATION_PROFILE="elevation profile";N.SNAPPING="snapping";N.SHADOW_ACCUMULATOR="shadow accumulator";N.CLOUDS_GENERATOR="clouds generator";N[N.NONE=0]="NONE";N[N.TEST_PRIO=1]="TEST_PRIO"})(d.TaskPriority||
(d.TaskPriority={}));const a=new Map([[d.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[d.TaskPriority.RESOURCE_CONTROLLER,4],[d.TaskPriority.SLIDE,0],[d.TaskPriority.STREAM_DATA_LOADER,0],[d.TaskPriority.ELEVATION_QUERY,0],[d.TaskPriority.TERRAIN_SURFACE,1],[d.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[d.TaskPriority.LOD_RENDERER,2],[d.TaskPriority.GRAPHICS_CORE,2],[d.TaskPriority.I3S_CONTROLLER,2],[d.TaskPriority.POINT_CLOUD_LAYER,2],[d.TaskPriority.FEATURE_TILE_FETCHER,2],[d.TaskPriority.OVERLAY,
4],[d.TaskPriority.STAGE,4],[d.TaskPriority.GRAPHICS_DECONFLICTOR,4],[d.TaskPriority.FILTER_VISIBILITY,4],[d.TaskPriority.SCALE_VISIBILITY,4],[d.TaskPriority.FRUSTUM_VISIBILITY,4],[d.TaskPriority.CLOUDS_GENERATOR,4],[d.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[d.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[d.TaskPriority.LABELER,8],[d.TaskPriority.FEATURE_QUERY_ENGINE,8],[d.TaskPriority.FEATURE_TILE_TREE,16],[d.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[d.TaskPriority.ELEVATION_ALIGNMENT,12],[d.TaskPriority.TEXT_TEXTURE_ATLAS,
12],[d.TaskPriority.TEXTURE_UNLOAD,12],[d.TaskPriority.LINE_OF_SIGHT_TOOL,16],[d.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[d.TaskPriority.SNAPPING,0],[d.TaskPriority.SHADOW_ACCUMULATOR,30]]),r=w.Milliseconds(6.5),y=w.Milliseconds(1),F=w.Milliseconds(30),S=w.Milliseconds(1E3/30),b=w.Milliseconds(100);var A;(function(N){class T{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(m=>m.needsUpdate)}constructor(){this._updating=p.signal(!0);this._microTaskQueued=
!1;this._frameNumber=0;this.performanceInfo={total:new n("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new O;this._state=t.RenderState.INTERACTING;this._tasks=new f;this._runQueue=new f;this._load=0;this._idleStateCallbacks=new f;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=g.watch(()=>E.SCHEDULER_LOG_SLOW_TASKS,u=>this._debug=u,g.initial);for(const u of Object.keys(d.TaskPriority))this.performanceInfo.tasks.set(d.TaskPriority[u],new n(d.TaskPriority[u]));
const m=this;this._test={FRAME_SAFETY_BUDGET:r,INTERACTING_BUDGET:S,IDLE_BUDGET:b,get availableBudget(){return m._budget.budget},usedBudget:0,getBudget:()=>m._budget,setBudget:u=>m._budget=u,updateTask:u=>this._updateTask(u),getState:u=>this._getState(u),getRuntime:u=>this._getRuntime(u),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach(m=>m.remove());this._tasks.clear();M.removeMaybe(this._debugHandle);
this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(m){this._updatingChanged();m&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(m,u){const J=q(m);u=new l(this,m,u,J);this._tasks.push(u);this._updatingChanged();this.performanceInfo.tasks.has(m)||this.performanceInfo.tasks.set(m,new n(m));return u}registerIdleStateCallbacks(m,
u){const J={idleBegin:m,idleEnd:u};this._idleStateCallbacks.push(J);this.state===t.RenderState.IDLE&&this._idleUpdatesStartFired&&J.idleBegin();const L=this;return{remove:()=>this._removeIdleStateCallbacks(J),set idleBegin(U){L._idleUpdatesStartFired&&(J.idleEnd(),L._state===t.RenderState.IDLE&&U());J.idleBegin=U},set idleEnd(U){J.idleEnd=U}}}get load(){return this._load}set state(m){this._state!==m&&(this._state=m,this.state!==t.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=
!1,this._idleStateCallbacks.forAll(u=>u.idleEnd())))}get state(){return this._state}updateBudget(m){this._test.usedBudget=0;++this._frameNumber;let u=r,J=m.frameDuration,L=y;switch(this.state){case t.RenderState.IDLE:u=w.Milliseconds(0);J=w.Milliseconds(Math.max(b,m.frameDuration));L=F;break;case t.RenderState.INTERACTING:J=w.Milliseconds(Math.max(S,m.frameDuration))}J=w.Milliseconds(J-m.elapsedFrameTime-u);if(this.state!==t.RenderState.IDLE&&J<y&&!this._forceTask)return this._forceTask=!0,!1;J=w.Milliseconds(Math.max(J,
L));this._budget.reset(J,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case t.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(m=>m.idleBegin()));this._runIdle();break;case t.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(w.Milliseconds(0),this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(m){this._idleUpdatesStartFired&&
m.idleEnd();this._idleStateCallbacks.removeUnordered(m)}removeTask(m){this._tasks.removeUnordered(m);this._runQueue.removeUnordered(m);this._updatingChanged()}_updateTask(m){this._tasks.forAll(u=>{u.name===m&&u.setPriority(m)})}_getState(m){if(this._runQueue.some(J=>J.name===m))return d.TaskState.SCHEDULED;let u=d.TaskState.IDLE;this._tasks.forAll(J=>{J.name===m&&J.needsUpdate&&(1>=J.schedulePriority?u=d.TaskState.READY:u!==d.TaskState.READY&&(u=d.TaskState.WAITING))});return u}_getRuntime(m){let u=
0;this._tasks.forAll(J=>{J.name===m&&(u+=J.runtime)});return u}_resetRuntimes(){this._tasks.forAll(m=>m.runtime=0)}_getRunning(){const m=new Map;this._tasks.forAll(J=>{J.needsUpdate&&m.set(J.name,(m.get(J.name)||0)+1)});if(0===m.size)return null;let u="";m.forEach((J,L)=>{u=1<J?u+` ${J}x ${L}`:u+` ${L}`});return u}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const m=this._tasks.reduce((u,J)=>J.needsUpdate?++u:u,0);this._load=.9*this._load+m*(1-.9)}_schedule(){this._runQueue.filterInPlace(m=>
{if(m.needsUpdate)return!0;m.schedulePriority=m.basePriority;return!1});for(this._tasks.forAll(m=>{0===m.basePriority&&m.needsUpdate&&!this._runQueue.includes(m)&&m.blockFrame!==this._frameNumber&&this._runQueue.unshift(m)});0===this._runQueue.length;){let m=!1;this._tasks.forAll(u=>{if(u.needsUpdate&&0!==u.schedulePriority&&0!==u.basePriority&&u.blockFrame!==this._frameNumber)switch(m=!0,u.schedulePriority){case 1:u.schedulePriority=0;this._runQueue.push(u);break;default:--u.schedulePriority}});
if(!m)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const m=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var u=this._budget.now();const J=this._runQueue.pop();this._budget.resetProgress();try{J.task.runTask(this._budget)===d.Task.YIELD&&(J.blockFrame=this._frameNumber)}catch(L){z.getLogger("esri.views.support.Scheduler").error(`Exception in task "${J.name}"`,L),J.blockFrame=this._frameNumber}!this._budget.hasProgressed&&J.blockFrame!==
this._frameNumber&&J.needsUpdate&&(J.blockFrame=this._frameNumber);J.schedulePriority=J.basePriority;u=this._budget.now()-u;J.runtime+=u;this._frameTaskTimes.set(J.priority,this._frameTaskTimes.get(J.priority)+u);this._debug&&u>2*this._budget.budget&&console.log("Task",J.name,"used",u,"of max",this._budget.budget,"ms");if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-m);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-
m)}_startFrameTaskTimes(){for(const m of Object.keys(d.TaskPriority))this._frameTaskTimes.set(d.TaskPriority[m],0)}_recordFrameTaskTimes(m){this._frameTaskTimes.forEach((u,J)=>this.performanceInfo.tasks.get(J).record(u));this.performanceInfo.total.record(m)}get test(){return this._test}}N.Scheduler=T;class l{get task(){return this._task.value}get updating(){return this._queue.running}constructor(m,u,J,L){this._scheduler=m;this.name=u;this._basePriority=L;this.runtime=this.blockFrame=0;this._queue=
new I.PromiseQueue;this._handles=new e;this.schedulePriority=this._basePriority;this._task=p.signal(null!=J?J:this._queue);this._handles.add(g.when(()=>this.task.running,U=>m.taskRunningChanged(U)))}remove(){this.processQueue(R);this._scheduler.removeTask(this);this.schedule=Q.schedule;this.reschedule=Q.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(m){this.name=m;m=q(m);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=m;this._basePriority=
m}get priority(){return this.name}set priority(m){this.setPriority(m)}get needsUpdate(){return this.updating||this.task.running}schedule(m,u,J){return this._queue.push(m,u,J)}reschedule(m,u,J){return this._queue.unshift(m,u,J)}processQueue(m){this._queue.runTask(m)}}class O{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=t.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(m){if(this.done)return!1;!0===m()&&this.madeProgress();
return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(m){this._enabled=m}reset(m,u){this._begin=this.now();this._budget=m;this._state=u;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._done=
this._progressed=!1}get hasProgressed(){return this._progressed}}N.Budget=O})(A||(A={}));d.TaskState=void 0;(function(N){N.SCHEDULED="s";N.READY="r";N.WAITING="w";N.IDLE="i"})(d.TaskState||(d.TaskState={}));const R=(()=>{const N=new A.Budget;N.enabled=!1;return N})();class H{remove(){}processQueue(){}schedule(N,T,l){try{if(v.isAborted(T)){const O=v.createAbortError();return l?Promise.resolve(l(O)):Promise.reject(O)}return v.when(N(R))}catch(O){return Promise.reject(O)}}reschedule(N,T,l){return this.schedule(N,
T,l)}}const Q=new H;d.ImmediateTask=Q;d.getTaskPriority=q;d.newScheduler=function(){return new A.Scheduler};d.noBudget=R;d.taskPriorities=a;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(d,e,B,z){class M{constructor(n,f){this._observable=new z.SimpleObservable;this._value=n;this._equalityFunction=f}get value(){B.trackAccess(this._observable);
return this._value}set value(n){this._equalityFunction(n,this._value)||(this._value=n,this._observable.notify())}mutate(n){n(this._value);this._observable.notify()}}d.signal=function(n,f=e.equalsShallow){return new M(n,f)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal"],function(d,e,B){class z{constructor(){this._tasks=[];this._running=B.signal(!1)}get length(){return this._tasks.length}get running(){return this._running.value}destroy(){this.cancelAll()}runTask(n){for(;!n.done&&
this._process(n);)n.madeProgress()}push(n,f,v){this._running.value=!0;return new Promise((g,p)=>this._tasks.push(new M(g,p,n,f,v)))}unshift(n,f,v){this._running.value=!0;return new Promise((g,p)=>this._tasks.unshift(new M(g,p,n,f,v)))}_process(n){if(0===this._tasks.length)return!1;const f=this._tasks.shift();try{const v=e.isAborted(f.signal);if(v&&!f.abortCallback)f.reject(e.createAbortError());else{const g=v?f.abortCallback?.(e.createAbortError()):f.callback(n);e.isPromiseLike(g)?g.then(f.resolve,
f.reject):f.resolve(g)}}catch(v){f.reject(v)}this._running.value=0<this._tasks.length;return!0}cancelAll(){const n=e.createAbortError();for(const f of this._tasks)if(f.abortCallback){const v=f.abortCallback(n);f.resolve(v)}else f.reject(n);this._tasks.length=0;this._running.value=!1}}class M{constructor(n,f,v,g,p){this.resolve=n;this.reject=f;this.callback=v;this.signal=g;this.abortCallback=p}}d.PromiseQueue=z;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,e,B,z,M,n,f){e=class extends e{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=this.SCHEDULER_LOG_SLOW_TASKS=!1}};d.__decorate([B.property()],e.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);d.__decorate([B.property()],e.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);e=d.__decorate([f.subclass("esri.views.support.DebugFlags")],e);return new e})},"esri/views/support/RenderState":function(){define(["exports"],function(d){d.RenderState=
void 0;var e=d.RenderState||(d.RenderState={});e[e.ANIMATING=0]="ANIMATING";e[e.INTERACTING=1]="INTERACTING";e[e.IDLE=2]="IDLE";Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/geojson/geojson":function(){define("exports ../../../../core/date ../../../../core/Error ../../../../geometry/support/spatialReferenceUtils ../../OptimizedFeature ../../OptimizedGeometry ../../../support/fieldUtils".split(" "),function(d,e,B,z,M,n,f){function*v(b){switch(b.type){case "Feature":yield b;
break;case "FeatureCollection":for(const A of b.features)A&&(yield A)}}function*g(b){if(b)switch(b.type){case "Point":yield b.coordinates;break;case "LineString":case "MultiPoint":yield*b.coordinates;break;case "MultiLineString":case "Polygon":for(const A of b.coordinates)yield*A;break;case "MultiPolygon":for(const A of b.coordinates)for(const R of A)yield*R}}function*p(b,A={}){const {geometryType:R,objectIdField:H}=A;for(const Q of b){const {geometry:N,properties:T,id:l}=Q;if(N&&S[N.type]!==R)continue;
b=T||{};let O=void 0;H&&(O=b[H],null==l||O||(b[H]=O=l));yield new M.OptimizedFeature(N?t(new n,N,A):null,b,null,O??void 0)}}function w(b){for(const A of b)if(2<A.length)return!0;return!1}function I(b){let A=0;for(let R=0;R<b.length;R++){const H=b[R],Q=b[(R+1)%b.length];A+=H[0]*Q[1]-Q[0]*H[1]}return 0>=A}function E(b){const A=b[0],R=b[b.length-1];A[0]===R[0]&&A[1]===R[1]&&A[2]===R[2]||b.push(A);return b}function t(b,A,R){switch(A.type){case "LineString":return r(b,A.coordinates,R),b;case "MultiLineString":for(const Q of A.coordinates)r(b,
Q,R);return b;case "MultiPoint":return r(b,A.coordinates,R),b;case "MultiPolygon":for(var H of A.coordinates)for(q(b,H[0],R),A=1;A<H.length;A++)a(b,H[A],R);return b;case "Point":return F(b,A.coordinates,R),b;case "Polygon":H=A.coordinates;q(b,H[0],R);for(A=1;A<H.length;A++)a(b,H[A],R);return b}}function q(b,A,R){A=E(A);I(A)?r(b,A,R):y(b,A,R)}function a(b,A,R){A=E(A);I(A)?y(b,A,R):r(b,A,R)}function r(b,A,R){for(const H of A)F(b,H,R);b.lengths.push(A.length)}function y(b,A,R){for(let H=A.length-1;0<=
H;H--)F(b,A[H],R);b.lengths.push(A.length)}function F(b,A,R){const [H,Q,N]=A;b.coords.push(H,Q);R.hasZ&&b.coords.push(N||0)}const S={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};d.createOptimizedFeatures=function(b,A){return Array.from(p(v(b),A))};d.getGeometryType=function(b){return S[b]};d.inferLayerProperties=function(b,A={}){const R=[];var H=
new Set;const Q=new Set;var N=!1;let T=null,l=!1,O=void 0;({geometryType:A=null}=A);var m=!1;for(const u of v(b)){const {geometry:J,properties:L,id:U}=u;if(J&&(A||(A=S[J.type]),S[J.type]!==A))continue;N||(N=g(J),N=w(N));!l&&(l=null!=U)&&(O=typeof U,L&&(T=Object.keys(L).filter(Y=>L[Y]===U)));L&&T&&l&&null!=U&&(1<T.length?T=T.filter(Y=>L[Y]===U):1===T.length&&(T=L[T[0]]===U?T:[]));if(!m&&L){b=!0;for(const Y in L){if(H.has(Y))continue;m=L[Y];if(null==m){b=!1;Q.add(Y);continue}a:switch(typeof m){case "string":m=
e.isISO8601Date(m)?"esriFieldTypeDate":"esriFieldTypeString";break a;case "number":m="esriFieldTypeDouble";break a;default:m="unknown"}if("unknown"===m){Q.add(Y);continue}Q.delete(Y);H.add(Y);const ea=f.normalizeFieldName(Y);ea&&R.push({name:ea,alias:Y,type:m})}m=b}}if(H=f.normalizeFieldName(1===T?.length&&T[0]||null)??void 0)for(const u of R)if(u.name===H&&f.isNumericField(u)){u.type="esriFieldTypeOID";break}return{fields:R,geometryType:A,hasZ:N,objectIdFieldName:H,objectIdFieldType:O,unknownFields:Array.from(Q)}};
d.validateGeoJSON=function(b,A=4326){if(!b)throw new B("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==b.type&&"FeatureCollection"!==b.type)throw new B("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:b});({crs:b}=b);if(b){var R="string"===typeof b?b:"name"===b.type?b.properties.name:"EPSG"===b.type?b.properties.code:null;A=z.isWGS84({wkid:A})?RegExp(".*(CRS84H?|4326)$","i"):new RegExp(`.*(${A})$`,"i");if(!R||!A.test(R))throw new B("geojson:unsupported-crs",
"unsupported GeoJSON 'crs' member",{crs:b});}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/date":function(){define(["exports"],function(d){function e(f){const v=new Date(f);if(Number.isNaN(v.getTime()))f=!1;else{var g=!0;if(n&&/\d+\W*$/.test(f)&&(f=f.match(/[a-zA-Z]{2,}/))){g=!1;let p=0;for(;!g&&p<=f.length;)g=!M.test(f[p]),p++;g=!g}f=g}return f?Number.isNaN(v.getTime())?null:v.getTime()-6E4*v.getTimezoneOffset():null}function B(f){f=z.exec(f);if(!f?.groups)return null;
f=f.groups;const v=+f.year,g=+f.month-1,p=+f.day,w=+(f.hours??0),I=+(f.minutes??0),E=+(f.seconds??0);if(23<w||59<I||59<E)return null;var t=f.ms??"0";t=t?+t.padEnd(3,"0").substring(0,3):0;f=f.isUTC||!f.offsetSign?Date.UTC(v,g,p,w,I,E,t):6E4*("+"===f.offsetSign?-1:1)*(60*+f.offsetHours+ +f.offsetMinutes)+Date.UTC(v,g,p,w,I,E,t);return Number.isNaN(f)?null:f}const z=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,
M=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,n=!Number.isNaN((new Date("technology 10")).getTime());d.isDateString=function(f){return null!=B(f)||null!=e(f)};d.isISO8601Date=function(f){return z.test(f)};d.parseDate=function(f){return B(f)??e(f)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["exports",
"../../../../core/has","../../../../core/lang","../../data/QueryEngineCapabilities","../../../../symbols/support/defaultsJSON"],function(d,e,B,z,M){const n=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let f=1;d.createCapabilities=function(v,g){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:v},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:g,supportsDelete:g,
supportsEditing:g,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:g,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:z.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:g,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,
supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}};d.createDefaultAttributesFunction=function(v,g){if(e("esri-csp-restrictions"))return()=>({[g]:null,...v});try{let p=`this.${g} = null;`;for(const I in v){const E=n.test(I)?`.${I}`:`["${I}"]`;p+=`this${E} = ${JSON.stringify(v[I])};`}const w=(new Function(`\n      return class AttributesClass$${f++} {\n        constructor() {\n          ${p};\n        }\n      }\n    `))();
return()=>new w}catch(p){return()=>({[g]:null,...v})}};d.createDefaultTemplate=function(v={}){return[{name:"New Feature",description:"",prototype:{attributes:B.clone(v)}}]};d.createDrawingInfo=function(v){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===v||"esriGeometryMultipoint"===v?M.defaultPointSymbolJSON:"esriGeometryPolyline"===v?M.defaultPolylineSymbolJSON:M.defaultPolygonSymbolJSON}}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],
function(d){const e=[252,146,31,255],B={type:"esriSMS",style:"esriSMSCircle",size:6,color:e,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},z={type:"esriSLS",style:"esriSLSSolid",width:.75,color:e};d.defaultColor=e;d.defaultOutlineColor=[153,153,153,255];d.defaultPointSymbolJSON=B;d.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};d.defaultPolylineSymbolJSON=
z;d.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};d.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};d.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};d.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",
color:[0,0,0,255],width:1.5};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/sourceUtils":function(){define(["require","exports","../../../../core/date","../../../../geometry/support/spatialReferenceUtils","../../../support/fieldUtils"],function(d,e,B,z,M){function n(E){return new g(E)}async function f(){null==I&&(I=await new Promise((E,t)=>d(["../../../../geometry/geometryEngineJSON"],E,t)));return I}class v{constructor(){this.description=this.code=
null}}class g{constructor(E){this.error=new v;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=E}}class p{constructor(E){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=E}}const w=new Set;let I;e.createFeatureEditErrorResult=n;e.createFeatureEditSuccessResult=function(E){return new p(E)};e.loadGeometryEngineForSimplify=async function(E,t){!z.isValid(E)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t||await f()};e.mixAttributes=function(E,
t,q,a=!1){w.clear();for(const F in q){const S=E.get(F);if(!S)continue;var r=S,y=q[F];let b=y;M.isNumericField(r)&&"string"===typeof y?b=parseFloat(y):M.isStringField(r)&&null!=y&&"string"!==typeof y?b=String(y):M.isDateField(r)&&"string"===typeof y&&(b=B.parseDate(y));r=M.sanitizeNullFieldValue(b);w.add(S.name);if(S&&(a||S.editable)){if(y=M.validateFieldValue(S,r))return n(M.validationErrorToString(y,S,r));t[S.name]=r}}for(const F of E?.requiredFields??[])if(!w.has(F.name))return n(`missing required field "${F.name}"`);
return null};e.parseStringDateFieldValues=function(E,t){if(E?.length)for(const {name:q}of E)"string"===typeof t[q]&&(t[q]=B.parseDate(t[q]))};e.simplify=function(E,t){if(!E||!z.isValid(t))return E;if("rings"in E||"paths"in E){if(null==I)throw new TypeError("geometry engine not loaded");return I.simplify(t,E)}return E};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../../../request ../../../../core/asyncUtils ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./geojson ../support/clientSideDefaults ../support/sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils ../../../../time/timeZoneUtils".split(" "),function(d,
e,B,z,M,n,f,v,g,p,w,I,E,t,q,a,r,y){const F={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,
supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};class S{constructor(){this._queryEngine=null;this._snapshotFeatures=async b=>{b=await this._fetch(b);return this._createFeatures(b)}}destroy(){this._queryEngine?.destroy();this._queryEngine=this._createDefaultAttributes=null}async load(b,A={}){this._loadOptions={url:b.url,customParameters:b.customParameters};var R=[];[A]=await Promise.all([b.url?this._fetch(A?.signal):null,
this._checkProjection(b.spatialReference)]);var H=I.inferLayerProperties(A,{geometryType:b.geometryType}),Q=b.fields||H.fields||[];const N=null!=b.hasZ?b.hasZ:H.hasZ,T=H.geometryType;let l=b.objectIdField||H.objectIdFieldName||"__OBJECTID";const O=b.spatialReference||f.WGS84;b=b.timeInfo;Q===H.fields&&0<H.unknownFields.length&&R.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:H.unknownFields}});
var m=new q(Q);let u=m.get(l);u?("esriFieldTypeString"!==u.type&&(u.type="esriFieldTypeOID"),u.editable=!1,u.nullable=!1,l=u.name):(u={alias:l,name:l,type:"string"===H.objectIdFieldType?"esriFieldTypeString":"esriFieldTypeOID",editable:!1,nullable:!1},Q.unshift(u));H={};for(var J of Q){null==J.name&&(J.name=J.alias);null==J.alias&&(J.alias=J.name);if(!J.name)throw new B("geojson-layer:invalid-field-name","field name is missing",{field:J});if(!a.kebabDict.jsonValues.includes(J.type))throw new B("geojson-layer:invalid-field-type",
`invalid type for field "${J.name}"`,{field:J});if(J.name!==u.name){const Y=r.getFieldDefaultValue(J);void 0!==Y&&(H[J.name]=Y)}null==J.length&&(J.length=r.getFieldDefaultLength(J))}b&&(b.startTimeField&&((J=m.get(b.startTimeField))?(b.startTimeField=J.name,J.type="esriFieldTypeDate"):b.startTimeField=null),b.endTimeField&&((J=m.get(b.endTimeField))?(b.endTimeField=J.name,J.type="esriFieldTypeDate"):b.endTimeField=null),b.trackIdField&&((J=m.get(b.trackIdField))?b.trackIdField=J.name:(b.trackIdField=
null,R.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:b}}))),b.startTimeField||b.endTimeField||(R.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:b}}),b=null));J=T?E.createDrawingInfo(T):void 0;m=m.dateFields.length?{timeZoneIANA:y.utc}:null;R={warnings:R,featureErrors:[],layerDefinition:{...F,drawingInfo:J??void 0,templates:E.createDefaultTemplate(H),extent:void 0,geometryType:T,
objectIdField:l,fields:Q,hasZ:!!N,timeInfo:b,dateFieldsTimeReference:m}};this._queryEngine=new w.QueryEngine({fieldsIndex:q.fromLayerJSON({fields:Q,timeInfo:b,dateFieldsTimeReference:m}),geometryType:T,hasM:!1,hasZ:N,objectIdField:l,spatialReference:O,timeInfo:b,featureStore:new g({geometryType:T,hasM:!1,hasZ:N}),cacheSpatialQueries:!0});Q=this._queryEngine.fieldsIndex.requiredFields.indexOf(u);-1<Q&&this._queryEngine.fieldsIndex.requiredFields.splice(Q,1);this._createDefaultAttributes=E.createDefaultAttributesFunction(H,
l);A=await this._createFeatures(A);this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,A);A=this._normalizeFeatures(A,R.featureErrors);this._queryEngine.featureStore.addMany(A);const {fullExtent:L,timeExtent:U}=await this._queryEngine.fetchRecomputedExtents();R.layerDefinition.extent=L;if(U){const {start:Y,end:ea}=U;R.layerDefinition.timeInfo.timeExtent=[Y,ea]}return R}async applyEdits(b){const {spatialReference:A,geometryType:R}=this._queryEngine;await Promise.all([t.loadGeometryEngineForSimplify(A,
R),p.checkProjectionSupport(b.adds,A),p.checkProjectionSupport(b.updates,A)]);await this._waitSnapshotComplete();return this._applyEdits(b)}async queryFeatures(b={},A={}){await this._waitSnapshotComplete();return this._queryEngine.executeQuery(b,A.signal)}async queryFeatureCount(b={},A={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForCount(b,A.signal)}async queryObjectIds(b={},A={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForIds(b,A.signal)}async queryExtent(b=
{},A={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForExtent(b,A.signal)}async querySnapping(b,A={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForSnapping(b,A.signal)}async refresh(b){this._loadOptions.customParameters=b;this._snapshotTask?.abort();this._snapshotTask=e.createTask(this._snapshotFeatures);this._snapshotTask.promise.then(H=>{this._queryEngine.featureStore.clear();this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,
H);(H=this._normalizeFeatures(H))&&this._queryEngine.featureStore.addMany(H)},H=>{this._queryEngine.featureStore.clear();M.isAbortError(H)||z.getLogger("esri.layers.GeoJSONLayer").error(new B("geojson-layer:refresh","An error occurred during refresh",{error:H}))});await this._waitSnapshotComplete();const {fullExtent:A,timeExtent:R}=await this._queryEngine.fetchRecomputedExtents();return{extent:A,timeExtent:R}}async _createFeatures(b){if(null==b)return[];const {geometryType:A,hasZ:R,objectIdField:H}=
this._queryEngine;b=I.createOptimizedFeatures(b,{geometryType:A,hasZ:R,objectIdField:H});if(!f.equals(this._queryEngine.spatialReference,f.WGS84))for(const Q of b)null!=Q.geometry&&(Q.geometry=v.convertFromGeometry(p.project(v.convertToGeometry(Q.geometry,this._queryEngine.geometryType,this._queryEngine.hasZ,!1),f.WGS84,this._queryEngine.spatialReference)));return b}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _fetch(b){const {url:A,
customParameters:R}=this._loadOptions;b=(await d(A,{responseType:"json",query:{...R},signal:b})).data;I.validateGeoJSON(b);return b}_normalizeFeatures(b,A){const {objectIdField:R,fieldsIndex:H}=this._queryEngine,Q=[];for(const N of b){b=this._createDefaultAttributes();const T=t.mixAttributes(H,b,N.attributes,!0);T?A?.push(T):(this._assignObjectId(b,N.attributes,!0),N.attributes=b,N.objectId=b[R],Q.push(N))}return Q}async _applyEdits(b){const {adds:A,updates:R,deletes:H}=b;b={addResults:[],deleteResults:[],
updateResults:[],uidToObjectId:{}};A?.length&&this._applyAddEdits(b,A);R?.length&&this._applyUpdateEdits(b,R);if(H?.length){for(const T of H)b.deleteResults.push(t.createFeatureEditSuccessResult(T));this._queryEngine.featureStore.removeManyById(H)}const {fullExtent:Q,timeExtent:N}=await this._queryEngine.fetchRecomputedExtents();return{extent:Q,timeExtent:N,featureEditResults:b}}_applyAddEdits(b,A){const {addResults:R}=b,{geometryType:H,hasM:Q,hasZ:N,objectIdField:T,spatialReference:l,featureStore:O,
fieldsIndex:m}=this._queryEngine,u=[];for(const J of A){if(J.geometry&&H!==n.getJsonType(J.geometry)){R.push(t.createFeatureEditErrorResult("Incorrect geometry type."));continue}A=this._createDefaultAttributes();const L=t.mixAttributes(m,A,J.attributes);L?R.push(L):(this._assignObjectId(A,J.attributes),J.attributes=A,null!=J.uid&&(b.uidToObjectId[J.uid]=J.attributes[T]),null!=J.geometry&&(A=J.geometry.spatialReference??l,J.geometry=p.project(t.simplify(J.geometry,A),A,l)),u.push(J),R.push(t.createFeatureEditSuccessResult(J.attributes[T])))}O.addMany(v.convertFromFeatures([],
u,H,N,Q,T))}_applyUpdateEdits({updateResults:b},A){const {geometryType:R,hasM:H,hasZ:Q,objectIdField:N,spatialReference:T,featureStore:l,fieldsIndex:O}=this._queryEngine;for(const u of A){const {attributes:J,geometry:L}=u;A=J?.[N];if(null==A){b.push(t.createFeatureEditErrorResult(`Identifier field ${N} missing`));continue}if(!l.has(A)){b.push(t.createFeatureEditErrorResult(`Feature with object id ${A} missing`));continue}const U=v.convertToFeature(l.getFeature(A),R,Q,H);if(null!=L){if(R!==n.getJsonType(L)){b.push(t.createFeatureEditErrorResult("Incorrect geometry type."));
continue}var m=L.spatialReference??T;U.geometry=p.project(t.simplify(L,m),m,T)}if(J&&(m=t.mixAttributes(O,U.attributes,J))){b.push(m);continue}l.add(v.convertFromFeature(U,R,Q,H,N));b.push(t.createFeatureEditSuccessResult(A))}}_createObjectIdGenerator(b,A){const R=b.fieldsIndex.get(b.objectIdField);if("esriFieldTypeString"===R.type)return()=>R.name+"-"+Date.now().toString(16);let H=Number.NEGATIVE_INFINITY;for(const Q of A)Q.objectId&&(H=Math.max(H,Q.objectId));H=Math.max(0,H)+1;return()=>H++}_assignObjectId(b,
A,R=!1){const H=this._queryEngine.objectIdField;b[H]=R&&H in A?A[H]:this._objectIdGenerator()}async _checkProjection(b){try{await p.checkProjectionSupport(f.WGS84,b)}catch{throw new B("geojson-layer","Projection not supported");}}}return S});